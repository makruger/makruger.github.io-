<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Using Printing Protocols in the Solaris Release - System Administration Guide: Solaris Printing</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2009-01-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Solaris Printing</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="gdsuo.html">Previous</a>
             </td>
             <td align="right">
                 <a href="gezpb.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="vol2preface-11.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="printintro-1.html">1.&nbsp;&nbsp;Introduction to Printing in the Solaris Operating System</a></p>
<p class="toc level2"><a href="printconcept-42.html">What's New in Printing?</a></p>
<p class="toc level2"><a href="printconcept-40.html">Fundamentals of Printing in the Solaris Operating System</a></p>
<p class="toc level2"><a href="gdtha.html">Overview of the Solaris Printing Architecture</a></p>
<p class="toc level2"><a href="gdsuo.html">Implementation of the Open Standard Print API</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Using Printing Protocols in the Solaris Release</a></p>
</div>
<p class="toc level2"><a href="gezpb.html">Overview of Solaris Print Manager</a></p>
<p class="toc level2"><a href="printconcept-31908.html">Overview of the LP Print Service </a></p>
<p class="toc level2"><a href="printconcept-49.html">The Solaris Print Client-Server Process</a></p>
<p class="toc level2"><a href="printconcept-15.html">Where to Find Printing Tasks</a></p>
<p class="toc level1 tocsp"><a href="printplan-1.html">2.&nbsp;&nbsp;Planning for Printing in the Solaris Operating System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="printsetup-33230.html">3.&nbsp;&nbsp;Setting Up Printing Services (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="printers-33230.html">4.&nbsp;&nbsp;Setting Up Printers (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="printadmin-15883.html">5.&nbsp;&nbsp;Administering Printers by Using Solaris Print Manager and LP Print Commands (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="proto-1.html">6.&nbsp;&nbsp;Administering Printers That Use Network Printing Protocols (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="printcust-66310.html">7.&nbsp;&nbsp;Customizing Printing Services and Printers (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="forms-1.html">8.&nbsp;&nbsp;Administering Character Sets, Filters, Forms, and Fonts (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ppdadmin-1.html">9.&nbsp;&nbsp;Administering Printers by Using the PPD File Management Utility (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="printdesktop-1.html">10.&nbsp;&nbsp;Setting Up and Administering Printers From the Desktop (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="printref-76596.html">11.&nbsp;&nbsp;Printing in the Solaris Operating System (Reference)</a></p>
<p class="toc level1 tocsp"><a href="tsprint-34397.html">12.&nbsp;&nbsp;Troubleshooting Printing Problems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fddwm.html">A.&nbsp;&nbsp;Using the Internet Printing Protocol</a></p>
<p class="toc level1 tocsp"><a href="gdqrm.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="gedcr"></a><h3>Using Printing Protocols in the Solaris Release</h3>
<p>The overall printing architecture in the Solaris OS uses network printing protocols to
communicate with print services in following ways:</p>
<ul><li><p>Client-to-server communications</p></li>
<li><p>Server-to-printer communications</p></li></ul>
<p>The Solaris Express software provides applications, toolkits, printing commands, and an application programming interface
that interacts with print services.  This API is called the PAPI. 
The PAPI consists of a front-end API implementation that dynamically loads back-end print
service or protocol modules that communicate directly with print services.  These print
services contain the print job or print queue that is being acted upon.
Client-to-server communications include the RFC-1179 and IPP protocols, as well as support for
communicating with a local LP print service.  For server-to-printer communications, the network
printing protocol support enables the print service to transmit print jobs directly to
network&hyphen;attached printers.</p><p>Server-to-printer communications include support for the following network protocols:</p>
<ul><li><p>Raw Transmission Control Protocol (TCP) socket</p></li>
<li><p>RFC-1179</p></li>
<li><p>IPP</p></li>
<li><p>SMB</p></li></ul>


<a name="gdqri"></a><h4>Selecting the Client-To-Server Network Printing Protocol</h4>
<p>Applications, toolkits, and printing commands select the protocol to use for client-to-server communications,
based on the value of the <tt>printer-uri-supported</tt> attribute that is found in
the <tt>printers.conf</tt> database entry for the specified print queue.  This value is
automatically generated and populated when access to a remote print queue is configured
by using the <tt>lpadmin</tt> command or when an application uses the interface
that is being referenced to perform an action or actions.</p><p>For example, when printing a document while using Mozilla, the path that is
followed to gain access to the printer is:</p><p>Mozilla &rarr; <tt>lp</tt> &rarr; PAPI</p><p>For more information, see the <a href="http://docs.sun.com/doc/819-2251/printers.conf-4?a=view"><tt>printers.conf</tt>(4)</a></p><p>The <tt>lpadmin</tt> command generates <tt>printer-uri-supported</tt> values using the following format:</p><p><tt>{ipp|lpd}://</tt><i>server</i><tt>/printers/</tt><i>queue</i><tt></tt></p><p>To determine which URI to use in the <tt>printers.conf</tt> database, the <tt>lpadmin</tt> command
probes the remote print service.  If the remote print service supports IPP,
this protocol is preferred over the BSD protocol.  However, you can override
automatic protocol selection by specifying the <tt>-s</tt>option with the <tt>lpadmin</tt> command, then supplying
a different URI. For more information, see the <a href="#gdsxm">Printer URI Formats</a>.</p><p>The print subsystem uses the BSD print protocol, also referred to as
the RFC&hyphen;1179 protocol, and raw Transmission Control Protocol (TCP), the basic communication language or
protocol of the Internet, to communicate with the printer. If you are setting
up a printer that includes printer vendor documentation, information about which protocol to
use is provided. The TCP protocol is the protocol that is most often
used for printing on the network.</p>

<a name="gdsxm"></a><h4>Printer URI Formats</h4>
<p>The following are supported printer URI formats:</p><a name="gdsxb"></a><h6>Table&nbsp;1-1 Supported URI Formats for Print Commands</h6><table><col width="25%"><col width="74%"><tr><td align="left" valign="top" scope="row"><p><tt>lpsched</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>lpsched://localhost/printers/queue</tt></p><p>This printer URI scheme can only
be used to contact a local LP service to access the print queue
that is specified in the URI.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>lpd</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>lpd://localhost/printers/queue[#extensions]</tt></p><p>Use this printer URI scheme to contact
local or remote print services to address the specified print queue on the
host that is specified in the URI.  The optional <tt>#extensions</tt> can be
specified as <tt>#solaris</tt> to indicate that the server host will process Solaris
extensions to the RFC-1179 protocol during print job submission.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>ipp</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>ipp://<i>server</i>[:<i>port</i>]/printers/<i>queue</i></tt></p><p><tt>http://<i>server</i>:631/printers/<i>queue</i></tt></p><p><tt>ipp://<i>server</i>[:<i>port</i>]/...</tt></p><p>Use this printer URI scheme
to contact local or remote print services to address a particular print queue
on the host that is specified in the URI.   The IPP
URI scheme is described in the IPP specifications. This printer URI scheme utilizes
more of a free form than the LPD printer URI scheme.  All
of the Solaris and CUPS-based print queues are accessed by using these schemes,
or formats. Access to print queues on other IPP-based print servers requires the
use of the server supported IPP URI scheme.  Typically, the scheme that
is used is one those that are listed in this table.</p></td>
</tr>
</table>

<a name="gfucs"></a><h4>Selecting the Server-To-Printer Network Printing Protocol</h4>
<p>Network&hyphen;attached printers often support more than one method of communicating with a print service.
 The most common method of communicating with the print service is through
a raw TCP connection to a well-known port on the device. Other
methods of communication include the RFC-1179 and IPP network protocols.  You can select
the server-to-printer communication protocol when adding a new print queue in one of
following ways:</p>
<ul><li><p>By using the <tt>lpadmin</tt> command with the following options, and as shown here:</p><pre># <tt><b>lpadmin -o protocol={bsd|tcp} -o dest=printer:queue-or-port -m netstandard{_foomatic}</b></tt></pre><p>This method for communicating with the print service was introduced in the Solaris 2.6 OS and is available in all subsequent Solaris releases.</p></li>
<li><p>The second method is to use the <tt>lpadmin</tt> command with the <tt>-d </tt>option, supplying a <i>device-uri</i>, and the <tt>-m</tt> option, specifying a <i>uri</i>.</p><p>This method for communicating with the print service was introduced more recently and is intended to replace the previous method. For more information, see <a href="#fwmxi">What is a Device URI?</a>.</p></li></ul>
<p>When determining which protocol to use for server-to-printer communication, consult the vendor printer
documentation for more specific information. Documentation includes information such as TCP port numbers,
RFC-1179  printer names, and the IPP printer URIs that are supported by
the device.  In most instances, a raw TCP socket communication is likely
to provide the most reliable results.</p><p>Also, note that due to differences between printing services on UNIX and Windows
platforms, Windows hosted printers should be configured as network&hyphen;attached printers and administered as
such.  These types of printers require the creation of a print queue
if you are using them on a Solaris system. These printers might
also use the SMB protocol for server-to-printer communication.  For more information about the
SMB protocol, see <a href="#gfhaq">Using the SMB Protocol</a>.</p><p>For more information about setting up printers and configuring print queues, see <a href="gfgxy.html">Setting Up Printers on a Print Server (Task Map)</a>.</p>

<a name="fwmxi"></a><h4>What is a Device URI?</h4>
<a name="indexterm-4"></a><a name="indexterm-5"></a><a name="indexterm-6"></a><p>A Uniform Resource Identifier (URI) is an addressing technology for identifying resources on
the Internet or a private intranet. The terms URI and URL are used
synonymously. URIs can be used with application-level protocols, called <b>URI schemes</b>. The Solaris printer
software includes support for configuring network&hyphen;attached printers. When creating print queues for network&hyphen;attached printers by using
LP print commands or by using Solaris Print Manager, you can specify the
device as a <i>device-uri</i>.</p><p>To specify the device as a <i>device-uri</i> from the command line, use the
<tt>lpadmin</tt> command with the <tt>-v</tt> and <tt>-m</tt> options:</p><pre># <tt><b>lpadmin -p </tt><i>printer</i><tt> -v </tt><i>device-uri</i><tt> -m </tt><i>uri</i><tt></b></tt></pre><p>Note that the <tt>-v</tt> option is still a valid option for specifying devices
other than those that utilize the <i>device-uri.</i> addressing technology.</p><p>For example, to add the printer, <tt>Lucille</tt>, by using the <i>device-uri</i>, <tt>smb://server/queue</tt>, and the
interface script that is included in the Solaris printer software, type:</p><pre># <tt><b>lpadmin -p lucille -v smb://</tt><i>server</i><tt>/</tt><i>print-queue</i><tt> -m uri -n /usr/lib/lp/model/ppd /system/foomatic/Epson/Epson-Stylus_Color_777-Stc777p.upp.ppd.gz</b></tt></pre>
<hr><p><b>Note - </b>You must use the <tt>-m</tt> option in the command-line syntax to specify an
interface script, or the back-end process ignores the print request. The script can
be the interface script that is included in the Solaris printing software or
another interface script that is <i>device-uri</i> protocol aware.</p>
<hr>
<p>The following <i>device-uri</i> schemes are supported:</p>
<ul><li><p><tt>ipp://</tt><i>host</i><tt>/printers/</tt><i>name</i><tt></tt></p></li>
<li><p><tt>lpd://</tt><i>host</i><tt>/printers/</tt><i>name</i><tt></tt></p></li>
<li><p>socket://<i>host</i>:<i>port</i></p></li>
<li><p><tt>smb://</tt><i>server</i><tt>/</tt><i>printer</i><tt></tt></p></li>
<li><p><tt>smb://</tt><i>workgroup</i><tt>/</tt><i>server</i><tt>/</tt><i>printer</i><tt></tt></p></li>
<li><p><tt>smb://</tt><i>username</i><tt>:</tt><i>password</i><tt>@</tt><i>server</i><tt>/</tt><i>printer</i><tt></tt></p></li>
<li><p><tt>smb://</tt><i>username</i><tt>:</tt><i>password</i><tt>@</tt><i>workgroup</i><tt>/</tt><i>server</i><tt>/</tt><i>printer</i><tt></tt></p></li></ul>
<p>To specify a device that uses a <i>device-uri</i> when using Solaris Print Manager
to add a network&hyphen;attached printer, select the URI option in the Protocol drop-down
menu of the New Network Printer window. Type a supported printer URI in
the destination field.</p><p>Other modifications that support setup of remote print queues by specifying the device
as a <i>device-uri</i> include the following:</p>
<ul><li><p>The Solaris print spooler can pass device information in the form of a <i>device-uri</i> to the back-end interface script as the environment variable, <tt>DEVICE_URI</tt>. Because the information is passed to the back-end as an environment variable, the existing interface scripts cannot take advantage of this information. However, these scripts are not adversely impacted.</p></li>
<li><p>The <tt>/etc/lp/model/uri</tt> file now communicates with the printer through the use of helper applications and the <i>device-uri</i>. The interface script also has the ability to process PPD files and uses a Foomatic script to convert print data to a printer-ready format.</p></li></ul>


<a name="egkkk"></a><h4>What Is the Internet Printing Protocol?</h4>
<a name="indexterm-7"></a><a name="indexterm-8"></a><p>IPP is a fairly recent industry standard network printing protocol that is used
for client-to-server and server-to-printer communications.  This protocol provides a basic model that
includes printers and jobs, standard attributes for these printers and jobs, and a
set of standard operations that can be performed against these printers and jobs.
 Because the objects, attributes, and operations are standardized, IPP is a method
for communicating between client and server systems. In the Solaris OS, server-side support
for this protocol is provided by an IPP listening service.  IPP client-side
support in the Solaris OS is implemented through the PAPI. IPP printer support
is available through the URI interface script.</p><p>More information about OpenSolaris printing can be found at <a href="http://opensolaris.org/os/community/printing/">http://opensolaris.org/os/community/printing/</a>.</p><p>For step-by-step procedures and additional background information in this document, see <a href="geduc.html">Setting Up the Internet Printing Protocol</a> and
<a href="fddwm.html">Appendix&nbsp;A, Using the Internet Printing Protocol</a>.</p>

<a name="bsd-123"></a><h4>Overview of the RFC-1179 Printing Protocol</h4>
<p>The RFC-1179 protocol is an existing over-the-wire protocol that is widely used for
communicating between print clients and servers and network&hyphen;attached printers. The Request for Comments
(RFC) 1179 describes the protocol that a line printer daemon client uses to
control  printing. Developed originally for BSD UNIX, the RFC-1179 printing protocol has
long been the cross-platform standard for printing. You can use this protocol to
perform basic printing tasks, such as submitting and canceling print jobs, and obtaining
print job status. The RFC-1179 protocol is able to communicate with LPD-based print
servers and any other print server that accepts the BSD printing protocol. Many
network&hyphen;attached printers offer this protocol as an option for transferring job data.</p>

<a name="gezsg"></a><h4>RFC-1179 Protocol Compared to the Internet Printing Protocol</h4>
<p>The RFC-1179 protocol has served for decades as the standard network printing protocol.
The protocol was originally designed to perform a very limited set of operations.
The RFC-1179 protocol lacks a common representation for status information. In addition, this
protocol offers only basic print job options. Conversely, the design of IPP includes
features that are lacking in the RFC-1179 and BSD protocols. With IPP, a
broad set of operations can be performed. These operations make use of a
core set of common attributes by using a common representation and encoding method.
Also, IPP enables encryption and authentication to be used between a print client
and a print server. Finally, IPP provides a means for extending operations and
attributes, while maintaining backward compatibility and interoperability. One of the results of the
evolution of the RFC-1179 protocol is that it has several conflicting vendor extensions to
overcome, making IPP the preferred choice of printing protocols.</p><p>For more information about using IPP to set up and administer printers, see
<a href="geduc.html">Setting Up the Internet Printing Protocol</a> and <a href="fddwm.html">Appendix&nbsp;A, Using the Internet Printing Protocol</a>.</p>

<a name="gfhaq"></a><h4>Using the SMB Protocol</h4>
<p>The SMB protocol is an application-level network protocol that is primarily used for
sharing printers, access to files, serial ports, and miscellaneous communications between nodes on
the network. Mainly used by Windows systems, SMB is an authenticated inter-process communication
mechanism. In the Solaris OS, the SMB protocol is used primarily for sharing
printers. All of these processes take place over the network. SMB can run
over multiple protocols.</p><p>SMB works through a peer-to-peer approach. A client makes a specific requests to
a server, and the server responds accordingly. SMB servers make their file systems
and other resources available to clients on the network. In the Solaris OS,
SMB includes Samba server-side support that is managed by the Service Management Facility
(SMF) and Samba <tt>smbclient</tt> client-side support. To access a Windows hosted printer, setup
of a local print queue is required. This requirement is due to differences
in UNIX and Windows printing models.</p>

<a name="gfilf"></a><h5>About Samba</h5>
<p>Samba is an open-source SMB server freeware application that uses the SMB protocol.
Samba provides Windows clients access to UNIX servers and UNIX clients access to
Windows servers. The access that is provided is for both files and other
services, including printer sharing. Samba's design, as well as constraint, is to operate
on top of a variety of existing UNIX systems. Samba runs as a
set of daemons and services, without any need for modification of existing kernels.
More information about Samba can be found at <a href="http://www.samba.org">http://www.samba.org</a>.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="gdsuo.html">Previous</a>
             </td>
             <td align="right">
                 <a href="gezpb.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

