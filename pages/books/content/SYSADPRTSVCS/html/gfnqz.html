<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Managing Network Device Discovery Services (Task Map) - System Administration Guide: Solaris Printing</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2009-01-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Solaris Printing</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ghopb.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ghola.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="vol2preface-11.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="printintro-1.html">1.&nbsp;&nbsp;Introduction to Printing in the Solaris Operating System</a></p>
<p class="toc level1 tocsp"><a href="printplan-1.html">2.&nbsp;&nbsp;Planning for Printing in the Solaris Operating System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="printsetup-33230.html">3.&nbsp;&nbsp;Setting Up Printing Services (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="printers-33230.html">4.&nbsp;&nbsp;Setting Up Printers (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="printadmin-15883.html">5.&nbsp;&nbsp;Administering Printers by Using Solaris Print Manager and LP Print Commands (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="proto-1.html">6.&nbsp;&nbsp;Administering Printers That Use Network Printing Protocols (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="printcust-66310.html">7.&nbsp;&nbsp;Customizing Printing Services and Printers (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="forms-1.html">8.&nbsp;&nbsp;Administering Character Sets, Filters, Forms, and Fonts (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ppdadmin-1.html">9.&nbsp;&nbsp;Administering Printers by Using the PPD File Management Utility (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="printdesktop-1.html">10.&nbsp;&nbsp;Setting Up and Administering Printers From the Desktop (Tasks)</a></p>
<p class="toc level2"><a href="ghopb.html">Introduction to the OpenSolaris Print Manager</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Managing Network Device Discovery Services (Task Map)</a></p>
</div>
<p class="toc level2"><a href="ghola.html">Managing Printers and Printer Queues (Task Map)</a></p>
<p class="toc level2"><a href="ghomo.html">Getting Started With the OpenSolaris Print Manager</a></p>
<p class="toc level2"><a href="gfnwy.html">Setting Up Printers by Using the OpenSolaris Print Manager</a></p>
<p class="toc level2"><a href="ghopy.html">Managing Printer Groups and Print Jobs (Task Map)</a></p>
<p class="toc level2"><a href="ghpbd.html">Managing Printer Groups</a></p>
<p class="toc level2"><a href="ghooh.html">Managing Print Jobs</a></p>
<p class="toc level2"><a href="ghphk.html">Managing Print Manager and Printer Preferences (Task Map)</a></p>
<p class="toc level2"><a href="ggbqt.html">Managing Print Manager and Printer Preferences</a></p>
<p class="toc level1 tocsp"><a href="printref-76596.html">11.&nbsp;&nbsp;Printing in the Solaris Operating System (Reference)</a></p>
<p class="toc level1 tocsp"><a href="tsprint-34397.html">12.&nbsp;&nbsp;Troubleshooting Printing Problems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fddwm.html">A.&nbsp;&nbsp;Using the Internet Printing Protocol</a></p>
<p class="toc level1 tocsp"><a href="gdqrm.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="gfnqz"></a><h3>Managing Network Device Discovery Services (Task Map)</h3>
<a name="indexterm-190"></a><a name="indexterm-191"></a><a name="indexterm-192"></a><table><col width="33%"><col width="33%"><col width="33%"><tr><th align="left" valign="top" scope="column"><p>Task</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>For Information</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Initiate the HAL add-on module for network device discovery.</p></td>
<td align="left" valign="top" scope="row"><p>Before the system
can actively scan the network for network&hyphen;attached printers, you must first initiate the
HAL add-on module that discovers devices on a network. You can enable this
service from the desktop or by using the <tt>svcadm</tt> command.</p></td>
<td align="left" valign="top" scope="row"><p> <a href="#gfznn">How to Enable the Network Device Discovery Service</a></p><p><a href="#gfzng">How to Initiate the Network Device Discovery Services by Using SMF</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Obtain information
about printers that are discovered by the system by using the command line.</p></td>
<td align="left" valign="top" scope="row"><p>You
might need to obtain information about printers that have been discovered by your
system. You can obtain this information by using the command line. The output
shows all of the devices that have been discovered by the system.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#gfnsb">How to Determine Which Printers Are Known to the System</a></p></td>
</tr>
</table>

<a name="gievo"></a><h4>How Auto&hyphen;Discovery of Devices Works</h4>
<p>Discovery of devices, including printers, is accomplished through the Hardware Abstraction Layer (HAL)
device registry (database) component. HAL uses D-BUS messaging to notify interested applications about
changes to its registry. <b>D-BUS</b> is a messaging bus that passes messages between applications
and broadcasts signals that interested applications are able to detect. This messaging service
is used by HAL and a number of other applications. HAL provides the
framework for device discovery and notification of device configuration changes on a system.
In the Solaris release, this support has been extended to detecting printers that
are added or removed from a local system.</p><p>The HAL daemon, <tt>hald</tt>, provides a view of devices that are attached to
a local system. This view is updated automatically, as a system's hardware configuration
changes, by hotplugging or by other methods. HAL's internal database, also called the
<b>HAL device tree</b>, is where device information is stored and maintained. HAL devices are uniquely identified
in the HAL database through a <b>Universal Device Identifier</b> (UDI). This database is populated with
properties of each device in the HAL database.</p><p>The automatic printing configuration feature works with the HAL daemon by listening for
<b>sysevents</b>. When a hotplug-capable printer is added to a system, HAL creates a
new node in the HAL device tree, as shown in the following example:</p><pre>/org/freedesktop/Hal/devices/pci_0_0/pci1022_74606/pci108e_534d_3_1/printer_2_0_if0/print</pre><p>When the device node has been successfully registered in the HAL database, HAL
signals interested applications that the device is available. Device removal works similarly.</p><p> For more information about HAL, see <a href="http://opensolaris.org/os/project/tamarack/">http://opensolaris.org/os/project/tamarack/</a>.</p><p>The network device discovery components are standard  service interfaces that are offered
by classes of network&hyphen;attached devices. This module is capable of actively scanning a
network for new devices. The service is directly controlled through the <tt>svcadm</tt> interface.
For more information, see the <a href="http://docs.sun.com/doc/819-2240/svcadm-1m?a=view"><tt>svcadm</tt>(1M)</a> man page. <a href="http://docs.sun.com/doc/819-2240/svcadm-1m?a=view"><tt>svcadm</tt>(1M)</a>. To determine the device type, an
active scan is performed through a Simple Network Management Protocol version 1 (SNMPv1)
broadcast. Be default, the SNMP based network&hyphen;attached printer discovery service probes the network for
printers every 60 seconds. This property is configurable. See <a href="ggbqt.html#gholw">Configuring Auto-Discovery Settings for Network-Attached Printers</a>. During this active
scan, SNMP determines the device type by attempting to connect to the device.</p>
<hr><p><b>Note - </b>Only active device discovery is available in this Solaris OS. Passive device discovery
through the Multicast DNS (mDNS) is not available.</p>
<hr>


<a name="ghorb"></a><h4>Adding Newly Discovered Printers From the Desktop</h4>
<a name="indexterm-193"></a><a name="indexterm-194"></a><a name="indexterm-195"></a><a name="indexterm-196"></a><a name="indexterm-197"></a><p>You can use OpenSolaris Print Manager to configure newly discovered directly attached or
newly discovered network&hyphen;attached printers from the desktop. By default, the system automatically discovers
directly attached USB printers. The system also discovers network&hyphen;attached printers, if the network device
discovery service has been enabled. See <a href="#gfznn">How to Enable the Network Device Discovery Service</a>.</p>
<ul><li><p><b>Adding a Directly Attached USB Printer</b></p><p>When a new USB printer is connected to the system and discovered , the Add Printer Queue dialog, populated with printer configuration data, automatically opens on the desktop. From here, you can modify the existing configuration information and then create the new printer queue. After the new printer queue is created, it appears in the Queue pane of the Print Manager window. For more information, see <a href="gfnwy.html#ghoqw">How To Set Up Auto-Discovered Printers by Using the OpenSolaris Print Manager</a>.</p></li>
<li><p><b>Adding a Network&hyphen;Attached Printer</b></p><p>Network&hyphen;attached printers are auto&hyphen;discovered the same way as directly attached printers. This support is designed and implemented through a HAL add-on module, <tt>/usr/lib/hal/hald-addon-network-discovery</tt>. When a new network&hyphen;attached printer is discovered by the system, a printer queue is automatically created. At the same time, a notification message is displayed next to a printer icon located in the panel notification area of the desktop. Clicking this notification message launches the OpenSolaris Print Manager application. From here, you can view or change the configuration data for the newly discovered network&hyphen;attached printer. To do so, select the printer queue in the Queue pane of the Print Manager window and choose Properties from the Printer menu. For more information, see <a href="gfnwy.html#ghoqw">How To Set Up Auto-Discovered Printers by Using the OpenSolaris Print Manager</a>.</p><p>To utilize the network device discovery feature, the following conditions must be met:</p>
<ul><li><p>The network device discovery service, <tt>network/device-discovery/printers:snmp</tt>, must be enabled.</p><p>You can enable this service from the desktop or by using SMF commands. For more information, see <a href="">Managing Network Device Discovery Services (Task Map)</a>.</p></li>
<li><p>Network&hyphen;attached printers must support SNMP queries, which means the device must be &ldquo;known&rdquo; to the system.</p><p>For more information, see <a href="#gfnsb">How to Determine Which Printers Are Known to the System</a>.</p></li>
<li><p>Network-attached printers must be on the same subnet as the system that is querying the network.</p><p>The service is not capable of discovering network-attached printers that are more than one hop away.</p></li>
<li><p>OpenSolaris Print Manager Preferences for desktop notifications of network printing events must be turned on.</p><p>For more information, see <a href="ggbqt.html">Managing Print Manager and Printer Preferences</a>.</p></li></ul>
</li></ul>

<hr><p><b>Note - </b>In the OpenSolaris 2008.11 release, attempts to enable the HAL add&hyphen;on module from
the desktop or by using SMF commands, cause the system to revert to
maintenance state. This problem does not occur if you are running a supported
Solaris Express Community Edition release. To enable this service in the OpenSolaris 2008.11
release, you must first install the SUNWSmmgr package. For detailed instructions, go to
<a href="http://www.opensolaris.org/os/project/indiana/resources/relnotes/200811/x86/">http://www.opensolaris.org/os/project/indiana/resources/relnotes/200811/x86/</a>.</p>
<hr>


<a name="ghoqj"></a><h4>Notification of Printing Events in the Desktop</h4>
<a name="indexterm-198"></a><a name="indexterm-199"></a><a name="indexterm-200"></a><p>The panel notification icon is a printer icon that is displayed in
panel notification area of the desktop to notify you when:</p>
<ul><li><p>One or more print jobs are processing</p></li>
<li><p>One or more printers have been discovered</p></li></ul>
<p>To get more information, click the printer icon.</p>
<ul><li><p>If one or more print jobs are processing normally, a Job List window opens for each printer queue that has a pending print job.</p></li>
<li><p>If one or more printer queues have been discovered, the Printer Queue Properties dialog or the Print Manager application opens, allowing you to check the configuration of the new printer queues.</p></li></ul>

<hr><p><b>Note - </b>Notification messages that are not manually closed disappear after 5 seconds.</p>
<hr>
<p>Preferences for notification messages can be viewed and changed in the Printer Preferences
dialog. For more information, see <a href="ggbqt.html">Managing Print Manager and Printer Preferences</a>.</p>

<a name="gholb"></a><h4>Panel Notification Icon Context Menu</h4>
<a name="indexterm-201"></a><a name="indexterm-202"></a><a name="indexterm-203"></a><p>The following table describes the menu items that are available when you right-click
the panel notification icon.</p><table><col width="49%"><col width="50%"><tr><th align="left" valign="top" scope="column"><p>When Print Jobs Are Processing Normally</p></th>
<th align="left" valign="top" scope="column"><p>When Printers/Queues Are Discovered</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><b>Show Queue:</b>
Opens a Job List window for each queue in which you have a
pending print job.</p></td>
<td align="left" valign="top" scope="row"><p><b>Open Print Manager:</b> opens the Print Manager window, with the All Printers group
selected, and all new queues selected within the group.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><i>queuename</i> <b>Properties:</b> Opens the associated Printer
Properties window.</p></td>
<td align="left" valign="top" scope="row"><p><i>queue&hyphen;name</i> <b>Properties:</b> Opens the associated Printer Properties window. Hidden if more than
one new queue was discovered.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><b>Print Manager Preferences:</b> Opens the Print Manager Preferences dialog.</p></td>
<td align="left" valign="top" scope="row"><p><b>Print Manager Preferences:</b> Opens the Print
Manager Preferences dialog.</p></td>
</tr>
</table><p>For more information about viewing or changes preferences for notifications, see <a href="ggbqt.html">Managing Print Manager and Printer Preferences</a>.</p>

<a name="gfznn"></a><h4>How to Enable the Network Device Discovery Service</h4><p>By default, the OpenSolaris Print Manager automatically discovers and configures USB printers that
are directly connected to your system. Print Manager also has the ability to
discover and configure printers that are on a network after the network device
discovery service has been enabled.</p>
<hr><p><b>Note - </b>Note that in the OpenSolaris 2008.11 release, this service cannot be enabled from
the desktop until you install the SUNWSmmgr package. If you attempt to enable
the service before installing this package, the system reverts to maintenance state. For
detailed instructions, go to <a href="http://www.opensolaris.org/os/project/indiana/resources/relnotes/200811/x86/">http://www.opensolaris.org/os/project/indiana/resources/relnotes/200811/x86/</a>.</p>
<hr>
<ol>
<li><b>From the Main Menubar, select:</b><p>System-&gt; Administration-&gt; Services</p><p>The Services settings window is displayed.</p></li>
<li><b>To initiate the device discovery add-on module, select the Hardware Abstraction Layer network&hyphen;attached
printer discovery (<tt>network/device-discovery/printers:snmp</tt>) option.</b></li>
<li><b>Save your changes.</b><p>To disable auto&hyphen;discovery of devices, deselect this option.</p></li></ol>

<a name="gfzng"></a><h4>How to Initiate the Network Device Discovery Services by Using SMF</h4><a name="indexterm-204"></a><a name="indexterm-205"></a><a name="indexterm-206"></a><a name="indexterm-207"></a><p>This procedure describes how to initiate, as well as disable, the network
<tt>device-discovery/printers</tt> service (the HAL add-on module) by using the SMF.</p><ol>
<li><b>Become superuser or assume an equivalent role.</b></li>
<li><b>Determine whether the SMF <tt>device-discovery/printers</tt> service is online.</b><pre># <tt><b>svcs device-discovery/printers</b></tt></pre><p>If the service is online, the following output is displayed:</p><pre>STATE          STIME    FMRI
online         13:30:22 svc:/network/device-discovery/printers:snmp</pre><p>If the service is offline, the following output is displayed:</p><pre>STATE          STIME    FMRI
disabled       Dec_12   svc:/network/device-discovery/printers:snmp</pre></li>
<li><b>To enable or disable the service instance, use the appropriate command.</b><ul>
<li><b>To enable the service, type:</b><pre># <tt><b>svcadm enable printers:snmp</b></tt></pre></li>
<li><b>To disable the service, type:</b><pre># <tt><b>svcadm disable printers:snmp</b></tt></pre></li></ul></li>
<li><b>Verify that the HAL add-on module has been enabled or disabled.</b><p>If the module has been successfully enabled, the output is as follows:</p><pre># <tt><b>svcs device-discovery/printers</b></tt>
STATE          STIME    FMRI
online         13:30:22 svc:/network/device-discovery/printers:snmp </pre><p>If the module has been successfully disabled, the output is as follows:</p><pre># <tt><b>svcs device-discovery/printers</b></tt>
STATE          STIME    FMRI
disabled       Dec_12   svc:/network/device-discovery/printers:snmp</pre></li></ol>

<a name="gfnsb"></a><h4>How to Determine Which Printers Are Known to the System</h4><a name="indexterm-208"></a><a name="indexterm-209"></a><ul>
<li><b>On the system that you want to get information about discovered printers, type:</b><pre>system% <tt><b>hal-find-by-capability --capability printer</b></tt></pre><p>The output shows you all of the printers that have been discovered
by the system.</p><ul>
<li><b>To obtain additional details about discovered printers, type:</b><pre>zsh% <tt><b>for udi in $(hal-find-by-capability --capability printer) ; do ; lshal --show $udi --long ; done</b></tt></pre><p>Or, if you are using a shell that does not support the
use of <tt><b>$(</tt><i>command</i><tt>)</b></tt>, type:</p><pre>sh% <tt><b>for udi in `hal-find-by-capability --capability printer` ; do ; lshal --show $udi --long ; done</b></tt></pre></li></ul></li></ul><a name="gfnrh"></a><h6>Example&nbsp;10-1 Determining Which Printers Are Known to the System</h6><p>This example shows all of the devices discovered by the system, <tt>snoopy</tt>.</p><pre>snoopy% <tt><b>hal-find-by-capability --capability printer</b></tt>
/org/freedesktop/Hal/devices/pci_0_0/pci1022_7460_6/pci108e_534d_3_1/printer_2_printer_0
    snoopy%</pre><a name="gfohl"></a><h6>Example&nbsp;10-2 Obtaining Additional Details about Printers That Are Known to the System</h6><a name="indexterm-210"></a><pre>    zsh% <tt><b>for udi in $(hal-find-by-capability --capability printer) ; \ do ; lshal --show $udi --long ; done udi = \ '/org/freedesktop/Hal/devices/pci_0_0/pci1022_\ 7460_6/pci108e_534d_3_1/printer_2_printer_0'</b></tt>
      info.claimed.uid = 24656  (0x6050)  (int)
      info.claimed.service = 'gnome-volume-manager'  (string)
      info.claimed = true  (bool)
      printer.commandset = {'PJL', 'MLC', 'BIDI-ECP', 'PCLXL', 'PCL',
    'PDF', 'PJL', 'MIME', 'POSTSCRIPT'} (string list)
      printer.description = 'Hewlett-Packard color LaserJet 4650'  (string)
      printer.serial = '00000D920NSL'  (string)
      printer.product = 'hp color LaserJet 4650'  (string)
      printer.vendor = 'Hewlett-Packard'  (string)
      printer.device = '/dev/printers/1'  (string)
      info.capabilities = {'printer'} (string list)
      info.category = 'printer'  (string)
      info.solaris.driver = 'usbprn'  (string)
      solaris.devfs_path =
    '/pci@0,0/pci1022,7460@6/pci108e,534d@3,1/printer@2:printer'  (string)
      info.product = 'printer'  (string)
      info.udi =
    '/org/freedesktop/Hal/devices/pci_0_0/pci1022_7460_6/pci108e_534d_3_1/printer_2_printer_0'...)
      info.parent =
    '/org/freedesktop/Hal/devices/pci_0_0/pci1022_7460_6/pci108e_534d_3_1/printer_2_if0_0'...)

    zsh%</pre>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ghopb.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ghola.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

