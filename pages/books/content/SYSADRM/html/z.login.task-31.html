<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Performing the Initial Internal Zone Configuration - System Administration Guide:  Virtualization Using the Solaris Operating System</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-04-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide:  Virtualization Using the Solaris Operating System</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="z.login.task-52.html">Previous</a>
             </td>
             <td align="right">
                 <a href="z.login.task-2.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="preface-3.html">Solaris Virtualization Product Overview</a></p>
<p class="toc level1 tocsp"><a href="resource.html">Part&nbsp;I&nbsp;Resource Management</a></p>
<p class="toc level2"><a href="rmintro-1.html">1.&nbsp;&nbsp;Introduction to Solaris Resource Management</a></p>
<p class="toc level2"><a href="rmtaskproj-1.html">2.&nbsp;&nbsp;Projects and Tasks (Overview)</a></p>
<p class="toc level2"><a href="rmtaskproj.task-37.html">3.&nbsp;&nbsp;Administering Projects and Tasks</a></p>
<p class="toc level2"><a href="rmacct-1.html">4.&nbsp;&nbsp;Extended Accounting (Overview)</a></p>
<p class="toc level2"><a href="rmacct.task.sgm.html">5.&nbsp;&nbsp;Administering Extended Accounting (Tasks)</a></p>
<p class="toc level2"><a href="rmctrls-1.html">6.&nbsp;&nbsp;Resource Controls (Overview)</a></p>
<p class="toc level2"><a href="rmctrls.task-1.html">7.&nbsp;&nbsp;Administering Resource Controls (Tasks)</a></p>
<p class="toc level2"><a href="rmfss-1.html">8.&nbsp;&nbsp;Fair Share Scheduler (Overview)</a></p>
<p class="toc level2"><a href="rmfss.task-1.html">9.&nbsp;&nbsp;Administering the Fair Share Scheduler (Tasks)</a></p>
<p class="toc level2"><a href="rm.rcapd-1.html">10.&nbsp;&nbsp;Physical Memory Control Using the Resource Capping Daemon (Overview)</a></p>
<p class="toc level2"><a href="rm.rcapd.task-1.html">11.&nbsp;&nbsp;Administering the Resource Capping Daemon (Tasks)</a></p>
<p class="toc level2"><a href="rmpool-1.html">12.&nbsp;&nbsp;Resource Pools (Overview)</a></p>
<p class="toc level2"><a href="rmpool.task-1.html">13.&nbsp;&nbsp;Creating and Administering Resource Pools (Tasks)</a></p>
<p class="toc level2"><a href="rmconfig-1.html">14.&nbsp;&nbsp;Resource Management Configuration Example</a></p>
<p class="toc level2"><a href="rmconsole-1.html">15.&nbsp;&nbsp;Resource Control Functionality in the Solaris Management Console</a></p>
<p class="toc level1 tocsp"><a href="zone.html">Part&nbsp;II&nbsp;Zones</a></p>
<p class="toc level2"><a href="zones.intro-1.html">16.&nbsp;&nbsp;Introduction to Solaris Zones</a></p>
<p class="toc level2"><a href="z.config.ov-1.html">17.&nbsp;&nbsp;Non-Global Zone Configuration (Overview)</a></p>
<p class="toc level2"><a href="z.conf.start-1.html">18.&nbsp;&nbsp;Planning and Configuring Non-Global Zones (Tasks)</a></p>
<p class="toc level2"><a href="z.inst.ov-1.html">19.&nbsp;&nbsp;About Installing, Halting, Cloning, and Uninstalling Non-Global Zones (Overview)</a></p>
<p class="toc level2"><a href="z.inst.task-1.html">20.&nbsp;&nbsp;Installing, Booting, Halting, Uninstalling,  and Cloning Non-Global Zones (Tasks)</a></p>
<p class="toc level2"><a href="z.login.ov-1.html">21.&nbsp;&nbsp;Non-Global Zone Login (Overview)</a></p>
<p class="toc level2"><a href="z.login.task-1.html">22.&nbsp;&nbsp;Logging In to Non-Global Zones (Tasks)</a></p>
<p class="toc level3"><a href="z.login.task-52.html">Initial Zone Boot and Zone Login Procedures (Task Map)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Performing the Initial Internal Zone Configuration</a></p>
<p class="toc level4"><a href="#z.login.task-32">How to Log In to the Zone Console to Perform the Internal Zone Configuration</a></p>
<p class="toc level4"><a href="#z.login.task-38">How to Use an <tt>/etc/sysidcfg</tt> File to Perform the Initial Zone Configuration</a></p>
</div>
<p class="toc level3 tocsp"><a href="z.login.task-2.html">Logging In to a Zone</a></p>
<p class="toc level4"><a href="z.login.task-2.html#z.login.task-3">How to Log In to the Zone Console</a></p>
<p class="toc level4"><a href="z.login.task-2.html#z.login.task-9">How to Use Interactive Mode to Access a Zone</a></p>
<p class="toc level4"><a href="z.login.task-2.html#z.login.task-14">How to Use Non-Interactive Mode to Access a Zone</a></p>
<p class="toc level4"><a href="z.login.task-2.html#fpcft">How to Exit a Non-Global Zone</a></p>
<p class="toc level4"><a href="z.login.task-2.html#z.login.task-19">How to Use Failsafe Mode to Enter a Zone</a></p>
<p class="toc level4"><a href="z.login.task-2.html#z.login.task-25">How to Use <tt>zlogin</tt> to Shut Down a Zone</a></p>
<p class="toc level3 tocsp"><a href="gdpau.html">Switching the Non-Global Zone to a Different Networking Service Configuration</a></p>
<p class="toc level4"><a href="gdpau.html#gdpaw">How to Switch the Zone to the Open Networking Service Configuration</a></p>
<p class="toc level4"><a href="gdpau.html#gdpbe">How to Enable a Specific Service in a Zone</a></p>
<p class="toc level3 tocsp"><a href="z.login.task-49.html">Printing the Name of the Current Zone</a></p>
<p class="toc level2 tocsp"><a href="gcgnc.html">23.&nbsp;&nbsp;Moving and Migrating Non-Global Zones (Tasks)</a></p>
<p class="toc level2"><a href="z.pkginst.ov-1.html">24.&nbsp;&nbsp;About Packages and Patches on a Solaris System With Zones Installed (Overview)</a></p>
<p class="toc level2"><a href="z.pkginst.task-1.html">25.&nbsp;&nbsp;Adding and Removing Packages and Patches on a Solaris System With Zones Installed (Tasks)</a></p>
<p class="toc level2"><a href="z.admin.ov-1.html">26.&nbsp;&nbsp;Solaris Zones Administration (Overview)</a></p>
<p class="toc level2"><a href="z.admin.task-1.html">27.&nbsp;&nbsp;Administering Solaris Zones (Tasks)</a></p>
<p class="toc level2"><a href="gclkx.html">28.&nbsp;&nbsp;Troubleshooting Miscellaneous Solaris Zones Problems</a></p>
<p class="toc level1 tocsp"><a href="gchhk.html">Part&nbsp;III&nbsp;Branded Zones</a></p>
<p class="toc level2"><a href="gchhy.html">29.&nbsp;&nbsp;About Branded Zones and the Linux Branded Zone</a></p>
<p class="toc level2"><a href="gcwwm.html">30.&nbsp;&nbsp;Planning the <tt>lx</tt> Branded Zone Configuration (Overview)</a></p>
<p class="toc level2"><a href="gdajn.html">31.&nbsp;&nbsp;Configuring the <tt>lx</tt> Branded Zone (Tasks)</a></p>
<p class="toc level2"><a href="gdbki.html">32.&nbsp;&nbsp;About Installing, Booting, Halting, Cloning, and Uninstalling <tt>lx</tt> Branded Zones (Overview)</a></p>
<p class="toc level2"><a href="gdduh.html">33.&nbsp;&nbsp;Installing, Booting, Halting, Uninstalling and Cloning <tt>lx</tt> Branded Zones (Tasks)</a></p>
<p class="toc level2"><a href="gdgck.html">34.&nbsp;&nbsp;Logging In to <tt>lx</tt> Branded Zones (Tasks)</a></p>
<p class="toc level2"><a href="gdqnv.html">35.&nbsp;&nbsp;Moving and Migrating <tt>lx</tt> Branded Zones (Tasks)</a></p>
<p class="toc level2"><a href="gdgif.html">36.&nbsp;&nbsp;Administering and Running Applications in <tt>lx</tt> Branded Zones (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="gefwp.html">Part&nbsp;IV&nbsp;Sun xVM</a></p>
<p class="toc level2"><a href="gfwrc.html">37.&nbsp;&nbsp;Sun xVM Hypervisor System Requirements</a></p>
<p class="toc level2"><a href="gefwo.html">38.&nbsp;&nbsp;Booting and Running the Sun xVM Hypervisor</a></p>
<p class="toc level2"><a href="gfwcu.html">39.&nbsp;&nbsp;Xvnc</a></p>
<p class="toc level2"><a href="gfqke.html">40.&nbsp;&nbsp;Using <tt>virt-install</tt> to Install a Domain</a></p>
<p class="toc level2"><a href="gfwlm.html">41.&nbsp;&nbsp;xVM System Administration</a></p>
<p class="toc level2"><a href="gefzh.html">42.&nbsp;&nbsp;Troubleshooting Miscellaneous Sun xVM Problems</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="z.login.task-31"></a><h3>Performing the Initial Internal Zone Configuration</h3>
<p>You must configure the zone using one of the following methods:</p>
<ul><li><p>Log into the zone and configure it as described in <a href="z.login.ov-14.html">Internal Zone Configuration</a>.</p></li>
<li><p>Configure the zone using an <tt>/etc/sysidcfg</tt> file as described in <a href="#z.login.task-38">How to Use an <tt>/etc/sysidcfg</tt> File to Perform the Initial Zone Configuration</a>.</p></li></ul>

<hr><p><b>Tip - </b>After you have performed the internal configuration, it is a good idea to
make a copy of the non-global zone's configuration. You can use this backup
to restore the zone in the future. As superuser or Primary Administrator, print
the configuration for the zone <tt>my-zone</tt> to a file. This example uses a
file named <tt>my-zone.config</tt>.</p><pre>global# <tt><b>zonecfg -z my-zone export > my-zone.config</b></tt></pre><p>See <a href="gbrmv.html#gbrmi">How to Restore an Individual Non-Global Zone</a> for more information.</p>
<hr>


<a name="z.login.task-32"></a><h4>How to Log In to the Zone Console to Perform the Internal Zone Configuration</h4><p>You must be the global administrator in the global zone to perform
this procedure.</p><ol>
<li><a name="z.login.task-step-34"></a><b>Become superuser, or assume the Primary Administrator role.</b><p>To create the role and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-95?a=view">Using the Solaris Management Tools With RBAC (Task Map) in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="z.login.task-step-35"></a><b>Use the <tt>zlogin</tt> command with the <tt>-C</tt> option and the name of the
zone, <tt>my-zone</tt> in this procedure.</b><pre>global# <tt><b>zlogin -C my-zone</b></tt></pre></li>
<li><b>From another terminal window, boot the zone.</b><pre>global# <tt><b>zoneadm -z my-zone boot</b></tt></pre><p>You will see a display similar to the following in the <tt>zlogin</tt>
window:</p><pre>[NOTICE: Zone booting up]</pre></li>
<li><a name="z.login.task-step-36"></a><b>The first time you log in to the console, you are prompted to
answer a series of questions. Your screen will look similar to this:</b><pre>SunOS Release 5.10 Version Generic 64-bit
Copyright 1983-2006 Sun Microsystems, Inc.  All rights reserved.
Use is subject to license terms.
Hostname: my-zone
Loading smf(5) service descriptions: 114/114
Select a Language
     1. English
     2. es
     2. fr

Please make a choice (1 - 3), or press h or ? for help:

Select a Locale

      1. English (C - 7-bit ASCII)
      2. Canada (English) (UTF-8)
      4. U.S.A. (UTF-8)
      5. U.S.A. (en_US.ISO8859-1)
      6. U.S.A. (en_US.ISO8859-15)
      7. Go Back to Previous Screen
      
Please make a choice (1 - 7), or press h or ? for help:

What type of terminal are you using?
      1) ANSI Standard CRT
      2) DEC VT52
      3) DEC VT100
      4) Heathkit 19
      5) Lear Siegler ADM31
      6) PC Console
      7) Sun Command Tool
      8) Sun Workstation
      9) Televideo 910
      10) Televideo 925
      11) Wyse Model 50
      12) X Terminal Emulator (xterms)
      13) CDE Terminal Emulator (dtterm)
      14) Other
Type the number of your choice and press Return:
<tt><b>13</b></tt>
.
.
.</pre><p>For the complete list of questions you must answer, see <a href="z.login.ov-14.html">Internal Zone Configuration</a>.</p></li>
<li><a name="z.login.task-step-53"></a><b>(Optional) If you are not using two windows as described in step 3,
you might have missed the initial prompt for configuration information. If you see
the following system message at zone login instead of a prompt:</b><pre>[connected to zone <i>zonename</i> console]</pre><p>Press Return to display the prompt again.</p><p>If you enter an incorrect response and try to restart the configuration, you
might experience difficulty when you attempt the process again. This occurs because the
<tt>sysidtools</tt> can store your previous responses.</p><p>If this happens, use the following workaround from the global zone to restart
the configuration process.</p><pre>global# <tt><b>zlogin -S </tt><i>zonename</i><tt> /usr/sbin/sys-unconfig</b></tt></pre><p>For more information on the <tt>sys-unconfig</tt> command, see the <a href="http://docs.sun.com/doc/819-2240/sys-unconfig-1m?a=view"><tt>sys-unconfig</tt>(1M)</a> man page.</p></li></ol>

<a name="z.login.task-38"></a><h4>How to Use an <tt>/etc/sysidcfg</tt> File to Perform the Initial Zone Configuration</h4><p>You must be the global administrator in the global zone to perform
this procedure.</p><ol>
<li><a name="z.login.task-step-47"></a><b>Become superuser, or assume the Primary Administrator role.</b><p>To create the role and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-95?a=view">Using the Solaris Management Tools With RBAC (Task Map) in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b>From the global zone, change directories to the non-global zone's <tt>/etc</tt> directory:</b><pre>global# <tt><b>cd /export/home/my-zone/root/etc</b></tt></pre></li>
<li><a name="z.login.task-step-46"></a><b>Create the <tt>sysidcfg</tt> file and place it in this directory.</b><p>The file will look similar to the following:</p><ul>
<li><b>For a shared-IP zone:</b><pre>system_locale=C
terminal=dtterm
network_interface=primary {
            hostname=my-zone
}
security_policy=NONE
name_service=NIS {
            domain_name=special.example.com
            name_server=bird(192.168.112.3)
}
timezone=US/Central
root_password=m4qtoWN</pre></li>
<li><b>For an exclusive-IP zone with a static IP configuration:</b><pre>system_locale=C
terminal=dtterm
network_interface=primary {
         hostname=my-zone
         default_route=10.10.10.1
         ip_address=10.10.10.13
         netmask=255.255.255.0
}
timezone=US/Central
root_password=m4qtoWN</pre></li>
<li><b>For an exclusive-IP zone with DHCP and IPv6 option:</b><pre>system_locale=C
terminal=dtterm
network_interface=primary {
            dhcp protocol_ipv6=yes
}
security_policy=NONE
name_service=DNS {
         domain_name=example.net
         name_server=192.168.224.11,192.168.224.33
}
timezone=US/Central
root_password=m4qtoWN</pre></li></ul></li>
<li><b>By default, a separate module will request the NFSv4 domain parameter used by
the <tt>nfsmapid</tt> command. To complete a hands-off initial zone configuration, edit the file
<tt>default/nfs</tt>, uncomment the <tt>NFSMAPID_DOMAIN</tt> parameter, and set the domain to the desired NFSv4 domain:</b><pre>global# <tt><b>vi default/nfs</b></tt>
        .
        .
        .
        NFSMAPID_DOMAIN=<i>domain</i></pre><p>For more information on the NFSv4 domain parameter, see the <a href="http://docs.sun.com/doc/819-2240/nfsmapid-1m?a=view"><tt>nfsmapid</tt>(1M)</a> man
page.</p></li>
<li><b>Create the file <tt>.NFS4inst_state.domain</tt> in this directory to indicate that the NFSv4 domain
has been set:</b><pre>global# <tt><b>touch .NFS4inst_state.domain</b></tt></pre></li>
<li><a name="z.login.task-step-48"></a><b>Boot the zone.</b></li></ol><h6>See Also</h6><p>See the <a href="http://docs.sun.com/doc/819-2251/sysidcfg-4?a=view"><tt>sysidcfg</tt>(4)</a> man page for more information.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="z.login.task-52.html">Previous</a>
             </td>
             <td align="right">
                 <a href="z.login.task-2.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

