<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>CPU Share Examples - System Administration Guide:  Virtualization Using the Solaris Operating System</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-04-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide:  Virtualization Using the Solaris Operating System</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="rmfss-6.html">Previous</a>
             </td>
             <td align="right">
                 <a href="rmfss-14.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="preface-3.html">Solaris Virtualization Product Overview</a></p>
<p class="toc level1 tocsp"><a href="resource.html">Part&nbsp;I&nbsp;Resource Management</a></p>
<p class="toc level2"><a href="rmintro-1.html">1.&nbsp;&nbsp;Introduction to Solaris Resource Management</a></p>
<p class="toc level2"><a href="rmtaskproj-1.html">2.&nbsp;&nbsp;Projects and Tasks (Overview)</a></p>
<p class="toc level2"><a href="rmtaskproj.task-37.html">3.&nbsp;&nbsp;Administering Projects and Tasks</a></p>
<p class="toc level2"><a href="rmacct-1.html">4.&nbsp;&nbsp;Extended Accounting (Overview)</a></p>
<p class="toc level2"><a href="rmacct.task.sgm.html">5.&nbsp;&nbsp;Administering Extended Accounting (Tasks)</a></p>
<p class="toc level2"><a href="rmctrls-1.html">6.&nbsp;&nbsp;Resource Controls (Overview)</a></p>
<p class="toc level2"><a href="rmctrls.task-1.html">7.&nbsp;&nbsp;Administering Resource Controls (Tasks)</a></p>
<p class="toc level2"><a href="rmfss-1.html">8.&nbsp;&nbsp;Fair Share Scheduler (Overview)</a></p>
<p class="toc level3"><a href="rmfss-2.html">Introduction to the Scheduler</a></p>
<p class="toc level3"><a href="rmfss-4.html">CPU Share Definition</a></p>
<p class="toc level3"><a href="rmfss-5.html">CPU Shares and Process State</a></p>
<p class="toc level3"><a href="rmfss-6.html">CPU Share Versus Utilization</a></p>
<div class="onpage">
<p class="toc level3"><a href="">CPU Share Examples</a></p>
</div>
<p class="toc level3"><a href="rmfss-14.html">FSS Configuration</a></p>
<p class="toc level3"><a href="rmfss-19.html">FSS and Processor Sets</a></p>
<p class="toc level3"><a href="rmfss-17.html">Combining FSS With Other Scheduling Classes</a></p>
<p class="toc level3"><a href="rmfss-21.html">Setting the Scheduling Class for the System</a></p>
<p class="toc level3"><a href="rmfss-22.html">Scheduling Class on a System with Zones Installed</a></p>
<p class="toc level3"><a href="rmfss-20.html">Commands Used With FSS</a></p>
<p class="toc level2 tocsp"><a href="rmfss.task-1.html">9.&nbsp;&nbsp;Administering the Fair Share Scheduler (Tasks)</a></p>
<p class="toc level2"><a href="rm.rcapd-1.html">10.&nbsp;&nbsp;Physical Memory Control Using the Resource Capping Daemon (Overview)</a></p>
<p class="toc level2"><a href="rm.rcapd.task-1.html">11.&nbsp;&nbsp;Administering the Resource Capping Daemon (Tasks)</a></p>
<p class="toc level2"><a href="rmpool-1.html">12.&nbsp;&nbsp;Resource Pools (Overview)</a></p>
<p class="toc level2"><a href="rmpool.task-1.html">13.&nbsp;&nbsp;Creating and Administering Resource Pools (Tasks)</a></p>
<p class="toc level2"><a href="rmconfig-1.html">14.&nbsp;&nbsp;Resource Management Configuration Example</a></p>
<p class="toc level2"><a href="rmconsole-1.html">15.&nbsp;&nbsp;Resource Control Functionality in the Solaris Management Console</a></p>
<p class="toc level1 tocsp"><a href="zone.html">Part&nbsp;II&nbsp;Zones</a></p>
<p class="toc level2"><a href="zones.intro-1.html">16.&nbsp;&nbsp;Introduction to Solaris Zones</a></p>
<p class="toc level2"><a href="z.config.ov-1.html">17.&nbsp;&nbsp;Non-Global Zone Configuration (Overview)</a></p>
<p class="toc level2"><a href="z.conf.start-1.html">18.&nbsp;&nbsp;Planning and Configuring Non-Global Zones (Tasks)</a></p>
<p class="toc level2"><a href="z.inst.ov-1.html">19.&nbsp;&nbsp;About Installing, Halting, Cloning, and Uninstalling Non-Global Zones (Overview)</a></p>
<p class="toc level2"><a href="z.inst.task-1.html">20.&nbsp;&nbsp;Installing, Booting, Halting, Uninstalling,  and Cloning Non-Global Zones (Tasks)</a></p>
<p class="toc level2"><a href="z.login.ov-1.html">21.&nbsp;&nbsp;Non-Global Zone Login (Overview)</a></p>
<p class="toc level2"><a href="z.login.task-1.html">22.&nbsp;&nbsp;Logging In to Non-Global Zones (Tasks)</a></p>
<p class="toc level2"><a href="gcgnc.html">23.&nbsp;&nbsp;Moving and Migrating Non-Global Zones (Tasks)</a></p>
<p class="toc level2"><a href="z.pkginst.ov-1.html">24.&nbsp;&nbsp;About Packages and Patches on a Solaris System With Zones Installed (Overview)</a></p>
<p class="toc level2"><a href="z.pkginst.task-1.html">25.&nbsp;&nbsp;Adding and Removing Packages and Patches on a Solaris System With Zones Installed (Tasks)</a></p>
<p class="toc level2"><a href="z.admin.ov-1.html">26.&nbsp;&nbsp;Solaris Zones Administration (Overview)</a></p>
<p class="toc level2"><a href="z.admin.task-1.html">27.&nbsp;&nbsp;Administering Solaris Zones (Tasks)</a></p>
<p class="toc level2"><a href="gclkx.html">28.&nbsp;&nbsp;Troubleshooting Miscellaneous Solaris Zones Problems</a></p>
<p class="toc level1 tocsp"><a href="gchhk.html">Part&nbsp;III&nbsp;Branded Zones</a></p>
<p class="toc level2"><a href="gchhy.html">29.&nbsp;&nbsp;About Branded Zones and the Linux Branded Zone</a></p>
<p class="toc level2"><a href="gcwwm.html">30.&nbsp;&nbsp;Planning the <tt>lx</tt> Branded Zone Configuration (Overview)</a></p>
<p class="toc level2"><a href="gdajn.html">31.&nbsp;&nbsp;Configuring the <tt>lx</tt> Branded Zone (Tasks)</a></p>
<p class="toc level2"><a href="gdbki.html">32.&nbsp;&nbsp;About Installing, Booting, Halting, Cloning, and Uninstalling <tt>lx</tt> Branded Zones (Overview)</a></p>
<p class="toc level2"><a href="gdduh.html">33.&nbsp;&nbsp;Installing, Booting, Halting, Uninstalling and Cloning <tt>lx</tt> Branded Zones (Tasks)</a></p>
<p class="toc level2"><a href="gdgck.html">34.&nbsp;&nbsp;Logging In to <tt>lx</tt> Branded Zones (Tasks)</a></p>
<p class="toc level2"><a href="gdqnv.html">35.&nbsp;&nbsp;Moving and Migrating <tt>lx</tt> Branded Zones (Tasks)</a></p>
<p class="toc level2"><a href="gdgif.html">36.&nbsp;&nbsp;Administering and Running Applications in <tt>lx</tt> Branded Zones (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="gefwp.html">Part&nbsp;IV&nbsp;Sun xVM</a></p>
<p class="toc level2"><a href="gfwrc.html">37.&nbsp;&nbsp;Sun xVM Hypervisor System Requirements</a></p>
<p class="toc level2"><a href="gefwo.html">38.&nbsp;&nbsp;Booting and Running the Sun xVM Hypervisor</a></p>
<p class="toc level2"><a href="gfwcu.html">39.&nbsp;&nbsp;Xvnc</a></p>
<p class="toc level2"><a href="gfqke.html">40.&nbsp;&nbsp;Using <tt>virt-install</tt> to Install a Domain</a></p>
<p class="toc level2"><a href="gfwlm.html">41.&nbsp;&nbsp;xVM System Administration</a></p>
<p class="toc level2"><a href="gefzh.html">42.&nbsp;&nbsp;Troubleshooting Miscellaneous Sun xVM Problems</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="rmfss-7"></a><h3>CPU Share Examples</h3>
<p>Assume you have a system with two CPUs running two parallel CPU-bound workloads
called <i>A</i> and <i>B</i>, respectively. Each workload is running as a separate project.
The projects have been configured so that project <i>A</i> is assigned <i>S</i><sub><i>A</i></sub> shares, and
project <i>B</i> is assigned <i>S</i><sub><i>B</i></sub> shares.</p><p>On average, under the traditional TS scheduler, each of the workloads that is
running on the system would be given the same amount of CPU
resources. Each workload would get 50 percent of the system's capacity.</p><p>When run under the control of the FSS scheduler with <i>S</i><sub><i>A</i></sub>=<i>S</i><sub><i>B</i></sub>, these
projects are also given approximately the same amounts of CPU resources. However, if
the projects are given different numbers of shares, their CPU resource allocations are
different.</p><p>The next three examples illustrate how shares work in different configurations. These examples
show that shares are only mathematically accurate for representing the usage if demand
meets or exceeds available resources.</p>

<a name="rmfss-10"></a><h4>Example 1: Two CPU-Bound Processes in Each Project</h4>
<p>If <i>A</i> and <i>B</i> each have two CPU-bound processes, and <i>S</i><sub><i>A</i></sub> = <i>1</i>
and <i>S</i><sub><i>B</i></sub> = <i>3</i>, then the total number of shares is 1 +
3 = 4. In this configuration, given sufficient CPU demand, projects <i>A</i> and
<i>B</i> are allocated 25 percent and 75 percent of CPU resources, respectively.</p><img src="figures/rmschedex1.gif" alt="Illustration. The context describes the graphic."></img>

<a name="rmfss-9"></a><h4>Example 2: No Competition Between Projects</h4>
<p>If <i>A</i> and <i>B</i> have only <b>one</b> CPU-bound process each, and <i>S</i><sub><i>A</i></sub> =
<i>1</i> and <i>S</i><sub><i>B</i></sub> = <i>100</i>, then the total number of shares is 101.
Each project cannot use more than one CPU because each project has only
one running process. Because no competition exists between projects for CPU resources in
this configuration, projects <i>A</i> and <i>B</i> are each allocated 50 percent of
all CPU resources. In this configuration, CPU share values are irrelevant. The projects'
allocations would be the same (50/50), even if both projects were assigned zero
shares.</p><img src="figures/rmschedex2.gif" alt="Illustration. The context describes the graphic."></img>

<a name="rmfss-8"></a><h4>Example 3: One Project Unable to Run</h4>
<p>If <i>A</i> and <i>B</i> have two CPU-bound processes each, and project <i>A</i> is given
1 share and project <i>B</i> is given 0 shares, then project <i>B</i> is
not allocated any CPU resources and project <i>A</i> is allocated all CPU resources.
Processes in <i>B</i> always run at system priority 0, so they will never be
able to run because processes in project  <i>A</i> always have higher priorities.</p><img src="figures/rmschedex3.gif" alt="Illustration. The context describes the graphic."></img>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="rmfss-6.html">Previous</a>
             </td>
             <td align="right">
                 <a href="rmfss-14.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

