<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>About Adding Packages in Zones - System Administration Guide:  Virtualization Using the Solaris Operating System</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-04-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide:  Virtualization Using the Solaris Operating System</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="gdzlv.html">Previous</a>
             </td>
             <td align="right">
                 <a href="z.pkginst.ov-23.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="preface-3.html">Solaris Virtualization Product Overview</a></p>
<p class="toc level1 tocsp"><a href="resource.html">Part&nbsp;I&nbsp;Resource Management</a></p>
<p class="toc level2"><a href="rmintro-1.html">1.&nbsp;&nbsp;Introduction to Solaris Resource Management</a></p>
<p class="toc level2"><a href="rmtaskproj-1.html">2.&nbsp;&nbsp;Projects and Tasks (Overview)</a></p>
<p class="toc level2"><a href="rmtaskproj.task-37.html">3.&nbsp;&nbsp;Administering Projects and Tasks</a></p>
<p class="toc level2"><a href="rmacct-1.html">4.&nbsp;&nbsp;Extended Accounting (Overview)</a></p>
<p class="toc level2"><a href="rmacct.task.sgm.html">5.&nbsp;&nbsp;Administering Extended Accounting (Tasks)</a></p>
<p class="toc level2"><a href="rmctrls-1.html">6.&nbsp;&nbsp;Resource Controls (Overview)</a></p>
<p class="toc level2"><a href="rmctrls.task-1.html">7.&nbsp;&nbsp;Administering Resource Controls (Tasks)</a></p>
<p class="toc level2"><a href="rmfss-1.html">8.&nbsp;&nbsp;Fair Share Scheduler (Overview)</a></p>
<p class="toc level2"><a href="rmfss.task-1.html">9.&nbsp;&nbsp;Administering the Fair Share Scheduler (Tasks)</a></p>
<p class="toc level2"><a href="rm.rcapd-1.html">10.&nbsp;&nbsp;Physical Memory Control Using the Resource Capping Daemon (Overview)</a></p>
<p class="toc level2"><a href="rm.rcapd.task-1.html">11.&nbsp;&nbsp;Administering the Resource Capping Daemon (Tasks)</a></p>
<p class="toc level2"><a href="rmpool-1.html">12.&nbsp;&nbsp;Resource Pools (Overview)</a></p>
<p class="toc level2"><a href="rmpool.task-1.html">13.&nbsp;&nbsp;Creating and Administering Resource Pools (Tasks)</a></p>
<p class="toc level2"><a href="rmconfig-1.html">14.&nbsp;&nbsp;Resource Management Configuration Example</a></p>
<p class="toc level2"><a href="rmconsole-1.html">15.&nbsp;&nbsp;Resource Control Functionality in the Solaris Management Console</a></p>
<p class="toc level1 tocsp"><a href="zone.html">Part&nbsp;II&nbsp;Zones</a></p>
<p class="toc level2"><a href="zones.intro-1.html">16.&nbsp;&nbsp;Introduction to Solaris Zones</a></p>
<p class="toc level2"><a href="z.config.ov-1.html">17.&nbsp;&nbsp;Non-Global Zone Configuration (Overview)</a></p>
<p class="toc level2"><a href="z.conf.start-1.html">18.&nbsp;&nbsp;Planning and Configuring Non-Global Zones (Tasks)</a></p>
<p class="toc level2"><a href="z.inst.ov-1.html">19.&nbsp;&nbsp;About Installing, Halting, Cloning, and Uninstalling Non-Global Zones (Overview)</a></p>
<p class="toc level2"><a href="z.inst.task-1.html">20.&nbsp;&nbsp;Installing, Booting, Halting, Uninstalling,  and Cloning Non-Global Zones (Tasks)</a></p>
<p class="toc level2"><a href="z.login.ov-1.html">21.&nbsp;&nbsp;Non-Global Zone Login (Overview)</a></p>
<p class="toc level2"><a href="z.login.task-1.html">22.&nbsp;&nbsp;Logging In to Non-Global Zones (Tasks)</a></p>
<p class="toc level2"><a href="gcgnc.html">23.&nbsp;&nbsp;Moving and Migrating Non-Global Zones (Tasks)</a></p>
<p class="toc level2"><a href="z.pkginst.ov-1.html">24.&nbsp;&nbsp;About Packages and Patches on a Solaris System With Zones Installed (Overview)</a></p>
<p class="toc level3"><a href="z.pkginst.ov-4.html">Packaging and Patch Tools Overview</a></p>
<p class="toc level3"><a href="z.pkginst.ov-10.html">About Packages and Zones</a></p>
<p class="toc level3"><a href="z.pkginst.ov-11.html">Keeping Zones in Sync</a></p>
<p class="toc level3"><a href="gdzlv.html">How Zone State Affects Patch and Package Operations</a></p>
<div class="onpage">
<p class="toc level3"><a href="">About Adding Packages in Zones</a></p>
</div>
<p class="toc level3"><a href="z.pkginst.ov-23.html">About Removing Packages in Zones</a></p>
<p class="toc level3"><a href="z.pkginst.ov-47.html">Package Parameter Information</a></p>
<p class="toc level3"><a href="z.pkginst.ov-22.html">Package Information Query</a></p>
<p class="toc level3"><a href="z.pkginst.ov-18.html">About Adding Patches in Zones</a></p>
<p class="toc level3"><a href="z.pkginst.ov-29.html">Applying Patches on a Solaris System With Zones Installed</a></p>
<p class="toc level3"><a href="z.pkginst.ov-24.html">Removing Patches on a Solaris System With Zones Installed</a></p>
<p class="toc level3"><a href="z.pkginst.ov-20.html">PatchPro Support</a></p>
<p class="toc level3"><a href="z.pkginst.ov-19.html">Product Database</a></p>
<p class="toc level2 tocsp"><a href="z.pkginst.task-1.html">25.&nbsp;&nbsp;Adding and Removing Packages and Patches on a Solaris System With Zones Installed (Tasks)</a></p>
<p class="toc level2"><a href="z.admin.ov-1.html">26.&nbsp;&nbsp;Solaris Zones Administration (Overview)</a></p>
<p class="toc level2"><a href="z.admin.task-1.html">27.&nbsp;&nbsp;Administering Solaris Zones (Tasks)</a></p>
<p class="toc level2"><a href="gclkx.html">28.&nbsp;&nbsp;Troubleshooting Miscellaneous Solaris Zones Problems</a></p>
<p class="toc level1 tocsp"><a href="gchhk.html">Part&nbsp;III&nbsp;Branded Zones</a></p>
<p class="toc level2"><a href="gchhy.html">29.&nbsp;&nbsp;About Branded Zones and the Linux Branded Zone</a></p>
<p class="toc level2"><a href="gcwwm.html">30.&nbsp;&nbsp;Planning the <tt>lx</tt> Branded Zone Configuration (Overview)</a></p>
<p class="toc level2"><a href="gdajn.html">31.&nbsp;&nbsp;Configuring the <tt>lx</tt> Branded Zone (Tasks)</a></p>
<p class="toc level2"><a href="gdbki.html">32.&nbsp;&nbsp;About Installing, Booting, Halting, Cloning, and Uninstalling <tt>lx</tt> Branded Zones (Overview)</a></p>
<p class="toc level2"><a href="gdduh.html">33.&nbsp;&nbsp;Installing, Booting, Halting, Uninstalling and Cloning <tt>lx</tt> Branded Zones (Tasks)</a></p>
<p class="toc level2"><a href="gdgck.html">34.&nbsp;&nbsp;Logging In to <tt>lx</tt> Branded Zones (Tasks)</a></p>
<p class="toc level2"><a href="gdqnv.html">35.&nbsp;&nbsp;Moving and Migrating <tt>lx</tt> Branded Zones (Tasks)</a></p>
<p class="toc level2"><a href="gdgif.html">36.&nbsp;&nbsp;Administering and Running Applications in <tt>lx</tt> Branded Zones (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="gefwp.html">Part&nbsp;IV&nbsp;Sun xVM</a></p>
<p class="toc level2"><a href="gfwrc.html">37.&nbsp;&nbsp;Sun xVM Hypervisor System Requirements</a></p>
<p class="toc level2"><a href="gefwo.html">38.&nbsp;&nbsp;Booting and Running the Sun xVM Hypervisor</a></p>
<p class="toc level2"><a href="gfwcu.html">39.&nbsp;&nbsp;Xvnc</a></p>
<p class="toc level2"><a href="gfqke.html">40.&nbsp;&nbsp;Using <tt>virt-install</tt> to Install a Domain</a></p>
<p class="toc level2"><a href="gfwlm.html">41.&nbsp;&nbsp;xVM System Administration</a></p>
<p class="toc level2"><a href="gefzh.html">42.&nbsp;&nbsp;Troubleshooting Miscellaneous Sun xVM Problems</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="z.pkginst.ov-14"></a><h3>About Adding Packages in Zones</h3>
<p><a name="indexterm-308"></a>The <tt>pkgadd</tt> system utility described in the <a href="http://docs.sun.com/doc/819-2240/pkgadd-1m?a=view"><tt>pkgadd</tt>(1M)</a> man page is used to
add packages on a Solaris system with zones installed.</p>

<a name="z.pkginst.ov-16"></a><h4>Using <tt>pkgadd</tt> in the Global Zone</h4>
<p>The <tt>pkgadd</tt> utility can be used with the <tt>-G</tt> option in the global
zone to add the package to the global zone only. The package is
not propagated to any other  zones. Note that if <tt>SUNW_PKG_THISZONE=true</tt>, you
do not have to use the <tt>-G</tt> option. If  <tt>SUNW_PKG_THISZONE=false</tt>, the
<tt>-G</tt> option will override it.</p><p>When you run the <tt>pkgadd</tt> utility in the global zone, the following actions
apply.</p>
<ul><li><p>The <tt>pkgadd</tt> utility is able to add a package:</p>
<ul><li><p>To the global zone only, unless the package is <tt>SUNW_PKG_ALLZONES=true</tt></p></li>
<li><p>To the global zone and to all non-global zones</p></li>
<li><p>To all non-global zones only, if the package is already installed in the global zone</p></li>
<li><p>To the current zone only, if <tt>SUNW_PKG_THISZONE=true</tt></p></li></ul>
</li>
<li><p>The <tt>pkgadd</tt> utility cannot add a package:</p>
<ul><li><p>To any subset of the non-global zones</p></li>
<li><p>To all non-global zones, unless the package is already installed in the global zone</p></li></ul>
</li>
<li><p>If the <tt>pkgadd</tt> utility is run without the <tt>-G</tt> option and <tt>SUNW_PKG_THISZONE=false</tt> , the specified package is added to all zones by default. The package is not marked as installed in the global zone only.</p></li>
<li><p>If the <tt>pkgadd</tt> utility is run without the <tt>-G</tt> option and <tt>SUNW_PKG_THISZONE=true</tt>, then the specified package is added to the current (global) zone by default. The package is marked as installed in the global zone only.</p></li>
<li><p>If the <tt>-G</tt> option is used, the <tt>pkgadd</tt> utility adds the specified package to the global zone only. The package is marked as installed in the global zone only. The package is not installed when any non-global zone is installed.</p></li></ul>


<a name="z.pkginst.ov-41"></a><h5>Adding a Package to the Global Zone and to All Non-Global Zones</h5>
<p>To add a package to the global zone and to all non-global
zones, execute the <tt>pkgadd</tt> utility in the global zone. As the global administrator, run
<tt>pkgadd</tt> without the <tt>-G</tt> option.</p><p>A package can be added to the global zone and to all
non-global zones without regard to the area affected by the package.</p><p>The following steps are performed by the <tt>pkgadd</tt> utility:</p>
<ul><li><p>Package dependencies are checked on the global zone and on all non-global zones. If required packages are not installed in any zone, then the dependency check fails. The system notifies the global administrator, who is prompted whether to continue.</p></li>
<li><p>The package is added to the global zone.</p></li>
<li><p>The package database on the global zone is updated.</p></li>
<li><p>The package is added to each non-global zone and the database in the global zone is updated.</p></li>
<li><p>The package database on each non-global zone is updated.</p></li></ul>


<a name="z.pkginst.ov-42"></a><h5>Adding a Package to the Global Zone Only</h5>
<p>To add a package to the global zone only, as the global
administrator in the global zone, execute the <tt>pkgadd</tt> utility with the <tt>-G</tt> option
only.</p><p>A package can be added to the global zone if the following
conditions are true:</p>
<ul><li><p>The package contents do not affect any area of the global zone that is shared with any non-global zone.</p></li>
<li><p>The package is set <tt>SUNW_PKG_ALLZONES=false</tt>.</p></li></ul>
<p>The following steps are performed by the <tt>pkgadd</tt> utility:</p>
<ul><li><p>If the package contents affect any area of the global zone that is shared with any non-global zone, or if the package is set <tt>SUNW_PKG_ALLZONES=true</tt>, then <tt>pkgadd</tt> fails. The error message states that the package must be added to the global zone and to all non-global zones.</p></li>
<li><p>Package dependencies are checked on the global zone only. If required packages are not installed, then the dependency check fails. The system notifies the global administrator, who is prompted whether to continue.</p></li>
<li><p>The package is added to the global zone.</p></li>
<li><p>The package database on the global zone is updated.</p></li>
<li><p>The package information on the global zone is annotated to indicate that this package is installed on the global zone only. If a non-global zone is installed in the future, this package will not be installed.</p></li></ul>


<a name="z.pkginst.ov-43"></a><h5>Adding a Package Installed in the Global Zone to all Non-Global Zones</h5>
<p>To add a package that is already installed in the global zone
to all non-global zones, you must currently remove the package from the global
zone and reinstall it in all zones.</p><p>These are the steps used to add a package that is already
installed in the global zone to all of the non-global zones:</p>
<ol><li><p>In the global zone, use <tt>pkgrm</tt> to remove the package.</p></li>
<li><p>Add the package without using the <tt>-G</tt> option.</p></li></ol>


<a name="z.pkginst.ov-15"></a><h4>Using <tt>pkgadd</tt> in a Non-Global Zone</h4>
<p>To add a package in a specified non-global zone, execute the <tt>pkgadd</tt>
utility, without options, as the zone administrator. The following conditions apply:</p>
<ul><li><p>The <tt>pkgadd</tt> utility can only add packages in the non-global zone in which the utility is used.</p></li>
<li><p>The package cannot affect any area of the zone that is shared from the global zone.</p></li>
<li><p>The package must be set <tt>SUNW_PKG_ALLZONES=false</tt>.</p></li></ul>
<p>The following steps are performed by the <tt>pkgadd</tt> utility:</p>
<ul><li><p>Package dependencies are checked on the non-global zone's package database before the package is added. If required packages are not installed, then the dependency check fails. The system notifies the non-global zone administrator, who is prompted whether to continue. The check fails if either of the following conditions are true.</p>
<ul><li><p>Any component of the package affects any area of the zone that is shared from the global zone.</p></li>
<li><p>The package is set <tt>SUNW_PKG_ALLZONES=true</tt>.</p></li></ul>
</li>
<li><p>The package is added to the zone.</p></li>
<li><p>The package database on the zone is updated.</p></li></ul>

         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="gdzlv.html">Previous</a>
             </td>
             <td align="right">
                 <a href="z.pkginst.ov-23.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

