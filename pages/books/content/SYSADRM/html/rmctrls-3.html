<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Configuring Resource Controls and Attributes - System Administration Guide:  Virtualization Using the Solaris Operating System</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-04-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide:  Virtualization Using the Solaris Operating System</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="rmctrls-2.html">Previous</a>
             </td>
             <td align="right">
                 <a href="rmctrls-12.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="preface-3.html">Solaris Virtualization Product Overview</a></p>
<p class="toc level1 tocsp"><a href="resource.html">Part&nbsp;I&nbsp;Resource Management</a></p>
<p class="toc level2"><a href="rmintro-1.html">1.&nbsp;&nbsp;Introduction to Solaris Resource Management</a></p>
<p class="toc level2"><a href="rmtaskproj-1.html">2.&nbsp;&nbsp;Projects and Tasks (Overview)</a></p>
<p class="toc level2"><a href="rmtaskproj.task-37.html">3.&nbsp;&nbsp;Administering Projects and Tasks</a></p>
<p class="toc level2"><a href="rmacct-1.html">4.&nbsp;&nbsp;Extended Accounting (Overview)</a></p>
<p class="toc level2"><a href="rmacct.task.sgm.html">5.&nbsp;&nbsp;Administering Extended Accounting (Tasks)</a></p>
<p class="toc level2"><a href="rmctrls-1.html">6.&nbsp;&nbsp;Resource Controls (Overview)</a></p>
<p class="toc level3"><a href="rmctrls-2.html">Resource Controls Concepts</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Configuring Resource Controls and Attributes</a></p>
</div>
<p class="toc level3"><a href="rmctrls-12.html">Applying Resource Controls</a></p>
<p class="toc level3"><a href="rmctrls-13.html">Temporarily Updating Resource Control Values on a Running System</a></p>
<p class="toc level3"><a href="rmctrls-19.html">Commands Used With Resource Controls</a></p>
<p class="toc level2 tocsp"><a href="rmctrls.task-1.html">7.&nbsp;&nbsp;Administering Resource Controls (Tasks)</a></p>
<p class="toc level2"><a href="rmfss-1.html">8.&nbsp;&nbsp;Fair Share Scheduler (Overview)</a></p>
<p class="toc level2"><a href="rmfss.task-1.html">9.&nbsp;&nbsp;Administering the Fair Share Scheduler (Tasks)</a></p>
<p class="toc level2"><a href="rm.rcapd-1.html">10.&nbsp;&nbsp;Physical Memory Control Using the Resource Capping Daemon (Overview)</a></p>
<p class="toc level2"><a href="rm.rcapd.task-1.html">11.&nbsp;&nbsp;Administering the Resource Capping Daemon (Tasks)</a></p>
<p class="toc level2"><a href="rmpool-1.html">12.&nbsp;&nbsp;Resource Pools (Overview)</a></p>
<p class="toc level2"><a href="rmpool.task-1.html">13.&nbsp;&nbsp;Creating and Administering Resource Pools (Tasks)</a></p>
<p class="toc level2"><a href="rmconfig-1.html">14.&nbsp;&nbsp;Resource Management Configuration Example</a></p>
<p class="toc level2"><a href="rmconsole-1.html">15.&nbsp;&nbsp;Resource Control Functionality in the Solaris Management Console</a></p>
<p class="toc level1 tocsp"><a href="zone.html">Part&nbsp;II&nbsp;Zones</a></p>
<p class="toc level2"><a href="zones.intro-1.html">16.&nbsp;&nbsp;Introduction to Solaris Zones</a></p>
<p class="toc level2"><a href="z.config.ov-1.html">17.&nbsp;&nbsp;Non-Global Zone Configuration (Overview)</a></p>
<p class="toc level2"><a href="z.conf.start-1.html">18.&nbsp;&nbsp;Planning and Configuring Non-Global Zones (Tasks)</a></p>
<p class="toc level2"><a href="z.inst.ov-1.html">19.&nbsp;&nbsp;About Installing, Halting, Cloning, and Uninstalling Non-Global Zones (Overview)</a></p>
<p class="toc level2"><a href="z.inst.task-1.html">20.&nbsp;&nbsp;Installing, Booting, Halting, Uninstalling,  and Cloning Non-Global Zones (Tasks)</a></p>
<p class="toc level2"><a href="z.login.ov-1.html">21.&nbsp;&nbsp;Non-Global Zone Login (Overview)</a></p>
<p class="toc level2"><a href="z.login.task-1.html">22.&nbsp;&nbsp;Logging In to Non-Global Zones (Tasks)</a></p>
<p class="toc level2"><a href="gcgnc.html">23.&nbsp;&nbsp;Moving and Migrating Non-Global Zones (Tasks)</a></p>
<p class="toc level2"><a href="z.pkginst.ov-1.html">24.&nbsp;&nbsp;About Packages and Patches on a Solaris System With Zones Installed (Overview)</a></p>
<p class="toc level2"><a href="z.pkginst.task-1.html">25.&nbsp;&nbsp;Adding and Removing Packages and Patches on a Solaris System With Zones Installed (Tasks)</a></p>
<p class="toc level2"><a href="z.admin.ov-1.html">26.&nbsp;&nbsp;Solaris Zones Administration (Overview)</a></p>
<p class="toc level2"><a href="z.admin.task-1.html">27.&nbsp;&nbsp;Administering Solaris Zones (Tasks)</a></p>
<p class="toc level2"><a href="gclkx.html">28.&nbsp;&nbsp;Troubleshooting Miscellaneous Solaris Zones Problems</a></p>
<p class="toc level1 tocsp"><a href="gchhk.html">Part&nbsp;III&nbsp;Branded Zones</a></p>
<p class="toc level2"><a href="gchhy.html">29.&nbsp;&nbsp;About Branded Zones and the Linux Branded Zone</a></p>
<p class="toc level2"><a href="gcwwm.html">30.&nbsp;&nbsp;Planning the <tt>lx</tt> Branded Zone Configuration (Overview)</a></p>
<p class="toc level2"><a href="gdajn.html">31.&nbsp;&nbsp;Configuring the <tt>lx</tt> Branded Zone (Tasks)</a></p>
<p class="toc level2"><a href="gdbki.html">32.&nbsp;&nbsp;About Installing, Booting, Halting, Cloning, and Uninstalling <tt>lx</tt> Branded Zones (Overview)</a></p>
<p class="toc level2"><a href="gdduh.html">33.&nbsp;&nbsp;Installing, Booting, Halting, Uninstalling and Cloning <tt>lx</tt> Branded Zones (Tasks)</a></p>
<p class="toc level2"><a href="gdgck.html">34.&nbsp;&nbsp;Logging In to <tt>lx</tt> Branded Zones (Tasks)</a></p>
<p class="toc level2"><a href="gdqnv.html">35.&nbsp;&nbsp;Moving and Migrating <tt>lx</tt> Branded Zones (Tasks)</a></p>
<p class="toc level2"><a href="gdgif.html">36.&nbsp;&nbsp;Administering and Running Applications in <tt>lx</tt> Branded Zones (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="gefwp.html">Part&nbsp;IV&nbsp;Sun xVM</a></p>
<p class="toc level2"><a href="gfwrc.html">37.&nbsp;&nbsp;Sun xVM Hypervisor System Requirements</a></p>
<p class="toc level2"><a href="gefwo.html">38.&nbsp;&nbsp;Booting and Running the Sun xVM Hypervisor</a></p>
<p class="toc level2"><a href="gfwcu.html">39.&nbsp;&nbsp;Xvnc</a></p>
<p class="toc level2"><a href="gfqke.html">40.&nbsp;&nbsp;Using <tt>virt-install</tt> to Install a Domain</a></p>
<p class="toc level2"><a href="gfwlm.html">41.&nbsp;&nbsp;xVM System Administration</a></p>
<p class="toc level2"><a href="gefzh.html">42.&nbsp;&nbsp;Troubleshooting Miscellaneous Sun xVM Problems</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="rmctrls-3"></a><h3>Configuring Resource Controls and Attributes</h3>
<p><a name="indexterm-41"></a><a name="indexterm-42"></a><a name="indexterm-43"></a><a name="indexterm-44"></a>The resource controls facility is configured through the <tt>project</tt> database. See <a href="rmtaskproj-1.html">Chapter&nbsp;2, Projects and Tasks (Overview)</a>. Resource controls
and other attributes are set in the final field of the <tt>project</tt>
database entry. The values associated with each resource control are enclosed in parentheses,
and appear as plain text separated by commas. The values in parentheses constitute
an &ldquo;action clause.&rdquo; Each action clause is composed of a privilege level, a
threshold value, and an action that is associated with the particular threshold. Each
resource control can have multiple action clauses, which are also separated by commas. The
following entry defines a per-task lightweight process limit and a per-process maximum CPU
time limit on a project entity. The <tt>process.max-cpu-time</tt>  would send a process
a SIGTERM after the process ran for 1 hour, and a SIGKILL if
the process continued to run for a total of 1 hour and
1 minute. See <a href="#rmctrls-tbl-8">Table&nbsp;6-3</a>.</p><pre>development:101:Developers:::task.max-lwps=(privileged,10,deny);
  process.max-cpu-time=(basic,3600,signal=TERM),(priv,3660,signal=KILL)
typed as one line</pre>
<hr><p><b>Note - </b>On systems that have zones enabled, zone-wide resource controls are specified in the
zone configuration using a slightly different format. See <a href="z.config.ov-12.html">Zone Configuration Data</a> for more information.</p>
<hr>
<p>The <tt>rctladm</tt> command allows you to make runtime interrogations of and modifications to
the resource controls facility, with <b>global scope</b>. The <tt>prctl</tt> command allows you to
make runtime interrogations of and modifications to the resource controls facility, with <b>local scope</b>.</p><p>For more information, see <a href="#rmctrls-7">Global and Local Actions on Resource Control Values</a>, <a href="http://docs.sun.com/doc/819-2240/rctladm-1m?a=view"><tt>rctladm</tt>(1M)</a> and <a href="http://docs.sun.com/doc/819-2239/prctl-1?a=view"><tt>prctl</tt>(1)</a>.</p>
<hr><p><b>Note - </b>On a system with zones installed, you cannot use <tt>rctladm</tt> in a non-global
zone to modify settings. You can use <tt>rctladm</tt> in a non-global zone to
view the global logging state of each resource control.</p>
<hr>


<a name="rmctrls-4"></a><h4>Available Resource Controls</h4>
<p><a name="indexterm-45"></a>A list of the standard resource controls that are available in this release
is shown in the following table.</p><p>The table describes the resource that is constrained by each control. The table
also identifies the default units that are used by the <tt>project</tt> database
for that resource. The default units are of two types:</p>
<ul><li><p>Quantities represent a limited amount.</p></li>
<li><p>Indexes represent a maximum valid identifier.</p></li></ul>
<p>Thus, <tt>project.cpu-shares</tt> specifies the number of shares to which the project is entitled.
<tt>process.max-file-descriptor</tt> specifies the highest file number that can be assigned to a process
by the <a href="http://docs.sun.com/doc/819-2241/open-2?a=view"><tt>open</tt>(2)</a> system call.</p><a name="rmctrls-tbl-5"></a><h6>Table&nbsp;6-1 Standard Project, Task, and Process Resource Controls</h6><table><col width="39*"><col width="39*"><col width="22*"><tr><th align="left" valign="top" scope="column"><p>Control Name</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>Default Unit</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>project.cpu-cap</tt></p></td>
<td align="left" valign="top" scope="row"><p>Absolute limit on the amount of
CPU resources that can be consumed by a project. A value of <tt>100</tt>
means 100% of one CPU as the <tt>project.cpu-cap</tt> setting. A value of
<tt>125</tt> is 125%, because 100% corresponds to one full CPU on the system
when using CPU caps.</p></td>
<td align="left" valign="top" scope="row"><p>Quantity (number of CPUs)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>project.cpu-shares</tt></p></td>
<td align="left" valign="top" scope="row"><p>Number of CPU shares granted to
this project for use with the fair share scheduler (see <a href="http://docs.sun.com/doc/819-2254/fss-7?a=view"><tt>FSS</tt>(7)</a>).</p></td>
<td align="left" valign="top" scope="row"><p>Quantity (shares)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>project.max-crypto-memory</tt></p></td>
<td align="left" valign="top" scope="row"><p>Total amount
of kernel memory that can be used by <tt>libpkcs11</tt> for hardware crypto acceleration.
Allocations for kernel buffers and session-related structures are charged against this resource control.</p></td>
<td align="left" valign="top" scope="row"><p>Size
(bytes)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>project.max-locked-memory</tt></p></td>
<td align="left" valign="top" scope="row"><p>Total amount of physical locked memory allowed.</p><p>If <tt>priv_proc_lock_memory</tt> is assigned to a
user, consider setting this resource control as well to prevent that user from
locking all memory.</p><p>Note that this resource control replaced <tt>project.max-device-locked-memory</tt>, which has been removed.
This release control will be removed in a future release.</p></td>
<td align="left" valign="top" scope="row"><p>Size (bytes)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>project.max-msg-ids</tt></p></td>
<td align="left" valign="top" scope="row"><p>Maximum number of
message queue IDs allowed for this project.</p></td>
<td align="left" valign="top" scope="row"><p>Quantity (message queue IDs)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>project.max-port-ids</tt></p></td>
<td align="left" valign="top" scope="row"><p>Maximum allowable number
of event ports.</p></td>
<td align="left" valign="top" scope="row"><p>Quantity (number of event ports) </p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>project.max-sem-ids</tt></p></td>
<td align="left" valign="top" scope="row"><p>Maximum number of semaphore IDs
allowed for this project.</p></td>
<td align="left" valign="top" scope="row"><p>Quantity (semaphore IDs)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>project.max-shm-ids</tt></p></td>
<td align="left" valign="top" scope="row"><p>Maximum number of shared memory IDs allowed
for this project.</p></td>
<td align="left" valign="top" scope="row"><p>Quantity (shared memory IDs)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>project.max-shm-memory</tt></p></td>
<td align="left" valign="top" scope="row"><p>Total amount of System V shared memory
allowed for this project.</p></td>
<td align="left" valign="top" scope="row"><p>Size (bytes)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>project.max-lwps</tt></p></td>
<td align="left" valign="top" scope="row"><p>Maximum number of LWPs simultaneously available to this
project.</p></td>
<td align="left" valign="top" scope="row"><p>Quantity (LWPs)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>project.max-tasks</tt></p></td>
<td align="left" valign="top" scope="row"><p>Maximum number of tasks allowable in this project.</p></td>
<td align="left" valign="top" scope="row"><p>Quantity (number of tasks)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>project.max-contracts</tt></p></td>
<td align="left" valign="top" scope="row"><p>Maximum
number of contracts allowed in this project.</p></td>
<td align="left" valign="top" scope="row"><p>Quantity (contracts)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>task.max-cpu-time</tt></p></td>
<td align="left" valign="top" scope="row"><p>Maximum CPU time that is
available to this task's processes.</p></td>
<td align="left" valign="top" scope="row"><p>Time (seconds)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>task.max-lwps</tt></p></td>
<td align="left" valign="top" scope="row"><p>Maximum number of LWPs simultaneously available to
this task's processes.</p></td>
<td align="left" valign="top" scope="row"><p>Quantity (LWPs)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>process.max-cpu-time</tt></p></td>
<td align="left" valign="top" scope="row"><p>Maximum CPU time that is available to this process.</p></td>
<td align="left" valign="top" scope="row"><p>Time
(seconds)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>process.max-file-descriptor</tt></p></td>
<td align="left" valign="top" scope="row"><p>Maximum file descriptor index available to this process.</p></td>
<td align="left" valign="top" scope="row"><p>Index (maximum file descriptor)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>process.max-file-size</tt></p></td>
<td align="left" valign="top" scope="row"><p>Maximum file
offset available for writing by this process.</p></td>
<td align="left" valign="top" scope="row"><p>Size (bytes)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>process.max-core-size</tt></p></td>
<td align="left" valign="top" scope="row"><p>Maximum size of a core
file created by this process.</p></td>
<td align="left" valign="top" scope="row"><p>Size (bytes)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>process.max-data-size</tt></p></td>
<td align="left" valign="top" scope="row"><p>Maximum heap memory available to this process.</p></td>
<td align="left" valign="top" scope="row"><p>Size
(bytes)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>process.max-stack-size</tt></p></td>
<td align="left" valign="top" scope="row"><p>Maximum stack memory segment available to this process.</p></td>
<td align="left" valign="top" scope="row"><p>Size (bytes)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>process.max-address-space</tt></p></td>
<td align="left" valign="top" scope="row"><p>Maximum amount of address
space, as summed over segment sizes, that is available to this process.</p></td>
<td align="left" valign="top" scope="row"><p>Size (bytes)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>process.max-port-events</tt></p></td>
<td align="left" valign="top" scope="row"><p>Maximum
allowable number of events per event port.</p></td>
<td align="left" valign="top" scope="row"><p>Quantity (number of events) </p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>process.max-sem-nsems</tt></p></td>
<td align="left" valign="top" scope="row"><p>Maximum number
of semaphores allowed per semaphore set.</p></td>
<td align="left" valign="top" scope="row"><p>Quantity (semaphores per set)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>process.max-sem-ops</tt></p></td>
<td align="left" valign="top" scope="row"><p>Maximum number of semaphore
operations allowed per <tt>semop</tt> call (value copied from the resource control at <tt>semget()</tt>
time).</p></td>
<td align="left" valign="top" scope="row"><p>Quantity (number of operations)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>process.max-msg-qbytes</tt></p></td>
<td align="left" valign="top" scope="row"><p>Maximum number of bytes of messages on a message
queue (value copied from the resource control at <tt>msgget()</tt> time).</p></td>
<td align="left" valign="top" scope="row"><p>Size (bytes)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>process.max-msg-messages</tt></p></td>
<td align="left" valign="top" scope="row"><p>Maximum number of
messages on a message queue (value copied from the resource control at <tt>msgget()</tt>
time).</p></td>
<td align="left" valign="top" scope="row"><p>Quantity (number of messages)</p></td>
</tr>
</table><p>You can display the default values for resource controls on a system that
does not have any resource controls set or changed. Such a system
contains no non-default entries in <tt>/etc/system</tt> or the <tt>project</tt> database. To display values,
use the <tt>prctl</tt> command.</p>

<a name="gbrcy"></a><h4>Zone-Wide Resource Controls</h4>
<p>Zone-wide resource controls limit the total resource usage of all process entities within
a zone. Zone-wide resource controls can also be set using global property names
as described in <a href="z.config.ov-3.html#z.config.ov-13">Setting Zone-Wide Resource Controls</a> and <a href="z.conf.start-85.html#z.conf.start-29">How to Configure the Zone</a>.</p><a name="gdswx"></a><h6>Table&nbsp;6-2 Zones Resource Controls</h6><table><col width="39*"><col width="39*"><col width="22*"><tr><th align="left" valign="top" scope="column"><p>Control Name</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>Default Unit</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>zone.cpu-cap</tt></p></td>
<td align="left" valign="top" scope="row"><p>Absolute limit on the amount
of CPU resources that can be consumed by a non-global zone. A value
of <tt>100</tt> means 100% of one CPU as the <tt>project.cpu-cap</tt> setting. A value
of <tt>125</tt> is 125%, because 100% corresponds to one full CPU on the
system when using CPU caps.</p></td>
<td align="left" valign="top" scope="row"><p>Quantity (number of CPUs)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>zone.cpu-shares</tt></p></td>
<td align="left" valign="top" scope="row"><p>Number of fair share scheduler (FSS)
CPU shares for this zone</p></td>
<td align="left" valign="top" scope="row"><p>Quantity (shares)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>zone.max-locked-memory</tt></p></td>
<td align="left" valign="top" scope="row"><p>Total amount of physical locked memory available
to a zone.</p><p>When <tt>priv_proc_lock_memory</tt> is assigned to a zone, consider setting this resource
control as well to prevent that zone from locking all memory.</p></td>
<td align="left" valign="top" scope="row"><p>Size (bytes)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>zone.max-lwps</tt></p></td>
<td align="left" valign="top" scope="row"><p>Maximum number
of LWPs simultaneously available to this zone</p></td>
<td align="left" valign="top" scope="row"><p>Quantity (LWPs)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>zone.max-msg-ids</tt></p></td>
<td align="left" valign="top" scope="row"><p>Maximum number of message queue
IDs allowed for this zone</p></td>
<td align="left" valign="top" scope="row"><p>Quantity (message queue IDs)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>zone.max-sem-ids</tt></p></td>
<td align="left" valign="top" scope="row"><p>Maximum number of semaphore IDs
allowed for this zone</p></td>
<td align="left" valign="top" scope="row"><p>Quantity (semaphore IDs)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>zone.max-shm-ids</tt></p></td>
<td align="left" valign="top" scope="row"><p>Maximum number of shared memory IDs allowed
for this zone</p></td>
<td align="left" valign="top" scope="row"><p>Quantity (shared memory IDs)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>zone.max-shm-memory</tt></p></td>
<td align="left" valign="top" scope="row"><p>Total amount of System V shared memory
allowed for this zone</p></td>
<td align="left" valign="top" scope="row"><p>Size (bytes)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>zone.max-swap</tt></p></td>
<td align="left" valign="top" scope="row"><p>Total amount of swap that can be consumed
by user process address space mappings and <tt>tmpfs</tt> mounts for this zone.</p></td>
<td align="left" valign="top" scope="row"><p>Size (bytes)</p></td>
</tr>
</table><p>For information on configuring zone-wide resource controls, see <a href="z.config.ov-12.html#z.config.ov-17">Resource Type Properties</a> and <a href="z.conf.start-85.html#z.conf.start-29">How to Configure the Zone</a>. To
use zone-wide resource controls in <tt>lx</tt> branded zones, see <a href="gcziw.html#gdbji">How to Configure, Verify, and Commit the <tt>lx</tt> Branded Zone</a>.</p><p>Note that it is possible to apply a zone-wide resource control to
the global zone. See <a href="z.admin.task-71.html">Using the Fair Share Scheduler on a Solaris System With Zones Installed</a> for additional information.</p>

<a name="rmctrls-20"></a><h4>Units Support</h4>
<p>Global flags that identify resource control types are defined for all resource controls.
The flags are used by the system to communicate basic type information to
applications such as the <tt>prctl</tt> command. Applications use the information to determine the
following:</p>
<ul><li><p>The unit strings that are appropriate for each resource control</p></li>
<li><p>The correct scale to use when interpreting scaled values</p></li></ul>
<p>The following global flags are available:</p><table><col width="33*"><col width="30*"><col width="18*"><col width="19*"><tr><th align="left" valign="top" scope="column"><p>Global Flag</p></th>
<th align="left" valign="top" scope="column"><p>Resource Control Type String</p></th>
<th align="left" valign="top" scope="column"><p>Modifier</p></th>
<th align="left" valign="top" scope="column"><p>Scale</p></th>
</tr>
<tr><td rowspan="7" align="left" valign="top" scope="row"><p>RCTL_GLOBAL_BYTES</p></td>
<td align="left" valign="top" scope="row"><p>bytes</p></td>
<td align="left" valign="top" scope="row"><p>B</p></td>
<td align="left" valign="top" scope="row"><p>1</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p></p></td>
<td align="left" valign="top" scope="row"><p>KB</p></td>
<td align="left" valign="top" scope="row"><p>2<sup>10</sup></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p></p></td>
<td align="left" valign="top" scope="row"><p>MB</p></td>
<td align="left" valign="top" scope="row"><p>2<sup>20</sup></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p></p></td>
<td align="left" valign="top" scope="row"><p>GB</p></td>
<td align="left" valign="top" scope="row"><p>2<sup>30</sup></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p></p></td>
<td align="left" valign="top" scope="row"><p>TB</p></td>
<td align="left" valign="top" scope="row"><p>2<sup>40</sup></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p></p></td>
<td align="left" valign="top" scope="row"><p>PB</p></td>
<td align="left" valign="top" scope="row"><p>2<sup>50</sup></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p></p></td>
<td align="left" valign="top" scope="row"><p>EB</p></td>
<td align="left" valign="top" scope="row"><p>2<sup>60</sup></p></td>
</tr>
<tr><td rowspan="7" align="left" valign="top" scope="row"><p>RCTL_GLOBAL_SECONDS</p></td>
<td align="left" valign="top" scope="row"><p>seconds</p></td>
<td align="left" valign="top" scope="row"><p>s</p></td>
<td align="left" valign="top" scope="row"><p>1</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p></p></td>
<td align="left" valign="top" scope="row"><p>Ks</p></td>
<td align="left" valign="top" scope="row"><p>10<sup>3</sup></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p></p></td>
<td align="left" valign="top" scope="row"><p>Ms</p></td>
<td align="left" valign="top" scope="row"><p>10<sup>6</sup></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p></p></td>
<td align="left" valign="top" scope="row"><p>Gs</p></td>
<td align="left" valign="top" scope="row"><p>10<sup>9</sup></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p></p></td>
<td align="left" valign="top" scope="row"><p>Ts</p></td>
<td align="left" valign="top" scope="row"><p>10<sup>12</sup></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p></p></td>
<td align="left" valign="top" scope="row"><p>Ps</p></td>
<td align="left" valign="top" scope="row"><p>10<sup>15</sup></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p></p></td>
<td align="left" valign="top" scope="row"><p>Es</p></td>
<td align="left" valign="top" scope="row"><p>10<sup>18</sup></p></td>
</tr>
<tr><td rowspan="7" align="left" valign="top" scope="row"><p>RCTL_GLOBAL_COUNT</p></td>
<td align="left" valign="top" scope="row"><p>count</p></td>
<td align="left" valign="top" scope="row"><p>none</p></td>
<td align="left" valign="top" scope="row"><p>1</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p></p></td>
<td align="left" valign="top" scope="row"><p>K</p></td>
<td align="left" valign="top" scope="row"><p>10<sup>3</sup></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p></p></td>
<td align="left" valign="top" scope="row"><p>M</p></td>
<td align="left" valign="top" scope="row"><p>10<sup>6</sup></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p></p></td>
<td align="left" valign="top" scope="row"><p>G</p></td>
<td align="left" valign="top" scope="row"><p>10<sup>9</sup></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p></p></td>
<td align="left" valign="top" scope="row"><p>T</p></td>
<td align="left" valign="top" scope="row"><p>10<sup>12</sup></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p></p></td>
<td align="left" valign="top" scope="row"><p>P</p></td>
<td align="left" valign="top" scope="row"><p>10<sup>15</sup></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p></p></td>
<td align="left" valign="top" scope="row"><p>E</p></td>
<td align="left" valign="top" scope="row"><p>10<sup>18</sup></p></td>
</tr>
</table><p>Scaled values can be used with resource controls. The following example shows a
scaled threshold value:</p><pre>task.max-lwps=(priv,1K,deny)</pre>
<hr><p><b>Note - </b>Unit modifiers are accepted by the <tt>prctl</tt>, <tt>projadd</tt>, and <tt>projmod</tt> commands. You
cannot use unit modifiers in the <tt>project</tt> database itself.</p>
<hr>


<a name="rmctrls-6"></a><h4>Resource Control Values and Privilege Levels</h4>
<p><a name="indexterm-46"></a>A threshold value on a resource control constitutes an enforcement point where local
actions can be triggered or global actions, such as logging, can occur.</p><p><a name="indexterm-47"></a>Each threshold value on a resource control must be associated with a privilege
level. The privilege level must be one of the following three types.</p>
<ul><li><p>Basic, which can be modified by the owner of the calling process</p></li>
<li><p>Privileged, which can be modified only by privileged (superuser) callers</p></li>
<li><p>System, which is fixed for the duration of the operating system instance</p></li></ul>
<p>A resource control is guaranteed to have one system value, which is defined
by the system, or resource provider. The system value represents how much of
the resource the current implementation of the operating system is capable of providing.</p><p>Any number of privileged values can be defined, and only one basic
value is allowed. Operations that are performed without specifying a privilege value are assigned
a basic privilege by default.</p><p>The privilege level for a resource control value is defined in the
privilege field of the resource control block as RCTL_BASIC, RCTL_PRIVILEGED, or RCTL_SYSTEM. See <a href="http://docs.sun.com/doc/819-2241/setrctl-2?a=view"><tt>setrctl</tt>(2)</a>
for more information. You can use the <tt>prctl</tt> command to modify values that are
associated with basic and privileged levels.</p>

<a name="rmctrls-7"></a><h4>Global and Local Actions on Resource Control Values</h4>
<p><a name="indexterm-48"></a>There are two categories of actions on resource control values: global and local.</p>

<a name="rmctrls-25"></a><h5>Global Actions on Resource Control Values</h5>
<p><a name="indexterm-49"></a>Global actions apply to resource control values for every resource control on the
system. You can use the <tt>rctladm</tt> command described in the <a href="http://docs.sun.com/doc/819-2240/rctladm-1m?a=view"><tt>rctladm</tt>(1M)</a> man page to
perform the following actions:</p>
<ul><li><p>Display the global state of active system resource controls</p></li>
<li><p>Set global logging actions</p></li></ul>
<p>You can disable or enable the global logging action on resource controls. You
can set the <tt>syslog</tt> action to a specific degree by assigning a severity
level, <tt>syslog=</tt><i>level</i>. The possible settings for <i>level</i> are as follows:</p>
<ul><li><p><tt>debug</tt></p></li>
<li><p><tt>info</tt></p></li>
<li><p><tt>notice</tt></p></li>
<li><p><tt>warning</tt></p></li>
<li><p><tt>err</tt></p></li>
<li><p><tt>crit</tt></p></li>
<li><p><tt>alert</tt></p></li>
<li><p><tt>emerg</tt></p></li></ul>
<p>By default, there is no global logging of resource control violations. The level
<tt>n/a</tt> indicates resource controls on which no global action can be configured.</p>

<a name="rmctrls-24"></a><h5>Local Actions on Resource Control Values</h5>
<p><a name="indexterm-50"></a><a name="indexterm-51"></a>Local actions are taken on a process that attempts to exceed the control
value. For each threshold value that is placed on a resource control, you
can associate one or more actions. There are three types of local actions:
<tt>none</tt>, <tt>deny</tt>, and <tt>signal=</tt>. These three actions are used as follows:</p><dl><dt><tt>none</tt></dt>
<dd><p>No action is taken on resource requests for an amount that is greater than the threshold. This action is useful for monitoring resource usage without affecting the progress of applications. You can also enable a global message that displays when the resource control is exceeded, although the process exceeding the threshhold is not affected.</p></dd>
<dt><tt>deny</tt></dt>
<dd><p>You can deny resource requests for an amount that is greater than the threshold. For example, a <tt>task.max-lwps</tt> resource control with action <tt>deny</tt> causes a <tt>fork</tt> system call to fail if the new process would exceed the control value. See the <a href="http://docs.sun.com/doc/819-2241/fork-2?a=view"><tt>fork</tt>(2)</a> man page.</p></dd>
<dt><tt>signal=</tt></dt>
<dd><p>You can enable a global signal message action when the resource control is exceeded. A signal is sent to the process when the threshold value is exceeded. Additional signals are not sent if the process consumes additional resources. Available signals are listed in <a href="#rmctrls-tbl-8">Table&nbsp;6-3</a>.</p></dd>
</dl>
<p>Not all of the actions can be applied to every resource control.
For example, a process cannot exceed the number of CPU shares assigned to
the project of which it is a member. Therefore, a deny action is
not allowed on the <tt>project.cpu-shares</tt> resource control.</p><p>Due to implementation restrictions, the global properties of each control can restrict the
range of available actions that can be set on the threshold value. (See
the <a href="http://docs.sun.com/doc/819-2240/rctladm-1m?a=view"><tt>rctladm</tt>(1M)</a> man page.) A list of available signal actions is presented in
the following table. For additional information about signals, see the <a href="http://docs.sun.com/doc/819-2242/signal-3head?a=view"><tt>signal</tt>(3HEAD)</a> man page.</p><a name="rmctrls-tbl-8"></a><h6>Table&nbsp;6-3 Signals Available to Resource Control Values</h6><table><col width="20*"><col width="40*"><col width="30*"><tr><th align="left" valign="top" scope="column"><p>Signal</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>Notes</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>SIGABRT</p></td>
<td align="left" valign="top" scope="row"><p>Terminate
the process.</p></td>
<td align="left" valign="top" scope="row"><p></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>SIGHUP</p></td>
<td align="left" valign="top" scope="row"><p>Send a hangup signal. Occurs when carrier drops on an open
line. Signal sent to the process group that controls the terminal.</p></td>
<td align="left" valign="top" scope="row"><p></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>SIGTERM</p></td>
<td align="left" valign="top" scope="row"><p>Terminate the process.
Termination signal sent by software.</p></td>
<td align="left" valign="top" scope="row"><p></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>SIGKILL</p></td>
<td align="left" valign="top" scope="row"><p>Terminate the process and kill the program.</p></td>
<td align="left" valign="top" scope="row"><p></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>SIGSTOP</p></td>
<td align="left" valign="top" scope="row"><p>Stop the
process. Job control signal.</p></td>
<td align="left" valign="top" scope="row"><p></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>SIGXRES</p></td>
<td align="left" valign="top" scope="row"><p>Resource control limit exceeded. Generated by resource control facility.</p></td>
<td align="left" valign="top" scope="row"><p></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>SIGXFSZ</p></td>
<td align="left" valign="top" scope="row"><p>Terminate
the process. File size limit exceeded.</p></td>
<td align="left" valign="top" scope="row"><p>Available only to resource controls with the
RCTL_GLOBAL_FILE_SIZE property (<tt>process.max-file-size</tt>). See <a href="http://docs.sun.com/doc/819-2243/rctlblk-set-value-3c?a=view"><tt>rctlblk_set_value</tt>(3C)</a> for more information.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>SIGXCPU</p></td>
<td align="left" valign="top" scope="row"><p>Terminate the process. CPU time limit
exceeded.</p></td>
<td align="left" valign="top" scope="row"><p>Available only to resource controls with the RCTL_GLOBAL_CPUTIME property (<tt>process.max-cpu-time</tt>). See <a href="http://docs.sun.com/doc/819-2243/rctlblk-set-value-3c?a=view"><tt>rctlblk_set_value</tt>(3C)</a> for
more information.</p></td>
</tr>
</table>

<a name="rmctrls-9"></a><h4>Resource Control Flags and Properties</h4>
<p>Each resource control on the system has a certain set of associated properties.
This set of properties is defined as a set of flags, which
are associated with all controlled instances of that resource. Global flags cannot be modified,
but the flags can be retrieved by using either <tt>rctladm</tt> or the <tt>getrctl</tt>
system call.</p><p>Local flags define the default behavior and configuration for a specific threshold value
of that resource control on a specific process or process collective. The local
flags for one threshold value do not affect the behavior of other defined
threshold values for the same resource control. However, the global flags affect the
behavior for every value associated with a particular control. Local flags can be
modified, within the constraints supplied by their corresponding global flags, by the 
<tt>prctl</tt> command or the <tt>setrctl</tt> system call. See <a href="http://docs.sun.com/doc/819-2241/setrctl-2?a=view"><tt>setrctl</tt>(2)</a>.</p><p>For the complete list of local flags, global flags, and their  definitions, see
<a href="http://docs.sun.com/doc/819-2243/rctlblk-set-value-3c?a=view"><tt>rctlblk_set_value</tt>(3C)</a>.</p><p>To determine system behavior when a threshold value for a particular resource control
is reached, use <tt>rctladm</tt> to display the global flags for the resource control
. For example, to display the values for <tt>process.max-cpu-time</tt>, type the following:</p><pre>$ <tt><b>rctladm process.max-cpu-time</b></tt>
    process.max-cpu-time  syslog=off  [ lowerable no-deny cpu-time inf seconds ]</pre><p>The global flags indicate the following.</p><dl><dt><tt>lowerable</tt></dt>
<dd><p>Superuser privileges are not required to lower the privileged values for this control.</p></dd>
<dt><tt>no-deny</tt></dt>
<dd><p>Even when threshold values are exceeded, access to the resource is never denied.</p></dd>
<dt><tt>cpu-time</tt></dt>
<dd><p>SIGXCPU is available to be sent when threshold values of this resource are reached.</p></dd>
<dt><tt>seconds</tt></dt>
<dd><p>The time value for the resource control.</p></dd>
<dt><tt>no-basic</tt></dt>
<dd><p>Resource control values with the privilege type <tt>basic</tt> cannot be set. Only privileged resource control values are allowed.</p></dd>
<dt><tt>no-signal</tt></dt>
<dd><p>A local signal action cannot be set on resource control values.</p></dd>
<dt><tt>no-syslog</tt></dt>
<dd><p>The global <tt>syslog</tt> message action may not be set for this resource control.</p></dd>
<dt><tt>deny</tt></dt>
<dd><p>Always deny request for resource when threshold values are exceeded.</p></dd>
<dt><tt>count</tt></dt>
<dd><p>A count (integer) value for the resource control.</p></dd>
<dt><tt>bytes</tt></dt>
<dd><p>Unit of size for the resource control.</p></dd>
</dl>
<p>Use the <tt>prctl</tt> command to display local values and actions for the resource
control.</p><pre>$ <tt><b>prctl -n process.max-cpu-time $$</b></tt>
    process 353939: -ksh
    NAME    PRIVILEGE    VALUE    FLAG   ACTION              RECIPIENT
 process.max-cpu-time
         privileged   18.4Es    inf   signal=XCPU                 -
         system       18.4Es    inf   none </pre><p><a name="indexterm-52"></a>The <tt>max</tt> (RCTL_LOCAL_MAXIMAL) flag is set for both threshold values, and the <tt>inf</tt>
(RCTL_GLOBAL_INFINITE) flag is defined for this resource control. An <tt>inf</tt> value has an infinite
quantity. The value is never enforced. Hence, as configured, both threshold quantities represent
infinite values that are never exceeded.</p>

<a name="rmctrls-10"></a><h4>Resource Control Enforcement</h4>
<p>More than one resource control can exist on a resource. A resource
control can exist at each containment level in the process model. If resource
controls are active on the same resource at different container levels, the smallest container's
control is enforced first. Thus, action is taken on <tt>process.max-cpu-time</tt> before <tt>task.max-cpu-time</tt>
if both controls are encountered simultaneously.</p><a name="rmctrl-fig-11"></a><h6>Figure&nbsp;6-1 Process Collectives, Container Relationships, and Their Resource Control Sets</h6><img src="figures/rm_multictrl.gif" alt="Diagram shows enforcement of each resource control at its containment level."></img>

<a name="rmctrls-11"></a><h4>Global Monitoring of Resource Control Events</h4>
<p>Often, the resource consumption of processes is unknown. To get more information, try
using the global resource control actions that are available with the <tt>rctladm</tt> command.
Use <tt>rctladm</tt> to establish a <tt>syslog</tt> action on a resource control. Then, if any
entity managed by that resource control encounters a threshold value, a system message
is logged at the configured logging level. See <a href="rmctrls.task-1.html">Chapter&nbsp;7, Administering Resource Controls (Tasks)</a> and the <a href="http://docs.sun.com/doc/819-2240/rctladm-1m?a=view"><tt>rctladm</tt>(1M)</a>
man page for more information.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="rmctrls-2.html">Previous</a>
             </td>
             <td align="right">
                 <a href="rmctrls-12.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

