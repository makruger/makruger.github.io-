<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Using Solaris Auditing in Zones - System Administration Guide:  Virtualization Using the Solaris Operating System</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-04-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide:  Virtualization Using the Solaris Operating System</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="z.admin.ov-29.html">Previous</a>
             </td>
             <td align="right">
                 <a href="z.admin.ov-21.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="preface-3.html">Solaris Virtualization Product Overview</a></p>
<p class="toc level1 tocsp"><a href="resource.html">Part&nbsp;I&nbsp;Resource Management</a></p>
<p class="toc level2"><a href="rmintro-1.html">1.&nbsp;&nbsp;Introduction to Solaris Resource Management</a></p>
<p class="toc level2"><a href="rmtaskproj-1.html">2.&nbsp;&nbsp;Projects and Tasks (Overview)</a></p>
<p class="toc level2"><a href="rmtaskproj.task-37.html">3.&nbsp;&nbsp;Administering Projects and Tasks</a></p>
<p class="toc level2"><a href="rmacct-1.html">4.&nbsp;&nbsp;Extended Accounting (Overview)</a></p>
<p class="toc level2"><a href="rmacct.task.sgm.html">5.&nbsp;&nbsp;Administering Extended Accounting (Tasks)</a></p>
<p class="toc level2"><a href="rmctrls-1.html">6.&nbsp;&nbsp;Resource Controls (Overview)</a></p>
<p class="toc level2"><a href="rmctrls.task-1.html">7.&nbsp;&nbsp;Administering Resource Controls (Tasks)</a></p>
<p class="toc level2"><a href="rmfss-1.html">8.&nbsp;&nbsp;Fair Share Scheduler (Overview)</a></p>
<p class="toc level2"><a href="rmfss.task-1.html">9.&nbsp;&nbsp;Administering the Fair Share Scheduler (Tasks)</a></p>
<p class="toc level2"><a href="rm.rcapd-1.html">10.&nbsp;&nbsp;Physical Memory Control Using the Resource Capping Daemon (Overview)</a></p>
<p class="toc level2"><a href="rm.rcapd.task-1.html">11.&nbsp;&nbsp;Administering the Resource Capping Daemon (Tasks)</a></p>
<p class="toc level2"><a href="rmpool-1.html">12.&nbsp;&nbsp;Resource Pools (Overview)</a></p>
<p class="toc level2"><a href="rmpool.task-1.html">13.&nbsp;&nbsp;Creating and Administering Resource Pools (Tasks)</a></p>
<p class="toc level2"><a href="rmconfig-1.html">14.&nbsp;&nbsp;Resource Management Configuration Example</a></p>
<p class="toc level2"><a href="rmconsole-1.html">15.&nbsp;&nbsp;Resource Control Functionality in the Solaris Management Console</a></p>
<p class="toc level1 tocsp"><a href="zone.html">Part&nbsp;II&nbsp;Zones</a></p>
<p class="toc level2"><a href="zones.intro-1.html">16.&nbsp;&nbsp;Introduction to Solaris Zones</a></p>
<p class="toc level2"><a href="z.config.ov-1.html">17.&nbsp;&nbsp;Non-Global Zone Configuration (Overview)</a></p>
<p class="toc level2"><a href="z.conf.start-1.html">18.&nbsp;&nbsp;Planning and Configuring Non-Global Zones (Tasks)</a></p>
<p class="toc level2"><a href="z.inst.ov-1.html">19.&nbsp;&nbsp;About Installing, Halting, Cloning, and Uninstalling Non-Global Zones (Overview)</a></p>
<p class="toc level2"><a href="z.inst.task-1.html">20.&nbsp;&nbsp;Installing, Booting, Halting, Uninstalling,  and Cloning Non-Global Zones (Tasks)</a></p>
<p class="toc level2"><a href="z.login.ov-1.html">21.&nbsp;&nbsp;Non-Global Zone Login (Overview)</a></p>
<p class="toc level2"><a href="z.login.task-1.html">22.&nbsp;&nbsp;Logging In to Non-Global Zones (Tasks)</a></p>
<p class="toc level2"><a href="gcgnc.html">23.&nbsp;&nbsp;Moving and Migrating Non-Global Zones (Tasks)</a></p>
<p class="toc level2"><a href="z.pkginst.ov-1.html">24.&nbsp;&nbsp;About Packages and Patches on a Solaris System With Zones Installed (Overview)</a></p>
<p class="toc level2"><a href="z.pkginst.task-1.html">25.&nbsp;&nbsp;Adding and Removing Packages and Patches on a Solaris System With Zones Installed (Tasks)</a></p>
<p class="toc level2"><a href="z.admin.ov-1.html">26.&nbsp;&nbsp;Solaris Zones Administration (Overview)</a></p>
<p class="toc level3"><a href="z.admin.ov-4.html">Global Zone Visibility and Access</a></p>
<p class="toc level3"><a href="z.admin.ov-22.html">Process ID Visibility in Zones</a></p>
<p class="toc level3"><a href="z.admin.ov-24.html">System Observability in Zones</a></p>
<p class="toc level3"><a href="z.admin.ov-11.html">Non-Global Zone Node Name</a></p>
<p class="toc level3"><a href="z.admin.ov-2.html">File Systems and Non-Global Zones</a></p>
<p class="toc level3"><a href="z.admin.ov-9.html">Networking in Shared-IP Non-Global Zones</a></p>
<p class="toc level3"><a href="gelkh.html">Networking in Exclusive-IP Non-Global Zones</a></p>
<p class="toc level3"><a href="z.admin.ov-13.html">Device Use in Non-Global Zones</a></p>
<p class="toc level3"><a href="z.admin.ov-42.html">Running Applications in Non-Global Zones</a></p>
<p class="toc level3"><a href="z.admin.ov-3.html">Resource Controls Used in Non-Global Zones</a></p>
<p class="toc level3"><a href="z.admin.ov-43.html">Fair Share Scheduler on a Solaris System With Zones Installed</a></p>
<p class="toc level3"><a href="z.admin.ov-6.html">Extended Accounting on a Solaris System With Zones Installed</a></p>
<p class="toc level3"><a href="z.admin.ov-18.html">Privileges in a Non-Global Zone</a></p>
<p class="toc level3"><a href="z.admin.ov-29.html">Using IP Security Architecture in Zones</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Using Solaris Auditing in Zones</a></p>
</div>
<p class="toc level3"><a href="z.admin.ov-21.html">Core Files in Zones</a></p>
<p class="toc level3"><a href="gcogk.html">Running DTrace in a Non-Global Zone</a></p>
<p class="toc level3"><a href="gbrho.html">About Backing Up a Solaris System With Zones Installed</a></p>
<p class="toc level3"><a href="gbrhi.html">Determining What to Back Up in Non-Global Zones</a></p>
<p class="toc level3"><a href="gbrip.html">About Restoring Non-Global Zones</a></p>
<p class="toc level3"><a href="z.admin.ov-32.html">Commands Used on a Solaris System With Zones Installed</a></p>
<p class="toc level2 tocsp"><a href="z.admin.task-1.html">27.&nbsp;&nbsp;Administering Solaris Zones (Tasks)</a></p>
<p class="toc level2"><a href="gclkx.html">28.&nbsp;&nbsp;Troubleshooting Miscellaneous Solaris Zones Problems</a></p>
<p class="toc level1 tocsp"><a href="gchhk.html">Part&nbsp;III&nbsp;Branded Zones</a></p>
<p class="toc level2"><a href="gchhy.html">29.&nbsp;&nbsp;About Branded Zones and the Linux Branded Zone</a></p>
<p class="toc level2"><a href="gcwwm.html">30.&nbsp;&nbsp;Planning the <tt>lx</tt> Branded Zone Configuration (Overview)</a></p>
<p class="toc level2"><a href="gdajn.html">31.&nbsp;&nbsp;Configuring the <tt>lx</tt> Branded Zone (Tasks)</a></p>
<p class="toc level2"><a href="gdbki.html">32.&nbsp;&nbsp;About Installing, Booting, Halting, Cloning, and Uninstalling <tt>lx</tt> Branded Zones (Overview)</a></p>
<p class="toc level2"><a href="gdduh.html">33.&nbsp;&nbsp;Installing, Booting, Halting, Uninstalling and Cloning <tt>lx</tt> Branded Zones (Tasks)</a></p>
<p class="toc level2"><a href="gdgck.html">34.&nbsp;&nbsp;Logging In to <tt>lx</tt> Branded Zones (Tasks)</a></p>
<p class="toc level2"><a href="gdqnv.html">35.&nbsp;&nbsp;Moving and Migrating <tt>lx</tt> Branded Zones (Tasks)</a></p>
<p class="toc level2"><a href="gdgif.html">36.&nbsp;&nbsp;Administering and Running Applications in <tt>lx</tt> Branded Zones (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="gefwp.html">Part&nbsp;IV&nbsp;Sun xVM</a></p>
<p class="toc level2"><a href="gfwrc.html">37.&nbsp;&nbsp;Sun xVM Hypervisor System Requirements</a></p>
<p class="toc level2"><a href="gefwo.html">38.&nbsp;&nbsp;Booting and Running the Sun xVM Hypervisor</a></p>
<p class="toc level2"><a href="gfwcu.html">39.&nbsp;&nbsp;Xvnc</a></p>
<p class="toc level2"><a href="gfqke.html">40.&nbsp;&nbsp;Using <tt>virt-install</tt> to Install a Domain</a></p>
<p class="toc level2"><a href="gfwlm.html">41.&nbsp;&nbsp;xVM System Administration</a></p>
<p class="toc level2"><a href="gefzh.html">42.&nbsp;&nbsp;Troubleshooting Miscellaneous Sun xVM Problems</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="z.admin.ov-20"></a><h3>Using Solaris Auditing in Zones</h3>
<p>Solaris auditing is described in <a href="http://docs.sun.com/doc/819-3321/auditov-1?a=view">Chapter 28, Solaris Auditing (Overview), in <i>System Administration Guide: Security Services</i></a>. For zones considerations associated with auditing, see
the following sections:</p>
<ul><li><p><a href="http://docs.sun.com/doc/819-3321/auditplan-1?a=view">Chapter 29, Planning for Solaris Auditing, in <i>System Administration Guide: Security Services</i></a></p></li>
<li><p><a href="http://docs.sun.com/doc/819-3321/auditref-28?a=view">Auditing and Solaris Zones in <i>System Administration Guide: Security Services</i></a></p></li></ul>
<p>An audit record describes an event, such as logging in to a
system or writing to a file. The record is composed of tokens, which
are sets of audit data. By using the <tt>zonename</tt> token, you can configure
Solaris auditing to identify audit events by zone. Use of the <tt>zonename</tt> token allows
you to produce the following information:</p>
<ul><li><p>Audit records that are marked with the name of the zone that generated the record</p></li>
<li><p>An audit log for a specific zone that the global administrator can make available to the zone administrator</p></li></ul>


<a name="z.admin.ov-27"></a><h4>Configuring Audit in the Global Zone</h4>
<p>Solaris audit trails are configured in the global zone. Audit policy is set
in the global zone and applies to processes in all zones. The
audit records can be marked with the name of the zone in which
the event occurred. To include zone names in audit records, you must edit
the <tt>/etc/security/audit_startup</tt> file before you install any non-global zones. The zone name
selection is case-sensitive.</p><p>To configure auditing in the global zone to include all zone audit
records, add this line to the <tt>/etc/security/audit_startup</tt> file:</p><pre>/usr/sbin/auditconfig -setpolicy +zonename</pre><p>As the global administrator in the global zone, execute the <tt>auditconfig</tt> utility:</p><pre>global# <tt><b>auditconfig -setpolicy +zonename</b></tt></pre><p>For additional information, see the <a href="http://docs.sun.com/doc/819-2240/audit-startup-1m?a=view"><tt>audit_startup</tt>(1M)</a> and <a href="http://docs.sun.com/doc/819-2240/auditconfig-1m?a=view"><tt>auditconfig</tt>(1M)</a> man pages and &ldquo;Configuring
Audit Files (Task Map)&rdquo; in <i>System Administration Guide: Security Services</i>.</p>

<a name="z.admin.ov-30"></a><h4>Configuring User Audit Characteristics in a Non-Global Zone</h4>
<p>When a non-global zone is installed, the <tt>audit_control</tt> file and the <tt>audit_user</tt> file
in the global zone are copied to the zone's <tt>/etc/security</tt> directory. These files
might require modification to reflect the zone's audit needs.</p><p>For example, each zone can be configured to audit some users differently from
others. To apply different per-user preselection criteria, both the <tt>audit_control</tt> and the
<tt>audit_user</tt> files must be edited. The <tt>audit_user</tt> file in the non-global zone might also
require revisions to reflect the user base for the zone if necessary. Because
each zone can be configured differently with regard to auditing users, it is
possible for the  <tt>audit_user</tt> file to be empty.</p><p>For additional information, see the <a href="http://docs.sun.com/doc/819-2251/audit-control-4?a=view"><tt>audit_control</tt>(4)</a> and <a href="http://docs.sun.com/doc/819-2251/audit-user-4?a=view"><tt>audit_user</tt>(4)</a> man pages.</p>

<a name="z.admin.ov-28"></a><h4>Providing Audit Records for a Specific Non-Global Zone</h4>
<p>By including the <tt>zonename</tt> token as described in <a href="#z.admin.ov-27">Configuring Audit in the Global Zone</a>, Solaris audit records can
be categorized by zone. Records from different zones can then be collected by
using the <tt>auditreduce</tt> command to create logs for a specific zone.</p><p>For more information, see the <a href="http://docs.sun.com/doc/819-2240/audit-startup-1m?a=view"><tt>audit_startup</tt>(1M)</a> and <a href="http://docs.sun.com/doc/819-2240/auditreduce-1m?a=view"><tt>auditreduce</tt>(1M)</a> man pages.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="z.admin.ov-29.html">Previous</a>
             </td>
             <td align="right">
                 <a href="z.admin.ov-21.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

