<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>How Dynamic Resource Allocation Works - System Administration Guide:  Virtualization Using the Solaris Operating System</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-04-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide:  Virtualization Using the Solaris Operating System</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="rmpool-100.html">Previous</a>
             </td>
             <td align="right">
                 <a href="rmpool-107.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="preface-3.html">Solaris Virtualization Product Overview</a></p>
<p class="toc level1 tocsp"><a href="resource.html">Part&nbsp;I&nbsp;Resource Management</a></p>
<p class="toc level2"><a href="rmintro-1.html">1.&nbsp;&nbsp;Introduction to Solaris Resource Management</a></p>
<p class="toc level2"><a href="rmtaskproj-1.html">2.&nbsp;&nbsp;Projects and Tasks (Overview)</a></p>
<p class="toc level2"><a href="rmtaskproj.task-37.html">3.&nbsp;&nbsp;Administering Projects and Tasks</a></p>
<p class="toc level2"><a href="rmacct-1.html">4.&nbsp;&nbsp;Extended Accounting (Overview)</a></p>
<p class="toc level2"><a href="rmacct.task.sgm.html">5.&nbsp;&nbsp;Administering Extended Accounting (Tasks)</a></p>
<p class="toc level2"><a href="rmctrls-1.html">6.&nbsp;&nbsp;Resource Controls (Overview)</a></p>
<p class="toc level2"><a href="rmctrls.task-1.html">7.&nbsp;&nbsp;Administering Resource Controls (Tasks)</a></p>
<p class="toc level2"><a href="rmfss-1.html">8.&nbsp;&nbsp;Fair Share Scheduler (Overview)</a></p>
<p class="toc level2"><a href="rmfss.task-1.html">9.&nbsp;&nbsp;Administering the Fair Share Scheduler (Tasks)</a></p>
<p class="toc level2"><a href="rm.rcapd-1.html">10.&nbsp;&nbsp;Physical Memory Control Using the Resource Capping Daemon (Overview)</a></p>
<p class="toc level2"><a href="rm.rcapd.task-1.html">11.&nbsp;&nbsp;Administering the Resource Capping Daemon (Tasks)</a></p>
<p class="toc level2"><a href="rmpool-1.html">12.&nbsp;&nbsp;Resource Pools (Overview)</a></p>
<p class="toc level3"><a href="rmpool-2.html">Introduction to Resource Pools</a></p>
<p class="toc level3"><a href="gbtkx.html">Introduction to Dynamic Resource Pools</a></p>
<p class="toc level3"><a href="gbvil.html">About Enabling and Disabling Resource Pools and Dynamic Resource Pools</a></p>
<p class="toc level3"><a href="rmpool-114.html">Resource Pools Used in Zones</a></p>
<p class="toc level3"><a href="rmpool-3.html">When to Use Pools</a></p>
<p class="toc level3"><a href="rmpool-12.html">Resource Pools Framework</a></p>
<p class="toc level3"><a href="rmpool-17.html">Implementing Pools on a System</a></p>
<p class="toc level3"><a href="rmpool-117.html"><tt>project.pool</tt> Attribute</a></p>
<p class="toc level3"><a href="rmpool-58.html">SPARC: Dynamic Reconfiguration Operations and Resource Pools</a></p>
<p class="toc level3"><a href="rmpool-9.html">Creating Pools Configurations</a></p>
<p class="toc level3"><a href="rmpool-72.html">Directly Manipulating the Dynamic Configuration</a></p>
<p class="toc level3"><a href="rmpool-73.html"><tt>poold</tt> Overview</a></p>
<p class="toc level3"><a href="gbxvv.html">Managing Dynamic Resource Pools</a></p>
<p class="toc level3"><a href="rmpool-75.html">Configuration Constraints and Objectives</a></p>
<p class="toc level3"><a href="rmpool-100.html"><tt>poold</tt> Features That Can Be Configured</a></p>
<div class="onpage">
<p class="toc level3"><a href="">How Dynamic Resource Allocation Works</a></p>
</div>
<p class="toc level3"><a href="rmpool-107.html">Using <tt>poolstat</tt> to Monitor the Pools Facility and Resource Utilization</a></p>
<p class="toc level3"><a href="rmpool-8.html">Commands Used With the Resource Pools Facility</a></p>
<p class="toc level2 tocsp"><a href="rmpool.task-1.html">13.&nbsp;&nbsp;Creating and Administering Resource Pools (Tasks)</a></p>
<p class="toc level2"><a href="rmconfig-1.html">14.&nbsp;&nbsp;Resource Management Configuration Example</a></p>
<p class="toc level2"><a href="rmconsole-1.html">15.&nbsp;&nbsp;Resource Control Functionality in the Solaris Management Console</a></p>
<p class="toc level1 tocsp"><a href="zone.html">Part&nbsp;II&nbsp;Zones</a></p>
<p class="toc level2"><a href="zones.intro-1.html">16.&nbsp;&nbsp;Introduction to Solaris Zones</a></p>
<p class="toc level2"><a href="z.config.ov-1.html">17.&nbsp;&nbsp;Non-Global Zone Configuration (Overview)</a></p>
<p class="toc level2"><a href="z.conf.start-1.html">18.&nbsp;&nbsp;Planning and Configuring Non-Global Zones (Tasks)</a></p>
<p class="toc level2"><a href="z.inst.ov-1.html">19.&nbsp;&nbsp;About Installing, Halting, Cloning, and Uninstalling Non-Global Zones (Overview)</a></p>
<p class="toc level2"><a href="z.inst.task-1.html">20.&nbsp;&nbsp;Installing, Booting, Halting, Uninstalling,  and Cloning Non-Global Zones (Tasks)</a></p>
<p class="toc level2"><a href="z.login.ov-1.html">21.&nbsp;&nbsp;Non-Global Zone Login (Overview)</a></p>
<p class="toc level2"><a href="z.login.task-1.html">22.&nbsp;&nbsp;Logging In to Non-Global Zones (Tasks)</a></p>
<p class="toc level2"><a href="gcgnc.html">23.&nbsp;&nbsp;Moving and Migrating Non-Global Zones (Tasks)</a></p>
<p class="toc level2"><a href="z.pkginst.ov-1.html">24.&nbsp;&nbsp;About Packages and Patches on a Solaris System With Zones Installed (Overview)</a></p>
<p class="toc level2"><a href="z.pkginst.task-1.html">25.&nbsp;&nbsp;Adding and Removing Packages and Patches on a Solaris System With Zones Installed (Tasks)</a></p>
<p class="toc level2"><a href="z.admin.ov-1.html">26.&nbsp;&nbsp;Solaris Zones Administration (Overview)</a></p>
<p class="toc level2"><a href="z.admin.task-1.html">27.&nbsp;&nbsp;Administering Solaris Zones (Tasks)</a></p>
<p class="toc level2"><a href="gclkx.html">28.&nbsp;&nbsp;Troubleshooting Miscellaneous Solaris Zones Problems</a></p>
<p class="toc level1 tocsp"><a href="gchhk.html">Part&nbsp;III&nbsp;Branded Zones</a></p>
<p class="toc level2"><a href="gchhy.html">29.&nbsp;&nbsp;About Branded Zones and the Linux Branded Zone</a></p>
<p class="toc level2"><a href="gcwwm.html">30.&nbsp;&nbsp;Planning the <tt>lx</tt> Branded Zone Configuration (Overview)</a></p>
<p class="toc level2"><a href="gdajn.html">31.&nbsp;&nbsp;Configuring the <tt>lx</tt> Branded Zone (Tasks)</a></p>
<p class="toc level2"><a href="gdbki.html">32.&nbsp;&nbsp;About Installing, Booting, Halting, Cloning, and Uninstalling <tt>lx</tt> Branded Zones (Overview)</a></p>
<p class="toc level2"><a href="gdduh.html">33.&nbsp;&nbsp;Installing, Booting, Halting, Uninstalling and Cloning <tt>lx</tt> Branded Zones (Tasks)</a></p>
<p class="toc level2"><a href="gdgck.html">34.&nbsp;&nbsp;Logging In to <tt>lx</tt> Branded Zones (Tasks)</a></p>
<p class="toc level2"><a href="gdqnv.html">35.&nbsp;&nbsp;Moving and Migrating <tt>lx</tt> Branded Zones (Tasks)</a></p>
<p class="toc level2"><a href="gdgif.html">36.&nbsp;&nbsp;Administering and Running Applications in <tt>lx</tt> Branded Zones (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="gefwp.html">Part&nbsp;IV&nbsp;Sun xVM</a></p>
<p class="toc level2"><a href="gfwrc.html">37.&nbsp;&nbsp;Sun xVM Hypervisor System Requirements</a></p>
<p class="toc level2"><a href="gefwo.html">38.&nbsp;&nbsp;Booting and Running the Sun xVM Hypervisor</a></p>
<p class="toc level2"><a href="gfwcu.html">39.&nbsp;&nbsp;Xvnc</a></p>
<p class="toc level2"><a href="gfqke.html">40.&nbsp;&nbsp;Using <tt>virt-install</tt> to Install a Domain</a></p>
<p class="toc level2"><a href="gfwlm.html">41.&nbsp;&nbsp;xVM System Administration</a></p>
<p class="toc level2"><a href="gefzh.html">42.&nbsp;&nbsp;Troubleshooting Miscellaneous Sun xVM Problems</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="rmpool-81"></a><h3>How Dynamic Resource Allocation Works</h3>
<p>This section explains the process and the factors that <tt>poold</tt> uses to dynamically
allocate resources.</p>

<a name="rmpool-86"></a><h4>About Available Resources</h4>
<p>Available resources are considered to be all of the resources that are available
for use within the scope of the <tt>poold</tt> process. The scope of control
is at most a single Solaris instance.</p><p>On a system that has zones enabled, the scope of an executing
instance of <tt>poold</tt> is limited to the global zone.</p>

<a name="rmpool-82"></a><h4>Determining Available Resources</h4>
<p>Resource pools encompass all of the system resources that are available for consumption
by applications.</p><p>For a single executing Solaris instance, a resource of a single type, such
as a CPU, must be allocated to a single partition. There can
be one or more partitions for each type of resource. Each partition contains
a unique set of resources.</p><p>For example, a machine with four CPUs and two processor sets can
have the following setup:</p><p>pset 0: 0 1</p><p>pset 1: 2 3</p><p>where 0, 1, 2 and 3 after the colon represent CPU IDs.
Note that the two processor sets account for all four CPUs.</p><p>The same machine cannot have the following setup:</p><p>pset 0: 0 1</p><p>pset 1: 1 2 3</p><p>It cannot have this setup because CPU 1 can appear in only
one pset at a time.</p><p>Resources cannot be accessed from any partition other than the partition to which
they belong.</p><p>To discover the available resources, <tt>poold</tt> interrogates the active pools configuration to find
partitions. All resources within all partitions are summed to determine the total amount
of available resources for each type of resource that is controlled.</p><p>This quantity of resources is the basic figure that <tt>poold</tt> uses in its
operations. However, there are constraints upon this figure that limit the flexibility that
<tt>poold</tt> has to make allocations. For information about available constraints, see <a href="rmpool-75.html#rmpool-76">Configuration Constraints</a>.</p>

<a name="rmpool-87"></a><h4>Identifying a Resource Shortage</h4>
<p><a name="indexterm-112"></a>The control scope for <tt>poold</tt> is defined as the set of available resources
for which <tt>poold</tt> has primary responsibility for effective partitioning and management. However, other mechanisms
that are allowed to manipulate resources within this control scope can still affect
a configuration. If a partition should move out of control while <tt>poold</tt> is
active, <tt>poold</tt> tries to restore control through the judicious manipulation of available resources. If
<tt>poold</tt> cannot locate additional resources within its scope, then the daemon logs information
about the resource shortage.</p>

<a name="rmpool-88"></a><h4>Determining Resource Utilization</h4>
<p><tt>poold</tt> typically spends the greatest amount of time observing the usage of the
resources within its scope of control. This monitoring is performed to verify that
workload-dependent objectives are being met.</p><p>For example, for processor sets, all measurements are made across all of the
processors in a set. The resource utilization shows the proportion of time that
the resource is in use over the sample interval. Resource utilization is displayed
as a percentage from 0 to 100.</p>

<a name="rmpool-89"></a><h4>Identifying Control Violations</h4>
<p><a name="indexterm-113"></a><a name="indexterm-114"></a>The directives described in <a href="rmpool-75.html">Configuration Constraints and Objectives</a> are used to detect the approaching failure of
a system to meet its objectives. These objectives are directly related to workload.</p><p>A partition that is not meeting user-configured objectives is a control violation. The
two types of control violations are synchronous and asynchronous.</p>
<ul><li><p>A synchronous violation of an objective is detected by the daemon in the course of its workload monitoring.</p></li>
<li><p>An asynchronous violation of an objective occurs independently of monitoring action by the daemon.</p></li></ul>
<p>The following events cause asynchronous objective violations:</p>
<ul><li><p>Resources are added to or removed from a control scope.</p></li>
<li><p>The control scope is reconfigured.</p></li>
<li><p>The <tt>poold</tt> resource controller is restarted.</p></li></ul>
<p>The contributions of objectives that are not related to workload are assumed to
remain constant between evaluations of the objective function. Objectives that are not related
to workload are only reassessed when a reevaluation is triggered through one of
the asynchronous violations.</p>

<a name="rmpool-91"></a><h4>Determining Appropriate Remedial Action</h4>
<p>When the resource controller determines that a resource consumer is short of resources,
the initial response is that increasing the resources will improve performance.</p><p>Alternative configurations that meet the objectives specified in the configuration for the scope
of control are examined and evaluated.</p><p>This process is refined over time as the results of shifting resources are
monitored and each resource partition is evaluated for responsiveness. The decision history is
consulted to eliminate reconfigurations that did not show improvements in attaining the objective
function in the past. Other information, such as process names and quantities, are
used to further evaluate the relevance of the historical data.</p><p>If the daemon cannot take corrective action, the condition is logged. For more
information, see <a href="rmpool-100.html#rmpool-95"><tt>poold</tt> Logging Information</a>.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="rmpool-100.html">Previous</a>
             </td>
             <td align="right">
                 <a href="rmpool-107.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

