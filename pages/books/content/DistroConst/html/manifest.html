<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">

<!--   The contents of this Documentation are subject to the Public Documentation
License Version 1.01 (the "License"); you may only use this Documentation if
you comply with the terms of this License. A copy of the License is
available at http://www.opensolaris.org/os/community/documentation/license.
  -->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Editing the Manifest Files - OpenSolaris Distribution Constructor Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2009-06-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/opensol.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.com"><img border="0" src="graphics/opensolaris_logo_trans.png"></img></a>
   </div>
   <div class="Title">OpenSolaris Distribution Constructor Guide</div>
</div>
<div class="headerbar"></div>


<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="using.html">Previous</a>
             </td>
             <td align="right">
                 <a href="scripts.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="index.html">1.&nbsp;&nbsp;Introduction to the Distribution Constructor</a></p>
<p class="toc level1 tocsp"><a href="setup.html">2.&nbsp;&nbsp;Setup for the Distribution Constructor</a></p>
<p class="toc level1 tocsp"><a href="using.html">3.&nbsp;&nbsp;Using the Distribution Constructor</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Editing the Manifest Files</a></p>
</div>
<p class="toc level2"><a href="scripts.html">Using the Finalizer Scripts</a></p>
<p class="toc level2"><a href="distro_const.html">Creating an Image</a></p>
<p class="toc level2"><a href="command.html"><tt>distro_const</tt> Command Reference</a></p>
<p class="toc level2"><a href="trouble.html">Troubleshooting</a></p>
<p class="toc level2"><a href="addl.html">Additional Information</a></p>
<p class="toc level1 tocsp"><a href="appendix.html">4.&nbsp;&nbsp;Appendix: Sample Manifest File</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="manifest"></a><h3>Editing the Manifest Files</h3>
<p>The <tt>SUNWdistro-const</tt> package that you installed on your system includes default manifest files.
These XML manifest files provide the distribution constructor with the blueprints that specify
the contents and parameters of the image that you plan to build. </p><p>The default manifest files included in the <tt>SUNWdistro-const</tt> package are:</p>
<ul><li><p><b>Manifest for x86 ISO image &ndash;</b> Located at <tt>/usr/share/distro_const/slim_cd/all_lang_slim_cd_x86.xml</tt>, this manifest is used to create an ISO image comparable to the OpenSolaris 2009.06 Live CD. To view the contents of the x86 Slim CD manifest, see <a href="appendix.html">Chapter&nbsp;4, Appendix: Sample Manifest File</a>.</p></li>
<li><p><b>Manifest for SPARC AI ISO image &ndash;</b> Located at <tt>/usr/share/distro_const/auto_install/ai_sparc_image.xml</tt>, this manifest is used to create a SPARC AI ISO image for automated installations of the OpenSolaris OS to SPARC clients.</p></li>
<li><p><b>Manifest for x86 AI ISO image &ndash;</b> Located at <tt>/usr/share/distro_const/auto_install/ai_x86_image.xml</tt>, this manifest is used to create an x86 AI ISO image for automated installations of the OpenSolaris OS to x86 clients.</p></li></ul>
<p>You do not need to modify the default manifest files. However, you
can edit them if you wish. The following table summaries some of the
key sections in the manifest file and provides further instructions about how you
can customize these sections.</p>
<hr><p><b>Note - </b>When using the distribution constructor, you can only create SPARC images on a
SPARC system. And, you can only create x86 images on an x86
system.</p>
<hr>
<a name="mantbl"></a><h6>Table&nbsp;3-1 Primary Manifest Sections</h6><table><col width="28%"><col width="71%"><tr><th align="left" valign="top" scope="column"><p>Section XML Tags</p></th>
<th align="left" valign="top" scope="column"><p>Description of Required Manual Edits</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>&lt;distribution name="OpenSolaris"></tt></p></td>
<td align="left" valign="top" scope="row"><p>This section provides a default name
for the distribution.</p><p>You can leave the default name or type a unique
name for your distribution.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>&lt;checkpoint_enable></tt></p></td>
<td align="left" valign="top" scope="row"><p>The default setting in this section enables checkpointing when
you create the image. You can use checkpointing to pause while building an
image for testing purposes. Checkpointing is described later in this topic.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>&lt;pkg_repo_default_authority></tt></p></td>
<td align="left" valign="top" scope="row"><p>This section specifies
the location of the IPS repository. The constructor accesses the repository and retrieves
packages for the image when the image is being built. The default repository
location is <a href="http://pkg.opensolaris.org/release">http://pkg.opensolaris.org/release</a>.</p><p>If you do not want to use the opensolaris.org repository,
modify this location to point to the repository of your choice. To view
a list of some of the alternate repositories, see <a href="http://dlc.sun.com/osol/docs/content/2009.06/IMGPACKAGESYS/giifx.html">OpenSolaris Repositories</a>.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>&lt;packages></tt></p></td>
<td align="left" valign="top" scope="row"><p>This section lists the
packages to be included in the image.</p><p>If you have packages that you
want to add to the image, list your packages in this field, one
package per line.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>&lt;bootroot_contents></tt></p></td>
<td align="left" valign="top" scope="row"><p>This section lists the default files and directories that will
be included in the boot root for the image that is built. Files
or directories that need to be excluded from the image are specified with
the <tt>base_exclude</tt> tag.</p>
<hr><p><b>Caution - </b>It is recommended that you <b>not</b> edit the boot root contents
with the following exception. Modifying the boot root contents might cause the system
to fail to boot.</p>
<hr>
<p>The root archive for x86 images differs from the
root archive for SPARC images. The whole root archive, or bootroot, for x86
images is a UFS filesystem, compressed by using <tt>lzma</tt>.  The SPARC platform
does not support the compression of the whole root archive in this way.
 Instead, SPARC root archives use DCFS, which compress each file individually. These
individually compressed files might require specific handling in the manifest.</p><p>During boot time, some
of the files in the root archive need to be modified. But, compressed
files cannot be modified. Therefore, for SPARC images, you need to specify in
the manifest which files should not be compressed. In the finalizer section of
the manifest, find the reference to the <tt>boot_archive.py</tt> script. By default, this
script specifies that all the files and directories in the <tt>/boot/solaris/filelist.ramdisk</tt> file, and
all the files and subdirectories under the <tt>usr/kernel</tt> directory, are uncompressed. You must specify
any additional files that need to be in uncompressed state in the bootroot
by setting the <tt>fiocompress=false</tt> option in the manifest for those files.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>&lt;build_area></tt></p></td>
<td align="left" valign="top" scope="row"><p>This section
specifies the area where the image will be created.</p><p>You must check that
the package image area specified is valid for your system and revise as
needed.</p><p>If you want to use checkpointing, you must specify a ZFS dataset,
or a mount point that correlates to a ZFS dataset, as your build
area. If the ZFS dataset does not exist, it will be created. The
zpool that you specify, however, must already exist.</p><p>If you do not want to
use checkpointing, you can use either a regular mount point or a ZFS
or UFS file system.</p>
<hr><p><b>Note - </b>After an image has been created, the build area
for that image has the following structure.</p>
<ul><li><p><tt>&lt;build_area>/build_data/pkg_image</tt> &ndash; Package image area.</p></li>
<li><p><tt>&lt;build_area>/build_data/bootroot</tt> &ndash; Boot root build area.</p></li>
<li><p><tt>&lt;build_area>/build_data/tmp</tt> &ndash; Temporary directory used by constructor and finalizer scripts.</p></li>
<li><p><tt>&lt;build_area>/media</tt> &ndash; Area where the output images are placed.</p></li>
<li><p><tt>&lt;build_area>/logs</tt> &ndash; Area that holds log files which record the steps executed by the application and the output from all commands.</p><p>The &ldquo;simple&rdquo; log, named <tt>simple-log-YYYY-MM-DD-HH-Mi-SS</tt>, contains only errors. The &ldquo;detail&rdquo; log, named <tt>detail-log-YYYY-MM-DD-HH-Mi-SS</tt>, contains informational output and errors. The console echos information in the &ldquo;simple&rdquo; log file.</p></li></ul>

<hr>
</td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>&lt;finalizer></tt></p></td>
<td align="left" valign="top" scope="row"><p>This section specifies the finalizer scripts that
the distribution constructor invokes and the order in which the distribution constructor invokes
them.</p><p>Default finalizer scripts are provided in the <tt>distro_const</tt> package and automatically referenced
in this section of the manifest file. You do not need to edit
this section unless you add new finalizer scripts, or you change the name
or the <tt>argslist</tt> of existing scripts.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>&lt;key_value_pairs></tt></p></td>
<td align="left" valign="top" scope="row"><p>This section specifies additional parameters that are
needed by the distribution constructor or by the finalizer scripts. Default parameters are provided.</p><p>You
do not need to edit the default key-value pairs except to add
new ones that will be recognized by new or customized finalizer scripts.</p></td>
</tr>
</table><p>You can either use one of the default manifest files, or you
can copy a default manifest and create a custom manifest file with a
new file name. You will reference the manifest file by name when you
use the <tt>distro_const</tt> command to create an image.</p><p>If the default scripts do not leave the <tt>build_area</tt> as you need
it, you can create your own scripts to make further modifications. If you
do create new scripts, you'll need to update the script references in the
finalizer section of the manifest file.</p>
<hr><p><b>Note - </b>Always backup the original manifest file and the default scripts before copying them.
Your custom scripts are not supported.</p>
<hr>
<p>When you have completed any revisions to the manifest file and, optionally, customized
the finalizer scripts as described in the next section, you can proceed with
running the <tt>distro_const</tt> utility to create an image.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="using.html">Previous</a>
             </td>
             <td align="right">
                 <a href="scripts.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

