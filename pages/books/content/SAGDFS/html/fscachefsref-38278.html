<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Collecting CacheFS Statistics - System Administration Guide: Devices and File Systems</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-01-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: Devices and File Systems</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="fscachefsref-26610.html">Previous</a>
             </td>
             <td align="right">
                 <a href="fsswap-14677.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="vol1preface-11.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="medintro-55492.html">1.&nbsp;&nbsp;Managing Removable Media (Overview)</a></p>
<p class="toc level1 tocsp"><a href="medformat-83002.html">2.&nbsp;&nbsp;Managing Removable Media (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="medaccess-29267.html">3.&nbsp;&nbsp;Accessing Removable Media (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="medcdrw-1.html">4.&nbsp;&nbsp;Writing CDs and DVDs (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="devconfig-27900.html">5.&nbsp;&nbsp;Managing Devices (Overview/Tasks)</a></p>
<p class="toc level1 tocsp"><a href="devconfig2-1.html">6.&nbsp;&nbsp;Dynamically Configuring Devices (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="devusbover-24.html">7.&nbsp;&nbsp;Using USB Devices (Overview)</a></p>
<p class="toc level1 tocsp"><a href="devusbtasks-1.html">8.&nbsp;&nbsp;Using USB Devices (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fncpk.html">9.&nbsp;&nbsp;Using InfiniBand Devices (Overview/Tasks)</a></p>
<p class="toc level1 tocsp"><a href="disksconcepts-29477.html">10.&nbsp;&nbsp;Managing Disks (Overview)</a></p>
<p class="toc level1 tocsp"><a href="disksprep-31030.html">11.&nbsp;&nbsp;Administering Disks (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="diskssadd-16103.html">12.&nbsp;&nbsp;SPARC: Adding a Disk (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="disksxadd-38159.html">13.&nbsp;&nbsp;x86: Adding a Disk (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fmvcd.html">14.&nbsp;&nbsp;Configuring Solaris iSCSI Targets and Initiators (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="gfydr.html">15.&nbsp;&nbsp;Configuring and Managing the Solaris Internet Storage Name Service (iSNS)</a></p>
<p class="toc level1 tocsp"><a href="disksformat-15833.html">16.&nbsp;&nbsp;The <tt>format</tt> Utility (Reference)</a></p>
<p class="toc level1 tocsp"><a href="fsoverview-38559.html">17.&nbsp;&nbsp;Managing File Systems (Overview)</a></p>
<p class="toc level1 tocsp"><a href="fscreate-96442.html">18.&nbsp;&nbsp;Creating UFS, TMPFS, and LOFS File Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fsmount-42780.html">19.&nbsp;&nbsp;Mounting and Unmounting File Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fscachefs-70682.html">20.&nbsp;&nbsp;Using The CacheFS File System (Tasks)</a></p>
<p class="toc level2"><a href="fscachefs-16.html">High-Level View of Using the CacheFS File System (Task Map)</a></p>
<p class="toc level2"><a href="fscachefs-14.html">Overview of the CacheFS File System</a></p>
<p class="toc level2"><a href="fscachefs-80158.html">Creating and Mounting a CacheFS File System (Task Map)</a></p>
<p class="toc level3"><a href="fscachefs-80158.html#fscachefs-15053">How to Create the Cache</a></p>
<p class="toc level3"><a href="fscachefs-80158.html#fscachefs-77212">How to Mount a CacheFS File System (<tt>mount</tt>)</a></p>
<p class="toc level3"><a href="fscachefs-80158.html#fscachefs-23416">How to Mount a CacheFS File System (<tt>/etc/vfstab</tt>)</a></p>
<p class="toc level3"><a href="fscachefs-80158.html#fscachefs-54948">How to Mount a CacheFS File System (AutoFS)</a></p>
<p class="toc level2 tocsp"><a href="fscachefs-23.html">Maintaining a CacheFS File System (Task Map)</a></p>
<p class="toc level2"><a href="fscachefs-24.html">Maintaining a CacheFS File System</a></p>
<p class="toc level3"><a href="fscachefs-24.html#fscachefs-58683">How to Display Information About a CacheFS File System</a></p>
<p class="toc level3"><a href="fscachefs-24.html#fscachefs-87412">How to Specify Cache Consistency Checking on Demand</a></p>
<p class="toc level3"><a href="fscachefs-24.html#fscachefs-10353">How to Delete a CacheFS File System</a></p>
<p class="toc level3"><a href="fscachefs-24.html#fscachefs-17439">How to Check the Integrity of a CacheFS File System</a></p>
<p class="toc level2 tocsp"><a href="fscachefs-15.html">Packing a Cached File System (Task Map)</a></p>
<p class="toc level2"><a href="fscachepack-80612.html">Packing a CacheFS File System</a></p>
<p class="toc level3"><a href="fscachepack-80612.html#fscachepack-80613">How to Pack Files in the Cache</a></p>
<p class="toc level3"><a href="fscachepack-80612.html#fscachepack-21">How to Display Packed Files Information</a></p>
<p class="toc level3"><a href="fscachepack-80612.html#fscachepack-17738">How to Create a Packing List</a></p>
<p class="toc level3"><a href="fscachepack-80612.html#fscachepack-5">How to Pack Files in the Cache With a Packing List</a></p>
<p class="toc level3"><a href="fscachepack-80612.html#fscachepack-18">How to Unpack Files or Packing Lists From the Cache</a></p>
<p class="toc level2 tocsp"><a href="fscachefsref-26610.html">Collecting CacheFS Statistics (Task Map)</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Collecting CacheFS Statistics</a></p>
<p class="toc level3"><a href="#fscachefs-5">How to Set Up CacheFS Logging</a></p>
<p class="toc level3"><a href="#fscachefs-8">How to Locate the CacheFS Log File</a></p>
<p class="toc level3"><a href="#fscachefsref-71516">How to View the Working Set (Cache) Size</a></p>
<p class="toc level3"><a href="#fscachefsref-35885">How to View CacheFS Statistics</a></p>
</div>
<p class="toc level1 tocsp"><a href="fsswap-14677.html">21.&nbsp;&nbsp;Configuring Additional Swap Space (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fstroublefsck-61446.html">22.&nbsp;&nbsp;Checking UFS File System Consistency (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fsfilesysappx-94408.html">23.&nbsp;&nbsp;UFS File System (Reference)</a></p>
<p class="toc level1 tocsp"><a href="bkupconcepts-57422.html">24.&nbsp;&nbsp;Backing Up and Restoring File Systems (Overview)</a></p>
<p class="toc level1 tocsp"><a href="bkuptasks2-64128.html">25.&nbsp;&nbsp;Backing Up Files and File Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="bkupsnapshot-2.html">26.&nbsp;&nbsp;Using UFS Snapshots (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="bkuprestoretasks-38055.html">27.&nbsp;&nbsp;Restoring Files and File Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="bkupref-12756.html">28.&nbsp;&nbsp;UFS Backup and Restore Commands (Reference)</a></p>
<p class="toc level1 tocsp"><a href="bkupsavefiles-17924.html">29.&nbsp;&nbsp;Copying UFS Files and File Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="bkuptapedevice-42512.html">30.&nbsp;&nbsp;Managing Tape Drives (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="fscachefsref-38278"></a><h3>Collecting CacheFS Statistics</h3>
<p>Collecting CacheFS statistics enables you to do the following:</p>
<ul><li><p>Determine an appropriate cache size.</p></li>
<li><p>Observe the performance of the cache.</p></li></ul>
<p><a name="indexterm-435"></a><a name="indexterm-436"></a>These statistics help you determine the trade-off between your cache size and the desired
performance of the cache.</p><p>The following table describes the CacheFS statistics commands.</p><table><col width="22.87*"><col width="40.57*"><col width="35.56*"><tr><th align="left" valign="top" scope="column"><p>Command</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>Man Page</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>cachefslog</tt></p></td>
<td align="left" valign="top" scope="row"><p>Specifies the location of
the log file. This command also displays where the statistics are currently being
logged, and enables you to stop logging. </p></td>
<td align="left" valign="top" scope="row"><p><a href="http://docs.sun.com/doc/819-2240/cachefslog-1m?a=view"><tt>cachefslog</tt>(1M)</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>cachefswssize</tt></p></td>
<td align="left" valign="top" scope="row"><p>Interprets the log file to
give a recommended cache size. </p></td>
<td align="left" valign="top" scope="row"><p><a href="http://docs.sun.com/doc/819-2240/cachefswssize-1m?a=view"><tt>cachefswssize</tt>(1M)</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>cachefsstat</tt></p></td>
<td align="left" valign="top" scope="row"><p>Displays statistical information about a specific CacheFS
file system or all CacheFS file systems. The information provided in the command
output is taken directly from the cache. </p></td>
<td align="left" valign="top" scope="row"><p><a href="http://docs.sun.com/doc/819-2240/cachefsstat-1m?a=view"><tt>cachefsstat</tt>(1M)</a></p></td>
</tr>
</table>
<hr><p><b>Note - </b>You can issue the CacheFS statistics commands from any directory. You must be
superuser to issue the <tt>cachefswssize</tt> command.</p>
<hr>
<p>The CacheFS statistics begin accumulating when you create the log file. When the
work session is over, stop the logging by using the <tt>cachefslog</tt> <tt>-h</tt>
command, as described in <a href="#fscachefs-10">How to Stop CacheFS Logging</a>.</p><p>Before using the CacheFS statistics commands, you must do the following:</p>
<ul><li><p>Set up your cache by using the <tt>cfsadmin</tt> command.</p></li>
<li><p>Decide on an appropriate length of time to allow statistical information to collect in the log file you create. The length of time should equal a typical work session. For example, a day, a week, or a month.</p></li>
<li><p>Select a location or path for the log file. Ensure that sufficient space to allows for the growth of the log file. The longer you intend to allow statistical information to collect in the log file, the more space you need.</p></li></ul>

<hr><p><b>Note - </b>The following procedures are presented in a recommended order. This order is not
required.</p>
<hr>


<a name="fscachefs-5"></a><h4>How to Set Up CacheFS Logging</h4><ol>
<li><a name="fscachefs-step-22"></a><b><a name="indexterm-437"></a><a name="indexterm-438"></a>Set up logging.</b><pre>$ <tt><b>cachefslog -f</b></tt> <i>log-file-path /mount-point</i></pre><dl><dt><tt>-f</tt></dt>
<dd><p>Sets up logging.</p></dd>
<dt><i>log-file-path</i></dt>
<dd><p>Specifies the location of the log file. The log file is a standard file you create with an editor, such as vi.</p></dd>
<dt><i>/mount-point</i></dt>
<dd><p>Designates the mount point (CacheFS file system) for which statistics are being collected. </p></dd>
</dl>
</li>
<li><a name="fscachefs-step-6"></a><b>Verify that you correctly set up the log file.</b><pre>$ <tt><b>cachefslog</b></tt> <i>/mount-point</i></pre></li></ol><a name="fncrf"></a>Example&nbsp;20-13 Setting Up CacheFS Logging<p>The following example shows how to set up the <tt>/var/tmp/samlog</tt> log file to
collect statistics about the <tt>/home/sam</tt> directory.</p><pre>$ <tt><b>cachefslog -f /var/tmp/samlog /home/sam</b></tt>
  /var/tmp/samlog: /home/sam</pre>

<a name="fscachefs-8"></a><h4>How to Locate the CacheFS Log File</h4><ul>
<li><b>Display where CacheFS statistics are being logged.</b><pre>$ <tt><b>cachefslog</b></tt> <i>/mount-point</i></pre><p>where <i>/mount-point</i> specifies the CacheFS file system for which you want to view
the statistics.</p><p><a name="indexterm-439"></a><a name="indexterm-440"></a>You can also use the <tt>cachefslog</tt> command with no options to locate a
log file for a particular mount point.</p></li></ul><a name="fapeq"></a>Example&nbsp;20-14 Locating the CacheFS Log File<p>The following example shows what you would see if a log file
has been set up. The location of the log file is <tt>/var/tmp/stufflog</tt>. </p><pre>$ <tt><b>cachefslog /home/stuff</b></tt>
     /var/tmp/stufflog: /home/stuff</pre><p>The following example shows that no log file has been set up
for the specified file system.</p><pre>$ <tt><b>cachefslog /home/zap</b></tt>
    not logged: /home/zap </pre>

<a name="fscachefs-10"></a><h4>How to Stop CacheFS Logging</h4>
<p><a name="indexterm-441"></a><a name="indexterm-442"></a>Use the <tt>cachefslog</tt> <tt>-h</tt> option to stop logging.</p><pre>$ <tt><b>cachefslog -h</b></tt> <i>/mount-point</i></pre><p>The following example shows how to stop logging on <tt>/home/stuff</tt>. </p><pre>$ <tt><b>cachefslog -h /home/stuff</b></tt>
not logged: /home/stuff</pre><p>If you get a system response other than the response specified here, you
did not successfully stop logging. Determine if you are using the correct log
file name and mount point. </p>

<a name="fscachefsref-71516"></a><h4>How to View the Working Set (Cache) Size</h4><p>You might want to check if you need to increase the size
of the cache.  Or, you might want to determine the ideal cache
size based on your activity since you last used the <tt>cachefslog</tt> command for
a particular mount point. </p><ol>
<li><a name="fscachefsref-step-9"></a><b>Become superuser on the client system.</b></li>
<li><a name="fscachefsref-step-10"></a><b>View the current cache size and highest logged cache size.</b><pre># <tt><b>cachefswssize</b></tt> <i>log-file-path</i></pre><p>For more information, see <a href="http://docs.sun.com/doc/819-2240/cachefswssize-1m?a=view"><tt>cachefswssize</tt>(1M)</a>.</p></li></ol><a name="fncrd"></a>Example&nbsp;20-15 Viewing the Working Set (Cache) Size<p>In the following example, the <tt>end size</tt> is the size of the cache at
the time you issued the <tt>cachefswssize</tt> command. The <tt>high water size</tt> is the largest size
of the cache during the timeframe in which logging occurred. </p><pre># <tt><b>cachefswssize /var/tmp/samlog</b></tt>
 
    /home/sam
           end size:  10688k
    high water size:  10704k
 
    /
           end size:   1736k
    high water size:   1736k
 
    /opt
           end size:    128k
    high water size:    128k
 
    /nfs/saturn.dist
           end size:   1472k
    high water size:   1472k
 
    /data/abc
           end size:   7168k
    high water size:   7168k
 
    /nfs/venus.svr4
           end size:   4688k
    high water size:   5000k
 
    /data
           end size:   4992k
    high water size:   4992k
 
    total for cache
       initial size: 110960k
           end size:  30872k
    high water size:  30872k</pre>

<a name="fscachefsref-29413"></a><h4>Viewing CacheFS Statistics</h4>
<p>The following table explains the terminology that is displayed in the statistics output
for CacheFS file systems.</p><a name="fscachefsref-tbl-12"></a><h6>Table&nbsp;20-2 CacheFS Statistics Terminology</h6><table><col width="88*"><col width="308*"><tr><th align="left" valign="top" scope="column"><p>Output Term</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>cache hit rate</tt></p></td>
<td align="left" valign="top" scope="row"><p>The rate of cache hits compared to cache
misses, followed by the actual number of hits and misses. A <b>cache hit</b> occurs when
the user wants to perform an operation on a file or files,
and the file or files are actually in the cache. A <b>cache miss</b> occurs when
the file is not in the cache. The load on the server
is the sum of cache misses, consistency checks, and modifications (modifies).</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>consistency checks</tt></p></td>
<td align="left" valign="top" scope="row"><p>The number of
consistency checks performed, followed by the number that passed, and the number that
failed.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>modifies</tt></p></td>
<td align="left" valign="top" scope="row"><p>The number of modify operations. For example, writes or creates.</p></td>
</tr>
</table>

<a name="fscachefsref-35885"></a><h4>How to View CacheFS Statistics</h4><p><a name="indexterm-443"></a><a name="indexterm-444"></a>View the statistics with the <tt>cachefsstat</tt> command. You can view the statistics at any
time. For example, you do not have to set up logging in
order to view the statistics.</p><ul>
<li><b>View CacheFS statistics.</b><pre>$ <tt><b>cachefsstat</b></tt> <i>/mount-point</i></pre><p>where <i>/mount-point</i> specifies the CacheFS file system for which you want to view
the statistics.</p><p>If you do not specify the mount point, statistics for all mounted CacheFS
file systems will be displayed.</p></li></ul><a name="fapfu"></a>Example&nbsp;20-16 Viewing CacheFS Statistics<p>This example shows how to view statistics on the cached file system,
<tt>/home/sam</tt>.</p><pre>$ <tt><b>cachefsstat /home/sam</b></tt>
        cache hit rate: 73% (1234 hits, 450 misses)
    consistency checks: 700 (650 pass, 50 fail)
              modifies: 321
garbage collection:  0</pre>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="fscachefsref-26610.html">Previous</a>
             </td>
             <td align="right">
                 <a href="fsswap-14677.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

