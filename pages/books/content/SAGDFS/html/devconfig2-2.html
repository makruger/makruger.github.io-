<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Reconfiguration Coordination Manager (RCM) Script Overview - System Administration Guide: Devices and File Systems</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-01-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: Devices and File Systems</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="devconfig2-49.html">Previous</a>
             </td>
             <td align="right">
                 <a href="devconfig2-19.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="vol1preface-11.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="medintro-55492.html">1.&nbsp;&nbsp;Managing Removable Media (Overview)</a></p>
<p class="toc level1 tocsp"><a href="medformat-83002.html">2.&nbsp;&nbsp;Managing Removable Media (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="medaccess-29267.html">3.&nbsp;&nbsp;Accessing Removable Media (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="medcdrw-1.html">4.&nbsp;&nbsp;Writing CDs and DVDs (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="devconfig-27900.html">5.&nbsp;&nbsp;Managing Devices (Overview/Tasks)</a></p>
<p class="toc level1 tocsp"><a href="devconfig2-1.html">6.&nbsp;&nbsp;Dynamically Configuring Devices (Tasks)</a></p>
<p class="toc level2"><a href="devconfig2-6.html">Dynamic Reconfiguration and Hot-Plugging</a></p>
<p class="toc level2"><a href="devconfig2-120.html">SCSI Hot-Plugging With the <tt>cfgadm</tt> Command (Task Map)</a></p>
<p class="toc level2"><a href="devconfig2-8.html">SCSI Hot-Plugging With the <tt>cfgadm</tt> Command</a></p>
<p class="toc level3"><a href="devconfig2-8.html#devconfig2-9">How to Display Information About SCSI Devices</a></p>
<p class="toc level3"><a href="devconfig2-8.html#devconfig2-10">How to Unconfigure a SCSI Controller</a></p>
<p class="toc level3"><a href="devconfig2-8.html#devconfig2-11">How to Configure a SCSI Controller</a></p>
<p class="toc level3"><a href="devconfig2-8.html#devconfig2-12">How to Configure a SCSI Device</a></p>
<p class="toc level3"><a href="devconfig2-8.html#devconfig2-13">How to Disconnect a SCSI Controller</a></p>
<p class="toc level3"><a href="devconfig2-8.html#devconfig2-14">SPARC: How to Connect a SCSI Controller</a></p>
<p class="toc level3"><a href="devconfig2-8.html#devconfig2-15">SPARC: How to Add a SCSI Device to a SCSI Bus</a></p>
<p class="toc level3"><a href="devconfig2-8.html#devconfig2-57">SPARC: How to Replace an Identical Device on a SCSI Controller</a></p>
<p class="toc level3"><a href="devconfig2-8.html#devconfig2-58">SPARC: How to Remove a SCSI Device</a></p>
<p class="toc level3"><a href="devconfig2-8.html#devconfig2-90">How to Resolve a Failed SCSI Unconfigure Operation</a></p>
<p class="toc level2 tocsp"><a href="devconfig2-121.html">PCI or PCIe Hot-Plugging With the <tt>cfgadm</tt> Command (Task Map)</a></p>
<p class="toc level2"><a href="devconfig2-49.html">PCI or PCIe Hot-Plugging With the <tt>cfgadm</tt> Command</a></p>
<p class="toc level3"><a href="devconfig2-49.html#devconfig2-51">How to Display PCI Slot Configuration Information</a></p>
<p class="toc level3"><a href="devconfig2-49.html#devconfig2-54">How to Remove a PCI Adapter Card</a></p>
<p class="toc level3"><a href="devconfig2-49.html#devconfig2-55">How to Add a PCI Adapter Card</a></p>
<div class="onpage">
<p class="toc level2 tocsp"><a href="">Reconfiguration Coordination Manager (RCM) Script Overview</a></p>
</div>
<p class="toc level2"><a href="devconfig2-19.html">RCM Script Tasks</a></p>
<p class="toc level3"><a href="devconfig2-19.html#devconfig2-37">How to Install an RCM Script</a></p>
<p class="toc level3"><a href="devconfig2-19.html#devconfig2-42">How to Remove an RCM Script</a></p>
<p class="toc level3"><a href="devconfig2-19.html#devconfig2-43">How to Test an RCM Script</a></p>
<p class="toc level1 tocsp"><a href="devusbover-24.html">7.&nbsp;&nbsp;Using USB Devices (Overview)</a></p>
<p class="toc level1 tocsp"><a href="devusbtasks-1.html">8.&nbsp;&nbsp;Using USB Devices (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fncpk.html">9.&nbsp;&nbsp;Using InfiniBand Devices (Overview/Tasks)</a></p>
<p class="toc level1 tocsp"><a href="disksconcepts-29477.html">10.&nbsp;&nbsp;Managing Disks (Overview)</a></p>
<p class="toc level1 tocsp"><a href="disksprep-31030.html">11.&nbsp;&nbsp;Administering Disks (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="diskssadd-16103.html">12.&nbsp;&nbsp;SPARC: Adding a Disk (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="disksxadd-38159.html">13.&nbsp;&nbsp;x86: Adding a Disk (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fmvcd.html">14.&nbsp;&nbsp;Configuring Solaris iSCSI Targets and Initiators (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="gfydr.html">15.&nbsp;&nbsp;Configuring and Managing the Solaris Internet Storage Name Service (iSNS)</a></p>
<p class="toc level1 tocsp"><a href="disksformat-15833.html">16.&nbsp;&nbsp;The <tt>format</tt> Utility (Reference)</a></p>
<p class="toc level1 tocsp"><a href="fsoverview-38559.html">17.&nbsp;&nbsp;Managing File Systems (Overview)</a></p>
<p class="toc level1 tocsp"><a href="fscreate-96442.html">18.&nbsp;&nbsp;Creating UFS, TMPFS, and LOFS File Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fsmount-42780.html">19.&nbsp;&nbsp;Mounting and Unmounting File Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fscachefs-70682.html">20.&nbsp;&nbsp;Using The CacheFS File System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fsswap-14677.html">21.&nbsp;&nbsp;Configuring Additional Swap Space (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fstroublefsck-61446.html">22.&nbsp;&nbsp;Checking UFS File System Consistency (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fsfilesysappx-94408.html">23.&nbsp;&nbsp;UFS File System (Reference)</a></p>
<p class="toc level1 tocsp"><a href="bkupconcepts-57422.html">24.&nbsp;&nbsp;Backing Up and Restoring File Systems (Overview)</a></p>
<p class="toc level1 tocsp"><a href="bkuptasks2-64128.html">25.&nbsp;&nbsp;Backing Up Files and File Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="bkupsnapshot-2.html">26.&nbsp;&nbsp;Using UFS Snapshots (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="bkuprestoretasks-38055.html">27.&nbsp;&nbsp;Restoring Files and File Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="bkupref-12756.html">28.&nbsp;&nbsp;UFS Backup and Restore Commands (Reference)</a></p>
<p class="toc level1 tocsp"><a href="bkupsavefiles-17924.html">29.&nbsp;&nbsp;Copying UFS Files and File Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="bkuptapedevice-42512.html">30.&nbsp;&nbsp;Managing Tape Drives (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="devconfig2-2"></a><h3>Reconfiguration Coordination Manager (RCM) Script Overview</h3>
<p>The Reconfiguration Coordination Manager (RCM) is the framework that manages the dynamic removal
of system components. By using RCM, you can register and release system resources
in an orderly manner.</p><p>You can use the new RCM script feature to write your own
scripts to shut down your applications, or to cleanly release the devices from
your applications during dynamic reconfiguration. The RCM framework launches a script automatically in response
to a reconfiguration request, if the request impacts the resources that are registered
by the script.</p><p>You can also release resources from applications manually before you dynamically remove the
resource. Or, you can use the <tt>cfgadm</tt> command with the <tt>-f</tt> option to
force a reconfiguration operation. However, this option might leave your applications in an
unknown state. Also, the manual release of resources from applications commonly causes errors.</p><p>The RCM script feature simplifies and better controls the dynamic reconfiguration process. By
creating an RCM script, you can do the following:</p>
<ul><li><p>Automatically release a device when you dynamically remove a device. This process also closes the device if the device is opened by an application.</p></li>
<li><p>Run site-specific tasks when you dynamically remove a device from the system.</p></li></ul>


<a name="devconfig2-4"></a><h4>What Is an RCM Script?</h4>

<ul><li><p>An executable shell script (Perl, <tt>sh</tt>, <tt>csh</tt>, or <tt>ksh</tt>) or binary program that the RCM daemon runs. Perl is the recommended language. </p></li>
<li><p>A script that runs in its own address space by using the user ID of the script file owner.</p></li>
<li><p>A script that is run by the RCM daemon when you use the <tt>cfgadm</tt> command to dynamically reconfigure a system resource.</p></li></ul>


<a name="devconfig2-16"></a><h4>What Can an RCM Script Do?</h4>
<p>You can use an RCM script to release a device from an
application when you dynamically remove a device. If the device is currently open,
the RCM script also closes the device.<a name="indexterm-103"></a></p><p>For example, an RCM script for a tape backup application can inform the
tape backup application to close the tape drive or shut down the
tape backup application.</p>

<a name="devconfig2-17"></a><h4>How Does the RCM Script Process Work?</h4>
<p>You can invoke an RCM script as follows:</p><pre>$ <i>script-name</i> <i>command</i> [<i>args</i> ...]</pre><p>An RCM script performs the following basic steps:</p>
<ol><li><p>Takes the RCM command from command-line arguments.</p></li>
<li><p>Executes the command.</p></li>
<li><p>Writes the results to <tt>stdout</tt> as name-value pairs.</p></li>
<li><p>Exits with the appropriate exit status.</p></li></ol>
<p>The RCM daemon runs one instance of a script at a time.
For example, if a script is running, the RCM daemon does not run
the same script until the first script exits.</p>

<a name="devconfig2-32"></a><h5>RCM Script Commands</h5>
<p>You must include the following RCM commands in an RCM script:<a name="indexterm-104"></a></p>
<ul><li><p><tt>scriptinfo</tt> &ndash; Gathers script information</p></li>
<li><p><tt>register</tt> &ndash; Registers interest in resources</p></li>
<li><p><tt>resourceinfo</tt> &ndash; Gathers resource information</p></li></ul>
<p>You might include some or all of the following RCM commands:</p>
<ul><li><p><tt>queryremove</tt> &ndash; Queries whether the resource can be released</p></li>
<li><p><tt>preremove</tt> &ndash; Releases the resource</p></li>
<li><p><tt>postremove</tt> &ndash; Provides post-resource removal notification</p></li>
<li><p><tt>undoremove</tt> &ndash; Undoes the actions done in <tt>preremove</tt></p></li></ul>
<p>For a complete description of these RCM commands, see <a href="http://docs.sun.com/doc/819-2251/rcmscript-4?a=view"><tt>rcmscript</tt>(4)</a>.</p>

<a name="devconfig2-20"></a><h5>RCM Script Processing Environment</h5>
<p>When you dynamically remove a device, the RCM daemon runs the following:</p>
<ul><li><p>The script's <tt>register</tt> command to gather the list of resources (device names) that are identified in the script.</p></li>
<li><p>The script's <tt>queryremove</tt> and <tt>preremove</tt> commands prior to removing the resource if the script's registered resources are affected by the dynamic remove operation.</p></li>
<li><p>The script's <tt>postremove</tt> command if the remove operation succeeds. However, if the remove operation fails, the RCM daemon runs the script's <tt>undoremove</tt> command.</p></li></ul>

         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="devconfig2-49.html">Previous</a>
             </td>
             <td align="right">
                 <a href="devconfig2-19.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

