<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Customizing UFS File System Parameters - System Administration Guide: Devices and File Systems</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-01-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: Devices and File Systems</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="fsfilesysappx-23724.html">Previous</a>
             </td>
             <td align="right">
                 <a href="bkupconcepts-57422.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="vol1preface-11.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="medintro-55492.html">1.&nbsp;&nbsp;Managing Removable Media (Overview)</a></p>
<p class="toc level1 tocsp"><a href="medformat-83002.html">2.&nbsp;&nbsp;Managing Removable Media (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="medaccess-29267.html">3.&nbsp;&nbsp;Accessing Removable Media (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="medcdrw-1.html">4.&nbsp;&nbsp;Writing CDs and DVDs (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="devconfig-27900.html">5.&nbsp;&nbsp;Managing Devices (Overview/Tasks)</a></p>
<p class="toc level1 tocsp"><a href="devconfig2-1.html">6.&nbsp;&nbsp;Dynamically Configuring Devices (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="devusbover-24.html">7.&nbsp;&nbsp;Using USB Devices (Overview)</a></p>
<p class="toc level1 tocsp"><a href="devusbtasks-1.html">8.&nbsp;&nbsp;Using USB Devices (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fncpk.html">9.&nbsp;&nbsp;Using InfiniBand Devices (Overview/Tasks)</a></p>
<p class="toc level1 tocsp"><a href="disksconcepts-29477.html">10.&nbsp;&nbsp;Managing Disks (Overview)</a></p>
<p class="toc level1 tocsp"><a href="disksprep-31030.html">11.&nbsp;&nbsp;Administering Disks (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="diskssadd-16103.html">12.&nbsp;&nbsp;SPARC: Adding a Disk (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="disksxadd-38159.html">13.&nbsp;&nbsp;x86: Adding a Disk (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fmvcd.html">14.&nbsp;&nbsp;Configuring Solaris iSCSI Targets and Initiators (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="gfydr.html">15.&nbsp;&nbsp;Configuring and Managing the Solaris Internet Storage Name Service (iSNS)</a></p>
<p class="toc level1 tocsp"><a href="disksformat-15833.html">16.&nbsp;&nbsp;The <tt>format</tt> Utility (Reference)</a></p>
<p class="toc level1 tocsp"><a href="fsoverview-38559.html">17.&nbsp;&nbsp;Managing File Systems (Overview)</a></p>
<p class="toc level1 tocsp"><a href="fscreate-96442.html">18.&nbsp;&nbsp;Creating UFS, TMPFS, and LOFS File Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fsmount-42780.html">19.&nbsp;&nbsp;Mounting and Unmounting File Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fscachefs-70682.html">20.&nbsp;&nbsp;Using The CacheFS File System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fsswap-14677.html">21.&nbsp;&nbsp;Configuring Additional Swap Space (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fstroublefsck-61446.html">22.&nbsp;&nbsp;Checking UFS File System Consistency (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fsfilesysappx-94408.html">23.&nbsp;&nbsp;UFS File System (Reference)</a></p>
<p class="toc level2"><a href="fsfilesysappx-23724.html">Structure of Cylinder Groups for UFS File Systems</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Customizing UFS File System Parameters</a></p>
</div>
<p class="toc level1 tocsp"><a href="bkupconcepts-57422.html">24.&nbsp;&nbsp;Backing Up and Restoring File Systems (Overview)</a></p>
<p class="toc level1 tocsp"><a href="bkuptasks2-64128.html">25.&nbsp;&nbsp;Backing Up Files and File Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="bkupsnapshot-2.html">26.&nbsp;&nbsp;Using UFS Snapshots (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="bkuprestoretasks-38055.html">27.&nbsp;&nbsp;Restoring Files and File Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="bkupref-12756.html">28.&nbsp;&nbsp;UFS Backup and Restore Commands (Reference)</a></p>
<p class="toc level1 tocsp"><a href="bkupsavefiles-17924.html">29.&nbsp;&nbsp;Copying UFS Files and File Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="bkuptapedevice-42512.html">30.&nbsp;&nbsp;Managing Tape Drives (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="fsfilesysappx-20581"></a><h3>Customizing UFS File System Parameters</h3>
<a name="fsfilesysappx-ix2990"></a><a name="fsfilesysappx-ix2991"></a><a name="fsfilesysappx-ix2992"></a><p>Before you alter the default file system parameters that are assigned by the
<tt>newfs</tt> command, you need to understand them. This section describes these parameters:</p>
<ul><li><p><a href="#fsfilesysappx-9">Logical Block Size</a></p></li>
<li><p><a href="#fsfilesysappx-10">Fragment Size</a></p></li>
<li><p><a href="#fsfilesysappx-11">Minimum Free Space</a></p></li>
<li><p><a href="#fsfilesysappx-12">Rotational Delay</a> (Obsolete)</p></li>
<li><p><a href="#fsfilesysappx-13">Optimization Type</a></p></li>
<li><p><a href="#fsfilesysappx-14">Number of Inodes (Files)</a></p></li></ul>
<p>For a description of the command options that customize these parameters, see <a href="http://docs.sun.com/doc/819-2240/newfs-1m?a=view"><tt>newfs</tt>(1M)</a>
and <a href="http://docs.sun.com/doc/819-2240/mkfs-ufs-1m?a=view"><tt>mkfs_ufs</tt>(1M)</a>.</p>

<a name="fsfilesysappx-9"></a><h4>Logical Block Size</h4>
<a name="fsfilesysappx-ix2993"></a><a name="fsfilesysappx-ix2994"></a><p>The <b>logical block size</b> is the size of the blocks that the UNIX<sup>&reg;</sup>
				  kernel uses
to read or write files. The logical block size is usually different from
the physical block size. The physical block size is usually 512 bytes, which
is the size of the smallest block that the disk controller can read
or write.</p><p>Logical block size is set to the page size of the system
by default. The default logical block size is 8192 bytes (8 Kbytes) for
UFS file systems. The UFS file system supports block sizes of 4096 or
8192 bytes (4 or 8 Kbytes). The recommended logical block size is 8
Kbytes.</p>
<hr><p><b>SPARC only - </b>You can specify only the 8192-byte block size on the sun-4u<sup>TM</sup> platform.</p>
<hr>
<p>To choose the best logical block size for your system, consider both the
performance you want and the available space. For most UFS systems, an 8-Kbyte
file system provides the best performance, offering a good balance between disk performance
and the use of space in primary memory and on disk.</p><p>As a general rule, to increase efficiency, use a larger logical block size
for file systems when most of the files are very large. Use
a smaller logical block size for file systems when most of the files
are very small. You can use the <tt>quot -c</tt> <i>filesystem</i> command on a file system
to display a complete report on the distribution of files by block size.</p><p>However, the page size set when the file system is created is
probably the best size in most cases.</p>

<a name="fsfilesysappx-10"></a><h4>Fragment Size</h4>
<a name="fsfilesysappx-ix2995"></a><a name="fsfilesysappx-ix2996"></a><p>As files are created or expanded, they are allocated disk space in
either full logical blocks or portions of logical blocks called <b>fragments</b>. When disk space
is needed for a file, full blocks are allocated first, and then one
or more fragments of a block are allocated for the remainder. For small
files, allocation begins with fragments.</p><p>The ability to allocate fragments of blocks to files, rather than just whole
blocks, saves space by reducing <b>fragmentation</b> of disk space that results from unused
holes in blocks.</p><p>You define the <b>fragment size</b> when you create a UFS file system. The default
fragment size is 1 Kbyte. Each block can be divided into 1, 2,
4, or 8 fragments, which results in fragment sizes from 8192 bytes to
512 bytes (for 4-Kbyte file systems only). The lower bound is actually tied
to the disk sector size, typically 512 bytes.</p><p>For multiterabyte file systems, the fragment size must be equal to the file
system block size.</p>
<hr><p><b>Note - </b>The upper bound for the fragment is the logical block size, in which
case the fragment is not a fragment at all. This configuration might be
optimal for file systems with very large files when you are more
concerned with speed than with space.</p>
<hr>
<p>When choosing a fragment size, consider the trade-off between time and space: A
small fragment size saves space, but requires more time to allocate. As a
general rule, to increase storage efficiency, use a larger fragment size for file
systems when most of the files are large. Use a smaller fragment size
for file systems when most of the files are small.</p>

<a name="fsfilesysappx-11"></a><h4>Minimum Free Space</h4>
<a name="fsfilesysappx-ix2997"></a><a name="fsfilesysappx-ix2998"></a><p>The <b>minimum free space</b> is the percentage of the total disk space that is held
in reserve when you create the file system. The default reserve is ((64
Mbytes/partition size) * 100), rounded down to the nearest integer and limited between
1 percent and 10 percent, inclusively. </p><p>Free space is important because file access becomes less and less efficient as
a file system gets full. As long as an adequate amount of
free space exists, UFS file systems operate efficiently. When a file system becomes
full, using up the available user space, only root can access the reserved
free space.</p><p>Commands such as <tt>df</tt> report the percentage of space that is available to
users, excluding the percentage allocated as the minimum free space. When the command
reports that more than 100 percent of the disk space in the file
system is in use, some of the reserve has been used by
root.</p><p>If you impose quotas on users, the amount of space available to
them does not include the reserved free space. You can change the value
of the minimum free space for an existing file system by using the
<tt>tunefs</tt> command.</p>

<a name="fsfilesysappx-12"></a><h4>Rotational Delay</h4>
<p>This parameter is obsolete. The value is always set to 0, regardless of
the value you specify.</p>

<a name="fsfilesysappx-13"></a><h4>Optimization Type</h4>
<a name="fsfilesysappx-ix3003"></a><a name="fsfilesysappx-ix3004"></a><p>The <b>optimization type</b> parameter is set to either <b>space</b> or <b>time</b>.</p>
<ul><li><p><b>Space &ndash;</b> When you select space optimization, disk blocks are allocated to minimize fragmentation and disk use is optimized. </p></li>
<li><p><b>Time &ndash;</b> When you select time optimization, disk blocks are allocated as quickly as possible, with less emphasis on their placement. When sufficient free space exists, allocating disk blocks is relatively easy, without resulting in too much fragmentation. The default is <i>time</i>.</p><p>You can change the value of the optimization type parameter for an existing file system by using the <tt>tunefs</tt> command.</p></li></ul>
<p>For more information, see <a href="http://docs.sun.com/doc/819-2240/tunefs-1m?a=view"><tt>tunefs</tt>(1M)</a>.</p>

<a name="fsfilesysappx-14"></a><h4>Number of Inodes (Files)</h4>
<a name="fsfilesysappx-ix3005"></a><a name="fsfilesysappx-ix3006"></a><p>The number of bytes per  inode specifies the density of 
inodes  in the file system. The number is  divided into the
total size of  the file system to determine the number of inodes
to create. Once the inodes are allocated, you cannot change the number without
re-creating the file system.</p><p>The default number of bytes per inode is 2048 bytes (2 Kbytes)
if the file system is less than 1 Gbyte. If the file system
is larger than 1 Gbyte, the following formula is used:</p><table><col width="50*"><col width="50*"><tr><th align="left" valign="top" scope="column"><p>File System Size</p></th>
<th align="left" valign="top" scope="column"><p>Number of
Bytes Per Inode</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Less than or equal to 1 Gbyte</p></td>
<td align="left" valign="top" scope="row"><p>2048</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Less than 2 Gbytes</p></td>
<td align="left" valign="top" scope="row"><p>4096</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Less
than 3 Gbytes</p></td>
<td align="left" valign="top" scope="row"><p>6144</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>3 Gbytes up to 1 Tbyte</p></td>
<td align="left" valign="top" scope="row"><p>8192</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Greater than 1 Tbyte or
created with <tt>-T</tt> option</p></td>
<td align="left" valign="top" scope="row"><p>1048576</p></td>
</tr>
</table><p>If you have a file system with many symbolic links, they can
lower the average file size. If your file system is going to have
many small files, you can give this parameter a lower value. Note, however,
that having too many inodes is much better than running out of inodes.
If you have too few inodes, you could reach the maximum number of
files on a disk slice that is practically empty.</p>

<a name="fsfilesysappx-8"></a><h4>Maximum UFS File and File System Size</h4>
<p>The maximum size of a UFS file system is about 16 Tbytes
of usable space, minus about one percent overhead. A <b>sparse</b> file can have a
logical size of one terabyte. However, the actual amount of data that
can be stored in a file is approximately one percent less than 1
Tbyte because of the file system overhead.</p>

<a name="fsfilesysappx-5"></a><h4>Maximum Number of UFS Subdirectories</h4>
<p>The maximum number of subdirectories per directory in a UFS file system is
32,767. This limit is predefined and cannot be changed.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="fsfilesysappx-23724.html">Previous</a>
             </td>
             <td align="right">
                 <a href="bkupconcepts-57422.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

