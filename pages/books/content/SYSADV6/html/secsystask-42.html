<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Changing the Default Algorithm for Password Encryption - System Administration Guide: Security Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-08-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Security Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="secsys-15.html">Previous</a>
             </td>
             <td align="right">
                 <a href="secsys-37.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="oview-1.html">Part&nbsp;I&nbsp;Security Overview</a></p>
<p class="toc level2"><a href="secov-1.html">1.&nbsp;&nbsp;Security Services (Overview)</a></p>
<p class="toc level1 tocsp"><a href="sectm-1.html">Part&nbsp;II&nbsp;System, File, and Device Security</a></p>
<p class="toc level2"><a href="concept-1.html">2.&nbsp;&nbsp;Managing Machine Security (Overview)</a></p>
<p class="toc level2"><a href="secsys-1.html">3.&nbsp;&nbsp;Controlling Access to Systems (Tasks)</a></p>
<p class="toc level3"><a href="secsys-24.html">Controlling System Access (Task Map)</a></p>
<p class="toc level3"><a href="secsys-25.html">Securing Logins and Passwords (Task Map)</a></p>
<p class="toc level3"><a href="secsystask-40.html">Securing Logins and Passwords</a></p>
<p class="toc level3"><a href="secsys-15.html">Changing the Password Algorithm (Task Map)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Changing the Default Algorithm for Password Encryption</a></p>
</div>
<p class="toc level3"><a href="secsys-37.html">Monitoring and Restricting Superuser (Task Map)</a></p>
<p class="toc level3"><a href="secsystask-44.html">Monitoring and Restricting Superuser</a></p>
<p class="toc level3"><a href="secsys-29.html">SPARC: Controlling Access to System Hardware (Task Map)</a></p>
<p class="toc level3"><a href="secsystask-46.html">Controlling Access to System Hardware</a></p>
<p class="toc level2 tocsp"><a href="vscan-1.html">4.&nbsp;&nbsp;Virus Scanning Service (Tasks)</a></p>
<p class="toc level2"><a href="devtask-1.html">5.&nbsp;&nbsp;Controlling Access to Devices (Tasks)</a></p>
<p class="toc level2"><a href="bart-1.html">6.&nbsp;&nbsp;Using the Basic Audit Reporting Tool (Tasks)</a></p>
<p class="toc level2"><a href="secfile-1.html">7.&nbsp;&nbsp;Controlling Access to Files (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="prbactm-1.html">Part&nbsp;III&nbsp;Roles, Rights Profiles, and Privileges</a></p>
<p class="toc level2"><a href="prbac-1.html">8.&nbsp;&nbsp;Using Roles and Privileges (Overview)</a></p>
<p class="toc level2"><a href="rbactask-1.html">9.&nbsp;&nbsp;Using Role-Based Access Control (Tasks)</a></p>
<p class="toc level2"><a href="rbacref-1.html">10.&nbsp;&nbsp;Role-Based Access Control (Reference)</a></p>
<p class="toc level2"><a href="privtask-1.html">11.&nbsp;&nbsp;Privileges (Tasks)</a></p>
<p class="toc level2"><a href="privref-1.html">12.&nbsp;&nbsp;Privileges (Reference)</a></p>
<p class="toc level1 tocsp"><a href="scftm-1.html">Part&nbsp;IV&nbsp;Solaris Cryptographic Services</a></p>
<p class="toc level2"><a href="scf-1.html">13.&nbsp;&nbsp;Solaris Cryptographic Framework (Overview)</a></p>
<p class="toc level2"><a href="scftask-1.html">14.&nbsp;&nbsp;Solaris Cryptographic Framework (Tasks)</a></p>
<p class="toc level2"><a href="kmf-1.html">15.&nbsp;&nbsp;Solaris Key Management Framework</a></p>
<p class="toc level1 tocsp"><a href="authtm-1.html">Part&nbsp;V&nbsp;Authentication Services and Secure Communication</a></p>
<p class="toc level2"><a href="auth-1.html">16.&nbsp;&nbsp;Using Authentication Services (Tasks)</a></p>
<p class="toc level2"><a href="pam-1.html">17.&nbsp;&nbsp;Using PAM</a></p>
<p class="toc level2"><a href="sasl-1.html">18.&nbsp;&nbsp;Using SASL</a></p>
<p class="toc level2"><a href="sshuser-1.html">19.&nbsp;&nbsp;Using Solaris Secure Shell (Tasks)</a></p>
<p class="toc level2"><a href="sshref-1.html">20.&nbsp;&nbsp;Solaris Secure Shell (Reference)</a></p>
<p class="toc level1 tocsp"><a href="seamtm-1.html">Part&nbsp;VI&nbsp;Kerberos Service</a></p>
<p class="toc level2"><a href="intro-1.html">21.&nbsp;&nbsp;Introduction to the Kerberos Service</a></p>
<p class="toc level2"><a href="seamplan-1.html">22.&nbsp;&nbsp;Planning for the Kerberos Service</a></p>
<p class="toc level2"><a href="setup-8.html">23.&nbsp;&nbsp;Configuring the Kerberos Service (Tasks)</a></p>
<p class="toc level2"><a href="trouble-1.html">24.&nbsp;&nbsp;Kerberos Error Messages and Troubleshooting</a></p>
<p class="toc level2"><a href="aadmin-1.html">25.&nbsp;&nbsp;Administering Kerberos Principals and Policies (Tasks)</a></p>
<p class="toc level2"><a href="user-7.html">26.&nbsp;&nbsp;Using Kerberos Applications (Tasks)</a></p>
<p class="toc level2"><a href="refer-1.html">27.&nbsp;&nbsp;The Kerberos Service (Reference)</a></p>
<p class="toc level1 tocsp"><a href="audittm-1.html">Part&nbsp;VII&nbsp;Solaris Auditing</a></p>
<p class="toc level2"><a href="auditov-1.html">28.&nbsp;&nbsp;Solaris Auditing (Overview)</a></p>
<p class="toc level2"><a href="auditplan-1.html">29.&nbsp;&nbsp;Planning for Solaris Auditing</a></p>
<p class="toc level2"><a href="audittask-1.html">30.&nbsp;&nbsp;Managing Solaris Auditing (Tasks)</a></p>
<p class="toc level2"><a href="auditref-1.html">31.&nbsp;&nbsp;Solaris Auditing (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-2.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="secsystask-42"></a><h3>Changing the Default Algorithm for Password Encryption</h3>
<a name="indexterm-279"></a><p>By default, user passwords are encrypted with the <tt>crypt_unix</tt> algorithm. You can use
a stronger encryption algorithm, such as <a href="glossary-2.html#glossary-84">MD5</a> or <a href="glossary-2.html#glossary-133">Blowfish</a>, by changing the default
password encryption algorithm.</p>

<a name="secsys-20"></a><h4>How to Specify an Algorithm for Password Encryption</h4><a name="indexterm-280"></a><a name="indexterm-281"></a><a name="indexterm-282"></a><a name="indexterm-283"></a><a name="indexterm-284"></a><a name="indexterm-285"></a><a name="indexterm-286"></a><a name="indexterm-287"></a><p>In this procedure, the BSD-Linux version of the MD5 algorithm is the default
encryption algorithm that is used when users change their passwords. This algorithm is
suitable for a mixed network of machines that run the Solaris, BSD, and
Linux versions of UNIX. For a list of password encryption algorithms and algorithm
identifiers, see <a href="concept-28.html#concept-encralg-1">Table&nbsp;2-1</a>.</p><ol>
<li><b>Assume the Primary Administrator role, or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b><a name="indexterm-288"></a><a name="indexterm-289"></a>Specify the identifier for your chosen encryption algorithm.</b><p>Type the identifier as the value for the <tt>CRYPT_DEFAULT</tt> variable in the
<tt>/etc/security/policy.conf</tt> file.</p><p>You might want to comment the file to explain your choice.</p><pre># <tt><b>cat /etc/security/policy.conf</b></tt>
&hellip;
CRYPT_ALGORITHMS_ALLOW=1,2a,md5
#
<tt><b># Use the version of MD5 that works with Linux and BSD systems.</b></tt>
<tt><b># Passwords previously encrypted with __unix__ will be encrypted with MD5</b></tt>
<tt><b># when users change their passwords.</b></tt>
#
#
CRYPT_DEFAULT=__unix__
<tt><b>CRYPT_DEFAULT=1</b></tt></pre><p><a name="indexterm-290"></a><a name="indexterm-291"></a>In this example, the algorithms configuration ensures that the weakest algorithm, <tt>crypt_unix</tt>, is
never used to encrypt a password. Users whose passwords were encrypted with the
<tt>crypt_unix</tt> module get a <tt>crypt_bsdmd5</tt>-encrypted password when they change their passwords.</p><p>For more information on configuring the algorithm choices, see the <a href="http://docs.sun.com/doc/819-2251/policy.conf-4?a=view"><tt>policy.conf</tt>(4)</a> man
page.</p></li></ol><a name="secsys-14"></a><h6>Example&nbsp;3-6 Using the Blowfish Algorithm for Password Encryption</h6><a name="indexterm-292"></a><a name="indexterm-293"></a><a name="indexterm-294"></a><p>In this example, the identifier for the Blowfish algorithm, <tt>2a</tt>, is specified as
the value for the <tt>CRYPT_DEFAULT</tt> variable in the <tt>policy.conf</tt> file:</p><pre>CRYPT_ALGORITHMS_ALLOW=1,2a,md5
#CRYPT_ALGORITHMS_DEPRECATE=__unix__
CRYPT_DEFAULT=<tt><b>2a</b></tt></pre><p>This configuration is compatible with BSD systems that use the Blowfish algorithm.</p>

<a name="secsys-19"></a><h4>How to Specify a New Password Algorithm for an NIS Domain</h4><a name="indexterm-295"></a><a name="indexterm-296"></a><a name="indexterm-297"></a><a name="indexterm-298"></a><a name="indexterm-299"></a><p>When users in an NIS domain change their passwords, the NIS client
consults its local algorithms configuration in the <tt>/etc/security/policy.conf</tt> file. The NIS client machine encrypts
the password.</p><ol>
<li><b>Specify the password encryption algorithm in the <tt>/etc/security/policy.conf</tt> file on the NIS
client.</b></li>
<li><b>Copy the modified <tt>/etc/security/policy.conf</tt> file to every client machine in the NIS domain.</b></li>
<li><b>To minimize confusion, copy the modified <tt>/etc/security/policy.conf</tt> file to the NIS root
server and to the slave servers.</b></li></ol>

<a name="secsys-18"></a><h4>How to Specify a New Password Algorithm for an NIS+ Domain</h4><a name="indexterm-300"></a><a name="indexterm-301"></a><p>When users in an NIS+ domain change their passwords, the NIS+ name
service consults the algorithms configuration in the <tt>/etc/security/policy.conf</tt> file on the NIS+ master. The
NIS+ master, which is running the <tt>rpc.nispasswd</tt> daemon, creates the encrypted password.</p><ol>
<li><b>Specify the password encryption algorithm in the <tt>/etc/security/policy.conf</tt> file on the NIS+
master.</b></li>
<li><b><a name="indexterm-302"></a>To minimize confusion, copy the NIS+ master's <tt>/etc/security/policy.conf</tt> file to every host
in the NIS+ domain.</b></li></ol>

<a name="secsys-21"></a><h4>How to Specify a New Password Algorithm for an LDAP Domain</h4><a name="indexterm-303"></a><a name="indexterm-304"></a><p>When the LDAP client is properly configured, the LDAP client can use the
new password algorithms. The LDAP client behaves just as an NIS client behaves.</p><ol>
<li><b>Specify a password encryption algorithm in the <tt>/etc/security/policy.conf</tt> file on the LDAP
client.</b></li>
<li><b>Copy the modified <tt>policy.conf</tt> file to every client machine in the LDAP domain.</b></li>
<li><b>Ensure that the client's <tt>/etc/pam.conf</tt> file does not use a <tt>pam_ldap</tt> module.</b><p>Ensure that a comment sign (<tt>#</tt>) precedes entries that include <tt>pam_ldap.so.1</tt>. Also, do
not use the new <tt>server_policy</tt> option with the <tt>pam_authtok_store.so.1</tt> module.</p><p>The PAM entries in the client's <tt>pam.conf</tt> file enable the password to be
encrypted according to the local algorithms configuration. The PAM entries also enable the
password to be authenticated.</p><p>When users in the LDAP domain change their passwords, the LDAP client consults
its local algorithms configuration in the <tt>/etc/security/policy.conf</tt> file. The LDAP client machine
encrypts the password. Then, the client sends the encrypted password, with a <tt>{crypt}</tt>
tag, to the server. The tag tells the server that the password is
already encrypted. The password is then stored, as is, on the server. For
authentication, the client retrieves the stored password from the server. The client then
compares the stored password with the encrypted version that the client has just
generated from the user's typed password.</p>
<hr><p><b>Note - </b>To take advantage of password policy controls on the LDAP server, use the
<tt>server_policy</tt> option with the <tt>pam_authtok_store</tt> entries in the <tt>pam.conf</tt> file. Passwords are then
encrypted on the server by using the Sun Java<sup>TM</sup> System Directory Server's cryptographic
mechanism. For the procedure, see <a href="http://docs.sun.com/doc/819-3194/sundssetup-13?a=view">Chapter 11, Setting Up Sun Java System Directory Server With LDAP Clients (Tasks), in <i>System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</i></a>.</p>
<hr>
</li></ol>

<a name="secsys-13"></a><h4>How to Install a Password Encryption Module From a Third Party</h4><a name="indexterm-305"></a><a name="indexterm-306"></a><a name="indexterm-307"></a><a name="indexterm-308"></a><a name="indexterm-309"></a><a name="indexterm-310"></a><a name="indexterm-311"></a><a name="indexterm-312"></a><a name="indexterm-313"></a><a name="indexterm-314"></a><p>A third-party password encryption algorithm is typically delivered as a module in a
software package. When you run the <tt>pkgadd</tt> command, scripts from the vendor should
modify the <tt>/etc/security/crypt.conf</tt> file. You then modify the <tt>/etc/security/policy.conf</tt> file to include the new
module and its identifier.</p><ol>
<li><b><a name="indexterm-315"></a>Add the software by using the <tt>pkgadd</tt> command.</b><p>For detailed instructions on how to add software, see <a href="http://docs.sun.com/doc/819-2379/swmgrpkgsconcepts-25409?a=view">Adding or Removing a Software Package (pkgadd) in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b>Confirm that the new module and module identifier have been added.</b><p>Read the list of encryption algorithms in the <tt>/etc/security/crypt.conf</tt> file.</p><p>For example, the following lines show that a module that implements the <tt>crypt_rot13</tt>
algorithm has been installed.</p><pre># crypt.conf
#
md5 /usr/lib/security/$ISA/crypt_md5.so
<tt><b>rot13 /usr/lib/security/$ISA/crypt_rot13.so</b></tt>

# For *BSD - Linux compatibility
# 1 is MD5,  2a is Blowfish
1 /usr/lib/security/$ISA/crypt_bsdmd5.so
2a /usr/lib/security/$ISA/crypt_bsdbf.so</pre></li>
<li><b>Add the identifier of the newly installed algorithm to the <tt>/etc/security/policy.conf</tt> file.</b><p>The following lines show excerpts from the <tt>policy.conf</tt> file that would need to be
modified to add the <tt>rot13</tt> identifier.</p><pre># Copyright 1999-2002 Sun Microsystems, Inc.  All rights reserved.
# ...
#ident  "@(#)policy.conf        1.6     02/06/07 SMI"
# ...
# crypt(3c) Algorithms Configuration
CRYPT_ALGORITHMS_ALLOW=1,2a,md5<tt><b>,rot13</b></tt>
#CRYPT_ALGORITHMS_DEPRECATE=__unix__
CRYPT_DEFAULT=md5</pre><p>In this example, the <tt>rot13</tt> algorithm is used if the current password was
encrypted with the <tt>crypt_rot13</tt> algorithm. New user passwords are encrypted with the <tt>crypt_sunmd5</tt>
algorithm. This algorithms configuration works on Solaris-only networks.</p></li></ol>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="secsys-15.html">Previous</a>
             </td>
             <td align="right">
                 <a href="secsys-37.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

