<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Administering the Cryptographic Framework - System Administration Guide: Security Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-08-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Security Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="scftask-28.html">Previous</a>
             </td>
             <td align="right">
                 <a href="kmf-1.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="oview-1.html">Part&nbsp;I&nbsp;Security Overview</a></p>
<p class="toc level2"><a href="secov-1.html">1.&nbsp;&nbsp;Security Services (Overview)</a></p>
<p class="toc level1 tocsp"><a href="sectm-1.html">Part&nbsp;II&nbsp;System, File, and Device Security</a></p>
<p class="toc level2"><a href="concept-1.html">2.&nbsp;&nbsp;Managing Machine Security (Overview)</a></p>
<p class="toc level2"><a href="secsys-1.html">3.&nbsp;&nbsp;Controlling Access to Systems (Tasks)</a></p>
<p class="toc level2"><a href="vscan-1.html">4.&nbsp;&nbsp;Virus Scanning Service (Tasks)</a></p>
<p class="toc level2"><a href="devtask-1.html">5.&nbsp;&nbsp;Controlling Access to Devices (Tasks)</a></p>
<p class="toc level2"><a href="bart-1.html">6.&nbsp;&nbsp;Using the Basic Audit Reporting Tool (Tasks)</a></p>
<p class="toc level2"><a href="secfile-1.html">7.&nbsp;&nbsp;Controlling Access to Files (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="prbactm-1.html">Part&nbsp;III&nbsp;Roles, Rights Profiles, and Privileges</a></p>
<p class="toc level2"><a href="prbac-1.html">8.&nbsp;&nbsp;Using Roles and Privileges (Overview)</a></p>
<p class="toc level2"><a href="rbactask-1.html">9.&nbsp;&nbsp;Using Role-Based Access Control (Tasks)</a></p>
<p class="toc level2"><a href="rbacref-1.html">10.&nbsp;&nbsp;Role-Based Access Control (Reference)</a></p>
<p class="toc level2"><a href="privtask-1.html">11.&nbsp;&nbsp;Privileges (Tasks)</a></p>
<p class="toc level2"><a href="privref-1.html">12.&nbsp;&nbsp;Privileges (Reference)</a></p>
<p class="toc level1 tocsp"><a href="scftm-1.html">Part&nbsp;IV&nbsp;Solaris Cryptographic Services</a></p>
<p class="toc level2"><a href="scf-1.html">13.&nbsp;&nbsp;Solaris Cryptographic Framework (Overview)</a></p>
<p class="toc level2"><a href="scftask-1.html">14.&nbsp;&nbsp;Solaris Cryptographic Framework (Tasks)</a></p>
<p class="toc level3"><a href="scftask-2.html">Using the Cryptographic Framework (Task Map)</a></p>
<p class="toc level3"><a href="scftask-24.html">Protecting Files With the Solaris Cryptographic Framework (Task Map)</a></p>
<p class="toc level3"><a href="scftask-3.html">Protecting Files With the Solaris Cryptographic Framework</a></p>
<p class="toc level3"><a href="scftask-28.html">Administering the Cryptographic Framework (Task Map)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Administering the Cryptographic Framework</a></p>
</div>
<p class="toc level2 tocsp"><a href="kmf-1.html">15.&nbsp;&nbsp;Solaris Key Management Framework</a></p>
<p class="toc level1 tocsp"><a href="authtm-1.html">Part&nbsp;V&nbsp;Authentication Services and Secure Communication</a></p>
<p class="toc level2"><a href="auth-1.html">16.&nbsp;&nbsp;Using Authentication Services (Tasks)</a></p>
<p class="toc level2"><a href="pam-1.html">17.&nbsp;&nbsp;Using PAM</a></p>
<p class="toc level2"><a href="sasl-1.html">18.&nbsp;&nbsp;Using SASL</a></p>
<p class="toc level2"><a href="sshuser-1.html">19.&nbsp;&nbsp;Using Solaris Secure Shell (Tasks)</a></p>
<p class="toc level2"><a href="sshref-1.html">20.&nbsp;&nbsp;Solaris Secure Shell (Reference)</a></p>
<p class="toc level1 tocsp"><a href="seamtm-1.html">Part&nbsp;VI&nbsp;Kerberos Service</a></p>
<p class="toc level2"><a href="intro-1.html">21.&nbsp;&nbsp;Introduction to the Kerberos Service</a></p>
<p class="toc level2"><a href="seamplan-1.html">22.&nbsp;&nbsp;Planning for the Kerberos Service</a></p>
<p class="toc level2"><a href="setup-8.html">23.&nbsp;&nbsp;Configuring the Kerberos Service (Tasks)</a></p>
<p class="toc level2"><a href="trouble-1.html">24.&nbsp;&nbsp;Kerberos Error Messages and Troubleshooting</a></p>
<p class="toc level2"><a href="aadmin-1.html">25.&nbsp;&nbsp;Administering Kerberos Principals and Policies (Tasks)</a></p>
<p class="toc level2"><a href="user-7.html">26.&nbsp;&nbsp;Using Kerberos Applications (Tasks)</a></p>
<p class="toc level2"><a href="refer-1.html">27.&nbsp;&nbsp;The Kerberos Service (Reference)</a></p>
<p class="toc level1 tocsp"><a href="audittm-1.html">Part&nbsp;VII&nbsp;Solaris Auditing</a></p>
<p class="toc level2"><a href="auditov-1.html">28.&nbsp;&nbsp;Solaris Auditing (Overview)</a></p>
<p class="toc level2"><a href="auditplan-1.html">29.&nbsp;&nbsp;Planning for Solaris Auditing</a></p>
<p class="toc level2"><a href="audittask-1.html">30.&nbsp;&nbsp;Managing Solaris Auditing (Tasks)</a></p>
<p class="toc level2"><a href="auditref-1.html">31.&nbsp;&nbsp;Solaris Auditing (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-2.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="scftask-8"></a><h3>Administering the Cryptographic Framework</h3>
<p><a name="indexterm-1673"></a><a name="indexterm-1674"></a>This section describes how to administer the software providers and the hardware providers in
the Solaris Cryptographic Framework. Software providers and hardware providers can be removed from
use when desirable. For example, you can disable the implementation of an algorithm
from one software provider. You can then force the system to use the
algorithm from a different software provider.</p>

<a name="scftask-6"></a><h4>How to List Available Providers</h4><a name="indexterm-1675"></a><a name="indexterm-1676"></a><a name="indexterm-1677"></a><a name="indexterm-1678"></a><a name="indexterm-1679"></a><a name="indexterm-1680"></a><a name="indexterm-1681"></a><p>The Solaris Cryptographic Framework provides algorithms for several types of consumers:</p>
<ul><li><p>User-level providers provide a PKCS #11 cryptographic interface to applications that are linked with the <tt>libpkcs11</tt> library</p></li>
<li><p>Kernel software providers provide algorithms for IPsec, Kerberos, and other Solaris kernel components</p></li>
<li><p>Kernel hardware providers provide algorithms that are available to kernel consumers and to applications through the <tt>pkcs11_kernel</tt> library</p></li></ul>
<ol>
<li><b><a name="indexterm-1682"></a><a name="indexterm-1683"></a><a name="indexterm-1684"></a><a name="indexterm-1685"></a><a name="indexterm-1686"></a><a name="indexterm-1687"></a><a name="indexterm-1688"></a><a name="indexterm-1689"></a><a name="indexterm-1690"></a><a name="indexterm-1691"></a><a name="indexterm-1692"></a><a name="indexterm-1693"></a>List the providers in a brief format.</b><p>Only those mechanisms at the user level are available for use by regular
users.</p><pre>% <tt><b>cryptoadm list</b></tt>
user-level providers:
    /usr/lib/security/$ISA/pkcs11_kernel.so
    /usr/lib/security/$ISA/pkcs11_softtoken.so

kernel software providers:
    des
    aes
    blowfish
    arcfour
    sha1
    md5
    rsa

kernel hardware providers:
    dca/0</pre></li>
<li><b>List the providers and their mechanisms in the Solaris Cryptographic Framework.</b><p><a name="indexterm-1694"></a>All mechanisms are listed in the following output. However, some of the listed
mechanisms might be unavailable for use. To list only the mechanisms that the
administrator has approved for use, see <a href="#scftask-31">Example&nbsp;14-20</a>.</p><p>The output is reformatted for display purposes.</p><pre>% <tt><b>cryptoadm list -m</b></tt>
user-level providers:
=====================
/usr/lib/security/$ISA/pkcs11_kernel.so: CKM_MD5,CKM_MD5_HMAC,
CKM_MD5_HMAC_GENERAL,CKM_SHA_1,CKM_SHA_1_HMAC,CKM_SHA_1_HMAC_GENERAL,
&hellip;
/usr/lib/security/$ISA/pkcs11_softtoken.so: 
CKM_DES_CBC,CKM_DES_CBC_PAD,CKM_DES_ECB,CKM_DES_KEY_GEN,
CKM_DES3_CBC,CKM_DES3_CBC_PAD,CKM_DES3_ECB,CKM_DES3_KEY_GEN,
CKM_AES_CBC,CKM_AES_CBC_PAD,CKM_AES_ECB,CKM_AES_KEY_GEN,
&hellip;
kernel software providers:
==========================
des: CKM_DES_ECB,CKM_DES_CBC,CKM_DES3_ECB,CKM_DES3_CBC
aes: CKM_AES_ECB,CKM_AES_CBC
blowfish: CKM_BF_ECB,CKM_BF_CBC
arcfour: CKM_RC4
sha1: CKM_SHA_1,CKM_SHA_1_HMAC,CKM_SHA_1_HMAC_GENERAL
md5: CKM_MD5,CKM_MD5_HMAC,CKM_MD5_HMAC_GENERAL
rsa: CKM_RSA_PKCS,CKM_RSA_X_509,CKM_MD5_RSA_PKCS,CKM_SHA1_RSA_PKCS
swrand: No mechanisms presented.

kernel hardware providers:
==========================
dca/0: CKM_RSA_PKCS, CKM_RSA_X_509, CKM_DSA, CKM_DES_CBC, CKM_DES3_CBC</pre></li></ol><a name="scftask-12"></a><h6>Example&nbsp;14-19 Finding the Existing Cryptographic Mechanisms</h6><p><a name="indexterm-1695"></a><a name="indexterm-1696"></a>In the following example, all mechanisms that the user-level library, <tt>pkcs11_softtoken</tt>, offers are
listed.</p><pre>% <tt><b>cryptoadm list -m provider=/usr/lib/security/'$ISA'/pkcs11_softtoken.so</b></tt>
/usr/lib/security/$ISA/pkcs11_softtoken.so:
CKM_DES_CBC,CKM_DES_CBC_PAD,CKM_DES_ECB,CKM_DES_KEY_GEN,
CKM_DES3_CBC,CKM_DES3_CBC_PAD,CKM_DES3_ECB,CKM_DES3_KEY_GEN,
&hellip;
CKM_SSL3_KEY_AND_MAC_DERIVE,CKM_TLS_KEY_AND_MAC_DERIVE</pre><a name="scftask-31"></a><h6>Example&nbsp;14-20 Finding the Available Cryptographic Mechanisms</h6><p><a name="indexterm-1697"></a><a name="indexterm-1698"></a>Policy determines which mechanisms are available for use. The administrator sets the policy. An
administrator can choose to disable mechanisms from a particular provider. The <tt>-p</tt> option
displays the list of mechanisms that are permitted by the policy that the
administrator has set.</p><pre>% <tt><b>cryptoadm list -p</b></tt>
user-level providers:
=====================
/usr/lib/security/$ISA/pkcs11_kernel.so: all mechanisms are enabled.
random is enabled.
/usr/lib/security/$ISA/pkcs11_softtoken.so: all mechanisms are enabled.
random is enabled.

kernel software providers:
==========================
des: all mechanisms are enabled.
aes: all mechanisms are enabled.
blowfish: all mechanisms are enabled.
arcfour: all mechanisms are enabled.
sha1: all mechanisms are enabled.
md5: all mechanisms are enabled.
rsa: all mechanisms are enabled.
swrand: random is enabled.

kernel hardware providers:
==========================
dca/0: all mechanisms are enabled. random is enabled.</pre>

<a name="scftask-11"></a><h4>How to Add a Software Provider</h4><a name="indexterm-1699"></a><a name="indexterm-1700"></a><a name="indexterm-1701"></a><a name="indexterm-1702"></a><ol>
<li><b>Assume the Primary Administrator role, or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b>List the software providers that are available to the system.</b><pre># <tt><b>cryptoadm list</b></tt>
user-level providers:
        /usr/lib/security/$ISA/pkcs11_kernel.so
        /usr/lib/security/$ISA/pkcs11_softtoken.so

kernel software providers:
    des
    aes
    blowfish
    arcfour
    sha1
    md5
    rsa
    swrand

kernel hardware providers:
     dca/0</pre></li>
<li><b><a name="indexterm-1703"></a>Add the provider's package by using the <tt>pkgadd</tt> command.</b><pre># <tt><b>pkgadd -d</b></tt> <i>/path/to/package</i> <i>pkginst</i></pre><p>The package must include software that has been signed by a certificate from
Sun. To request a certificate from Sun and to sign a provider,
see <a href="http://docs.sun.com/doc/819-2145/pkg?a=view">Appendix F, <i>Packaging and Signing Cryptographic Providers,</i> in <i>Solaris Security for Developers Guide</i></a>.</p><p>The package should have scripts that notify the cryptographic framework that another provider
with a set of mechanisms is available. For information about the packaging requirements,
see <a href="http://docs.sun.com/doc/819-2145/pkg?a=view">Appendix F, <i>Packaging and Signing Cryptographic Providers,</i> in <i>Solaris Security for Developers Guide</i></a>.</p></li>
<li><b>Refresh the providers.</b><p><a name="indexterm-1704"></a>You need to refresh providers if you added a software provider, or if
you added hardware and specified policy for the hardware.</p><pre># <tt><b>svcadm refresh svc:/system/cryptosvc</b></tt></pre></li>
<li><b>Locate the new provider on the list.</b><p>In this case, a new kernel software provider was installed.</p><pre># <tt><b>cryptoadm list</b></tt> 
&hellip;
kernel software providers:
    des
    aes
    blowfish
    arcfour
    sha1
    md5
    rsa
    swrand
    ecc &lt;-- added provider
&hellip;</pre></li></ol><a name="scftask-48"></a><h6>Example&nbsp;14-21 Adding a User-Level Software Provider</h6><a name="indexterm-1705"></a><a name="indexterm-1706"></a><a name="indexterm-1707"></a><a name="indexterm-1708"></a><a name="indexterm-1709"></a><p>In the following example, a signed PKCS #11 library is installed.</p><pre># <tt><b>pkgadd -d /cdrom/cdrom0/SolarisNew</b></tt>
Answer the prompts
# <tt><b>svcadm refresh system/cryptosvc</b></tt>
# <tt><b>cryptoadm list</b></tt>
user-level providers:
==========================
    /usr/lib/security/$ISA/pkcs11_kernel.so
    /usr/lib/security/$ISA/pkcs11_softtoken.so
    /opt/SUNWconn/lib/$ISA/libpkcs11.so.1 &lt;-- added provider</pre><p><a name="indexterm-1710"></a><a name="indexterm-1711"></a><a name="indexterm-1712"></a>Developers who are testing a library with the cryptographic framework can install the
library manually.</p><pre># <tt><b>cryptoadm install provider=/opt/SUNWconn/lib/'$ISA'/libpkcs11.so.1</b></tt></pre>

<a name="scftask-25"></a><h4>How to Prevent the Use of a User-Level Mechanism</h4><p><a name="indexterm-1713"></a><a name="indexterm-1714"></a>If some of the cryptographic mechanisms from a library provider should not be
used, you can remove selected mechanisms. This procedure uses the DES mechanisms in
the <tt>pkcs11_softtoken</tt> library as an example.</p><ol>
<li><b><a name="indexterm-1715"></a>Become superuser or assume a role that includes the Crypto Management rights profile.</b><p>To create a role that includes the Crypto Management rights profile and assign
the role to a user, see <a href="rbactask-30.html#rbactask-17">Example&nbsp;9-7</a>.</p></li>
<li><b><a name="indexterm-1716"></a><a name="indexterm-1717"></a>List the mechanisms that are offered by a particular user-level software provider.</b><pre>% <tt><b>cryptoadm list -m provider=/usr/lib/security/'$ISA'/pkcs11_softtoken.so</b></tt>
/usr/lib/security/$ISA/pkcs11_softtoken.so:
CKM_DES_CBC,CKM_DES_CBC_PAD,CKM_DES_ECB,CKM_DES_KEY_GEN,
CKM_DES3_CBC,CKM_DES3_CBC_PAD,CKM_DES3_ECB,CKM_DES3_KEY_GEN,
CKM_AES_CBC,CKM_AES_CBC_PAD,CKM_AES_ECB,CKM_AES_KEY_GEN,
&hellip;</pre></li>
<li><b><a name="indexterm-1718"></a><a name="indexterm-1719"></a>List the mechanisms that are available for use.</b><pre>$ <tt><b>cryptoadm list -p</b></tt>
user-level providers:
=====================
&hellip;
/usr/lib/security/$ISA/pkcs11_softtoken.so: all mechanisms are enabled.
random is enabled.
&hellip;</pre></li>
<li><b>Disable the mechanisms that should not be used.</b><pre>$ <tt><b>cryptoadm disable provider=/usr/lib/security/'$ISA'/pkcs11_softtoken.so \</b></tt>
&gt; <tt><b>mechanism=CKM_DES_CBC,CKM_DES_CBC_PAD,CKM_DES_ECB</b></tt></pre></li>
<li><b>List the mechanisms that are available for use.</b><pre>$ <tt><b>cryptoadm list -p provider=/usr/lib/security/'$ISA'/pkcs11_softtoken.so</b></tt>
/usr/lib/security/$ISA/pkcs11_softtoken.so: all mechanisms are enabled,
except CKM_DES_ECB,CKM_DES_CBC_PAD,CKM_DES_CBC. random is enabled.</pre></li></ol><a name="scftask-46"></a><h6>Example&nbsp;14-22 Enabling a User-Level Software Provider Mechanism</h6><p>In the following example, a disabled DES mechanism is again made available for
use.</p><pre>$ <tt><b>cryptoadm list -m provider=/usr/lib/security/'$ISA'/pkcs11_softtoken.so</b></tt>
/usr/lib/security/$ISA/pkcs11_softtoken.so:
CKM_DES_CBC,CKM_DES_CBC_PAD,CKM_DES_ECB,CKM_DES_KEY_GEN,
CKM_DES3_CBC,CKM_DES3_CBC_PAD,CKM_DES3_ECB,CKM_DES3_KEY_GEN,
&hellip;
$ <tt><b>cryptoadm list -p provider=/usr/lib/security/'$ISA'/pkcs11_softtoken.so</b></tt>
/usr/lib/security/$ISA/pkcs11_softtoken.so: all mechanisms are enabled,
except CKM_DES_ECB,CKM_DES_CBC_PAD,CKM_DES_CBC. random is enabled.
$ <tt><b>cryptoadm enable provider=/usr/lib/security/'$ISA'/pkcs11_softtoken.so \</b></tt>
&gt; <tt><b>mechanism=CKM_DES_ECB</b></tt>
$ <tt><b>cryptoadm list -p provider=/usr/lib/security/'$ISA'/pkcs11_softtoken.so</b></tt>
/usr/lib/security/$ISA/pkcs11_softtoken.so: all mechanisms are enabled,
except CKM_DES_CBC_PAD,CKM_DES_CBC. random is enabled.</pre><a name="scftask-44"></a><h6>Example&nbsp;14-23 Enabling All User-Level Software Provider Mechanisms</h6><p><a name="indexterm-1720"></a>In the following example, all mechanisms from the user-level library are enabled.</p><pre>$ <tt><b>cryptoadm enable provider=/usr/lib/security/'$ISA'/pkcs11_softtoken.so all</b></tt>
$ <tt><b>cryptoadm list -p provider=/usr/lib/security/'$ISA'/pkcs11_softtoken.so</b></tt>
/usr/lib/security/$ISA/pkcs11_softtoken.so: all mechanisms are enabled.
random is enabled.</pre><a name="scftask-43"></a><h6>Example&nbsp;14-24 Permanently Removing User-Level Software Provider Availability</h6><p><a name="indexterm-1721"></a><a name="indexterm-1722"></a>In the following example, the <tt>libpkcs11.so.1</tt> library is removed.</p><pre>$ <tt><b>cryptoadm uninstall provider=/opt/SUNWconn/lib/'$ISA'/libpkcs11.so.1</b></tt>
$ <tt><b>cryptoadm list</b></tt>
user-level providers:
    /usr/lib/security/$ISA/pkcs11_kernel.so
    /usr/lib/security/$ISA/pkcs11_softtoken.so

kernel software providers:
&hellip;</pre>

<a name="scftask-17"></a><h4>How to Prevent the Use of a Kernel Software Provider</h4><a name="indexterm-1723"></a><a name="indexterm-1724"></a><p><a name="indexterm-1725"></a><a name="indexterm-1726"></a>If the cryptographic framework provides multiple modes of a provider such as AES,
you might remove a slow mechanism from use, or a corrupted mechanism. This
procedure uses the AES algorithm as an example.</p><ol>
<li><b><a name="indexterm-1727"></a>Become superuser or assume a role that includes the Crypto Management rights profile.</b><p>To create a role that includes the Crypto Management rights profile and assign
the role to a user, see <a href="rbactask-30.html#rbactask-17">Example&nbsp;9-7</a>.</p></li>
<li><b><a name="indexterm-1728"></a><a name="indexterm-1729"></a><a name="indexterm-1730"></a><a name="indexterm-1731"></a><a name="indexterm-1732"></a><a name="indexterm-1733"></a>List the mechanisms that are offered by a particular kernel software provider.</b><pre>$ <tt><b>cryptoadm list -m provider=aes</b></tt>
aes: CKM_AES_ECB,CKM_AES_CBC</pre></li>
<li><b>List the mechanisms that are available for use.</b><pre>$ <tt><b>cryptoadm list -p provider=aes</b></tt>
aes: all mechanisms are enabled.</pre></li>
<li><b><a name="indexterm-1734"></a><a name="indexterm-1735"></a>Disable the mechanism that should not be used.</b><pre>$ <tt><b>cryptoadm disable provider=aes mechanism=CKM_AES_ECB</b></tt></pre></li>
<li><b>List the mechanisms that are available for use.</b><pre>$ <tt><b>cryptoadm list -p provider=aes</b></tt>
aes: all mechanisms are enabled, except CKM_AES_ECB.</pre></li></ol><a name="scftask-23"></a><h6>Example&nbsp;14-25 Enabling a Kernel Software Provider Mechanism</h6><a name="indexterm-1736"></a><a name="indexterm-1737"></a><a name="indexterm-1738"></a><a name="indexterm-1739"></a><p>In the following example, a disabled AES mechanism is again made available for
use.</p><pre><tt><b>cryptoadm list -m provider=aes</b></tt>
aes: CKM_AES_ECB,CKM_AES_CBC
$ <tt><b>cryptoadm list -p provider=aes</b></tt>
aes: all mechanisms are enabled, except CKM_AES_ECB.
$ <tt><b>cryptoadm enable provider=aes mechanism=CKM_AES_ECB</b></tt>
$ <tt><b>cryptoadm list -p provider=aes</b></tt>
aes: all mechanisms are enabled.</pre><a name="scftask-19"></a><h6>Example&nbsp;14-26 Temporarily Removing Kernel Software Provider Availability</h6><p><a name="indexterm-1740"></a>In the following example, the AES provider is temporarily removed from use. The
<tt>unload</tt> subcommand is useful to prevent a provider from being loaded automatically while
the provider is being uninstalled. For example, the <tt>unload</tt> subcommand would be used when
installing a patch that affects the provider.</p><pre>$ <tt><b>cryptoadm unload provider=aes</b></tt>
$ <tt><b>cryptoadm list</b></tt>
...
kernel software providers:
         des
         aes (inactive)
         blowfish
         arcfour
         sha1
         md5
         rsa
         swrand</pre><p>The AES provider is unavailable until the cryptographic framework is refreshed.</p><pre>$ <tt><b>svcadm refresh system/cryptosvc</b></tt>
$ <tt><b>cryptoadm list</b></tt>
...
kernel software providers:
         des
         aes
         blowfish
         arcfour
         sha1
         md5
         rsa
         swrand</pre><p>If a kernel consumer is using the kernel software provider, the software is
not unloaded. An error message is displayed and the provider continues to be
available for use.</p><a name="scftask-21"></a><h6>Example&nbsp;14-27 Permanently Removing Software Provider Availability</h6><p><a name="indexterm-1741"></a>In the following example, the AES provider is removed from use. Once removed,
the AES provider does not appear in the policy listing of kernel software
providers.</p><pre>$ <tt><b>cryptoadm uninstall provider=aes</b></tt>
$ <tt><b>cryptoadm list</b></tt>
&hellip;
kernel software providers:
         des
         blowfish
         arcfour
         sha1
         md5
         rsa
         swrand</pre><p>If a kernel consumer is using the kernel software provider, an error message
is displayed and the provider continues to be available for use.</p><a name="scftask-26"></a><h6>Example&nbsp;14-28 Reinstalling a Removed Kernel Software Provider</h6><p><a name="indexterm-1742"></a>In the following example, the AES kernel software provider is reinstalled.</p><pre>$ <tt><b>cryptoadm install provider=aes mechanism=CKM_AES_ECB,CKM_AES_CBC</b></tt>
$ <tt><b>cryptoadm list</b></tt>
&hellip;
kernel software providers:
         des
         aes
         blowfish
         arcfour
         sha1
         md5
         rsa
         swrand</pre>

<a name="scftask-13"></a><h4>How to List Hardware Providers</h4><a name="indexterm-1743"></a><a name="indexterm-1744"></a><a name="indexterm-1745"></a><a name="indexterm-1746"></a><a name="indexterm-1747"></a><p><a name="indexterm-1748"></a>Hardware providers are automatically located and loaded. For more information, see <a href="http://docs.sun.com/doc/819-2251/driver.conf-4?a=view"><tt>driver.conf</tt>(4)</a> man
page.</p><h6>Before You Begin</h6><p>When you add hardware that expects to be used within the Solaris
Cryptographic Framework, the hardware registers with the SPI in the kernel. The framework checks
that the hardware driver is signed. Specifically, the framework checks that the object
file of the driver is signed with a certificate that Sun issues.</p><ol>
<li><b>List the hardware providers that are available on the system.</b><pre>% <tt><b>cryptoadm list</b></tt>
&hellip; 
kernel hardware providers:
   dca/0</pre></li>
<li><b>List the mechanisms that the board provides.</b><pre>% <tt><b>cryptoadm list -m provider=dca/0</b></tt>
dca/0: CKM_RSA_PKCS, CKM_RSA_X_509, CKM_DSA, CKM_DES_CBC, CKM_DES3_CBC</pre></li>
<li><b>List the mechanisms that are available for use on the board.</b><pre>% <tt><b>cryptoadm list -p provider=dca/0</b></tt>
dca/0: all mechanisms are enabled. random is enabled.</pre></li></ol>

<a name="scftask-41"></a><h4>How to Disable Hardware Provider Mechanisms and Features</h4><a name="indexterm-1749"></a><a name="indexterm-1750"></a><a name="indexterm-1751"></a><a name="indexterm-1752"></a><a name="indexterm-1753"></a><a name="indexterm-1754"></a><p>You can selectively disable mechanisms and the random number feature from a hardware
provider. To enable them again, see <a href="#scftask-42">Example&nbsp;14-29</a>.</p><ol>
<li><b>List the mechanisms and features that are available from the board.</b><pre>% <tt><b>cryptoadm list -p provider=dca/0</b></tt>
dca/0: all mechanisms are enabled. random is enabled.</pre></li>
<li><b>Become superuser or assume a role that includes the Crypto Management rights profile.</b><p>To create a role that includes the Crypto Management rights profile and assign
the role to a user, see <a href="rbactask-30.html#rbactask-17">Example&nbsp;9-7</a>.</p></li>
<li><b>Choose the mechanisms or feature to disable:</b><ul>
<li><b>Disable selected mechanisms.</b><pre># <tt><b>cryptoadm list -m provider=dca/0</b></tt>
dca/0: CKM_RSA_PKCS, CKM_RSA_X_509, CKM_DSA, CKM_DES_CBC, CKM_DES3_CBC
random is enabled.
# <tt><b>cryptoadm disable provider=dca/0 mechanism=CKM_DES_CBC,CKM_DES3_CBC</b></tt>
# <tt><b>cryptoadm list -p provider=dca/0</b></tt>
dca/0: all mechanisms are enabled except CKM_DES_CBC,CKM_DES3_CBC.
random is enabled.</pre></li>
<li><b>Disable the random number generator.</b><pre># <tt><b>cryptoadm list -p provider=dca/0</b></tt>
dca/0: all mechanisms are enabled. random is enabled.
# <tt><b>cryptoadm disable provider=dca/0 random</b></tt>
# <tt><b>cryptoadm list -p provider=dca/0</b></tt>
dca/0: all mechanisms are enabled. random is disabled.</pre></li>
<li><b>Disable all mechanisms. Do not disable the random number generator.</b><pre># <tt><b>cryptoadm list -p provider=dca/0</b></tt>
dca/0: all mechanisms are enabled. random is enabled.
# <tt><b>cryptoadm disable provider=dca/0 mechanism=all</b></tt>
# <tt><b>cryptoadm list -p provider=dca/0</b></tt>
dca/0: all mechanisms are disabled. random is enabled.</pre></li>
<li><b>Disable every feature and mechanism on the hardware.</b><pre># <tt><b>cryptoadm list -p provider=dca/0</b></tt>
dca/0: all mechanisms are enabled. random is enabled.
# <tt><b>cryptoadm disable provider=dca/0 all</b></tt>
# <tt><b>cryptoadm list -p provider=dca/0</b></tt>
dca/0: all mechanisms are disabled. random is disabled.</pre></li></ul></li></ol><a name="scftask-42"></a><h6>Example&nbsp;14-29 Enabling Mechanisms and Features on a Hardware Provider</h6><p><a name="indexterm-1755"></a><a name="indexterm-1756"></a><a name="indexterm-1757"></a><a name="indexterm-1758"></a>In the following examples, disabled mechanisms on a piece of hardware are selectively
enabled.</p><pre># <tt><b>cryptoadm list -p provider=dca/0</b></tt>
dca/0: all mechanisms are enabled except CKM_DES_ECB,CKM_DES3_ECB.
random is enabled.
# <tt><b>cryptoadm enable provider=dca/0 mechanism=CKM_DES3_ECB</b></tt>
# <tt><b>cryptoadm list -p provider=dca/0</b></tt>
dca/0: all mechanisms are enabled except CKM_DES_ECB. random is enabled.</pre><p>In the following example, only the random generator is enabled.</p><pre># <tt><b>cryptoadm list -p provider=dca/0</b></tt>
dca/0: all mechanisms are enabled, except CKM_MD5,CKM_MD5_HMAC,&hellip;. 
random is disabled.
# <tt><b>cryptoadm enable provider=dca/0 random</b></tt>
# <tt><b>cryptoadm list -p provider=dca/0</b></tt>
dca/0: all mechanisms are enabled, except CKM_MD5,CKM_MD5_HMAC,&hellip;.
random is enabled.</pre><p>In the following example, only the mechanisms are enabled. The random generator continues
to be disabled.</p><pre># <tt><b>cryptoadm list -p provider=dca/0</b></tt>
dca/0: all mechanisms are enabled, except CKM_MD5,CKM_MD5_HMAC,&hellip;. 
random is disabled.
# <tt><b>cryptoadm enable provider=dca/0 mechanism=all</b></tt>
# <tt><b>cryptoadm list -p provider=dca/0</b></tt>
dca/0: all mechanisms are enabled. random is disabled.</pre><p>In the following example, every feature and mechanism on the board is enabled.</p><pre># <tt><b>cryptoadm list -p provider=dca/0</b></tt>
dca/0: all mechanisms are enabled, except CKM_DES_ECB,CKM_DES3_ECB.
random is disabled.
# <tt><b>cryptoadm enable provider=dca/0 all</b></tt>
# <tt><b>cryptoadm list -p provider=dca/0</b></tt>
dca/0: all mechanisms are enabled. random is enabled.</pre>

<a name="scftask-50"></a><h4>How to Refresh or Restart All Cryptographic Services</h4><a name="indexterm-1759"></a><a name="indexterm-1760"></a><a name="indexterm-1761"></a><a name="indexterm-1762"></a><a name="indexterm-1763"></a><a name="indexterm-1764"></a><a name="indexterm-1765"></a><a name="indexterm-1766"></a><a name="indexterm-1767"></a><a name="indexterm-1768"></a><a name="indexterm-1769"></a><p>By default, the Solaris Cryptographic Framework is enabled. When the <tt>kcfd</tt> daemon
fails for any reason, the service management facility can be used to restart
cryptographic services. For more information, see the <a href="http://docs.sun.com/doc/819-2252/smf-5?a=view"><tt>smf</tt>(5)</a> and <a href="http://docs.sun.com/doc/819-2240/svcadm-1m?a=view"><tt>svcadm</tt>(1M)</a> man pages. For
the effect on zones of restarting cryptographic services, see <a href="scf-17.html">Cryptographic Services and Zones</a>.</p><ol>
<li><b>Check the status of cryptographic services.</b><pre>% <tt><b>svcs \*cryptosvc\*</b></tt>
 STATE          STIME    FMRI
offline         Dec_09   svc:/system/cryptosvc:default</pre></li>
<li><b>Become superuser or assume an equivalent role to enable cryptographic services.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="rbactask-15.html">Configuring RBAC (Task Map)</a>.</p><pre># <tt><b>svcadm enable svc:/system/cryptosvc</b></tt></pre></li></ol><a name="scftask-51"></a><h6>Example&nbsp;14-30 Refreshing Cryptographic Services</h6><p>In the following example, cryptographic services are refreshed in the global zone. Therefore,
kernel-level cryptographic policy in every non-global zone is also refreshed.</p><pre># <tt><b>svcadm refresh system/cryptosvc</b></tt></pre>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="scftask-28.html">Previous</a>
             </td>
             <td align="right">
                 <a href="kmf-1.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

