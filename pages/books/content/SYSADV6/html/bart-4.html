<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Using BART (Tasks) - System Administration Guide: Security Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-08-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Security Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="bart-1zyx.html">Previous</a>
             </td>
             <td align="right">
                 <a href="bart-13.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="oview-1.html">Part&nbsp;I&nbsp;Security Overview</a></p>
<p class="toc level2"><a href="secov-1.html">1.&nbsp;&nbsp;Security Services (Overview)</a></p>
<p class="toc level1 tocsp"><a href="sectm-1.html">Part&nbsp;II&nbsp;System, File, and Device Security</a></p>
<p class="toc level2"><a href="concept-1.html">2.&nbsp;&nbsp;Managing Machine Security (Overview)</a></p>
<p class="toc level2"><a href="secsys-1.html">3.&nbsp;&nbsp;Controlling Access to Systems (Tasks)</a></p>
<p class="toc level2"><a href="vscan-1.html">4.&nbsp;&nbsp;Virus Scanning Service (Tasks)</a></p>
<p class="toc level2"><a href="devtask-1.html">5.&nbsp;&nbsp;Controlling Access to Devices (Tasks)</a></p>
<p class="toc level2"><a href="bart-1.html">6.&nbsp;&nbsp;Using the Basic Audit Reporting Tool (Tasks)</a></p>
<p class="toc level3"><a href="bart-2.html">Basic Audit Reporting Tool (Overview)</a></p>
<p class="toc level3"><a href="bart-1zyx.html">Using BART (Task Map)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Using BART (Tasks)</a></p>
</div>
<p class="toc level3"><a href="bart-13.html">BART Manifest, Rules File, and Reporting (Reference)</a></p>
<p class="toc level2 tocsp"><a href="secfile-1.html">7.&nbsp;&nbsp;Controlling Access to Files (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="prbactm-1.html">Part&nbsp;III&nbsp;Roles, Rights Profiles, and Privileges</a></p>
<p class="toc level2"><a href="prbac-1.html">8.&nbsp;&nbsp;Using Roles and Privileges (Overview)</a></p>
<p class="toc level2"><a href="rbactask-1.html">9.&nbsp;&nbsp;Using Role-Based Access Control (Tasks)</a></p>
<p class="toc level2"><a href="rbacref-1.html">10.&nbsp;&nbsp;Role-Based Access Control (Reference)</a></p>
<p class="toc level2"><a href="privtask-1.html">11.&nbsp;&nbsp;Privileges (Tasks)</a></p>
<p class="toc level2"><a href="privref-1.html">12.&nbsp;&nbsp;Privileges (Reference)</a></p>
<p class="toc level1 tocsp"><a href="scftm-1.html">Part&nbsp;IV&nbsp;Solaris Cryptographic Services</a></p>
<p class="toc level2"><a href="scf-1.html">13.&nbsp;&nbsp;Solaris Cryptographic Framework (Overview)</a></p>
<p class="toc level2"><a href="scftask-1.html">14.&nbsp;&nbsp;Solaris Cryptographic Framework (Tasks)</a></p>
<p class="toc level2"><a href="kmf-1.html">15.&nbsp;&nbsp;Solaris Key Management Framework</a></p>
<p class="toc level1 tocsp"><a href="authtm-1.html">Part&nbsp;V&nbsp;Authentication Services and Secure Communication</a></p>
<p class="toc level2"><a href="auth-1.html">16.&nbsp;&nbsp;Using Authentication Services (Tasks)</a></p>
<p class="toc level2"><a href="pam-1.html">17.&nbsp;&nbsp;Using PAM</a></p>
<p class="toc level2"><a href="sasl-1.html">18.&nbsp;&nbsp;Using SASL</a></p>
<p class="toc level2"><a href="sshuser-1.html">19.&nbsp;&nbsp;Using Solaris Secure Shell (Tasks)</a></p>
<p class="toc level2"><a href="sshref-1.html">20.&nbsp;&nbsp;Solaris Secure Shell (Reference)</a></p>
<p class="toc level1 tocsp"><a href="seamtm-1.html">Part&nbsp;VI&nbsp;Kerberos Service</a></p>
<p class="toc level2"><a href="intro-1.html">21.&nbsp;&nbsp;Introduction to the Kerberos Service</a></p>
<p class="toc level2"><a href="seamplan-1.html">22.&nbsp;&nbsp;Planning for the Kerberos Service</a></p>
<p class="toc level2"><a href="setup-8.html">23.&nbsp;&nbsp;Configuring the Kerberos Service (Tasks)</a></p>
<p class="toc level2"><a href="trouble-1.html">24.&nbsp;&nbsp;Kerberos Error Messages and Troubleshooting</a></p>
<p class="toc level2"><a href="aadmin-1.html">25.&nbsp;&nbsp;Administering Kerberos Principals and Policies (Tasks)</a></p>
<p class="toc level2"><a href="user-7.html">26.&nbsp;&nbsp;Using Kerberos Applications (Tasks)</a></p>
<p class="toc level2"><a href="refer-1.html">27.&nbsp;&nbsp;The Kerberos Service (Reference)</a></p>
<p class="toc level1 tocsp"><a href="audittm-1.html">Part&nbsp;VII&nbsp;Solaris Auditing</a></p>
<p class="toc level2"><a href="auditov-1.html">28.&nbsp;&nbsp;Solaris Auditing (Overview)</a></p>
<p class="toc level2"><a href="auditplan-1.html">29.&nbsp;&nbsp;Planning for Solaris Auditing</a></p>
<p class="toc level2"><a href="audittask-1.html">30.&nbsp;&nbsp;Managing Solaris Auditing (Tasks)</a></p>
<p class="toc level2"><a href="auditref-1.html">31.&nbsp;&nbsp;Solaris Auditing (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-2.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="bart-4"></a><h3>Using BART (Tasks)</h3>
<p><a name="indexterm-685"></a>You can run the <tt>bart</tt> command as a regular user, superuser, or a user
who has assumed the Primary Administrator role.  If you run the
<tt>bart</tt> command as a regular user, you will only be able to
catalog and monitor files that you have permission to access, for example, information about
files in your home directory. The advantage of  becoming superuser when you
run the <tt>bart</tt> command is that the manifests you create will contain information
about hidden and private files that you might want to monitor. If you
need to catalog and monitor information about files that have restricted permissions, for
example, the <tt>/etc/passwd</tt> or <tt>/etc/shadow</tt> file, run the <tt>bart</tt> command as superuser or
assume an equivalent role. For more information about using role-based access control, see
<a href="rbactask-15.html">Configuring RBAC (Task Map)</a>.</p>

<a name="bart-aa"></a><h4>BART Security Considerations</h4>
<a name="indexterm-686"></a><a name="indexterm-687"></a><p>Running the <tt>bart</tt> command as superuser makes the output readable by anyone. This
output might contain file names that are intended to be private. If you
become superuser when you run the <tt>bart</tt> command, take appropriate measures to protect
the output. For example, use options that generate output files with restrictive permissions.</p>
<hr><p><b>Note - </b>The procedures and examples in this chapter show the <tt>bart</tt> command run by
superuser. Unless otherwise specified, running the <tt>bart</tt> command as superuser is optional.</p>
<hr>


<a name="bart-5"></a><h4>How to Create a Manifest</h4><p>You can create a manifest of a system immediately after an initial
Solaris software installation. This type of manifest will provide you with a baseline for
comparing changes to the same system over time. Or, you can use
this manifest to compare with the manifests for different systems. For example, if
you take a snapshot of each system on your network, and then compare
each test manifest with the control manifest, you can quickly determine what you
need to do to synchronize the test system with the baseline configuration.<a name="indexterm-688"></a></p><ol>
<li><b>Assume the Primary Administrator role, or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b><a name="indexterm-689"></a><a name="indexterm-690"></a><a name="indexterm-691"></a><a name="indexterm-692"></a>After installing the Solaris software, create a control manifest and redirect the output
to a file.</b><pre># bart create <i>options &gt; control-manifest</i></pre><dl><dt><tt>-R</tt></dt>
<dd><p>Specifies the root directory for the manifest. All paths specified by the rules will be interpreted relative to this directory. All paths reported in the manifest will be relative to this directory.</p></dd>
<dt><tt>-I</tt></dt>
<dd><p>Accepts a list of individual files to be cataloged, either on the command line or read from standard input.</p></dd>
<dt><tt>-r</tt></dt>
<dd><p>Is the name of the rules file for this manifest. Note that <tt>&ndash;</tt>, when used with the <tt>-r</tt> option, will be read the rules file from standard input.</p></dd>
<dt><tt>-n</tt></dt>
<dd><p>Turns off content signatures for all regular files in the file list. This option can be used to improve performance. Or, you can use this option if the contents of the file list are expected to change, as in the case of system log files.</p></dd>
</dl>
</li>
<li><b>Examine the contents of the manifest.</b></li>
<li><b>Save the manifest for future use.</b><p>Choose a meaningful name for the manifest. For example, use the system name
and date that the manifest was created.</p></li></ol><a name="egysq"></a><h6>Example&nbsp;6-1 Creating a Manifest That Lists Information About Every File on a System</h6><p>If you run the <tt>bart create</tt> command without any options, information about every file
that is installed on the system will be cataloged. Use this type of
manifest as a baseline when you are installing many systems from a central
image. Or, use this type of manifest to run comparisons when you want
to ensure that the installations are identical.</p><p>For example:</p><pre># <tt><b>bart create</b></tt>
! Version 1.0
! Thursday, December 04, 2003 (16:17:39)
# Format:
#fname D size mode acl dirmtime uid gid
#fname P size mode acl mtime uid gid
#fname S size mode acl mtime uid gid
#fname F size mode acl mtime uid gid contents
#fname L size mode acl lnmtime uid gid dest
#fname B size mode acl mtime uid gid devnode
#fname C size mode acl mtime uid gid devnode
/ D 1024 40755 user::rwx,group::r-x,mask:r-x,other:r-x 3fd9ea47 0 0
/.java D 512 40755 user::rwx,group::r-x,mask:r-x,other:r-x 3f8dc04d 0 10
/.java/.userPrefs D 512 40700 user::rwx,group::---,mask:---
other:--- 3f8dc06b 010
/.java/.userPrefs/.user.lock.root F 0 100600 user::rw-
group::---,mask:---,other:--- 3f8dc06b 0 10 -
/.java/.userPrefs/.userRootModFile.root F 0 100600 user::rw-,
group::---,mask:---,other:--- 3f8dc0a1 0 10 -
/.smc.properties F 1389 100644 user::rw-,group::r--,mask:r--
other:r-- 3f8dca0c0 10
.
.
.
/var/sadm/pkg/SUNWdtmad/install/depend F 932 100644 user::rw-,
group::r--,mask:r--,other:r-- 3c23a19e 0 0 -
/var/sadm/pkg/SUNWdtmad/pkginfo F 594 100644 user::rw-
group::r--,mask:r--,other:r-- 3f81e416 0 0 -
/var/sadm/pkg/SUNWdtmad/save D 512 40755 user::rwx,group::r-x
mask:r-x,other:r-x 3f81e416 0 0
/var/sadm/pkg/SUNWdtmaz D 512 40755 user::rwx,group::r-x
mask:r-x,other:r-x 3f81e41b 0 0
/var/sadm/pkg/TSIpgxw/save D 512 40755 user::rwx
group::r-x,mask:r-x,other:r-x 3f81e892 0 0
.
.
.</pre><p>Each manifest consists of a header and entries. Each manifest file entry is
a single line, depending on the file type. For example, for each
manifest entry in the preceding output, type <tt>F</tt> specifies a file and type <tt>D</tt>
specifies a directory. Also listed is information about size, content, user ID, group
ID, and permissions. File entries in the output are sorted by the encoded
versions of the file names to correctly handle special characters. All entries are
sorted in ascending order by file name. All nonstandard file names, such as
those that contain embedded newline or tab characters, have the nonstandard characters quoted
before being sorted.</p><p>Lines that begin with <tt>!</tt> supply metadata about the manifest. The manifest version
line indicates the manifest specification version. The date line shows the date on
which the manifest was created, in date form. See the <a href="http://docs.sun.com/doc/819-2239/date-1?a=view"><tt>date</tt>(1)</a> man page. Some
lines are ignored by the manifest comparison tool. Ignored lines include blank lines,
lines that consist only of white space, and comments that begin with <tt>#</tt>.
</p>

<a name="bart-5bcd"></a><h4>How to Customize a Manifest</h4><a name="indexterm-693"></a><a name="indexterm-694"></a><p>You can customize a manifest in one of the following ways:</p>
<ul><li><p>By specifying a subtree</p><p>Creating a manifest for an individual subtree on a system is an efficient way to monitor changes to specific files, rather than the entire contents of a large directory. You can create a baseline manifest of a specific subtree on your system, then periodically create test manifests of the same subtree. Use the <tt>bart compare</tt> command to compare the control manifest with the test manifest. By using this option, you are able to efficiently monitor important file systems to determine whether any files have been compromised by an intruder.</p></li>
<li><p>By specifying a file name</p><p>Since creating a manifest that catalogs the entire system is more time-consuming, takes up more space, and is more costly, you might choose to use this option of the <tt>bart</tt> command when you want to only list information about a specific file or files on a system.</p></li>
<li><p>By using a rules file</p><p>You use a rules file to create custom manifests that list information about specific files and specific subtrees on a given system. You can also use a rules file to monitor specific file attributes. Using a rules file to create and compare manifests gives you the flexibility to specify multiple attributes for more than one file or subtree. Whereas, from the command line, you can only specify a global attribute definition that applies to all files for each manifest you create or report you generate.</p></li></ul>
<ol>
<li><b>Determine which files you want to catalog and monitor.</b></li>
<li><b>Assume the Primary Administrator role, or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b>After installing the Solaris software, create a custom manifest by using one of
the following options:</b>
<ul><li><p>By specifying a subtree:</p><pre># bart create -R <i>root-directory</i></pre></li>
<li><p>By specifying a file name or file names:</p><pre># bart create -I <i>filename...</i></pre><p>For example:</p><pre># <tt><b>bart create -I /etc/system /etc/passwd /etc/shadow</b></tt></pre></li>
<li><p>By using a rules file:</p><pre># bart create -r <i>rules-file</i></pre></li></ul>
</li>
<li><b>Examine the contents of the manifest.</b></li>
<li><b>Save the manifest for future use.</b></li></ol><a name="egysp"></a><h6>Example&nbsp;6-2 Creating a Manifest by Specifying a Subtree</h6><p>This example shows how to create a manifest that contains information about the
files in the <tt>/etc/ssh</tt> subtree only.</p><pre># <tt><b>bart create -R /etc/ssh</b></tt>
! Version 1.0
! Saturday, November 29, 2003 (14:05:36)
# Format:
#fname D size mode acl dirmtime uid gid
#fname P size mode acl mtime uid gid
#fname S size mode acl mtime uid gid
#fname F size mode acl mtime uid gid contents
#fname L size mode acl lnmtime uid gid dest
#fname B size mode acl mtime uid gid devnode
#fname C size mode acl mtime uid gid devnode
/ D 512 40755 user::rwx,group::r-x,mask:r-x,other:r-x 3f81eab9 0 3
/ssh_config F 861 100644 user::rw-,group::r--,mask:r--,
other:r-- 3f81e504 0 3 422453ca0e2348cd9981820935600395
/ssh_host_dsa_key F 668 100600 user::rw-,group::---,mask:---,
other:--- 3f81eab9 0 0 5cc28cdc97e833069fd41ef89e4d9834
/ssh_host_dsa_key.pub F 602 100644 user::rw-,group::r--,mask:r--,
other:r-- 3f81eab9 0 0 16118c736995a4e4754f5ab4f28cf917
/ssh_host_rsa_key F 883 100600 user::rw-,group::---,mask:---,
other:--- 3f81eaa2 0 0 6ff17aa968ecb20321c448c89a8840a9
/ssh_host_rsa_key.pub F 222 100644 user::rw-,group::r--,mask:r--,
other:r-- 3f81eaa2 0 0 9ea27617efc76058cb97aa2caa6dd65a
.
.
.</pre><a name="egyso"></a><h6>Example&nbsp;6-3 Customizing a Manifest by Specifying a File Name</h6><p>This example shows how to create a manifest that lists only information about
the <tt>/etc/passwd</tt> and <tt>/etc/shadow</tt> files on a system. </p><pre># <tt><b>bart create -I /etc/passwd /etc/shadow</b></tt>
! Version 1.0
! Monday, December 15, 2003 (16:28:55)
# Format:
#fname D size mode acl dirmtime uid gid
#fname P size mode acl mtime uid gid
#fname S size mode acl mtime uid gid
#fname F size mode acl mtime uid gid contents
#fname L size mode acl lnmtime uid gid dest
#fname B size mode acl mtime uid gid devnode
#fname C size mode acl mtime uid gid devnode
/etc/passwd F 542 100444 user::r--,group::r--,mask:r--,
other:r-- 3fcfd45b 0 3 d6
84554f85d1de06219d80543174ad1a
/etc/shadow F 294 100400 user::r--,group::---,mask:---,
other:--- 3f8dc5a0 0 3 fd
c3931c1ae5ee40341f3567b7cf15e2</pre><p>By comparison, the following is the standard output of the <tt>ls <tt>-al</tt></tt> command
for the <tt>/etc/passwd</tt> and the <tt>/etc/shadow</tt> files on the same system.</p><pre># ls -al /etc/passwd
-r--r--r--   1 root     sys          542 Dec  4 17:42 /etc/passwd</pre><pre># ls -al /etc/shadow
-r--------   1 root     sys          294 Oct 15 16:09 /etc/shadow</pre><a name="egyss"></a><h6>Example&nbsp;6-4 Customizing a Manifest by Using a Rules File</h6><p>This example shows how to create a manifest by using a rules
file to catalog only those files in the <tt>/etc</tt> directory. The same rules file
includes directives to be used by the <tt>bart compare</tt> command for monitoring changes to
the <tt>acl</tt> attribute of the <tt>/etc/system</tt> file.</p>
<ul><li><p>Use a text editor to create a rules file that catalogs only those files in the <tt>/etc</tt> directory.</p><pre># List information about all the files in the /etc directory.

CHECK all
/etc

# Check only acl changes in the /etc/system file

IGNORE all
CHECK acl
/etc/system</pre><p>For more information about creating a rules file, see <a href="bart-2.html#bart-3c">BART Rules File</a>.</p></li>
<li><p>Create a control manifest by using the rules file you created.</p><pre># <tt><b>bart create -r </tt><i>etc.rules-file</i><tt> &gt; </tt><i>etc.system.control-manifest</i><tt></b></tt>
! Version 1.0
! Thursday, December 11, 2003 (21:51:32)
# Format:
#fname D size mode acl dirmtime uid gid
#fname P size mode acl mtime uid gid
#fname S size mode acl mtime uid gid
#fname F size mode acl mtime uid gid contents
#fname L size mode acl lnmtime uid gid dest
#fname B size mode acl mtime uid gid devnode
#fname C size mode acl mtime uid gid devnode
/etc/system F 1883 100644 user::rw-,group::r--,mask:r--,
other:r-- 3f81db61 0 3</pre></li>
<li><p>Create a test manifest whenever you want to monitor changes to the system. Prepare the test manifest identically to the control manifest by using the same <tt>bart</tt> options and the same rules file. </p></li>
<li><p>Compare manifests by using the same rules file.</p></li></ul>


<a name="bart-9"></a><h4>How to Compare Manifests for the Same System Over Time</h4><p>Use this procedure when you want to monitor file-level changes to the same
system over time. This type of manifest can assist you in locating
corrupted or unusual files, detecting security breaches, or in troubleshooting performance issues on a
system.</p><ol>
<li><b>Assume the Primary Administrator role, or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b>After installing the Solaris software, create a control manifest of the files that
you want to monitor on the system.<a name="indexterm-695"></a> <a name="indexterm-696"></a><a name="indexterm-697"></a> <a name="indexterm-698"></a></b><pre># bart create -R /etc &gt; <i>control-manifest</i></pre></li>
<li><b>Create a test manifest that is prepared identically to the control manifest whenever
you want monitor changes to the system.</b><pre># bart create -R /etc &gt; <i>test-manifest</i></pre></li>
<li><b>Compare the control manifest with the test manifest.</b><pre># bart compare <i>options</i> <i>control-manifest test-manifest &gt; bart-report</i></pre><dl><dt><tt>-r</tt></dt>
<dd><p>Is the name of the rules file for this comparison. Using the <tt>-r</tt> option with the <tt>&ndash;</tt> means that the directives will be read from standard input.</p></dd>
<dt><tt>-i</tt></dt>
<dd><p>Allows the user to set global <tt>IGNORE</tt> directives from the command line.</p></dd>
<dt><tt>-p</tt></dt>
<dd><p>Is the programmatic mode that generates standard non-localized output for programmatic parsing.</p></dd>
<dt><i>control-manifest</i></dt>
<dd><p>Is the output from the <tt>bart create</tt> command for the control system.</p></dd>
<dt><i>test-manifest</i></dt>
<dd><p>Is the output from the <tt>bart create</tt> command of the test system.</p></dd>
</dl>
</li>
<li><b>Examine the BART report for oddities.</b></li></ol><a name="egysr"></a><h6>Example&nbsp;6-5 Comparing Manifests for the Same System Over Time</h6><p>This example shows how to monitor changes that have occurred in the
<tt>/etc</tt> directory between two points in time. This type of comparison enables you
to quickly determine whether important files on the system have been compromised.</p>
<ul><li><p>Create a control manifest.</p><pre># <tt><b>bart create -R /etc &gt; system1.control.121203</b></tt>
! Version 1.0
! Friday, December 12, 2003 (08:34:51)
# Format:
#fname D size mode acl dirmtime uid gid
#fname P size mode acl mtime uid gid
#fname S size mode acl mtime uid gid
#fname F size mode acl mtime uid gid contents
#fname L size mode acl lnmtime uid gid dest
#fname B size mode acl mtime uid gid devnode
#fname C size mode acl mtime uid gid devnode
/ D 4096 40755 user::rwx,group::r-x,mask:r-x,other:r-x 3fd9dfb4 0 3
/.cpr_config F 2236 100644 user::rw-,group::r--,mask:r--,other:r--
3fd9991f 0 0
67cfa2c830b4ce3e112f38c5e33c56a2
/.group.lock F 0 100600 user::rw-,group::---,mask:---,other:--- 3f81f14d
0 1 d41
d8cd98f00b204e9800998ecf8427e
/.java D 512 40755 user::rwx,group::r-x,mask:r-x,other:r-x 3f81dcb5 0 2
/.java/.systemPrefs D 512 40755 user::rwx,group::r-x,mask:r-x,
other:r-x 3f81dcb7
.
.
.</pre></li>
<li><p>Create a test manifest when you want to monitor changes to the <tt>/etc</tt> directory.</p><pre># <tt><b>bart create -R /etc &gt; system1.test.121503</b></tt>
Version 1.0
! Monday, December 15, 2003 (08:35:28)
# Format:
#fname D size mode acl dirmtime uid gid
#fname P size mode acl mtime uid gid
#fname S size mode acl mtime uid gid
#fname F size mode acl mtime uid gid contents
#fname L size mode acl lnmtime uid gid dest
#fname B size mode acl mtime uid gid devnode
#fname C size mode acl mtime uid gid devnode
/ D 4096 40755 user::rwx,group::r-x,mask:r-x,other:r-x 3fd9dfb4 0 3
/.cpr_config F 2236 100644 user::rw-,group::r--,mask:r--,other:r--
3fd9991f 0 0
67cfa2c830b4ce3e112f38c5e33c56a2
/.group.lock F 0 100600 user::rw-,group::---,mask:---,other:---
3f81f14d 0 1 d41d8cd98f00b204e9800998ecf8427e
/.java D 512 40755 user::rwx,group::r-x,mask:r-x,other:r-x 3f81dcb5 0 2
/.java/.systemPrefs D 512 40755 user::rwx,group::r-x,mask:r-x,
other:r-x 3f81dcb70 2
/.java/.systemPrefs/.system.lock F 0 100644 user::rw-,group::r--
,mask:r--,other:
r-- 3f81dcb5 0 2 d41d8cd98f00b204e9800998ecf8427e
/.java/.systemPrefs/.systemRootModFile F 0 100644 user::rw-,
group::r--,mask:r--,
other:r-- 3f81dd0b 0 2 d41d8cd98f00b204e9800998ecf8427e
.
.
.</pre></li>
<li><p>Compare the control manifest with the test manifest.</p><pre># <tt><b>bart compare system1.control.121203 system1.test.121503</b></tt>
/vfstab:
  mode  control:100644  test:100777
  acl  control:user::rw-,group::r--,mask:r--,other:r--  test:user::rwx,
group::rwx,mask:rwx,other:rwx</pre></li></ul>
<p>The preceding output indicates permissions on the <tt>vfstab</tt> file have changed since the
control manifest was created. This report can be used to investigate whether ownership,
date, content, or any other file attributes have changed. Having this type of
information readily available can assist you in tracking down who might have tampered
with the file and when the change might have occurred.</p>

<a name="bart-10"></a><h4>How to Compare Manifests From a Different System With the Manifest of a Control System</h4><p>You can run system to system comparisons, thereby enabling you to quickly determine
whether there are any file-level differences between a baseline system and the other
systems. For example, if you have installed a particular version of the Solaris
software on a baseline system, and you want to know whether other systems
have identical packages installed, you can create manifests for those systems and then
compare the test manifests with the control manifest. This type of comparison will
list any discrepancies in the file contents for each test system that you
compare with the control system.</p><ol>
<li><b>Assume the Primary Administrator role, or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b>After installing the Solaris software, create a control manifest.</b><pre># bart create <i>options</i> &gt; <i>control-manifest</i></pre></li>
<li><b>Save the control manifest.</b></li>
<li><b>On the test system, use the same <tt>bart</tt> options to create a manifest,
and redirect the output to a file.</b><pre># bart create <i>options</i> &gt; <i>test1-manifest</i></pre><p>Choose a distinct and meaningful name for the test manifest.</p></li>
<li><b>Save the test manifest to a central location on the system until you
are ready to compare manifests.</b></li>
<li><b>When you want to compare manifests, copy the control manifest to the location
of the test manifest. Or, copy the test manifest to the control system.</b><p>For example:</p><p># <tt><b>cp </tt><i>control-manifest /net/test-server/bart/manifests</i><tt></b></tt></p><p>If the test system is not an NFS-mounted system, use <tt>FTP</tt> or some other
reliable means to copy the control manifest to the test system.</p></li>
<li><b>Compare the control manifest with the test manifest and redirect the output to
a file.</b><pre># <tt><b>bart compare </tt><i>control-manifest test1-manifest &gt; test1.report</i><tt></b></tt></pre></li>
<li><b>Examine the BART report for oddities.</b></li>
<li><b>Repeat Step 4 through Step 9 for each test manifest that you
want to compare with the control manifest.</b><p>Use the same <tt>bart</tt> options for each test system.</p></li></ol><a name="egyst"></a><h6>Example&nbsp;6-6 Comparing Manifests From Different Systems With the Manifest of a Control System</h6><p>This example describes how to monitor changes to the contents of the
<tt>/usr/bin</tt> directory by comparing a control manifest with a test manifest from a
different system.</p>
<ul><li><p>Create a control manifest.</p><pre># <tt><b>bart create -R /usr/bin &gt; control-manifest.121203</b></tt>
!Version 1.0
! Friday, December 12, 2003 (09:19:00)
# Format:
#fname D size mode acl dirmtime uid gid
#fname P size mode acl mtime uid gid
#fname S size mode acl mtime uid gid
#fname F size mode acl mtime uid gid contents
#fname L size mode acl lnmtime uid gid dest
#fname B size mode acl mtime uid gid devnode
#fname C size mode acl mtime uid gid devnode
/ D 13312 40755 user::rwx,group::r-x,mask:r-x,other:r-x 3fd9e925 0 2
/.s F 14200 104711 user::rwx,group::--x,mask:--x,other:--x
3f8dbfd6 0 1 8ec7e52d8a35ba3b054a6394cbf71cf6
/ControlPanel L 28 120777 - 3f81dc71 0 1 jre/bin/ControlPanel
/HtmlConverter L 25 120777 - 3f81dcdc 0 1 bin/HtmlConverter
/acctcom F 28300 100555 user::r-x,group::r-x,mask:r-x,other:r-x
3f6b5750 0 2 d6e99b19c847ab4ec084d9088c7c7608
/activation-client F 9172 100755 user::rwx,group::r-x,mask:r-x,
other:r-x 3f5cb907 0 1 b3836ad1a656324a6e1bd01edcba28f0
/adb F 9712 100555 user::r-x,group::r-x,mask:r-x,other:r-x
3f6b5736 0 2 5e026413175f65fb239ee628a8870eda
/addbib F 11080 100555 user::r-x,group::r-x,mask:r-x,other:r-x
3f6b5803 0 2 a350836c36049febf185f78350f27510
.
.
.</pre></li>
<li><p>Create a test manifest for each system that you want to compare with the control system.</p><pre># <tt><b>bart create -R /usr/bin &gt; system2-manifest.121503</b></tt>
! Version 1.0
! Friday, December 15, 2003 (13:30:58)
# Format:
#fname D size mode acl dirmtime uid gid
#fname P size mode acl mtime uid gid
#fname S size mode acl mtime uid gid
#fname F size mode acl mtime uid gid contents
#fname L size mode acl lnmtime uid gid dest
#fname B size mode acl mtime uid gid devnode
#fname C size mode acl mtime uid gid devnode
/ D 13312 40755 user::rwx,group::r-x,mask:r-x,other:r-x 3fd9ea9c 0 2
/.s F 14200 104711 user::rwx,group::--x,mask:--x,other:--x
3f8dbfd6 0 1 8ec7e52d8a35ba3b054a6394cbf71cf6
/ControlPanel L 28 120777 - 3f81dc71 0 1 jre/bin/ControlPanel
/HtmlConverter L 25 120777 - 3f81dcdc 0 1 bin/HtmlConverter
/acctcom F 28300 100555 user::r-x,group::r-x,mask:r-x,other:
r-x 3f6b5750 0 2 d6e99b19c847ab4ec084d9088c7c7608
.
.
.</pre></li>
<li><p>When you want to compare manifests, copy the manifests to the same location.</p><pre># <tt><b>cp control-manifest /net/system2.central/bart/manifests</b></tt></pre></li>
<li><p>Compare the control manifest with the test manifest.</p><pre># <tt><b>bart compare control-manifest system2.test &gt; system2.report</b></tt>
/su:
  gid  control:3  test:1
/ypcat:
  mtime  control:3fd72511  test:3fd9eb23</pre></li></ul>
<p>The previous output indicates that the group ID of the <tt>su</tt> file in
the <tt>/usr/bin</tt> directory is not the same as that of the control system.
This information can be helpful in determining whether a different version of the
software was installed on the test system or if possibly someone has tampered
with the file.</p>

<a name="bart-11"></a><h4>How to Customize a BART Report by Specifying File Attributes</h4><p>This procedure is optional and explains how to customize a BART report by
specifying file attributes from the command line. If you create a baseline manifest
that lists information about all the files or specific on your system, you
can run the <tt>bart compare</tt> command, specifying different attributes, whenever you need to monitor
changes to a particular directory, subdirectory, file or files. You can run different
types of comparisons for the same manifests by specifying different file attributes from
the command line.</p><ol>
<li><b>Determine which file attributes you want to monitor.</b></li>
<li><b>Assume the Primary Administrator role, or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b>After installing the Solaris software, create a control manifest.</b></li>
<li><b>Create a test manifest when you want to monitor changes.</b><p>Prepare the test manifest identically to the control manifest.</p></li>
<li><b>Compare the manifests.</b><p>For example:</p><pre># <tt><b>bart compare -i dirmtime,lnmtime,mtime </tt><i>control-manifest.121503</i><tt></b></tt> \
<tt><b></tt><i>test-manifest.010504</i><tt> &gt; </tt><i>bart.report.010504</i><tt></b></tt></pre><p>Note that a comma separates each attribute you specify in the command-line syntax.</p></li>
<li><b>Examine the BART report for oddities.</b></li></ol>

<a name="bart-12"></a><h4>How to Customize a BART Report by Using a Rules File</h4><a name="indexterm-699"></a><p>This procedure is also optional and explains how to customize a BART report
by using a rules file as input to the <tt>bart compare</tt> command. By using
a rules file, you can customize a BART report, which allows you
the flexibility of specifying multiple attributes for more than one file or subtree. You
can run different comparisons for the same manifests by using different rules files.</p><ol>
<li><b>Assume the Primary Administrator role, or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b>Determine which files and file attributes you want to monitor.</b></li>
<li><b>Use a text editor to create a rules file with the appropriate directives.</b></li>
<li><b>After installing the Solaris software, create a control manifest by using the rules
file you created.</b><pre># bart create -r <i>rules-file</i> &gt; <i>control-manifest</i></pre></li>
<li><b>Create a test manifest that is prepared identically to the control manifest.</b><pre># bart create -r <i>rules-file</i> &gt; <i>test-manifest</i></pre></li>
<li><b>Compare the control manifest with the test manifest by using the same rules
file.</b><pre># bart compare -r <i>rules-file control-manifest test-manifest &gt; bart.report</i></pre></li>
<li><b>Examine the BART report for oddities.</b></li></ol><a name="egysu"></a><h6>Example&nbsp;6-7 Customizing a BART Report by Using a Rules File</h6><p>The following rules file includes directives for both the <tt>bart create</tt> and the
<tt>bart compare</tt> commands. The rules file directs the <tt>bart create</tt> command to list information about the
contents of the <tt>/usr/bin</tt> directory. In addition, the rules file directs the <tt>bart compare</tt>
command to track only size and content changes in the same directory.</p><pre># Check size and content changes in the /usr/bin directory.
# This rules file only checks size and content changes.
# See rules file example.

IGNORE all
CHECK size contents
/usr/bin</pre>
<ul><li><p>Create a control manifest by using the rules file you created.</p><pre># <tt><b>bart create -r bartrules.txt &gt; usr_bin.control-manifest.121003</b></tt></pre></li>
<li><p>Create a test manifest whenever you want to monitor changes to the <tt>/usr/bin</tt> directory.</p><pre># <tt><b>bart create -r bartrules.txt &gt; usr_bin.test-manifest.121103</b></tt></pre></li>
<li><p>Compare the manifests by using the same rules file.</p><pre># <tt><b>bart compare -r bartrules.txt usr_bin.control-manifest \</b></tt>
<tt><b>usr_bin.test-manifest</b></tt></pre></li>
<li><p>Examine the output of the <tt>bart compare</tt> command.</p><pre> /usr/bin/gunzip:  add
/usr/bin/ypcat:
  delete</pre></li></ul>
<p>In the preceding output, the <tt>bart compare</tt> command reported a discrepancy in the <tt>/usr/bin</tt>
directory. This output indicates that <tt>/usr/bin/ypcat</tt> file was deleted, and the <tt>/usr/bin/gunzip</tt> file was
added.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="bart-1zyx.html">Previous</a>
             </td>
             <td align="right">
                 <a href="bart-13.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

