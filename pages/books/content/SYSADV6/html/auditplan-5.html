<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Determining Audit Policy - System Administration Guide: Security Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-08-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Security Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="auditplan-12.html">Previous</a>
             </td>
             <td align="right">
                 <a href="auditplan-3.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="oview-1.html">Part&nbsp;I&nbsp;Security Overview</a></p>
<p class="toc level2"><a href="secov-1.html">1.&nbsp;&nbsp;Security Services (Overview)</a></p>
<p class="toc level1 tocsp"><a href="sectm-1.html">Part&nbsp;II&nbsp;System, File, and Device Security</a></p>
<p class="toc level2"><a href="concept-1.html">2.&nbsp;&nbsp;Managing Machine Security (Overview)</a></p>
<p class="toc level2"><a href="secsys-1.html">3.&nbsp;&nbsp;Controlling Access to Systems (Tasks)</a></p>
<p class="toc level2"><a href="vscan-1.html">4.&nbsp;&nbsp;Virus Scanning Service (Tasks)</a></p>
<p class="toc level2"><a href="devtask-1.html">5.&nbsp;&nbsp;Controlling Access to Devices (Tasks)</a></p>
<p class="toc level2"><a href="bart-1.html">6.&nbsp;&nbsp;Using the Basic Audit Reporting Tool (Tasks)</a></p>
<p class="toc level2"><a href="secfile-1.html">7.&nbsp;&nbsp;Controlling Access to Files (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="prbactm-1.html">Part&nbsp;III&nbsp;Roles, Rights Profiles, and Privileges</a></p>
<p class="toc level2"><a href="prbac-1.html">8.&nbsp;&nbsp;Using Roles and Privileges (Overview)</a></p>
<p class="toc level2"><a href="rbactask-1.html">9.&nbsp;&nbsp;Using Role-Based Access Control (Tasks)</a></p>
<p class="toc level2"><a href="rbacref-1.html">10.&nbsp;&nbsp;Role-Based Access Control (Reference)</a></p>
<p class="toc level2"><a href="privtask-1.html">11.&nbsp;&nbsp;Privileges (Tasks)</a></p>
<p class="toc level2"><a href="privref-1.html">12.&nbsp;&nbsp;Privileges (Reference)</a></p>
<p class="toc level1 tocsp"><a href="scftm-1.html">Part&nbsp;IV&nbsp;Solaris Cryptographic Services</a></p>
<p class="toc level2"><a href="scf-1.html">13.&nbsp;&nbsp;Solaris Cryptographic Framework (Overview)</a></p>
<p class="toc level2"><a href="scftask-1.html">14.&nbsp;&nbsp;Solaris Cryptographic Framework (Tasks)</a></p>
<p class="toc level2"><a href="kmf-1.html">15.&nbsp;&nbsp;Solaris Key Management Framework</a></p>
<p class="toc level1 tocsp"><a href="authtm-1.html">Part&nbsp;V&nbsp;Authentication Services and Secure Communication</a></p>
<p class="toc level2"><a href="auth-1.html">16.&nbsp;&nbsp;Using Authentication Services (Tasks)</a></p>
<p class="toc level2"><a href="pam-1.html">17.&nbsp;&nbsp;Using PAM</a></p>
<p class="toc level2"><a href="sasl-1.html">18.&nbsp;&nbsp;Using SASL</a></p>
<p class="toc level2"><a href="sshuser-1.html">19.&nbsp;&nbsp;Using Solaris Secure Shell (Tasks)</a></p>
<p class="toc level2"><a href="sshref-1.html">20.&nbsp;&nbsp;Solaris Secure Shell (Reference)</a></p>
<p class="toc level1 tocsp"><a href="seamtm-1.html">Part&nbsp;VI&nbsp;Kerberos Service</a></p>
<p class="toc level2"><a href="intro-1.html">21.&nbsp;&nbsp;Introduction to the Kerberos Service</a></p>
<p class="toc level2"><a href="seamplan-1.html">22.&nbsp;&nbsp;Planning for the Kerberos Service</a></p>
<p class="toc level2"><a href="setup-8.html">23.&nbsp;&nbsp;Configuring the Kerberos Service (Tasks)</a></p>
<p class="toc level2"><a href="trouble-1.html">24.&nbsp;&nbsp;Kerberos Error Messages and Troubleshooting</a></p>
<p class="toc level2"><a href="aadmin-1.html">25.&nbsp;&nbsp;Administering Kerberos Principals and Policies (Tasks)</a></p>
<p class="toc level2"><a href="user-7.html">26.&nbsp;&nbsp;Using Kerberos Applications (Tasks)</a></p>
<p class="toc level2"><a href="refer-1.html">27.&nbsp;&nbsp;The Kerberos Service (Reference)</a></p>
<p class="toc level1 tocsp"><a href="audittm-1.html">Part&nbsp;VII&nbsp;Solaris Auditing</a></p>
<p class="toc level2"><a href="auditov-1.html">28.&nbsp;&nbsp;Solaris Auditing (Overview)</a></p>
<p class="toc level2"><a href="auditplan-1.html">29.&nbsp;&nbsp;Planning for Solaris Auditing</a></p>
<p class="toc level3"><a href="auditplan-11.html">Planning Solaris Auditing (Task Map)</a></p>
<p class="toc level3"><a href="auditplan-12.html">Planning Solaris Auditing (Tasks)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Determining Audit Policy</a></p>
</div>
<p class="toc level3"><a href="auditplan-3.html">Controlling Auditing Costs</a></p>
<p class="toc level3"><a href="auditplan-9.html">Auditing Efficiently</a></p>
<p class="toc level2 tocsp"><a href="audittask-1.html">30.&nbsp;&nbsp;Managing Solaris Auditing (Tasks)</a></p>
<p class="toc level2"><a href="auditref-1.html">31.&nbsp;&nbsp;Solaris Auditing (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-2.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="auditplan-5"></a><h3>Determining Audit Policy</h3>
<a name="indexterm-3177"></a><a name="indexterm-3178"></a><a name="indexterm-3179"></a><a name="indexterm-3180"></a><p>Audit policy determines the characteristics of the audit records for the local system.
The policy options are set by a startup script. The <tt>bsmconv</tt> script,
which enables the auditing service, creates the <tt>/etc/security/audit_startup</tt> script. The <tt>audit_startup</tt> script
executes the <tt>auditconfig</tt> command to establish audit policy. For details about the script, see
the <a href="http://docs.sun.com/doc/819-2240/audit-startup-1m?a=view"><tt>audit_startup</tt>(1M)</a> man page.</p><p><a name="indexterm-3181"></a>Most audit policy options are disabled by default to minimize storage requirements and
system processing demands. You can dynamically enable and disable audit policy options with
the <tt>auditconfig</tt> command. You can permanently enable and disable the policy options with
the <tt>audit_startup</tt> script.</p><p>Use the following table to determine if the needs of your site
justify the additional overhead that results from enabling one or more audit policy options.</p><a name="auditplan-tbl-3"></a><h6>Table&nbsp;29-1 Effects of Audit Policy Options</h6><table><col width="11%"><col width="45%"><col width="42%"><tr><th align="left" valign="top" scope="column"><p>Policy
Name</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>Why Change the Policy Option?</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><a name="indexterm-3182"></a><tt>ahlt</tt></p></td>
<td align="left" valign="top" scope="row"><p>This policy applies to asynchronous events only. When
disabled, this policy allows the event to complete without an audit record being
generated.</p><p>When enabled, this policy stops the system when the audit file systems are
full. Administrative intervention is required to clean up the audit queue, make space
available for audit records, and reboot. This policy can only be enabled in
the global zone. The policy affects all zones.</p></td>
<td align="left" valign="top" scope="row"><p>The disabled option makes sense
when system availability is more important than security.</p><p>The enabled option makes sense in
an environment where security is paramount.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><a name="indexterm-3183"></a><a name="indexterm-3184"></a><tt>arge</tt></p></td>
<td align="left" valign="top" scope="row"><p>When disabled, this policy omits environment variables
of an executed program from the <tt>exec</tt> audit record.</p><p><a name="indexterm-3185"></a>When enabled, this policy adds
the environment variables of an executed program to the <tt>exec</tt> audit record. The
resulting audit records contain much more detail than when this policy is disabled.</p></td>
<td align="left" valign="top" scope="row"><p>The
disabled option collects much less information than the enabled option.</p><p>The enabled option makes
sense when you are auditing a few users. The option is also useful
when you have suspicions about the environment variables that are being used in
<tt>exec</tt> programs.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><a name="indexterm-3186"></a><tt>argv</tt></p></td>
<td align="left" valign="top" scope="row"><p>When disabled, this policy omits the arguments of an executed program from
the <tt>exec</tt> audit record.</p><p>When enabled, this policy adds the arguments of an
executed program to the <tt>exec</tt> audit record. The resulting audit records contain much more
detail than when this policy is disabled.</p></td>
<td align="left" valign="top" scope="row"><p>The disabled option collects much less
information than the enabled option.</p><p>The enabled option makes sense when you are auditing
a few users. The option is also useful when you have reason to
believe that unusual <tt>exec</tt> programs are being run.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><a name="indexterm-3187"></a><tt>cnt</tt></p></td>
<td align="left" valign="top" scope="row"><p>When disabled, this policy blocks a
user or application from running. The blocking happens when audit records cannot be
added to the audit trail because no disk space is available.</p><p>When enabled, this
policy allows the event to complete without an audit record being generated. The
policy maintains a count of audit records that are dropped.</p></td>
<td align="left" valign="top" scope="row"><p>The disabled option makes
sense in an environment where security is paramount.</p><p>The enabled option makes sense when
system availability is more important than security.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><a name="indexterm-3188"></a><tt>group</tt></p></td>
<td align="left" valign="top" scope="row"><p>When disabled, this policy does not add
a groups list to audit records.</p><p><a name="indexterm-3189"></a>When enabled, this policy adds a groups list
to every audit record as a special token.</p></td>
<td align="left" valign="top" scope="row"><p>The disabled option usually satisfies requirements
for site security.</p><p>The enabled option makes sense when you need to audit
which groups are generating audit events.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><a name="indexterm-3190"></a><tt>path</tt></p></td>
<td align="left" valign="top" scope="row"><p>When disabled, this policy records in an audit
record at most one path that is used during a system call.</p><p>When enabled,
this policy records every path that is used in conjunction with an audit
event to every audit record.</p></td>
<td align="left" valign="top" scope="row"><p>The disabled option places at most one path
in an audit record.</p><p>The enabled option enters each file name or path
that is used during a system call in the audit record as a
<tt>path</tt> token.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><a name="indexterm-3191"></a><tt>perzone</tt></p></td>
<td align="left" valign="top" scope="row"><p>When disabled, this policy maintains a single audit configuration for a system.
One audit daemon runs in the global zone. Audit events in non-global zones
can be located in the audit record by preselecting the <tt>zonename</tt> audit token.</p><p>When
enabled, this policy maintains separate audit configuration, audit queue, and audit logs for
each zone. A separate version of the audit daemon runs in each zone.
This policy can be enabled in the global zone only.</p></td>
<td align="left" valign="top" scope="row"><p>The disabled option
is useful when you have no special reason to maintain a separate audit
log, queue, and daemon for each zone.</p><p>The enabled option is useful when
you cannot monitor your system effectively by simply preselecting the <tt>zonename</tt> audit token.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><a name="indexterm-3192"></a><tt>public</tt></p></td>
<td align="left" valign="top" scope="row"><p>When
disabled, this policy does not add read-only events of public objects to the
audit trail when the reading of files is preselected. Audit classes that contain
read-only events include <tt>fr</tt>, <tt>fa</tt>, and <tt>cl</tt>.</p><p><a name="indexterm-3193"></a><a name="indexterm-3194"></a>When enabled, this policy records every read-only audit
event of public objects if an appropriate audit class is preselected.</p></td>
<td align="left" valign="top" scope="row"><p>The disabled option
usually satisfies requirements for site security.</p><p>The enabled option is rarely useful.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><a name="indexterm-3195"></a><tt>seq</tt></p></td>
<td align="left" valign="top" scope="row"><p>When disabled,
this policy does not add a sequence number to every audit record.</p><p><a name="indexterm-3196"></a>When enabled, this
policy adds a sequence number to every audit record. The <tt>sequence</tt> token
holds the sequence number.</p></td>
<td align="left" valign="top" scope="row"><p>The disabled option is sufficient when auditing is running
smoothly.</p><p>The enabled option makes sense when the <tt>cnt</tt> policy is enabled. The <tt>seq</tt>
policy enables you to to determine when data was discarded.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><a name="indexterm-3197"></a><tt>trail</tt></p></td>
<td align="left" valign="top" scope="row"><p>When disabled, this policy
does not add a <tt>trailer</tt> token to audit records.</p><p><a name="indexterm-3198"></a>When enabled, this policy adds a
<tt>trailer</tt> token to every audit record.</p></td>
<td align="left" valign="top" scope="row"><p>The disabled option creates a smaller audit record.</p><p>The
enabled option clearly marks the end of each audit record with a
<tt>trailer</tt> token. The <tt>trailer</tt> token is often used in conjunction with the <tt>sequence</tt>
token. The <tt>trailer</tt> token provides easier and more accurate resynchronization of audit records.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><a name="indexterm-3199"></a><tt>zonename</tt></p></td>
<td align="left" valign="top" scope="row"><p>When
disabled, this policy does not include a <tt>zonename</tt> token in audit records.</p><p>When enabled,
this policy includes a <tt>zonename</tt> token in every audit record from a non-global
zone.</p></td>
<td align="left" valign="top" scope="row"><p>The disabled option is useful when you do not need to compare
audit behavior across zones.</p><p>The enabled option is useful when you want to isolate
and compare audit behavior across zones.</p></td>
</tr>
</table>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="auditplan-12.html">Previous</a>
             </td>
             <td align="right">
                 <a href="auditplan-3.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

