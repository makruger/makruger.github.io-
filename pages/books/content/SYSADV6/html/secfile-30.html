<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Protecting Files With ACLs (Task Map) - System Administration Guide: Security Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-08-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Security Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="secfile-15.html">Previous</a>
             </td>
             <td align="right">
                 <a href="secfile-40.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="oview-1.html">Part&nbsp;I&nbsp;Security Overview</a></p>
<p class="toc level2"><a href="secov-1.html">1.&nbsp;&nbsp;Security Services (Overview)</a></p>
<p class="toc level1 tocsp"><a href="sectm-1.html">Part&nbsp;II&nbsp;System, File, and Device Security</a></p>
<p class="toc level2"><a href="concept-1.html">2.&nbsp;&nbsp;Managing Machine Security (Overview)</a></p>
<p class="toc level2"><a href="secsys-1.html">3.&nbsp;&nbsp;Controlling Access to Systems (Tasks)</a></p>
<p class="toc level2"><a href="vscan-1.html">4.&nbsp;&nbsp;Virus Scanning Service (Tasks)</a></p>
<p class="toc level2"><a href="devtask-1.html">5.&nbsp;&nbsp;Controlling Access to Devices (Tasks)</a></p>
<p class="toc level2"><a href="bart-1.html">6.&nbsp;&nbsp;Using the Basic Audit Reporting Tool (Tasks)</a></p>
<p class="toc level2"><a href="secfile-1.html">7.&nbsp;&nbsp;Controlling Access to Files (Tasks)</a></p>
<p class="toc level3"><a href="secfile-60.html">Using UNIX Permissions to Protect Files</a></p>
<p class="toc level3"><a href="secfile-37.html">Using Access Control Lists to Protect Files</a></p>
<p class="toc level3"><a href="secfile-68.html">Preventing Executable Files From Compromising Security</a></p>
<p class="toc level3"><a href="secfile-10.html">Protecting Files (Task Map)</a></p>
<p class="toc level3"><a href="secfile-15.html">Protecting Files With UNIX Permissions (Task Map)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Protecting Files With ACLs (Task Map)</a></p>
</div>
<p class="toc level3"><a href="secfile-40.html">Protecting Against Programs With Security Risk (Task Map)</a></p>
<p class="toc level1 tocsp"><a href="prbactm-1.html">Part&nbsp;III&nbsp;Roles, Rights Profiles, and Privileges</a></p>
<p class="toc level2"><a href="prbac-1.html">8.&nbsp;&nbsp;Using Roles and Privileges (Overview)</a></p>
<p class="toc level2"><a href="rbactask-1.html">9.&nbsp;&nbsp;Using Role-Based Access Control (Tasks)</a></p>
<p class="toc level2"><a href="rbacref-1.html">10.&nbsp;&nbsp;Role-Based Access Control (Reference)</a></p>
<p class="toc level2"><a href="privtask-1.html">11.&nbsp;&nbsp;Privileges (Tasks)</a></p>
<p class="toc level2"><a href="privref-1.html">12.&nbsp;&nbsp;Privileges (Reference)</a></p>
<p class="toc level1 tocsp"><a href="scftm-1.html">Part&nbsp;IV&nbsp;Solaris Cryptographic Services</a></p>
<p class="toc level2"><a href="scf-1.html">13.&nbsp;&nbsp;Solaris Cryptographic Framework (Overview)</a></p>
<p class="toc level2"><a href="scftask-1.html">14.&nbsp;&nbsp;Solaris Cryptographic Framework (Tasks)</a></p>
<p class="toc level2"><a href="kmf-1.html">15.&nbsp;&nbsp;Solaris Key Management Framework</a></p>
<p class="toc level1 tocsp"><a href="authtm-1.html">Part&nbsp;V&nbsp;Authentication Services and Secure Communication</a></p>
<p class="toc level2"><a href="auth-1.html">16.&nbsp;&nbsp;Using Authentication Services (Tasks)</a></p>
<p class="toc level2"><a href="pam-1.html">17.&nbsp;&nbsp;Using PAM</a></p>
<p class="toc level2"><a href="sasl-1.html">18.&nbsp;&nbsp;Using SASL</a></p>
<p class="toc level2"><a href="sshuser-1.html">19.&nbsp;&nbsp;Using Solaris Secure Shell (Tasks)</a></p>
<p class="toc level2"><a href="sshref-1.html">20.&nbsp;&nbsp;Solaris Secure Shell (Reference)</a></p>
<p class="toc level1 tocsp"><a href="seamtm-1.html">Part&nbsp;VI&nbsp;Kerberos Service</a></p>
<p class="toc level2"><a href="intro-1.html">21.&nbsp;&nbsp;Introduction to the Kerberos Service</a></p>
<p class="toc level2"><a href="seamplan-1.html">22.&nbsp;&nbsp;Planning for the Kerberos Service</a></p>
<p class="toc level2"><a href="setup-8.html">23.&nbsp;&nbsp;Configuring the Kerberos Service (Tasks)</a></p>
<p class="toc level2"><a href="trouble-1.html">24.&nbsp;&nbsp;Kerberos Error Messages and Troubleshooting</a></p>
<p class="toc level2"><a href="aadmin-1.html">25.&nbsp;&nbsp;Administering Kerberos Principals and Policies (Tasks)</a></p>
<p class="toc level2"><a href="user-7.html">26.&nbsp;&nbsp;Using Kerberos Applications (Tasks)</a></p>
<p class="toc level2"><a href="refer-1.html">27.&nbsp;&nbsp;The Kerberos Service (Reference)</a></p>
<p class="toc level1 tocsp"><a href="audittm-1.html">Part&nbsp;VII&nbsp;Solaris Auditing</a></p>
<p class="toc level2"><a href="auditov-1.html">28.&nbsp;&nbsp;Solaris Auditing (Overview)</a></p>
<p class="toc level2"><a href="auditplan-1.html">29.&nbsp;&nbsp;Planning for Solaris Auditing</a></p>
<p class="toc level2"><a href="audittask-1.html">30.&nbsp;&nbsp;Managing Solaris Auditing (Tasks)</a></p>
<p class="toc level2"><a href="auditref-1.html">31.&nbsp;&nbsp;Solaris Auditing (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-2.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="secfile-30"></a><h3>Protecting Files With ACLs (Task Map)</h3>
<a name="indexterm-931"></a><a name="indexterm-932"></a><a name="indexterm-933"></a><a name="indexterm-934"></a><a name="indexterm-935"></a><a name="indexterm-936"></a><p><a name="indexterm-937"></a><a name="indexterm-938"></a>The following task map points to procedures that list the ACLs on a
file, change the ACLs, and copy the ACLs to another file.</p><table><col width="48%"><col width="51%"><tr><th align="left" valign="top" scope="column"><p>Task</p></th>
<th align="left" valign="top" scope="column"><p>For Instructions</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Determine
if a file has an ACL</p></td>
<td align="left" valign="top" scope="row"><p><a href="#secfile-17">How to Check if a File Has an ACL</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Add an ACL to a file</p></td>
<td align="left" valign="top" scope="row"><p><a href="#secfile-51">How to Add ACL Entries to a File</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Copy an
ACL</p></td>
<td align="left" valign="top" scope="row"><p><a href="#secfile-75">How to Copy an ACL</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Modify an ACL</p></td>
<td align="left" valign="top" scope="row"><p><a href="#secfile-48">How to Change ACL Entries on a File</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Remove ACLs from a file</p></td>
<td align="left" valign="top" scope="row"><p><a href="#secfile-49">How to Delete ACL Entries From a File</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Display the ACLs on a file</p></td>
<td align="left" valign="top" scope="row"><p><a href="#secfile-12">How to Display ACL Entries for a File</a></p></td>
</tr>
</table>

<a name="secfile-17"></a><h4>How to Check if a File Has an ACL</h4><a name="indexterm-939"></a><a name="indexterm-940"></a><a name="indexterm-941"></a><a name="indexterm-942"></a><a name="indexterm-943"></a><ul>
<li><b><a name="indexterm-944"></a>Check if a file has an ACL.</b><pre>% ls -l <i>filename</i></pre><p>where <i>filename</i> specifies the file or directory.</p><p>In the output, a plus sign (<tt>+</tt>) to the right of the mode
field indicates that the file has an ACL.</p>
<hr><p><b>Note - </b><a name="indexterm-945"></a><a name="indexterm-946"></a>Unless you have added ACL entries that extend UNIX file permissions, a file
is considered to have a &ldquo;trivial&rdquo; ACL and the plus sign (<tt>+</tt>) does
not display.</p>
<hr>
</li></ul><a name="secfile-42"></a><h6>Example&nbsp;7-6 Checking if a File Has an ACL</h6><p>In the following example, the <tt>ch1.sgm</tt> file has an ACL. The ACL is
indicated by the plus sign (<tt>+</tt>) to the right of the mode field.</p><pre>% <tt><b>ls -l ch1.sgm</b></tt>
-rwxr-----+  1 stacey   techpubs      167 Nov 11 11:13 ch1.sgm</pre>

<a name="secfile-51"></a><h4>How to Add ACL Entries to a File</h4><a name="indexterm-947"></a><a name="indexterm-948"></a><a name="indexterm-949"></a><a name="indexterm-950"></a><a name="indexterm-951"></a><a name="indexterm-952"></a><a name="indexterm-953"></a><a name="indexterm-954"></a><a name="indexterm-955"></a><ol>
<li><b><a name="indexterm-956"></a>Set an ACL on a file by using the <tt>setfacl</tt> command.</b><pre>% setfacl -s user::<i>perms</i>,group::<i>perms</i>,other:<i>perms</i>,mask:<i>perms</i>,<i>acl-entry-list</i> <i>filename ...</i></pre><dl><dt><tt>-s</tt></dt>
<dd><p>Sets an ACL on the file. If a file already has an ACL, it is replaced. This option requires at least the <tt>user::</tt>, <tt>group::</tt>, and <tt>other::</tt> entries.</p></dd>
<dt><tt>user::</tt><i>perms</i></dt>
<dd><p>Specifies the file owner permissions.</p></dd>
<dt><tt>group::</tt><i>perms</i></dt>
<dd><p>Specifies the group ownership permissions.</p></dd>
<dt><tt>other:</tt><i>perms</i></dt>
<dd><p>Specifies the permissions for users other than the file owner or members of the group.</p></dd>
<dt><tt>mask:</tt><i>perms</i></dt>
<dd><p>Specifies the permissions for the ACL mask. The mask indicates the maximum permissions that are allowed for users (other than the owner) and for groups.</p></dd>
<dt><i>acl-entry-list</i></dt>
<dd><p>Specifies the list of one or more ACL entries to set for specific users and groups on the file or directory. You can also set default ACL entries on a directory. <a href="secfile-37.html#secfile-35">Table&nbsp;7-7</a> and <a href="secfile-37.html#secfile-52">Table&nbsp;7-8</a> show the valid ACL entries.</p></dd>
<dt><i>filename ...</i></dt>
<dd><p>Specifies one or more files or directories on which to set the ACL. Multiple <i>filename</i>s are separated by spaces.</p></dd>
</dl>

<hr><p><b>Caution - </b>If an ACL already exists on the file, the <tt>-s</tt> option replaces the
entire ACL with the new ACL.</p>
<hr>
<p>For more information, see the <a href="http://docs.sun.com/doc/819-2239/setfacl-1?a=view"><tt>setfacl</tt>(1)</a> man page.</p></li>
<li><b><a name="indexterm-957"></a>Verify that the ACL entries were set on the file.</b><pre>% getfacl <i>filename</i></pre><p>For more information, see <a href="#secfile-17">How to Check if a File Has an ACL</a>.</p></li></ol><a name="secfile-31"></a><h6>Example&nbsp;7-7 Setting an ACL on a File</h6><p>In the following example, the file owner permissions are set to read and
write, file group permissions are set to read only, and other permissions are
set to none on the <tt>ch1.sgm</tt> file. In addition, the user <tt>anusha</tt> is
given read and write permissions on the file. The ACL mask permissions are
set to read and write, which means that no user or group can
have execute permissions.</p><pre>% <tt><b>setfacl -s user::rw-,group::r--,other:---,mask:rw-,user:anusha:rw- ch1.sgm</b></tt>
% <tt><b>ls -l</b></tt>
total 124
-rw-r-----+  1 stacey  techpubs   34816 Nov 11 14:16 ch1.sgm
-rw-r--r--   1 stacey  techpubs   20167 Nov 11 14:16 ch2.sgm
-rw-r--r--   1 stacey  techpubs    8192 Nov 11 14:16 notes
% <tt><b>getfacl ch1.sgm</b></tt>
# file: ch1.sgm
# owner: stacey
# group: techpubs
user::rw-
user:anusha:rw-    #effective:rw-
group::r--         #effective:r--
mask:rw-
other:---</pre><p>In the following example, the file owner permissions are set to read, write,
and execute, file group permissions are set to read only, other permissions are
set to none. In addition, the ACL mask permissions are set to
read on the <tt>ch2.sgm</tt> file. Finally, the user <tt>anusha</tt> is given read and write
permissions. However, due to the ACL mask, the permissions for <tt>anusha</tt> are read
only.</p><pre>% <tt><b>setfacl -s u::7,g::4,o:0,m:4,u:anusha:7 ch2.sgm</b></tt>
% <tt><b>getfacl ch2.sgm</b></tt>
# file: ch2.sgm
# owner: stacey
# group: techpubs
user::rwx
user:anusha:rwx         #effective:r--
group::r--              #effective:r--
mask:r--
other:---</pre>

<a name="secfile-75"></a><h4>How to Copy an ACL</h4><a name="indexterm-958"></a><a name="indexterm-959"></a><a name="indexterm-960"></a><ul>
<li><b>Copy a file's ACL to another file by redirecting the <tt>getfacl</tt> output.</b><pre>% getfacl <i>filename1</i> | setfacl -f - <i>filename2</i> </pre><dl><dt><i>filename1</i></dt>
<dd><p>Specifies the file from which to copy the ACL.</p></dd>
<dt><i>filename2</i></dt>
<dd><p>Specifies the file on which to set the copied ACL.</p></dd>
</dl>
</li></ul><a name="secfile-32"></a><h6>Example&nbsp;7-8 Copying an ACL</h6><p><a name="indexterm-961"></a><a name="indexterm-962"></a>In the following example, the ACL on <tt>ch2.sgm</tt> is copied to <tt>ch3.sgm</tt>.</p><pre>% <tt><b>getfacl ch2.sgm | setfacl -f - ch3.sgm</b></tt></pre>

<a name="secfile-48"></a><h4>How to Change ACL Entries on a File</h4><a name="indexterm-963"></a><a name="indexterm-964"></a><a name="indexterm-965"></a><a name="indexterm-966"></a><ol>
<li><b><a name="indexterm-967"></a>Modify ACL entries on a file by using the <tt>setfacl</tt> command.</b><pre>% setfacl -m <i>acl-entry-list filename ...</i> </pre><dl><dt><tt>-m</tt></dt>
<dd><p>Modifies the existing ACL entry.</p></dd>
<dt><i>acl-entry-list</i></dt>
<dd><p>Specifies the list of one or more ACL entries to modify on the file or directory. You can also modify default ACL entries on a directory. <a href="secfile-37.html#secfile-35">Table&nbsp;7-7</a> and <a href="secfile-37.html#secfile-52">Table&nbsp;7-8</a> show the valid ACL entries.</p></dd>
<dt><i>filename ...</i></dt>
<dd><p>Specifies one or more files or directories, separated by a space.</p></dd>
</dl>
</li>
<li><b>Verify that the ACL entries were modified on the file.</b><pre>% getfacl <i>filename</i></pre></li></ol><a name="secfile-33"></a><h6>Example&nbsp;7-9 Modifying ACL Entries on a File</h6><a name="indexterm-968"></a><p>In the following example, the permissions for the user <tt>anusha</tt> are modified to
read and write.</p><pre>% <tt><b>setfacl -m user:anusha:6 ch3.sgm</b></tt>
% <tt><b>getfacl ch3.sgm</b></tt>
# file: ch3.sgm
# owner: stacey
# group: techpubs
user::rw-                
user::anusha:rw-        #effective:r--
group::r-               #effective:r--
mask:r--
other:r-</pre><p>In the following example, the default permissions for the group <tt>staff</tt> are
modified to read on the <tt>book</tt> directory. In addition, the default ACL mask
permissions are modified to read and write.</p><pre>% <tt><b>setfacl -m default:group:staff:4,default:mask:6 book</b></tt></pre>

<a name="secfile-49"></a><h4>How to Delete ACL Entries From a File</h4><a name="indexterm-969"></a><a name="indexterm-970"></a><a name="indexterm-971"></a><a name="indexterm-972"></a><a name="indexterm-973"></a><ol>
<li><b>Delete ACL entries from a file.</b><pre>% setfacl -d <i>acl-entry-list filename ...</i> </pre><dl><dt><tt>-d</tt></dt>
<dd><p>Deletes the specified ACL entries.</p></dd>
<dt><i>acl-entry-list</i></dt>
<dd><p>Specifies the list of ACL entries (without specifying the permissions) to delete from the file or directory. You can only delete ACL entries and default ACL entries for specific users and groups. <a href="secfile-37.html#secfile-35">Table&nbsp;7-7</a> and <a href="secfile-37.html#secfile-52">Table&nbsp;7-8</a> show the valid ACL entries.</p></dd>
<dt><i>filename ...</i></dt>
<dd><p>Specifies one or more files or directories, separated by a space.</p></dd>
</dl>
<p>Alternatively, you can use the <tt>setfacl -s</tt> command to delete all the ACL entries
on a file and replace them with the new ACL entries that are
specified.</p></li>
<li><b>Verify that the ACL entries were deleted from the file.</b><pre>% getfacl <i>filename</i></pre></li></ol><a name="secfile-34"></a><h6>Example&nbsp;7-10 Deleting ACL Entries on a File</h6><p><a name="indexterm-974"></a><a name="indexterm-975"></a>In the following example, the user <tt>anusha</tt> is deleted from the <tt>ch4.sgm</tt> file.</p><pre>% <tt><b>setfacl -d user:anusha ch4.sgm</b></tt></pre>

<a name="secfile-12"></a><h4>How to Display ACL Entries for a File</h4><a name="indexterm-976"></a><a name="indexterm-977"></a><a name="indexterm-978"></a><a name="indexterm-979"></a><a name="indexterm-980"></a><a name="indexterm-981"></a><a name="indexterm-982"></a><ul>
<li><b><a name="indexterm-983"></a><a name="indexterm-984"></a>Display ACL entries for a file by using the <tt>getfacl</tt> command.</b><pre>% getfacl [-a | -d] <i>filename ...</i></pre><dl><dt><tt>-a</tt></dt>
<dd><p>Displays the file name, file owner, file group, and ACL entries for the specified file or directory.</p></dd>
<dt><tt>-d</tt></dt>
<dd><p>Displays the file name, file owner, file group, and the default ACL entries, if they exist, for the specified directory.</p></dd>
<dt><i>filename ...</i></dt>
<dd><p>Specifies one or more files or directories, separated by a space.</p></dd>
</dl>
<p>If you specify multiple file names on the command line, the ACL
entries are displayed with a blank line between each entry.</p></li></ul><a name="secfile-41"></a><h6>Example&nbsp;7-11 Displaying ACL Entries for a File</h6><p>In the following example, all the ACL entries for the <tt>ch1.sgm</tt> file are
displayed. The <tt>#effective:</tt> note beside the user and group entries indicates what the
permissions are after being modified by the ACL mask.</p><pre>% <tt><b>getfacl ch1.sgm</b></tt>

# file: ch1.sgm
# owner: stacey
# group: techpubs
user::rw-
user:anusha:r-        #effective:r--
group::rw-            #effective:rw-
mask:rw-
other:---</pre><p><a name="indexterm-985"></a><a name="indexterm-986"></a>In the following example, the default ACL entries for the <tt>book</tt> directory
are displayed.</p><pre>% <tt><b>getfacl -d book</b></tt>

# file: book
# owner: stacey
# group: techpubs
user::rwx
user:anusha:r-x       #effective:r-x
group::rwx            #effective:rwx
mask:rwx
other:---
default:user::rw-
default:user:anusha:r--
default:group::rw-
default:mask:rw-
default:other:---</pre>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="secfile-15.html">Previous</a>
             </td>
             <td align="right">
                 <a href="secfile-40.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

