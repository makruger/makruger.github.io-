<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Using the Vscan Service - System Administration Guide: Security Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-08-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Security Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="vscan-4.html">Previous</a>
             </td>
             <td align="right">
                 <a href="devtask-1.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="oview-1.html">Part&nbsp;I&nbsp;Security Overview</a></p>
<p class="toc level2"><a href="secov-1.html">1.&nbsp;&nbsp;Security Services (Overview)</a></p>
<p class="toc level1 tocsp"><a href="sectm-1.html">Part&nbsp;II&nbsp;System, File, and Device Security</a></p>
<p class="toc level2"><a href="concept-1.html">2.&nbsp;&nbsp;Managing Machine Security (Overview)</a></p>
<p class="toc level2"><a href="secsys-1.html">3.&nbsp;&nbsp;Controlling Access to Systems (Tasks)</a></p>
<p class="toc level2"><a href="vscan-1.html">4.&nbsp;&nbsp;Virus Scanning Service (Tasks)</a></p>
<p class="toc level3"><a href="vscan-3.html">About Virus Scanning</a></p>
<p class="toc level3"><a href="vscan-4.html">About the Vscan Service</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Using the Vscan Service</a></p>
</div>
<p class="toc level2 tocsp"><a href="devtask-1.html">5.&nbsp;&nbsp;Controlling Access to Devices (Tasks)</a></p>
<p class="toc level2"><a href="bart-1.html">6.&nbsp;&nbsp;Using the Basic Audit Reporting Tool (Tasks)</a></p>
<p class="toc level2"><a href="secfile-1.html">7.&nbsp;&nbsp;Controlling Access to Files (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="prbactm-1.html">Part&nbsp;III&nbsp;Roles, Rights Profiles, and Privileges</a></p>
<p class="toc level2"><a href="prbac-1.html">8.&nbsp;&nbsp;Using Roles and Privileges (Overview)</a></p>
<p class="toc level2"><a href="rbactask-1.html">9.&nbsp;&nbsp;Using Role-Based Access Control (Tasks)</a></p>
<p class="toc level2"><a href="rbacref-1.html">10.&nbsp;&nbsp;Role-Based Access Control (Reference)</a></p>
<p class="toc level2"><a href="privtask-1.html">11.&nbsp;&nbsp;Privileges (Tasks)</a></p>
<p class="toc level2"><a href="privref-1.html">12.&nbsp;&nbsp;Privileges (Reference)</a></p>
<p class="toc level1 tocsp"><a href="scftm-1.html">Part&nbsp;IV&nbsp;Solaris Cryptographic Services</a></p>
<p class="toc level2"><a href="scf-1.html">13.&nbsp;&nbsp;Solaris Cryptographic Framework (Overview)</a></p>
<p class="toc level2"><a href="scftask-1.html">14.&nbsp;&nbsp;Solaris Cryptographic Framework (Tasks)</a></p>
<p class="toc level2"><a href="kmf-1.html">15.&nbsp;&nbsp;Solaris Key Management Framework</a></p>
<p class="toc level1 tocsp"><a href="authtm-1.html">Part&nbsp;V&nbsp;Authentication Services and Secure Communication</a></p>
<p class="toc level2"><a href="auth-1.html">16.&nbsp;&nbsp;Using Authentication Services (Tasks)</a></p>
<p class="toc level2"><a href="pam-1.html">17.&nbsp;&nbsp;Using PAM</a></p>
<p class="toc level2"><a href="sasl-1.html">18.&nbsp;&nbsp;Using SASL</a></p>
<p class="toc level2"><a href="sshuser-1.html">19.&nbsp;&nbsp;Using Solaris Secure Shell (Tasks)</a></p>
<p class="toc level2"><a href="sshref-1.html">20.&nbsp;&nbsp;Solaris Secure Shell (Reference)</a></p>
<p class="toc level1 tocsp"><a href="seamtm-1.html">Part&nbsp;VI&nbsp;Kerberos Service</a></p>
<p class="toc level2"><a href="intro-1.html">21.&nbsp;&nbsp;Introduction to the Kerberos Service</a></p>
<p class="toc level2"><a href="seamplan-1.html">22.&nbsp;&nbsp;Planning for the Kerberos Service</a></p>
<p class="toc level2"><a href="setup-8.html">23.&nbsp;&nbsp;Configuring the Kerberos Service (Tasks)</a></p>
<p class="toc level2"><a href="trouble-1.html">24.&nbsp;&nbsp;Kerberos Error Messages and Troubleshooting</a></p>
<p class="toc level2"><a href="aadmin-1.html">25.&nbsp;&nbsp;Administering Kerberos Principals and Policies (Tasks)</a></p>
<p class="toc level2"><a href="user-7.html">26.&nbsp;&nbsp;Using Kerberos Applications (Tasks)</a></p>
<p class="toc level2"><a href="refer-1.html">27.&nbsp;&nbsp;The Kerberos Service (Reference)</a></p>
<p class="toc level1 tocsp"><a href="audittm-1.html">Part&nbsp;VII&nbsp;Solaris Auditing</a></p>
<p class="toc level2"><a href="auditov-1.html">28.&nbsp;&nbsp;Solaris Auditing (Overview)</a></p>
<p class="toc level2"><a href="auditplan-1.html">29.&nbsp;&nbsp;Planning for Solaris Auditing</a></p>
<p class="toc level2"><a href="audittask-1.html">30.&nbsp;&nbsp;Managing Solaris Auditing (Tasks)</a></p>
<p class="toc level2"><a href="auditref-1.html">31.&nbsp;&nbsp;Solaris Auditing (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-2.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="vscan-5"></a><h3>Using the Vscan Service</h3>
<a name="indexterm-395"></a><p>Scanning files for viruses is available when the following requirements are met:</p>
<ul><li><p>At least one scan engine is installed and configured.</p></li>
<li><p>The files reside on a file system that supports virus scanning.</p></li>
<li><p>Virus scanning is enabled on the file system.</p></li>
<li><p>The vscan service is enabled.</p></li>
<li><p>The vscan service is configured to scan files of the specified file type.</p></li></ul>
<p>The following table points to the tasks you perform to set up
the vscan service.</p><table><col width="29%"><col width="38%"><col width="31%"><tr><th align="left" valign="top" scope="column"><p>Task</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>For Instructions</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Install a <a href="glossary-2.html#glossaryscanengine">scan engine</a>.</p></td>
<td align="left" valign="top" scope="row"><p>Install and configure one or more of the
supported third-party products listed in <a href="vscan-3.html#avscanenginesoftwaretbl">Table&nbsp;4-1</a>.</p></td>
<td align="left" valign="top" scope="row"><p>See the product documentation.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Enable the file system to
allow virus scans.</p></td>
<td align="left" valign="top" scope="row"><p>Use the file system command to enable virus scans if
necessary. For example, scans are disabled by default in the ZFS file system.
</p></td>
<td align="left" valign="top" scope="row"><p><a href="#vscan-6">How to Enable Virus Scanning on a File System</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Enable the vscan service.</p></td>
<td align="left" valign="top" scope="row"><p>Use the <tt>svcadm</tt>(1M) command to start the scan service.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#vscan-7">How to Enable the Vscan Service</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Add
a scan engine to the vscan service</p></td>
<td align="left" valign="top" scope="row"><p>Use the <tt>vscanadm</tt>(1M) command with its
<tt>add-engine</tt> subcommand to include the scan engine in the vscan service.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#vscan-8">How to Add a Scan Engine</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Configure the vscan
service.</p></td>
<td align="left" valign="top" scope="row"><p>Use the <tt>vscanadm</tt>(1M) command to view and change vscan properties.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#vscan-9">How to View Vscan Properties</a></p><p><a href="#vscan-10">How to Change Vscan Properties</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Configure the vscan
service for specific file types.</p></td>
<td align="left" valign="top" scope="row"><p>Use the <tt>vscanadm</tt>(1M) command to set the file
type.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#excludefilesfromscanstask">How to Exclude Files From Virus Scans</a></p></td>
</tr>
</table>

<a name="vscan-6"></a><h4>How to Enable Virus Scanning on a File System</h4><a name="indexterm-396"></a><p>Use the file system command to allow virus scans of files. For
example, to include a ZFS file system in a virus scan, use the
<tt>zfs</tt>(1M) command.</p><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. The ZFS file system allows some administrative tasks
to be delegated to specific users. For more information about Delegated Administration, see
the <i>ZFS Administration Guide</i>. For more information about roles, see <a href="rbactask-15.html">Configuring RBAC (Task Map)</a>. To configure a
role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b>Enable virus scanning on a ZFS file system, for example, <tt>pool/volumes/vol1</tt>.</b><pre># <tt><b>zfs set vscan=on </tt><i>path</i><tt>/pool/volumes/vol1</b></tt></pre></li></ol>

<a name="vscan-7"></a><h4>How to Enable the Vscan Service</h4><a name="indexterm-397"></a><ol>
<li><b>Use the &ldquo;VSCAN Management&rdquo; RBAC profile to obtain the authorizations needed for managing
the vscan service.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="rbactask-15.html">Configuring RBAC (Task Map)</a>.
</p></li>
<li><b>Use the <tt>svcadm</tt>(1M) command to enable virus scanning.</b><pre># <tt><b>svcadm enable vscan</b></tt></pre></li></ol>

<a name="vscan-8"></a><h4>How to Add a Scan Engine</h4><a name="indexterm-398"></a><ol>
<li><b>Use the &ldquo;VSCAN Management&rdquo; RBAC profile to obtain the authorizations needed for managing
the vscan service.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="rbactask-15.html">Configuring RBAC (Task Map)</a>.
</p></li>
<li><b>To add a scan engine to the vscan service with default properties, type:</b><pre>#<tt><b>vscanadm add-engine </tt><i>engine_ID</i><tt></b></tt></pre><p>See the manpage for the <tt>vscanadm</tt>(1M) command for a description of the command.</p></li></ol>

<a name="vscan-9"></a><h4>How to View Vscan Properties</h4><ul>
<li><b>View the properties of the vscan service, of all scan engines, or of
a specific scan engine.</b><ul>
<li><b>To view the properties of a particular scan engine, type:</b><pre># <tt><b>vscanadm get-engine </tt><i>engineID</i><tt></b></tt></pre></li>
<li><b>To view the properties of all scan engines, type:</b><pre># <tt><b>vscanadm get-engine</b></tt></pre></li>
<li><b>To view one of the properties of the vscan service, type:</b><pre># <tt><b>vscanadm get -p </tt><i>property</i><tt></b></tt></pre><p>where <i>property</i> is one of the parameters described in the manpage for the
<tt>vscanadm</tt>(1M) command.</p><p>For example, if you want to see the maximum size of a
file that can be scanned, type:</p><pre># <tt><b>vscanadm get max-size</b></tt></pre></li></ul></li></ul>

<a name="vscan-10"></a><h4>How to Change Vscan Properties</h4><p>You can change the properties of a particular scan engine and the
general properties of the vscan service. Many scan engines limit the size of
the files they scan, so the vscan service's <i>max-size</i> property must be set to
a value less than or equal to the scan engine's maximum allowed size.
You then define whether files that are larger than the maximum size, and
therefore not scanned, are accessible.</p><ol>
<li><b>Use the &ldquo;VSCAN Management&rdquo; RBAC profile to obtain the authorizations needed for managing
the vscan service.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="rbactask-15.html">Configuring RBAC (Task Map)</a>.
</p></li>
<li><b>View the current properties by using the <tt>vscanadm show</tt> command.</b></li>
<li><b>Set the maximum size for virus scans to, for example, 128 megabytes.</b><pre># <tt><b>vscanadm set -p max-size=128M</b></tt></pre></li>
<li><b>Specify that access is denied to any file that is not scanned due
to its size.</b><pre># <tt><b>vscanadm set -p max-size-action=deny</b></tt></pre><p>See the manpage for the <tt>vscanadm</tt>(1M) command for a description of the command.</p></li></ol>

<a name="excludefilesfromscanstask"></a><h4>How to Exclude Files From Virus Scans</h4><a name="indexterm-399"></a><p>When you enable antivirus protection, you can specify that all files of specific
types are excluded from the virus scan. Because the vscan service affects the
performance of the system, you can conserve system resources by targeting specific file
types for virus scans.</p><ol>
<li><b>Use the &ldquo;VSCAN Management&rdquo; RBAC profile to obtain the authorizations needed for managing
the vscan service.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="rbactask-15.html">Configuring RBAC (Task Map)</a>.
</p></li>
<li><b>View the list of all file types included in the virus scan.</b><pre># <tt><b>vscanadm get -p types</b></tt></pre></li>
<li><b>Specify the types of files to be scanned for virus:</b><ul>
<li><b>Exclude a specific file type, for example the JPEG type, from the virus
scan.</b><pre># <tt><b>vscanadm set -p types=-jpg,+*</b></tt></pre></li>
<li><b>Include a specific file type, for example executable files, in the virus scan.</b><pre># <tt><b>vscanadm set -p types=+exe,-*</b></tt></pre></li></ul><p>See the manpage for the <tt>vscanadm</tt>(1M) command for a description of the command.</p></li></ol>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="vscan-4.html">Previous</a>
             </td>
             <td align="right">
                 <a href="devtask-1.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

