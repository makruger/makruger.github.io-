<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Audit Token Formats - System Administration Guide: Security Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-08-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Security Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="auditref-20.html">Previous</a>
             </td>
             <td align="right">
                 <a href="glossary-2.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="oview-1.html">Part&nbsp;I&nbsp;Security Overview</a></p>
<p class="toc level2"><a href="secov-1.html">1.&nbsp;&nbsp;Security Services (Overview)</a></p>
<p class="toc level1 tocsp"><a href="sectm-1.html">Part&nbsp;II&nbsp;System, File, and Device Security</a></p>
<p class="toc level2"><a href="concept-1.html">2.&nbsp;&nbsp;Managing Machine Security (Overview)</a></p>
<p class="toc level2"><a href="secsys-1.html">3.&nbsp;&nbsp;Controlling Access to Systems (Tasks)</a></p>
<p class="toc level2"><a href="vscan-1.html">4.&nbsp;&nbsp;Virus Scanning Service (Tasks)</a></p>
<p class="toc level2"><a href="devtask-1.html">5.&nbsp;&nbsp;Controlling Access to Devices (Tasks)</a></p>
<p class="toc level2"><a href="bart-1.html">6.&nbsp;&nbsp;Using the Basic Audit Reporting Tool (Tasks)</a></p>
<p class="toc level2"><a href="secfile-1.html">7.&nbsp;&nbsp;Controlling Access to Files (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="prbactm-1.html">Part&nbsp;III&nbsp;Roles, Rights Profiles, and Privileges</a></p>
<p class="toc level2"><a href="prbac-1.html">8.&nbsp;&nbsp;Using Roles and Privileges (Overview)</a></p>
<p class="toc level2"><a href="rbactask-1.html">9.&nbsp;&nbsp;Using Role-Based Access Control (Tasks)</a></p>
<p class="toc level2"><a href="rbacref-1.html">10.&nbsp;&nbsp;Role-Based Access Control (Reference)</a></p>
<p class="toc level2"><a href="privtask-1.html">11.&nbsp;&nbsp;Privileges (Tasks)</a></p>
<p class="toc level2"><a href="privref-1.html">12.&nbsp;&nbsp;Privileges (Reference)</a></p>
<p class="toc level1 tocsp"><a href="scftm-1.html">Part&nbsp;IV&nbsp;Solaris Cryptographic Services</a></p>
<p class="toc level2"><a href="scf-1.html">13.&nbsp;&nbsp;Solaris Cryptographic Framework (Overview)</a></p>
<p class="toc level2"><a href="scftask-1.html">14.&nbsp;&nbsp;Solaris Cryptographic Framework (Tasks)</a></p>
<p class="toc level2"><a href="kmf-1.html">15.&nbsp;&nbsp;Solaris Key Management Framework</a></p>
<p class="toc level1 tocsp"><a href="authtm-1.html">Part&nbsp;V&nbsp;Authentication Services and Secure Communication</a></p>
<p class="toc level2"><a href="auth-1.html">16.&nbsp;&nbsp;Using Authentication Services (Tasks)</a></p>
<p class="toc level2"><a href="pam-1.html">17.&nbsp;&nbsp;Using PAM</a></p>
<p class="toc level2"><a href="sasl-1.html">18.&nbsp;&nbsp;Using SASL</a></p>
<p class="toc level2"><a href="sshuser-1.html">19.&nbsp;&nbsp;Using Solaris Secure Shell (Tasks)</a></p>
<p class="toc level2"><a href="sshref-1.html">20.&nbsp;&nbsp;Solaris Secure Shell (Reference)</a></p>
<p class="toc level1 tocsp"><a href="seamtm-1.html">Part&nbsp;VI&nbsp;Kerberos Service</a></p>
<p class="toc level2"><a href="intro-1.html">21.&nbsp;&nbsp;Introduction to the Kerberos Service</a></p>
<p class="toc level2"><a href="seamplan-1.html">22.&nbsp;&nbsp;Planning for the Kerberos Service</a></p>
<p class="toc level2"><a href="setup-8.html">23.&nbsp;&nbsp;Configuring the Kerberos Service (Tasks)</a></p>
<p class="toc level2"><a href="trouble-1.html">24.&nbsp;&nbsp;Kerberos Error Messages and Troubleshooting</a></p>
<p class="toc level2"><a href="aadmin-1.html">25.&nbsp;&nbsp;Administering Kerberos Principals and Policies (Tasks)</a></p>
<p class="toc level2"><a href="user-7.html">26.&nbsp;&nbsp;Using Kerberos Applications (Tasks)</a></p>
<p class="toc level2"><a href="refer-1.html">27.&nbsp;&nbsp;The Kerberos Service (Reference)</a></p>
<p class="toc level1 tocsp"><a href="audittm-1.html">Part&nbsp;VII&nbsp;Solaris Auditing</a></p>
<p class="toc level2"><a href="auditov-1.html">28.&nbsp;&nbsp;Solaris Auditing (Overview)</a></p>
<p class="toc level2"><a href="auditplan-1.html">29.&nbsp;&nbsp;Planning for Solaris Auditing</a></p>
<p class="toc level2"><a href="audittask-1.html">30.&nbsp;&nbsp;Managing Solaris Auditing (Tasks)</a></p>
<p class="toc level2"><a href="auditref-1.html">31.&nbsp;&nbsp;Solaris Auditing (Reference)</a></p>
<p class="toc level3"><a href="auditref-36.html">Audit Commands</a></p>
<p class="toc level3"><a href="auditref-13.html">Files Used in the Auditing Service</a></p>
<p class="toc level3"><a href="auditref-22.html">Rights Profiles for Administering Auditing</a></p>
<p class="toc level3"><a href="auditref-28.html">Auditing and Solaris Zones</a></p>
<p class="toc level3"><a href="auditref-48.html">Audit Classes</a></p>
<p class="toc level3"><a href="auditref-74.html">Audit Policy</a></p>
<p class="toc level3"><a href="auditref-55.html">Process Audit Characteristics</a></p>
<p class="toc level3"><a href="auditref-75.html">Audit Trail</a></p>
<p class="toc level3"><a href="auditref-77.html">Conventions for Binary Audit File Names</a></p>
<p class="toc level3"><a href="auditref-20.html">Audit Record Structure</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Audit Token Formats</a></p>
</div>
<p class="toc level1 tocsp"><a href="glossary-2.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="aparecord-11"></a><h3>Audit Token Formats</h3>
<p><a name="indexterm-3685"></a><a name="indexterm-3686"></a>Each audit token has a token type identifier, which is followed by data
that is specific to the token. Each token type has its own
format. The following table shows the token names with a brief description of
each token. Obsolete tokens are maintained for compatibility with previous Solaris releases.</p><a name="auditref-tbl-1"></a><h6>Table&nbsp;31-4 Audit Tokens for Solaris Auditing</h6><table><col width="16%"><col width="41%"><col width="41%"><tr><th align="left" valign="top" scope="column"><p>Token Name</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>For More
Information</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>acl</tt></p></td>
<td align="left" valign="top" scope="row"><p>Access Control List (ACL) information</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aparecord-3"><tt>acl</tt> Token</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>arbitrary</tt></p></td>
<td align="left" valign="top" scope="row"><p>Data with format and type information</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aparecord-5"><tt>arbitrary</tt> Token  (Obsolete)</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>arg</tt></p></td>
<td align="left" valign="top" scope="row"><p>System call argument value</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aparecord-6"><tt>arg</tt> Token</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>attribute</tt></p></td>
<td align="left" valign="top" scope="row"><p>File
vnode tokens</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aparecord-4"><tt>attribute</tt> Token</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>cmd</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3687"></a>Command arguments and environment variables</p></td>
<td align="left" valign="top" scope="row"><p><a href="#auditref-26"><tt>cmd</tt> Token</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>exec_args</tt></p></td>
<td align="left" valign="top" scope="row"><p>Exec system call arguments</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aparecord-10"><tt>exec_args</tt> Token</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>exec_env</tt></p></td>
<td align="left" valign="top" scope="row"><p>Exec system call environment
variables</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aparecord-12"><tt>exec_env</tt> Token</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>exit</tt></p></td>
<td align="left" valign="top" scope="row"><p>Program exit information</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aparecord-14"><tt>exit</tt> Token  (Obsolete)</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>file</tt></p></td>
<td align="left" valign="top" scope="row"><p>Audit file information</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aparecord-16"><tt>file</tt> Token</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>group</tt></p></td>
<td align="left" valign="top" scope="row"><p>Process groups information</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aparecord-18"><tt>group</tt> Token (Obsolete)</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>groups</tt></p></td>
<td align="left" valign="top" scope="row"><p>Process groups information</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aparecord-25"><tt>groups</tt> Token</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>header</tt></p></td>
<td align="left" valign="top" scope="row"><p>Indicates start of audit
record</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aparecord-20"><tt>header</tt> Token</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>in_addr</tt></p></td>
<td align="left" valign="top" scope="row"><p>Internet address</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aparecord-22"><tt>in_addr</tt> Token</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>ip</tt></p></td>
<td align="left" valign="top" scope="row"><p>IP header information</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aparecord-24"><tt>ip</tt> Token (Obsolete)</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>ipc</tt></p></td>
<td align="left" valign="top" scope="row"><p>System V IPC information</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aparecord-26"><tt>ipc</tt> Token</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>ipc_perm</tt></p></td>
<td align="left" valign="top" scope="row"><p>System V IPC object tokens</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aparecord-23"><tt>ipc_perm</tt> Token</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>iport</tt></p></td>
<td align="left" valign="top" scope="row"><p>Internet port
address</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aparecord-7"><tt>iport</tt> Token</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>opaque</tt></p></td>
<td align="left" valign="top" scope="row"><p>Unstructured data (unspecified format)</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aparecord-27"><tt>opaque</tt> Token  (Obsolete)</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>path</tt></p></td>
<td align="left" valign="top" scope="row"><p>Path information</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aparecord-29"><tt>path</tt> Token</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>path_attr</tt></p></td>
<td align="left" valign="top" scope="row"><p>Access path information</p></td>
<td align="left" valign="top" scope="row"><p><a href="#auditref-21"><tt>path_attr</tt> Token</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>privilege</tt></p></td>
<td align="left" valign="top" scope="row"><p>Privilege set information</p></td>
<td align="left" valign="top" scope="row"><p><a href="#auditref-23"><tt>privilege</tt> Token</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>process</tt></p></td>
<td align="left" valign="top" scope="row"><p>Process token information</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aparecord-28"><tt>process</tt> Token</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>return</tt></p></td>
<td align="left" valign="top" scope="row"><p>Status of system
call</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aparecord-30"><tt>return</tt> Token</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>sequence</tt></p></td>
<td align="left" valign="top" scope="row"><p>Sequence number token</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aparecord-31"><tt>sequence</tt> Token</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>socket</tt></p></td>
<td align="left" valign="top" scope="row"><p>Socket type and addresses</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aparecord-32"><tt>socket</tt> Token</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>subject</tt></p></td>
<td align="left" valign="top" scope="row"><p>Subject token information (same format as <tt>process</tt>
token)</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aparecord-33"><tt>subject</tt> Token</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>text</tt></p></td>
<td align="left" valign="top" scope="row"><p>ASCII string</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aparecord-34"><tt>text</tt> Token</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>trailer</tt></p></td>
<td align="left" valign="top" scope="row"><p>Indicates end of audit record</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aparecord-35"><tt>trailer</tt> Token</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>uauth</tt></p></td>
<td align="left" valign="top" scope="row"><p>Use of authorization</p></td>
<td align="left" valign="top" scope="row"><p><a href="#auditref-27"><tt>uauth</tt> Token</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>zonename</tt></p></td>
<td align="left" valign="top" scope="row"><p>Name of zone</p></td>
<td align="left" valign="top" scope="row"><p><a href="#auditref-15"><tt>zonename</tt> Token</a></p></td>
</tr>
</table><p>An audit record always begins with a <tt>header</tt> token. The <tt>header</tt> token indicates
where the audit record begins in the audit trail. In the case of
attributable events, the <tt>subject</tt> and the <tt>process</tt> tokens refer to the values of
the process that caused the event. In the case of nonattributable events, the
<tt>process</tt> token refers to the system.</p>

<a name="aparecord-3"></a><h4><tt>acl</tt> Token</h4>
<a name="indexterm-3688"></a><p>The <tt>acl</tt> token records information about Access Control Lists (ACLs). This token consists
of four fixed fields:</p>
<ul><li><p>A token ID that identifies this token as an <tt>acl</tt> token</p></li>
<li><p>A field that specifies the ACL type</p></li>
<li><p>An ACL value field</p></li>
<li><p>A field that lists the permissions associated with this ACL</p></li></ul>
<p>The <tt>praudit</tt> command displays the <tt>acl</tt> token as follows:</p><pre>acl,jdoe,staff,0755</pre>

<a name="aparecord-5"></a><h4><tt>arbitrary</tt> Token  (Obsolete)</h4>
<a name="indexterm-3689"></a><p>The <tt>arbitrary</tt> token encapsulates data for the audit trail. This token consists of
four fixed fields and an array of data. The fixed fields are as
follows:</p>
<ul><li><p>A token ID that identifies this token as an <tt>arbitrary</tt> token</p></li>
<li><p>A suggested print format field, such as hexadecimal</p></li>
<li><p><a name="indexterm-3690"></a><a name="indexterm-3691"></a>An item size field that specifies the size of the data that is encapsulated, such as short</p></li>
<li><p>A count field that provides the number of following items</p></li></ul>
<p>The remainder of the token is composed of <i>count</i> of the specified type.
The <tt>praudit</tt> command displays the <tt>arbitrary</tt> token as follows:</p><pre>arbitrary,decimal,int,1
42</pre><p><a name="indexterm-3692"></a><a name="indexterm-3693"></a>The following table shows the possible values of the print format field.</p><a name="aparecord-21"></a><h6>Table&nbsp;31-5 Values for the <tt>arbitrary</tt> Token's Print Format Field</h6><table><col width="33%"><col width="66%"><tr><th align="left" valign="top" scope="column"><p>Value</p></th>
<th align="left" valign="top" scope="column"><p>Action</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>AUP_BINARY</tt></p></td>
<td align="left" valign="top" scope="row"><p>Prints the
date in binary format</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>AUP_OCTAL</tt></p></td>
<td align="left" valign="top" scope="row"><p>Prints the date in octal format</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>AUP_DECIMAL</tt></p></td>
<td align="left" valign="top" scope="row"><p>Prints the date in
decimal format</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>AUP_HEX</tt></p></td>
<td align="left" valign="top" scope="row"><p>Prints the date in hexadecimal format</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>AUP_STRING</tt></p></td>
<td align="left" valign="top" scope="row"><p>Prints the date as a string</p></td>
</tr>
</table><p>The following table shows the possible values of the item size field.</p><a name="aparecord-tbl-2"></a><h6>Table&nbsp;31-6 Values for the <tt>arbitrary</tt> Token's Item Size Field</h6><table><col width="33%"><col width="66%"><tr><th align="left" valign="top" scope="column"><p>Value</p></th>
<th align="left" valign="top" scope="column"><p>Action</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>AUR_BYTE</tt></p></td>
<td align="left" valign="top" scope="row"><p>Data
is printed in units of bytes in 1 byte</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>AUR_SHORT</tt></p></td>
<td align="left" valign="top" scope="row"><p>Data is printed in
units of shorts in 2 bytes</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>AUR_LONG</tt></p></td>
<td align="left" valign="top" scope="row"><p>Data is printed in units of longs
in 4 bytes</p></td>
</tr>
</table>

<a name="aparecord-6"></a><h4><tt>arg</tt> Token</h4>
<a name="indexterm-3694"></a><a name="indexterm-3695"></a><p>The <tt>arg</tt> token contains information about the arguments to a system call: the
argument number of the system call, the argument value, and an optional description.
This token allows a 32-bit integer system-call argument in an audit record. The
<tt>arg</tt> token has five fields:</p>
<ul><li><p>A token ID that identifies this token as an <tt>arg</tt> token</p></li>
<li><p>An argument ID that tells which system call argument that the token refers to</p></li>
<li><p>The argument value</p></li>
<li><p>The length of the descriptive text string</p></li>
<li><p>The text string</p></li></ul>
<p>The <tt>praudit</tt> command displays the <tt>arg</tt> token without the fourth field, as follows:</p><pre>argument,4,0xffbfe0ac,pri</pre><p>The <tt>praudit -x</tt> command includes the names of the fields that are displayed:</p><pre>&lt;argument arg-num="4" value="0xffbfe0ac" desc="pri"/&gt;</pre>

<a name="aparecord-4"></a><h4><tt>attribute</tt> Token</h4>
<a name="indexterm-3696"></a><a name="indexterm-3697"></a><a name="indexterm-3698"></a><p>The <tt>attribute</tt> token contains information from the file vnode. This token has seven
fields:</p>
<ul><li><p>A token ID that identifies this token as an <tt>attribute</tt> token</p></li>
<li><p>The file access mode and type</p></li>
<li><p>The owner user ID</p></li>
<li><p>The owner group ID</p></li>
<li><p>The file system ID</p></li>
<li><p>The node ID</p></li>
<li><p>The device ID that the file might represent</p></li></ul>
<p>For further information about the file system ID and the device ID, see
the <a href="http://docs.sun.com/doc/819-2241/statvfs-2?a=view"><tt>statvfs</tt>(2)</a> man page.</p><p>The <tt>attribute</tt> token usually accompanies a <tt>path</tt> token. The <tt>attribute</tt> token is produced
during path searches. If a path-search error occurs, there is no vnode available
to obtain the necessary file information. Therefore, the <tt>attribute</tt> token is not included as
part of the audit record. The <tt>praudit</tt> command displays the <tt>attribute</tt> token as
follows:</p><pre>attribute,20666,root,root,247,4829,450971566127</pre>

<a name="auditref-26"></a><h4><tt>cmd</tt> Token</h4>
<a name="indexterm-3699"></a><a name="indexterm-3700"></a><p>The <tt>cmd</tt> token records the list of arguments and the list of environment
variables that are associated with a command.</p><p>The <tt>cmd</tt> token contains the following fields:</p>
<ul><li><p>A token ID that identifies this token as a <tt>cmd</tt> token</p></li>
<li><p>A count of the command's arguments</p></li>
<li><p>The argument list</p></li>
<li><p>The length of the next field</p></li>
<li><p>The content of the arguments</p></li>
<li><p>A count of the environment variables</p></li>
<li><p>The list of environment variables</p></li>
<li><p>The length of the next field</p></li>
<li><p>The content of the environment variables</p></li></ul>
<p>The <tt>praudit</tt> command displays the <tt>cmd</tt> token as follows:</p><pre>cmd,argcnt,3,ls,-l,/etc,envcnt,0,</pre>

<a name="aparecord-10"></a><h4><tt>exec_args</tt> Token</h4>
<a name="indexterm-3701"></a><a name="indexterm-3702"></a><a name="indexterm-3703"></a><a name="indexterm-3704"></a><p>The <tt>exec_args</tt> token records the arguments to an <tt>exec()</tt> system call. The
<tt>exec_args</tt> token has two fixed fields:</p>
<ul><li><p>A token ID field that identifies this token as an <tt>exec_args</tt> token</p></li>
<li><p>A count that represents the number of arguments that are passed to the <tt>exec()</tt> system call</p></li></ul>
<p>The remainder of this token is composed of <i>count</i> strings.  The <tt>praudit</tt>
command displays the <tt>exec_args</tt> token as follows:</p><pre>exec_args,2,vi,/etc/security/audit_user</pre>
<hr><p><b>Note - </b>The <tt>exec_args</tt> token is output only when the <tt>argv</tt> audit policy option
is active.</p>
<hr>


<a name="aparecord-12"></a><h4><tt>exec_env</tt> Token</h4>
<a name="indexterm-3705"></a><a name="indexterm-3706"></a><a name="indexterm-3707"></a><a name="indexterm-3708"></a><a name="indexterm-3709"></a><p>The <tt>exec_env</tt> token records the current environment variables to an <tt>exec()</tt> system call.
The <tt>exec_env</tt> token has two fixed fields:</p>
<ul><li><p>A token ID field that identifies this token as an <tt>exec_env</tt> token</p></li>
<li><p>A count that represents the number of arguments that are passed to the <tt>exec()</tt> system call</p></li></ul>
<p>The remainder of this token is composed of <i>count</i> strings. The <tt>praudit</tt> command
displays the <tt>exec_env</tt> token as follows:</p><pre>exec_env,25,
GROUP=staff,HOME=/export/home/jdoe,HOST=exm1,HOSTTYPE=sun4u,HZ=100,
LC_COLLATE=en_US.ISO8859-1,LC_CTYPE=en_US.ISO8859-1,LC_MESSAGES=C,
LC_MONETARY=en_US.ISO8859-1,LC_NUMERIC=en_US.ISO8859-1,
LC_TIME=en_US.ISO8859-1,LOGNAME=jdoe,MACHTYPE=sparc,
MAIL=/var/mail/jdoe,OSTYPE=solaris,PATH=/usr/sbin:/usr/bin,PS1=#,
PWD=/var/audit,REMOTEHOST=192.168.13.5,SHELL=/usr/bin/csh,SHLVL=1,
TERM=dtterm,TZ=US/Pacific,USER=jdoe,VENDOR=sun</pre>
<hr><p><b>Note - </b>The <tt>exec_env</tt> token is output only when the <tt>arge</tt> audit policy option
is active.</p>
<hr>


<a name="aparecord-14"></a><h4><tt>exit</tt> Token (Obsolete)</h4>
<a name="indexterm-3710"></a><p>The <tt>exit</tt> token records the exit status of a program. The <tt>exit</tt> token
contains the following fields:</p>
<ul><li><p>A token ID that identifies this token as an <tt>exit</tt> token</p></li>
<li><p>A program exit status as passed to the <tt>exit()</tt> system call</p></li>
<li><p>A return value that describes the exit status or that provides a system error number</p></li></ul>
<p>The <tt>praudit</tt> command displays the <tt>exit</tt> token as follows:</p><pre>exit,Error 0,0</pre>

<a name="aparecord-16"></a><h4><tt>file</tt> Token</h4>
<a name="indexterm-3711"></a><p>The <tt>file</tt> token is a special token that is generated by the <tt>auditd</tt>
daemon. The token marks the beginning of a new audit file and the
end of an old audit file as the old file is deactivated. The
<tt>auditd</tt> daemon builds a special audit record that contains this token to &ldquo;link&rdquo;
together successive audit files into one audit trail.</p><p>The <tt>file</tt> token has four fields:</p>
<ul><li><p>A token ID that identifies this token as a <tt>file</tt> token</p></li>
<li><p>A timestamp that identifies the date and the time that the file was created or was closed</p></li>
<li><p>The file name length</p></li>
<li><p>A field that holds the file null-terminated name</p></li></ul>
<p>The <tt>praudit -x</tt> command shows the fields of the <tt>file</tt> token:</p><pre>file,2003-10-13 11:21:35.506 -07:00,
    /var/audit/localhost/files/20031013175058.20031013182135.example1</pre>

<a name="aparecord-18"></a><h4><tt>group</tt> Token (Obsolete)</h4>
<p>This token has been replaced by the the <tt>groups</tt> token. See <a href="#aparecord-25"><tt>groups</tt> Token</a>.</p>

<a name="aparecord-25"></a><h4><tt>groups</tt> Token</h4>
<a name="indexterm-3712"></a><p>The <tt>groups</tt> token replaces the <tt>group</tt> token. The <tt>groups</tt> token records the group
entries from the process's credential. The <tt>groups</tt> token has two fixed fields:</p>
<ul><li><p>A token ID field that identifies this token as a <tt>groups</tt> token</p></li>
<li><p>A count that represents the number of groups that are contained in this audit record</p></li></ul>
<p>The remainder of this token is composed of <i>count</i> group entries. The <tt>praudit</tt>
command displays the <tt>groups</tt> token as follows:</p><pre>groups,staff,admin</pre>
<hr><p><b>Note - </b><a name="indexterm-3713"></a><a name="indexterm-3714"></a>The <tt>groups</tt> token is output only when the <tt>group</tt> audit policy option is
active.</p>
<hr>


<a name="aparecord-20"></a><h4><tt>header</tt> Token</h4>
<a name="indexterm-3715"></a><a name="indexterm-3716"></a><p>The <tt>header</tt> token is special in that it marks the beginning of an
audit record. The <tt>header</tt> token combines with the <tt>trailer</tt> token to bracket all
the other tokens in the record.</p><p>The <tt>header</tt> token has eight fields:</p>
<ul><li><p>A token ID field that identifies this token as a <tt>header</tt> token</p></li>
<li><p>A byte count of the total length of the audit record, including both the <tt>header</tt> and the <tt>trailer</tt> tokens</p></li>
<li><p>A version number that identifies the version of the audit record structure</p></li>
<li><p>The audit event ID that identifies the audit event that the record represents</p></li>
<li><p>The ID modifier that identifies special characteristics of the audit event</p></li>
<li><p>The address type, either IPv4 or IPv6</p></li>
<li><p>The machine's IP address</p></li>
<li><p>The time and date that the record was created</p></li></ul>
<p>On 64-bit systems, the <tt>header</tt> token is displayed with a 64-bit timestamp, in
place of the 32-bit timestamp.</p><p>The <tt>praudit</tt> command displays the <tt>header</tt> token for a <tt>ioctl()</tt> system call as
follows:</p><pre>header,176,2,ioctl(2),fe,example1,2003-09-08 11:23:31.050 -07:00</pre><p><a name="indexterm-3717"></a><a name="indexterm-3718"></a>The ID modifier field has the following flags defined:</p><pre>0x4000            PAD_NOTATTR                        nonattributable event
0x8000            PAD_FAILURE                        failed audit event</pre>

<a name="aparecord-22"></a><h4><tt>in_addr</tt> Token</h4>
<a name="indexterm-3719"></a><a name="indexterm-3720"></a><p>The <tt>in_addr</tt> token contains an Internet Protocol address. Since the Solaris 8 release,
the Internet address can be displayed in IPv4 format or IPv6 format. The
IPv4 address uses 4 bytes. The IPv6 address uses 1 byte to describe
the address type, and 16 bytes to describe the address. The <tt>in_addr</tt> token
has three fields:</p>
<ul><li><p>A token ID that identifies this token as an <tt>in_addr</tt> token</p></li>
<li><p>The IP address type, either IPv4 or IPv6</p></li>
<li><p>An IP address</p></li></ul>
<p>The <tt>praudit</tt> command displays the <tt>in_addr</tt> token, without the second field, as follows:</p><pre>ip address,192.168.113.7</pre>

<a name="aparecord-24"></a><h4><tt>ip</tt> Token (Obsolete)</h4>
<a name="indexterm-3721"></a><a name="indexterm-3722"></a><p>The <tt>ip</tt> token contains a copy of an Internet Protocol header. The <tt>ip</tt>
token has two fields:</p>
<ul><li><p>A token ID that identifies this token as an <tt>ip</tt> token</p></li>
<li><p>A copy of the IP header, that is, all 20 bytes</p></li></ul>
<p>The <tt>praudit</tt> command displays the <tt>ip</tt> token as follows:</p><pre>ip address,0.0.0.0</pre><p>The IP header structure is defined in the <tt>/usr/include/netinet/ip.h</tt> file.</p>

<a name="aparecord-26"></a><h4><tt>ipc</tt> Token</h4>
<a name="indexterm-3723"></a><a name="indexterm-3724"></a><a name="indexterm-3725"></a><a name="indexterm-3726"></a><p>The <tt>ipc</tt> token contains the System V IPC message handle, semaphore handle, or
shared-memory handle that is used by the caller to identify a particular IPC
object. The <tt>ipc</tt> token has three fields:</p>
<ul><li><p>A token ID that identifies this token as an <tt>ipc</tt> token</p></li>
<li><p>A type field that specifies the type of IPC object</p></li>
<li><p>The handle that identifies the IPC object</p></li></ul>

<hr><p><b>Note - </b>The IPC object identifiers violate the context-free nature of the Solaris audit tokens.
No global &ldquo;name&rdquo; uniquely identifies IPC objects. Instead, IPC objects are identified by
their handles. The handles are valid only during the time that the IPC
objects are active. However, the identification of IPC objects should not be a
problem. The System V IPC mechanisms are seldom used, and the mechanisms all
share the same audit class.</p>
<hr>
<p>The following table shows the possible values for the IPC object type field.
The values are defined in the <tt>/usr/include/bsm/audit.h</tt> file. </p><a name="aparecord-17"></a><h6>Table&nbsp;31-7 Values for the IPC Object Type Field</h6><table><col width="28%"><col width="28%"><col width="42%"><tr><th align="left" valign="top" scope="column"><p>Name</p></th>
<th align="left" valign="top" scope="column"><p>Value</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>AU_IPC_MSG</tt></p></td>
<td align="left" valign="top" scope="row"><p>1</p></td>
<td align="left" valign="top" scope="row"><p>IPC message object</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>AU_IPC_SEM</tt></p></td>
<td align="left" valign="top" scope="row"><p>2</p></td>
<td align="left" valign="top" scope="row"><p>IPC semaphore
object</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>AU_IPC_SHM</tt></p></td>
<td align="left" valign="top" scope="row"><p>3</p></td>
<td align="left" valign="top" scope="row"><p>IPC shared-memory object</p></td>
</tr>
</table><p>The <tt>praudit</tt> command displays the <tt>ipc</tt> token as follows:</p><pre>IPC,msg,3</pre>

<a name="aparecord-23"></a><h4><tt>ipc_perm</tt> Token</h4>
<a name="indexterm-3727"></a><a name="indexterm-3728"></a><p>The <tt>ipc_perm</tt> token contains a copy of the System V IPC access permissions.
This token is added to audit records that are generated by IPC shared-memory
events, IPC semaphore events, and IPC message events. The <tt>ipc_perm</tt> token has eight
fields:</p>
<ul><li><p>A token ID that identifies this token as an <tt>ipc_perm</tt> token</p></li>
<li><p>The user ID of the IPC owner</p></li>
<li><p>The group ID of the IPC owner</p></li>
<li><p>The user ID of the IPC creator</p></li>
<li><p>The group ID of the IPC creator</p></li>
<li><p>The access mode of the IPC</p></li>
<li><p>The sequence number of the IPC</p></li>
<li><p>The IPC key value</p></li></ul>
<p>The <tt>praudit</tt> command displays the <tt>ipc_perm</tt> token as follows:</p><pre>IPC perm,root,sys,root,sys,0,0,0x00000000</pre><p>The values are taken from the <tt>ipc_perm</tt> structure that is associated with the
IPC object.</p>

<a name="aparecord-7"></a><h4><tt>iport</tt> Token</h4>
<a name="indexterm-3729"></a><a name="indexterm-3730"></a><a name="indexterm-3731"></a><a name="indexterm-3732"></a><p>The <tt>iport</tt> token contains the TCP or UDP port address. The <tt>iport</tt> token
has two fields:</p>
<ul><li><p>A token ID that identifies this token as an <tt>iport</tt> token</p></li>
<li><p>The TCP or UDP port address</p></li></ul>
<p>The <tt>praudit</tt> command displays the <tt>iport</tt> token as follows:</p><pre>ip port,0xf6d6</pre>

<a name="aparecord-27"></a><h4><tt>opaque</tt> Token  (Obsolete)</h4>
<a name="indexterm-3733"></a><p>The <tt>opaque</tt> token contains unformatted data as a sequence of bytes. The <tt>opaque</tt>
token has three fields:</p>
<ul><li><p>A token ID that identifies this token as an <tt>opaque</tt> token</p></li>
<li><p>A byte count of the data</p></li>
<li><p>An array of byte data</p></li></ul>
<p>The <tt>praudit</tt> command displays the <tt>opaque</tt> token as follows:</p><pre>opaque,12,0x4f5041515545204441544100</pre>

<a name="aparecord-29"></a><h4><tt>path</tt> Token</h4>
<a name="indexterm-3734"></a><p>The <tt>path</tt> token contains access path information for an object. This token contains
the following fields:</p>
<ul><li><p>A token ID that identifies this token as an <tt>path</tt> token</p></li>
<li><p>The path length</p></li>
<li><p>The absolute path to the object that is based on the real root of the system</p></li></ul>
<p>The <tt>praudit</tt> command displays the <tt>path</tt> token, without the second field, as follows:</p><pre>path,/etc/security/audit_user</pre><p>The <tt>praudit -x</tt> command displays the <tt>path</tt> token as follows:</p><pre>&lt;path&gt;/etc/security/audit_user&lt;/path&gt;</pre><p>The following figure shows the format of a <tt>path</tt> token.</p><a name="aparecord-fig-16"></a><h6>Figure&nbsp;31-4 <tt>path</tt> Token Format</h6><img src="figures/7172.path.gif" alt="The preceding context describes the graphic."></img>

<a name="auditref-21"></a><h4><tt>path_attr</tt> Token</h4>
<a name="indexterm-3735"></a><p>The <tt>path_attr</tt> token contains access path information for an object. The access path
specifies the sequence of attribute file objects below the <tt>path</tt> token object. Systems
calls such as <tt>openat()</tt> access attribute files. For more information on attribute
file objects, see the <a href="http://docs.sun.com/doc/819-2252/fsattr-5?a=view"><tt>fsattr</tt>(5)</a> man page.</p><p>The <tt>path_attr</tt> token contains the following fields:</p>
<ul><li><p>A token ID that identifies this token as a <tt>path_attr</tt> token</p></li>
<li><p>A count that represents the number of sections of attribute file paths</p></li>
<li><p><i>count</i> null-terminated strings</p></li></ul>
<p>The <tt>praudit</tt> command displays the <tt>path_attr</tt> token as follows:</p><pre>path_attr,1,attr_file_name</pre>

<a name="auditref-23"></a><h4><tt>privilege</tt> Token</h4>
<a name="indexterm-3736"></a><p>The <tt>privilege</tt> token records the use of privileges on a process. The <tt>privilege</tt>
token is not recorded for privileges in the basic set. If a privilege
has been removed from the basic set by administrative action, then the use
of that privilege is recorded. For more information on privileges, see <a href="prbac-2.html">Privileges (Overview)</a></p><p>The <tt>privilege</tt> token contains the following fields:</p>
<ul><li><p>A token ID that identifies this token as a <tt>privilege</tt> token</p></li>
<li><p>The length of the following field</p></li>
<li><p>The name of privilege set</p></li>
<li><p>The length of the following field</p></li>
<li><p>The list of privileges</p></li></ul>
<p>The <tt>praudit</tt> command displays the <tt>privilege</tt> token as follows:</p><pre>privilege,effective,</pre>

<a name="aparecord-28"></a><h4><tt>process</tt> Token</h4>
<a name="indexterm-3737"></a><p>The <tt>process</tt> token contains information about a user who is associated with a
process, such as the recipient of a signal. The <tt>process</tt> token has
nine fields:</p>
<ul><li><p>A token ID that identifies this token as a <tt>process</tt> token</p></li>
<li><p>The audit ID</p></li>
<li><p>The effective user ID</p></li>
<li><p>The effective group ID</p></li>
<li><p>The real user ID</p></li>
<li><p>The real group ID</p></li>
<li><p>The process ID</p></li>
<li><p>The audit session ID</p></li>
<li><p>A terminal ID that consists of a device ID and a machine ID</p></li></ul>
<p>The audit ID, user ID, group ID, process ID, and session ID
are long instead of short.</p>
<hr><p><b>Note - </b>The <tt>process</tt> token fields for the session ID, the real user ID, or
the real group ID might be unavailable. The value is then set to
<tt>-1</tt>.</p>
<hr>
<p>Any token that contains a terminal ID has several variations. The <tt>praudit</tt>
command hides these variations. So, the terminal ID is handled the same way
for any token that contains a terminal ID. The terminal ID is either
an IP address and port number, or a device ID. A device
ID, such as the serial port that is connected to a modem, can
be zero. The terminal ID is specified in one of several formats.</p><p>The terminal ID for device numbers is specified as follows:</p>
<ul><li><p><b>32-bit applications &ndash;</b> 4-byte device number, 4 bytes unused</p></li>
<li><p><b>64-bit applications &ndash;</b> 8-byte device number, 4 bytes unused</p></li></ul>
<p>In releases prior to the Solaris 8 release, the terminal ID for port
numbers is specified as follows:</p>
<ul><li><p><b>32-bit applications &ndash;</b> 4-byte port number, 4-byte IP address</p></li>
<li><p><b>64-bit applications &ndash;</b> 8-byte port number, 4-byte IP address</p></li></ul>
<p>Since the Solaris 8 release, the terminal ID for port numbers is specified
as follows:</p>
<ul><li><p><b>32-bit with IPv4 &ndash;</b> 4-byte port number, 4-byte IP type, 4-byte IP address</p></li>
<li><p><b>32-bit with IPv6 &ndash;</b> 4-byte port number, 4-byte IP type, 16-byte IP address</p></li>
<li><p><b>64-bit with IPv4 &ndash;</b> 8-byte port number, 4-byte IP type, 4-byte IP address</p></li>
<li><p><b>64-bit with IPv6 &ndash;</b> 8-byte port number, 4-byte IP type, 16-byte IP address</p></li></ul>
<p>The <tt>praudit</tt> command displays the <tt>process</tt> token as follows:</p><pre>process,root,root,sys,root,sys,0,0,0,0.0.0.0</pre><p>The following figure shows the format of a <tt>process</tt> token.</p><a name="aparecord-fig-17"></a><h6>Figure&nbsp;31-5 <tt>process</tt> Token Format</h6><img src="figures/7173.process.gif" alt="The preceding context describes the graphic."></img>

<a name="aparecord-30"></a><h4><tt>return</tt> Token</h4>
<a name="indexterm-3738"></a><a name="indexterm-3739"></a><p>The <tt>return</tt> token contains the return status of the system call (<tt>u_error</tt>) and
the process return value (<tt>u_rval1</tt>). This token has three fields:</p>
<ul><li><p>A token ID that identifies this token as a <tt>return</tt> token</p></li>
<li><p>The error status of the system call</p></li>
<li><p>The return value of the system call</p></li></ul>
<p>The <tt>return</tt> token is always returned as part of kernel-generated audit records for
system calls. In application auditing, this token indicates exit status and other return
values.</p><p>The <tt>praudit</tt> command displays the <tt>return</tt> token for a system call as follows:</p><pre>return,failure: Operation now in progress,-1</pre><p>The <tt>praudit -x</tt> command displays the <tt>return</tt> token as follows:</p><pre>&lt;return errval="failure: Operation now in progress" retval="-1/"&gt;</pre>

<a name="aparecord-31"></a><h4><tt>sequence</tt> Token</h4>
<a name="indexterm-3740"></a><a name="indexterm-3741"></a><p>The <tt>sequence</tt> token contains a sequence number. This token is useful for debugging.
The <tt>sequence</tt> token has two fields:</p>
<ul><li><p>A token ID that identifies this token as a <tt>sequence</tt> token</p></li>
<li><p>A 32-bit unsigned long field that contains the sequence number</p></li></ul>
<p>The sequence number is incremented every time an audit record is added to
the audit trail. The <tt>praudit</tt> command displays the <tt>sequence</tt> token as follows:</p><pre>sequence,1292</pre><p><a name="indexterm-3742"></a><a name="indexterm-3743"></a>The <tt>praudit -x</tt> command displays the <tt>sequence</tt> token as follows:</p><pre>&lt;sequence seq-num="1292"/&gt;</pre>
<hr><p><b>Note - </b>The <tt>sequence</tt> token is output only when the <tt>seq</tt> audit policy option
is active.</p>
<hr>


<a name="aparecord-32"></a><h4><tt>socket</tt> Token</h4>
<a name="indexterm-3744"></a><a name="indexterm-3745"></a><p>The <tt>socket</tt> token contains information that describes an Internet socket. In some instances,
the token has four fields:</p>
<ul><li><p>A token ID that identifies this token as a <tt>socket</tt> token</p></li>
<li><p>A socket type field that indicates the type of socket referenced, either TCP, UDP, or UNIX</p></li>
<li><p>The local port</p></li>
<li><p>The local IP address</p></li></ul>
<p>The <tt>praudit</tt> command displays this instance of the <tt>socket</tt> token as follows:</p><pre>socket,0x0002,0x83b1,localhost</pre><p>In most instances, the token has eight fields:</p>
<ul><li><p>A token ID that identifies this token as a <tt>socket</tt> token</p></li>
<li><p>The socket domain</p></li>
<li><p>A socket type field that indicates the type of socket referenced, either TCP, UDP, or UNIX</p></li>
<li><p>The local port</p></li>
<li><p>The address type, either IPv4 or IPv6</p></li>
<li><p>The local IP address</p></li>
<li><p>The remote port</p></li>
<li><p>The remote IP address</p></li></ul>
<p>Since the Solaris 8 release, the Internet address can be displayed in IPv4
format or IPv6 format. The IPv4 address uses 4 bytes. The IPv6
address uses 1 byte to describe the address type, and 16 bytes to
describe the address.</p><p>The <tt>praudit</tt> command displays the <tt>socket</tt> token as follows:</p><pre>socket,0x0002,0x0002,0x83cf,example1,0x2383,server1.Subdomain.Domain.COM</pre><p>The <tt>praudit -x</tt> command describes the <tt>socket</tt> token fields. The lines are wrapped for
display purposes.</p><pre>&lt;socket sock_domain="0x0002" sock_type="0x0002" lport="0x83cf" 
laddr="example1" fport="0x2383" faddr="server1.Subdomain.Domain.COM"/&gt;</pre>

<a name="aparecord-33"></a><h4><tt>subject</tt> Token</h4>
<a name="indexterm-3746"></a><p>The <tt>subject</tt> token describes a user who performs or attempts to perform an
operation. The format is the same as the <tt>process</tt> token. The <tt>subject</tt> token
has nine fields:</p>
<ul><li><p>A token ID that identifies this token as a <tt>subject</tt> token</p></li>
<li><p>The audit ID</p></li>
<li><p>The effective user ID</p></li>
<li><p>The effective group ID</p></li>
<li><p>The real user ID</p></li>
<li><p>The real group ID</p></li>
<li><p>The process ID</p></li>
<li><p>The audit session ID</p></li>
<li><p>A terminal ID that consists of a device ID and a machine ID</p></li></ul>
<p>The audit ID, user ID, group ID, process ID, and session ID
are long instead of short.</p>
<hr><p><b>Note - </b>The <tt>subject</tt> token fields for the session ID, the real user ID, or
the real group ID might be unavailable. The value is then set to
<tt>-1</tt>.</p>
<hr>
<p>Any token that contains a terminal ID has several variations. The <tt>praudit</tt>
command hides these variations. So, the terminal ID is handled the same way
for any token that contains a terminal ID. The terminal ID is either
an IP address and port number, or a device ID. A device
ID, such as the serial port that is connected to a modem, can
be zero. The terminal ID is specified in one of several formats.</p><p>The terminal ID for device numbers is specified as follows:</p>
<ul><li><p><b>32-bit applications &ndash;</b> 4-byte device number, 4 bytes unused</p></li>
<li><p><b>64-bit applications &ndash;</b> 8-byte device number, 4 bytes unused</p></li></ul>
<p>In releases prior to the Solaris 8 release, the terminal ID for port
numbers is specified as follows:</p>
<ul><li><p><b>32-bit applications &ndash;</b> 4-byte port number, 4-byte IP address</p></li>
<li><p><b>64-bit applications &ndash;</b> 8-byte port number, 4-byte IP address</p></li></ul>
<p>Since the Solaris 8 release, the terminal ID for port numbers is specified
as follows:</p>
<ul><li><p><b>32-bit with IPv4 &ndash;</b> 4-byte port number, 4-byte IP type, 4-byte IP address</p></li>
<li><p><b>32-bit with IPv6 &ndash;</b> 4-byte port number, 4-byte IP type, 16-byte IP address</p></li>
<li><p><b>64-bit with IPv4 &ndash;</b> 8-byte port number, 4-byte IP type, 4-byte IP address</p></li>
<li><p><b>64-bit with IPv6 &ndash;</b> 8-byte port number, 4-byte IP type, 16-byte IP address</p></li></ul>
<p>The <tt>subject</tt> token is always returned as part of kernel-generated audit records for
system calls. The <tt>praudit</tt> command displays the <tt>subject</tt> token as follows:</p><pre>subject,jdoe,root,staff,root,staff,424,223,0 0 example1</pre><p>The following figure shows the format of the <tt>subject</tt> token.</p><a name="aparecord-fig-25"></a><h6>Figure&nbsp;31-6 <tt>subject</tt> Token Format</h6><img src="figures/7173.process.gif" alt="The preceding context describes the graphic."></img>

<a name="aparecord-34"></a><h4><tt>text</tt> Token</h4>
<a name="indexterm-3747"></a><p>The <tt>text</tt> token contains a text string. This token has three fields:</p>
<ul><li><p>A token ID that identifies this token as a <tt>text</tt> token</p></li>
<li><p>The length of the text string</p></li>
<li><p>The text string itself</p></li></ul>
<p>The <tt>praudit</tt> command displays the <tt>text</tt> token as follows:</p><pre>text,logout jdoe</pre>

<a name="aparecord-35"></a><h4><tt>trailer</tt> Token</h4>
<a name="indexterm-3748"></a><a name="indexterm-3749"></a><p>The two tokens, <tt>header</tt> and <tt>trailer</tt>, are special in that they distinguish the
end points of an audit record and bracket all the other tokens. A
<tt>header</tt> token begins an audit record. A <tt>trailer</tt> token ends an audit record.
The <tt>trailer</tt> token is an optional token. The <tt>trailer</tt> token is added as
the last token of each record only when the <tt>trail</tt> audit policy option
has been set.</p><p><a name="indexterm-3750"></a>When an audit record is generated with trailers turned on, the <tt>auditreduce</tt> command can
verify that the trailer correctly points back to the record header. The
<tt>trailer</tt> token supports backward seeks of the audit trail.</p><p>The <tt>trailer</tt> token has three fields:</p>
<ul><li><p>A token ID that identifies this token as a <tt>trailer</tt> token</p></li>
<li><p>A pad number to aid in marking the end of the record</p></li>
<li><p>The total number of characters in the audit record, including both the <tt>header</tt> and <tt>trailer</tt> tokens</p></li></ul>
<p><a name="indexterm-3751"></a>The <tt>praudit</tt> command displays the <tt>trailer</tt> token, without the second field, as follows:</p><pre>trailer,136</pre>

<a name="auditref-27"></a><h4><tt>uauth</tt> Token</h4>
<a name="indexterm-3752"></a><p>The <tt>uauth</tt> token records the use of authorization with a command or action.</p><p>The <tt>uauth</tt> token contains the following fields:</p>
<ul><li><p>A token ID that identifies this token as a <tt>uauth</tt> token</p></li>
<li><p>The length of the text in the following field</p></li>
<li><p>A list of authorizations</p></li></ul>
<p>The <tt>praudit</tt> command displays the <tt>uauth</tt> token as follows:</p><pre>use of authorization,solaris.admin.printer.delete</pre>

<a name="auditref-15"></a><h4><tt>zonename</tt> Token</h4>
<a name="indexterm-3753"></a><p>The <tt>zonename</tt> token records the zone in which the audit event occurred. The
string &ldquo;global&rdquo; indicates audit events that occur in the global zone.</p><p>The <tt>zonename</tt> token contains the following fields:</p>
<ul><li><p>A token ID that identifies this token as a <tt>zonename</tt> token</p></li>
<li><p>The length of the text in the following field</p></li>
<li><p>The name of the zone</p></li></ul>
<p>The <tt>praudit</tt> command displays the <tt>zonename</tt> token as follows:</p><pre>zonename,graphzone</pre>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="auditref-20.html">Previous</a>
             </td>
             <td align="right">
                 <a href="glossary-2.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

