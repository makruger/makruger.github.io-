<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>A Typical Solaris Secure Shell Session - System Administration Guide: Security Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-08-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Security Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="sshref-1.html">Previous</a>
             </td>
             <td align="right">
                 <a href="sshref-4.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="oview-1.html">Part&nbsp;I&nbsp;Security Overview</a></p>
<p class="toc level2"><a href="secov-1.html">1.&nbsp;&nbsp;Security Services (Overview)</a></p>
<p class="toc level1 tocsp"><a href="sectm-1.html">Part&nbsp;II&nbsp;System, File, and Device Security</a></p>
<p class="toc level2"><a href="concept-1.html">2.&nbsp;&nbsp;Managing Machine Security (Overview)</a></p>
<p class="toc level2"><a href="secsys-1.html">3.&nbsp;&nbsp;Controlling Access to Systems (Tasks)</a></p>
<p class="toc level2"><a href="vscan-1.html">4.&nbsp;&nbsp;Virus Scanning Service (Tasks)</a></p>
<p class="toc level2"><a href="devtask-1.html">5.&nbsp;&nbsp;Controlling Access to Devices (Tasks)</a></p>
<p class="toc level2"><a href="bart-1.html">6.&nbsp;&nbsp;Using the Basic Audit Reporting Tool (Tasks)</a></p>
<p class="toc level2"><a href="secfile-1.html">7.&nbsp;&nbsp;Controlling Access to Files (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="prbactm-1.html">Part&nbsp;III&nbsp;Roles, Rights Profiles, and Privileges</a></p>
<p class="toc level2"><a href="prbac-1.html">8.&nbsp;&nbsp;Using Roles and Privileges (Overview)</a></p>
<p class="toc level2"><a href="rbactask-1.html">9.&nbsp;&nbsp;Using Role-Based Access Control (Tasks)</a></p>
<p class="toc level2"><a href="rbacref-1.html">10.&nbsp;&nbsp;Role-Based Access Control (Reference)</a></p>
<p class="toc level2"><a href="privtask-1.html">11.&nbsp;&nbsp;Privileges (Tasks)</a></p>
<p class="toc level2"><a href="privref-1.html">12.&nbsp;&nbsp;Privileges (Reference)</a></p>
<p class="toc level1 tocsp"><a href="scftm-1.html">Part&nbsp;IV&nbsp;Solaris Cryptographic Services</a></p>
<p class="toc level2"><a href="scf-1.html">13.&nbsp;&nbsp;Solaris Cryptographic Framework (Overview)</a></p>
<p class="toc level2"><a href="scftask-1.html">14.&nbsp;&nbsp;Solaris Cryptographic Framework (Tasks)</a></p>
<p class="toc level2"><a href="kmf-1.html">15.&nbsp;&nbsp;Solaris Key Management Framework</a></p>
<p class="toc level1 tocsp"><a href="authtm-1.html">Part&nbsp;V&nbsp;Authentication Services and Secure Communication</a></p>
<p class="toc level2"><a href="auth-1.html">16.&nbsp;&nbsp;Using Authentication Services (Tasks)</a></p>
<p class="toc level2"><a href="pam-1.html">17.&nbsp;&nbsp;Using PAM</a></p>
<p class="toc level2"><a href="sasl-1.html">18.&nbsp;&nbsp;Using SASL</a></p>
<p class="toc level2"><a href="sshuser-1.html">19.&nbsp;&nbsp;Using Solaris Secure Shell (Tasks)</a></p>
<p class="toc level2"><a href="sshref-1.html">20.&nbsp;&nbsp;Solaris Secure Shell (Reference)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">A Typical Solaris Secure Shell Session</a></p>
</div>
<p class="toc level3"><a href="sshref-4.html">Client and Server Configuration in Solaris Secure Shell</a></p>
<p class="toc level3"><a href="sshref-10.html">Keywords in Solaris Secure Shell</a></p>
<p class="toc level3"><a href="sshref-11.html">Maintaining Known Hosts in Solaris Secure Shell</a></p>
<p class="toc level3"><a href="sshref-28.html">Solaris Secure Shell Packages and Initialization</a></p>
<p class="toc level3"><a href="sshref-2.html">Solaris Secure Shell Files</a></p>
<p class="toc level3"><a href="sshref-13.html">Solaris Secure Shell Commands</a></p>
<p class="toc level1 tocsp"><a href="seamtm-1.html">Part&nbsp;VI&nbsp;Kerberos Service</a></p>
<p class="toc level2"><a href="intro-1.html">21.&nbsp;&nbsp;Introduction to the Kerberos Service</a></p>
<p class="toc level2"><a href="seamplan-1.html">22.&nbsp;&nbsp;Planning for the Kerberos Service</a></p>
<p class="toc level2"><a href="setup-8.html">23.&nbsp;&nbsp;Configuring the Kerberos Service (Tasks)</a></p>
<p class="toc level2"><a href="trouble-1.html">24.&nbsp;&nbsp;Kerberos Error Messages and Troubleshooting</a></p>
<p class="toc level2"><a href="aadmin-1.html">25.&nbsp;&nbsp;Administering Kerberos Principals and Policies (Tasks)</a></p>
<p class="toc level2"><a href="user-7.html">26.&nbsp;&nbsp;Using Kerberos Applications (Tasks)</a></p>
<p class="toc level2"><a href="refer-1.html">27.&nbsp;&nbsp;The Kerberos Service (Reference)</a></p>
<p class="toc level1 tocsp"><a href="audittm-1.html">Part&nbsp;VII&nbsp;Solaris Auditing</a></p>
<p class="toc level2"><a href="auditov-1.html">28.&nbsp;&nbsp;Solaris Auditing (Overview)</a></p>
<p class="toc level2"><a href="auditplan-1.html">29.&nbsp;&nbsp;Planning for Solaris Auditing</a></p>
<p class="toc level2"><a href="audittask-1.html">30.&nbsp;&nbsp;Managing Solaris Auditing (Tasks)</a></p>
<p class="toc level2"><a href="auditref-1.html">31.&nbsp;&nbsp;Solaris Auditing (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-2.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="sshref-3"></a><h3>A Typical Solaris Secure Shell Session</h3>
<a name="indexterm-2130"></a><a name="indexterm-2131"></a><a name="indexterm-2132"></a><a name="indexterm-2133"></a><a name="indexterm-2134"></a><p>The Solaris Secure Shell daemon (<tt>sshd</tt>) is normally started at boot time when
network services are started. The daemon listens for connections from clients. A Solaris
Secure Shell session begins when the user runs an <tt>ssh</tt>, <tt>scp</tt>, or
<tt>sftp</tt> command. A new <tt>sshd</tt> daemon is forked for each incoming connection. The
forked daemons handle key exchange, encryption, authentication, command execution, and data exchange with
the client. These session characteristics are determined by client-side configuration files and server-side configuration
files. Command-line arguments can override the settings in the configuration files.</p><p>The client and server must authenticate themselves to each other. After successful authentication,
the user can execute commands remotely and copy data between hosts.</p>

<a name="sshref-12"></a><h4>Session Characteristics in Solaris Secure Shell</h4>
<p><a name="indexterm-2135"></a>The server-side behavior of the <tt>sshd</tt> daemon is controlled by keyword settings in
the <tt>/etc/ssh/sshd_config</tt> file. For example, the <tt>sshd_config</tt> file controls which types of authentication are
permitted for accessing the server. The server-side behavior can also be controlled by
the command-line options when the <tt>sshd</tt> daemon is started.</p><p><a name="indexterm-2136"></a>The behavior on the client side is controlled by Solaris Secure Shell
keywords in this order of precedence:</p>
<ul><li><p>Command-line options</p></li>
<li><p>User's configuration file, <tt>~/.ssh/config</tt></p></li>
<li><p>System-wide configuration file, <tt>/etc/ssh/ssh_config</tt></p></li></ul>
<p>For example, a user can override a system-wide configuration <tt>Cipher</tt> setting of
<tt>blowfish</tt> by specifying <tt>-c 3des</tt> on the command line.</p>

<a name="sshref-14"></a><h4>Authentication and Key Exchange in Solaris Secure Shell</h4>
<a name="indexterm-2137"></a><a name="indexterm-2138"></a><p>The Solaris Secure Shell protocols, v1 and v2, both support client user/host
authentication and server host authentication. Both protocols involve the exchange of session cryptographic keys
for the protection of Solaris Secure Shell sessions. Each protocol provides various methods
for authentication and key exchange. Some methods are optional. Solaris Secure Shell
supports a number of client authentication mechanisms, as shown in <a href="sshuser-2.html#sshuser-tbl-1">Table&nbsp;19-1</a>. Servers are
authenticated by using known host public keys.</p><p>For the v1 protocol, Solaris Secure Shell supports user authentication with passwords. The
protocol also supports user public keys and authentication with trusted host public keys.
Server authentication is done with a host public key. For the v1 protocol,
all public keys are <a href="glossary-2.html#glossary-159">RSA</a> keys. Session key exchanges involve the use of
an ephemeral server key that is periodically regenerated.</p><p>For the v2 protocol, Solaris Secure Shell supports user authentication and generic interactive
authentication, which usually involves passwords. The protocol also supports authentication with user public
keys and with trusted host public keys. The keys can be RSA or
<a href="glossary-2.html#glossary-145">DSA</a>. Session key exchanges consist of Diffie-Hellman ephemeral key exchanges that are signed in
the server authentication step. Additionally, Solaris Secure Shell can use GSS credentials for
authentication.</p>

<a name="sshref-15"></a><h5>Acquiring GSS Credentials in Solaris Secure Shell</h5>
<p><a name="indexterm-2139"></a>To use GSS-API for authentication in Solaris Secure Shell, the server must
have GSS-API acceptor credentials and the client must have GSS-API initiator credentials. Support is
available for <tt>mech_dh</tt> and for <tt>mech_krb5</tt>.</p><p><a name="indexterm-2140"></a>For <tt>mech_dh</tt>, the server has GSS-API acceptor credentials if <tt>root</tt> has run the
<tt>keylogin</tt> command.</p><p><a name="indexterm-2141"></a>For <tt>mech_krb5</tt>, the server has GSS-API acceptor credentials when the host principal that
corresponds to the server has a valid entry in <tt>/etc/krb5/krb5.keytab</tt>.</p><p>The client has initiator credentials for <tt>mech_dh</tt> if one of the following has
been done:</p>
<ul><li><p>The <tt>keylogin</tt> command has been run.</p></li>
<li><p>The <tt>pam_dhkeys</tt> module is used in the <tt>pam.conf</tt> file.</p></li></ul>
<p>The client has initiator credentials for <tt>mech_krb5</tt> if one of the following has
been done:</p>
<ul><li><p>The <tt>kinit</tt> command has been run.</p></li>
<li><p>The <tt>pam_krb5</tt> module is used in the <tt>pam.conf</tt> file.</p></li></ul>
<p>For the use of <tt>mech_dh</tt> in secure RPC, see <a href="auth-1.html">Chapter&nbsp;16, Using Authentication Services (Tasks)</a>. For the use
of <tt>mech_krb5</tt>, see <a href="intro-1.html">Chapter&nbsp;21, Introduction to the Kerberos Service</a>. For more information on mechanisms, see the <a href="http://docs.sun.com/doc/819-2251/mech-4?a=view"><tt>mech</tt>(4)</a> and
<a href="http://docs.sun.com/doc/819-2252/mech-spnego-5?a=view"><tt>mech_spnego</tt>(5)</a> man pages.</p>

<a name="sshref-16"></a><h4>Command Execution and Data Forwarding in Solaris Secure Shell</h4>
<a name="indexterm-2142"></a><a name="indexterm-2143"></a><a name="indexterm-2144"></a><a name="indexterm-2145"></a><a name="indexterm-2146"></a><a name="indexterm-2147"></a><a name="indexterm-2148"></a><p><a name="indexterm-2149"></a>After authentication is complete, the user can use Solaris Secure Shell, generally by
requesting a shell or executing a command. Through the <tt>ssh</tt> command options, the
user can make requests. Requests can include allocating a pseudo-tty, forwarding X11 connections
or TCP/IP connections, or enabling an <tt>ssh-agent</tt> authentication program over a secure
connection.</p><p>The basic components of a user session are as follows:</p>
<ol><li><p>The user requests a shell or the execution of a command, which begins the session mode.</p><p>In this mode, data is sent or received through the terminal on the client side. On the server side, data is sent through the shell or a command.</p></li>
<li><p>When data transfer is complete, the user program terminates.</p></li>
<li><p>All X11 forwarding and TCP/IP forwarding is stopped, except for those connections that already exist. Existing X11 connections and TCP/IP connections remain open.</p></li>
<li><p>The server sends an exit status message to the client. When all connections are closed, such as forwarded ports that had remained open, the client closes the connection to the server. Then, the client exits.</p></li></ol>

         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="sshref-1.html">Previous</a>
             </td>
             <td align="right">
                 <a href="sshref-4.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

