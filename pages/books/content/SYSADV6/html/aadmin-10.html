<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Administering Keytab Files - System Administration Guide: Security Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-08-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Security Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="aadmin-228.html">Previous</a>
             </td>
             <td align="right">
                 <a href="user-7.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="oview-1.html">Part&nbsp;I&nbsp;Security Overview</a></p>
<p class="toc level2"><a href="secov-1.html">1.&nbsp;&nbsp;Security Services (Overview)</a></p>
<p class="toc level1 tocsp"><a href="sectm-1.html">Part&nbsp;II&nbsp;System, File, and Device Security</a></p>
<p class="toc level2"><a href="concept-1.html">2.&nbsp;&nbsp;Managing Machine Security (Overview)</a></p>
<p class="toc level2"><a href="secsys-1.html">3.&nbsp;&nbsp;Controlling Access to Systems (Tasks)</a></p>
<p class="toc level2"><a href="vscan-1.html">4.&nbsp;&nbsp;Virus Scanning Service (Tasks)</a></p>
<p class="toc level2"><a href="devtask-1.html">5.&nbsp;&nbsp;Controlling Access to Devices (Tasks)</a></p>
<p class="toc level2"><a href="bart-1.html">6.&nbsp;&nbsp;Using the Basic Audit Reporting Tool (Tasks)</a></p>
<p class="toc level2"><a href="secfile-1.html">7.&nbsp;&nbsp;Controlling Access to Files (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="prbactm-1.html">Part&nbsp;III&nbsp;Roles, Rights Profiles, and Privileges</a></p>
<p class="toc level2"><a href="prbac-1.html">8.&nbsp;&nbsp;Using Roles and Privileges (Overview)</a></p>
<p class="toc level2"><a href="rbactask-1.html">9.&nbsp;&nbsp;Using Role-Based Access Control (Tasks)</a></p>
<p class="toc level2"><a href="rbacref-1.html">10.&nbsp;&nbsp;Role-Based Access Control (Reference)</a></p>
<p class="toc level2"><a href="privtask-1.html">11.&nbsp;&nbsp;Privileges (Tasks)</a></p>
<p class="toc level2"><a href="privref-1.html">12.&nbsp;&nbsp;Privileges (Reference)</a></p>
<p class="toc level1 tocsp"><a href="scftm-1.html">Part&nbsp;IV&nbsp;Solaris Cryptographic Services</a></p>
<p class="toc level2"><a href="scf-1.html">13.&nbsp;&nbsp;Solaris Cryptographic Framework (Overview)</a></p>
<p class="toc level2"><a href="scftask-1.html">14.&nbsp;&nbsp;Solaris Cryptographic Framework (Tasks)</a></p>
<p class="toc level2"><a href="kmf-1.html">15.&nbsp;&nbsp;Solaris Key Management Framework</a></p>
<p class="toc level1 tocsp"><a href="authtm-1.html">Part&nbsp;V&nbsp;Authentication Services and Secure Communication</a></p>
<p class="toc level2"><a href="auth-1.html">16.&nbsp;&nbsp;Using Authentication Services (Tasks)</a></p>
<p class="toc level2"><a href="pam-1.html">17.&nbsp;&nbsp;Using PAM</a></p>
<p class="toc level2"><a href="sasl-1.html">18.&nbsp;&nbsp;Using SASL</a></p>
<p class="toc level2"><a href="sshuser-1.html">19.&nbsp;&nbsp;Using Solaris Secure Shell (Tasks)</a></p>
<p class="toc level2"><a href="sshref-1.html">20.&nbsp;&nbsp;Solaris Secure Shell (Reference)</a></p>
<p class="toc level1 tocsp"><a href="seamtm-1.html">Part&nbsp;VI&nbsp;Kerberos Service</a></p>
<p class="toc level2"><a href="intro-1.html">21.&nbsp;&nbsp;Introduction to the Kerberos Service</a></p>
<p class="toc level2"><a href="seamplan-1.html">22.&nbsp;&nbsp;Planning for the Kerberos Service</a></p>
<p class="toc level2"><a href="setup-8.html">23.&nbsp;&nbsp;Configuring the Kerberos Service (Tasks)</a></p>
<p class="toc level2"><a href="trouble-1.html">24.&nbsp;&nbsp;Kerberos Error Messages and Troubleshooting</a></p>
<p class="toc level2"><a href="aadmin-1.html">25.&nbsp;&nbsp;Administering Kerberos Principals and Policies (Tasks)</a></p>
<p class="toc level3"><a href="aadmin-171.html">Ways to Administer Kerberos Principals and Policies</a></p>
<p class="toc level3"><a href="aadmin-23.html">SEAM Administration Tool</a></p>
<p class="toc level3"><a href="aadmin-9.html">Administering Kerberos Principals</a></p>
<p class="toc level3"><a href="aadmin-68.html">Administering Kerberos Policies</a></p>
<p class="toc level3"><a href="aadmin-228.html">SEAM Tool Reference</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Administering Keytab Files</a></p>
</div>
<p class="toc level2 tocsp"><a href="user-7.html">26.&nbsp;&nbsp;Using Kerberos Applications (Tasks)</a></p>
<p class="toc level2"><a href="refer-1.html">27.&nbsp;&nbsp;The Kerberos Service (Reference)</a></p>
<p class="toc level1 tocsp"><a href="audittm-1.html">Part&nbsp;VII&nbsp;Solaris Auditing</a></p>
<p class="toc level2"><a href="auditov-1.html">28.&nbsp;&nbsp;Solaris Auditing (Overview)</a></p>
<p class="toc level2"><a href="auditplan-1.html">29.&nbsp;&nbsp;Planning for Solaris Auditing</a></p>
<p class="toc level2"><a href="audittask-1.html">30.&nbsp;&nbsp;Managing Solaris Auditing (Tasks)</a></p>
<p class="toc level2"><a href="auditref-1.html">31.&nbsp;&nbsp;Solaris Auditing (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-2.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="aadmin-10"></a><h3>Administering Keytab Files</h3>
<a name="indexterm-2750"></a><a name="indexterm-2751"></a><a name="indexterm-2752"></a><a name="indexterm-2753"></a><p>Every host that provides a service must have a local file, called
a <b>keytab</b> (short for &ldquo;key table&rdquo;). The keytab contains the principal for the
appropriate service, called a <b>service key</b>. A service key is used by a service
to authenticate itself to the KDC and is known only by Kerberos and
the service itself. For example, if you have a Kerberized NFS server, that
server must have a keytab file that contains its <tt>nfs</tt> service principal.</p><p><a name="indexterm-2754"></a><a name="indexterm-2755"></a><a name="indexterm-2756"></a><a name="indexterm-2757"></a><a name="indexterm-2758"></a>To add a service key to a keytab file, you add the appropriate
service principal to a host's keytab file by using the <tt>ktadd</tt> command of
<tt>kadmin</tt>. Because you are adding a service principal to a keytab file, the
principal must already exist in the Kerberos database so that <tt>kadmin</tt> can
verify its existence. On the master KDC, the keytab file is located at
<tt>/etc/krb5/kadm5.keytab</tt>, by default. On application servers that provide Kerberized services, the keytab file is
located at <tt>/etc/krb5/krb5.keytab</tt>, by default.</p><p>A keytab is analogous to a user's password. Just as it is
important for users to protect their passwords, it is equally important for application servers
to protect their keytab files. You should always store keytab files on a
local disk, and make them readable only by the <tt>root</tt> user. Also, you
should never send a keytab file over an unsecured network. </p><p><a name="indexterm-2759"></a>There is also a special instance in which to add a <tt>root</tt> principal
to a host's keytab file. If you want a user on the Kerberos
client to mount Kerberized NFS file systems that require root-equivalent access, you must
add the client's <tt>root</tt> principal to the client's keytab file. Otherwise, users must
use the <tt>kinit</tt> command as <tt>root</tt> to obtain credentials for the client's <tt>root</tt>
principal whenever they want to mount a Kerberized NFS file system with <tt>root</tt>
access, even when they are using the automounter. </p>
<hr><p><b>Note - </b><a name="indexterm-2760"></a><a name="indexterm-2761"></a>When you set up a master KDC, you need to add the <tt>kadmind</tt>
and <tt>changepw</tt> principals to the <tt>kadm5.keytab</tt> file.</p>
<hr>
<p><a name="indexterm-2762"></a><a name="indexterm-2763"></a>Another command that you can use to administer keytab files is the <tt>ktutil</tt>
command. This interactive command enables you to manage a local host's keytab file
without having Kerberos administration privileges, because <tt>ktutil</tt> doesn't interact with the Kerberos database as
<tt>kadmin</tt> does. So, after a principal is added to a keytab file, you
can use <tt>ktutil</tt> to view the keylist in a keytab file or to
temporarily disable authentication for a service.</p>
<hr><p><b>Note - </b>When you change a principal in a keytab file using the <tt>ktadd</tt>
command in <tt>kadmin</tt>, a new key is generated and added to the keytab
file.</p>
<hr>


<a name="aadmin-227"></a><h4>Administering Keytab Files (Task Map)</h4>
<table><col width="27%"><col width="42%"><col width="30%"><tr><th align="left" valign="top" scope="column"><p>Task</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>For Instructions</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Add a service principal to a keytab file.</p></td>
<td align="left" valign="top" scope="row"><p>Use the <tt>ktadd</tt> command
of <tt>kadmin</tt> to add a service principal to a keytab file.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aadmin-158">How to Add a Kerberos Service Principal to a Keytab File</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Remove a service
principal from a keytab file.</p></td>
<td align="left" valign="top" scope="row"><p>Use the <tt>ktremove</tt> command of <tt>kadmin</tt> to remove a
service from a keytab file.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aadmin-164">How to Remove a Service Principal From a Keytab File</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Display the keylist (list of principals) in a
keytab file.</p></td>
<td align="left" valign="top" scope="row"><p>Use the <tt>ktutil</tt> command to display the keylist in a keytab file.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aadmin-193">How to Display the Keylist (Principals) in a Keytab File</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Temporarily
disable authentication for a service on a host.</p></td>
<td align="left" valign="top" scope="row"><p>This procedure is a quick
way to temporarily disable authentication for a service on a host without requiring
<tt>kadmin</tt> privileges. </p><p>Before you use <tt>ktutil</tt> to delete the service principal from the
server's keytab file, copy the original keytab file to a temporary location. When
you want to enable the service again, copy the original keytab file back
to its proper location.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#aadmin-194">How to Temporarily Disable Authentication for a Service on a Host</a></p></td>
</tr>
</table>

<a name="aadmin-158"></a><h4>How to Add a Kerberos Service Principal to a Keytab File</h4><a name="indexterm-2764"></a><a name="indexterm-2765"></a><a name="indexterm-2766"></a><a name="indexterm-2767"></a><a name="indexterm-2768"></a><a name="indexterm-2769"></a><ol>
<li><a name="seamgadmin-step-296"></a><b>Make sure that the principal already exists in the Kerberos database. </b><p>See <a href="aadmin-9.html#aadmin-12">How to View the List of Kerberos Principals</a> for more information.</p></li>
<li><a name="seamgadmin-step-297"></a><b>Become superuser on the host that needs a principal added to its keytab
file.</b></li>
<li><a name="seamgadmin-step-298"></a><b>Start the <tt>kadmin</tt> command. </b><pre># <tt><b>/usr/sbin/kadmin</b></tt></pre></li>
<li><a name="seamgadmin-step-299"></a><b><a name="indexterm-2770"></a>Add a principal to a keytab file by using the <tt>ktadd</tt> command.</b><pre>kadmin: <tt><b>ktadd</b></tt> [<tt><b>-e</b></tt> <i>enctype</i>] [<tt><b>-k</b></tt> <i>keytab</i>] [<tt><b>-q</b></tt>] [<i>principal</i> | <tt><b>-glob</b></tt> <i>principal-exp</i>]</pre><dl><dt><tt>-e</tt> <i>enctype</i></dt>
<dd><p>Overrides the list of encryption types defined in the <tt>krb5.conf</tt> file.</p></dd>
<dt><tt>-k</tt> <i>keytab</i></dt>
<dd><p>Specifies the keytab file. By default, <tt>/etc/krb5/krb5.keytab</tt> is used.</p></dd>
<dt><tt>-q</tt></dt>
<dd><p>Displays less verbose information.</p></dd>
<dt><i>principal</i></dt>
<dd><p>Specifies the principal to be added to the keytab file. You can add the following service principals: <tt>host</tt>, <tt>root</tt>, <tt>nfs</tt>, and <tt>ftp</tt>.</p></dd>
<dt><tt>-glob</tt> <i>principal-exp</i></dt>
<dd><p>Specifies the principal expressions. All principals that match the <i>principal-exp</i> are added to the keytab file. The rules for principal expression are the same as for the <tt>list_principals</tt> command of <tt>kadmin</tt>. </p></dd>
</dl>
</li>
<li><a name="seamgadmin-step-300"></a><b>Quit the <tt>kadmin</tt> command.</b><pre>kadmin: <tt><b>quit</b></tt></pre></li></ol><a name="ehgaw"></a><h6>Example&nbsp;25-16 Adding a Service Principal to a Keytab File</h6><p>In the following example, the <tt>kadmin/kdc1.example.com</tt> and <tt>changepw/kdc1.example.com</tt> principals are added to
a master KDC's keytab file. For this example, the keytab file must be
the file that is specified in the <tt>kdc.conf</tt> file.</p><pre>kdc1 # <tt><b>/usr/sbin/kadmin.local</b></tt>
kadmin.local: <tt><b>ktadd -k /etc/krb5/kadm5.keytab kadmin/kdc1.example.com changepw/kdc1.example.com</b></tt>
Entry for principal kadmin/kdc1.example.com with kvno 3, encryption type AES-256 CTS mode
          with 96-bit SHA-1 HMAC added to keytab WRFILE:/etc/krb5/kadm5.keytab.
Entry for principal kadmin/kdc1.example.com with kvno 3, encryption type AES-128 CTS mode
          with 96-bit SHA-1 HMAC added to keytab WRFILE:/etc/krb5/kadm5.keytab.
Entry for principal kadmin/kdc1.example.com with kvno 3, encryption type Triple DES cbc
          mode with HMAC/sha1 added to keytab WRFILE:/etc/krb5/kadm5.keytab.
Entry for principal kadmin/kdc1.example.com with kvno 3, encryption type ArcFour
          with HMAC/md5 added to keytab WRFILE:/etc/krb5/kadm5.keytab.
Entry for principal kadmin/kdc1.example.com with kvno 3, encryption type DES cbc mode
          with RSA-MD5 added to keytab WRFILE:/etc/krb5/kadm5.keytab.
Entry for principal changepw/kdc1.example.com with kvno 3, encryption type AES-256 CTS
          mode with 96-bit SHA-1 HMAC added to keytab WRFILE:/etc/krb5/kadm5.keytab.
Entry for principal changepw/kdc1.example.com with kvno 3, encryption type AES-128 CTS
          mode with 96-bit SHA-1 HMAC added to keytab WRFILE:/etc/krb5/kadm5.keytab.
Entry for principal changepw/kdc1.example.com with kvno 3, encryption type Triple DES cbc
          mode with HMAC/sha1 added to keytab WRFILE:/etc/krb5/kadm5.keytab.
Entry for principal changepw/kdc1.example.com with kvno 3, encryption type ArcFour
          with HMAC/md5 added to keytab WRFILE:/etc/krb5/kadm5.keytab.
Entry for principal changepw/kdc1.example.com with kvno 3, encryption type DES cbc mode
          with RSA-MD5 added to keytab WRFILE:/etc/krb5/kadm5.keytab.
kadmin.local: <tt><b>quit</b></tt></pre><p>In the following example, <tt>denver</tt>'s <tt>host</tt> principal is added to <tt>denver</tt>'s keytab file,
so that the KDC can authenticate <tt>denver</tt>'s network services.</p><pre>denver # <tt><b>/usr/sbin/kadmin</b></tt>
kadmin: <tt><b>ktadd host/denver.example.com</b></tt>
Entry for principal host/denver.example.com with kvno 3, encryption type AES-256 CTS
          mode with 96-bit SHA-1 HMAC added to keytab WRFILE:/etc/krb5/krb5.keytab.
Entry for principal host/denver.example.com with kvno 3, encryption type AES-128 CTS mode
          with 96-bit SHA-1 HMAC added to keytab WRFILE:/etc/krb5/krb5.keytab.
Entry for principal host/denver.example.com with kvno 3, encryption type Triple DES cbc mode
          with HMAC/sha1 added to keytab WRFILE:/etc/krb5/krb5.keytab.
Entry for principal host/denver.example.com with kvno 3, encryption type ArcFour
          with HMAC/md5 added to keytab WRFILE:/etc/krb5/krb5.keytab.
Entry for principal host/denver.example.com with kvno 3, encryption type DES cbc mode
          with RSA-MD5 added to keytab WRFILE:/etc/krb5/krb5.keytab.
kadmin: <tt><b>quit</b></tt></pre>

<a name="aadmin-164"></a><h4>How to Remove a Service Principal From a Keytab File</h4><a name="indexterm-2771"></a><a name="indexterm-2772"></a><a name="indexterm-2773"></a><a name="indexterm-2774"></a><a name="indexterm-2775"></a><ol>
<li><a name="seamgadmin-step-301"></a><b>Become superuser on the host with a service principal that must be removed
from its keytab file.</b></li>
<li><a name="seamgadmin-step-302"></a><b>Start the <tt>kadmin</tt> command. </b><pre># <tt><b>/usr/sbin/kadmin</b></tt></pre></li>
<li><a name="aadmin-step-164"></a>(Optional) <b><a name="indexterm-2776"></a><a name="indexterm-2777"></a>To display the current list of principals (keys) in the keytab file, use
the <tt>ktutil</tt> command. </b><p>See <a href="#aadmin-193">How to Display the Keylist (Principals) in a Keytab File</a> for detailed instructions.</p></li>
<li><a name="seamgadmin-step-303"></a><b><a name="indexterm-2778"></a><a name="indexterm-2779"></a><a name="indexterm-2780"></a><a name="indexterm-2781"></a><a name="indexterm-2782"></a>Remove a principal from the keytab file by using the <tt>ktremove</tt> command.</b><pre>kadmin: <tt><b>ktremove</b></tt> [<tt><b>-k</b></tt> <i>keytab</i>] [<tt><b>-q</b></tt>] <i>principal</i> [<i>kvno</i> | <tt><b>all</b></tt> | <tt><b>old</b></tt> ]</pre><dl><dt><tt>-k</tt> <i>keytab</i></dt>
<dd><p>Specifies the keytab file. By default, <tt>/etc/krb5/krb5.keytab</tt> is used.</p></dd>
<dt><tt>-q</tt></dt>
<dd><p>Displays less verbose information.</p></dd>
<dt><i>principal</i></dt>
<dd><p>Specifies the principal to be removed from the keytab file.</p></dd>
<dt><i>kvno</i></dt>
<dd><p>Removes all entries for the specified principal whose key version number matches <i>kvno</i>.</p></dd>
<dt><tt>all</tt></dt>
<dd><p>Removes all entries for the specified principal.</p></dd>
<dt><tt>old</tt></dt>
<dd><p>Removes all entries for the specified principal, except those principals with the highest key version number.</p></dd>
</dl>
</li>
<li><a name="seamgadmin-step-304"></a><b>Quit the <tt>kadmin</tt> command.</b><pre>kadmin: <tt><b>quit</b></tt></pre></li></ol><a name="ehgat"></a><h6>Example&nbsp;25-17 Removing a Service Principal From a Keytab File</h6><p>In the following example, <tt>denver</tt>'s <tt>host</tt> principal is removed from <tt>denver</tt>'s keytab file.</p><pre>denver # <tt><b>/usr/sbin/kadmin</b></tt>
kadmin: <tt><b>ktremove host/denver.example.com@EXAMPLE.COM</b></tt>
kadmin: Entry for principal host/denver.example.com@EXAMPLE.COM with kvno 3
  removed from keytab WRFILE:/etc/krb5/krb5.keytab.
kadmin: <tt><b>quit</b></tt></pre>

<a name="aadmin-193"></a><h4>How to Display the Keylist (Principals) in a Keytab File</h4><a name="indexterm-2783"></a><a name="indexterm-2784"></a><ol>
<li><a name="seamgadmin-step-305"></a><b>Become superuser on the host with the keytab file.</b>
<hr><p><b>Note - </b>Although you can create keytab files that are owned by other users, using
the default location for the keytab file requires <tt>root</tt> ownership. </p>
<hr>
</li>
<li><a name="seamgadmin-step-306"></a><b>Start the <tt>ktutil</tt> command.</b><pre># <tt><b>/usr/bin/ktutil</b></tt></pre></li>
<li><a name="seamgadmin-step-307"></a><b><a name="indexterm-2785"></a><a name="indexterm-2786"></a><a name="indexterm-2787"></a>Read the keytab file into the keylist buffer by using the <tt>read_kt</tt> command.</b><pre>ktutil: <tt><b>read_kt</b></tt> <i>keytab</i></pre></li>
<li><a name="seamgadmin-step-308"></a><b><a name="indexterm-2788"></a><a name="indexterm-2789"></a><a name="indexterm-2790"></a><a name="indexterm-2791"></a>Display the keylist buffer by using the <tt>list</tt> command.</b><pre>ktutil: <tt><b>list</b></tt></pre><p>The current keylist buffer is displayed.</p></li>
<li><a name="seamgadmin-step-309"></a><b>Quit the <tt>ktutil</tt> command.</b><pre>ktutil: <tt><b>quit</b></tt></pre></li></ol><a name="ehgau"></a><h6>Example&nbsp;25-18 Displaying the Keylist (Principals) in a Keytab File</h6><p>The following example displays the keylist in the <tt>/etc/krb5/krb5.keytab</tt> file on the
<tt>denver</tt> host.</p><pre>denver # <tt><b>/usr/bin/ktutil</b></tt>
    ktutil: <tt><b>read_kt /etc/krb5/krb5.keytab</b></tt>
    ktutil: <tt><b>list</b></tt>
slot KVNO Principal
---- ---- ---------------------------------------
   1    5 host/denver@EXAMPLE.COM
    ktutil: <tt><b>quit</b></tt></pre>

<a name="aadmin-194"></a><h4>How to Temporarily Disable Authentication for a Service on a Host</h4><a name="indexterm-2792"></a><a name="indexterm-2793"></a><a name="indexterm-2794"></a><p>At times, you might need to temporarily disable the authentication mechanism for a
service, such as <tt>rlogin</tt> or <tt>ftp</tt>, on a network application server. For example,
you might want to stop users from logging in to a system while
you are performing maintenance procedures. The <tt>ktutil</tt> command enables you to accomplish this
task by removing the service principal from the server's keytab file, without requiring
<tt>kadmin</tt> privileges. To enable authentication again, you just need to copy the original
keytab file that you saved back to its original location.</p>
<hr><p><b>Note - </b>By default, most services are set up to require authentication. If a service
is not set up to require authentication, then the service still works, even
if you disable authentication for the service.</p>
<hr>
<ol>
<li><a name="seamgadmin-step-310"></a><b>Become superuser on the host with the keytab file.</b>
<hr><p><b>Note - </b>Although you can create keytab files that are owned by other users, using
the default location for the keytab file requires <tt>root</tt> ownership. </p>
<hr>
</li>
<li><a name="seamgadmin-step-311"></a><b>Save the current keytab file to a temporary file.</b></li>
<li><a name="seamgadmin-step-312"></a><b>Start the <tt>ktutil</tt> command.</b><pre># <tt><b>/usr/bin/ktutil</b></tt></pre></li>
<li><a name="seamgadmin-step-313"></a><b><a name="indexterm-2795"></a><a name="indexterm-2796"></a><a name="indexterm-2797"></a>Read the keytab file into the keylist buffer by using the <tt>read_kt</tt> command.</b><pre>ktutil: <tt><b>read_kt</b></tt> <i>keytab</i></pre></li>
<li><a name="seamgadmin-step-314"></a><b><a name="indexterm-2798"></a><a name="indexterm-2799"></a><a name="indexterm-2800"></a><a name="indexterm-2801"></a>Display the keylist buffer by using the <tt>list</tt> command.</b><pre>ktutil: <tt><b>list</b></tt></pre><p>The current keylist buffer is displayed. Note the slot number for the service
that you want to disable.</p></li>
<li><a name="seamgadmin-step-315"></a><b><a name="indexterm-2802"></a><a name="indexterm-2803"></a><a name="indexterm-2804"></a><a name="indexterm-2805"></a>To temporarily disable a host's service, remove the specific service principal from the
keylist buffer by using the <tt>delete_entry</tt> command.</b><pre>ktutil: <tt><b>delete_entry</b></tt> <i>slot-number</i></pre><p>Where <i>slot-number</i> specifies the slot number of the service principal to be deleted,
which is displayed by the <tt>list</tt> command.</p></li>
<li><a name="seamgadmin-step-316"></a><b>Write the keylist buffer to a new keytab file by using the <tt>write_kt</tt>
command.</b><pre>ktutil: <tt><b>write_kt</b></tt> <i>new-keytab</i></pre></li>
<li><a name="seamgadmin-step-317"></a><b>Quit the <tt>ktutil</tt> command.</b><pre>ktutil: <tt><b>quit</b></tt></pre></li>
<li><b>Move the new keytab file.</b><pre># mv <i>new-keytab</i> <i>keytab</i></pre></li>
<li><a name="seamgadmin-step-318"></a><b>When you want to re-enable the service, copy the temporary (original) keytab file
back to its original location.</b></li></ol><a name="ehgav"></a><h6>Example&nbsp;25-19 Temporarily Disabling a Service on a Host</h6><p>In the following example, the <tt>host</tt> service on the <tt>denver</tt> host is
temporarily disabled. To re-enable the host service on <tt>denver</tt>, you would copy the
<tt>krb5.keytab.temp</tt> file to the <tt>/etc/krb5/krb5.keytab</tt> file.</p><pre>denver # <tt><b>cp /etc/krb5/krb5.keytab /etc/krb5/krb5.keytab.temp</b></tt>
denver # <tt><b>/usr/bin/ktutil</b></tt>
    ktutil:<tt><b>read_kt /etc/krb5/krb5.keytab</b></tt>
    ktutil:<tt><b>list</b></tt>
slot KVNO Principal
---- ---- ---------------------------------------
   1    8 root/denver@EXAMPLE.COM
   2    5 host/denver@EXAMPLE.COM
    ktutil:<tt><b>delete_entry 2</b></tt>
    ktutil:<tt><b>list</b></tt>
slot KVNO Principal
---- ---- --------------------------------------
   1    8 root/denver@EXAMPLE.COM
    ktutil:<tt><b>write_kt /etc/krb5/new.krb5.keytab</b></tt>
    ktutil: <tt><b>quit</b></tt>
denver # <tt><b>cp /etc/krb5/new.krb5.keytab /etc/krb5/krb5.keytab</b></tt></pre>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="aadmin-228.html">Previous</a>
             </td>
             <td align="right">
                 <a href="user-7.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

