<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Configuring Audit Files (Tasks) - System Administration Guide: Security Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-08-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Security Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="audittask-15.html">Previous</a>
             </td>
             <td align="right">
                 <a href="audittask-4.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="oview-1.html">Part&nbsp;I&nbsp;Security Overview</a></p>
<p class="toc level2"><a href="secov-1.html">1.&nbsp;&nbsp;Security Services (Overview)</a></p>
<p class="toc level1 tocsp"><a href="sectm-1.html">Part&nbsp;II&nbsp;System, File, and Device Security</a></p>
<p class="toc level2"><a href="concept-1.html">2.&nbsp;&nbsp;Managing Machine Security (Overview)</a></p>
<p class="toc level2"><a href="secsys-1.html">3.&nbsp;&nbsp;Controlling Access to Systems (Tasks)</a></p>
<p class="toc level2"><a href="vscan-1.html">4.&nbsp;&nbsp;Virus Scanning Service (Tasks)</a></p>
<p class="toc level2"><a href="devtask-1.html">5.&nbsp;&nbsp;Controlling Access to Devices (Tasks)</a></p>
<p class="toc level2"><a href="bart-1.html">6.&nbsp;&nbsp;Using the Basic Audit Reporting Tool (Tasks)</a></p>
<p class="toc level2"><a href="secfile-1.html">7.&nbsp;&nbsp;Controlling Access to Files (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="prbactm-1.html">Part&nbsp;III&nbsp;Roles, Rights Profiles, and Privileges</a></p>
<p class="toc level2"><a href="prbac-1.html">8.&nbsp;&nbsp;Using Roles and Privileges (Overview)</a></p>
<p class="toc level2"><a href="rbactask-1.html">9.&nbsp;&nbsp;Using Role-Based Access Control (Tasks)</a></p>
<p class="toc level2"><a href="rbacref-1.html">10.&nbsp;&nbsp;Role-Based Access Control (Reference)</a></p>
<p class="toc level2"><a href="privtask-1.html">11.&nbsp;&nbsp;Privileges (Tasks)</a></p>
<p class="toc level2"><a href="privref-1.html">12.&nbsp;&nbsp;Privileges (Reference)</a></p>
<p class="toc level1 tocsp"><a href="scftm-1.html">Part&nbsp;IV&nbsp;Solaris Cryptographic Services</a></p>
<p class="toc level2"><a href="scf-1.html">13.&nbsp;&nbsp;Solaris Cryptographic Framework (Overview)</a></p>
<p class="toc level2"><a href="scftask-1.html">14.&nbsp;&nbsp;Solaris Cryptographic Framework (Tasks)</a></p>
<p class="toc level2"><a href="kmf-1.html">15.&nbsp;&nbsp;Solaris Key Management Framework</a></p>
<p class="toc level1 tocsp"><a href="authtm-1.html">Part&nbsp;V&nbsp;Authentication Services and Secure Communication</a></p>
<p class="toc level2"><a href="auth-1.html">16.&nbsp;&nbsp;Using Authentication Services (Tasks)</a></p>
<p class="toc level2"><a href="pam-1.html">17.&nbsp;&nbsp;Using PAM</a></p>
<p class="toc level2"><a href="sasl-1.html">18.&nbsp;&nbsp;Using SASL</a></p>
<p class="toc level2"><a href="sshuser-1.html">19.&nbsp;&nbsp;Using Solaris Secure Shell (Tasks)</a></p>
<p class="toc level2"><a href="sshref-1.html">20.&nbsp;&nbsp;Solaris Secure Shell (Reference)</a></p>
<p class="toc level1 tocsp"><a href="seamtm-1.html">Part&nbsp;VI&nbsp;Kerberos Service</a></p>
<p class="toc level2"><a href="intro-1.html">21.&nbsp;&nbsp;Introduction to the Kerberos Service</a></p>
<p class="toc level2"><a href="seamplan-1.html">22.&nbsp;&nbsp;Planning for the Kerberos Service</a></p>
<p class="toc level2"><a href="setup-8.html">23.&nbsp;&nbsp;Configuring the Kerberos Service (Tasks)</a></p>
<p class="toc level2"><a href="trouble-1.html">24.&nbsp;&nbsp;Kerberos Error Messages and Troubleshooting</a></p>
<p class="toc level2"><a href="aadmin-1.html">25.&nbsp;&nbsp;Administering Kerberos Principals and Policies (Tasks)</a></p>
<p class="toc level2"><a href="user-7.html">26.&nbsp;&nbsp;Using Kerberos Applications (Tasks)</a></p>
<p class="toc level2"><a href="refer-1.html">27.&nbsp;&nbsp;The Kerberos Service (Reference)</a></p>
<p class="toc level1 tocsp"><a href="audittm-1.html">Part&nbsp;VII&nbsp;Solaris Auditing</a></p>
<p class="toc level2"><a href="auditov-1.html">28.&nbsp;&nbsp;Solaris Auditing (Overview)</a></p>
<p class="toc level2"><a href="auditplan-1.html">29.&nbsp;&nbsp;Planning for Solaris Auditing</a></p>
<p class="toc level2"><a href="audittask-1.html">30.&nbsp;&nbsp;Managing Solaris Auditing (Tasks)</a></p>
<p class="toc level3"><a href="audittask-3.html">Solaris Auditing (Task Map)</a></p>
<p class="toc level3"><a href="audittask-15.html">Configuring Audit Files (Task Map)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Configuring Audit Files (Tasks)</a></p>
</div>
<p class="toc level3"><a href="audittask-4.html">Configuring and Enabling the Auditing Service (Task Map)</a></p>
<p class="toc level3"><a href="audittask-28.html">Configuring and Enabling the Auditing Service (Tasks)</a></p>
<p class="toc level3"><a href="audittask-26.html">Configuring the Auditing Service in Zones (Tasks)</a></p>
<p class="toc level3"><a href="audittask-91.html">Managing Audit Records (Task Map)</a></p>
<p class="toc level3"><a href="audittask-21.html">Managing Audit Records</a></p>
<p class="toc level2 tocsp"><a href="auditref-1.html">31.&nbsp;&nbsp;Solaris Auditing (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-2.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="audittask-44"></a><h3>Configuring Audit Files (Tasks)</h3>
<a name="indexterm-3225"></a><a name="indexterm-3226"></a><p>Before you enable auditing on your network, you can customize the audit configuration
files for your site auditing requirements. You can also restart the auditing service
or reboot the local system to read changed configuration files after the auditing
service has been enabled. However, the recommended practice is to customize your audit
configuration as much as possible before you start the auditing service.</p><p>If you have implemented zones, you can choose to audit all zones
from the global zone. To differentiate between zones in the audit output, you
can set the <tt>zonename</tt> policy option. Alternatively, to audit  non-global zones individually, you
can set the <tt>perzone</tt> policy in the global zone and customize the audit
configuration files in the non-global zones. For an overview, see <a href="auditref-28.html">Auditing and Solaris Zones</a>. For planning,
see <a href="auditplan-12.html#auditplan-10">How to Plan Auditing in Zones</a>.</p>

<a name="audittask-45"></a><h4>How to Modify the <tt>audit_control</tt> File</h4><a name="indexterm-3227"></a><a name="indexterm-3228"></a><a name="indexterm-3229"></a><a name="indexterm-3230"></a><a name="indexterm-3231"></a><a name="indexterm-3232"></a><a name="indexterm-3233"></a><p>The <tt>/etc/security/audit_control</tt> file configures system-wide auditing. The file determines which events are audited,
when audit warnings are issued, and the location of the audit files.</p><ol>
<li><b>Assume the Primary Administrator role, or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="audittask-stepopt-3"></a>(Optional) <b>Save a backup copy of the <tt>audit_control</tt> file.</b><pre># <tt><b>cp /etc/security/audit_control /etc/security/audit_control.orig</b></tt></pre></li>
<li><b>Modify the <tt>audit_control</tt> file for your site.</b><p>Each entry has the following format:</p><pre><i>keyword</i>:<i>value</i></pre><dl><dt><i>keyword</i></dt>
<dd><p>Defines the type of line. The types are <tt>dir</tt>, <tt>flags</tt>, <tt>minfree</tt>, <tt>naflags</tt>, and <tt>plugin</tt>. The <tt>dir</tt> line can be repeated.</p><p>For explanations of the keywords, see the following examples. For an example of a <tt>plugin</tt> entry, see <a href="#audittask-11">How to Configure <tt>syslog</tt> Audit Logs</a></p></dd>
<dt><i>value</i></dt>
<dd><p>Specifies data that is associated with the line type.</p></dd>
</dl>
</li></ol><a name="audittask-71"></a><h6>Example&nbsp;30-1 Preselecting Audit Classes for All Users</h6><p>The <tt>flags</tt> line in the <tt>audit_control</tt> file defines which classes of attributable events
are audited for all users on the system. The classes are separated by
commas. White space is allowed. In this example, the events in the <tt>lo</tt>
class are audited for all users.</p><pre># audit_control file
dir:/var/audit
<tt><b>flags:lo</b></tt>
minfree:20
naflags:lo</pre><p>To see which events are in the <tt>lo</tt> class, read the <tt>audit_event</tt>
file. You can also use the <tt>bsmrecord</tt> command, as shown in <a href="audittask-21.html#audittask-33">Example&nbsp;30-25</a>.</p><a name="audittask-70"></a><h6>Example&nbsp;30-2 Preselecting Nonattributable Events</h6><p>In this example, all events in the <tt>na</tt> class, and all <tt>login</tt> events
that are not attributable, are audited.</p><pre># audit_control file
dir:/var/audit
flags:lo
minfree:20
<tt><b>naflags:lo,na</b></tt></pre><a name="audittask-50"></a><h6>Example&nbsp;30-3 Specifying the Location of Binary Audit Data</h6><p><a name="indexterm-3234"></a>The <tt>dir</tt> lines in the <tt>audit_control</tt> file list which audit file systems
to use for binary audit data. In this example, three locations for binary
audit data are defined.</p><pre># audit_control file
#
# Primary audit directory - NFS-mounted from audit server
<tt><b>dir:/var/audit/egret.1/files</b></tt>
#
# Secondary audit directory - NFS-mounted from audit server
<tt><b>dir:/var/audit/egret.2/files</b></tt>
#
# Directory of last resort local directory
<tt><b>dir:/var/audit</b></tt>
flags:lo
minfree:20
naflags:lo,na
plugin:</pre><p>To set up file systems to hold audit binary audit data, see
<a href="audittask-28.html#audittask-8">How to Create Partitions for Audit Files</a>.</p><a name="audittask-49"></a><h6>Example&nbsp;30-4 Changing the Soft Limit for Warnings</h6><p>In this example, the minimum free-space level for all audit file systems is
set so that a warning is issued when only 10 percent of
the file system is available.</p><pre># audit_control file
#
dir:/var/audit/examplehost.1/files
dir:/var/audit/examplehost.2/files
dir:/var/audit/localhost/files
flags:lo
<tt><b>minfree:10</b></tt>
naflags:lo,na</pre><p>The <tt>audit_warn</tt> alias receives the warning. To set up the alias, see <a href="audittask-28.html#audittask-16">How to Configure the <tt>audit_warn</tt> Email Alias</a>.</p>

<a name="audittask-11"></a><h4>How to Configure <tt>syslog</tt> Audit Logs</h4><a name="indexterm-3235"></a><a name="indexterm-3236"></a><a name="indexterm-3237"></a><p>You can instruct the auditing service to collect only binary audit data, or
you can instruct the auditing service to collect binary data and text
data. In the following procedure, you collect binary audit data and text audit
data. The collected text audit data is a subset of the binary data.</p><h6>Before You Begin</h6><p>Preselected audit classes must be specified on the <tt>flags</tt> line or the <tt>naflags</tt>
line of the <tt>audit_control</tt> file. The text data is a subset of the
preselected binary data.</p><ol>
<li><b>Assume the Primary Administrator role, or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li>(Optional) <b>Save a backup copy of the <tt>audit_control</tt> file.</b><pre># <tt><b>cp /etc/security/audit_control /etc/security/audit_control.save</b></tt></pre></li>
<li><b>Add a <tt>plugin</tt> entry.</b><p><a name="indexterm-3238"></a>Plugins in the auditing service implement binary output and <tt>syslog</tt> output of audit data.
The binary plugin is not specified. The <tt>syslog</tt> plugin must be specified. For
more information, see <a href="auditref-36.html#auditref-14"><tt>auditd</tt> Daemon</a>.</p><p>A <tt>plugin</tt> entry has the following format:</p><pre>plugin:name=<i>value</i>; p_flags=<i>classes</i></pre><dl><dt><i>value</i></dt>
<dd><p>Lists the name of the plugin to use. Currently, the only valid value is the <tt>audit_syslog.so.1</tt> plugin.</p></dd>
<dt><i>classes</i></dt>
<dd><p><a name="indexterm-3239"></a><a name="indexterm-3240"></a><a name="indexterm-3241"></a>Lists a subset of the audit classes that are specified in the <tt>flags</tt> line and the <tt>naflags</tt> line.</p></dd>
</dl>
<p>For more information about the <tt>plugin</tt> value, see the <a href="http://docs.sun.com/doc/819-2252/audit-syslog-5?a=view"><tt>audit_syslog</tt>(5)</a> man page.</p></li>
<li><b><a name="indexterm-3242"></a><a name="indexterm-3243"></a><a name="indexterm-3244"></a><a name="indexterm-3245"></a><a name="indexterm-3246"></a><a name="indexterm-3247"></a>Add an <tt>audit.notice</tt> entry to the <tt>syslog.conf</tt> file.</b><p>The entry includes the location of the log file.</p><pre># <tt><b>cat /etc/syslog.conf</b></tt>
&hellip;
audit.notice       /var/adm/auditlog</pre><p>Text logs should not be stored where the binary audit files are
stored. The <tt>auditreduce</tt> command assumes that all files in an audit partition are binary
audit files.</p></li>
<li><b>Create the log file.</b><pre># <tt><b>touch /var/adm/auditlog</b></tt></pre></li>
<li><b><a name="indexterm-3248"></a>Refresh the configuration information for the <tt>syslog</tt> service.</b><pre># <tt><b>svcadm refresh system/system-log</b></tt></pre></li>
<li><b>Regularly archive the <tt>syslog</tt> log files.</b><p>The auditing service can generate extensive output. To manage the logs, see the
<a href="http://docs.sun.com/doc/819-2240/logadm-1m?a=view"><tt>logadm</tt>(1M)</a> man page.</p></li></ol><a name="audittask-63"></a><h6>Example&nbsp;30-5 Specifying Audit Classes for <tt>syslog</tt> Output</h6><p>In the following example, the <tt>syslog</tt> utility collects a subset of the preselected
audit classes.</p><pre># audit_control file
dir:/var/audit/host.1/files
dir:/var/audit/host.2/files
dir:/var/audit/localhost/files
flags:lo,ss
minfree:10
naflags:lo,na
<tt><b>plugin:name=audit_syslog.so.1; p_flags=-lo,-na,-ss</b></tt></pre><p>The <tt>flags</tt> and <tt>naflags</tt> entries instruct the system to collect all login/logout, nonattributable,
and change of system state audit records in binary format. The <tt>plugin</tt> entry instructs
the <tt>syslog</tt> utility to collect only failed logins, failed nonattributable events, and failed
changes of system state.</p><a name="audittask-73"></a><h6>Example&nbsp;30-6 Putting <tt>syslog</tt> Audit Records on a Remote System</h6><p>You can change the <tt>audit.notice</tt> entry in the <tt>syslog.conf</tt> file to point
to a remote system. In this example, the name of the local system
is <tt>example1</tt>. The remote system is <tt>remote1</tt>.</p><pre>example1 # <tt><b>cat /etc/syslog.conf</b></tt>
&hellip;
audit.notice       @remote1</pre><p>The <tt>audit.notice</tt> entry in the <tt>syslog.conf</tt> file on the <tt>remote1</tt> system points to
the log file.</p><pre>remote1 # <tt><b>cat /etc/syslog.conf</b></tt>
&hellip;
audit.notice       /var/adm/auditlog</pre>

<a name="audittask-53"></a><h4>How to Change a User's Audit Characteristics</h4><a name="indexterm-3249"></a><a name="indexterm-3250"></a><a name="indexterm-3251"></a><a name="indexterm-3252"></a><p>Definitions for each user are stored in the <tt>audit_user</tt> database. These definitions modify,
for the specified user, the preselected classes in the <tt>audit_control</tt> file. The <tt>nsswitch.conf</tt>
file determines if a local file or if a name service database is
used. To calculate the user's final audit preselection mask, see <a href="auditref-55.html">Process Audit Characteristics</a>.</p><ol>
<li><b>Assume the Primary Administrator role, or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="audittask-stepopt-4"></a>(Optional) <b>Save a backup copy of the <tt>audit_user</tt> database.</b><pre># <tt><b>cp /etc/security/audit_user /etc/security/audit_user.orig</b></tt></pre></li>
<li><b>Add new entries to the <tt>audit_user</tt> database.</b><p>In the local database, each entry has the following format:</p><pre><i>username</i>:<i>always-audit</i>:<i>never-audit</i></pre><dl><dt><i>username</i></dt>
<dd><p>Selects the name of the user to be audited.</p></dd>
<dt><i>always-audit</i></dt>
<dd><p>Selects the list of audit classes that should always be audited for the specified user.</p></dd>
<dt><i>never-audit</i></dt>
<dd><p>Selects the list of audit classes that should never be audited for the specified user.</p></dd>
</dl>
<p>You can specify multiple classes by separating the audit classes with commas.</p><p>The <tt>audit_user</tt> entries are in effect at the user's next login.</p></li></ol><a name="audittask-75"></a><h6>Example&nbsp;30-7 Changing Which Events Are Audited for One User</h6><p>In this example, the <tt>audit_control</tt> file contains the preselected audit classes for the
system:</p><pre># audit_control file
&hellip;
flags:lo,ss
minfree:10
naflags:lo,na</pre><p>The <tt>audit_user</tt> file shows an exception. When the user <tt>jdoe</tt> uses a profile
shell, that use is audited:</p><pre># audit_user file
jdoe:pf</pre><p>The audit preselection mask for <tt>jdoe</tt> is a combination of the <tt>audit_user</tt> settings
with the <tt>audit_control</tt> settings. The <tt>auditconfig -getaudit</tt> command shows the preselection mask for <tt>jdoe</tt>:</p><pre># <tt><b>auditconfig -getaudit</b></tt>
audit id = jdoe(1234567)
process preselection mask = ss,pf,lo(0x13000,0x13000)
terminal id (maj,min,host) = 242,511,example1(192.168.160.171)
audit session id = 2138517656</pre><a name="audittask-35"></a><h6>Example&nbsp;30-8 Auditing Users Only, Not the System</h6><p>In this example, the login and role activities of four users only
are audited on this system. The <tt>audit_control</tt> file does not preselect audit classes for
the system:</p><pre># audit_control file
&hellip;
flags:
minfree:10
naflags:</pre><p>The <tt>audit_user</tt> file preselects two audit classes for four users:</p><pre># audit_user file
jdoe:lo,pf
kdoe:lo,pf
pdoe:lo,pf
sdoe:lo,pf</pre><p>The following <tt>audit_control</tt> file protects the system from unwarranted intrusion. In combination with
the <tt>audit_user</tt> file, this file protects the system more than the first <tt>audit_control</tt>
file in this example.</p><pre># audit_control file
&hellip;
flags:
minfree:10
naflags:lo</pre>

<a name="audittask-58"></a><h4>How to Add an Audit Class</h4><a name="indexterm-3253"></a><a name="indexterm-3254"></a><a name="indexterm-3255"></a><a name="indexterm-3256"></a><a name="indexterm-3257"></a><a name="indexterm-3258"></a><a name="indexterm-3259"></a><p>When you create your own audit class, you can place into it
just those audit events that you want to audit for your site. When
you add the class on one system, you should copy the change to
all systems that are being audited.</p><ol>
<li><b>Assume the Primary Administrator role, or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="audittask-stepopt-5"></a>(Optional) <b>Save a backup copy of the <tt>audit_class</tt> file.</b><pre># <tt><b>cp /etc/security/audit_class /etc/security/audit_class.orig</b></tt></pre></li>
<li><a name="audittask-addclass-1"></a><b>Add new entries to the <tt>audit_class</tt> file.</b><p>Each entry has the following format:</p><pre>0x<i>number</i>:<i>name</i>:<i>description</i></pre><dl><dt>0x</dt>
<dd><p>Identifies <i>number</i> as hexadecimal.</p></dd>
<dt><i>number</i></dt>
<dd><p>Defines the unique audit class mask.</p></dd>
<dt><i>name</i></dt>
<dd><p>Defines the letter name of the audit class.</p></dd>
<dt><i>description</i></dt>
<dd><p>Defines the descriptive name of the audit class.</p></dd>
</dl>
<p>The entry must be unique in the file. Do not use existing
audit class masks.</p></li></ol><a name="audittask-51"></a><h6>Example&nbsp;30-9 Creating a New Audit Class</h6><p>This example creates a class to hold a small set of audit
events. The added entry to the <tt>audit_class</tt> file is as follows:</p><pre>0x01000000:pf:profile command</pre><p>The entry creates a new audit class that is called <tt>pf</tt>. <a href="#audittask-43">Example&nbsp;30-10</a>
populates the new audit class.</p><h6>Troubleshooting</h6><p>If you have customized the <tt>audit_class</tt> database, make sure that any modifications to
<tt>audit_user</tt> are consistent with the new audit classes. Errors occur when the audit
classes in <tt>audit_user</tt> are not a subset of the <tt>audit_class</tt> database.</p>

<a name="audittask-59"></a><h4>How to Change an Audit Event's Class Membership</h4><a name="indexterm-3260"></a><a name="indexterm-3261"></a><a name="indexterm-3262"></a><a name="indexterm-3263"></a><p>You might want to change an audit event's class membership to reduce the
size of an existing audit class, or to place the event in
a class of its own. When you reconfigure audit event-class mappings on one
system, you should copy the change to all systems that are being audited.</p><ol>
<li><b>Assume the Primary Administrator role, or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="audittask-stepopt-1"></a>(Optional) <b>Save a backup copy of the <tt>audit_event</tt> file.</b><pre># <tt><b>cp /etc/security/audit_event /etc/security/audit_event.orig</b></tt></pre></li>
<li><b>Change the class to which particular events belong by changing the <i>class-list</i> of
the events.</b><p>Each entry has the following format:</p><pre><i>number</i>:<i>name</i>:<i>description</i>:<i>class-list</i></pre><dl><dt><i>number</i></dt>
<dd><p>Is the audit event ID.</p></dd>
<dt><i>name</i></dt>
<dd><p>Is the name of the audit event.</p></dd>
<dt><i>description</i></dt>
<dd><p>Typically, the system call or executable that triggers the creation of an audit record.</p></dd>
<dt><i>class-list</i></dt>
<dd><p>Is a comma-separated list of audit classes.</p></dd>
</dl>
</li></ol><a name="audittask-43"></a><h6>Example&nbsp;30-10 Mapping Existing Audit Events to a New Class</h6><p>This example maps an existing audit event to the new class that
was created in <a href="#audittask-51">Example&nbsp;30-9</a>. In the <tt>audit_control</tt> file, the binary audit record captures successes and
failures of events in the <tt>pf</tt> class. The <tt>syslog</tt> audit log contains
only failures of events in the <tt>pf</tt> class.</p><pre># <tt><b>grep pf | /etc/security/audit_class</b></tt>
0x01000000:pf:profile command
# <tt><b>vi /etc/security/audit_event</b></tt>
6180:AUE_prof_cmd:profile command:ua,as<tt><b>,pf</b></tt>
# <tt><b>vi audit_control</b></tt>
...
flags:lo<tt><b>,pf</b></tt>
plugin:name=audit_syslog.so.1; p_flags=-lo<tt><b>,-pf</b></tt></pre><a name="audittask-74"></a><h6>Example&nbsp;30-11 Auditing the Use of <tt>setuid</tt> Programs</h6><p>This example creates a class to hold events that monitor calls to
the <tt>setuid</tt> and <tt>setgid</tt> programs. The <tt>audit_control</tt> entries audit all successful invocations
of the events in the <tt>st</tt> class.</p><pre># <tt><b>vi /etc/security/audit_class</b></tt>
0x00000800:st:setuid class
# <tt><b>vi /etc/security/audit_event</b></tt>
26:AUE_SETGROUPS:setgroups(2):<tt><b>st</b></tt>
27:AUE_SETPGRP:setpgrp(2):<tt><b>st</b></tt>
40:AUE_SETREUID:setreuid(2):<tt><b>st</b></tt>
41:AUE_SETREGID:setregid(2):<tt><b>st</b></tt>
214:AUE_SETEGID:setegid(2):<tt><b>st</b></tt>
215:AUE_SETEUID:seteuid(2):<tt><b>st</b></tt>
# <tt><b>vi audit_control</b></tt>
...
flags:lo<tt><b>,+st</b></tt>
plugin:name=audit_syslog.so.1; p_flags=-lo<tt><b>,+st</b></tt></pre>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="audittask-15.html">Previous</a>
             </td>
             <td align="right">
                 <a href="audittask-4.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

