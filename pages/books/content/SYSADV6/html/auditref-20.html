<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Audit Record Structure - System Administration Guide: Security Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-08-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Security Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="auditref-77.html">Previous</a>
             </td>
             <td align="right">
                 <a href="aparecord-11.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="oview-1.html">Part&nbsp;I&nbsp;Security Overview</a></p>
<p class="toc level2"><a href="secov-1.html">1.&nbsp;&nbsp;Security Services (Overview)</a></p>
<p class="toc level1 tocsp"><a href="sectm-1.html">Part&nbsp;II&nbsp;System, File, and Device Security</a></p>
<p class="toc level2"><a href="concept-1.html">2.&nbsp;&nbsp;Managing Machine Security (Overview)</a></p>
<p class="toc level2"><a href="secsys-1.html">3.&nbsp;&nbsp;Controlling Access to Systems (Tasks)</a></p>
<p class="toc level2"><a href="vscan-1.html">4.&nbsp;&nbsp;Virus Scanning Service (Tasks)</a></p>
<p class="toc level2"><a href="devtask-1.html">5.&nbsp;&nbsp;Controlling Access to Devices (Tasks)</a></p>
<p class="toc level2"><a href="bart-1.html">6.&nbsp;&nbsp;Using the Basic Audit Reporting Tool (Tasks)</a></p>
<p class="toc level2"><a href="secfile-1.html">7.&nbsp;&nbsp;Controlling Access to Files (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="prbactm-1.html">Part&nbsp;III&nbsp;Roles, Rights Profiles, and Privileges</a></p>
<p class="toc level2"><a href="prbac-1.html">8.&nbsp;&nbsp;Using Roles and Privileges (Overview)</a></p>
<p class="toc level2"><a href="rbactask-1.html">9.&nbsp;&nbsp;Using Role-Based Access Control (Tasks)</a></p>
<p class="toc level2"><a href="rbacref-1.html">10.&nbsp;&nbsp;Role-Based Access Control (Reference)</a></p>
<p class="toc level2"><a href="privtask-1.html">11.&nbsp;&nbsp;Privileges (Tasks)</a></p>
<p class="toc level2"><a href="privref-1.html">12.&nbsp;&nbsp;Privileges (Reference)</a></p>
<p class="toc level1 tocsp"><a href="scftm-1.html">Part&nbsp;IV&nbsp;Solaris Cryptographic Services</a></p>
<p class="toc level2"><a href="scf-1.html">13.&nbsp;&nbsp;Solaris Cryptographic Framework (Overview)</a></p>
<p class="toc level2"><a href="scftask-1.html">14.&nbsp;&nbsp;Solaris Cryptographic Framework (Tasks)</a></p>
<p class="toc level2"><a href="kmf-1.html">15.&nbsp;&nbsp;Solaris Key Management Framework</a></p>
<p class="toc level1 tocsp"><a href="authtm-1.html">Part&nbsp;V&nbsp;Authentication Services and Secure Communication</a></p>
<p class="toc level2"><a href="auth-1.html">16.&nbsp;&nbsp;Using Authentication Services (Tasks)</a></p>
<p class="toc level2"><a href="pam-1.html">17.&nbsp;&nbsp;Using PAM</a></p>
<p class="toc level2"><a href="sasl-1.html">18.&nbsp;&nbsp;Using SASL</a></p>
<p class="toc level2"><a href="sshuser-1.html">19.&nbsp;&nbsp;Using Solaris Secure Shell (Tasks)</a></p>
<p class="toc level2"><a href="sshref-1.html">20.&nbsp;&nbsp;Solaris Secure Shell (Reference)</a></p>
<p class="toc level1 tocsp"><a href="seamtm-1.html">Part&nbsp;VI&nbsp;Kerberos Service</a></p>
<p class="toc level2"><a href="intro-1.html">21.&nbsp;&nbsp;Introduction to the Kerberos Service</a></p>
<p class="toc level2"><a href="seamplan-1.html">22.&nbsp;&nbsp;Planning for the Kerberos Service</a></p>
<p class="toc level2"><a href="setup-8.html">23.&nbsp;&nbsp;Configuring the Kerberos Service (Tasks)</a></p>
<p class="toc level2"><a href="trouble-1.html">24.&nbsp;&nbsp;Kerberos Error Messages and Troubleshooting</a></p>
<p class="toc level2"><a href="aadmin-1.html">25.&nbsp;&nbsp;Administering Kerberos Principals and Policies (Tasks)</a></p>
<p class="toc level2"><a href="user-7.html">26.&nbsp;&nbsp;Using Kerberos Applications (Tasks)</a></p>
<p class="toc level2"><a href="refer-1.html">27.&nbsp;&nbsp;The Kerberos Service (Reference)</a></p>
<p class="toc level1 tocsp"><a href="audittm-1.html">Part&nbsp;VII&nbsp;Solaris Auditing</a></p>
<p class="toc level2"><a href="auditov-1.html">28.&nbsp;&nbsp;Solaris Auditing (Overview)</a></p>
<p class="toc level2"><a href="auditplan-1.html">29.&nbsp;&nbsp;Planning for Solaris Auditing</a></p>
<p class="toc level2"><a href="audittask-1.html">30.&nbsp;&nbsp;Managing Solaris Auditing (Tasks)</a></p>
<p class="toc level2"><a href="auditref-1.html">31.&nbsp;&nbsp;Solaris Auditing (Reference)</a></p>
<p class="toc level3"><a href="auditref-36.html">Audit Commands</a></p>
<p class="toc level3"><a href="auditref-13.html">Files Used in the Auditing Service</a></p>
<p class="toc level3"><a href="auditref-22.html">Rights Profiles for Administering Auditing</a></p>
<p class="toc level3"><a href="auditref-28.html">Auditing and Solaris Zones</a></p>
<p class="toc level3"><a href="auditref-48.html">Audit Classes</a></p>
<p class="toc level3"><a href="auditref-74.html">Audit Policy</a></p>
<p class="toc level3"><a href="auditref-55.html">Process Audit Characteristics</a></p>
<p class="toc level3"><a href="auditref-75.html">Audit Trail</a></p>
<p class="toc level3"><a href="auditref-77.html">Conventions for Binary Audit File Names</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Audit Record Structure</a></p>
</div>
<p class="toc level3"><a href="aparecord-11.html">Audit Token Formats</a></p>
<p class="toc level1 tocsp"><a href="glossary-2.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="auditref-20"></a><h3>Audit Record Structure</h3>
<p><a name="indexterm-3678"></a><a name="indexterm-3679"></a><a name="indexterm-3680"></a>An audit record is a sequence of audit tokens. Each audit token contains
event information such as user ID, time, and date. A <tt>header</tt> token begins
an audit record, and an optional <tt>trailer</tt> token concludes the record. Other audit tokens
contain information relevant to the audit event. The following figure shows a typical
audit record.</p><a name="auditref-fig-4"></a><h6>Figure&nbsp;31-3 Typical Audit Record Structure</h6><img src="figures/7156.typauditrecord.gif" alt="Diagram shows a typical audit record structure, which includes a header token followed by an arg, a data, a subject, and a return token."></img>

<a name="auditref-24"></a><h4>Audit Record Analysis</h4>
<p>Audit record analysis involves postselecting records from the audit trail. You can use
one of two approaches to parsing the binary data that was collected.</p>
<ul><li><p>You can parse the binary data stream. To parse the data stream, you need to know the order of the fields in each token, and the order of tokens in each record. You also need to know the variants of an audit record. For example, the <tt>ioctl()</tt> system call creates an audit record for &ldquo;Bad file name&rdquo; that contains different tokens from the audit record for &ldquo;Invalid file descriptor&rdquo;.</p>
<ul><li><p>For a description of the order of binary data in each audit token, see the <a href="http://docs.sun.com/doc/819-2251/audit.log-4?a=view"><tt>audit.log</tt>(4)</a> man page.</p></li>
<li><p><a name="indexterm-3681"></a><a name="indexterm-3682"></a><a name="indexterm-3683"></a><a name="indexterm-3684"></a>For a description of the order of tokens in an audit record, use the <tt>bsmrecord</tt> command. Output from the <tt>bsmrecord</tt> command includes the different formats that occur under different conditions. Square brackets (<tt>[]</tt>) indicate that an audit token is optional. For more information, see the <a href="http://docs.sun.com/doc/819-2240/bsmrecord-1m?a=view"><tt>bsmrecord</tt>(1M)</a> man page. For examples, see also <a href="audittask-21.html#audittask-10">How to Display Audit Record Formats</a>.</p></li></ul>
</li>
<li><p>You can use the <tt>praudit</tt> command. Options to the command provide different text outputs. For example, the <tt>praudit -x</tt> command provides XML for input into scripts and browsers. <tt>praudit</tt> outputs do not include fields whose sole purpose is to help to parse the binary data. The outputs do not necessarily follow the order of the binary fields. Also, the order and format of <tt>praudit</tt> output is not guaranteed between Solaris releases.</p><p>For examples of <tt>praudit</tt> output, see <a href="audittask-21.html#audittask-22">How to View the Contents of Binary Audit Files</a>, and the <a href="http://docs.sun.com/doc/819-2240/praudit-1m?a=view"><tt>praudit</tt>(1M)</a> man page.</p><p>For a description of the <tt>praudit</tt> output for each audit token, see the individual tokens in the <a href="aparecord-11.html">Audit Token Formats</a> section.</p></li></ul>

         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="auditref-77.html">Previous</a>
             </td>
             <td align="right">
                 <a href="aparecord-11.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

