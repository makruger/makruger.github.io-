<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>PAM (Tasks) - System Administration Guide: Security Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-08-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Security Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="pam-2.html">Previous</a>
             </td>
             <td align="right">
                 <a href="pam-32.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="oview-1.html">Part&nbsp;I&nbsp;Security Overview</a></p>
<p class="toc level2"><a href="secov-1.html">1.&nbsp;&nbsp;Security Services (Overview)</a></p>
<p class="toc level1 tocsp"><a href="sectm-1.html">Part&nbsp;II&nbsp;System, File, and Device Security</a></p>
<p class="toc level2"><a href="concept-1.html">2.&nbsp;&nbsp;Managing Machine Security (Overview)</a></p>
<p class="toc level2"><a href="secsys-1.html">3.&nbsp;&nbsp;Controlling Access to Systems (Tasks)</a></p>
<p class="toc level2"><a href="vscan-1.html">4.&nbsp;&nbsp;Virus Scanning Service (Tasks)</a></p>
<p class="toc level2"><a href="devtask-1.html">5.&nbsp;&nbsp;Controlling Access to Devices (Tasks)</a></p>
<p class="toc level2"><a href="bart-1.html">6.&nbsp;&nbsp;Using the Basic Audit Reporting Tool (Tasks)</a></p>
<p class="toc level2"><a href="secfile-1.html">7.&nbsp;&nbsp;Controlling Access to Files (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="prbactm-1.html">Part&nbsp;III&nbsp;Roles, Rights Profiles, and Privileges</a></p>
<p class="toc level2"><a href="prbac-1.html">8.&nbsp;&nbsp;Using Roles and Privileges (Overview)</a></p>
<p class="toc level2"><a href="rbactask-1.html">9.&nbsp;&nbsp;Using Role-Based Access Control (Tasks)</a></p>
<p class="toc level2"><a href="rbacref-1.html">10.&nbsp;&nbsp;Role-Based Access Control (Reference)</a></p>
<p class="toc level2"><a href="privtask-1.html">11.&nbsp;&nbsp;Privileges (Tasks)</a></p>
<p class="toc level2"><a href="privref-1.html">12.&nbsp;&nbsp;Privileges (Reference)</a></p>
<p class="toc level1 tocsp"><a href="scftm-1.html">Part&nbsp;IV&nbsp;Solaris Cryptographic Services</a></p>
<p class="toc level2"><a href="scf-1.html">13.&nbsp;&nbsp;Solaris Cryptographic Framework (Overview)</a></p>
<p class="toc level2"><a href="scftask-1.html">14.&nbsp;&nbsp;Solaris Cryptographic Framework (Tasks)</a></p>
<p class="toc level2"><a href="kmf-1.html">15.&nbsp;&nbsp;Solaris Key Management Framework</a></p>
<p class="toc level1 tocsp"><a href="authtm-1.html">Part&nbsp;V&nbsp;Authentication Services and Secure Communication</a></p>
<p class="toc level2"><a href="auth-1.html">16.&nbsp;&nbsp;Using Authentication Services (Tasks)</a></p>
<p class="toc level2"><a href="pam-1.html">17.&nbsp;&nbsp;Using PAM</a></p>
<p class="toc level3"><a href="pam-2.html">PAM (Overview)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">PAM (Tasks)</a></p>
</div>
<p class="toc level3"><a href="pam-32.html">PAM Configuration (Reference)</a></p>
<p class="toc level2 tocsp"><a href="sasl-1.html">18.&nbsp;&nbsp;Using SASL</a></p>
<p class="toc level2"><a href="sshuser-1.html">19.&nbsp;&nbsp;Using Solaris Secure Shell (Tasks)</a></p>
<p class="toc level2"><a href="sshref-1.html">20.&nbsp;&nbsp;Solaris Secure Shell (Reference)</a></p>
<p class="toc level1 tocsp"><a href="seamtm-1.html">Part&nbsp;VI&nbsp;Kerberos Service</a></p>
<p class="toc level2"><a href="intro-1.html">21.&nbsp;&nbsp;Introduction to the Kerberos Service</a></p>
<p class="toc level2"><a href="seamplan-1.html">22.&nbsp;&nbsp;Planning for the Kerberos Service</a></p>
<p class="toc level2"><a href="setup-8.html">23.&nbsp;&nbsp;Configuring the Kerberos Service (Tasks)</a></p>
<p class="toc level2"><a href="trouble-1.html">24.&nbsp;&nbsp;Kerberos Error Messages and Troubleshooting</a></p>
<p class="toc level2"><a href="aadmin-1.html">25.&nbsp;&nbsp;Administering Kerberos Principals and Policies (Tasks)</a></p>
<p class="toc level2"><a href="user-7.html">26.&nbsp;&nbsp;Using Kerberos Applications (Tasks)</a></p>
<p class="toc level2"><a href="refer-1.html">27.&nbsp;&nbsp;The Kerberos Service (Reference)</a></p>
<p class="toc level1 tocsp"><a href="audittm-1.html">Part&nbsp;VII&nbsp;Solaris Auditing</a></p>
<p class="toc level2"><a href="auditov-1.html">28.&nbsp;&nbsp;Solaris Auditing (Overview)</a></p>
<p class="toc level2"><a href="auditplan-1.html">29.&nbsp;&nbsp;Planning for Solaris Auditing</a></p>
<p class="toc level2"><a href="audittask-1.html">30.&nbsp;&nbsp;Managing Solaris Auditing (Tasks)</a></p>
<p class="toc level2"><a href="auditref-1.html">31.&nbsp;&nbsp;Solaris Auditing (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-2.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="pam-11"></a><h3>PAM (Tasks)</h3>
<p><a name="indexterm-1963"></a><a name="indexterm-1964"></a>This section discusses some tasks that might be required to make the PAM
framework use a particular security policy. You should be aware of some security
issues that are associated with the PAM configuration file. For information about the
security issues, see <a href="#pam-13">Planning for Your PAM Implementation</a>.</p>

<a name="esqbh"></a><h4>PAM (Task Map)</h4>
<table><col width="27%"><col width="42%"><col width="30%"><tr><th align="left" valign="top" scope="column"><p>Task</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>For Instructions</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Plan for your PAM installation.</p></td>
<td align="left" valign="top" scope="row"><p>Consider configuration issues and
make decisions about them before you start the software configuration process.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#pam-13">Planning for Your PAM Implementation</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Add new PAM
modules.</p></td>
<td align="left" valign="top" scope="row"><p>Sometimes, site-specific modules must be written and installed to cover requirements that are
not part of the generic software. This procedure explains how to install these
new PAM modules.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#pam-14">How to Add a PAM Module</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Block access through <tt>~/.rhosts</tt>.</p></td>
<td align="left" valign="top" scope="row"><p>Further increase security by preventing access through
<tt>~/.rhosts</tt>.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#ewaws">How to Prevent Rhost-Style Access From Remote Systems With PAM</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Initiate error logging.</p></td>
<td align="left" valign="top" scope="row"><p>Start the logging of PAM error messages through <tt>syslog</tt>.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#pam-23">How to Log PAM Error Reports</a></p></td>
</tr>
</table>

<a name="pam-13"></a><h4>Planning for Your PAM Implementation</h4>
<p><a name="indexterm-1965"></a><a name="indexterm-1966"></a>As delivered, the <tt>pam.conf</tt> configuration file implements the standard Solaris security policy. This
policy should work in many situations. If you need to implement a different
security policy, here are the issues that you should focus on:</p>
<ul><li><p>Determine what your needs are, especially which PAM service modules you should select.</p></li>
<li><p>Identify the services that need special configuration options. Use <tt>other</tt> if appropriate.</p></li>
<li><p>Decide the order in which the modules should be run.</p></li>
<li><p>Select the control flag for each module. See <a href="pam-32.html#pam-15">How PAM Stacking Works</a> for more information about all of the control flags.</p></li>
<li><p>Choose any options that are necessary for each module. The man page for each module should list any special options.</p></li></ul>
<p>Here are some suggestions to consider before you change the PAM configuration file:</p>
<ul><li><p>Use <tt>other</tt> entries for each module type so that every application does not have to be included in <tt>/etc/pam.conf</tt>.</p></li>
<li><p>Make sure to consider the security implications of the <tt>binding</tt>, <tt>sufficient</tt>, and <tt>optional</tt> control flags.</p></li>
<li><p>Review the man pages that are associated with the modules. These man pages can help you understand how each module functions, what options are available, and the interactions between stacked modules.</p>
<hr><p><b>Caution - </b>If the PAM configuration file is misconfigured or the file becomes corrupted, no user might be able to log in. Because the <tt>sulogin</tt> command does not use PAM, the root password would then be required to boot the machine into single-user mode and fix the problem.</p>
<hr>
<p>After you change the <tt>/etc/pam.conf</tt> file, review the file as much as possible while you still have system access to correct problems. Test all the commands that might have been affected by your changes. An example is adding a new module to the <tt>telnet</tt> service. In this example, you would use the <tt>telnet</tt> command and verify that your changes make the service behave as expected.</p></li></ul>


<a name="pam-14"></a><h4>How to Add a PAM Module</h4><a name="indexterm-1967"></a><a name="indexterm-1968"></a><p>This procedure shows how to add a new PAM module. New modules
can be created to cover site-specific security policies or to support third party applications.</p><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="rbactask-15.html">Configuring RBAC (Task Map)</a>.</p></li>
<li><a name="pam-step-17"></a><b>Determine which control flags and which other options should be used.</b><p>Refer to <a href="pam-32.html#pam-15">How PAM Stacking Works</a> for information on the control flags.</p></li>
<li><a name="pam-step-19"></a><b>Ensure that the ownership and permissions are set so that the module file
is owned by <tt>root</tt> and the permissions are <tt>555</tt>.</b></li>
<li><a name="pam-step-20"></a><b>Edit the PAM configuration file, <tt>/etc/pam.conf</tt>, and add this module to the
appropriate services.</b></li>
<li><b>Verify that the module has been added properly.</b><p>You must test <b>before</b> the system is rebooted in case the configuration file is
misconfigured. Login using a direct service, such as <tt>ssh</tt>, and run the <tt>su</tt>
command, before you reboot the system. The service might be a daemon that
is spawned only once when the system is booted. Then, you must reboot
the system before you can verify that the module has been added.</p></li></ol>

<a name="ewaws"></a><h4>How to Prevent Rhost-Style Access From Remote Systems With PAM</h4><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="rbactask-15.html">Configuring RBAC (Task Map)</a>.</p></li>
<li><b>Remove all of the lines that include <tt>rhosts_auth.so.1</tt> from the PAM configuration file.</b><p>This step prevents the reading of the <tt>~/.rhosts</tt> files during an <tt>rlogin</tt> session. Therefore,
this step prevents unauthenticated access to the local system from remote systems. All
<tt>rlogin</tt> access requires a password, regardless of the presence or contents of any
<tt>~/.rhosts</tt> or <tt>/etc/hosts.equiv</tt> files.</p></li>
<li><b>Disable the <tt>rsh</tt> service.</b><p>To prevent other unauthenticated access to the <tt>~/.rhosts</tt> files, remember to disable the <tt>rsh</tt>
service. </p><pre># <tt><b>svcadm disable network/shell</b></tt></pre></li></ol>

<a name="pam-23"></a><h4>How to Log PAM Error Reports</h4><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="rbactask-15.html">Configuring RBAC (Task Map)</a>.</p></li>
<li><a name="pam-step-25"></a><b><a name="indexterm-1969"></a><a name="indexterm-1970"></a>Configure the <tt>/etc/syslog.conf</tt> file for the level of logging that you need.</b><p>See the <a href="http://docs.sun.com/doc/819-2251/syslog.conf-4?a=view"><tt>syslog.conf</tt>(4)</a> for more information about the logging levels.</p></li>
<li><a name="pam-step-26"></a><b>Refresh the configuration information for the <tt>syslog</tt> daemon.</b><pre># <tt><b>svcadm refresh system/system-log</b></tt></pre></li></ol>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="pam-2.html">Previous</a>
             </td>
             <td align="right">
                 <a href="pam-32.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

