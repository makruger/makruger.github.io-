<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Audit Classes - System Administration Guide: Security Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-08-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Security Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="auditref-28.html">Previous</a>
             </td>
             <td align="right">
                 <a href="auditref-74.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="oview-1.html">Part&nbsp;I&nbsp;Security Overview</a></p>
<p class="toc level2"><a href="secov-1.html">1.&nbsp;&nbsp;Security Services (Overview)</a></p>
<p class="toc level1 tocsp"><a href="sectm-1.html">Part&nbsp;II&nbsp;System, File, and Device Security</a></p>
<p class="toc level2"><a href="concept-1.html">2.&nbsp;&nbsp;Managing Machine Security (Overview)</a></p>
<p class="toc level2"><a href="secsys-1.html">3.&nbsp;&nbsp;Controlling Access to Systems (Tasks)</a></p>
<p class="toc level2"><a href="vscan-1.html">4.&nbsp;&nbsp;Virus Scanning Service (Tasks)</a></p>
<p class="toc level2"><a href="devtask-1.html">5.&nbsp;&nbsp;Controlling Access to Devices (Tasks)</a></p>
<p class="toc level2"><a href="bart-1.html">6.&nbsp;&nbsp;Using the Basic Audit Reporting Tool (Tasks)</a></p>
<p class="toc level2"><a href="secfile-1.html">7.&nbsp;&nbsp;Controlling Access to Files (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="prbactm-1.html">Part&nbsp;III&nbsp;Roles, Rights Profiles, and Privileges</a></p>
<p class="toc level2"><a href="prbac-1.html">8.&nbsp;&nbsp;Using Roles and Privileges (Overview)</a></p>
<p class="toc level2"><a href="rbactask-1.html">9.&nbsp;&nbsp;Using Role-Based Access Control (Tasks)</a></p>
<p class="toc level2"><a href="rbacref-1.html">10.&nbsp;&nbsp;Role-Based Access Control (Reference)</a></p>
<p class="toc level2"><a href="privtask-1.html">11.&nbsp;&nbsp;Privileges (Tasks)</a></p>
<p class="toc level2"><a href="privref-1.html">12.&nbsp;&nbsp;Privileges (Reference)</a></p>
<p class="toc level1 tocsp"><a href="scftm-1.html">Part&nbsp;IV&nbsp;Solaris Cryptographic Services</a></p>
<p class="toc level2"><a href="scf-1.html">13.&nbsp;&nbsp;Solaris Cryptographic Framework (Overview)</a></p>
<p class="toc level2"><a href="scftask-1.html">14.&nbsp;&nbsp;Solaris Cryptographic Framework (Tasks)</a></p>
<p class="toc level2"><a href="kmf-1.html">15.&nbsp;&nbsp;Solaris Key Management Framework</a></p>
<p class="toc level1 tocsp"><a href="authtm-1.html">Part&nbsp;V&nbsp;Authentication Services and Secure Communication</a></p>
<p class="toc level2"><a href="auth-1.html">16.&nbsp;&nbsp;Using Authentication Services (Tasks)</a></p>
<p class="toc level2"><a href="pam-1.html">17.&nbsp;&nbsp;Using PAM</a></p>
<p class="toc level2"><a href="sasl-1.html">18.&nbsp;&nbsp;Using SASL</a></p>
<p class="toc level2"><a href="sshuser-1.html">19.&nbsp;&nbsp;Using Solaris Secure Shell (Tasks)</a></p>
<p class="toc level2"><a href="sshref-1.html">20.&nbsp;&nbsp;Solaris Secure Shell (Reference)</a></p>
<p class="toc level1 tocsp"><a href="seamtm-1.html">Part&nbsp;VI&nbsp;Kerberos Service</a></p>
<p class="toc level2"><a href="intro-1.html">21.&nbsp;&nbsp;Introduction to the Kerberos Service</a></p>
<p class="toc level2"><a href="seamplan-1.html">22.&nbsp;&nbsp;Planning for the Kerberos Service</a></p>
<p class="toc level2"><a href="setup-8.html">23.&nbsp;&nbsp;Configuring the Kerberos Service (Tasks)</a></p>
<p class="toc level2"><a href="trouble-1.html">24.&nbsp;&nbsp;Kerberos Error Messages and Troubleshooting</a></p>
<p class="toc level2"><a href="aadmin-1.html">25.&nbsp;&nbsp;Administering Kerberos Principals and Policies (Tasks)</a></p>
<p class="toc level2"><a href="user-7.html">26.&nbsp;&nbsp;Using Kerberos Applications (Tasks)</a></p>
<p class="toc level2"><a href="refer-1.html">27.&nbsp;&nbsp;The Kerberos Service (Reference)</a></p>
<p class="toc level1 tocsp"><a href="audittm-1.html">Part&nbsp;VII&nbsp;Solaris Auditing</a></p>
<p class="toc level2"><a href="auditov-1.html">28.&nbsp;&nbsp;Solaris Auditing (Overview)</a></p>
<p class="toc level2"><a href="auditplan-1.html">29.&nbsp;&nbsp;Planning for Solaris Auditing</a></p>
<p class="toc level2"><a href="audittask-1.html">30.&nbsp;&nbsp;Managing Solaris Auditing (Tasks)</a></p>
<p class="toc level2"><a href="auditref-1.html">31.&nbsp;&nbsp;Solaris Auditing (Reference)</a></p>
<p class="toc level3"><a href="auditref-36.html">Audit Commands</a></p>
<p class="toc level3"><a href="auditref-13.html">Files Used in the Auditing Service</a></p>
<p class="toc level3"><a href="auditref-22.html">Rights Profiles for Administering Auditing</a></p>
<p class="toc level3"><a href="auditref-28.html">Auditing and Solaris Zones</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Audit Classes</a></p>
</div>
<p class="toc level3"><a href="auditref-74.html">Audit Policy</a></p>
<p class="toc level3"><a href="auditref-55.html">Process Audit Characteristics</a></p>
<p class="toc level3"><a href="auditref-75.html">Audit Trail</a></p>
<p class="toc level3"><a href="auditref-77.html">Conventions for Binary Audit File Names</a></p>
<p class="toc level3"><a href="auditref-20.html">Audit Record Structure</a></p>
<p class="toc level3"><a href="aparecord-11.html">Audit Token Formats</a></p>
<p class="toc level1 tocsp"><a href="glossary-2.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="auditref-48"></a><h3>Audit Classes</h3>
<p><a name="indexterm-3586"></a><a name="indexterm-3587"></a><a name="indexterm-3588"></a>System-wide defaults for Solaris auditing are preselected by specifying one or more classes of
events. The classes are preselected for each system in the system's <tt>audit_control</tt>
file. Anyone who uses the system is audited for these classes of events.
The file is described in <a href="auditref-13.html#auditref-12"><tt>audit_control</tt> File</a>.</p><p>You can configure audit classes and make new audit classes. Audit class names
can be up to 8 characters in length. The class description is
limited to 72 characters. Numeric and non-alphanumeric characters are allowed.</p><p><a name="indexterm-3589"></a>You can modify what is audited for individual users by adding audit classes
to a user's entry in the <tt>audit_user</tt> database. The audit classes are also used
as arguments to the <tt>auditconfig</tt> command. For details, see the <a href="http://docs.sun.com/doc/819-2240/auditconfig-1m?a=view"><tt>auditconfig</tt>(1M)</a> man page.</p>

<a name="auditref-49"></a><h4>Definitions of Audit Classes</h4>
<p><a name="indexterm-3590"></a><a name="indexterm-3591"></a><a name="indexterm-3592"></a>The following table shows each predefined audit class, the descriptive name for each
audit class, and a short description.</p><a name="auditref-tbl-2"></a><h6>Table&nbsp;31-1 Predefined Audit Classes</h6><table><col width="12%"><col width="25%"><col width="62%"><tr><th align="left" valign="top" scope="column"><p>Audit Class</p></th>
<th align="left" valign="top" scope="column"><p>Descriptive Name</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>all</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3593"></a><tt>all</tt></p></td>
<td align="left" valign="top" scope="row"><p>All classes (meta-class)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>no</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3594"></a><tt>no_class</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3595"></a>Null value for turning
off event preselection</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>na</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3596"></a><tt>non_attrib</tt></p></td>
<td align="left" valign="top" scope="row"><p>Nonattributable events</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>fr</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3597"></a><tt>file_read</tt></p></td>
<td align="left" valign="top" scope="row"><p>Read of data, open for reading</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>fw</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3598"></a><tt>file_write</tt></p></td>
<td align="left" valign="top" scope="row"><p>Write of data, open
for writing</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>fa</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3599"></a><tt>file_attr_acc</tt></p></td>
<td align="left" valign="top" scope="row"><p>Access of object attributes: <tt>stat</tt>, <tt>pathconf</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>fm</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3600"></a><tt>file_attr_mod</tt></p></td>
<td align="left" valign="top" scope="row"><p>Change of object attributes: <tt>chown</tt>, <tt>flock</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>fc</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3601"></a><tt>file_creation</tt></p></td>
<td align="left" valign="top" scope="row"><p>Creation
of object</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>fd</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3602"></a><tt>file_deletion</tt></p></td>
<td align="left" valign="top" scope="row"><p>Deletion of object</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>cl</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3603"></a><tt>file_close</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3604"></a><tt>close</tt> system call</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>ap</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3605"></a><tt>application</tt></p></td>
<td align="left" valign="top" scope="row"><p>Application-defined event</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>ad</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3606"></a><tt>administrative</tt></p></td>
<td align="left" valign="top" scope="row"><p>Administrative actions (old administrative meta-class)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>am</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3607"></a><tt>administrative</tt></p></td>
<td align="left" valign="top" scope="row"><p>Administrative actions
(meta-class)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>ss</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3608"></a><tt>system state</tt></p></td>
<td align="left" valign="top" scope="row"><p>Change system state</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>as</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3609"></a><tt>system-wide administration</tt></p></td>
<td align="left" valign="top" scope="row"><p>System-wide administration</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>ua</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3610"></a><tt>user administration</tt></p></td>
<td align="left" valign="top" scope="row"><p>User administration</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>aa</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3611"></a><tt>audit administration</tt></p></td>
<td align="left" valign="top" scope="row"><p>Audit utilization</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>ps</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3612"></a><tt>process start</tt></p></td>
<td align="left" valign="top" scope="row"><p>Process start and process stop</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>pm</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3613"></a><tt>process modify</tt></p></td>
<td align="left" valign="top" scope="row"><p>Process modify</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>pc</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3614"></a><tt>process</tt></p></td>
<td align="left" valign="top" scope="row"><p>Process (meta-class)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>ex</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3615"></a><tt>exec</tt></p></td>
<td align="left" valign="top" scope="row"><p>Program
execution</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>io</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3616"></a><tt>ioctl</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3617"></a><a name="indexterm-3618"></a><tt>ioctl()</tt> system call</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>ip</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3619"></a><tt>ipc</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3620"></a>System V IPC operations</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>lo</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3621"></a><tt>login_logout</tt></p></td>
<td align="left" valign="top" scope="row"><p>Login and logout events</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>nt</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3622"></a><tt>network</tt></p></td>
<td align="left" valign="top" scope="row"><p>Network events: <tt>bind</tt>, <tt>connect</tt>,
<tt>accept</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>ot</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3623"></a><tt>other</tt></p></td>
<td align="left" valign="top" scope="row"><p>Miscellaneous, such as device allocation and <tt>memcntl()</tt></p></td>
</tr>
</table><p>You can define new classes by modifying the <tt>/etc/security/audit_class</tt> file. You can
also rename existing classes. For more information, see the <a href="http://docs.sun.com/doc/819-2251/audit-class-4?a=view"><tt>audit_class</tt>(4)</a> man page.</p>

<a name="auditref-51"></a><h4>Audit Class Syntax</h4>
<p><a name="indexterm-3624"></a><a name="indexterm-3625"></a><a name="indexterm-3626"></a><a name="indexterm-3627"></a><a name="indexterm-3628"></a><a name="indexterm-3629"></a><a name="indexterm-3630"></a><a name="indexterm-3631"></a><a name="indexterm-3632"></a>Events can be audited for success, events can be audited for failure, and
events can be audited for both. Without a prefix, a class of events
is audited for success and for failure. With a plus (<tt>+</tt>) prefix, a
class of events is audited for success only. With a minus (<tt>-</tt>) prefix, a
class of events is audited for failure only. The following table shows some
possible representations of audit classes.</p><a name="auditref-tbl-3"></a><h6>Table&nbsp;31-2 Plus and Minus Prefixes to Audit Classes</h6><table><col width="20%"><col width="80%"><tr><th align="left" valign="top" scope="column"><p><tt>[</tt><i>prefix</i><tt>]</tt><i>class</i></p></th>
<th align="left" valign="top" scope="column"><p>Explanation</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>lo</tt></p></td>
<td align="left" valign="top" scope="row"><p>Audit all successful attempts to log in and
log out, and all failed attempts to log in. A user cannot fail
an attempt to log out.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>+lo</tt></p></td>
<td align="left" valign="top" scope="row"><p>Audit all successful attempts to log in and
log out.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>-all</tt></p></td>
<td align="left" valign="top" scope="row"><p>Audit all failed events.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>+all</tt></p></td>
<td align="left" valign="top" scope="row"><p>Audit all successful events.</p></td>
</tr>
</table>
<hr><p><b>Caution - </b><a name="indexterm-3633"></a><a name="indexterm-3634"></a>The <tt>all</tt> class can generate large amounts of data and quickly fill audit
file systems. Use the <tt>all</tt> class only if you have extraordinary reasons to audit
all activities.</p>
<hr>
<p><a name="indexterm-3635"></a><a name="indexterm-3636"></a><a name="indexterm-3637"></a><a name="indexterm-3638"></a><a name="indexterm-3639"></a><a name="indexterm-3640"></a>Audit classes that were previously selected can be further modified by a caret
prefix, <tt>^</tt>. The following table shows how the caret prefix modifies a preselected
audit class.</p><a name="auditref-tbl-4"></a><h6>Table&nbsp;31-3 Caret Prefix That Modifies Already-Specified Audit Classes</h6><table><col width="14%"><col width="85%"><tr><th align="left" valign="top" scope="column"><p><tt>^</tt>[<i>prefix</i>]<i>class</i></p></th>
<th align="left" valign="top" scope="column"><p>Explanation</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>-all,^-fc</tt></p></td>
<td align="left" valign="top" scope="row"><p>Audit all failed events, except do not audit failed attempts to
create file objects</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>am,^+aa</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-3641"></a>Audit all administrative events for success and for failure, except do not
audit successful attempts to administer auditing</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>am,^ua</tt></p></td>
<td align="left" valign="top" scope="row"><p>Audit all administrative events for success and
for failure, except do not audit user administration events</p></td>
</tr>
</table><p>The audit classes and their prefixes can be used in the following
files and commands:</p>
<ul><li><p>In the <tt>flags</tt> line in the <tt>audit_control</tt> file</p></li>
<li><p>In the <tt>plugin ...p_flags=</tt> line in the <tt>audit_control</tt> file</p></li>
<li><p>In the user's entry in the <tt>audit_user</tt> database</p></li>
<li><p>As arguments to <tt>auditconfig</tt> command options</p></li></ul>
<p>See <a href="auditref-13.html#auditref-12"><tt>audit_control</tt> File</a> for an example of using the prefixes in the <tt>audit_control</tt> file.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="auditref-28.html">Previous</a>
             </td>
             <td align="right">
                 <a href="auditref-74.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

