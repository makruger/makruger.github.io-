<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>BART Manifest, Rules File, and Reporting (Reference) - System Administration Guide: Security Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-08-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Security Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="bart-4.html">Previous</a>
             </td>
             <td align="right">
                 <a href="secfile-1.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="oview-1.html">Part&nbsp;I&nbsp;Security Overview</a></p>
<p class="toc level2"><a href="secov-1.html">1.&nbsp;&nbsp;Security Services (Overview)</a></p>
<p class="toc level1 tocsp"><a href="sectm-1.html">Part&nbsp;II&nbsp;System, File, and Device Security</a></p>
<p class="toc level2"><a href="concept-1.html">2.&nbsp;&nbsp;Managing Machine Security (Overview)</a></p>
<p class="toc level2"><a href="secsys-1.html">3.&nbsp;&nbsp;Controlling Access to Systems (Tasks)</a></p>
<p class="toc level2"><a href="vscan-1.html">4.&nbsp;&nbsp;Virus Scanning Service (Tasks)</a></p>
<p class="toc level2"><a href="devtask-1.html">5.&nbsp;&nbsp;Controlling Access to Devices (Tasks)</a></p>
<p class="toc level2"><a href="bart-1.html">6.&nbsp;&nbsp;Using the Basic Audit Reporting Tool (Tasks)</a></p>
<p class="toc level3"><a href="bart-2.html">Basic Audit Reporting Tool (Overview)</a></p>
<p class="toc level3"><a href="bart-1zyx.html">Using BART (Task Map)</a></p>
<p class="toc level3"><a href="bart-4.html">Using BART (Tasks)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">BART Manifest, Rules File, and Reporting (Reference)</a></p>
</div>
<p class="toc level2 tocsp"><a href="secfile-1.html">7.&nbsp;&nbsp;Controlling Access to Files (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="prbactm-1.html">Part&nbsp;III&nbsp;Roles, Rights Profiles, and Privileges</a></p>
<p class="toc level2"><a href="prbac-1.html">8.&nbsp;&nbsp;Using Roles and Privileges (Overview)</a></p>
<p class="toc level2"><a href="rbactask-1.html">9.&nbsp;&nbsp;Using Role-Based Access Control (Tasks)</a></p>
<p class="toc level2"><a href="rbacref-1.html">10.&nbsp;&nbsp;Role-Based Access Control (Reference)</a></p>
<p class="toc level2"><a href="privtask-1.html">11.&nbsp;&nbsp;Privileges (Tasks)</a></p>
<p class="toc level2"><a href="privref-1.html">12.&nbsp;&nbsp;Privileges (Reference)</a></p>
<p class="toc level1 tocsp"><a href="scftm-1.html">Part&nbsp;IV&nbsp;Solaris Cryptographic Services</a></p>
<p class="toc level2"><a href="scf-1.html">13.&nbsp;&nbsp;Solaris Cryptographic Framework (Overview)</a></p>
<p class="toc level2"><a href="scftask-1.html">14.&nbsp;&nbsp;Solaris Cryptographic Framework (Tasks)</a></p>
<p class="toc level2"><a href="kmf-1.html">15.&nbsp;&nbsp;Solaris Key Management Framework</a></p>
<p class="toc level1 tocsp"><a href="authtm-1.html">Part&nbsp;V&nbsp;Authentication Services and Secure Communication</a></p>
<p class="toc level2"><a href="auth-1.html">16.&nbsp;&nbsp;Using Authentication Services (Tasks)</a></p>
<p class="toc level2"><a href="pam-1.html">17.&nbsp;&nbsp;Using PAM</a></p>
<p class="toc level2"><a href="sasl-1.html">18.&nbsp;&nbsp;Using SASL</a></p>
<p class="toc level2"><a href="sshuser-1.html">19.&nbsp;&nbsp;Using Solaris Secure Shell (Tasks)</a></p>
<p class="toc level2"><a href="sshref-1.html">20.&nbsp;&nbsp;Solaris Secure Shell (Reference)</a></p>
<p class="toc level1 tocsp"><a href="seamtm-1.html">Part&nbsp;VI&nbsp;Kerberos Service</a></p>
<p class="toc level2"><a href="intro-1.html">21.&nbsp;&nbsp;Introduction to the Kerberos Service</a></p>
<p class="toc level2"><a href="seamplan-1.html">22.&nbsp;&nbsp;Planning for the Kerberos Service</a></p>
<p class="toc level2"><a href="setup-8.html">23.&nbsp;&nbsp;Configuring the Kerberos Service (Tasks)</a></p>
<p class="toc level2"><a href="trouble-1.html">24.&nbsp;&nbsp;Kerberos Error Messages and Troubleshooting</a></p>
<p class="toc level2"><a href="aadmin-1.html">25.&nbsp;&nbsp;Administering Kerberos Principals and Policies (Tasks)</a></p>
<p class="toc level2"><a href="user-7.html">26.&nbsp;&nbsp;Using Kerberos Applications (Tasks)</a></p>
<p class="toc level2"><a href="refer-1.html">27.&nbsp;&nbsp;The Kerberos Service (Reference)</a></p>
<p class="toc level1 tocsp"><a href="audittm-1.html">Part&nbsp;VII&nbsp;Solaris Auditing</a></p>
<p class="toc level2"><a href="auditov-1.html">28.&nbsp;&nbsp;Solaris Auditing (Overview)</a></p>
<p class="toc level2"><a href="auditplan-1.html">29.&nbsp;&nbsp;Planning for Solaris Auditing</a></p>
<p class="toc level2"><a href="audittask-1.html">30.&nbsp;&nbsp;Managing Solaris Auditing (Tasks)</a></p>
<p class="toc level2"><a href="auditref-1.html">31.&nbsp;&nbsp;Solaris Auditing (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-2.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="bart-13"></a><h3>BART Manifest, Rules File, and Reporting (Reference)</h3>
<p>This section includes the following reference information:</p>
<ul><li><p><a href="#bart-14">BART Manifest File Format</a></p></li>
<li><p><a href="#bart-18">BART Rules File Format</a></p></li>
<li><p><a href="#bart-25xyz">BART Reporting</a></p></li></ul>


<a name="bart-14"></a><h4>BART Manifest File Format</h4>
<a name="indexterm-700"></a><a name="indexterm-701"></a><a name="indexterm-702"></a><p>Each manifest file entry is a single line, depending on the file
type. Each entry begins with <b>fname</b>, which is the name of the file. To
prevent parsing problems that are caused by special characters embedded in file names,
the file names are encoded. For more information, see <a href="#bart-18">BART Rules File Format</a>.</p><p>Subsequent fields represent the following file attributes:</p><dl><dt><b>type</b></dt>
<dd><p>Type of file with the following possible values:</p>
<ul><li><p>B for a block device node</p></li>
<li><p>C for a character device node</p></li>
<li><p>D for a directory </p></li>
<li><p>F for a file</p></li>
<li><p>L for a symbolic link</p></li>
<li><p>P for a pipe</p></li>
<li><p>S for a socket</p></li></ul>
</dd>
<dt><b>size</b></dt>
<dd><p>File size in bytes.</p></dd>
<dt><b>mode</b></dt>
<dd><p>Octal number that represents the permissions of the file.</p></dd>
<dt><b>acl</b></dt>
<dd><p>ACL attributes for the file. For a file with ACL attributes, this contains the output from <tt>acltotext()</tt>.</p></dd>
<dt><b>uid</b></dt>
<dd><p>Numerical user ID of the owner of this entry.</p></dd>
<dt><b>gid</b></dt>
<dd><p>Numerical group ID of the owner of this entry.</p></dd>
<dt><b>dirmtime</b></dt>
<dd><p>Last modification time, in seconds, since 00:00:00 UTC, January 1, 1970, for directories.</p></dd>
<dt><b>lnmtime</b></dt>
<dd><p>Last modification time, in seconds, since 00:00:00 UTC, January 1, 1970, for links.</p></dd>
<dt><b>mtime</b></dt>
<dd><p>Last modification time, in seconds, since 00:00:00 UTC January 1, 1970, for files.</p></dd>
<dt><i>contents</i></dt>
<dd><p>Checksum value of the file. This attribute is only specified for regular files. If you turn off context checking, or if checksums cannot be computed, the value of this field is <tt>&ndash;</tt>.</p></dd>
<dt><i>dest</i></dt>
<dd><p>Destination of a symbolic link.</p></dd>
<dt><i>devnode</i></dt>
<dd><p>Value of the device node. This attribute is for character device files and block device files only.</p></dd>
</dl>
<p>For more information about BART manifests, see the <a href="http://docs.sun.com/doc/819-2251/bart-manifest-4?a=view"><tt>bart_manifest</tt>(4)</a> man page.</p>

<a name="bart-18"></a><h4>BART Rules File Format</h4>
<a name="indexterm-703"></a><p>The input files to the <tt>bart</tt> command are text files. These files consist
of lines that specify which files are to be included in the manifest
and which file attributes are to be included the report. The same input
file can be used across both pieces of BART functionality. Lines that begin
with <tt>#</tt>, blank lines, and lines that contain white space are ignored by
the tool.</p><p>The input files have three types of directives:</p>
<ul><li><p>Subtree directive, with optional pattern matching modifiers</p></li>
<li><p><tt>CHECK</tt> directive</p></li>
<li><p><tt>IGNORE</tt> directive</p></li></ul>
<a name="egysv"></a><h6>Example&nbsp;6-8 Rules File Format</h6><pre>&lt;Global CHECK/IGNORE Directives&gt;
&lt;subtree1&gt; [pattern1..]
&lt;IGNORE/CHECK Directives for subtree1&gt;

&lt;subtree2&gt; [pattern2..]
&lt;subtree3&gt; [pattern3..]
&lt;subtree4&gt; [pattern4..]
&lt;IGNORE/CHECK Directives for subtree2, subtree3, subtree4&gt;</pre>
<hr><p><b>Note - </b>All directives are read in order, with later directives possibly overriding earlier directives.</p>
<hr>
<p>There is one subtree directive per line. The directive <b>must</b> begin with an
absolute pathname, followed by zero or more pattern matching statements.</p>

<a name="bart-22bbb"></a><h5>Rules File Attributes</h5>
<a name="indexterm-704"></a><p>The <tt>bart</tt> command uses <tt>CHECK</tt> and <tt>IGNORE</tt> statements to define which attributes
to track or ignore. Each attribute has an associated keyword.</p><p><a name="indexterm-705"></a><a name="indexterm-706"></a>The attribute <b>keywords</b> are as follows:</p>
<ul><li><p><tt>acl</tt></p></li>
<li><p><tt>all</tt></p></li>
<li><p><tt>contents</tt></p></li>
<li><p><tt>dest</tt></p></li>
<li><p><tt>devnode</tt></p></li>
<li><p><tt>dirmtime</tt></p></li>
<li><p><tt>gid</tt></p></li>
<li><p><tt>lnmtime</tt></p></li>
<li><p><tt>mode</tt></p></li>
<li><p><tt>mtime</tt></p></li>
<li><p><tt>size</tt></p></li>
<li><p><tt>type</tt></p></li>
<li><p><tt>uid</tt></p></li></ul>
<p>The <tt>all</tt> keyword refers to all file attributes.</p>

<a name="bart-18ddd"></a><h5>Quoting Syntax</h5>
<a name="indexterm-707"></a><a name="indexterm-708"></a><p>The rules file specification language that BART uses is the standard UNIX quoting
syntax for representing nonstandard file names. Embedded tab, space, newline, or special characters
are encoded in their octal forms to enable the tool to read file
names. This nonuniform quoting syntax prevents certain file names, such as those containing
an embedded carriage return, from being processed correctly in a command pipeline. The
rules specification language allows the expression of complex file name filtering criteria that would
be difficult and inefficient to describe by using shell syntax alone.</p><p>For more information about the BART rules file or the quoting syntax used
by BART, see the <a href="http://docs.sun.com/doc/819-2251/bart-rules-4?a=view"><tt>bart_rules</tt>(4)</a> man page.</p>

<a name="bart-25xyz"></a><h4>BART Reporting</h4>
<p>In default mode, the <tt>bart compare</tt> command, as shown in the following example, will
check all the files installed on the system, with the exception of modified
directory timestamps (<tt>dirmtime</tt>):</p><pre>CHECK all
IGNORE    dirmtime</pre><p>If you supply a rules file, then the global directives of <tt>CHECK all</tt>
and <tt>IGNORE dirmtime</tt>, in that order, are automatically prepended to the rules file.</p>

<a name="bart-16"></a><h5>BART Output</h5>
<a name="indexterm-709"></a><a name="indexterm-710"></a><p>The following exit values are returned:</p><dl><dt>0</dt>
<dd><p>Success</p></dd>
<dt>1</dt>
<dd><p>Nonfatal error when processing files, such as permission problems</p></dd>
<dt>&gt;1</dt>
<dd><p>Fatal error, such as an invalid command-line option</p></dd>
</dl>
<p>The reporting mechanism provides two types of output: verbose and programmatic:<a name="indexterm-711"></a></p>
<ul><li><p>Verbose output is the default output and is localized and presented on multiple lines. Verbose output is internationalized and is human-readable. When the <tt>bart compare</tt> command compares two system manifests, a list of file differences is generated.</p><p>For example:</p><pre><i>filename attribute control:xxxx test:yyyy</i></pre><dl><dt><i>filename</i></dt>
<dd><p>Name of the file that differs between the control manifest and the test manifest.</p></dd>
<dt><i>attribute</i></dt>
<dd><p>Name of the file attribute that differs between the manifests that are compared. <i>xxxx</i> is the attribute value from the control manifest, and <i>yyyy</i> is the attribute value from the test manifest. When discrepancies for multiple attributes occur in the same file, each difference is noted on a separate line.</p></dd>
</dl>
<p>Following is an example of the default output for the <tt>bart compare</tt> command. The attribute differences are for the <tt>/etc/passwd</tt> file. The output indicates that the <tt>size</tt>, <tt>mtime</tt>, and <tt>contents</tt> attributes have changed.</p><pre>/etc/passwd:
size    control:74    test:81
mtime control:3c165879    test:3c165979
contents    control:daca28ae0de97afd7a6b91fde8d57afa
test:84b2b32c4165887355317207b48a6ec7</pre></li>
<li><p><a name="indexterm-712"></a>Programmatic output is generated if you use the <tt>-p</tt> option when you run the <tt>bart compare</tt> command. This output is generated in a form that is suitable for programmatic manipulation. Programmatic output can be easily parsed by other programs and is designed to be used as input for other tools.</p><p>For example:</p><pre><i>filename</i> <i>attribute</i> <i>control-val</i> <i>test-val</i> [<i>attribute</i> <i>control-val</i> <i>test-val</i>]*</pre><dl><dt><i>filename</i></dt>
<dd><p>Same as the <i>filename</i> attribute in the default format</p></dd>
<dt><b>attribute</b> <i>control-val</i> <i>test-val</i></dt>
<dd><p>A description of the file attributes that differ between the control and test manifests for each file</p></dd>
</dl>
</li></ul>
<p>For a list of attributes that are supported by the <tt>bart</tt> command, see
<a href="#bart-22bbb">Rules File Attributes</a>.</p><p>For more information about BART, see the <a href="http://docs.sun.com/doc/819-2240/bart-1m?a=view"><tt>bart</tt>(1M)</a> man page.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="bart-4.html">Previous</a>
             </td>
             <td align="right">
                 <a href="secfile-1.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

