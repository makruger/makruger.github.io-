<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Kerberos Troubleshooting - System Administration Guide: Security Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-08-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Security Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="trouble-2.html">Previous</a>
             </td>
             <td align="right">
                 <a href="aadmin-1.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="oview-1.html">Part&nbsp;I&nbsp;Security Overview</a></p>
<p class="toc level2"><a href="secov-1.html">1.&nbsp;&nbsp;Security Services (Overview)</a></p>
<p class="toc level1 tocsp"><a href="sectm-1.html">Part&nbsp;II&nbsp;System, File, and Device Security</a></p>
<p class="toc level2"><a href="concept-1.html">2.&nbsp;&nbsp;Managing Machine Security (Overview)</a></p>
<p class="toc level2"><a href="secsys-1.html">3.&nbsp;&nbsp;Controlling Access to Systems (Tasks)</a></p>
<p class="toc level2"><a href="vscan-1.html">4.&nbsp;&nbsp;Virus Scanning Service (Tasks)</a></p>
<p class="toc level2"><a href="devtask-1.html">5.&nbsp;&nbsp;Controlling Access to Devices (Tasks)</a></p>
<p class="toc level2"><a href="bart-1.html">6.&nbsp;&nbsp;Using the Basic Audit Reporting Tool (Tasks)</a></p>
<p class="toc level2"><a href="secfile-1.html">7.&nbsp;&nbsp;Controlling Access to Files (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="prbactm-1.html">Part&nbsp;III&nbsp;Roles, Rights Profiles, and Privileges</a></p>
<p class="toc level2"><a href="prbac-1.html">8.&nbsp;&nbsp;Using Roles and Privileges (Overview)</a></p>
<p class="toc level2"><a href="rbactask-1.html">9.&nbsp;&nbsp;Using Role-Based Access Control (Tasks)</a></p>
<p class="toc level2"><a href="rbacref-1.html">10.&nbsp;&nbsp;Role-Based Access Control (Reference)</a></p>
<p class="toc level2"><a href="privtask-1.html">11.&nbsp;&nbsp;Privileges (Tasks)</a></p>
<p class="toc level2"><a href="privref-1.html">12.&nbsp;&nbsp;Privileges (Reference)</a></p>
<p class="toc level1 tocsp"><a href="scftm-1.html">Part&nbsp;IV&nbsp;Solaris Cryptographic Services</a></p>
<p class="toc level2"><a href="scf-1.html">13.&nbsp;&nbsp;Solaris Cryptographic Framework (Overview)</a></p>
<p class="toc level2"><a href="scftask-1.html">14.&nbsp;&nbsp;Solaris Cryptographic Framework (Tasks)</a></p>
<p class="toc level2"><a href="kmf-1.html">15.&nbsp;&nbsp;Solaris Key Management Framework</a></p>
<p class="toc level1 tocsp"><a href="authtm-1.html">Part&nbsp;V&nbsp;Authentication Services and Secure Communication</a></p>
<p class="toc level2"><a href="auth-1.html">16.&nbsp;&nbsp;Using Authentication Services (Tasks)</a></p>
<p class="toc level2"><a href="pam-1.html">17.&nbsp;&nbsp;Using PAM</a></p>
<p class="toc level2"><a href="sasl-1.html">18.&nbsp;&nbsp;Using SASL</a></p>
<p class="toc level2"><a href="sshuser-1.html">19.&nbsp;&nbsp;Using Solaris Secure Shell (Tasks)</a></p>
<p class="toc level2"><a href="sshref-1.html">20.&nbsp;&nbsp;Solaris Secure Shell (Reference)</a></p>
<p class="toc level1 tocsp"><a href="seamtm-1.html">Part&nbsp;VI&nbsp;Kerberos Service</a></p>
<p class="toc level2"><a href="intro-1.html">21.&nbsp;&nbsp;Introduction to the Kerberos Service</a></p>
<p class="toc level2"><a href="seamplan-1.html">22.&nbsp;&nbsp;Planning for the Kerberos Service</a></p>
<p class="toc level2"><a href="setup-8.html">23.&nbsp;&nbsp;Configuring the Kerberos Service (Tasks)</a></p>
<p class="toc level2"><a href="trouble-1.html">24.&nbsp;&nbsp;Kerberos Error Messages and Troubleshooting</a></p>
<p class="toc level3"><a href="trouble-2.html">Kerberos Error Messages</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Kerberos Troubleshooting</a></p>
</div>
<p class="toc level2 tocsp"><a href="aadmin-1.html">25.&nbsp;&nbsp;Administering Kerberos Principals and Policies (Tasks)</a></p>
<p class="toc level2"><a href="user-7.html">26.&nbsp;&nbsp;Using Kerberos Applications (Tasks)</a></p>
<p class="toc level2"><a href="refer-1.html">27.&nbsp;&nbsp;The Kerberos Service (Reference)</a></p>
<p class="toc level1 tocsp"><a href="audittm-1.html">Part&nbsp;VII&nbsp;Solaris Auditing</a></p>
<p class="toc level2"><a href="auditov-1.html">28.&nbsp;&nbsp;Solaris Auditing (Overview)</a></p>
<p class="toc level2"><a href="auditplan-1.html">29.&nbsp;&nbsp;Planning for Solaris Auditing</a></p>
<p class="toc level2"><a href="audittask-1.html">30.&nbsp;&nbsp;Managing Solaris Auditing (Tasks)</a></p>
<p class="toc level2"><a href="auditref-1.html">31.&nbsp;&nbsp;Solaris Auditing (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-2.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="trouble-5"></a><h3>Kerberos Troubleshooting</h3>
<p><a name="indexterm-2646"></a><a name="indexterm-2647"></a>This section provides troubleshooting information for the Kerberos software.</p>

<a name="trouble-16"></a><h4>Problems With the Format of the <tt>krb5.conf</tt> File</h4>
<p>If the <tt>krb5.conf</tt> file is not formatted properly, the <tt>telnet</tt> command will fail.
However, the <tt>dtlogin</tt> and <tt>login</tt> commands will still succeed, even if the
<tt>krb5.conf</tt> file is specified as required for the commands. If this problem occurs,
the following error message is displayed:  </p><pre>Error initializing krb5: Improper format of Kerberos configuration</pre><p>In addition, an incorrectly formatted <tt>krb5.conf</tt> file, prevents the applications that use the
GSSAPI from using the <tt>krb5</tt> mechanisms.</p><p>If there is a problem with the format of the <tt>krb5.conf</tt> file, you
are vulnerable to security breaches. You should fix the problem before you allow
Kerberos features to be used.</p>

<a name="trouble-21"></a><h4>Problems Propagating the Kerberos Database</h4>
<p>If propagating the Kerberos database fails, try <tt>/usr/bin/rlogin</tt> <tt>-x</tt> between the slave
KDC and master KDC, and from the master KDC to the slave KDC
server. </p><p>If the KDCs have been set up to restrict access, <tt>rlogin</tt> is disabled
and cannot be used to troubleshoot this problem. To enable <tt>rlogin</tt> on
a KDC, you must enable the <tt>eklogin</tt> service.</p><pre># svcadm enable svc:/network/login:eklogin</pre><p>After you finish troubleshooting the problem, you need to disable the <tt>eklogin</tt>
service..</p><p>If <tt>rlogin</tt> does not work, problems are likely because of the keytab files
on the KDCs. If <tt>rlogin</tt> does work, the problem is not in the
keytab file or the name service, because <tt>rlogin</tt> and the propagation software use
the same <tt>host/</tt><i>host-name</i> principal. In this case, make sure that the <tt>kpropd.acl</tt>
file is correct.</p>

<a name="trouble-22"></a><h4>Problems Mounting a Kerberized NFS File System</h4>

<ul><li><p>If mounting a Kerberized NFS file system fails, make sure that the <tt>/var/rcache/root</tt> file exists on the NFS server. If the file system is not owned by <tt>root</tt>, remove it and try the mount again. </p></li>
<li><p>If you have a problem accessing a Kerberized NFS file system, make sure that the <tt>gssd</tt> service is enabled on your system and the NFS server.</p></li>
<li><p>If you see either the <tt>invalid argument</tt> or <tt>bad directory</tt> error message when you are trying to access a Kerberized NFS file system, the problem might be that you are not using a fully qualified DNS name when you are trying to mount the NFS file system. The host that is being mounted is not the same as the host name part of the service principal in the server's keytab file.</p><p>This problem might also occur if your server has multiple Ethernet interfaces, and you have set up DNS to use a &ldquo;name per interface&rdquo; scheme instead of a &ldquo;multiple address records per host&rdquo; scheme. For the Kerberos service, you should set up multiple address records per host as follows<a name="trouble-fn-25"></a>Ken Hornstein, &ldquo;Kerberos FAQ,&rdquo; [<a href="http://www.nrl.navy.mil/CCS/people/kenh/kerberos-faq.html">http://www.nrl.navy.mil/CCS/people/kenh/kerberos-faq.html</a>], accessed 11 December 1998.:</p><pre>my.host.name.   A       1.2.3.4
                A       1.2.4.4
                A       1.2.5.4

my-en0.host.name.       A       1.2.3.4
my-en1.host.name.       A       1.2.4.4
my-en2.host.name.       A       1.2.5.4

4.3.2.1         PTR     my.host.name.
4.4.2.1         PTR     my.host.name.
4.5.2.1         PTR     my.host.name.</pre></li></ul>
<p>In this example, the setup allows one reference to the different interfaces and
a single service principal instead of three service principals in the server's keytab
file.</p>

<a name="trouble-23"></a><h4>Problems Authenticating as <tt>root</tt></h4>
<p>If authentication fails when you try to become superuser on your system and
you have already added the <tt>root</tt> principal to your host's keytab file, there
are two potential problems to check. First, make sure that the <tt>root</tt> principal
in the keytab file has a fully qualified host name as its instance.
If it does, check the <tt>/etc/resolv.conf</tt> file to make sure that the system
is correctly set up as a DNS client.</p>

<a name="fabaf"></a><h4>Observing Mapping from GSS Credentials to UNIX Credentials</h4>
<p>To be able to monitor the credential mappings, first uncomment this line from
the <tt>/etc/gss/gsscred.conf</tt> file.</p><pre>SYSLOG_UID_MAPPING=yes</pre><p>Next instruct the <tt>gssd</tt> service to get information from the <tt>/etc/gss/gsscred.conf</tt> file.</p><pre># pkill -HUP gssd</pre><p>Now you should be able to monitor the credential mappings as <tt>gssd</tt>
requests them. The mappings are recorded by <tt>syslogd</tt>, if the <tt>syslog.conf</tt> file is
configured for the <tt>auth</tt> system facility with the <tt>debug</tt> severity level.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="trouble-2.html">Previous</a>
             </td>
             <td align="right">
                 <a href="aadmin-1.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

