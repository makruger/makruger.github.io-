<chapter id="troubleshooting"><title>Solaris CIFS Troubleshooting</title><highlights><itemizedlist><para>This chapter provides troubleshooting information for the Solaris CIFS service, Solaris CIFS client, and the <command>idmapd</command> service, as follows:</para><listitem><para><olink targetptr="smbservertroubleshooting" remap="internal">Solaris CIFS Service Troubleshooting</olink></para>
</listitem><listitem><para><olink targetptr="smbclienttroubleshooting" remap="internal">Solaris CIFS Client Troubleshooting</olink></para>
</listitem><listitem><para><olink targetptr="idmappingtroubleshooting" remap="internal">Identity Mapping Troubleshooting</olink></para>
</listitem>
</itemizedlist><para>Up-to-date troubleshooting information is also on a wiki that is available from the <ulink url="http://opensolaris.org/os/project/cifs-server/docs" type="text_url">OpenSolaris CIFS Server project page</ulink>.</para>
</highlights><sect1 id="smbservertroubleshooting"><title>Solaris CIFS Service Troubleshooting</title><para>The following are troubleshooting issues for the Solaris CIFS service.</para><sect2 id="fsunexpectedbehavior"><title>File Name Case-Sensitivity Issues</title><para>Sometimes you might experience unexpected behavior when performing basic file operations. This behavior might be related to the file system being unable to handle case-insensitive operations.</para><para>CIFS clients usually expect a case-insensitive file system for correct operation. The use of a ZFS file system that has been created in mixed-case or case-insensitive mode should allow you to circumvent these problems.</para><para>To create such a ZFS file system, use the following command:</para><screen># <userinput>zfs create -o casesensitivity=mixed <replaceable>fsname</replaceable></userinput></screen>
</sect2><sect2 id="cannotjoinwindowsdomain"><title>Cannot Join a Windows Domain</title><para>To authenticate users from a Windows domain, the Solaris CIFS service must locate a domain controller, authenticate, and then add a computer account to the domain.</para><para>Users from the domain are not able to establish a connection to the Solaris CIFS service unless this process succeeds.</para><itemizedlist><para>The following sections describe configuration issues you might have when you cannot successfully join a Windows domain:</para><listitem><para><olink targetptr="cifsconfigurationissues" remap="internal">Checking the DNS Configuration</olink></para>
</listitem><listitem><para><olink targetptr="correctkerberosconfiguration" remap="internal">Checking the Kerberos Configuration</olink></para>
</listitem><listitem><para><olink targetptr="wrongpassword" remap="internal">Ensuring That You Specify the Correct Password for Your Domain User</olink></para>
</listitem><listitem><para><olink targetptr="insufficientpermissions" remap="internal">Ensuring That Your Domain User Has Sufficient Administrative Privileges</olink></para>
</listitem>
</itemizedlist><sect3 id="cifsconfigurationissues"><title>Checking the DNS Configuration</title><para>The Solaris CIFS service must be running for the <command>smbadm join</command> command to succeed.</para><para>If Active Directory (AD) is configured, the Solaris CIFS service attempts to locate the domain controller by means of DNS. If the service cannot locate the domain controller, configure DNS properly.</para><itemizedlist><para>The following configuration issues might prevent you from configuring the Solaris CIFS service in domain mode:</para><listitem><para><emphasis role="strong">Missing DNS domain.</emphasis> Ensure that the fully qualified AD domain name has been added to the search list or as the local domain in <filename>/etc/resolv.conf</filename>.</para><para>If your configuration is incorrect, you might see the <literal>failed to join domain <replaceable>domain-name</replaceable> (INVALID_PARAMETER)</literal> error when attempting to join the domain.</para>
</listitem><listitem><para><emphasis role="strong">Missing DNS server.</emphasis> Ensure that the IP address of the AD DNS server is added as the name server in <filename>/etc/resolv.conf</filename>.</para><para>If your configuration is incorrect, you might see the <literal>failed to find any domain controllers</literal> error when attempting to join the domain.</para>
</listitem><listitem><para><emphasis role="strong">DNS host lookup not used.</emphasis> Ensure that DNS is used for host lookup in the <filename>/etc/nsswitch.conf</filename> file.</para>
</listitem>
</itemizedlist>
</sect3><sect3 id="correctkerberosconfiguration"><title>Checking the Kerberos Configuration</title><itemizedlist><para>You might see the following error messages, which indicate that Kerberos is not correctly configured:</para><listitem><para><literal>k5_kinit: KDC has no support for encryption type</literal></para><para>When this error occurs, you must reset the Domain Administrator password by re-entering the original password.</para><para>This error is a known issue on Windows where DES encryption keys are not created for the administrator under certain circumstances. For more information, see <ulink url="http://support.microsoft.com/kb/248808" type="text_url">Microsoft knowledge base article 248808</ulink>.</para>
</listitem><listitem><para><literal>k5_kinit: getting initial credentials (KDC reply did not match expectations)</literal></para><para>Ensure that the Kerberos Realm specified in the <filename>/etc/krb5/krb5.conf</filename> uses uppercase characters.</para>
</listitem><listitem><para><literal>k5_kinit: getting initial credentials (Cannot resolve network address for KDC in requested realm)</literal></para><para>This problem can be corrected by ensuring that the configuration is correct in one of these ways:</para><itemizedlist><listitem><para>Ensure that DNS is used for host lookup in the <filename>/etc/nsswitch.conf</filename> file.</para>
</listitem><listitem><para>Ensure that the IP address of the DNS server is added as the name server in the <filename>/etc/resolv.conf</filename> file.</para><para>Check the <filename>resolve.conf</filename> file if you also see the following log entries:</para><screen>Jan  4 10:27:58 pb-49 smbd[101148]: [ID 290708 daemon.debug] NS Found 10.1.98.13 name server
Jan  4 10:27:58 pb-49 smbd[101148]: [ID 290708 daemon.debug] NS Found 10.1.98.12 name server
Jan  4 10:27:58 pb-49 smbd[101148]: [ID 327122 daemon.debug] NS Found 2 name servers
Jan  4 10:27:58 pb-49 smbd[101148]: [ID 995127 daemon.error] dyndns: UDP send error (Bad file number)
Jan  4 10:27:58 pb-49 smbd[101148]: [ID 342079 daemon.error] smb_ads: send/receive error
Jan  4 10:27:58 pb-49 smbd[101148]: [ID 995127 daemon.error] dyndns: UDP send error (Bad file number)
Jan  4 10:27:58 pb-49 smbd[101148]: [ID 342079 daemon.error] smb_ads: send/receive error
Jan  4 10:27:58 pb-49 smbd[101148]: [ID 327097 daemon.error] smb_ads: No ADS host found from configured
nameservers</screen>
</listitem>
</itemizedlist>
</listitem>
</itemizedlist>
</sect3><sect3 id="wrongpassword"><title>Ensuring That You Specify the Correct Password for Your Domain User</title><para>The user that you specify on the <command>smbadm join</command> command line must have the correct password and the authority to create computer accounts. Typically, you must specify a user account that is a member of the Domain Administrators global group.</para><para>The following error message only appears if you supply the wrong password for the administrative user:</para><screen>failed to join <replaceable>domain-name</replaceable> (LOGON_FAILURE)</screen><para>This error message might also appear if packet signing is enabled on the domain controller. So, you must disable packet signing on the domain controller before you can successfully join a domain.</para><para>If you attempt to join as a domain user who does not have administrative privileges, the join fails with <literal>insufficient access</literal> error messages.</para>
</sect3><sect3 id="insufficientpermissions"><title>Ensuring That Your Domain User Has Sufficient Administrative Privileges</title><para>The user that you specify on the <command>smbadm join</command> command line must be a member of the Domain Administrators global group.</para><para>The following error message only appears if you attempt to join as a domain user who does not have administrative privileges. The join fails with <literal>insufficient access</literal> error messages.</para><screen>smbd: failed joining <replaceable>domain-name</replaceable> (UNSUCCESSFUL)</screen>
</sect3>
</sect2><sect2 id="intermittentdomainconnectivity"><title>Checking Intermittent Domain Connectivity</title><sect3 id="lostconnectiontodomain"><title>Checking the Domain Controller Selection</title><para>Sometimes the Solaris CIFS service might lose its connection to the domain controller. In such a situation, Windows users are denied access to the Solaris CIFS service.</para><para>The connection might be lost if the network experiences connectivity problems or if the primary domain controller fails.</para><para>The solution to any of these problems is to rejoin the Windows domain. See <olink targetptr="configuredomainmodetask" remap="internal">How to Configure the Solaris CIFS Service in Domain Mode</olink>.</para>
</sect3>
</sect2><sect2 id="noisyidmapdinworkgroupmode"><title><command>idmapd</command> Unable to Contact AD When in Workgroup Mode</title><para>The <command>idmapd</command> server attempts to contact AD even if the Solaris CIFS service is in workgroup mode. As a result, <command>idmapd</command> issues errors.</para><para>To work around this problem, remove all rule-based mappings and ignore any errors from <command>idmapd</command> about its failure to contact AD.</para>
</sect2><sect2 id="viewserverpropertysettings"><title>Viewing Solaris CIFS Service Property Settings</title><para>Much of the Solaris CIFS service configuration uses the <olink targetdoc="refman1m" targetptr="sharectl-1m" remap="external"><citerefentry><refentrytitle>sharectl</refentrytitle><manvolnum>1M</manvolnum></citerefentry></olink> command to set properties. Before you change property values, you should view the current property settings by running the <command>sharectl get smb</command> command.</para>
</sect2><sect2 id="configurewinsclientexample"><title>Excluding IP Addresses From WINS Name Resolution</title><para>When using WINS/NetBIOS, Windows domain controllers (DC) do not automatically respond to the IP address from which they received a request. They perform a WINS or NetBIOS cache lookup and for multihomed servers the DC can respond to a different IP address belonging to the server. If the IP address is not accessible to the DC, it will appear as if the DC has not responded to the server. Thus, it may be necessary to exclude some IP addresses when a multihomed server registers with WINS.</para><para>The following example shows how to configure the Solaris CIFS service as a WINS client. The primary WINS server is set to IP address <literal>172.16.48.20</literal>, the secondary WINS server is set to IP address <literal>172.16.48.21</literal>, and IP addresses <literal>172.16.48.22</literal> and <literal>172.16.48.23</literal> are excluded from WINS resolution.</para><screen># <userinput>sharectl set -p wins_server_1=172.16.48.20 smb</userinput>
# <userinput>sharectl set -p wins_server_2=172.16.48.21 smb</userinput>
# <userinput>sharectl set -p wins_exclude=192.168.48.22,192.168.48.23 smb</userinput></screen>
</sect2><sect2 id="mappingchangesdonottakeeffect"><title>Changes to Windows Group Membership and to User Mapping Do Not Take Effect</title><para>Windows clients use an access token to assign user data and group membership. This token is assigned when the client connects to the CIFS service. Any changes made to this token are not reflected until the next time the user connects.</para><para>To force changes to take effect immediately, the user must disconnect from the CIFS service by logging out of all connected workstations.</para>
</sect2><sect2 id="missingwindowsclients"><title>Windows Clients Cannot Connect by NetBIOS Name or Are Missing From Browse List or Network Neighborhood</title><para>A master browser is a server that is configured to manage CIFS/SMB browse lists and to respond to client requests for them. A Windows server is configured as a master browser by default.</para><para>The Solaris CIFS service is not configured as a master browser. The Solaris CIFS service dedicates all of its resources to file sharing.</para><para>For browsing to function correctly, each subnet or physical network segment must have a master browser. To make the Solaris CIFS service available through browse lists, the system on which it runs should be located on the same segment and subnet as a Windows server.</para><para>Configuring a Windows server improves the performance of browsing and might compensate for the lack of a master browser on some segments.</para>
</sect2><sect2 id="sharesecurity"><title>Cannot Set Share Security, All Shares Inherit the Security of the Directory Object</title><para>The security implementation of the Solaris CIFS service only secures files and directories. The effective security of a CIFS share is <emphasis>always</emphasis> the security of the directory to which it points.</para>
</sect2><sect2 id="cannotcopylargefiles"><title>Older Versions of Windows Cannot Copy Files Larger Than 4 Gbytes</title><itemizedlist><para>You might see this problem if your client is running Windows 2000 or an older version of Windows.</para><listitem><para>If you are running a Windows 2000 client, apply the latest service pack.</para>
</listitem><listitem><para>If you are running a version older than Windows 2000, you might be able to work around the problem by using the Windows backup utility or by using a similar third-party product.</para>
</listitem>
</itemizedlist>
</sect2><sect2 id="cannotmapdrives"><title>Cannot Use CIFS to Map Drives</title><para>To map a drive or to connect to a share, you must have read access to the directory to which the share points.</para><para>If the Solaris CIFS service is in domain mode, you must also be logged in to the domain.</para><orderedlist><para>To ensure that a user can connect to a share, do the following to check and modify permissions:</para><listitem><para>Log in to the system that is running the Solaris CIFS service.</para>
</listitem><listitem><para>Become superuser.</para>
</listitem><listitem><para>Obtain the user name and group name of the owner.</para><screen># <userinput>ls -l <replaceable>pathname</replaceable></userinput></screen><para>For example, the following output indicates that the share is a directory with 750 permissions. The owner is <literal>root</literal> and the group is <literal>sys</literal>.</para><screen># <userinput>ls -ld /vol1/data</userinput>
drwxr-x---  41 root     sys         1024 Jan  2 23:19 /vol1/data</screen>
</listitem><listitem><para>Determine the permissions necessary for the user to access the directory.</para>
</listitem><listitem><para>Use the <command>chmod</command> command to change the permissions of the directory.</para>
</listitem>
</orderedlist>
</sect2><sect2 id="cannotseesecuritytab"><title>Cannot See the Security Tab From Windows Clients</title><para>Some Windows clients do not show the security tab unless you have permission to view or change security.</para><para>For information about how to view and modify share permissions, see <olink targetptr="cannotmapdrives" remap="internal">Cannot Use CIFS to Map Drives</olink>.</para>
</sect2><sect2 id="smbdisconnectsfrommssqlserver"><title>Microsoft Access or SQL Server Sessions Time Out After a Period of Inactivity</title><para>Applications can send SMB echo requests periodically to keep idle sessions open or to reconnect, as required, if a session times out due to inactivity. If an application appears unable to deal with an idle session timeout, the CIFS service <literal>keep_alive</literal> property can be set to 0 to disable the session inactivity timer.</para><screen># <userinput>sharectl set -p keep_alive=0 smb</userinput></screen>
</sect2><sect2 id="cannotaddlocalgroupstoacl"><title>Cannot Add Windows Local Groups to Access Control List</title><para>Windows local groups cannot be used to assign security on remote systems. A local group can only be used on the individual computer on which it is created. A local group is not stored in the domain SAM database.</para><para>Windows domain controllers are an exception to this behavior. Domain controllers share a set of local groups that can only be shared with other domain controllers. To make security assignments to the Solaris CIFS service, use global groups.</para><para>The Solaris CIFS service has its own set of local groups that are provided for Windows compatibility purposes. These local groups permit a limited set of privileges, and they can also be used for security assignments to individual files and folders.</para><note><para>Windows domain local groups are not supported.</para>
</note>
</sect2><sect2 id="sharesmbonzfspool"><title>CIFS Browsing Fails When <literal>sharesmb=on</literal> Is Set on a ZFS Pool</title><para>If you have a ZFS pool with datasets and you run the <command>zfs set sharesmb=on</command> command on the pool, the pool and all its datasets are shared, but unavailable for browsing by Windows systems.</para><orderedlist><para>To work around this problem, do the following:</para><listitem><para>Determine whether your <command>zpool</command> and <command>zfs</command> versions support CIFS shares.</para><screen># <userinput>zpool get version <replaceable>pool</replaceable></userinput>
# <userinput>zfs get version <replaceable>dataset</replaceable></userinput></screen><para>Support for CIFS shares requires that ZFS pools be at least Version 9 and that ZFS datasets be at least Version 3.</para>
</listitem><listitem><para>(Optional) Upgrade <command>zpool</command> and <command>zfs</command>.</para><screen># <userinput>zpool upgrade <replaceable>pool</replaceable></userinput>
# <userinput>zfs upgrade <replaceable>dataset</replaceable></userinput></screen><para>For more information, see the <olink targetdoc="refman1m" targetptr="zpool-1m" remap="external"><citerefentry><refentrytitle>zpool</refentrytitle><manvolnum>1M</manvolnum></citerefentry></olink> and <olink targetdoc="refman1m" targetptr="zfs-1m" remap="external"><citerefentry><refentrytitle>zfs</refentrytitle><manvolnum>1M</manvolnum></citerefentry></olink> man pages.</para>
</listitem><listitem><itemizedlist><para>Map the shares in one of the following ways:</para><listitem><para>Run the <command>zfs set sharesmb=on</command> command on any of the lower-level datasets instead of the pool.</para>
</listitem><listitem><para>Map the shares directly.</para>
</listitem>
</itemizedlist>
</listitem>
</orderedlist>
</sect2><sect2 id="sambacifscannotbindports"><title>Samba or CIFS Service Cannot Bind Various Ports</title><para>You will see errors if you attempt to run both the Samba service, <literal>svc:/network/samba:default</literal>, and the Solaris CIFS service, <literal>svc:/network/smb/server:default</literal>, simultaneously.</para><para>The Samba and Solaris CIFS services are mutually exclusive because they both attempt to listen on the same ports. Only one service should be enabled at any time.</para><itemizedlist><para>To disable either the Samba or Solaris CIFS service, do one of the following:</para><listitem><para><emphasis role="strong">Disable the Samba service.</emphasis> Use the <command>svcadm disable svc:/network/samba</command> command.</para>
</listitem><listitem><para><emphasis role="strong">Disable the Solaris CIFS service.</emphasis> Use the <command>svcadm disable smb/server</command> command.</para>
</listitem>
</itemizedlist>
</sect2><sect2 id="inaccessiblecifsshares"><title>CIFS Shares on ZFS Are Inaccessible After a Reboot</title><para>CIFS shares on ZFS might be inaccessible to CIFS clients if you reboot the Solaris CIFS server.</para><para>Run the following command to reshare the ZFS shares:</para><screen># <userinput>sharemgr start -P smb zfs</userinput></screen>
</sect2><sect2 id="invalidpassworderrors"><title><literal>invalid password</literal> Errors Appear When Mapping a Drive or Browsing Computers in the Workgroup</title><para>When you map a drive or browse computers in your workgroup, you might see <literal>invalid password</literal> errors. If you see these errors, check to see that the <filename>/var/smb/smbpasswd</filename> file includes information for the appropriate users.</para><para>Also, ensure that the <literal>pam_smb_passwd.so.1</literal> entry is in the <filename>/etc/pam.conf</filename> file and that you use the <command>passwd</command> command to set your password.</para><para>For more information, see <olink targetptr="configureworkgroupmodetask" remap="internal">How to Configure the Solaris CIFS Service in Workgroup Mode</olink>.</para>
</sect2><sect2 id="aclinheritanceissues"><title>Access Control List Inheritance Issues</title><para>Access control list (ACL) behavior differs between Windows systems and ZFS on Solaris systems. You might experience Windows ACL inheritance problems because of the access control entry (ACE) ordering used by the default ZFS ACL.</para><para>The default ZFS ACL is designed to comply with POSIX, which results in the interleaving of <literal>allow</literal> and <literal>deny</literal> ACEs. Windows expects all <literal>deny</literal> ACEs to precede all <literal>allow</literal> ACEs.</para><para>You can override the default ZFS behavior by changing the ACL on the root directory to provide the equivalent of <literal>Everyone:FullControl</literal> as follows:</para><screen># <userinput>chmod 777 /<replaceable>pool-name</replaceable></userinput>
# <userinput>chmod A=everyone@:rwxpdDaARWcCos:fd:allow /<replaceable>pool</replaceable>/<replaceable>fs-name</replaceable></userinput></screen><para>For information about the <command>chmod</command> options, see the <olink targetdoc="refman1" targetptr="chmod-1" remap="external"><citerefentry><refentrytitle>chmod</refentrytitle><manvolnum>1</manvolnum></citerefentry></olink> man page.</para><para>You can verify the ACL by viewing it on Windows or by running the following command on a Solaris system:</para><screen># <userinput>ls -V -d /<replaceable>pool-name</replaceable>/<replaceable>fs-name</replaceable></userinput></screen><para>You can apply this ACL recursively to all subdirectories and files for existing file systems from Windows or from the Solaris OS.</para><para>If you apply the ACL when the file system is first created, the ACL will be propagated according to the normal inheritance rules.</para><para>If a directory has a default ZFS ACL, when a file or folder is created under this directory from Windows, it has two ACEs: one for the owner and one for SYSTEM. To change this behavior, update the root directory's ACL by running the <command>chmod</command> commands shown previously.</para>
</sect2><sect2 id="missingsecuritytabxpclient"><title>Missing Security Tab on XP Clients</title><itemizedlist><para>You might not see the security tab for a file or folder when using an XP client for the following reasons:</para><listitem><para>You do not have enough permissions to see the security settings of the file or folder</para>
</listitem><listitem><para>Simplified file sharing is enabled on your client</para>
</listitem>
</itemizedlist><para>To disable simplified file sharing, go to Control Panel->Folder Options->View, and unselect Use Simple File Sharing (Recommended), and click Apply.</para><para>For more information about disabling simplified file sharing and setting permissions on a shared folder, see <ulink url="http://support.microsoft.com/kb/307874" type="text_url">Microsoft knowledge base article 307874</ulink>.</para>
</sect2>
</sect1><sect1 id="smbclienttroubleshooting"><title>Solaris CIFS Client Troubleshooting</title><sect2 id="viewclientpropertysettings"><title>Viewing Solaris CIFS Client Property Settings</title><para>The Solaris CIFS client configuration uses the <command>sharectl</command> command to set properties. Before you change property values, view the current property settings by running the <command>sharectl get smbfs</command> command.</para>
</sect2><sect2 id="accessdeniedtoserver"><title><literal>Access Denied</literal> Message When Accessing a Server</title><para>You get an <literal>Access Denied</literal> error when attempting to access or view CIFS shares from a server. This problem might occur because the password you supplied is wrong or the CIFS server is part of a domain.</para><para>If the CIFS server is part of a domain, you must provide the domain name for the <command>smbutil view</command> or <command>mount</command> command. Otherwise, the server assumes that you are attempting to authenticate a local user, and the authentication process fails.</para><para>For example, if the server <literal>solarsystem</literal> is in the <literal>MYDOMAIN</literal> domain, the following commands would be appropriate to view and access CIFS shares as user <literal>cal</literal>:</para><screen># <userinput>smbutil view "//MYDOMAIN;cal@solarsystem"</userinput>
# <userinput>mount -F smbfs "//MYDOMAIN;cal@solarsystem/tmp" /mnt</userinput></screen><para>To obtain the domain name, use the <command>smbutil status <replaceable>server</replaceable></command> command, which sends a NetBIOS query to the specified server:</para><screen># <userinput>smbutil status solarsystem</userinput>
Workgroup: MYDOMAIN
Server: SOLARSYSTEM</screen>
</sect2><sect2 id="cannotviewmountshare"><title>Cannot View or Mount CIFS Shares</title><para>If you are unable to view or mount CIFS shares, use the <command>smbutil view -A //<replaceable>server</replaceable></command> command. The <option>A</option> option gives anonymous access to the server if the server permits such access.</para>
</sect2><sect2 id="cannotmountsharereguser"><title>Cannot Mount CIFS Shares as a Regular User</title><para>You might see the following error message when you attempt to mount a CIFS share as a regular user on a mount point that you own:</para><screen>$ <userinput>mount -F smbfs //<replaceable>username</replaceable>@<replaceable>server-name</replaceable>/<replaceable>share-name</replaceable> <replaceable>mount-point</replaceable></userinput>
mount: mount_smbfs: <replaceable>mount-point</replaceable>: Not owner</screen><para>Verify that you have the following entries in your <filename>/etc/security/exec_attr</filename> file:</para><screen>Basic Solaris User:solaris:cmd:::/usr/lib/fs/smbfs/mount:privs=sys_mount
Basic Solaris User:solaris:cmd:::/usr/lib/fs/smbfs/umount:privs=sys_mount</screen><para>These entries in the <filename>/etc/security/exec_attr</filename> file enable you to mount and unmount CIFS shares on mount points that you own as a regular user.</para>
</sect2><sect2 id="filechangedasreadwarningsfromtar"><title><command>tar</command> and <command>gtar</command> Issues <literal>file changed as we read it</literal> Warnings</title><itemizedlist><para>You might see the <literal>file changed as we read it</literal> warning in the following situations:</para><listitem><para>When you use the Solaris CIFS client to mount a CIFS share, and use the <command>gtar</command> utility to write the share to a tape</para>
</listitem><listitem><para>When you use the Solaris CIFS client to mount a CIFS share, and use the Solaris <command>tar</command> utility checks file attributes after setting them</para>
</listitem>
</itemizedlist><para>Other than these warnings, the <command>tar</command> and <command>gtar</command> operations succeed as expected.</para><para>You can ignore these warnings.</para><note><para><literal>smbfs</literal> ignores calls to set any file or directory attributes, as those have no direct representation in CIFS. Also, <literal>smbfs</literal> does not support the &ldquo;UNIX extensions&rdquo; that would permit the storing of attributes with some servers.</para>
</note>
</sect2>
</sect1><sect1 id="idmappingtroubleshooting"><title>Identity Mapping Troubleshooting</title><sect2 id="viewidmappropertysettings"><title>Viewing Identity Mapping Service Property Settings</title><para>The identity mapping service uses the <olink targetdoc="refman1m" targetptr="svccfg-1m" remap="external"><citerefentry><refentrytitle>svccfg</refentrytitle><manvolnum>1M</manvolnum></citerefentry></olink> command to set properties. Before you change property values, you should view the current property settings.</para><itemizedlist><para>To view configuration properties related to the <command>idmap</command> service, run one of the following commands:</para><listitem><para><command># svccfg -s idmap listprop "config/*"</command></para>
</listitem><listitem><para><command># svcprop -p config svc:/system/idmap</command></para>
</listitem>
</itemizedlist><itemizedlist><para>To view all properties related to the <command>idmap</command> service, run one of the following commands:</para><listitem><para><command># svccfg -s idmap listprop</command></para>
</listitem><listitem><para><command># svcprop svc:/system/idmap</command></para>
</listitem>
</itemizedlist>
</sect2><sect2 id="saveandrestorenamebasedmappings"><title>Saving and Restoring Rule-Based Mappings</title><para>You might need to back up and restore your rule-based mappings.</para><para>For more information about the <command>idmap export</command>, <command>idmap import</command>, and <command>idmap list</command> commands, see the <olink targetdoc="refman1m" targetptr="idmap-1m" remap="external"><citerefentry><refentrytitle>idmap</refentrytitle><manvolnum>1M</manvolnum></citerefentry></olink> man page.</para><orderedlist><para>To <emphasis>back up</emphasis> the mappings, perform the following steps:</para><listitem><itemizedlist><para>Save your rule-based mappings in one of the following ways:</para><listitem><para>Export the mappings.</para><screen># <userinput>idmap export -f <replaceable>output-file</replaceable> <replaceable>format</replaceable></userinput></screen>
</listitem><listitem><para>List the mappings.</para><screen># <userinput>idmap list ><replaceable>output-file</replaceable></userinput></screen>
</listitem>
</itemizedlist>
</listitem><listitem><para>Disable the <command>idmap</command> service.</para><screen># <userinput>svcadm disable idmap</userinput></screen>
</listitem><listitem><para>Remove the <filename>idmap.db</filename> databases.</para><screen># <userinput>rm /var/idmap/idmap.db /var/run/idmap/idmap.db</userinput></screen>
</listitem><listitem><para>Reboot the system.</para>
</listitem>
</orderedlist><itemizedlist><para>To <emphasis>restore</emphasis> the mappings, use the mapping output you saved during the backup procedure. Do one of the following to restore based on your backup method:</para><listitem><para><emphasis role="strong">Use the</emphasis> <command>idmap import</command> <emphasis role="strong">command.</emphasis></para><screen># <userinput>idmap import -f <replaceable>input-file</replaceable> <replaceable>format</replaceable></userinput></screen>
</listitem><listitem><para><emphasis role="strong">Use the</emphasis> <command>idmap list</command> <emphasis role="strong">command.</emphasis></para><para>Run <replaceable>output-file</replaceable> as a shell script.</para><screen># <userinput>sh ./<replaceable>output-file</replaceable></userinput></screen>
</listitem>
</itemizedlist>
</sect2><sect2 id="detailedviewofmappings"><title>Viewing Details About Mappings</title><para>If you encounter unexpected mapping results, use the <command>idmap dump</command> and <command>idmap show</command> commands to gather data. Each command has a <option>v</option> option that produces detailed information about mappings.</para><para>For more information, see <olink targetptr="dumpmappingtask" remap="internal">How to Show All Established Mappings</olink> and <olink targetptr="showmappingtask" remap="internal">How to Show a Mapping for a Particular Identity</olink>.</para>
</sect2>
</sect1>
</chapter>