<?Pub UDT _bookmark _target?><chapter id="managedev-1"><?Pub Tag atict:info tracking="on" ref="10"?><?Pub Tag
atict:user user="sharonr" fullname="Sharon Veach"?><title>Managing Devices
for Trusted Extensions (Tasks)</title><indexterm><primary>administering</primary><secondary>devices</secondary>
</indexterm><indexterm><primary>devices</primary><secondary>administering</secondary>
</indexterm><highlights><para>This chapter describes how to administer and use devices on a system
that is configured with Solaris Trusted Extensions.</para><itemizedlist remap="jumplist"><listitem><para><olink targetptr="managedev-2" remap="internal">Handling Devices in Trusted
Extensions (Task Map)</olink></para>
</listitem><listitem><para><olink targetptr="managedev-18" remap="internal">Using Devices in Trusted Extensions
(Task Map)</olink></para>
</listitem><listitem><para><olink targetptr="managedev-33" remap="internal">Managing Devices in Trusted
Extensions (Task Map)</olink></para>
</listitem><listitem><para><olink targetptr="managedev-16" remap="internal">Customizing Device Authorizations
in Trusted Extensions (Task Map)</olink></para>
</listitem>
</itemizedlist>
</highlights><sect1 id="managedev-2"><title>Handling Devices in Trusted Extensions (Task Map)</title><indexterm><primary>tasks and task maps</primary><secondary>Handling Devices in Trusted Extensions (Task Map)</secondary>
</indexterm><indexterm><primary>Handling Devices in Trusted Extensions (Task Map)</primary>
</indexterm><para>The following task map points to task maps for administrators and users
for handling peripheral devices.</para><informaltable frame="all" pgwide="1"><tgroup cols="3" colsep="1" rowsep="1"><colspec colname="colspec0" colwidth="71.72*"/><colspec colname="col2" colwidth="168.35*"/><colspec colname="colspec1" colwidth="155.94*"/><thead><row><entry><para>Task</para>
</entry><entry><para>Description</para>
</entry><entry><para>For Instructions</para>
</entry>
</row>
</thead><tbody><row><entry><para>Use devices.</para>
</entry><entry><para>Uses a device as a role or as a regular user.</para>
</entry><entry><para><olink targetptr="managedev-18" remap="internal">Using Devices in Trusted Extensions
(Task Map)</olink></para>
</entry>
</row><row><entry><para>Administer devices.</para>
</entry><entry><para>Configures devices for ordinary users.</para>
</entry><entry><para><olink targetptr="managedev-33" remap="internal">Managing Devices in Trusted Extensions
(Task Map)</olink></para>
</entry>
</row><row><entry><para>Customize device authorizations.</para>
</entry><entry><para>The Security Administrator role creates new authorizations, adds them
to the device, places them in a rights profile and assigns this profile to
the user.</para>
</entry><entry><para><olink targetptr="managedev-16" remap="internal">Customizing Device Authorizations in
Trusted Extensions (Task Map)</olink></para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable>
</sect1><sect1 id="managedev-18"><title>Using Devices in Trusted Extensions (Task Map)</title><indexterm><primary>users</primary><secondary>using devices</secondary>
</indexterm><indexterm><primary>devices</primary><secondary>using</secondary>
</indexterm><indexterm><primary>tasks and task maps</primary><secondary>Using Devices in Trusted Extensions (Tasks Map)</secondary>
</indexterm><indexterm><primary>Using Devices in Trusted Extensions (Task Map)</primary>
</indexterm><para>In Trusted Extensions, all roles are authorized to allocate a device. Like
users, roles must use the Device Allocation Manager. The Solaris <command>allocate</command> command does not work in Trusted Extensions. The following task map
points to user procedures that include using devices to perform administrative
tasks.</para><informaltable frame="all" pgwide="1"><tgroup cols="2" colsep="1" rowsep="1"><colspec colname="colspec0" colwidth="89.48*"/><colspec colname="colspec1" colwidth="139.52*"/><thead><row><entry><para>Task</para>
</entry><entry><para>For Instructions</para>
</entry>
</row>
</thead><tbody><row><entry><para>Allocate and deallocate a device.</para>
</entry><entry><para><olink targetdoc="trssug" targetptr="ugelem-27" remap="external"><citetitle remap="section">How to Allocate a Device in Trusted Extensions</citetitle> in <citetitle remap="book">Solaris Trusted Extensions User&rsquo;s Guide</citetitle></olink></para><para><olink targetdoc="trssug" targetptr="ugelem-12" remap="external"><citetitle remap="section">Workspace Switch Area</citetitle> in <citetitle remap="book">Solaris Trusted Extensions User&rsquo;s Guide</citetitle></olink></para>
</entry>
</row><row><entry><para>Use portable media to transfer files.</para>
</entry><entry><para><olink targetptr="basic-25" remap="internal">How to Copy
Files From Portable Media in Trusted Extensions</olink></para><para><olink targetptr="basic-52" remap="internal">How to Copy
Files to Portable Media in Trusted Extensions</olink></para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable>
</sect1><sect1 id="managedev-33"><title>Managing Devices in Trusted Extensions (Task Map)</title><indexterm><primary>tasks and task maps</primary><secondary>Managing Devices in Trusted Extensions (Task Map)</secondary>
</indexterm><indexterm><primary>Managing Devices in Trusted Extensions (Task Map)</primary>
</indexterm><indexterm><primary>administering</primary><secondary>devices</secondary>
</indexterm><para>The following task map describes procedures to protect devices at your
site.</para><informaltable frame="all" pgwide="1"><tgroup cols="3" colsep="1" rowsep="1"><colspec colname="colspec0" colwidth="109.90*"/><colspec colname="col2" colwidth="153.98*"/><colspec colname="colspec1" colwidth="132.12*"/><thead><row><entry><para>Task</para>
</entry><entry><para>Description</para>
</entry><entry><para>For Instructions</para>
</entry>
</row>
</thead><tbody><row><entry><para>Set or modify device policy.</para>
</entry><entry><para>Changes the privileges that are required to access a device.</para>
</entry><entry><para><olink targetdoc="group-sa" targetptr="devtask-10" remap="external"><citetitle remap="section">Configuring Device Policy (Task Map)</citetitle> in <citetitle remap="book">System Administration Guide: Security Services</citetitle></olink></para>
</entry>
</row><row><entry morerows="1" rowsep="1"><para>Authorize users to allocate a device.</para>
</entry><entry><para>The Security Administrator role assigns a profile with the Allocate
Device authorization to the user.</para>
</entry><entry><para><olink targetdoc="group-sa" targetptr="devtask-36" remap="external"><citetitle remap="section">How to Authorize Users to Allocate a Device</citetitle> in <citetitle remap="book">System Administration Guide: Security Services</citetitle></olink></para>
</entry>
</row><row><entry><para>The Security Administrator role assigns a profile with the site-specific
authorizations to the user.</para>
</entry><entry><para><olink targetptr="managedev-16" remap="internal">Customizing Device Authorizations in
Trusted Extensions (Task Map)</olink></para>
</entry>
</row><row><entry><para>Configure a device.</para>
</entry><entry><para>Chooses security features to protect the device.</para>
</entry><entry><para><olink targetptr="managedev-53" remap="internal">How to Configure a Device in Trusted
Extensions</olink></para>
</entry>
</row><row><entry morerows="1" rowsep="1"><para>Revoke or reclaim a device.</para>
</entry><entry><para>Uses the Device Allocation Manager to make a device available for use.</para>
</entry><entry><para><olink targetptr="managedev-31" remap="internal">How to Revoke or Reclaim a Device in
Trusted Extensions</olink></para>
</entry>
</row><row><entry><para>Uses Solaris commands to make a device available or unavailable
for use.</para>
</entry><entry><para><olink targetdoc="group-sa" targetptr="devtask-13" remap="external"><citetitle remap="section">Forcibly Allocating a Device</citetitle> in <citetitle remap="book">System Administration Guide: Security Services</citetitle></olink></para><para><olink targetdoc="group-sa" targetptr="devtask-31" remap="external"><citetitle remap="section">Forcibly Deallocating a Device</citetitle> in <citetitle remap="book">System Administration Guide: Security Services</citetitle></olink></para>
</entry>
</row><row><entry morerows="1" rowsep="1"><para>Prevent access to an allocatable device.</para>
</entry><entry><para>Provides fine&ndash;grained access control to a device.</para>
</entry><entry><para><olink targetptr="managedev-41" remap="internal">Example&nbsp;23&ndash;4</olink></para>
</entry>
</row><row><entry><para>Denies everyone access to an allocatable device.</para>
</entry><entry><para><olink targetptr="managedev-19" remap="internal">Example&nbsp;23&ndash;1</olink></para>
</entry>
</row><row><entry><para>Protect printers and frame buffers.</para>
</entry><entry><para>Ensures that nonallocatable devices are not allocatable.</para>
</entry><entry><para><olink targetptr="managedev-26" remap="internal">How to Protect Nonallocatable Devices
in Trusted Extensions</olink></para>
</entry>
</row><row><entry><para>Configure serial login devices.</para>
</entry><entry><para>Enables logins by serial port.</para>
</entry><entry><para><olink targetptr="managedev-54" remap="internal">How to Configure a Serial Line for Logins</olink></para>
</entry>
</row><row><entry><para>Enable a CD player program to be used.</para>
</entry><entry><para>Enables an audio player program to open automatically when a music CD
is inserted.</para>
</entry><entry><para><olink targetptr="managedev-29" remap="internal">How to Configure an Audio Player Program
for Use in Trusted CDE</olink></para>
</entry>
</row><row><entry><para>Prevent the File Manager from displaying.</para>
</entry><entry><para>Prevents the File Manager from displaying after a device has been allocated.</para>
</entry><entry><para><olink targetptr="managedev-21" remap="internal">How to Prevent the File Manager From
Displaying After Device Allocation</olink></para>
</entry>
</row><row><entry><para>Use a new device-clean script.</para>
</entry><entry><para>Places a new script in the appropriate places.</para>
</entry><entry><para><olink targetptr="managedev-57" remap="internal">How to Add a Device_Clean Script in
Trusted Extensions</olink></para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable><task id="managedev-53"><title>How to Configure a Device in Trusted Extensions</title><indexterm><primary>configuring</primary><secondary>devices</secondary>
</indexterm><indexterm><primary>devices</primary><secondary>configuring devices</secondary>
</indexterm><indexterm><primary>devices</primary><secondary>administering with Device Allocation Manager</secondary>
</indexterm><indexterm><primary>Device Allocation Manager</primary><secondary>use by administrators</secondary>
</indexterm><indexterm><primary>Security Administrator role</primary><secondary>configuring a device</secondary>
</indexterm><tasksummary><para>By default, an allocatable device has a label range from <constant>ADMIN_LOW</constant> to <constant>ADMIN_HIGH</constant> and must be allocated for use.
Also, users must be authorized to allocate the device. These defaults can
be changed.</para>
</tasksummary><taskprerequisites><para>You must be in the Security Administrator role in the global zone.</para>
</taskprerequisites><procedure><step><para>From the Trusted Path menu, select Allocate Device.</para><para>The
Device Allocation Manager appears.</para><mediaobject><imageobject><imagedata entityref="devmgr.tiff"/>
</imageobject><textobject><simpara>Dialog box titled Device Allocation Administration shows
the default security settings for an audio device for an ordinary user.</simpara>
</textobject>
</mediaobject>
</step><step><para>View the default security settings.</para><para>Click Device Administration,
then highlight the device. The following figure shows a CD-ROM drive with
default security settings.</para><mediaobject><imageobject><imagedata entityref="devconfig.tiff"/>
</imageobject><textobject><simpara>Dialog box titled Device Allocation Configuration shows
the default security settings for a CD-ROM drive.</simpara>
</textobject>
</mediaobject>
</step><step performance="optional"><para>Restrict the label range on the device.</para><substeps><step><para>Set the minimum label.</para><para>Click the Min Label... button.
Choose a minimum label from the label builder. For information about the label
builder, see <olink targetptr="txtool-5" remap="internal">Label Builder in Trusted Extensions</olink>.</para>
</step><step><para>Set the maximum label.</para><para>Click the Max Label... button.
Choose a maximum label from the label builder.</para>
</step>
</substeps>
</step><step><para>Specify if the device can be allocated locally.</para><para>In
the Device Allocation Configuration dialog box, under For Allocations From
Trusted Path, select an option from the Allocatable By list. By default, the
Authorized Users option is checked. Therefore, the device is allocatable and
users must be authorized.</para><stepalternatives><step><para>To make the device nonallocatable, click No Users.</para><para>When
configuring a printer, frame buffer, or other device that must not be allocatable,
select No Users.</para>
</step><step><para>To make the device allocatable, but to not require authorization,
click All Users.</para>
</step>
</stepalternatives>
</step><step><para>Specify if the device can be allocated remotely.</para><para>In
the For Allocations From Non-Trusted Path section, select an option from the
Allocatable By list. By default, the Same As Trusted Path option is checked.</para><stepalternatives><step><para>To require user authorization, select Allocatable by Authorized
Users.</para>
</step><step><para>To make the device nonallocatable by remote users, select No Users.</para>
</step><step><para>To make the device allocatable by anyone, select All Users.</para>
</step>
</stepalternatives>
</step><step><para>If the device is allocatable, <emphasis>and</emphasis> your site
has created new device authorizations, select the appropriate authorization.</para><para>The following dialog box shows the <literal>solaris.device.allocate</literal> authorization
is required to allocate the <literal>cdrom0</literal> device.</para><mediaobject><imageobject><imagedata entityref="devauth.tiff"/>
</imageobject><textobject><simpara>Dialog box titled Device Allocation Authorizations shows
the authorizations of a device.</simpara>
</textobject>
</mediaobject><para>To create and use site-specific device authorizations, see <olink targetptr="managedev-16" remap="internal">Customizing Device Authorizations in Trusted Extensions
(Task Map)</olink>.</para>
</step><step><para>To save your changes, click OK.</para>
</step>
</procedure>
</task><task id="managedev-31"><title>How to Revoke or Reclaim a Device in Trusted Extensions</title><indexterm><primary>deallocating</primary><secondary>forcing</secondary>
</indexterm><indexterm><primary>devices</primary><secondary>reclaiming</secondary>
</indexterm><indexterm><primary>System Administrator role</primary><secondary>reclaiming a device</secondary>
</indexterm><indexterm><primary>troubleshooting</primary><secondary>reclaiming a device</secondary>
</indexterm><indexterm><primary>devices</primary><secondary>troubleshooting</secondary>
</indexterm><indexterm><primary>allocate error state</primary><secondary>correcting</secondary>
</indexterm><tasksummary><para>If a device is not listed in the Device Allocation Manager, it might
already be allocated or it might be in an allocate error state. The system
administrator can recover the device for use.</para>
</tasksummary><taskprerequisites><para>You must be in the System Administrator role in the global zone. This
role includes the <constant>solaris.device.revoke</constant> authorization.</para>
</taskprerequisites><procedure><step><para>From the Trusted Path menu, select Allocate Device.</para><para>In
the following figure, the audio device is already allocated to a user.</para><mediaobject><imageobject><imagedata entityref="devaudioint.tiff"/>
</imageobject><textobject><simpara>Dialog box titled Device Allocation Administration shows
the devices that can be administered, and the allocation status of the audio
device.</simpara>
</textobject>
</mediaobject>
</step><step><para>Click the Device Administration button.</para>
</step><step><para>Check the status of a device.</para><para>Select the device name
and check the State field.</para><stepalternatives><step><para>If the State field is Allocate Error State, click the Reclaim
button.</para>
</step><step><para>If the State field is Allocated, do one of the following:</para><stepalternatives><step><para>Ask the user in the Owner field to deallocate the device.</para>
</step><step><para>Force deallocation of the device by clicking the Revoke button.</para>
</step>
</stepalternatives>
</step>
</stepalternatives>
</step><step><para>Close the Device Allocation Manager.</para>
</step>
</procedure>
</task><task id="managedev-26"><title>How to Protect Nonallocatable Devices
in Trusted Extensions</title><indexterm><primary>devices</primary><secondary>protecting nonallocatable</secondary>
</indexterm><indexterm><primary>nonallocatable devices</primary><secondary>protecting</secondary>
</indexterm><indexterm><primary>Security Administrator role</primary><secondary>protecting nonallocatable devices</secondary>
</indexterm><indexterm><primary>protecting</primary><secondary>nonallocatable devices</secondary>
</indexterm><tasksummary><para>The No Users option in the Allocatable By section of the Device Configuration
dialog box is used most often for the frame buffer and printer, which do not
have to be allocated to be used.</para>
</tasksummary><taskprerequisites><para>You must be in the Security Administrator role in the global zone.</para>
</taskprerequisites><procedure><step><para>From the Trusted Path menu, select  Allocate Device.</para>
</step><step><para>In the Device Allocation Manager, click the Device Administration
button.</para>
</step><step><para>Select the new printer or frame buffer.</para><substeps><step><para>To make the device nonallocatable, click No Users.</para>
</step><step performance="optional"><para>Restrict the label range on the device.</para><substeps><step><para>Set the minimum label.</para><para>Click the Min Label... button.
Choose a minimum label from the label builder. For information about the label
builder, see <olink targetptr="txtool-5" remap="internal">Label Builder in Trusted Extensions</olink>.</para>
</step><step><para>Set the maximum label.</para><para>Click the Max Label... button.
Choose a maximum label from the label builder.</para>
</step>
</substeps>
</step>
</substeps>
</step>
</procedure><example id="managedev-19"><title>Preventing Remote Allocation of the Audio Device</title><para><indexterm><primary>protecting</primary><secondary>devices from remote allocation</secondary></indexterm><indexterm><primary>audio devices</primary><secondary>preventing remote allocation</secondary></indexterm><indexterm><primary>devices</primary><secondary>preventing remote allocation of audio</secondary></indexterm>The No Users option in the Allocatable By section prevents remote
users from hearing conversations around a remote system.</para><para>The security administrator configures the audio device in the Device
Allocation Manager as follows:</para><screen>Device Name: audio
For Allocations From: Trusted Path
Allocatable By: Authorized Users
Authorizations: solaris.device.allocate</screen><screen>Device Name: audio
For Allocations From: Non-Trusted Pathh
Allocatable By: No Users</screen>
</example>
</task><task id="managedev-54"><title>How to Configure a Serial Line for
Logins</title><indexterm><primary>devices</primary><secondary>configuring serial line</secondary>
</indexterm><indexterm><primary>serial line</primary><secondary>configuring for logins</secondary>
</indexterm><indexterm><primary>login</primary><secondary>configuring serial line</secondary>
</indexterm><indexterm><primary>Security Administrator role</primary><secondary>configuring serial line for login</secondary>
</indexterm><indexterm><primary>administering</primary><secondary>serial line for login</secondary>
</indexterm><indexterm><primary>configuring</primary><secondary>serial line for login</secondary>
</indexterm><taskprerequisites><para>You must be in the Security Administrator role in the global zone.</para>
</taskprerequisites><procedure><step><para>Open the Solaris Management Console in the Files scope.</para><figure id="managedev-fig-2"><title>Serial Ports Tool in the Solaris Management Console</title><mediaobject><imageobject><imagedata entityref="smc.serial.port.panel.tiff"/>
</imageobject><textobject><simpara>Window shows the Navigation pane of the Trusted Extensions
toolbox in Files scope. The Devices and Hardware node is visible.</simpara>
</textobject>
</mediaobject>
</figure>
</step><step><para>Under Devices and Hardware, navigate to Serial Ports.</para><para>Provide
a password when prompted. Follow the online help to configure the serial port.</para>
</step><step><para>To change the default label range, open the Device Allocation
Manager.</para><para>The default label range is <constant>ADMIN_LOW</constant> to <constant>ADMIN_HIGH</constant>.</para>
</step>
</procedure><example id="managedev-37"><title>Restricting the Label Range of a Serial Port</title><para>After creating a serial login device, the security administrator restricts
the label range of the serial port to a single label, <literal>Public</literal>.
The administrator sets the following values in the Device Administration dialog
boxes.</para><screen>Device Name: /dev/term/[a|b]
Device Type: tty
Clean Program: /bin/true
Device Map: /dev/term/[a|b]
Minimum Label: Public
Maximum Label: Public
Allocatable By: No Users</screen>
</example>
</task><task id="managedev-29"><title>How to Configure an Audio Player Program for
Use in Trusted CDE</title><indexterm><primary>devices</primary><secondary>setting up audio</secondary>
</indexterm><indexterm><primary>devices</primary><secondary>automatically starting an audio player</secondary>
</indexterm><indexterm><primary>audio devices</primary><secondary>automatically starting an audio player</secondary>
</indexterm><indexterm><primary>CD-ROM drives</primary><secondary>playing music automatically</secondary>
</indexterm><indexterm><primary>System Administrator role</primary><secondary>enabling music to play automatically</secondary>
</indexterm><indexterm><primary><filename>/etc/rmmount.conf</filename> file</primary>
</indexterm><indexterm><primary><filename>rmmount.conf</filename> file</primary>
</indexterm><indexterm><primary>files</primary><secondary><filename>/etc/rmmount.conf</filename></secondary>
</indexterm><indexterm><primary>administering</primary><secondary>audio device to play music</secondary>
</indexterm><indexterm><primary>configuring</primary><secondary>audio device to play music</secondary>
</indexterm><tasksummary><para>The following procedure enables an audio player to open automatically
in a Trusted CDE workspace when a user inserts a music CD. For the user's procedure,
see the example in <olink targetdoc="trssug" targetptr="ugelem-27" remap="external"><citetitle remap="section">How to Allocate a Device in Trusted Extensions</citetitle> in <citetitle remap="book">Solaris Trusted Extensions User&rsquo;s Guide</citetitle></olink>.</para><note><para>In a Trusted GNOME workspace, users
specify the behavior of removable media just as they specify it in a non-trusted
workspace.</para>
</note>
</tasksummary><taskprerequisites><para>You must be in the System Administrator role in the global zone.</para>
</taskprerequisites><procedure><step><para>Edit the <filename>/etc/rmmount.conf</filename> file.</para><para>Use
the trusted editor. For details, see <olink targetptr="roles-10" remap="internal">How to Edit
Administrative Files in Trusted Extensions</olink>.</para>
</step><step><para>Add your site's CD player program to the <literal>cdrom</literal> action
in the file.</para><screen>action <replaceable>media</replaceable> action_<replaceable>program</replaceable>.so <replaceable>path-to-program</replaceable></screen>
</step>
</procedure><example id="managedev-17"><title>Configuring an Audio Player Program for Use</title><para>In the following example, the system administrator makes the <literal>workman</literal> program available to all users of a system. The <command>workman</command> program
is an audio player program.</para><screen># /etc/rmmount.conf file
<userinput>action cdrom action_workman.so /usr/local/bin/workman</userinput></screen>
</example>
</task><task id="managedev-21"><title>How to Prevent the File Manager From
Displaying After Device Allocation</title><indexterm><primary>File Manager</primary><secondary>preventing display after device allocation</secondary>
</indexterm><indexterm><primary>device allocation</primary><secondary>preventing File Manager display</secondary>
</indexterm><indexterm><primary>System Administrator role</primary><secondary>preventing File Manager display</secondary>
</indexterm><indexterm><primary><filename>/etc/rmmount.conf</filename> file</primary>
</indexterm><indexterm><primary><filename>rmmount.conf</filename> file</primary>
</indexterm><tasksummary><para>By default, the File Manager displays when a device is mounted. If you
are not mounting devices that have file systems, you might want to prevent
the File Manager from displaying.</para>
</tasksummary><taskprerequisites><para>You must be in the System Administrator role in the global zone.</para>
</taskprerequisites><procedure><step><para>Edit the <filename>/etc/rmmount.conf</filename> file.</para><para>Use
the trusted editor. For details, see <olink targetptr="roles-10" remap="internal">How to Edit
Administrative Files in Trusted Extensions</olink>.</para>
</step><step><para>Find the following <literal>filemgr</literal> actions:</para><screen>action cdrom action_filemgr.so
action floppy action_filemgr.so</screen>
</step><step><para>Comment out the appropriate action.</para><para>The following
example shows the <filename>action_filemgr.so</filename> actions commented
out for both the <literal>cdrom</literal> and <literal>diskette</literal> devices.</para><screen><userinput>#</userinput> action cdrom action_filemgr.so
<userinput>#</userinput> action floppy action_filemgr.so</screen><para>When a CDROM or diskette is allocated, the File Manager does not display.</para>
</step>
</procedure>
</task><task id="managedev-57"><title>How to Add a Device_Clean Script
in Trusted Extensions</title><indexterm><primary>System Administrator role</primary><secondary>adding <command>device_clean</command> script</secondary>
</indexterm><indexterm><primary>devices</primary><secondary>adding <command>device_clean</command> script</secondary>
</indexterm><indexterm><primary><command>device-clean</command> scripts</primary><secondary>adding to devices</secondary>
</indexterm><tasksummary><para>If no <filename>device_clean</filename> script is specified at the time
a device is created, the default script, <filename>/bin/true</filename>, is
used.</para>
</tasksummary><taskprerequisites><para>Have ready a script that purges all usable data from the physical device
and that returns <literal>0</literal> for success. For devices with removable
media, the script attempts to eject the media if the user does not do so.
The script puts the device into the allocate error state if the medium is
not ejected. For details about the requirements, see the <olink targetdoc="group-refman" targetptr="device-clean-5" remap="external"><citerefentry><refentrytitle>device_clean</refentrytitle><manvolnum>5</manvolnum></citerefentry></olink> man page.</para><para>You must be in the System Administrator role in the global zone.</para>
</taskprerequisites><procedure><step><para>Copy the script into the <filename>/etc/security/lib</filename> directory.</para>
</step><step><para>In the Device Administration dialog box, specify the full path
to the script.</para><substeps><step><para>Open the Device Allocation Manager.</para>
</step><step><para>Click the Device Administration button.</para>
</step><step><para>Select the name of the device, and click the Configure button.</para>
</step><step><para>In the Clean Program field, type the full path to the script.</para>
</step>
</substeps>
</step><step><para>Save your changes.</para>
</step>
</procedure>
</task>
</sect1><sect1 id="managedev-16"><title>Customizing Device Authorizations in Trusted Extensions (Task
Map)</title><indexterm><primary>tasks and task maps</primary><secondary>Customizing Device Authorizations in Trusted Extensions (Task Map)</secondary>
</indexterm><indexterm><primary>Customizing Device Authorizations in Trusted Extensions (Task Map)</primary>
</indexterm><para>The following task map describes procedures to change device authorizations
at your site.</para><informaltable frame="all" pgwide="1"><tgroup cols="3" colsep="1" rowsep="1"><colspec colname="colspec0" colwidth="109.90*"/><colspec colname="col2" colwidth="153.98*"/><colspec colname="colspec1" colwidth="132.12*"/><thead><row><entry><para>Task</para>
</entry><entry><para>Description</para>
</entry><entry><para>For Instructions</para>
</entry>
</row>
</thead><tbody><row><entry><para>Create new device authorizations.</para>
</entry><entry><para>Creates site-specific authorizations.</para>
</entry><entry><para><olink targetptr="managedev-10" remap="internal">How to Create New Device Authorizations</olink></para>
</entry>
</row><row><entry><para>Add authorizations to a device.</para>
</entry><entry><para>Adds site-specific authorizations to selected devices.</para>
</entry><entry><para><olink targetptr="managedev-42" remap="internal">How to Add Site-Specific Authorizations
to a Device in Trusted Extensions</olink></para>
</entry>
</row><row><entry><para>Assign device authorizations to users and roles.</para>
</entry><entry><para>Enables users and roles to use the new authorizations.</para>
</entry><entry><para><olink targetptr="managedev-38" remap="internal">How to Assign Device Authorizations</olink></para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable><task id="managedev-10"><title>How to Create New Device Authorizations</title><indexterm><primary>devices</primary><secondary>creating new authorizations</secondary>
</indexterm><indexterm><primary>authorizations</primary><secondary>adding new device authorizations</secondary>
</indexterm><indexterm><primary>administering</primary><secondary>device authorizations</secondary>
</indexterm><indexterm><primary>configuring</primary><secondary>authorizations for devices</secondary>
</indexterm><indexterm><primary>creating</primary><secondary>authorizations for devices</secondary>
</indexterm><tasksummary><para>If no authorization is specified at the time a device is created, by
default, all users can use the device. If an authorization is specified, then,
by default, only authorized users can use the device.</para><para>To prevent all access to an allocatable device without using authorizations,
see <olink targetptr="managedev-19" remap="internal">Example&nbsp;23&ndash;1</olink>.</para>
</tasksummary><taskprerequisites><para>You must be in the Security Administrator role in the global zone.</para>
</taskprerequisites><procedure><step><para>Edit the <filename>auth_attr</filename> file.</para><para>Use
the trusted editor. For details, see <olink targetptr="roles-10" remap="internal">How to Edit
Administrative Files in Trusted Extensions</olink>.</para>
</step><step><para>Create a heading for the new authorizations.</para><para>Use the
reverse-order Internet domain name of your organization followed by optional
additional arbitrary components, such as the name of your company. Separate
components by dots. End heading names with a dot.</para><screen><replaceable>domain-suffix</replaceable>.<replaceable>domain-prefix</replaceable>.<replaceable>optional</replaceable>.:::<replaceable>Company</replaceable> Header::help=<replaceable>Company</replaceable>.html</screen>
</step><step><para>Add new authorization entries.</para><para>Add the authorizations,
one authorization per line. The lines are split for display purposes. The
authorizations include <literal>grant</literal> authorizations that enable
administrators to assign the new authorizations.</para><screen><replaceable>domain-suffix</replaceable>.<replaceable>domain-prefix</replaceable>.grant:::Grant All <replaceable>Company</replaceable> Authorizations::
help=<replaceable>Company</replaceable>Grant.html
<replaceable>domain-suffix</replaceable>.<replaceable>domain-prefix</replaceable>.grant.device:::Grant <replaceable>Company</replaceable> Device Authorizations::
help=<replaceable>Company</replaceable>GrantDevice.html
<replaceable>domain-suffix</replaceable>.<replaceable>domain-prefix</replaceable>.device.allocate.tape:::Allocate Tape Device::
help=<replaceable>Company</replaceable>TapeAllocate.html
<replaceable>domain-suffix</replaceable>.<replaceable>domain-prefix</replaceable>.device.allocate.floppy:::Allocate Floppy Device::
help=<replaceable>Company</replaceable>FloppyAllocate.html</screen>
</step><step><para>Save the file and close the editor.</para>
</step><step><para>If you are using LDAP as your naming service, update the <literal>auth_attr</literal> entries on the Sun Java System Directory Server (LDAP server).</para><para>For information,
see the <olink targetdoc="group-refman" targetptr="ldapaddent-1m" remap="external"><citerefentry><refentrytitle>ldapaddent</refentrytitle><manvolnum>1M</manvolnum></citerefentry></olink> man page.</para>
</step><step><para>Add the new authorizations to the appropriate rights profiles.
Then assign the profiles to users and roles.</para><para>Use the Solaris Management Console. Assume
the Security Administrator role, then follow the Solaris procedure <olink targetdoc="group-sa" targetptr="rbactask-24" remap="external"><citetitle remap="section">How to Create or Change a Rights Profile</citetitle> in <citetitle remap="book">System Administration Guide: Security Services</citetitle></olink>.</para>
</step><step><para>Use the authorization to restrict access to tape and diskette
drives.</para><para>Add the new authorizations to the list of required authorizations
in the Device Allocation Manager. For the procedure, see <olink targetptr="managedev-42" remap="internal">How to Add Site-Specific Authorizations to a Device
in Trusted Extensions</olink>.</para>
</step>
</procedure><example id="managedev-41"><title>Creating Fine-Grained Device Authorizations</title><indexterm><primary>authorizations</primary><secondary>creating customized device authorizations</secondary>
</indexterm><para>A security administrator for NewCo needs to construct fine-grained device
authorizations for the company.</para><para>First, the administrator writes the following help files, and places
the files in the <filename class="directory">/usr/lib/help/auths/locale/C</filename> directory:</para><screen>Newco.html
NewcoGrant.html
NewcoGrantDevice.html
NewcoTapeAllocate.html
NewcoFloppyAllocate.html</screen><para>Next, the administrator adds a header for all of the authorizations
for <literal>newco.com</literal> in the <filename>auth_attr</filename> file.</para><screen># auth_attr file
com.newco.:::NewCo Header::help=Newco.html</screen><para>Next, the administrator adds authorization entries to the file:</para><screen>com.newco.grant:::Grant All NewCo Authorizations::
help=NewcoGrant.html
com.newco.grant.device:::Grant NewCo Device Authorizations::
help=NewcoGrantDevice.html
com.newco.device.allocate.tape:::Allocate Tape Device::
help=NewcoTapeAllocate.html
com.newco.device.allocate.floppy:::Allocate Floppy Device::
help=NewcoFloppyAllocate.html</screen><para>The lines are split for display purposes.</para><itemizedlist><para>The <filename>auth_attr</filename> entries create the following authorizations:</para><listitem><para>An authorization to grant all NewCo's authorizations</para>
</listitem><listitem><para>An authorization to grant NewCo's device authorizations</para>
</listitem><listitem><para>An authorization to allocate a tape drive</para>
</listitem><listitem><para>An authorization to allocate a diskette drive</para>
</listitem>
</itemizedlist>
</example><example id="managedev-43"><title>Creating Trusted Path and Non-Trusted Path Authorizations</title><indexterm><primary>authorizations</primary><secondary>creating local and remote device authorizations</secondary>
</indexterm><indexterm><primary>rights profiles</primary><secondary>with new device authorizations</secondary>
</indexterm><para>By default, the Allocate Devices authorization enables allocation from
the trusted path and from outside the trusted path.</para><para>In the following example, site security policy requires restricting
remote CD-ROM allocation. The security administrator creates the <literal>com.someco.device.cdrom.local</literal> authorization. This authorization is for CD-ROM drives that are
allocated with the trusted path. The <literal>com.someco.device.cdrom.remote</literal> authorization
is for those few users who are allowed to allocate a CD-ROM drive outside
the trusted path.</para><itemizedlist><para>The security administrator creates the help files, adds the authorizations
to the <filename>auth_attr</filename> database, adds the authorizations to
the devices, and then places the authorizations in rights profiles. The profiles
are assigned to users who are allowed to allocate devices.</para><listitem><para>The following are the <filename>auth_attr</filename> database
entries:</para><screen>com.someco.:::SomeCo Header::help=Someco.html
com.someco.grant:::Grant All SomeCo Authorizations::
help=SomecoGrant.html
com.someco.grant.device:::Grant SomeCo Device Authorizations::
help=SomecoGrantDevice.html
com.someco.device.cdrom.local:::Allocate Local CD-ROM Device::
help=SomecoCDAllocateLocal.html
com.someco.device.cdrom.remote:::Allocate Remote CD-ROM Device::
help=SomecoCDAllocateRemote.html</screen>
</listitem><listitem><para>The following is the Device Allocation Manager assignment:</para><para>The Trusted Path enables authorized users to use the Device Allocation
Manager when allocating the local CD-ROM drive.</para><screen>Device Name: cdrom_0
For Allocations From: <userinput>Trusted Path</userinput>
Allocatable By: Authorized Users
Authorizations: com.someco.device.cdrom.local</screen><para>The Non-Trusted Path enables users to allocate a device remotely by
using the <command>allocate</command> command.</para><screen>Device Name: cdrom_0
For Allocations From: <userinput>Non-Trusted Path</userinput>
Allocatable By: Authorized Users
Authorizations: com.someco.device.cdrom.remote</screen>
</listitem><listitem><para>The following are the rights profile entries:</para><screen># Local Allocator profile
com.someco.device.cdrom.local

# Remote Allocator profile
com.someco.device.cdrom.remote</screen>
</listitem><listitem><para>The following are the rights profiles for authorized users:</para><screen># List of profiles for regular authorized user
Local Allocator Profile
...

# List of profiles for role or authorized user
Remote Allocator Profile
...</screen>
</listitem>
</itemizedlist>
</example>
</task><task id="managedev-42"><title>How to Add Site-Specific Authorizations to
a Device in Trusted Extensions</title><indexterm><primary>devices</primary><secondary>adding customized authorizations</secondary>
</indexterm><indexterm><primary>customizing</primary><secondary>device authorizations</secondary>
</indexterm><indexterm><primary>authorizations</primary><secondary>customizing for devices</secondary>
</indexterm><taskprerequisites><para>You must be in the Security Administrator role, or in a role that includes
the Configure Device Attributes authorization. You must have already created
site-specific authorizations, as described in <olink targetptr="managedev-10" remap="internal">How
to Create New Device Authorizations</olink>.</para>
</taskprerequisites><procedure><step><para>Follow the <olink targetptr="managedev-53" remap="internal">How to Configure a
Device in Trusted Extensions</olink> procedure.</para><substeps><step><para>Select a device that needs to be protected with your new authorizations.</para>
</step><step><para>Open the Device Administration dialog box.</para>
</step><step><para>In the Device Configuration dialog box, click the Authorizations
button.</para><para>The new authorizations are displayed in the Not Required
list.</para>
</step><step><para>Add the new authorizations to the Required list of authorizations.</para>
</step>
</substeps>
</step><step><para>To save your changes, click OK.</para>
</step>
</procedure>
</task><task id="managedev-38"><title>How to Assign Device Authorizations</title><indexterm><primary>authorizing</primary><secondary>device allocation</secondary>
</indexterm><indexterm><primary>device allocation</primary><secondary>authorizing</secondary>
</indexterm><indexterm><primary>authorizations</primary><secondary>assigning device authorizations</secondary>
</indexterm><indexterm><primary>Allocate Device authorization</primary>
</indexterm><indexterm><primary>authorizations</primary><secondary>Allocate Device</secondary>
</indexterm><indexterm><primary>Revoke or Reclaim Device authorization</primary>
</indexterm><indexterm><primary>authorizations</primary><secondary>Revoke or Reclaim Device</secondary>
</indexterm><indexterm><primary>administering</primary><secondary>device allocation</secondary>
</indexterm><indexterm><primary>administering</primary><secondary>assigning device authorizations</secondary>
</indexterm><tasksummary><para>The Allocate Device authorization enables users to allocate a device.
The Allocate Device authorization, and the Revoke or Reclaim Device authorization,
are appropriate for administrative roles.</para>
</tasksummary><taskprerequisites><para>You must be in the Security Administrator role in the global zone.</para><para>If the existing profiles are not appropriate, the security administrator
can create a new profile. For an example, see <olink targetptr="manageusers-40" remap="internal">How
to Create a Rights Profile for Convenient Authorizations</olink>.</para>
</taskprerequisites><procedure remap="single-step"><step><para><indexterm><primary>rights profiles</primary><secondary>with Allocate Device authorization</secondary></indexterm>Assign to the user a rights profile
that contains the Allocate Device authorization.</para><para>For assistance,
see the online help. For the step-by-step procedure, see <olink targetdoc="group-sa" targetptr="rbactask-25" remap="external"><citetitle remap="section">How to Change the RBAC Properties of a User</citetitle> in <citetitle remap="book">System Administration Guide: Security Services</citetitle></olink>.</para><itemizedlist><para><indexterm><primary>authorizations</primary><secondary>profiles that include device allocation authorizations</secondary></indexterm><indexterm><primary>device allocation</primary><secondary>profiles that include allocation authorizations</secondary></indexterm><indexterm><primary>rights profiles</primary><secondary>with device allocation authorizations</secondary></indexterm><indexterm><primary>Allocate Device authorization</primary></indexterm><indexterm><primary>authorizations</primary><secondary>Allocate Device</secondary></indexterm>The following
profiles enable a role to allocate devices:</para><listitem><para>All Authorizations</para>
</listitem><listitem><para>Device Management</para>
</listitem><listitem><para>Media Backup</para>
</listitem><listitem><para>Media Restore</para>
</listitem><listitem><para>Object Label Management</para>
</listitem><listitem><para>Software Installation</para>
</listitem>
</itemizedlist><itemizedlist><para><indexterm><primary>Revoke or Reclaim Device authorization</primary></indexterm><indexterm><primary>authorizations</primary><secondary>Revoke or Reclaim Device</secondary></indexterm>The following profiles enable a role
to revoke or reclaim devices:</para><listitem><para>All Authorizations</para>
</listitem><listitem><para>Device Management</para>
</listitem>
</itemizedlist><itemizedlist><para><indexterm><primary>Configure Device Attributes authorization</primary></indexterm><indexterm><primary>authorizations</primary><secondary>Configure Device Attributes</secondary></indexterm>The following profiles enable a role
to create or configure devices:</para><listitem><para>All Authorizations</para>
</listitem><listitem><para>Device Security</para>
</listitem>
</itemizedlist>
</step>
</procedure><example id="managedev-15"><title>Assigning New Device Authorizations</title><orderedlist><para>In this example, the security administrator configures the new device
authorizations for the system and assigns the rights profile with the new
authorizations to trustworthy users. The security administrator does the following:</para><listitem><para>Creates new device authorizations, as in <olink targetptr="managedev-10" remap="internal">How to Create New Device Authorizations</olink></para>
</listitem><listitem><para>In the Device Allocation Manager, adds the new device authorizations
to the tape and diskette drives</para>
</listitem><listitem><para>Places the new authorizations in the rights profile, NewCo
Allocation</para>
</listitem><listitem><para>Adds the NewCo Allocation rights profile to the profiles of
users and roles who are authorized to allocate tape and diskette drives</para>
</listitem>
</orderedlist><para>Authorized users and roles can now use the tape drives and diskette
drives on this system.</para>
</example>
</task>
</sect1>
</chapter><?Pub *0000046544 0?>