<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Adding Network Interfaces and Routing to Labeled Zones - Solaris Trusted Extensions Administrator's Procedures</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2009-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">Solaris Trusted Extensions Administrator's Procedures</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="txconf-20.html">Previous</a>
             </td>
             <td align="right">
                 <a href="txconf-14.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-4.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="trp-part-1.html">Part&nbsp;I&nbsp;Initial Configuration of Trusted Extensions</a></p>
<p class="toc level2"><a href="ovw-1.html">1.&nbsp;&nbsp;Security Planning for Trusted Extensions</a></p>
<p class="toc level2"><a href="tmap-1.html">2.&nbsp;&nbsp;Configuration Roadmap for Trusted Extensions</a></p>
<p class="toc level2"><a href="startinst-1.html">3.&nbsp;&nbsp;Adding Solaris Trusted Extensions Software to the Solaris OS (Tasks)</a></p>
<p class="toc level2"><a href="txconf-1.html">4.&nbsp;&nbsp;Configuring Trusted Extensions (Tasks)</a></p>
<p class="toc level3"><a href="txconf-60.html">Setting Up the Global Zone in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-20.html">Creating Labeled Zones</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Adding Network Interfaces and Routing to Labeled Zones</a></p>
</div>
<p class="toc level3"><a href="txconf-14.html">Creating Roles and Users in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-50.html">Creating Home Directories in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-64.html">Adding Users and Hosts to an Existing Trusted Network</a></p>
<p class="toc level3"><a href="txconf-trouble-1.html">Troubleshooting Your Trusted Extensions Configuration</a></p>
<p class="toc level3"><a href="txconf-18.html">Additional Trusted Extensions Configuration Tasks</a></p>
<p class="toc level2 tocsp"><a href="txldap-1.html">5.&nbsp;&nbsp;Configuring LDAP for Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="headl-1.html">6.&nbsp;&nbsp;Configuring a Headless System With Trusted Extensions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="trp-part-2.html">Part&nbsp;II&nbsp;Administration of Trusted Extensions</a></p>
<p class="toc level2"><a href="txintro-1.html">7.&nbsp;&nbsp;Trusted Extensions Administration Concepts</a></p>
<p class="toc level2"><a href="txtool-1.html">8.&nbsp;&nbsp;Trusted Extensions Administration Tools</a></p>
<p class="toc level2"><a href="roles-1.html">9.&nbsp;&nbsp;Getting Started as a Trusted Extensions Administrator (Tasks)</a></p>
<p class="toc level2"><a href="secreq-1.html">10.&nbsp;&nbsp;Security Requirements on a Trusted Extensions System (Overview)</a></p>
<p class="toc level2"><a href="commontasks-1.html">11.&nbsp;&nbsp;Administering Security Requirements in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="useraccts-1.html">12.&nbsp;&nbsp;Users, Rights, and Roles in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="manageusers-1.html">13.&nbsp;&nbsp;Managing Users, Rights, and Roles in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="remotead-1.html">14.&nbsp;&nbsp;Remote Administration in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="manageldap-1.html">15.&nbsp;&nbsp;Trusted Extensions and LDAP (Overview)</a></p>
<p class="toc level2"><a href="managezones-1.html">16.&nbsp;&nbsp;Managing Zones in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="managefiles-1.html">17.&nbsp;&nbsp;Managing and Mounting Files in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="txnet-1.html">18.&nbsp;&nbsp;Trusted Networking (Overview)</a></p>
<p class="toc level2"><a href="managetnet-1.html">19.&nbsp;&nbsp;Managing Networks in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="managemail-1.html">20.&nbsp;&nbsp;Multilevel Mail in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="manageprint-1.html">21.&nbsp;&nbsp;Managing Labeled Printing (Tasks)</a></p>
<p class="toc level2"><a href="gentextid-15538.html">22.&nbsp;&nbsp;Devices in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="managedev-1.html">23.&nbsp;&nbsp;Managing Devices for Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="audtask-1.html">24.&nbsp;&nbsp;Trusted Extensions Auditing (Overview)</a></p>
<p class="toc level2"><a href="softmgt-1.html">25.&nbsp;&nbsp;Software Management in Trusted Extensions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="appol-1.html">A.&nbsp;&nbsp;Site Security Policy</a></p>
<p class="toc level2"><a href="appol-12.html">Creating and Managing a Security Policy</a></p>
<p class="toc level2"><a href="appol-11.html">Site Security Policy and Trusted Extensions</a></p>
<p class="toc level2"><a href="appol-2.html">Computer Security Recommendations</a></p>
<p class="toc level2"><a href="appol-3.html">Physical Security Recommendations</a></p>
<p class="toc level2"><a href="appol-4.html">Personnel Security Recommendations</a></p>
<p class="toc level2"><a href="appol-5.html">Common Security Violations</a></p>
<p class="toc level2"><a href="appol-6.html">Additional Security References</a></p>
<p class="toc level1 tocsp"><a href="aptxconf-1.html">B.&nbsp;&nbsp;Using CDE Actions to Install Zones in Trusted Extensions</a></p>
<p class="toc level2"><a href="aptxconf-62.html">Associating Network Interfaces With Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level2"><a href="aptxconf-40.html">Preparing to Create Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level2"><a href="aptxconf-20.html">Creating Labeled Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level1 tocsp"><a href="checklist-1.html">C.&nbsp;&nbsp;Configuration Checklist for Trusted Extensions</a></p>
<p class="toc level2"><a href="checklist-2.html">Checklist for Configuring Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="txapp-1.html">D.&nbsp;&nbsp;Quick Reference to Trusted Extensions Administration</a></p>
<p class="toc level2"><a href="txapp-2.html">Administrative Interfaces in Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-3.html">Solaris Interfaces Extended by Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-4.html">Tighter Security Defaults in Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-5.html">Limited Options in Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="txmp-1.html">E.&nbsp;&nbsp;List of Trusted Extensions Man Pages</a></p>
<p class="toc level2"><a href="txmp-2.html">Trusted Extensions Man Pages in Alphabetical Order</a></p>
<p class="toc level2"><a href="txmp-3.html">Solaris Man Pages That Are Modified by Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="txconf-98"></a><h3>Adding Network Interfaces and Routing to Labeled Zones</h3>
<p>The following tasks support environments where each zone is connected to a separate
physical network.</p><table><col width="22%"><col width="45%"><col width="31%"><tr><th align="left" valign="top" scope="column"><p>Task</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>For Instructions</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>EITHER 1a: Add a network interface to each labeled zone
and use the global zone to reach the external network.</p></td>
<td align="left" valign="top" scope="row"><p>Connects each labeled zone
to a separate physical network. The labeled zones use the network routing that
the global zone provides.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#txconf-84">Add a Network Interface to Route an Existing Labeled Zone</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>OR 1b: Add a network interface to each labeled
zone with a default route.</p></td>
<td align="left" valign="top" scope="row"><p>Connects each zone to a separate physical network.
The labeled zones do <b>not</b> use the global zone for routing.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#txconf-96">Add a Network Interface That Does Not Use the Global Zone to Route an Existing Labeled Zone</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>2. Create a
name service cache in each labeled zone.</p></td>
<td align="left" valign="top" scope="row"><p>Configures a name service daemon for
each zone.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#txconf-94">Configure a Name Service Cache in Each Labeled Zone</a></p></td>
</tr>
</table>

<a name="txconf-84"></a><h4>Add a Network Interface to Route an Existing Labeled Zone</h4><a name="indexterm-180"></a><a name="indexterm-181"></a><a name="indexterm-182"></a><p>This procedure adds zone-specific network interfaces to existing labeled zones. This configuration supports
environments where each labeled zone is connected to a separate physical network. The
labeled zones use the network routing that the global zone provides.</p>
<hr><p><b>Note - </b>The global zone must configure an IP address for every subnet in which
a non-global zone address is configured.</p>
<hr>
<h6>Before You Begin</h6><p>You are superuser in the global zone.</p><p>For every zone, you have completed the tasks in <a href="txconf-20.html">Creating Labeled Zones</a>.</p><ol>
<li><b>In the global zone, type the IP addresses and hostnames for the additional
network interfaces into the <tt>/etc/hosts</tt> file.</b><p>Use a standard naming convention, such as adding <i>-zone-name</i> to the name of
the host.</p><pre>## /etc/hosts in global zone
10.10.8.2   <i>hostname-zone-name1</i>
10.10.8.3   <i>hostname-global-name1</i>
10.10.9.2   <i>hostname-zone-name2</i>
10.10.9.3   <i>hostname-global-name2</i></pre></li>
<li><b>For the network for each interface, add entries to the <tt>/etc/netmasks</tt> file.</b><pre>## /etc/netmasks in global zone
10.10.8.0 255.255.255.0
10.10.9.0 255.255.255.0</pre><p>For more information, see the <a href="http://docs.sun.com/doc/819-2251/netmasks-4?a=view"><tt>netmasks</tt>(4)</a> man page.</p></li>
<li><b>In the global zone, plumb the zone-specific physical interfaces.</b><ol style="list-style-type: lower-alpha">
<li><b>Identify the physical interfaces that are already plumbed.</b><pre># <tt><b>ifconfig -a</b></tt></pre></li>
<li><b>Configure the global zone addresses on each interface.</b><pre># ifconfig <i>interface-nameN1</i> plumb
# ifconfig <i>interface-nameN1</i> 10.10.8.3 up
# ifconfig <i>interface-nameN2</i> plumb
# ifconfig <i>interface-nameN2</i> 10.10.9.3 up</pre></li>
<li><b>For each global zone address, create a <tt>hostname.</tt><i>interface-nameN</i> file.</b><pre># /etc/hostname.<i>interface-nameN1</i>
10.10.8.3
# /etc/hostname.<i>interface-nameN2</i>
10.10.9.3</pre></li></ol><p>The global zone addresses are configured immediately upon system startup. The zone-specific addresses
are configured when the zone is booted.</p></li>
<li><b>Assign a security template to each zone-specific network interface.</b><p>If the gateway to the network is not configured with labels, assign the
<tt>admin_low</tt> security template. If the gateway to the network is labeled, assign a
<tt>cipso</tt> security template. </p><p>You can create security templates of host type <tt>cipso</tt> that reflect the label
of every network. For the procedures to create and assign the templates, see
<a href="managetnet-3.html">Configuring Trusted Network Databases (Task Map)</a>.</p></li>
<li><b>Halt every labeled zone to which you plan to add a zone-specific interface.</b><pre># zoneadm -z <i>zone-name</i> halt</pre></li>
<li><b>Start the Labeled Zone Manager.</b><pre># <tt><b>/usr/sbin/txzonemgr</b></tt></pre></li>
<li><b>For each zone where you want to add a zone-specific interface, do the
following:</b><ol style="list-style-type: lower-alpha">
<li><b>Select the zone.</b></li>
<li><b>Select Add Network.</b></li>
<li><b>Name the network interface.</b></li>
<li><b>Type the IP address of the interface.</b></li></ol></li>
<li><b>In the Labeled Zone Manager for every completed zone, select Zone Console.</b></li>
<li><b>Select Boot.</b></li>
<li><b>In the Zone Console, verify that the interfaces have been created.</b><pre># <tt><b>ifconfig -a</b></tt></pre></li>
<li><b>Verify that the zone has a route to the gateway for the
subnet.</b><pre># <tt><b>netstat -rn</b></tt></pre></li></ol><h6>Troubleshooting</h6><p>To debug zone configuration, see the following:</p>
<ul><li><p><a href="http://docs.sun.com/doc/819-2450/gclkx?a=view">Chapter 28, Troubleshooting Miscellaneous Solaris Zones Problems, in <i>System Administration Guide: Virtualization Using the Solaris Operating System</i></a></p></li>
<li><p><a href="txconf-trouble-1.html">Troubleshooting Your Trusted Extensions Configuration</a></p></li>
<li><p><a href="managetnet-2.html">Troubleshooting the Trusted Network (Task Map)</a></p></li></ul>


<a name="txconf-96"></a><h4>Add a Network Interface That Does Not Use the Global Zone to Route an Existing Labeled Zone</h4><a name="indexterm-183"></a><a name="indexterm-184"></a><a name="indexterm-185"></a><a name="indexterm-186"></a><a name="indexterm-187"></a><a name="indexterm-188"></a><p>This procedure sets zone-specific default routes for existing labeled zones. In this configuration,
the labeled zones do <b>not</b> use the global zone for routing.</p><p>The labeled zone must be plumbed in the global zone before the
zone is booted. However, to isolate the labeled zone from the global zone,
the interface must be in the <tt>down</tt> state when the zone is booted. For
more information, see <a href="http://docs.sun.com/doc/819-2450/z.config.ov-1?a=view">Chapter 17, Non-Global Zone Configuration (Overview), in <i>System Administration Guide: Virtualization Using the Solaris Operating System</i></a>.</p>
<hr><p><b>Note - </b>A unique default route must be configured for every non-global zone that is
booted.</p>
<hr>
<h6>Before You Begin</h6><p>You are superuser in the global zone.</p><p>For every zone, you have completed the tasks in <a href="txconf-20.html">Creating Labeled Zones</a>. You are
using either the <tt>vni0</tt> interface or the <tt>lo0</tt> interface to connect the labeled zones
to the global zone.</p><ol>
<li><b>For every network interface, determine its IP address, netmask, and default router.</b><p>Use the <tt>ifconfig -a</tt> command to determine the IP address and netmask. Use the
<tt>zonecfg -z zonename info net</tt> command to determine if a default router has been assigned.</p></li>
<li><b>Create an empty <tt>/etc/hostname.</tt><i>interface</i><tt></tt> file for each labeled zone.</b><pre># touch /etc/hostname.<i>interface</i>
# touch /etc/hostname.<i>interface</i>:<i>n</i></pre><p>For more information, see the <a href="http://docs.sun.com/doc/819-2251/netmasks-4?a=view"><tt>netmasks</tt>(4)</a> man page.</p></li>
<li><b>Plumb the network interfaces of the labeled zones.</b><pre># ifconfig <i>zone1-network-interface</i> plumb
# ifconfig <i>zone2-network-interface</i> plumb</pre></li>
<li><b>Verify that the labeled zone's interfaces are in the <tt>down</tt> state.</b><pre># <tt><b>ifconfig -a</b></tt>
<i>zone1-network-interface</i> <i>zone1-IP-address</i> down
<i>zone2-network-interface</i> <i>zone2-IP-address</i> down</pre><p>The zone-specific addresses are configured when the zone is booted.</p></li>
<li><b>For the network for each interface, add entries to the <tt>/etc/netmasks</tt> file.</b><pre>## /etc/netmasks in global zone
192.168.2.0 255.255.255.0
192.168.3.0 255.255.255.0</pre><p>For more information, see the <a href="http://docs.sun.com/doc/819-2251/netmasks-4?a=view"><tt>netmasks</tt>(4)</a> man page.</p></li>
<li><b>Assign a security template to each zone-specific network interface.</b><p>Create security templates of host type <tt>cipso</tt> that reflect the label of every
network. To create and assign the templates, see <a href="managetnet-3.html">Configuring Trusted Network Databases (Task Map)</a>.</p></li>
<li><b>Run the <tt>txzonemgr</tt> script, and open a separate terminal window.</b><p>In the Labeled Zone Manager, you will add the network interfaces for the
labeled zones. In the terminal window, you will display information about the zone
and set the default router.</p></li>
<li><b>For every zone to which you are going to add a zone-specific
network interface and router, complete the following steps:</b><ol style="list-style-type: lower-alpha">
<li><b>In the terminal window, halt the zone.</b><pre># zoneadm -z <i>zone-name</i> halt</pre></li>
<li><b>In the Labeled Zone Manager, do the following:</b><ol style="list-style-type: lower-roman">
<li><b>Select the zone.</b></li>
<li><b>Select Add Network.</b></li>
<li><b>Name the network interface.</b></li>
<li><b>Type the IP address of the interface.</b></li>
<li><b>In the terminal window, verify the zone configuration.</b><pre># <tt><b>zonecfg -z </tt><i>zone-name</i><tt> info net</b></tt>
net:   address: <i>IP-address</i>
       physical: <i>zone-network-interface</i>
       defrouter not specified</pre></li></ol></li>
<li><b>In the terminal window, configure the default router for the labeled zone's network.</b><pre># <tt><b>zonecfg -z </tt><i>zone-name</i><tt></b></tt>
zonecfg:<i>zone-name</i> &gt; <tt><b>select net address=</b></tt><i>IP-address</i> 
zonecfg:<i>zone-name</i>:net&gt; <tt><b>set defrouter=</tt><i>router-address</i><tt></b></tt> 
zonecfg:<i>zone-name</i>:net&gt; <tt><b>end</b></tt> 
zonecfg:<i>zone-name</i> &gt; <tt><b>verify</b></tt> 
zonecfg:<i>zone-name</i> &gt; <tt><b>commit</b></tt> 
zonecfg:<i>zone-name</i> &gt; <tt><b>exit</b></tt> 
#</pre><p>For more information, see the <a href="http://docs.sun.com/doc/819-2240/zonecfg-1m?a=view"><tt>zonecfg</tt>(1M)</a> man page and <a href="http://docs.sun.com/doc/819-2450/z.conf.start-29?a=view">How to Configure the Zone in <i>System Administration Guide: Virtualization Using the Solaris Operating System</i></a>.</p></li>
<li><b>Boot the labeled zone.</b><pre># zoneadm -z <i>zone-name</i> boot</pre></li>
<li><b>In the global zone, verify that the labeled zone has a route
to the gateway for the subnet.</b><pre># <tt><b>netstat -rn</b></tt></pre><p>A routing table is displayed. The destination and interface for the labeled zone
is different from the entry for the global zone.</p></li></ol></li>
<li><b>To remove the default route, select the zone's IP address, then remove the
route.</b><pre># <tt><b>zonecfg -z </tt><i>zone-name</i><tt></b></tt>

zonecfg:<i>zone-name</i> &gt; <tt><b>select net address=</b></tt><i>zone-IP-address</i>
zonecfg:<i>zone-name</i>:net&gt; <tt><b>remove net defrouter=</b></tt><i>zone-default-route</i>
zonecfg:<i>zone-name</i>:net&gt;  <tt><b>info net</b></tt>
net:
   address: <i>zone-IP-address</i>
   physical: <i>zone-network-interface</i>
   defrouter not specified</pre></li></ol><a name="txconf-defrout-1"></a><h6>Example&nbsp;4-5 Setting a Default Route for a Labeled Zone</h6><p>In this example, the administrator routes the Secret zone to a separate physical
subnet. Traffic to and from the Secret zone is not routed through the
global zone. The administrator uses the Labeled Zone Manager and the <tt>zonecfg</tt>
command, then verifies that routing works.</p><p>The administrator determines that <tt>qfe1</tt> and <tt>qfe1:0</tt> are not currently in use.
and creates a mapping for two labeled zones. <tt>qfe1</tt> is the designated interface
for the Secret zone.</p><pre>Interface IP Address    Netmask        Default Router
qfe1     192.168.2.22 255.255.255.0 192.168.2.2
qfe1:0   192.168.3.33 255.255.255.0 192.168.3.3</pre><p>First, the administrator creates the <tt>/etc/hostname.qfe1</tt> file and configures the <tt>/etc/netmasks</tt> file.</p><pre># <tt><b>touch /etc/hostname.qfe1</b></tt></pre><pre># <tt><b>cat /etc/netmasks</b></tt>
## /etc/netmasks in global zone
192.168.2.0 255.255.255.0</pre><p>Then, the administrator plumbs the network interface and verifies that the interface is
down.</p><pre># <tt><b>ifconfig qfe1 plumb</b></tt>
# <tt><b>ifconfig -a</b></tt></pre><p>Then, in the Solaris Management Console, the administrator creates a security template
with a single label, Secret, and assigns the IP address of the interface
to the template.</p><p>The administrator halts the zone.</p><pre># <tt><b>zoneadm -z secret halt</b></tt></pre><p>The administrator runs the <tt>txzonemgr</tt> script to open the Labeled Zone Manager.</p><pre># <tt><b>/usr/sbin/txzonemgr</b></tt></pre><p>In the Labeled Zone Manager, the administrator selects the Secret zone, selects Add
Network, and then selects a network interface. The administrator closes the Labeled Zone
Manager.</p><p>On the command line, the administrator selects the zone's IP address, then sets
its default route. Before exiting the command, the administrator verifies the route and
commits it.</p><pre># <tt><b>zonecfg -z secret</b></tt>
zonecfg: secret &gt; <tt><b>select net address=192.168.6.22</b></tt> 
zonecfg: secret:net&gt; <tt><b>set defrouter=192.168.6.2</b></tt> 
zonecfg: secret:net&gt; <tt><b>end</b></tt> 
zonecfg: secret &gt; <tt><b>verify</b></tt> 
zonecfg: secret &gt; <tt><b>commit</b></tt> 
zonecfg: secret &gt; <tt><b>info net</b></tt> 
  net:
     address: 192.168.6.22
     physical: qfe1
     defrouter: 192.168.6.2
zonecfg: secret &gt; <tt><b>exit</b></tt> 
#</pre><p>The administrator boots the zone.</p><pre># <tt><b>zoneadm -z secret boot</b></tt></pre><p>In a separate terminal window in the global zone, the administrator verifies the
sending and receiving of packets.</p><pre># <tt><b>netstat -rn</b></tt>
Routing Table: IPv4
  Destination           Gateway           Flags  Ref     Use  Interface 
-------------------- -------------------- ----- ----- ------- --------- 
default              192.168.5.15         UG        1    2664 qfe0      
192.168.6.2          192.168.6.22         UG        1     240 qfe1      
192.168.3.3          192.168.3.33         U         1     183 qfe1:0    
127.0.0.1            127.0.0.1            UH        1     380 lo0       
...</pre>

<a name="txconf-94"></a><h4>Configure a Name Service Cache in Each Labeled Zone</h4><a name="indexterm-189"></a><a name="indexterm-190"></a><a name="indexterm-191"></a><a name="indexterm-192"></a><a name="indexterm-193"></a><a name="indexterm-194"></a><p>This procedure enables you to separately configure a name service daemon (<tt>nscd</tt>) in
each labeled zone. This configuration supports environments where each zone is connected to
a subnetwork that runs at the label of the zone, and the subnetwork
has its own name server for that label.</p>
<hr><p><b>Note - </b>This configuration does not satisfy the criteria for an evaluated configuration. In an
evaluated configuration, the <tt>nscd</tt> daemon runs only in the global zone. Doors in
each labeled zone connect the zone to the global <tt>nscd</tt> daemon.</p>
<hr>
<h6>Before You Begin</h6><p>You are superuser in the global zone. <tt>root</tt> must not yet be a
role. You have successfully completed <a href="#txconf-84">Add a Network Interface to Route an Existing Labeled Zone</a>.</p><p>This configuration requires that you have advanced networking skills. If LDAP is your
naming service, you are responsible for establishing the LDAP client connection to each
labeled zone. The <tt>nscd</tt> daemon caches the name service information, but does not
route it.</p><ol>
<li><b>If you are using LDAP, verify a route to the LDAP server
from the labeled zone.</b><p>In a terminal window in every labeled zone, run the following command:</p><pre><i>zone-name</i> # <tt><b>netstat -rn</b></tt></pre></li>
<li><b>In the global zone, start the Labeled Zone Manager.</b><pre># <tt><b>/usr/sbin/txzonemgr</b></tt></pre></li>
<li><b>Select the Configure per-zone name service, and click OK.</b><p>This option is intended to be used once, during initial  system
configuration.</p></li>
<li><b>Configure each zone's <tt>nscd</tt> service.</b><p>For assistance, see the <a href="http://docs.sun.com/doc/819-2240/nscd-1m?a=view"><tt>nscd</tt>(1M)</a> and <a href="http://docs.sun.com/doc/819-2251/nscd.conf-4?a=view"><tt>nscd.conf</tt>(4)</a> man pages.</p></li>
<li><b>Reboot the system.</b></li>
<li><b>For every zone, verify the route and the name service daemon.</b><ol style="list-style-type: lower-alpha">
<li><b>In the Zone Console, list the <tt>nscd</tt> service.</b><pre><i>zone-name</i> # <tt><b>svcs -x name-service-cache</b></tt>
svc:/system/name-service-cache:default (name service cache)
 State: online since October 10, 2010  10:10:10 AM PDT
   See: nscd(1M)
   See: /etc/svc/volatile/system-name-service-cache:default.log
Impact: None.</pre></li>
<li><b>Verify the route to the subnetwork.</b><pre><i>zone-name</i> # <tt><b>netstat -rn</b></tt></pre></li></ol></li>
<li><b><a name="indexterm-195"></a><a name="indexterm-196"></a><a name="indexterm-197"></a>To remove the zone-specific name service daemons, do the following in the global
zone:</b><ol style="list-style-type: lower-alpha">
<li><b>Open the Labeled Zone Manager.</b></li>
<li><b>Select Unconfigure per-zone name service, and click OK.</b><p>This selection removes the <tt>nscd</tt> daemon in every labeled zone.</p></li>
<li><b>Reboot the system.</b></li></ol></li></ol>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="txconf-20.html">Previous</a>
             </td>
             <td align="right">
                 <a href="txconf-14.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

