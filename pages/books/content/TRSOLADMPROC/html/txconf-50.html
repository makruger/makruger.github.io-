<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Creating Home Directories in Trusted Extensions - Solaris Trusted Extensions Administrator's Procedures</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2009-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">Solaris Trusted Extensions Administrator's Procedures</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="txconf-14.html">Previous</a>
             </td>
             <td align="right">
                 <a href="txconf-64.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-4.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="trp-part-1.html">Part&nbsp;I&nbsp;Initial Configuration of Trusted Extensions</a></p>
<p class="toc level2"><a href="ovw-1.html">1.&nbsp;&nbsp;Security Planning for Trusted Extensions</a></p>
<p class="toc level2"><a href="tmap-1.html">2.&nbsp;&nbsp;Configuration Roadmap for Trusted Extensions</a></p>
<p class="toc level2"><a href="startinst-1.html">3.&nbsp;&nbsp;Adding Solaris Trusted Extensions Software to the Solaris OS (Tasks)</a></p>
<p class="toc level2"><a href="txconf-1.html">4.&nbsp;&nbsp;Configuring Trusted Extensions (Tasks)</a></p>
<p class="toc level3"><a href="txconf-60.html">Setting Up the Global Zone in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-20.html">Creating Labeled Zones</a></p>
<p class="toc level3"><a href="txconf-98.html">Adding Network Interfaces and Routing to Labeled Zones</a></p>
<p class="toc level3"><a href="txconf-14.html">Creating Roles and Users in Trusted Extensions</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Creating Home Directories in Trusted Extensions</a></p>
</div>
<p class="toc level3"><a href="txconf-64.html">Adding Users and Hosts to an Existing Trusted Network</a></p>
<p class="toc level3"><a href="txconf-trouble-1.html">Troubleshooting Your Trusted Extensions Configuration</a></p>
<p class="toc level3"><a href="txconf-18.html">Additional Trusted Extensions Configuration Tasks</a></p>
<p class="toc level2 tocsp"><a href="txldap-1.html">5.&nbsp;&nbsp;Configuring LDAP for Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="headl-1.html">6.&nbsp;&nbsp;Configuring a Headless System With Trusted Extensions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="trp-part-2.html">Part&nbsp;II&nbsp;Administration of Trusted Extensions</a></p>
<p class="toc level2"><a href="txintro-1.html">7.&nbsp;&nbsp;Trusted Extensions Administration Concepts</a></p>
<p class="toc level2"><a href="txtool-1.html">8.&nbsp;&nbsp;Trusted Extensions Administration Tools</a></p>
<p class="toc level2"><a href="roles-1.html">9.&nbsp;&nbsp;Getting Started as a Trusted Extensions Administrator (Tasks)</a></p>
<p class="toc level2"><a href="secreq-1.html">10.&nbsp;&nbsp;Security Requirements on a Trusted Extensions System (Overview)</a></p>
<p class="toc level2"><a href="commontasks-1.html">11.&nbsp;&nbsp;Administering Security Requirements in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="useraccts-1.html">12.&nbsp;&nbsp;Users, Rights, and Roles in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="manageusers-1.html">13.&nbsp;&nbsp;Managing Users, Rights, and Roles in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="remotead-1.html">14.&nbsp;&nbsp;Remote Administration in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="manageldap-1.html">15.&nbsp;&nbsp;Trusted Extensions and LDAP (Overview)</a></p>
<p class="toc level2"><a href="managezones-1.html">16.&nbsp;&nbsp;Managing Zones in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="managefiles-1.html">17.&nbsp;&nbsp;Managing and Mounting Files in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="txnet-1.html">18.&nbsp;&nbsp;Trusted Networking (Overview)</a></p>
<p class="toc level2"><a href="managetnet-1.html">19.&nbsp;&nbsp;Managing Networks in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="managemail-1.html">20.&nbsp;&nbsp;Multilevel Mail in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="manageprint-1.html">21.&nbsp;&nbsp;Managing Labeled Printing (Tasks)</a></p>
<p class="toc level2"><a href="gentextid-15538.html">22.&nbsp;&nbsp;Devices in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="managedev-1.html">23.&nbsp;&nbsp;Managing Devices for Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="audtask-1.html">24.&nbsp;&nbsp;Trusted Extensions Auditing (Overview)</a></p>
<p class="toc level2"><a href="softmgt-1.html">25.&nbsp;&nbsp;Software Management in Trusted Extensions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="appol-1.html">A.&nbsp;&nbsp;Site Security Policy</a></p>
<p class="toc level2"><a href="appol-12.html">Creating and Managing a Security Policy</a></p>
<p class="toc level2"><a href="appol-11.html">Site Security Policy and Trusted Extensions</a></p>
<p class="toc level2"><a href="appol-2.html">Computer Security Recommendations</a></p>
<p class="toc level2"><a href="appol-3.html">Physical Security Recommendations</a></p>
<p class="toc level2"><a href="appol-4.html">Personnel Security Recommendations</a></p>
<p class="toc level2"><a href="appol-5.html">Common Security Violations</a></p>
<p class="toc level2"><a href="appol-6.html">Additional Security References</a></p>
<p class="toc level1 tocsp"><a href="aptxconf-1.html">B.&nbsp;&nbsp;Using CDE Actions to Install Zones in Trusted Extensions</a></p>
<p class="toc level2"><a href="aptxconf-62.html">Associating Network Interfaces With Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level2"><a href="aptxconf-40.html">Preparing to Create Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level2"><a href="aptxconf-20.html">Creating Labeled Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level1 tocsp"><a href="checklist-1.html">C.&nbsp;&nbsp;Configuration Checklist for Trusted Extensions</a></p>
<p class="toc level2"><a href="checklist-2.html">Checklist for Configuring Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="txapp-1.html">D.&nbsp;&nbsp;Quick Reference to Trusted Extensions Administration</a></p>
<p class="toc level2"><a href="txapp-2.html">Administrative Interfaces in Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-3.html">Solaris Interfaces Extended by Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-4.html">Tighter Security Defaults in Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-5.html">Limited Options in Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="txmp-1.html">E.&nbsp;&nbsp;List of Trusted Extensions Man Pages</a></p>
<p class="toc level2"><a href="txmp-2.html">Trusted Extensions Man Pages in Alphabetical Order</a></p>
<p class="toc level2"><a href="txmp-3.html">Solaris Man Pages That Are Modified by Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="txconf-50"></a><h3>Creating Home Directories in Trusted Extensions</h3>
<a name="indexterm-228"></a><a name="indexterm-229"></a><p>In Trusted Extensions, users need access to their home directories at every label
at which the users work. To make every home directory available to
the user requires that you create a multilevel home directory server, run the automounter
on the server, and export the home directories. On the client side, you
can run scripts to find the home directory for every zone for
each user, or you can have the user log in to the home
directory server.</p>

<a name="txconf-52"></a><h4>Create the Home Directory Server in Trusted Extensions</h4><a name="indexterm-230"></a><a name="indexterm-231"></a><h6>Before You Begin</h6><p>You must be superuser, in the <tt>root</tt> role, or in the Primary Administrator
role.</p><ol>
<li><b>Install and configure the home directory server with Trusted Extensions software.</b>
<ul><li><p>If you are cloning zones, make sure that you use a Solaris ZFS snapshot that has empty home directories.</p></li>
<li><p>Because users require a home directory at every label that they they can log in to, create every zone that a user can log in to. For example, if you use the default <tt>label_encodings</tt> file, you would create a zone for the <tt>PUBLIC</tt> label.</p></li></ul>
</li>
<li><b>If you are using UFS and not Solaris ZFS, enable the NFS server
to serve itself.</b><ol style="list-style-type: lower-alpha">
<li><b>In the global zone, modify the <tt>automount</tt> entry in the <tt>nsswitch.conf</tt> file.</b><p>Use the trusted editor to edit the <tt>/etc/nsswitch.conf</tt> file. For the procedure, see <a href="roles-4.html#roles-10">How to Edit Administrative Files in Trusted Extensions</a>.</p><pre>automount: files</pre></li>
<li><b>In the global zone, run the <tt>automount</tt> command.</b></li></ol></li>
<li><b>For every labeled zone, follow the automount procedure in <a href="managefiles-6.html#txconf-41">How to NFS Mount Files in a Labeled Zone</a>. Then, return
to this procedure.</b></li>
<li><b>Verify that the home directories have been created.</b><ol style="list-style-type: lower-alpha">
<li><b>Log out of the home directory server.</b></li>
<li><b>As a regular user, log in to the home directory server.</b></li>
<li><b>In the login zone, open a terminal.</b></li>
<li><b>In the terminal window, verify that the user's home directory exists.</b></li>
<li><b>Create workspaces for every zone that the user can work in.</b></li>
<li><b>In each zone, open a terminal window to verify that the user's home
directory exists.</b></li></ol></li>
<li><b>Log out of the home directory server.</b></li></ol>

<a name="txconf-56"></a><h4>Enable Users to Access Their Home Directories in Trusted Extensions</h4><a name="indexterm-232"></a><a name="indexterm-233"></a><p>Users can initially log in to the home directory server to create
a home directory that can be shared with other systems. To create a
home directory at every label, each user must log in to the home
directory server at every label.</p><p>Alternatively, you, as administrator, can create a script to create a mount point
for home directories on each user's home system before the user first logs
in. The script creates mount points at every label at which the user
is permitted to work.</p><h6>Before You Begin</h6><p>The home directory server for your Trusted Extensions domain is configured.</p><ul>
<li><b>Choose whether to allow direct login to the server, or whether to run
a script.</b><ul>
<li><b>Enable users to log in directly to the home directory server.</b><ol style="list-style-type: lower-alpha">
<li><b>Instruct each user to log in to the home directory server.</b><p>After successful login, the user must log out.</p></li>
<li><b>Instruct each user to log in again, and this time, to choose
a different login label.</b><p>The user uses the label builder to choose a different login label. After
successful login, the user must log out.</p></li>
<li><b>Instruct each user to repeat the login process for every label that the
user is permitted to use.</b></li>
<li><b>Instruct the users to log in from their regular workstation.</b><p>Their home directory for their default label is available. When a user changes
the label of a session or adds a workspace at a different
label, the user's home directory for that label is mounted.</p></li></ol></li>
<li><b>Write a script that creates a home directory mount point for every user,
and run the script.</b><pre>#!/bin/sh
#
for zoneroot in `/usr/sbin/zoneadm list -p | cut -d ":" -f4` ; do
    if [ $zoneroot != / ]; then
        prefix=$zoneroot/root/export
    
        for j in `getent passwd|tr ' ' _` ; do
            uid=`echo $j|cut -d ":" -f3`
            if [ $uid -ge 100 ]; then
                gid=`echo $j|cut -d ":" -f4`
                homedir=`echo $j|cut -d ":" -f6`
                mkdir -m 711 -p $prefix$homedir
                chown $uid:$gid $prefix$homedir
            fi
        done
    fi
done</pre><ol style="list-style-type: lower-alpha">
<li><b>From the global zone, run this script on the NFS server.</b></li>
<li><b>Then, run this script on every multilevel desktop that the user is going
to log in to.</b></li></ol></li></ul></li></ul>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="txconf-14.html">Previous</a>
             </td>
             <td align="right">
                 <a href="txconf-64.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

