<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Adding Users and Hosts to an Existing Trusted Network - Solaris Trusted Extensions Administrator's Procedures</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2009-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">Solaris Trusted Extensions Administrator's Procedures</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="txconf-50.html">Previous</a>
             </td>
             <td align="right">
                 <a href="txconf-trouble-1.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-4.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="trp-part-1.html">Part&nbsp;I&nbsp;Initial Configuration of Trusted Extensions</a></p>
<p class="toc level2"><a href="ovw-1.html">1.&nbsp;&nbsp;Security Planning for Trusted Extensions</a></p>
<p class="toc level2"><a href="tmap-1.html">2.&nbsp;&nbsp;Configuration Roadmap for Trusted Extensions</a></p>
<p class="toc level2"><a href="startinst-1.html">3.&nbsp;&nbsp;Adding Solaris Trusted Extensions Software to the Solaris OS (Tasks)</a></p>
<p class="toc level2"><a href="txconf-1.html">4.&nbsp;&nbsp;Configuring Trusted Extensions (Tasks)</a></p>
<p class="toc level3"><a href="txconf-60.html">Setting Up the Global Zone in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-20.html">Creating Labeled Zones</a></p>
<p class="toc level3"><a href="txconf-98.html">Adding Network Interfaces and Routing to Labeled Zones</a></p>
<p class="toc level3"><a href="txconf-14.html">Creating Roles and Users in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-50.html">Creating Home Directories in Trusted Extensions</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Adding Users and Hosts to an Existing Trusted Network</a></p>
</div>
<p class="toc level3"><a href="txconf-trouble-1.html">Troubleshooting Your Trusted Extensions Configuration</a></p>
<p class="toc level3"><a href="txconf-18.html">Additional Trusted Extensions Configuration Tasks</a></p>
<p class="toc level2 tocsp"><a href="txldap-1.html">5.&nbsp;&nbsp;Configuring LDAP for Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="headl-1.html">6.&nbsp;&nbsp;Configuring a Headless System With Trusted Extensions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="trp-part-2.html">Part&nbsp;II&nbsp;Administration of Trusted Extensions</a></p>
<p class="toc level2"><a href="txintro-1.html">7.&nbsp;&nbsp;Trusted Extensions Administration Concepts</a></p>
<p class="toc level2"><a href="txtool-1.html">8.&nbsp;&nbsp;Trusted Extensions Administration Tools</a></p>
<p class="toc level2"><a href="roles-1.html">9.&nbsp;&nbsp;Getting Started as a Trusted Extensions Administrator (Tasks)</a></p>
<p class="toc level2"><a href="secreq-1.html">10.&nbsp;&nbsp;Security Requirements on a Trusted Extensions System (Overview)</a></p>
<p class="toc level2"><a href="commontasks-1.html">11.&nbsp;&nbsp;Administering Security Requirements in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="useraccts-1.html">12.&nbsp;&nbsp;Users, Rights, and Roles in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="manageusers-1.html">13.&nbsp;&nbsp;Managing Users, Rights, and Roles in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="remotead-1.html">14.&nbsp;&nbsp;Remote Administration in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="manageldap-1.html">15.&nbsp;&nbsp;Trusted Extensions and LDAP (Overview)</a></p>
<p class="toc level2"><a href="managezones-1.html">16.&nbsp;&nbsp;Managing Zones in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="managefiles-1.html">17.&nbsp;&nbsp;Managing and Mounting Files in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="txnet-1.html">18.&nbsp;&nbsp;Trusted Networking (Overview)</a></p>
<p class="toc level2"><a href="managetnet-1.html">19.&nbsp;&nbsp;Managing Networks in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="managemail-1.html">20.&nbsp;&nbsp;Multilevel Mail in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="manageprint-1.html">21.&nbsp;&nbsp;Managing Labeled Printing (Tasks)</a></p>
<p class="toc level2"><a href="gentextid-15538.html">22.&nbsp;&nbsp;Devices in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="managedev-1.html">23.&nbsp;&nbsp;Managing Devices for Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="audtask-1.html">24.&nbsp;&nbsp;Trusted Extensions Auditing (Overview)</a></p>
<p class="toc level2"><a href="softmgt-1.html">25.&nbsp;&nbsp;Software Management in Trusted Extensions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="appol-1.html">A.&nbsp;&nbsp;Site Security Policy</a></p>
<p class="toc level2"><a href="appol-12.html">Creating and Managing a Security Policy</a></p>
<p class="toc level2"><a href="appol-11.html">Site Security Policy and Trusted Extensions</a></p>
<p class="toc level2"><a href="appol-2.html">Computer Security Recommendations</a></p>
<p class="toc level2"><a href="appol-3.html">Physical Security Recommendations</a></p>
<p class="toc level2"><a href="appol-4.html">Personnel Security Recommendations</a></p>
<p class="toc level2"><a href="appol-5.html">Common Security Violations</a></p>
<p class="toc level2"><a href="appol-6.html">Additional Security References</a></p>
<p class="toc level1 tocsp"><a href="aptxconf-1.html">B.&nbsp;&nbsp;Using CDE Actions to Install Zones in Trusted Extensions</a></p>
<p class="toc level2"><a href="aptxconf-62.html">Associating Network Interfaces With Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level2"><a href="aptxconf-40.html">Preparing to Create Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level2"><a href="aptxconf-20.html">Creating Labeled Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level1 tocsp"><a href="checklist-1.html">C.&nbsp;&nbsp;Configuration Checklist for Trusted Extensions</a></p>
<p class="toc level2"><a href="checklist-2.html">Checklist for Configuring Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="txapp-1.html">D.&nbsp;&nbsp;Quick Reference to Trusted Extensions Administration</a></p>
<p class="toc level2"><a href="txapp-2.html">Administrative Interfaces in Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-3.html">Solaris Interfaces Extended by Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-4.html">Tighter Security Defaults in Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-5.html">Limited Options in Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="txmp-1.html">E.&nbsp;&nbsp;List of Trusted Extensions Man Pages</a></p>
<p class="toc level2"><a href="txmp-2.html">Trusted Extensions Man Pages in Alphabetical Order</a></p>
<p class="toc level2"><a href="txmp-3.html">Solaris Man Pages That Are Modified by Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="txconf-64"></a><h3>Adding Users and Hosts to an Existing Trusted Network</h3>
<p>If you have users who are defined in NIS maps, you can
add them to your network. </p><p>To add hosts and labels to hosts, see the following procedures:</p>
<ul><li><p>To add a host, you use the Computers and Networks tool set in the Solaris Management Console. For details, see <a href="managetnet-3.html#txconf-9">How to Add Hosts to the System's Known Network</a>.</p><p>When you add a host to the LDAP server, add all IP addresses that are associated with the host. All-zones addresses, including addresses for labeled zones, must be added to the LDAP server.</p></li>
<li><p>To label a host, see <a href="managetnet-3.html#managetnet-16">How to Assign a Security Template to a Host or a Group of Hosts</a>.</p></li></ul>


<a name="txconf-65"></a><h4>Add an NIS User to the LDAP Server</h4><a name="indexterm-234"></a><a name="indexterm-235"></a><a name="indexterm-236"></a><h6>Before You Begin</h6><p>You must be superuser, in the <tt>root</tt> role, or in the Primary Administrator
role.</p><ol>
<li><b>From the NIS database, gather the information that you need.</b><ol style="list-style-type: lower-alpha">
<li><b>Create a file from the user's entry in the <tt>aliases</tt> database.</b><pre>% ypcat -k aliases | grep <i>login-name</i> &gt; aliases.<i>name</i></pre></li>
<li><b>Create a file from the user's entry in the <tt>passwd</tt> database.</b><pre>% ypcat -k passwd | grep "<i>Full Name</i>" &gt; passwd.<i>name</i></pre></li>
<li><b>Create a file from the user's entry in the <tt>auto_home_</tt> database.</b><pre>% ypcat -k auto_home | grep <i>login-name</i> &gt; <tt>auto_home_</tt><i>label</i></pre></li></ol></li>
<li><b>Reformat the information for LDAP and Trusted Extensions.</b><ol style="list-style-type: lower-alpha">
<li><b>Use the <tt>sed</tt> command to reformat the <tt>aliases</tt> entry.</b><pre>% sed 's/ /:/g' aliases.<i>login-name</i> &gt; aliases</pre></li>
<li><b>Use the <tt>nawk</tt> command to reformat the <tt>passwd</tt> entry.</b><pre>% nawk -F: '{print $1":x:"$3":"$4":"$5":"$6":"$7}' passwd.<i>name</i> &gt; passwd</pre></li>
<li><b>Use the <tt>nawk</tt> command to create a <tt>shadow</tt> entry.</b><pre>% nawk -F: '{print $1":"$2":6445::::::"}' passwd.<i>name</i> &gt; shadow</pre></li>
<li><b>Use the <tt>nawk</tt> command to create a <tt>user_attr</tt> entry.</b><pre>% nawk -F: '{print $1"::::lock_after_retries=<i>yes-or-no</i>;profiles=<i>user-profile, ...</i>;
labelview=<i>int-or-ext</i>,<i>show-or-hide</i>;min_label=<i>min-label</i>;
clearance=<i>max-label</i>;type=normal;roles=<i>role-name,...</i>;
auths=<i>auth-name,...</i>"}' passwd.<i>name</i> &gt; user_attr</pre></li></ol></li>
<li><a name="txconf-ldentries-1"></a><b>Copy the modified files to the <tt>/tmp</tt> directory on the LDAP server.</b><pre># cp aliases auto_home_internal passwd shadow user_attr /tmp/<i>name</i></pre></li>
<li><b>Add the entries in the files in <a href="#txconf-ldentries-1">Step&nbsp;3</a> to the databases on
the LDAP server.</b><pre># /usr/sbin/ldapaddent -D "cn=directory manager" -w <i>DM-password</i> \
-a simple -f /tmp/<i>name</i>/aliases aliases
# /usr/sbin/ldapaddent -D "cn=directory manager" -w <i>DM-password</i> \
-a simple -f /tmp/<i>name</i>/auto_home_internal auto_home_internal
# /usr/sbin/ldapaddent -D "cn=directory manager" -w <i>DM-password</i> \
-a simple -f /tmp/<i>name</i>/passwd passwd
# /usr/sbin/ldapaddent -D "cn=directory manager" -w <i>DM-password</i> \
-a simple -f /tmp/<i>name</i>/shadow shadow
# /usr/sbin/ldapaddent -D "cn=directory manager" -w <i>DM-password</i> \
-a simple -f /tmp/<i>name</i>/user_attr user_attr</pre></li></ol><a name="txconf-67"></a><h6>Example&nbsp;4-8 Adding a User From an NIS Database to the LDAP Server</h6><p>In the following example, the administrator adds a new user to the
trusted network. The user's information is stored originally in an NIS database. To protect
the LDAP server password, the administrator runs the <tt>ldapaddent</tt> commands on the server.</p><p>In Trusted Extensions, the new user can allocate devices and assume the Operator
role. Because the user can assume a role, the user account does
not get locked out. The user's minimum label is <tt>PUBLIC</tt>. The label at which
the user works is <tt>INTERNAL</tt>, so <tt>jan</tt> is added to the <tt>auto_home_internal</tt> database.
The <tt>auto_home_internal</tt> database automounts <tt>jan</tt>'s home directory with read-write permissions.</p>
<ul><li><p>On the LDAP server, the administrator extracts user information from NIS databases.</p><pre># <tt><b>ypcat -k aliases | grep jan.doe &gt; aliases.jan</b></tt>
# <tt><b>ypcat passwd | grep "Jan Doe" &gt; passwd.jan</b></tt>
# <tt><b>ypcat -k auto_home | grep jan.doe &gt; auto_home_internal</b></tt></pre></li>
<li><p>Then, the administrator reformats the entries for LDAP.</p><pre># <tt><b>sed 's/ /:/g' aliases.jan &gt; aliases</b></tt>
# <tt><b>nawk -F: '{print $1":x:"$3":"$4":"$5":"$6":"$7}' passwd.jan &gt; passwd</b></tt>
# <tt><b>nawk -F: '{print $1":"$2":6445::::::"}' passwd.jan &gt; shadow</b></tt></pre></li>
<li><p>Then, the administrator creates a <tt>user_attr</tt> entry for Trusted Extensions.</p><pre># <tt><b>nawk -F: '{print $1"::::lock_after_retries=no;profiles=Media User;</b></tt>
<tt><b>labelview=internal,showsl;min_label=0x0002-08-08;</b></tt>
<tt><b>clearance=0x0004-08-78;type=normal;roles=oper;</b></tt>
<tt><b>auths=solaris.device.allocate"}' passwd.jan &gt; user_attr</b></tt></pre></li>
<li><p>Then, the administrator copies the files to the <tt>/tmp/jan</tt> directory.</p><pre># <tt><b>cp aliases auto_home_internal passwd shadow user_attr /tmp/jan</b></tt></pre></li>
<li><p>Finally, the administrator populates the server with the files in the <tt>/tmp/jan</tt> directory.</p><pre># <tt><b>/usr/sbin/ldapaddent -D "cn=directory manager" -w a2b3c4d5e6 \</b></tt>
<tt><b>-a simple -f /tmp/jan/aliases aliases</b></tt>
# <tt><b>/usr/sbin/ldapaddent -D "cn=directory manager" -w a2b3c4d5e6 \</b></tt>
<tt><b>-a simple -f /tmp/jan/auto_home_internal auto_home_internal</b></tt>
# <tt><b>/usr/sbin/ldapaddent -D "cn=directory manager" -w a2b3c4d5e6 \</b></tt>
<tt><b>-a simple -f /tmp/jan/passwd passwd</b></tt>
# <tt><b>/usr/sbin/ldapaddent -D "cn=directory manager" -w a2b3c4d5e6 \</b></tt>
<tt><b>-a simple -f /tmp/jan/shadow shadow</b></tt>
# <tt><b>/usr/sbin/ldapaddent -D "cn=directory manager" -w a2b3c4d5e6 \</b></tt>
<tt><b>-a simple -f /tmp/jan/user_attr user_attr</b></tt></pre></li></ul>

         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="txconf-50.html">Previous</a>
             </td>
             <td align="right">
                 <a href="txconf-trouble-1.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

