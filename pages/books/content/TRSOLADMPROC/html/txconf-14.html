<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Creating Roles and Users in Trusted Extensions - Solaris Trusted Extensions Administrator's Procedures</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2009-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">Solaris Trusted Extensions Administrator's Procedures</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="txconf-98.html">Previous</a>
             </td>
             <td align="right">
                 <a href="txconf-50.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-4.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="trp-part-1.html">Part&nbsp;I&nbsp;Initial Configuration of Trusted Extensions</a></p>
<p class="toc level2"><a href="ovw-1.html">1.&nbsp;&nbsp;Security Planning for Trusted Extensions</a></p>
<p class="toc level2"><a href="tmap-1.html">2.&nbsp;&nbsp;Configuration Roadmap for Trusted Extensions</a></p>
<p class="toc level2"><a href="startinst-1.html">3.&nbsp;&nbsp;Adding Solaris Trusted Extensions Software to the Solaris OS (Tasks)</a></p>
<p class="toc level2"><a href="txconf-1.html">4.&nbsp;&nbsp;Configuring Trusted Extensions (Tasks)</a></p>
<p class="toc level3"><a href="txconf-60.html">Setting Up the Global Zone in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-20.html">Creating Labeled Zones</a></p>
<p class="toc level3"><a href="txconf-98.html">Adding Network Interfaces and Routing to Labeled Zones</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Creating Roles and Users in Trusted Extensions</a></p>
</div>
<p class="toc level3"><a href="txconf-50.html">Creating Home Directories in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-64.html">Adding Users and Hosts to an Existing Trusted Network</a></p>
<p class="toc level3"><a href="txconf-trouble-1.html">Troubleshooting Your Trusted Extensions Configuration</a></p>
<p class="toc level3"><a href="txconf-18.html">Additional Trusted Extensions Configuration Tasks</a></p>
<p class="toc level2 tocsp"><a href="txldap-1.html">5.&nbsp;&nbsp;Configuring LDAP for Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="headl-1.html">6.&nbsp;&nbsp;Configuring a Headless System With Trusted Extensions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="trp-part-2.html">Part&nbsp;II&nbsp;Administration of Trusted Extensions</a></p>
<p class="toc level2"><a href="txintro-1.html">7.&nbsp;&nbsp;Trusted Extensions Administration Concepts</a></p>
<p class="toc level2"><a href="txtool-1.html">8.&nbsp;&nbsp;Trusted Extensions Administration Tools</a></p>
<p class="toc level2"><a href="roles-1.html">9.&nbsp;&nbsp;Getting Started as a Trusted Extensions Administrator (Tasks)</a></p>
<p class="toc level2"><a href="secreq-1.html">10.&nbsp;&nbsp;Security Requirements on a Trusted Extensions System (Overview)</a></p>
<p class="toc level2"><a href="commontasks-1.html">11.&nbsp;&nbsp;Administering Security Requirements in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="useraccts-1.html">12.&nbsp;&nbsp;Users, Rights, and Roles in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="manageusers-1.html">13.&nbsp;&nbsp;Managing Users, Rights, and Roles in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="remotead-1.html">14.&nbsp;&nbsp;Remote Administration in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="manageldap-1.html">15.&nbsp;&nbsp;Trusted Extensions and LDAP (Overview)</a></p>
<p class="toc level2"><a href="managezones-1.html">16.&nbsp;&nbsp;Managing Zones in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="managefiles-1.html">17.&nbsp;&nbsp;Managing and Mounting Files in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="txnet-1.html">18.&nbsp;&nbsp;Trusted Networking (Overview)</a></p>
<p class="toc level2"><a href="managetnet-1.html">19.&nbsp;&nbsp;Managing Networks in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="managemail-1.html">20.&nbsp;&nbsp;Multilevel Mail in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="manageprint-1.html">21.&nbsp;&nbsp;Managing Labeled Printing (Tasks)</a></p>
<p class="toc level2"><a href="gentextid-15538.html">22.&nbsp;&nbsp;Devices in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="managedev-1.html">23.&nbsp;&nbsp;Managing Devices for Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="audtask-1.html">24.&nbsp;&nbsp;Trusted Extensions Auditing (Overview)</a></p>
<p class="toc level2"><a href="softmgt-1.html">25.&nbsp;&nbsp;Software Management in Trusted Extensions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="appol-1.html">A.&nbsp;&nbsp;Site Security Policy</a></p>
<p class="toc level2"><a href="appol-12.html">Creating and Managing a Security Policy</a></p>
<p class="toc level2"><a href="appol-11.html">Site Security Policy and Trusted Extensions</a></p>
<p class="toc level2"><a href="appol-2.html">Computer Security Recommendations</a></p>
<p class="toc level2"><a href="appol-3.html">Physical Security Recommendations</a></p>
<p class="toc level2"><a href="appol-4.html">Personnel Security Recommendations</a></p>
<p class="toc level2"><a href="appol-5.html">Common Security Violations</a></p>
<p class="toc level2"><a href="appol-6.html">Additional Security References</a></p>
<p class="toc level1 tocsp"><a href="aptxconf-1.html">B.&nbsp;&nbsp;Using CDE Actions to Install Zones in Trusted Extensions</a></p>
<p class="toc level2"><a href="aptxconf-62.html">Associating Network Interfaces With Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level2"><a href="aptxconf-40.html">Preparing to Create Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level2"><a href="aptxconf-20.html">Creating Labeled Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level1 tocsp"><a href="checklist-1.html">C.&nbsp;&nbsp;Configuration Checklist for Trusted Extensions</a></p>
<p class="toc level2"><a href="checklist-2.html">Checklist for Configuring Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="txapp-1.html">D.&nbsp;&nbsp;Quick Reference to Trusted Extensions Administration</a></p>
<p class="toc level2"><a href="txapp-2.html">Administrative Interfaces in Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-3.html">Solaris Interfaces Extended by Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-4.html">Tighter Security Defaults in Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-5.html">Limited Options in Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="txmp-1.html">E.&nbsp;&nbsp;List of Trusted Extensions Man Pages</a></p>
<p class="toc level2"><a href="txmp-2.html">Trusted Extensions Man Pages in Alphabetical Order</a></p>
<p class="toc level2"><a href="txmp-3.html">Solaris Man Pages That Are Modified by Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="txconf-14"></a><h3>Creating Roles and Users in Trusted Extensions</h3>
<a name="indexterm-198"></a><a name="indexterm-199"></a><a name="indexterm-200"></a><a name="indexterm-201"></a><p>If you are already using <a href="glossary-1.html#glossary-5">administrative role</a>s, you might want to add a
Security Administrator role. For sites that have not yet implemented roles, the procedure
for creating them is similar to the procedure in the Solaris OS. Trusted
Extensions adds the Security Administrator role and requires the use of the Solaris
Management Console to administer a Trusted Extensions domain.</p><p>If site security requires two people to create user and role accounts, create
custom rights profiles and assign them to roles to enforce <b><a href="glossary-1.html#glossary-148">separation of duty</a></b>.</p><table><col width="22%"><col width="45%"><col width="31%"><tr><th align="left" valign="top" scope="column"><p>Task</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>For Instructions</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Create
three rights profiles that are more restrictive than default profiles.</p></td>
<td align="left" valign="top" scope="row"><p>Creates rights profiles to
manage users. These profiles are more restrictive than the default profiles that manage
users.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#txconf-95">Create Rights Profiles That Enforce Separation of Duty</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Create a security administrator role.</p></td>
<td align="left" valign="top" scope="row"><p>Creates a security administrator role that handles security-relevant tasks.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#txconf-23">Create the Security Administrator Role in Trusted Extensions</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Create
a system administrator role that cannot set a user password.</p></td>
<td align="left" valign="top" scope="row"><p>Creates a system
administrator role and assigns to it a restricted System Administrator rights profile.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#txconf-97">Create a Restricted System Administrator Role</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Create users
to assume the administrative roles.</p></td>
<td align="left" valign="top" scope="row"><p>Creates one or more users who can assume
roles.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#txconf-25">Create Users Who Can Assume Roles in Trusted Extensions</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Verify that the roles can perform their tasks.</p></td>
<td align="left" valign="top" scope="row"><p>Tests the roles in various
scenarios.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#txconf-29">Verify That the Trusted Extensions Roles Work</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Enable users to log in to a labeled zone.</p></td>
<td align="left" valign="top" scope="row"><p>Starts the <tt>zones</tt> service
so that regular users can log in.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#txconf-34">Enable Users to Log In to a Labeled Zone</a></p></td>
</tr>
</table>

<a name="txconf-95"></a><h4>Create Rights Profiles That Enforce Separation of Duty</h4><a name="indexterm-202"></a><a name="indexterm-203"></a><a name="indexterm-204"></a><a name="indexterm-205"></a><p>Skip this procedure if <a href="glossary-1.html#glossary-148">separation of duty</a> is not a site security requirement. If
your site requires separation of duty, you must create these rights profiles and
roles before you populate the LDAP server.</p><p>This procedure creates rights profiles that have discrete capabilities to manage users. When
you assign these profiles to distinct roles, two roles are required to create
and configure users. One role can create users, but cannot assign security attributes.
The other role can assign security attributes, but cannot create users. When you
log in to the Solaris Management Console in a role that is
assigned one of these profiles, only the appropriate tabs and fields are available to
the role.</p><h6>Before You Begin</h6><p>You must be superuser, in the <tt>root</tt> role, or in the Primary Administrator
role. When you start this procedure, the Solaris Management Console must be closed.</p><ol>
<li><b>Create copies of the default rights profiles that affect user configuration.</b><ol style="list-style-type: lower-alpha">
<li><b>Copy the <tt>prof_attr</tt> file to the <tt>prof_attr.orig</tt> file.</b></li>
<li><b>Open the <tt>prof_attr</tt> file in the trusted editor.</b><pre># <tt><b>/usr/dt/bin/trusted_edit /etc/security/prof_attr</b></tt></pre></li>
<li><b>Copy the three rights profiles and rename the copies.</b><pre>System Administrator:::Can perform most non-security...
<tt><b>Custom System Administrator:::Can perform most non-security...</b></tt>

User Security:::Manage passwords...
<tt><b>Custom User Security:::Manage passwords...</b></tt>

User Management:::Manage users, groups, home...
<tt><b>Custom User Management:::Manage users, groups, home...</b></tt></pre></li>
<li><b>Save the changes.</b></li>
<li><b>Verify the changes.</b><pre># <tt><b>grep ^Custom /etc/security/prof_attr</b></tt>
Custom System Administrator:::Can perform most non-security...
Custom User Management:::Manage users, groups, home...
Custom User Security:::Manage passwords...</pre></li></ol><p>Copying a rights profile rather than modifying it enables you to upgrade the
system to a later Solaris release and retain your changes. Because these rights
profiles are complex, modifying a copy of the default profile is less prone
to error than building the more restrictive profile from scratch.</p></li>
<li><b>Start the Solaris Management Console.</b><pre># <tt><b>/usr/sbin/smc &amp;</b></tt></pre></li>
<li><b>Select the This Computer (<i>this-host</i>: <tt>Scope=Files, Policy=TSOL</tt>) toolbox.</b></li>
<li><b>Click System Configuration, then click Users.</b><p>You are prompted for your password.</p></li>
<li><b>Type the appropriate password.</b></li>
<li><b>Double-click Rights.</b></li>
<li><b>Modify the Custom User Security rights profile.</b><p>You restrict this profile from creating a user.</p><ol style="list-style-type: lower-alpha">
<li><b>Double-click Custom User Security.</b></li>
<li><b>Click the Authorizations tab, then perform the following steps:</b><ol style="list-style-type: lower-roman">
<li><b>From the Included list, remove the <tt>Manage Users and Roles</tt> authorization.</b><p>The following User Accounts rights remain:</p><pre>Audit Controls
Label and Clearance Range
Change Password
View Users and Roles
Modify Extended Security Attributes</pre></li>
<li><b>Add the Manage Privileges right to the Included list.</b></li></ol></li>
<li><b>Click OK to save your changes.</b></li></ol></li>
<li><b>Modify the Custom User Management profile.</b><p>You restrict this profile from setting a password.</p><ol style="list-style-type: lower-alpha">
<li><b>Double-click Custom User Management.</b></li>
<li><b>Click the Authorizations tab, then perform the following steps:</b><ol style="list-style-type: lower-roman">
<li><b>Drag the scrollbar for the Included list to User Accounts.</b></li>
<li><b>From the Included list, remove the <tt>Modify Extended Security Attributes</tt> authorization.</b><p>The following User Accounts rights remain:</p><pre>Manage Users and Roles
View Users and Roles</pre></li></ol></li>
<li><b>Save your changes.</b></li></ol></li>
<li><b>Modify the Custom System Administrator rights profile.</b><p>The User Management profile is a supplementary profile in this profile. You prevent the
system administrator from setting a password.</p><ol style="list-style-type: lower-alpha">
<li><b>Double-click Custom System Administrator.</b></li>
<li><b>Click the Supplementary Rights tab, then perform the following steps:</b><ol style="list-style-type: lower-roman">
<li><b>Remove the User Management rights profile.</b></li>
<li><b>Add the Custom User Management rights profile.</b></li>
<li><b>Move the Custom User Management rights profile above the All rights profile.</b></li></ol></li>
<li><b>Save your changes.</b></li></ol></li></ol><h6>Next Steps</h6><p>To prevent the default profiles from being used, see <a href="#txconf-sepduty-1">Step&nbsp;8</a> in <a href="#txconf-29">Verify That the Trusted Extensions Roles Work</a>
after you verify that the custom profiles enforce separation of duty.</p>

<a name="txconf-23"></a><h4>Create the Security Administrator Role in Trusted Extensions</h4><a name="indexterm-206"></a><a name="indexterm-207"></a><p>Role creation in Trusted Extensions is identical to role creation in the
Solaris OS. However, in Trusted Extensions, a Security Administrator role is required. To create
a local Security Administrator role, you can also use the command-line interface, as
in <a href="#txconf-61">Example&nbsp;4-6</a>.</p><h6>Before You Begin</h6><p>You must be superuser, in the <tt>root</tt> role, or in the Primary Administrator
role.</p><p>To create the role on the network, you must have completed <a href="confsys-10.html">Configuring the Solaris Management Console for LDAP (Task Map)</a>.</p><ol>
<li><b>Start the Solaris Management Console.</b><pre># <tt><b>/usr/sbin/smc &amp;</b></tt></pre></li>
<li><b>Select the appropriate toolbox.</b><ul>
<li><b>To create the role locally, use This Computer (<i>this-host</i>: <tt>Scope=Files, Policy=TSOL</tt>).</b></li>
<li><b>To create the role in the LDAP service, use This Computer (<i>ldap-server</i>:
<tt>Scope=LDAP, Policy=TSOL</tt>).</b></li></ul></li>
<li><b>Click System Configuration, then click Users.</b><p>You are prompted for your password.</p></li>
<li><b>Type the appropriate password.</b></li>
<li><b>Double-click Administrative Roles.</b></li>
<li><b>From the Action menu, choose Add Administrative Role.</b></li>
<li><b>Create the Security Administrator role.</b><p>Use the following information as a guide:</p>
<ul><li><p>Role name &ndash; <tt>secadmin</tt></p></li>
<li><p>Full name &ndash; <tt>Security Administrator</tt></p></li>
<li><p>Description &ndash; Site Security Officer <b>No proprietary information here</b>.</p></li>
<li><p>Role ID Number &ndash; &ge;100</p></li>
<li><p>Role shell &ndash; Administrator's Bourne (profile shell)</p></li>
<li><p>Create a role mailing list &ndash; Leave the checkbox selected.</p></li>
<li><p>Password and confirm &ndash; Assign a password of at least 6 alphanumeric characters.</p><p>The password for the Security Administrator role, and all passwords, must be difficult to guess, thus reducing the chance of an adversary gaining unauthorized access by attempting to guess passwords.</p>
<hr><p><b>Note - </b>For all administrative roles, make the account Always Available, and do not set password expiration dates.</p>
<hr>
</li>
<li><p>Available and Granted Rights &ndash; Information Security, User Security</p>
<ul><li><p>If site security does not require <a href="glossary-1.html#glossary-148">separation of duty</a>, select the Information Security and the default User Security rights profiles.</p></li>
<li><p>If site security requires separation of duty, select the Information Security and the Custom User Security rights profiles.</p></li></ul>
</li>
<li><p>Home Directory Server &ndash; <i>home-directory-server</i></p></li>
<li><p>Home Directory Path &ndash; /<i>mount-path</i></p></li>
<li><p>Assign Users&ndash; This field is automatically filled in when you assign a role to a user.</p></li></ul>
</li>
<li><b>After creating the role, check that the settings are correct.</b><p>Select the role, then double-click it.</p><p>Review the values in the following fields:</p>
<ul><li><p>Available Groups &ndash; Add groups if required.</p></li>
<li><p>Trusted Extensions Attributes &ndash; Defaults are correct.</p><p>For a single-label system where the labels must not be visible, choose Hide for Label: Show or Hide.</p></li>
<li><p>Audit Excluded and Included &ndash; Set audit flags only if the role's audit flags are exceptions to the system settings in the <tt>audit_control</tt> file.</p></li></ul>
</li>
<li><b>To create other roles, use the Security Administrator role as a guide.</b><p>For examples, see <a href="http://docs.sun.com/doc/819-3321/rbactask-32?a=view">How to Create and Assign a Role by Using the GUI in <i>System Administration Guide: Security Services</i></a>. Give each role a unique ID, and assign to
the role the correct rights profile. Possible roles include the following:</p>
<ul><li><p>admin Role &ndash; <tt>System Administrator</tt> Granted Rights</p></li>
<li><p>primaryadmin Role &ndash; <tt>Primary Administrator</tt> Granted Rights</p></li>
<li><p>oper Role &ndash; <tt>Operator</tt> Granted Rights</p></li></ul>
</li></ol><a name="txconf-61"></a><h6>Example&nbsp;4-6 Using the <tt>roleadd</tt> Command to Create a Local Security Administrator Role</h6><a name="indexterm-208"></a><a name="indexterm-209"></a><a name="indexterm-210"></a><a name="indexterm-211"></a><p>In this example, the <tt>root</tt> user adds the Security Administrator role to the
local system by using the <tt>roleadd</tt> command. For details, see the <a href="http://docs.sun.com/doc/819-2240/roleadd-1m?a=view"><tt>roleadd</tt>(1M)</a> man page.
The <tt>root</tt> user consults <a href="ovw-36.html#ovw-tbl-4">Table&nbsp;1-2</a> before creating the role. At this site,
separation of duty is not required to create a user.</p><pre># <tt><b>roleadd -c "Local Security Administrator" -d /export/home1 \</b></tt>
<tt><b>-u 110 -P "Information Security,User Security" -K lock_after_retries=no \</b></tt>
<tt><b>-K idletime=5 -K idlecmd=lock -K labelview=showsl \</b></tt>
<tt><b>-K min_label=ADMIN_LOW -K clearance=ADMIN_HIGH secadmin</b></tt></pre><p>The <tt>root</tt> user provides an initial password for the role.</p><pre># <tt><b>passwd -r files secadmin</b></tt>
New Password:        &lt;Type password&gt;
Re-enter new Password: &lt;Retype password&gt;
passwd: password successfully changed for secadmin
#</pre><p>To assign the role to a local user, see <a href="#txconf-63">Example&nbsp;4-7</a>.</p>

<a name="txconf-97"></a><h4>Create a Restricted System Administrator Role</h4><a name="indexterm-212"></a><a name="indexterm-213"></a><a name="indexterm-214"></a><p>Skip this procedure if <a href="glossary-1.html#glossary-148">separation of duty</a> is not a site security requirement.</p><p>In this procedure, you assign a more restrictive rights profile to the System
Administrator role.</p><h6>Before You Begin</h6><p>You must be superuser, in the <tt>root</tt> role, or in the Primary Administrator
role.</p><p>You have completed <a href="#txconf-95">Create Rights Profiles That Enforce Separation of Duty</a>. You are using the same toolbox that you used
to create the rights profile.</p><ol>
<li><b>In the Solaris Management Console, create the System Administrator role.</b><p>For assistance, see <a href="#txconf-23">Create the Security Administrator Role in Trusted Extensions</a>.</p></li>
<li><b>Assign the Custom System Administrator rights profile to the role.</b></li>
<li><b>Save the changes.</b></li>
<li><b>Close the Solaris Management Console.</b></li></ol>

<a name="txconf-25"></a><h4>Create Users Who Can Assume Roles in Trusted Extensions</h4><a name="indexterm-215"></a><a name="indexterm-216"></a><a name="indexterm-217"></a><p>To create a local user, you can use the command-line interface, as
in <a href="#txconf-63">Example&nbsp;4-7</a>, instead of the following procedure. Where site security policy permits, you
can choose to create a user who can assume more than one administrative
role.</p><p>For secure user creation, the System Administrator role creates the user, and the
Security Administrator role assigns security-relevant attributes, such as a password.</p><h6>Before You Begin</h6><p>You must be superuser, in the <tt>root</tt> role, in the Security Administrator role,
or in the Primary Administrator role. The Security Administrator role has the least
amount of privilege that is required for user creation.</p><p>The Solaris Management Console is displayed. For details, see <a href="#txconf-23">Create the Security Administrator Role in Trusted Extensions</a>.</p><ol>
<li><b>Double-click User Accounts in the Solaris Management Console.</b></li>
<li><b>From the Action menu, choose Add User &rarr; Use Wizard.</b>
<hr><p><b>Caution - </b>The names and IDs of roles and users come from the same
pool. Do not use existing names or IDs for the users that you
add.</p>
<hr>
</li>
<li><b>Follow the online help.</b><p>You can also follow the procedures in <a href="http://docs.sun.com/doc/819-2379/usersetup-21?a=view">How to Add a User With the Solaris Management Console&rsquo;s Users Tool in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b>After creating the user, double-click the created user to modify the settings.</b>
<hr><p><b>Note - </b>For users who can assume roles, make the user account Always Available, and
do not set password expiration dates.</p>
<hr>
<p>Ensure that the following fields are correctly set:</p>
<ul><li><p>Description &ndash; No proprietary information here.</p></li>
<li><p>Password and confirm &ndash; Assign a password of at least 6 alphanumeric characters.</p>
<hr><p><b>Note - </b>When the initial setup team chooses a password, the team must select a password that is difficult to guess, thus reducing the chance of an adversary gaining unauthorized access by attempting to guess passwords.</p>
<hr>
</li>
<li><p>Account Availability &ndash; Always Available.</p></li>
<li><p>Trusted Extensions Attributes &ndash; Defaults are correct.</p><p>For a single-label system where the labels must not be visible, choose Hide for Label: Show or Hide.</p></li>
<li><p>Account Usage &ndash; Set Idle time and Idle action.</p><p>Lock account &ndash; Set to No for any user who can assume a role.</p></li></ul>
</li>
<li><b>Close the Solaris Management Console.</b></li>
<li><b>Customize the user's environment.</b><ol style="list-style-type: lower-alpha">
<li><b>Assign convenient authorizations.</b><p>After checking your site security policy, you might want to grant your first
users the Convenient Authorizations rights profile. With this profile, you can enable users
to allocate devices, print PostScript<sup>TM</sup> files, print without labels, remotely log in, and shut
down the system. To create the profile, see <a href="usermgr-13.html#manageusers-40">How to Create a Rights Profile for Convenient Authorizations</a>.</p></li>
<li><b>Customize user initialization files.</b><p>See <a href="manageusers-1.html">Chapter&nbsp;13, Managing Users, Rights, and Roles in Trusted Extensions (Tasks)</a>.</p><p>Also see <a href="usermgr-13.html">Managing Users and Rights With the Solaris Management Console (Task Map)</a>.</p></li>
<li><b>Create multilabel copy and link files.</b><p>On a multilabel system, users and roles can be set up with files
that list user initialization files to be copied or linked to other labels.
For more information, see <a href="manageusers-27.html#manageusers-28"><tt>.copy_files</tt> and <tt>.link_files</tt> Files</a>.</p></li></ol></li></ol><a name="txconf-63"></a><h6>Example&nbsp;4-7 Using the <tt>useradd</tt> Command to Create a Local User</h6><a name="indexterm-218"></a><a name="indexterm-219"></a><a name="indexterm-220"></a><a name="indexterm-221"></a><p>In this example, the <tt>root</tt> user creates a local user who can assume
the Security Administrator role. For details, see the <a href="http://docs.sun.com/doc/819-2240/useradd-1m?a=view"><tt>useradd</tt>(1M)</a> and <a href="http://docs.sun.com/doc/819-2240/atohexlabel-1m?a=view"><tt>atohexlabel</tt>(1M)</a> man
pages.</p><p>First, the <tt>root</tt> user determines the hexadecimal format of the user's minimum label
and clearance label.</p><pre># <tt><b>atohexlabel public</b></tt>
0x0002-08-08
# <tt><b>atohexlabel -c "confidential restricted"</b></tt>
0x0004-08-78</pre><p>Next, the <tt>root</tt> user consults <a href="ovw-36.html#ovw-tbl-4">Table&nbsp;1-2</a>, and then creates the user.</p><pre># <tt><b>useradd -c "Local user for Security Admin" -d /export/home1 \</b></tt>
<tt><b>-K idletime=10 -K idlecmd=logout -K lock_after_retries=no</b></tt>
<tt><b>-K min_label=0x0002-08-08 -K clearance=0x0004-08-78 -K labelview=showsl jandoe</b></tt></pre><p>Then, the <tt>root</tt> user provides an initial password.</p><pre># <tt><b>passwd -r files jandoe</b></tt>
New Password:    &lt;Type password&gt;
Re-enter new Password: &lt;Retype password&gt;
passwd: password successfully changed for jandoe
#</pre><p>Finally, the <tt>root</tt> user adds the Security Administrator role to the user's definition.
The role was created in <a href="#txconf-23">Create the Security Administrator Role in Trusted Extensions</a>.</p><pre># <tt><b>usermod -R secadmin jandoe</b></tt></pre>

<a name="txconf-29"></a><h4>Verify That the Trusted Extensions Roles Work</h4><a name="indexterm-222"></a><a name="indexterm-223"></a><a name="indexterm-224"></a><p>To verify each role, assume the role. Then, perform tasks that only that
role can perform.</p><h6>Before You Begin</h6><p>If you have configured DNS or routing, you must reboot after you
create the roles and before you verify that the roles work.</p><ol>
<li><b>For each role, log in as a user who can assume the
role.</b></li>
<li><b>Open the Trusted Path menu.</b><ul>
<li><b>In Trusted CDE, click the workspace switch area.</b></li>
<li><b>In Trusted GNOME, click your user name in the trusted stripe.</b></li></ul><br><img src="figures/tpmenu.gif" alt="Illustration shows the Trusted Path menu in CDE." width="174" height="240"></img></li>
<li><b>From the menu, assume the role.</b></li>
<li><b>In the role workspace, start the Solaris Management Console.</b><pre>$ <tt><b>/usr/sbin/smc &amp;</b></tt></pre></li>
<li><b>Select the appropriate scope for the role that you are testing.</b></li>
<li><b>Click System Services, and navigate to Users.</b><p>You are prompted for a password.</p><ol style="list-style-type: lower-alpha">
<li><b>Type the role password.</b></li>
<li><b>Double-click User Accounts.</b></li></ol></li>
<li><b>Click a user.</b>
<ul><li><p>The System Administrator role should be able to modify fields under the General, Home Directory, and Group tabs.</p><p>If you configured the roles to enforce <a href="glossary-1.html#glossary-148">separation of duty</a>, then the System Administrator role cannot set the user's initial password.</p></li>
<li><p>The Security Administrator role should be able to modify fields under all tabs.</p><p>If you configured the roles to enforce separation of duty, then the Security Administrator role cannot create a user.</p></li>
<li><p>The Primary Administrator role should be able to modify fields under all tabs.</p></li></ul>
</li>
<li><a name="txconf-sepduty-1"></a>(Optional) <b>If you are enforcing separation of duty, prevent the default rights profiles from
being used.</b>
<hr><p><b>Note - </b>When the system is upgraded to a newer version of the Solaris
OS, the System Administrator, User Management, and User Security default profiles are replaced.</p>
<hr>
<p>In the trusted editor, perform one of the following steps:</p><ul>
<li><b>Remove the three rights profiles from the <tt>prof_attr</tt> file.</b><p>Removal prevents an administrator from viewing or assigning these profiles. Also, remove the
<tt>prof_attr.orig</tt> file.</p></li>
<li><b>Comment out the three rights profiles in the <tt>prof_attr</tt> file.</b><p>Commenting out the rights profiles prevents these profiles from being viewed in the
Solaris Management Console or from being used in commands that manage users. The
profiles and their contents can still be viewed in the <tt>prof_attr</tt> file.</p></li>
<li><b>Type a different description for the three rights profiles in the <tt>prof_attr</tt> file.</b><p>Edit the <tt>prof_attr</tt> file to change the description field of these rights
profiles. For example, you might replace the descriptions with <tt>Do not use this profile</tt>. This change warns
an administrator to not use the profile, but does not prevent the profile
from being used.</p></li></ul></li></ol>

<a name="txconf-34"></a><h4>Enable Users to Log In to a Labeled Zone</h4><a name="indexterm-225"></a><a name="indexterm-226"></a><a name="indexterm-227"></a><p>When the host is rebooted, the association between the devices and the underlying
storage must be re-established.</p><h6>Before You Begin</h6><p>You have created at least one labeled zone. That zone is not
being used for cloning.</p><ol>
<li><b>Reboot the system.</b></li>
<li><b>Log in as the <tt>root</tt> user.</b></li>
<li><b>Restart the zones service.</b><pre># <tt><b>svcs zones</b></tt>
STATE          STIME    FMRI
offline        -        svc:/system/zones:default</pre><pre># <tt><b>svcadm restart svc:/system/zones:default</b></tt></pre></li>
<li><b>Log out.</b><p>Regular users can now log in. Their session is in a labeled zone.</p></li></ol>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="txconf-98.html">Previous</a>
             </td>
             <td align="right">
                 <a href="txconf-50.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

