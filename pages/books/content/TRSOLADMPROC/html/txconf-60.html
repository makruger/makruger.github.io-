<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Setting Up the Global Zone in Trusted Extensions - Solaris Trusted Extensions Administrator's Procedures</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2009-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">Solaris Trusted Extensions Administrator's Procedures</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="txconf-1.html">Previous</a>
             </td>
             <td align="right">
                 <a href="txconf-20.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-4.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="trp-part-1.html">Part&nbsp;I&nbsp;Initial Configuration of Trusted Extensions</a></p>
<p class="toc level2"><a href="ovw-1.html">1.&nbsp;&nbsp;Security Planning for Trusted Extensions</a></p>
<p class="toc level2"><a href="tmap-1.html">2.&nbsp;&nbsp;Configuration Roadmap for Trusted Extensions</a></p>
<p class="toc level2"><a href="startinst-1.html">3.&nbsp;&nbsp;Adding Solaris Trusted Extensions Software to the Solaris OS (Tasks)</a></p>
<p class="toc level2"><a href="txconf-1.html">4.&nbsp;&nbsp;Configuring Trusted Extensions (Tasks)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Setting Up the Global Zone in Trusted Extensions</a></p>
</div>
<p class="toc level3"><a href="txconf-20.html">Creating Labeled Zones</a></p>
<p class="toc level3"><a href="txconf-98.html">Adding Network Interfaces and Routing to Labeled Zones</a></p>
<p class="toc level3"><a href="txconf-14.html">Creating Roles and Users in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-50.html">Creating Home Directories in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-64.html">Adding Users and Hosts to an Existing Trusted Network</a></p>
<p class="toc level3"><a href="txconf-trouble-1.html">Troubleshooting Your Trusted Extensions Configuration</a></p>
<p class="toc level3"><a href="txconf-18.html">Additional Trusted Extensions Configuration Tasks</a></p>
<p class="toc level2 tocsp"><a href="txldap-1.html">5.&nbsp;&nbsp;Configuring LDAP for Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="headl-1.html">6.&nbsp;&nbsp;Configuring a Headless System With Trusted Extensions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="trp-part-2.html">Part&nbsp;II&nbsp;Administration of Trusted Extensions</a></p>
<p class="toc level2"><a href="txintro-1.html">7.&nbsp;&nbsp;Trusted Extensions Administration Concepts</a></p>
<p class="toc level2"><a href="txtool-1.html">8.&nbsp;&nbsp;Trusted Extensions Administration Tools</a></p>
<p class="toc level2"><a href="roles-1.html">9.&nbsp;&nbsp;Getting Started as a Trusted Extensions Administrator (Tasks)</a></p>
<p class="toc level2"><a href="secreq-1.html">10.&nbsp;&nbsp;Security Requirements on a Trusted Extensions System (Overview)</a></p>
<p class="toc level2"><a href="commontasks-1.html">11.&nbsp;&nbsp;Administering Security Requirements in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="useraccts-1.html">12.&nbsp;&nbsp;Users, Rights, and Roles in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="manageusers-1.html">13.&nbsp;&nbsp;Managing Users, Rights, and Roles in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="remotead-1.html">14.&nbsp;&nbsp;Remote Administration in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="manageldap-1.html">15.&nbsp;&nbsp;Trusted Extensions and LDAP (Overview)</a></p>
<p class="toc level2"><a href="managezones-1.html">16.&nbsp;&nbsp;Managing Zones in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="managefiles-1.html">17.&nbsp;&nbsp;Managing and Mounting Files in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="txnet-1.html">18.&nbsp;&nbsp;Trusted Networking (Overview)</a></p>
<p class="toc level2"><a href="managetnet-1.html">19.&nbsp;&nbsp;Managing Networks in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="managemail-1.html">20.&nbsp;&nbsp;Multilevel Mail in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="manageprint-1.html">21.&nbsp;&nbsp;Managing Labeled Printing (Tasks)</a></p>
<p class="toc level2"><a href="gentextid-15538.html">22.&nbsp;&nbsp;Devices in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="managedev-1.html">23.&nbsp;&nbsp;Managing Devices for Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="audtask-1.html">24.&nbsp;&nbsp;Trusted Extensions Auditing (Overview)</a></p>
<p class="toc level2"><a href="softmgt-1.html">25.&nbsp;&nbsp;Software Management in Trusted Extensions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="appol-1.html">A.&nbsp;&nbsp;Site Security Policy</a></p>
<p class="toc level2"><a href="appol-12.html">Creating and Managing a Security Policy</a></p>
<p class="toc level2"><a href="appol-11.html">Site Security Policy and Trusted Extensions</a></p>
<p class="toc level2"><a href="appol-2.html">Computer Security Recommendations</a></p>
<p class="toc level2"><a href="appol-3.html">Physical Security Recommendations</a></p>
<p class="toc level2"><a href="appol-4.html">Personnel Security Recommendations</a></p>
<p class="toc level2"><a href="appol-5.html">Common Security Violations</a></p>
<p class="toc level2"><a href="appol-6.html">Additional Security References</a></p>
<p class="toc level1 tocsp"><a href="aptxconf-1.html">B.&nbsp;&nbsp;Using CDE Actions to Install Zones in Trusted Extensions</a></p>
<p class="toc level2"><a href="aptxconf-62.html">Associating Network Interfaces With Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level2"><a href="aptxconf-40.html">Preparing to Create Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level2"><a href="aptxconf-20.html">Creating Labeled Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level1 tocsp"><a href="checklist-1.html">C.&nbsp;&nbsp;Configuration Checklist for Trusted Extensions</a></p>
<p class="toc level2"><a href="checklist-2.html">Checklist for Configuring Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="txapp-1.html">D.&nbsp;&nbsp;Quick Reference to Trusted Extensions Administration</a></p>
<p class="toc level2"><a href="txapp-2.html">Administrative Interfaces in Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-3.html">Solaris Interfaces Extended by Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-4.html">Tighter Security Defaults in Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-5.html">Limited Options in Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="txmp-1.html">E.&nbsp;&nbsp;List of Trusted Extensions Man Pages</a></p>
<p class="toc level2"><a href="txmp-2.html">Trusted Extensions Man Pages in Alphabetical Order</a></p>
<p class="toc level2"><a href="txmp-3.html">Solaris Man Pages That Are Modified by Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="txconf-60"></a><h3>Setting Up the Global Zone in Trusted Extensions</h3>
<p>Before setting up the global zone, you must make decisions about your configuration.
For the decisions, see <a href="startinst-6.html">Collecting Information and Making Decisions Before Enabling&nbsp;Trusted Extensions</a>.</p><table><col width="18%"><col width="43%"><col width="37%"><tr><th align="left" valign="top" scope="column"><p>Task</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>For Instructions</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Protect the hardware.</p></td>
<td align="left" valign="top" scope="row"><p>Hardware can be protected by
requiring a password to change hardware settings.</p></td>
<td align="left" valign="top" scope="row"><p><a href="http://docs.sun.com/doc/819-3321/secsystask-46?a=view">Controlling Access to System Hardware in <i>System Administration Guide: Security Services</i></a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Configure labels.</p></td>
<td align="left" valign="top" scope="row"><p>Labels <b>must</b> be configured for your
site. If you plan to use the default <tt>label_encodings</tt> file, you can skip this
step.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#confsys-17">Check and Install Your Label Encodings File</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>For IPv6, modify the <tt>/etc/system</tt> file.</p></td>
<td align="left" valign="top" scope="row"><p>If you are running an IPv6 network,
you modify  the <tt>/etc/system</tt> file to enable IP to recognize labeled packets.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#txconf-35">Enable IPv6 Networking in Trusted Extensions</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>For
a DOI whose value is not <tt>1</tt>, modify the <tt>/etc/system</tt> file.</p></td>
<td align="left" valign="top" scope="row"><p>If the
CIPSO Domain of Interpretation (DOI) of your network nodes is different from <tt>1</tt>,
specify the DOI in the <tt>/etc/system</tt> file.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#txconf-92">Configure the Domain of Interpretation</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Create space for a Solaris ZFS
snapshot.</p></td>
<td align="left" valign="top" scope="row"><p>If you plan to use a Solaris ZFS snapshot to clone zones,
create the ZFS pool.</p><p>Perform this task if you are going to clone the
first zone to create the rest of the labeled zones.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#txconf-42">Create ZFS Pool for Cloning Zones</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Reboot and log in.</p></td>
<td align="left" valign="top" scope="row"><p>Upon
login, you are in the global zone, which is an environment that recognizes
and enforces mandatory access control (MAC).</p></td>
<td align="left" valign="top" scope="row"><p><a href="#confsys-3">Reboot and Log In to Trusted Extensions</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Initialize the Solaris Management Console.</p></td>
<td align="left" valign="top" scope="row"><p>Trusted Extensions adds
tools to the Solaris Management Console for administering users, roles, zones, and the
network.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#confsys-21">Initialize the Solaris Management Console Server in Trusted Extensions</a></p></td>
</tr>
<tr><td rowspan="2" align="left" valign="top" scope="row"><p>Configure LDAP.</p></td>
<td align="left" valign="top" scope="row"><p>If you are using the LDAP naming service, set up the
LDAP service.</p></td>
<td align="left" valign="top" scope="row"><p><a href="txldap-1.html">Chapter&nbsp;5, Configuring LDAP for Trusted Extensions (Tasks)</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>If you have set up the LDAP service, make this system
an LDAP client.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#txldap-8">Make the Global Zone an LDAP Client in Trusted Extensions</a></p></td>
</tr>
</table>

<a name="confsys-17"></a><h4>Check and Install Your Label Encodings File</h4><a name="indexterm-90"></a><a name="indexterm-91"></a><a name="indexterm-92"></a><a name="indexterm-93"></a><a name="indexterm-94"></a><a name="indexterm-95"></a><a name="indexterm-96"></a><a name="indexterm-97"></a><a name="indexterm-98"></a><a name="indexterm-99"></a><p>Your encodings file must be compatible with any Trusted Extensions host with which
you are communicating.</p>
<hr><p><b>Note - </b>Trusted Extensions installs a default <tt>label_encodings</tt> file. This default file is useful for
demonstrations. However, this file might not be a good choice for your use.
If you plan to use the default file, you can skip this procedure.</p>
<hr>

<ul><li><p>If you are familiar with encodings files, you can use the following procedure.</p></li>
<li><p>If you are not familiar with encodings files, consult <a href="http://docs.sun.com/doc/819-7308"><i>Solaris Trusted Extensions Label Administration</i></a> for requirements, procedures, and examples.</p></li></ul>

<hr><p><b>Caution - </b>You <b>must</b> successfully install labels before continuing, or the configuration will fail.</p>
<hr>
<h6>Before You Begin</h6><p>You are the security administrator. The <a href="glossary-1.html#glossary-111">security administrator</a> is responsible for editing, checking,
and maintaining the <tt>label_encodings</tt> file. If you plan to edit the <tt>label_encodings</tt> file,
make sure that the file itself is writable. For more information, see the
<a href="http://docs.sun.com/doc/819-2251/label-encodings-4?a=view"><tt>label_encodings</tt>(4)</a> man page.</p><ol>
<li><b>Insert the media with the <tt>label_encodings</tt> file into the appropriate device.</b></li>
<li><b>Copy the <tt>label_encodings</tt> file to the disk.</b></li>
<li><b>Check the syntax of the file and make it the active <tt>label_encodings</tt>
file.</b><ul>
<li><a name="txconf-lejds-1"></a><b>In Trusted GNOME, check and install the file from the command line.</b><ol style="list-style-type: lower-alpha">
<li><b>Open a terminal window.</b></li>
<li><b>Run the <tt>chk_encodings</tt> command.</b><pre># /usr/sbin/chk_encodings <i>/full-pathname-of-label-encodings-file</i></pre></li>
<li><b>Read the output and do one of the following:</b><ul>
<li><b>Resolve errors.</b><p>If the command reports errors, the errors <b>must</b> be resolved before continuing. For
assistance, see <a href="http://docs.sun.com/doc/819-7308/modifyenc-1?a=view">Chapter 3, Making a Label Encodings File (Tasks), in <i>Solaris Trusted Extensions Label Administration</i></a></p></li>
<li><b>Make the file the active <tt>label_encodings</tt> file.</b><pre># <tt><b>cp </tt><i>/full-pathname-of-label-encodings-file</i><tt> \ /etc/security/tsol/label.encodings.site</b></tt>
# <tt><b>cd /etc/security/tsol</b></tt>
# <tt><b>cp label_encodings label_encodings.tx.orig</b></tt>
# <tt><b>cp label.encodings.site label_encodings</b></tt></pre></li></ul></li></ol>
<hr><p><b>Caution - </b>Your <tt>label_encodings</tt> file <b>must</b> pass the <tt>chk_encodings</tt> test before you continue.</p>
<hr>
</li>
<li><b>In Trusted CDE, use the Check Encodings action.</b><ol style="list-style-type: lower-alpha">
<li><b>Open the Trusted_Extensions folder.</b><p>Click mouse button 3 on the background.</p></li>
<li><b>From the Workspace menu, choose Applications &rarr; Application Manager.</b></li>
<li><b>Double-click the Trusted_Extensions folder icon.</b><br><img src="figures/Dtagen.m.color.gif" alt="Illustration shows the Trusted_Extensions folder icon." width="32" height="32"></img></li>
<li><b>Double-click the Check Encodings action.</b><p>In the dialog box, type the full path name to the file:</p><pre><i>/full-pathname-of-label-encodings-file</i></pre><p>The <tt>chk_encodings</tt> command is invoked to check the syntax of the file. The
results are displayed in the Check Encodings dialog box.</p></li>
<li><b>Read the contents of the Check Encodings dialog box and do one of
the following:</b><ul>
<li><b>Resolve errors.</b><p>If the Check Encodings action reports errors, the errors <b>must</b> be resolved before
continuing. For assistance, see <a href="http://docs.sun.com/doc/819-7308/modifyenc-1?a=view">Chapter 3, Making a Label Encodings File (Tasks), in <i>Solaris Trusted Extensions Label Administration</i></a>.</p></li>
<li><b>Click <tt>Yes</tt> to make the file the active <tt>label_encodings</tt> file.</b><p>The Check Encodings action creates a backup copy of the original file, then
installs the checked version in <tt>/etc/security/tsol/label_encodings</tt>. The action then restarts the label
daemon.</p></li></ul></li></ol></li></ul>
<hr><p><b>Caution - </b>Your <tt>label_encodings</tt> file <b>must</b> pass the Check Encodings test before you continue.</p>
<hr>
</li></ol><a name="txconf-75"></a><h6>Example&nbsp;4-1 Checking <tt>label_encodings</tt> Syntax on the Command Line</h6><a name="indexterm-100"></a><p>In this example, the administrator tests several <tt>label_encodings</tt> files by using the command
line.</p><pre># <tt><b>/usr/sbin/chk_encodings /var/encodings/label_encodings1</b></tt>
No errors found in /var/encodings/label_encodings1
# <tt><b>/usr/sbin/chk_encodings /var/encodings/label_encodings2</b></tt>
No errors found in /var/encodings/label_encodings2</pre><p>When management decides to use the <tt>label_encodings2</tt> file, the administrator runs a semantic
analysis of the file.</p><pre># <tt><b>/usr/sbin/chk_encodings -a /var/encodings/label_encodings2</b></tt>
No errors found in /var/encodings/label_encodings2

---&gt; VERSION = MYCOMPANY LABEL ENCODINGS  2.0 10/10/2006

---&gt; CLASSIFICATIONS &lt;---

   Classification 1: PUBLIC
   Initial Compartment bits: 10
   Initial Markings bits: NONE

---&gt; COMPARTMENTS AND MARKINGS USAGE ANALYSIS &lt;---
...
---&gt; SENSITIVITY LABEL to COLOR MAPPING &lt;---
...</pre><p>The administrator prints a copy of the semantic analysis for her records, then
moves the file to the <tt>/etc/security/tsol</tt> directory.</p><pre># <tt><b>cp /var/encodings/label_encodings2 /etc/security/tsol/label.encodings.10.10.06</b></tt>
# <tt><b>cd /etc/security/tsol</b></tt>
# <tt><b>cp label_encodings label_encodings.tx.orig</b></tt>
# <tt><b>cp label.encodings.10.10.06 label_encodings</b></tt></pre><p>Finally, the administrator verifies that the <tt>label_encodings</tt> file is the company file.</p><pre># <tt><b>/usr/sbin/chk_encodings -a /etc/security/tsol/label_encodings | head -4</b></tt>
No errors found in /etc/security/tsol/label_encodings

---&gt; VERSION = MYCOMPANY LABEL ENCODINGS  2.0 10/10/2006</pre>

<a name="txconf-35"></a><h4>Enable IPv6 Networking in Trusted Extensions</h4><a name="indexterm-101"></a><a name="indexterm-102"></a><a name="indexterm-103"></a><a name="indexterm-104"></a><p>CIPSO options do not have an Internet Assigned Numbers Authority (IANA) number to
use in the IPv6 Option Type field of a packet. The entry
that you set in this procedure supplies a number to use on the
local network until IANA assigns a number for this option. Trusted Extensions disables
IPv6 networking if this number is not defined.</p><p>To enable an IPv6 network in Trusted Extensions, you must add an
entry in the <tt>/etc/system</tt> file.</p><ul>
<li><b>Type the following entry into the <tt>/etc/system</tt> file:</b><pre><tt><b>set ip:ip6opt_ls = 0x0a</b></tt></pre></li></ul><h6>Troubleshooting</h6>
<ul><li><p><a name="indexterm-105"></a><a name="indexterm-106"></a>If error messages during boot indicate that your IPv6 configuration is incorrect, correct the entry:</p>
<ul><li><p>Check that the entry is spelled correctly.</p></li>
<li><p>Check that the system has been rebooted after adding the correct entry to the <tt>/etc/system</tt> file.</p></li></ul>
</li>
<li><p>If you install Trusted Extensions on a Solaris system that currently has IPv6 enabled, but you fail to add the IP entry in <tt>/etc/system</tt>, you see the following error message: <tt>t_optmgmt: System error: Cannot assign requested address</tt> <i>time-stamp</i></p></li>
<li><p>If you install Trusted Extensions on a Solaris system that does not have IPv6 enabled, and you fail to add the IP entry in <tt>/etc/system</tt>, you see the following types of error messages:</p>
<ul><li><p><tt>WARNING: IPv6 not enabled via /etc/system</tt></p></li>
<li><p><tt>Failed to configure IPv6 interface(s): hme0</tt></p></li>
<li><p><tt>rpcbind: Unable to join IPv6 multicast group for rpc broadcast</tt> <i>broadcast-number</i></p></li></ul>
</li></ul>


<a name="txconf-92"></a><h4>Configure the Domain of Interpretation</h4><a name="indexterm-107"></a><a name="indexterm-108"></a><a name="indexterm-109"></a><a name="indexterm-110"></a><p>All communications to and from a system that is configured with Trusted
Extensions must follow the labeling rules of a single CIPSO Domain of Interpretation
(DOI). The DOI that is used in each message is identified by an
integer number in the CIPSO IP Option header. By default, the DOI in
Trusted Extensions is <tt>1</tt>.</p><p>If your DOI is not <tt>1</tt>, you must add an entry to
the <tt>/etc/system</tt> file and modify the <tt>doi</tt> value in the default security templates.</p><ol>
<li><b>Type your DOI entry into the <tt>/etc/system</tt> file:</b><pre>set default_doi = <i>n</i></pre><p>This positive, non-zero number must match the DOI number in the <tt>tnrhtp</tt>
database for your node and for the systems that your node communicates with.</p></li>
<li><b>Before adding the <tt>tnrhtp</tt> database to your LDAP server, modify the <tt>doi</tt> value
in the default entries and all entries for local addresses.</b><p>Trusted Extensions provides two templates in the <tt>tnrhtp</tt> database, <tt>cipso</tt> and <tt>admin_low</tt>. If
you have added entries for local addresses, also modify these entries.</p><ol style="list-style-type: lower-alpha">
<li><b>Open the <tt>tnrhtp</tt> database in the trusted editor.</b><pre># <tt><b>/usr/dt/bin/trusted_edit /etc/security/tsol/tnrhtp</b></tt></pre><p>In Solaris Trusted Extensions (CDE), you can instead use the Admin Editor
action in the Trusted_Extensions folder in the Application Manager.</p></li>
<li><b>Copy the <tt>cipso</tt> template entry to another line.</b><pre>cipso:host_type=cipso;doi=1;min_sl=ADMIN_LOW;max_sl=ADMIN_HIGH
cipso:host_type=cipso;doi=1;min_sl=ADMIN_LOW;max_sl=ADMIN_HIGH</pre></li>
<li><b>Comment out one of the <tt>cipso</tt> entries.</b><pre>#cipso:host_type=cipso;doi=1;min_sl=ADMIN_LOW;max_sl=ADMIN_HIGH
cipso:host_type=cipso;doi=1;min_sl=ADMIN_LOW;max_sl=ADMIN_HIGH</pre></li>
<li><b>Modify the <tt>doi</tt> value in the uncommented <tt>cipso</tt> entry.</b><p>Make this value the same as the <tt>default_doi</tt> value in the <tt>/etc/system</tt>
file.</p><pre>#cipso:host_type=cipso;doi=1;min_sl=ADMIN_LOW;max_sl=ADMIN_HIGH
cipso:host_type=cipso;doi=<i>n</i>;min_sl=ADMIN_LOW;max_sl=ADMIN_HIGH</pre></li>
<li><b>Change the <tt>doi</tt> value for the <tt>admin_low</tt> entry.</b><pre>#admin_low:host_type=unlabeled;min_sl=ADMIN_LOW;max_sl=ADMIN_HIGH;doi=1;def_label=ADMIN_LOW
admin_low:host_type=unlabeled;min_sl=ADMIN_LOW;max_sl=ADMIN_HIGH;doi=<i>n</i>;def_label=ADMIN_LOW</pre></li></ol><p>You are finished when every <tt>doi</tt> value in every entry in the <tt>tnrhtp</tt>
database is the same.</p></li></ol><h6>Troubleshooting</h6><p>If the <tt>/etc/system</tt> file sets a <tt>default_doi</tt> value other than <tt>1</tt>, and a
security template for this system sets a value that does not match this
<tt>default_doi</tt> value, then messages similar to the following are displayed on the system
console during interface configuration:</p>
<ul><li><p><tt>NOTICE: er10 failed: 10.17.1.12 has wrong DOI 4 instead of 1</tt></p></li>
<li><p><tt>Failed to configure IPv4 interface(s): er10</tt></p></li></ul>
<p>Interface configuration failure can result in login failure:</p>
<ul><li><p><tt>Hostname: unknown</tt></p></li>
<li><p><tt>unknown console login: root</tt></p></li>
<li><p><tt>Oct 10 10:10:20 unknown login: pam_unix_cred: cannot load hostname Error 0</tt></p></li></ul>
<p>To correct the problem, boot the system into single-user mode and correct the
security templates as described in this procedure.</p><h6>See Also</h6><p>For more information about the DOI, see <a href="tnetov-40.html">Network Security Attributes in Trusted Extensions</a>.</p><p>To change the <tt>doi</tt> value in the security templates that you create, see
<a href="managetnet-3.html#managetnet-20">How to Construct a Remote Host Template</a>.</p><p>To use the editor of your choice as the trusted editor, see
<a href="commontasks-18.html#commontasks-24">How to Assign the Editor of Your Choice as the Trusted Editor</a>.</p>

<a name="txconf-42"></a><h4>Create ZFS Pool for Cloning Zones</h4><a name="indexterm-111"></a><a name="indexterm-112"></a><p>If you plan to use a Solaris ZFS<sup>TM</sup> snapshot as your zone template,
you need to create a ZFS pool from a ZFS file or
a ZFS device. This pool holds the snapshot for cloning each zone. You
use the <tt>/zone</tt> device for your ZFS pool.</p><h6>Before You Begin</h6><p>You have set aside disk space during Solaris installation for a ZFS file
system. For details, see <a href="ovw-36.html#ovw-11">Planning for Zones in Trusted Extensions</a>.</p><ol>
<li><b>Unmount the <tt>/zone</tt> partition.</b><p>During installation, you created a <tt>/zone</tt> partition with sufficient disk space of about
2000 MBytes.</p><pre># <tt><b>umount /zone</b></tt></pre></li>
<li><b>Remove the <tt>/zone</tt> mount point.</b><pre># <tt><b>rmdir /zone</b></tt></pre></li>
<li><b>Comment out the <tt>/zone</tt> entry in the <tt>vfstab</tt> file.</b><ol style="list-style-type: lower-alpha">
<li><b>Prevent the <tt>/zone</tt> entry from being read.</b><p>Open the <tt>vfstab</tt> file in an editor. Prefix the <tt>/zone</tt> entry with a comment
sign.</p><pre><tt><b>#</b></tt>/dev/dsk/c<i>n</i>t<i>n</i>d<i>n</i>s<i>n</i>  /dev/dsk/c<i>n</i>t<i>n</i>d<i>n</i>s<i>n</i>  /zone  ufs  2  yes  -</pre></li>
<li><b>Copy the disk slice, <tt>c</tt><i>n</i><tt>t</tt><i>n</i><tt>d</tt><i>n</i><tt>s</tt><i>n</i>, to the clipboard.</b></li>
<li><b>Save the file, and close the editor.</b></li></ol></li>
<li><b>Use the disk slice to re-create <tt>/zone</tt> as a ZFS pool.</b><pre># zpool create -f zone c<i>n</i>t<i>n</i>d<i>n</i>s<i>n</i></pre><p>For example, if your <tt>/zone</tt> entry used disk slice <tt>c0t0d0s5</tt>, then the command
would be the following:</p><pre># <tt><b>zpool create -f zone c0t0d0s5</b></tt></pre></li>
<li><a name="txconf-zpool-verify-1"></a><b>Verify that the ZFS pool is healthy.</b><p>Use one of the following commands:</p><pre># <tt><b>zpool status -x zone</b></tt>
pool 'zone' is healthy</pre><pre># <tt><b>zpool list</b></tt>
NAME     SIZE     USED   AVAIL   CAP   HEALTH   ALTROOT
/zone    5.84G   80K    5.84G    7%   ONLINE   -</pre><p>In this example, the initial setup team reserved a 6000 MByte partition for
zones. For more information, see the <a href="http://docs.sun.com/doc/819-2240/zpool-1m?a=view"><tt>zpool</tt>(1M)</a> man page.</p></li></ol>

<a name="confsys-3"></a><h4>Reboot and Log In to Trusted Extensions</h4><a name="indexterm-113"></a><a name="indexterm-114"></a><a name="indexterm-115"></a><p>At most sites, two or more administrators, who serve as an <a href="glossary-1.html#glossary-59">initial setup team</a>,
are present when configuring the system.</p><h6>Before You Begin</h6><p>Before you first log in, become familiar with the desktop and label options
in Trusted Extensions. For details, see <a href="http://docs.sun.com/doc/819-7313/uglog-1?a=view">Chapter 2, Logging In to Trusted Extensions (Tasks), in <i>Solaris Trusted Extensions User&rsquo;s Guide</i></a>.</p><ol>
<li><b>Reboot the system.</b><pre># <tt><b>/usr/sbin/reboot</b></tt></pre><p>If your system does not have a graphical display, go to <a href="headl-1.html">Chapter&nbsp;6, Configuring a Headless System With Trusted Extensions (Tasks)</a>.</p></li>
<li><b>Log in to   the Solaris Trusted Extensions (GNOME) desktop as superuser.</b><ol style="list-style-type: lower-alpha">
<li><b>In the login window, select  Solaris Trusted Extensions (GNOME) as the desktop.</b><p>The  desktop contains  applets that are useful when configuring the system.</p></li>
<li><b>In the login dialog box, type <tt>root</tt> and the root password.</b><p>Users must not disclose their passwords to another person, as that person might
then have access to the data of the user and will not
be uniquely identified or accountable. Note that disclosure can be direct, through the
user deliberately disclosing his/her password to another person, or indirect, such as through writing
it down, or choosing an insecure password. Trusted Extensions software provides protection against
insecure passwords, but cannot prevent a user disclosing his/her password or writing it
down.</p></li></ol></li>
<li><b>Read the information in the Last Login dialog box.</b><br><img src="figures/last.login.gif" alt="Illustration shows the Last Login dialog box."></img><p>Then click OK to dismiss the box.</p></li>
<li><b>Read the Label Builder.</b><p>Click OK to accept the default label.</p><p><a name="indexterm-116"></a><a name="indexterm-117"></a><a name="indexterm-118"></a>Once the login process is complete, the Trusted Extensions screen appears briefly, and
you are in a desktop session with four workspaces. The <tt>Trusted Path</tt> symbol is displayed
in the <a href="glossary-1.html#glossary-133">trusted stripe</a>. </p>
<hr><p><b>Note - </b>You must log off or lock the screen before leaving a system unattended.
Otherwise, a person can access the system without having to pass identification and
authentication, and that person would not be uniquely identified or accountable.</p>
<hr>
</li></ol>

<a name="confsys-21"></a><h4>Initialize the Solaris Management Console Server in Trusted Extensions</h4><a name="indexterm-119"></a><a name="indexterm-120"></a><a name="indexterm-121"></a><a name="indexterm-122"></a><a name="indexterm-123"></a><a name="indexterm-124"></a><p>This procedure enables you to administer users, roles, hosts, zones, and the network
on this system. On the first system that you configure, only the <tt>files</tt>
scope is available.</p><h6>Before You Begin</h6><p>You must be superuser.</p><p>To use the LDAP toolbox on the LDAP server from a Solaris
Management Console that is running on a client, you must complete all of
the tasks in <a href="confsys-10.html">Configuring the Solaris Management Console for LDAP (Task Map)</a>.</p><ol>
<li><b>Start the Solaris Management Console.</b><pre># <tt><b>/usr/sbin/smc &amp;</b></tt></pre>
<hr><p><b>Note - </b>The first time the Solaris Management Console  is started, it performs
several registration tasks. These tasks can take a few minutes.</p>
<hr>
</li>
<li><a name="txconf-navinvisible-1"></a><b><a name="indexterm-125"></a><a name="indexterm-126"></a>Do one of the following if toolbox icons do not appear in the
Solaris Management Console:</b><ul>
<li><b>If the Navigation pane is not visible:</b><ol style="list-style-type: lower-alpha">
<li><b>In the Open Toolbox dialog box that is displayed, click Load next to
this system's name under Server.</b><p>If this system does not have the recommended amount of memory and swap,
it might take a few minutes for the toolboxes to display. For recommendations,
see <a href="startinst-4.html">Installing or Upgrading the Solaris OS for Trusted Extensions</a>.</p></li>
<li><b>From the list of toolboxes, select a toolbox whose <tt>Policy=TSOL</tt>.</b><p><a href="#txconf-fig-1">Figure&nbsp;4-1</a> shows a This Computer (<i>this-host</i>: <tt>Scope=Files, Policy=TSOL</tt>) toolbox. Trusted Extensions modifies tools under
the System Configuration node.</p>
<hr><p><b>Caution - </b>Do not choose a toolbox that has no policy. Toolboxes without a listed
policy do not support Trusted Extensions.</p>
<hr>
<p>Your toolbox choice depends on which scope you want to influence. </p>
<ul><li><p>To edit local files, choose the Files scope.</p></li>
<li><p>To edit LDAP databases, choose the LDAP scope.</p><p>After you complete all of the tasks in <a href="confsys-10.html">Configuring the Solaris Management Console for LDAP (Task Map)</a>, the LDAP scope is available.</p></li></ul>
</li>
<li><b>Click Open.</b></li></ol></li>
<li><b>If the Navigation pane is visible, but the toolbox icons are stop signs:</b><ol style="list-style-type: lower-alpha">
<li><b>Exit the Solaris Management Console.</b></li>
<li><b>Restart the Solaris Management Console.</b><pre># <tt><b>/usr/sbin/smc &amp;</b></tt></pre></li></ol></li></ul></li>
<li><b>If you have not yet done so, select a toolbox whose <tt>Policy=TSOL</tt>.</b><p>The following figure shows a This Computer (<i>this-host</i>: <tt>Scope=Files, Policy=TSOL</tt>) toolbox. Trusted Extensions
modifies tools under the System Configuration node.</p><a name="txconf-fig-1"></a><h6>Figure&nbsp;4-1 Trusted Extensions Tools in the Solaris Management Console</h6><img src="figures/smc.navpanel.gif" alt="Window shows the System Configuration node with the Users tools and the Computers and Networks tools." width="322" height="415"></img></li>
<li>(Optional) <b>Save the current toolbox.</b><p>Saving a <tt>Policy=TSOL</tt> toolbox enables a Trusted Extensions toolbox to load by default. Preferences
are saved per role, per host. The host is the Solaris Management Console
server.</p><ol style="list-style-type: lower-alpha">
<li><b>From the Console menu, choose Preferences.</b><p>The Home toolbox is selected.</p></li>
<li><b>Define a <tt>Policy=TSOL</tt> toolbox as the Home toolbox.</b><p>Put the current toolbox in the Location field by clicking the Use
Current Toolbox button.</p></li>
<li><b>Click OK to save the preferences.</b></li></ol></li>
<li><b>Exit the Solaris Management Console.</b></li></ol><h6>See Also</h6><p>For an overview of the Trusted Extensions additions to the Solaris Management
Console, see <a href="txtool-8.html">Solaris Management Console Tools</a>. To use the Solaris Management Console to create security templates,
see <a href="managetnet-3.html">Configuring Trusted Network Databases (Task Map)</a>.</p>

<a name="txldap-8"></a><h4>Make the Global Zone an LDAP Client in Trusted Extensions</h4><a name="indexterm-127"></a><a name="indexterm-128"></a><a name="indexterm-129"></a><a name="indexterm-130"></a><p>For LDAP, this procedure establishes the naming service configuration for the global zone.
If you are not using LDAP, you can skip this procedure.</p><p>Starting in the&nbsp; Solaris Express Developer Edition&nbsp;1/08 release, if you are in a
Solaris Trusted Extensions (CDE) workspace, you can use the <tt>txzonemgr</tt> script or a
Trusted CDE action to create an LDAP client. If you are in
a Solaris Trusted Extensions (GNOME) workspace, you must use the <tt>txzonemgr</tt> script.</p>
<hr><p><b>Note - </b>If you plan to set up a name server in each labeled
zone, you are responsible for establishing the LDAP client connection to each labeled zone.</p>
<hr>
<h6>Before You Begin</h6><p>The Sun Java<sup>TM</sup> System Directory Server, that is, the LDAP server, must
exist. The server must be populated with Trusted Extensions databases, and this system
must be able to contact the server. So, the system that you are
configuring must have an entry in the <tt>tnrhdb</tt> database on the LDAP server,
or this system must be included in a wildcard entry before you perform
this procedure.</p><p>If an LDAP server that is configured with Trusted Extensions does not
exist, you must complete the procedures in <a href="txldap-1.html">Chapter&nbsp;5, Configuring LDAP for Trusted Extensions (Tasks)</a> before you perform this procedure.</p><ol>
<li><b>If you are using DNS, modify the <tt>nsswitch.ldap</tt> file.</b><ol style="list-style-type: lower-alpha">
<li><b>Save a copy of the original <tt>nsswitch.ldap</tt> file.</b><p>The standard naming service switch file for LDAP is too restrictive for Trusted
Extensions.</p><pre># <tt><b>cd /etc</b></tt>
# <tt><b>cp nsswitch.ldap nsswitch.ldap.orig</b></tt></pre></li>
<li><b>Change the <tt>nsswitch.ldap</tt> file entries for the following services.</b><p>The correct entries are similar to the following:</p><pre>hosts:    files dns ldap

ipnodes:    files dns ldap

networks:   ldap files
protocols:  ldap files
rpc:        ldap files
ethers:     ldap files
netmasks:   ldap files
bootparams: ldap files
publickey:  ldap files

services:   files</pre><p>Note that Trusted Extensions adds two entries:</p><pre>tnrhtp:    files ldap
tnrhdb:    files ldap</pre></li>
<li><b>Copy the modified <tt>nsswitch.ldap</tt> file to <tt>nsswitch.conf</tt>.</b><pre># <tt><b>cp nsswitch.ldap nsswitch.conf</b></tt></pre></li></ol></li>
<li><b>Perform one of the following steps to create an LDAP client.</b><ul>
<li><b>Run the <tt>txzonemgr</tt> script and answer the prompts about LDAP.</b><p>The Create LDAP Client menu item configures the global zone only.</p><ol style="list-style-type: lower-alpha">
<li><b>Follow the instructions in <a href="txconf-20.html#txconf-80">Run the <tt>txzonemgr</tt> Script</a>.</b><p>The title of the dialog box is Labeled Zone Manager.</p></li>
<li><b>Select Create LDAP Client.</b></li>
<li><b>Answer the following prompts and click OK after each answer:</b><pre>Enter Domain Name:                   Type the domain name
Enter Hostname of LDAP Server:       Type the name of the server
Enter IP Address of LDAP Server <i>servername</i>: Type the IP address
Enter LDAP Proxy Password:       Type the password to the server
Confirm LDAP Proxy Password:     Retype the password to the server
Enter LDAP Profile Name:         Type the profile name</pre></li>
<li><b>Confirm or cancel the displayed values.</b><pre>Proceed to create LDAP Client?</pre><p>When you confirm, the <tt>txzonemgr</tt> script adds the LDAP client. Then, a window
displays the command output.</p></li></ol></li>
<li><b>In a Trusted CDE workspace, find and use the Create LDAP Client
action.</b><ol style="list-style-type: lower-alpha">
<li><b>Navigate to the Trusted_Extensions folder by clicking mouse button 3 on the background.</b></li>
<li><b>From the Workspace menu, choose Applications &rarr; Application Manager.</b></li>
<li><b>Double-click the Trusted_Extensions folder icon.</b><p>This folder contains actions that set up interfaces, LDAP clients, and labeled zones.</p></li>
<li><b>Double-click the Create LDAP Client action.</b><p>Answer the following prompts:</p><pre>Domain Name:               Type the domain name
Hostname of LDAP Server:   Type the name of the server
IP Address of LDAP Server: Type the IP address
LDAP Proxy Password:       Type the password to the server
Profile Name:              Type the profile name</pre></li>
<li><b>Click OK.</b><p>The following completion message appears:</p><pre>global zone will be LDAP client of <i>LDAP-server</i>
System successfully configured.

*** Select Close or Exit from the window menu to close this window ***</pre></li>
<li><b>Close the action window.</b></li></ol></li></ul></li>
<li><b>Verify that the information on the server is correct.</b><ol style="list-style-type: lower-alpha">
<li><b>Open a terminal window, and query the LDAP server.</b><pre># <tt><b>ldapclient list</b></tt></pre><p>The output looks similar to the following:</p><pre>NS_LDAP_FILE_VERSION= 2.0
NS_LDAP_BINDDN= cn=proxyagent,ou=profile,dc=<i>domain-name</i>
...
NS_LDAP_BIND_TIME= <i>number</i></pre></li>
<li><b>Correct any errors.</b><p>If you get an error, run the Create LDAP Client action with the
correct values. For example, the following error can indicate that the system does
not have an entry on the LDAP server:</p><pre>LDAP ERROR (91): Can't connect to the LDAP server.
Failed to find defaultSearchBase for domain <i>domain-name</i></pre><p>To correct this error, you need to check the LDAP server.</p></li></ol></li></ol><a name="txconf-93"></a><h6>Example&nbsp;4-2 Using Host Names After Loading a <tt>resolv.conf</tt> File</h6><a name="indexterm-131"></a><a name="indexterm-132"></a><p>In this example, the administrator wants a particular set of DNS servers to
be available to the system. The administrator copies a <tt>resolv.conf</tt> file from a
server on a trusted net. Because DNS is not yet active, the
administrator uses the server's IP address to locate the server.</p><pre># <tt><b>cd /etc</b></tt>
# cp <tt><b>/net/10.1.1.2/export/txsetup/resolv.conf resolv.conf</b></tt></pre><p>After the <tt>resolv.conf</tt> file is copied and the <tt>nsswitch.conf</tt> file includes <tt>dns</tt>
in the <tt>hosts</tt> entry, the administrator can use host names to locate
systems.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="txconf-1.html">Previous</a>
             </td>
             <td align="right">
                 <a href="txconf-20.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

