<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Overview of Routing in Trusted Extensions - Solaris Trusted Extensions Administrator's Procedures</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2009-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">Solaris Trusted Extensions Administrator's Procedures</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="tnetov-2.html">Previous</a>
             </td>
             <td align="right">
                 <a href="txnet-26.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-4.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="trp-part-1.html">Part&nbsp;I&nbsp;Initial Configuration of Trusted Extensions</a></p>
<p class="toc level2"><a href="ovw-1.html">1.&nbsp;&nbsp;Security Planning for Trusted Extensions</a></p>
<p class="toc level2"><a href="tmap-1.html">2.&nbsp;&nbsp;Configuration Roadmap for Trusted Extensions</a></p>
<p class="toc level2"><a href="startinst-1.html">3.&nbsp;&nbsp;Adding Solaris Trusted Extensions Software to the Solaris OS (Tasks)</a></p>
<p class="toc level2"><a href="txconf-1.html">4.&nbsp;&nbsp;Configuring Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="txldap-1.html">5.&nbsp;&nbsp;Configuring LDAP for Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="headl-1.html">6.&nbsp;&nbsp;Configuring a Headless System With Trusted Extensions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="trp-part-2.html">Part&nbsp;II&nbsp;Administration of Trusted Extensions</a></p>
<p class="toc level2"><a href="txintro-1.html">7.&nbsp;&nbsp;Trusted Extensions Administration Concepts</a></p>
<p class="toc level2"><a href="txtool-1.html">8.&nbsp;&nbsp;Trusted Extensions Administration Tools</a></p>
<p class="toc level2"><a href="roles-1.html">9.&nbsp;&nbsp;Getting Started as a Trusted Extensions Administrator (Tasks)</a></p>
<p class="toc level2"><a href="secreq-1.html">10.&nbsp;&nbsp;Security Requirements on a Trusted Extensions System (Overview)</a></p>
<p class="toc level2"><a href="commontasks-1.html">11.&nbsp;&nbsp;Administering Security Requirements in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="useraccts-1.html">12.&nbsp;&nbsp;Users, Rights, and Roles in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="manageusers-1.html">13.&nbsp;&nbsp;Managing Users, Rights, and Roles in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="remotead-1.html">14.&nbsp;&nbsp;Remote Administration in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="manageldap-1.html">15.&nbsp;&nbsp;Trusted Extensions and LDAP (Overview)</a></p>
<p class="toc level2"><a href="managezones-1.html">16.&nbsp;&nbsp;Managing Zones in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="managefiles-1.html">17.&nbsp;&nbsp;Managing and Mounting Files in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="txnet-1.html">18.&nbsp;&nbsp;Trusted Networking (Overview)</a></p>
<p class="toc level3"><a href="txnet-2.html">The Trusted Network</a></p>
<p class="toc level3"><a href="tnetov-40.html">Network Security Attributes in Trusted Extensions</a></p>
<p class="toc level3"><a href="tnetov-2.html">Trusted Network Fallback Mechanism</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Overview of Routing in Trusted Extensions</a></p>
</div>
<p class="toc level3"><a href="txnet-26.html">Administration of Routing in Trusted Extensions</a></p>
<p class="toc level2 tocsp"><a href="managetnet-1.html">19.&nbsp;&nbsp;Managing Networks in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="managemail-1.html">20.&nbsp;&nbsp;Multilevel Mail in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="manageprint-1.html">21.&nbsp;&nbsp;Managing Labeled Printing (Tasks)</a></p>
<p class="toc level2"><a href="gentextid-15538.html">22.&nbsp;&nbsp;Devices in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="managedev-1.html">23.&nbsp;&nbsp;Managing Devices for Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="audtask-1.html">24.&nbsp;&nbsp;Trusted Extensions Auditing (Overview)</a></p>
<p class="toc level2"><a href="softmgt-1.html">25.&nbsp;&nbsp;Software Management in Trusted Extensions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="appol-1.html">A.&nbsp;&nbsp;Site Security Policy</a></p>
<p class="toc level2"><a href="appol-12.html">Creating and Managing a Security Policy</a></p>
<p class="toc level2"><a href="appol-11.html">Site Security Policy and Trusted Extensions</a></p>
<p class="toc level2"><a href="appol-2.html">Computer Security Recommendations</a></p>
<p class="toc level2"><a href="appol-3.html">Physical Security Recommendations</a></p>
<p class="toc level2"><a href="appol-4.html">Personnel Security Recommendations</a></p>
<p class="toc level2"><a href="appol-5.html">Common Security Violations</a></p>
<p class="toc level2"><a href="appol-6.html">Additional Security References</a></p>
<p class="toc level1 tocsp"><a href="aptxconf-1.html">B.&nbsp;&nbsp;Using CDE Actions to Install Zones in Trusted Extensions</a></p>
<p class="toc level2"><a href="aptxconf-62.html">Associating Network Interfaces With Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level2"><a href="aptxconf-40.html">Preparing to Create Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level2"><a href="aptxconf-20.html">Creating Labeled Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level1 tocsp"><a href="checklist-1.html">C.&nbsp;&nbsp;Configuration Checklist for Trusted Extensions</a></p>
<p class="toc level2"><a href="checklist-2.html">Checklist for Configuring Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="txapp-1.html">D.&nbsp;&nbsp;Quick Reference to Trusted Extensions Administration</a></p>
<p class="toc level2"><a href="txapp-2.html">Administrative Interfaces in Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-3.html">Solaris Interfaces Extended by Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-4.html">Tighter Security Defaults in Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-5.html">Limited Options in Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="txmp-1.html">E.&nbsp;&nbsp;List of Trusted Extensions Man Pages</a></p>
<p class="toc level2"><a href="txmp-2.html">Trusted Extensions Man Pages in Alphabetical Order</a></p>
<p class="toc level2"><a href="txmp-3.html">Solaris Man Pages That Are Modified by Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="txnet-3"></a><h3>Overview of Routing in Trusted Extensions</h3>
<p><a name="indexterm-971"></a>In Trusted Extensions, routes between hosts on different networks must maintain security at
each step in the transmission. Trusted Extensions adds extended security attributes to the routing
protocols in the Solaris OS. Unlike the Solaris OS, this Trusted Extensions
release does not support dynamic routing. For details about specifying static routing, see the
<tt>-p</tt> option in the <a href="http://docs.sun.com/doc/819-2240/route-1m?a=view"><tt>route</tt>(1M)</a> man page.</p><p>Gateways and routers route packets. In this discussion, the terms &ldquo;gateway&rdquo; and &ldquo;router&rdquo;
are used interchangeably.</p><p>For communications between hosts on the same subnet, accreditation checks are performed at
endpoints only because no routers are involved. Label range checks are performed at
the source. If the receiving host is running Trusted Extensions software, label range
checks are also performed at the destination.</p><p>When the source and destination hosts are on different subnets, the packet is
sent from the source host to a gateway. The label range of
the destination and the first-hop gateway is checked at the source when a
route is selected. The gateway forwards the packet to the network where the
destination host is connected. A packet might go through several gateways before reaching
the destination.</p>

<a name="tnetov-14"></a><h4>Background on Routing</h4>
<p>On Trusted Extensions gateways, label range checks are performed in certain cases. A
Trusted Extensions system that is routing a packet between two unlabeled hosts compares
the default label of the source host to the default label of the
destination host. When the unlabeled hosts share a default label, the packet is
routed.</p><p>Each gateway maintains a list of routes to all destinations. Standard Solaris
routing makes choices to optimize the route. Trusted Extensions provides additional software to check
security requirements that apply to the route choices. The Solaris choices that do
not satisfy security requirements are skipped.</p>

<a name="txnet-13"></a><h4>Routing Table Entries in Trusted Extensions</h4>
<a name="indexterm-972"></a><a name="indexterm-973"></a><p>The routing table entries in Trusted Extensions can incorporate security attributes. Security attributes
can include a <tt>cipso</tt> keyword. Security attributes must include a maximum label, a
minimum label, and a DOI.</p><p>For entries that do not provide security attributes, the attributes in the gateway's
security template are used.</p>

<a name="txnet-14"></a><h4>Trusted Extensions Accreditation Checks</h4>
<a name="indexterm-974"></a><a name="indexterm-975"></a><p>Trusted Extensions software determines the suitability of a route for security purposes. The
software runs a series of tests called <b>accreditation checks</b> on the source host,
the destination host, and the intermediate gateways.</p>
<hr><p><b>Note - </b>In the following discussion, an accreditation check for a label range also means
a check for a security label set.</p>
<hr>
<p>The accreditation check verifies the label range and CIPSO label information. The security
attributes for a route are obtained from the routing table entry, or from
the security template of the gateway if the entry has no security attributes.</p><p><a name="indexterm-976"></a>For incoming communications, the Trusted Extensions software obtains labels from the packets themselves,
whenever possible. Obtaining labels from packets is only possible when the messages are
sent from systems that support labels. When a label is not available from
the packet, a default label is assigned to the message from trusted networking
database files. These labels are then used during accreditation checks. Trusted Extensions enforces
several checks on outgoing messages, forwarded messages, and incoming messages.</p>

<a name="txnet-15"></a><h5>Source Accreditation Checks</h5>
<p>The following accreditation checks are performed on the sending process or sending zone:</p>
<ul><li><p>For all destinations, the label of the data must be within the label range of the next hop in the route, that is, the first hop. And, the label must be contained in the first-hop gateway's security attributes.</p></li>
<li><p>For all destinations, the DOI of an outgoing packet must match the DOI of the destination host. The DOI must also match the DOI of all hops along the route, including its first-hop gateway.</p></li>
<li><p>When the destination host is an unlabeled host, one of the following conditions must be satisfied:</p>
<ul><li><p>The sending host's label must match the destination host's default label.</p></li>
<li><p>The sending host is privileged to perform cross-label communication, and the sender's label dominates the destination's default label.</p></li>
<li><p>The sending host is privileged to perform cross-label communication, and the sender's label is <tt>ADMIN_LOW</tt>. That is, the sender is sending from the global zone.</p></li></ul>
</li></ul>

<hr><p><b>Note - </b>A first-hop check occurs when a message is being sent through a gateway
from a host on one network to a host on another network.</p>
<hr>


<a name="txnet-16"></a><h5>Gateway Accreditation Checks</h5>
<a name="indexterm-977"></a><p>On a Trusted Extensions gateway system,the following accreditation checks are performed for the
next-hop gateway:</p>
<ul><li><p>If the incoming packet is unlabeled, the packet inherits the source host's default label from the <tt>tnrhdb</tt> entry. Otherwise, the packet receives the indicated CIPSO label.</p></li>
<li><p>Checks for forwarding a packet proceed similar to source accreditation:</p>
<ul><li><p>For all destinations, the label of the data must be within the label range of the next hop. And, the label must be contained in the security attributes of the next-hop host.</p></li>
<li><p>For all destinations, the DOI of an outgoing packet must match the DOI of the destination host. The DOI must also match the DOI of the next-hop host.</p></li>
<li><p>The label of an unlabeled packet must match the destination host's default label.</p></li>
<li><p>The label of a CIPSO packet must be within the destination host's label range.</p></li></ul>
</li></ul>


<a name="txnet-17"></a><h5>Destination Accreditation Checks</h5>
<p>When a Trusted Extensions host receives data, the software performs the following checks:</p>
<ul><li><p>If the incoming packet is unlabeled, the packet inherits the source host's default label from the <tt>tnrhdb</tt> entry. Otherwise, the packet receives the indicated CIPSO label.</p></li>
<li><p>The label and DOI for the packet must be consistent with the destination zone or destination process's label and DOI. The exception is when a process is listening on a port. The listening process can receive a packet if the process is privileged to perform cross-label communications, and the process is either in the global zone or has a label that dominates the packet's label.</p></li></ul>

         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="tnetov-2.html">Previous</a>
             </td>
             <td align="right">
                 <a href="txnet-26.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

