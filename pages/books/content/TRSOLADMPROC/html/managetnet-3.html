<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Configuring Trusted Network Databases (Task Map) - Solaris Trusted Extensions Administrator's Procedures</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2009-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">Solaris Trusted Extensions Administrator's Procedures</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="managetnet-6.html">Previous</a>
             </td>
             <td align="right">
                 <a href="managetnet-14.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-4.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="trp-part-1.html">Part&nbsp;I&nbsp;Initial Configuration of Trusted Extensions</a></p>
<p class="toc level2"><a href="ovw-1.html">1.&nbsp;&nbsp;Security Planning for Trusted Extensions</a></p>
<p class="toc level2"><a href="tmap-1.html">2.&nbsp;&nbsp;Configuration Roadmap for Trusted Extensions</a></p>
<p class="toc level2"><a href="startinst-1.html">3.&nbsp;&nbsp;Adding Solaris Trusted Extensions Software to the Solaris OS (Tasks)</a></p>
<p class="toc level2"><a href="txconf-1.html">4.&nbsp;&nbsp;Configuring Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="txldap-1.html">5.&nbsp;&nbsp;Configuring LDAP for Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="headl-1.html">6.&nbsp;&nbsp;Configuring a Headless System With Trusted Extensions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="trp-part-2.html">Part&nbsp;II&nbsp;Administration of Trusted Extensions</a></p>
<p class="toc level2"><a href="txintro-1.html">7.&nbsp;&nbsp;Trusted Extensions Administration Concepts</a></p>
<p class="toc level2"><a href="txtool-1.html">8.&nbsp;&nbsp;Trusted Extensions Administration Tools</a></p>
<p class="toc level2"><a href="roles-1.html">9.&nbsp;&nbsp;Getting Started as a Trusted Extensions Administrator (Tasks)</a></p>
<p class="toc level2"><a href="secreq-1.html">10.&nbsp;&nbsp;Security Requirements on a Trusted Extensions System (Overview)</a></p>
<p class="toc level2"><a href="commontasks-1.html">11.&nbsp;&nbsp;Administering Security Requirements in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="useraccts-1.html">12.&nbsp;&nbsp;Users, Rights, and Roles in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="manageusers-1.html">13.&nbsp;&nbsp;Managing Users, Rights, and Roles in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="remotead-1.html">14.&nbsp;&nbsp;Remote Administration in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="manageldap-1.html">15.&nbsp;&nbsp;Trusted Extensions and LDAP (Overview)</a></p>
<p class="toc level2"><a href="managezones-1.html">16.&nbsp;&nbsp;Managing Zones in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="managefiles-1.html">17.&nbsp;&nbsp;Managing and Mounting Files in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="txnet-1.html">18.&nbsp;&nbsp;Trusted Networking (Overview)</a></p>
<p class="toc level2"><a href="managetnet-1.html">19.&nbsp;&nbsp;Managing Networks in Trusted Extensions (Tasks)</a></p>
<p class="toc level3"><a href="managetnet-6.html">Managing the Trusted Network (Task Map)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Configuring Trusted Network Databases (Task Map)</a></p>
</div>
<p class="toc level3"><a href="managetnet-14.html">Configuring Routes and Checking Network Information in Trusted Extensions (Task Map)</a></p>
<p class="toc level3"><a href="managetnet-2.html">Troubleshooting the Trusted Network (Task Map)</a></p>
<p class="toc level2 tocsp"><a href="managemail-1.html">20.&nbsp;&nbsp;Multilevel Mail in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="manageprint-1.html">21.&nbsp;&nbsp;Managing Labeled Printing (Tasks)</a></p>
<p class="toc level2"><a href="gentextid-15538.html">22.&nbsp;&nbsp;Devices in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="managedev-1.html">23.&nbsp;&nbsp;Managing Devices for Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="audtask-1.html">24.&nbsp;&nbsp;Trusted Extensions Auditing (Overview)</a></p>
<p class="toc level2"><a href="softmgt-1.html">25.&nbsp;&nbsp;Software Management in Trusted Extensions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="appol-1.html">A.&nbsp;&nbsp;Site Security Policy</a></p>
<p class="toc level2"><a href="appol-12.html">Creating and Managing a Security Policy</a></p>
<p class="toc level2"><a href="appol-11.html">Site Security Policy and Trusted Extensions</a></p>
<p class="toc level2"><a href="appol-2.html">Computer Security Recommendations</a></p>
<p class="toc level2"><a href="appol-3.html">Physical Security Recommendations</a></p>
<p class="toc level2"><a href="appol-4.html">Personnel Security Recommendations</a></p>
<p class="toc level2"><a href="appol-5.html">Common Security Violations</a></p>
<p class="toc level2"><a href="appol-6.html">Additional Security References</a></p>
<p class="toc level1 tocsp"><a href="aptxconf-1.html">B.&nbsp;&nbsp;Using CDE Actions to Install Zones in Trusted Extensions</a></p>
<p class="toc level2"><a href="aptxconf-62.html">Associating Network Interfaces With Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level2"><a href="aptxconf-40.html">Preparing to Create Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level2"><a href="aptxconf-20.html">Creating Labeled Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level1 tocsp"><a href="checklist-1.html">C.&nbsp;&nbsp;Configuration Checklist for Trusted Extensions</a></p>
<p class="toc level2"><a href="checklist-2.html">Checklist for Configuring Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="txapp-1.html">D.&nbsp;&nbsp;Quick Reference to Trusted Extensions Administration</a></p>
<p class="toc level2"><a href="txapp-2.html">Administrative Interfaces in Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-3.html">Solaris Interfaces Extended by Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-4.html">Tighter Security Defaults in Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-5.html">Limited Options in Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="txmp-1.html">E.&nbsp;&nbsp;List of Trusted Extensions Man Pages</a></p>
<p class="toc level2"><a href="txmp-2.html">Trusted Extensions Man Pages in Alphabetical Order</a></p>
<p class="toc level2"><a href="txmp-3.html">Solaris Man Pages That Are Modified by Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="managetnet-3"></a><h3>Configuring Trusted Network Databases (Task Map)</h3>
<a name="indexterm-989"></a><a name="indexterm-990"></a><a name="indexterm-991"></a><a name="indexterm-992"></a><a name="indexterm-993"></a><a name="indexterm-994"></a><a name="indexterm-995"></a><a name="indexterm-996"></a><a name="indexterm-997"></a><a name="indexterm-998"></a><a name="indexterm-999"></a><a name="indexterm-1000"></a><a name="indexterm-1001"></a><a name="indexterm-1002"></a><a name="indexterm-1003"></a><a name="indexterm-1004"></a><a name="indexterm-1005"></a><a name="indexterm-1006"></a><a name="indexterm-1007"></a><a name="indexterm-1008"></a><p>Trusted Extensions software includes the <tt>tnrhtp</tt> and <tt>tnrhdb</tt> databases. These databases provide
labels for remote hosts that contact the system. The Solaris Management Console provides
the GUI that you use to administer these databases.</p><table><col width="33%"><col width="33%"><col width="33%"><tr><th align="left" valign="top" scope="column"><p>Task</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>For Instructions</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Determine if your site
requires customized security templates.</p></td>
<td align="left" valign="top" scope="row"><p>Evaluates the existing templates for the security requirements of
your site.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#managetnet-22">How to Determine If You Need Site-Specific Security Templates</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Access the Security Templates tool in the Solaris Management Console.</p></td>
<td align="left" valign="top" scope="row"><p>Accesses the tool
for modifying trusted network databases.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#managetnet-15">How to Open the Trusted Networking Tools</a></p></td>
</tr>
<tr><td rowspan="8" align="left" valign="top" scope="row"><p>Modify security templates.</p></td>
<td align="left" valign="top" scope="row"><p>Modifies the definitions of security attributes
in your trusted network by modifying the trusted network databases.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#managetnet-20">How to Construct a Remote Host Template</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Changes the DOI to
a value different from <tt>1</tt>.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#managetnet-47">Example&nbsp;19-1</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Creates a security template for labeled hosts that
restrict communication between other hosts to a single label.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#managetnet-48">Example&nbsp;19-2</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Creates a security template for
unlabeled hosts that operate as single-label gateways.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#managetnet-23">Example&nbsp;19-3</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Creates a security template for hosts with
a restricted label range.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#managetnet-24">Example&nbsp;19-4</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Creates a security template for a host that specifies
a set of discrete labels in its label range.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#managetnet-25">Example&nbsp;19-5</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Creates a security template for
unlabeled systems and networks.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#txconf-49">Example&nbsp;19-6</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Creates a security template for two developer systems.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#txconf-51">Example&nbsp;19-7</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Add hosts
to the known network.</p></td>
<td align="left" valign="top" scope="row"><p>Adds systems and networks to the trusted network.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#txconf-9">How to Add Hosts to the System's Known Network</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Provide remote
host access by using wildcard entries.</p></td>
<td align="left" valign="top" scope="row"><p>Allows hosts within a range of IP
addresses to communicate with a system by indirectly assigning each host to the
same security template.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#managetnet-26">Example&nbsp;19-8</a></p><p><a href="#managetnet-27">Example&nbsp;19-9</a></p><p><a href="#managetnet-28">Example&nbsp;19-10</a></p></td>
</tr>
<tr><td rowspan="2" align="left" valign="top" scope="row"><p>Change the <tt>admin_low</tt> wildcard entry in the <tt>tnrhdb</tt> file.</p></td>
<td align="left" valign="top" scope="row"><p>Increases security
by replacing the wildcard entry with specific addresses for the host to contact
at boot time.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#managetnet-8">How to Limit the Hosts That Can Be Contacted on the Trusted Network</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Increases security by replacing the wildcard entry with a network
of labeled hosts as the default.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#managetnet-43">Example&nbsp;19-11</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Create an entry for the host address <tt>0.0.0.0</tt></p></td>
<td align="left" valign="top" scope="row"><p>Configures a Sun
Ray server to accept the initial contact from a remote client</p></td>
<td align="left" valign="top" scope="row"><p><a href="#managetnet-35">Example&nbsp;19-13</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Assign security
templates.</p></td>
<td align="left" valign="top" scope="row"><p>Associates a template with an IP address or list of contiguous IP
addresses.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#managetnet-16">How to Assign a Security Template to a Host or a Group of Hosts</a></p></td>
</tr>
</table>

<a name="managetnet-22"></a><h4>How to Determine If You Need Site-Specific Security Templates</h4><h6>Before You Begin</h6><p>You must be in the Security Administrator role in the global zone.</p><ol>
<li><b>Familiarize yourself with the Trusted Extensions templates.</b><p>Read the <tt>tnrhtp</tt> file on a local host. The comments in the file are
helpful. You can also view the security attribute values in the Security Templates
tool in the Solaris Management Console.</p>
<ul><li><p>The default templates match any installation. The label range for each template is <tt>ADMIN_LOW</tt> to <tt>ADMIN_HIGH</tt>.</p></li>
<li><p>The <tt>cipso</tt> template defines a CIPSO host type whose DOI is <tt>1</tt>. The label range for the template is <tt>ADMIN_LOW</tt> to <tt>ADMIN_HIGH</tt>.</p></li>
<li><p>The <tt>admin_low</tt> template defines an unlabeled host whose DOI is <tt>1</tt>. The template's default label is <tt>ADMIN_LOW</tt>. The label range for the template is <tt>ADMIN_LOW</tt> to <tt>ADMIN_HIGH</tt>. In the default configuration, the address <tt>0.0.0.0</tt> is assigned to this template. Therefore, all non-CIPSO hosts are treated as hosts that operate at the <tt>ADMIN_LOW</tt> security label.</p></li></ul>
</li>
<li><b>Keep the default templates.</b><p>For support purposes, do not delete or modify the default templates. You can
change the host that is assigned these default templates. For an example, see
<a href="#managetnet-8">How to Limit the Hosts That Can Be Contacted on the Trusted Network</a>.</p></li>
<li><b>Create new templates if you want to do any of the following:</b>
<ul><li><p>Limit the label range of a host or a group of hosts.</p></li>
<li><p>Create a single-label host.</p></li>
<li><p>Create a host that recognizes a few discrete labels.</p></li>
<li><p>Use a different DOI than <tt>1</tt>.</p></li>
<li><p>Require a default label for unlabeled hosts that is not <tt>ADMIN_LOW</tt>.</p></li></ul>
<p>For details, see <a href="#managetnet-20">How to Construct a Remote Host Template</a>.</p></li></ol>

<a name="managetnet-15"></a><h4>How to Open the Trusted Networking Tools</h4><a name="indexterm-1009"></a><a name="indexterm-1010"></a><a name="indexterm-1011"></a><h6>Before You Begin</h6><p>You must be in the global zone in a role that can
modify network security. For example, roles that are assigned the Information Security or
Network Security rights profile can modify security settings. The Security Administrator role includes these
profiles.</p><p>To use the LDAP toolbox, you must have completed <a href="confsys-10.html">Configuring the Solaris Management Console for LDAP (Task Map)</a>.</p><ol>
<li><b>Start the Solaris Management Console.</b><p>For details, see <a href="txconf-60.html#confsys-21">Initialize the Solaris Management Console Server in Trusted Extensions</a>.</p></li>
<li><b>Use the appropriate tool.</b>
<ul><li><p>To modify a template, use the Security Templates tool.</p><p>All currently defined templates display in the right pane. When you select or create a template, online help is available in the left pane.</p></li>
<li><p>To assign a host to a template, use the Security Templates tool.</p></li>
<li><p>To create a host that can be assigned to a template, use the Computers and Networks tool.</p></li>
<li><p>To assign a label to a zone, use the Trusted Network Zones tool. For more information about zones in Trusted Extensions, see <a href="managezones-1.html">Chapter&nbsp;16, Managing Zones in Trusted Extensions (Tasks)</a>.</p></li></ul>
</li></ol>

<a name="managetnet-20"></a><h4>How to Construct a Remote Host Template</h4><a name="indexterm-1012"></a><a name="indexterm-1013"></a><a name="indexterm-1014"></a><a name="indexterm-1015"></a><h6>Before You Begin</h6><p>You must be in the global zone in a role that can
modify network security. For example, roles that are assigned the Information Security or
Network Security rights profiles can modify security settings. The Security Administrator role includes these
profiles.</p><ol>
<li><b>In the Solaris Management Console, navigate to the Security Templates tool.</b><p>See <a href="#managetnet-15">How to Open the Trusted Networking Tools</a> for the steps.</p></li>
<li><b>Under Computers and Networks, double-click Security Templates.</b><p>The existing templates are displayed in the View pane. These templates describe the
security attributes for hosts that this system can contact. These hosts include CIPSO
hosts that are running Trusted Extensions and unlabeled hosts.</p></li>
<li><b>Examine the <tt>cipso</tt> template.</b><p>View which hosts and which networks are already assigned this template.</p></li>
<li><b>Examine the <tt>admin_low</tt> template.</b><p>View which hosts and which networks are already assigned this template.</p></li>
<li><b>Create a template.</b><p>If the provided templates do not sufficiently describe the hosts that can be
in communication with this system, choose Add Template from the Action menu.</p><p>Use the online help for assistance. Before assigning hosts to the templates, create
all the templates that your site requires.</p></li>
<li>(Optional) <b>Modify an existing template that is not a default template.</b><p>Double-click the template, and use the online help for assistance. You can change
the assigned hosts or the assigned networks.</p></li></ol><a name="managetnet-47"></a><h6>Example&nbsp;19-1 Creating a Security Template With a Different DOI Value</h6><p>In this example, the security administrator's network has a DOI whose value is
different from <tt>1</tt>. The team that initially configured the system has completed <a href="txconf-60.html#txconf-92">Configure the Domain of Interpretation</a>.</p><p>First, the security administrator confirms the value of the DOI in the
<tt>/etc/system</tt> file:</p><pre># <tt><b>grep doi /etc/system</b></tt>
set default_doi = 4</pre><p>Then, in the Security Templates tool, for every template that the administrator creates,
the value of <tt>doi</tt> is set to <tt>4</tt>. For the single-label system that
is described in <a href="#managetnet-48">Example&nbsp;19-2</a>, the security administrator creates the following template:</p><pre>template: CIPSO_PUBLIC
host_type: CIPSO
doi: <tt><b>4</b></tt>
min_sl: PUBLIC
max_sl: PUBLIC</pre><a name="managetnet-48"></a><h6>Example&nbsp;19-2 Creating a Security Template That Has a Single Label</h6><p>In this example, the security administrator wants to create a gateway that can
only pass packets at a single label, <tt>PUBLIC</tt>. Using the Security Templates tool
in the Solaris Management Console, the administrator creates a template and assigns the
gateway host to the template.</p><p>First, the gateway host and IP address are added to the Computers
and Networks tool.</p><pre>gateway-1
192.168.131.75</pre><p>Then, the template is created in the Security Templates tool.&nbsp; The following are
the values in the template:</p><pre>template: <tt><b>CIPSO_PUBLIC</b></tt>
host_type: <tt><b>CIPSO</b></tt>
doi: <tt><b>1</b></tt>
min_sl: <tt><b>PUBLIC</b></tt>
max_sl: <tt><b>PUBLIC</b></tt></pre><p>The tool supplies the hexadecimal value for <tt>PUBLIC</tt>, <tt>0X0002-08-08</tt>.</p><p>Finally, the <tt>gateway-1</tt> host is assigned to the template by its name and
IP address.</p><pre>gateway-1
192.168.131.75</pre><p>On a local host, the <tt>tnrhtp</tt> entry appears similar to the following:</p><pre>cipso_public:host_type=cipso;doi=1;min_sl=0X0002-08-08;max_sl=0X0002-08-08;</pre><p>On a local host, the <tt>tnrhdb</tt> entry appears similar to the following:</p><pre># gateway-1
192.168.131.75:cipso_public</pre><a name="managetnet-23"></a><h6>Example&nbsp;19-3 Creating a Security Template for an Unlabeled Router</h6><p>Any IP router can forward messages with CIPSO labels even though the router
does not explicitly support labels. Such an unlabeled  router needs a default
label to define the level at which connections to the router, perhaps for
router management, need to be handled. In this example, the security administrator creates
a router that can forward traffic at any label, but all direct
communication with the router is handled at the default label, <tt>PUBLIC</tt>.</p><p>In the Solaris Management Console, the administrator creates a template and assigns
the gateway host to the template.</p><p>First, the router and its IP address are added to the Computers
and Networks tool.</p><pre>router-1
192.168.131.82</pre><p>Then, the template is created in the Security Templates tool. The following values
are in the template:</p><pre>Template Name: <tt><b>UNL_PUBLIC</b></tt>
Host Type: <tt><b>UNLABELED</b></tt>
DOI: <tt><b>1</b></tt>
Default Label: <tt><b>PUBLIC</b></tt>
Minimum Label: <tt><b>ADMIN_LOW</b></tt>
Maximum Label: <tt><b>ADMIN_HIGH</b></tt></pre><p>The tool supplies the hexadecimal value for the labels.</p><p>Finally, the <tt>router-1</tt> router is assigned to the template by its name and
IP address.</p><pre>router-1
192.168.131.82</pre><a name="managetnet-24"></a><h6>Example&nbsp;19-4 Creating a Security Template That Has a Limited Label Range</h6><p>In this example, the security administrator wants to create a gateway that restricts
packets to a narrow label range. In the Solaris Management Console, the
administrator creates a template and assigns the gateway host to the template.</p><p>First, the host and its IP address are added to the Computers
and Networks tool.</p><pre>gateway-ir
192.168.131.78</pre><p>Then, the template is created in the Security Templates tool. The following values
are in the template:</p><pre>Template Name: <tt><b>CIPSO_IUO_RSTRCT</b></tt>
Host Type: <tt><b>CIPSO</b></tt>
DOI: <tt><b>1</b></tt>
Minimum Label: <tt><b>CONFIDENTIAL : INTERNAL USE ONLY</b></tt>
Maximum Label: <tt><b>CONFIDENTIAL : RESTRICTED</b></tt></pre><p>The tool supplies the hexadecimal value for the labels.</p><p>Finally, the <tt>gateway-ir</tt> gateway is assigned to the template by its name and
IP address.</p><pre>gateway-ir
192.168.131.78</pre><a name="managetnet-25"></a><h6>Example&nbsp;19-5 Creating a Security Template That Has a Security Label Set</h6><p>In this example, the security administrator wants to create a security template that
recognizes two labels only. In the Solaris Management Console, the administrator creates a
template and assigns the gateway host to the template.</p><p>First, each host and IP address that is going to use this
template is added to the Computers and Networks tool.</p><pre>host-slset1
192.168.132.21

host-slset2
192.168.132.22

host-slset3
192.168.132.23

host-slset4
192.168.132.24</pre><p>Then, the template is created in the Security Templates tool. The following values
are in the template:</p><pre>Template Name: <tt><b>CIPSO_PUB_RSTRCT</b></tt>
Host Type: <tt><b>CIPSO</b></tt>
DOI: <tt><b>1</b></tt>
Minimum Label: <tt><b>PUBLIC</b></tt>
Maximum Label: <tt><b>CONFIDENTIAL : RESTRICTED</b></tt>
SL Set: <tt><b>PUBLIC, CONFIDENTIAL : RESTRICTED</b></tt></pre><p>The tool supplies the hexadecimal value for the labels.</p><p>Finally, the range of IP addresses are assigned to the template by
using the Wildcard button and a prefix.</p><pre>192.168.132.0/17</pre><a name="txconf-49"></a><h6>Example&nbsp;19-6 Creating an Unlabeled Template at the Label <tt>PUBLIC</tt></h6><p>In this example, the security administrator allows a subnetwork of Solaris systems to
have the <tt>PUBLIC</tt> label in the trusted network. The template has the following
values:</p><pre>Template Name: public
Host Type: Unlabeled
Default Label: Public
Minimum Label: Public
Maximum Label: Public
DOI: 1

Wildcard Entry: 10.10.0.0
Prefix: 16</pre><p>All systems on the <tt>10.10.0.0</tt> subnetwork are handled at the label <tt>PUBLIC</tt>.</p><a name="txconf-51"></a><h6>Example&nbsp;19-7 Creating a Labeled Template for Developers</h6><p>In this example, the security administrator creates a <tt>SANDBOX</tt> template. This template is
assigned to systems that are used by developers of trusted software. The two
systems that are assigned this template create and test labeled programs. However, their
tests do not affect the other labeled systems, because the label <tt>SANDBOX</tt> is
disjoint from the other labels on the network.</p><pre>Template Name: cipso_sandbox
Host Type: CIPSO
Minimum Label: SANDBOX
Maximum Label: SANDBOX
DOI: 1

Hostname: DevMachine1
IP Address: 196.168.129.129

Hostname: DevMachine2
IP Address: 196.168.129.102</pre><p>The developers who use these systems can communicate with each other at the
label <tt>SANDBOX</tt>.</p>

<a name="txconf-9"></a><h4>How to Add Hosts to the System's Known Network</h4><a name="indexterm-1016"></a><a name="indexterm-1017"></a><a name="indexterm-1018"></a><a name="indexterm-1019"></a><p>The Computers tool in the Solaris Management Console is identical to the
Computers tool in the Solaris OS. This procedure is provided here for your
convenience. After the hosts are known, you then assign the hosts to a
security template.</p><h6>Before You Begin</h6><p>You must be in an administrator who can manage networks. For example, roles
that include the Network Management or System Administrator rights profiles can manage networks.</p><ol>
<li><b>In the Solaris Management Console, navigate to the Computers tool.</b><p>For details, see <a href="#managetnet-15">How to Open the Trusted Networking Tools</a>.</p></li>
<li><b>In the Computers tool, confirm that you want to view all computers on
the network.</b></li>
<li><b>Add a host that this system can contact.</b><p>You must add every host that this system might contact, including any static
routers and any audit servers.</p><ol style="list-style-type: lower-alpha">
<li><b>From the Action menu, choose Add Computer.</b></li>
<li><b>Identify the host by name and IP address.</b></li>
<li>(Optional) <b>Provide additional information about the host.</b></li>
<li><b>To add the host, click Apply.</b></li>
<li><b>When the entries are complete, click OK.</b></li></ol></li>
<li><b>Add a group of hosts that this system can contact.</b><p>Use the online help to add groups of hosts by using a network
IP address.</p></li></ol>

<a name="managetnet-16"></a><h4>How to Assign a Security Template to a Host or a Group of Hosts</h4><a name="indexterm-1020"></a><a name="indexterm-1021"></a><a name="indexterm-1022"></a><a name="indexterm-1023"></a><a name="indexterm-1024"></a><a name="indexterm-1025"></a><a name="indexterm-1026"></a><a name="indexterm-1027"></a><h6>Before You Begin</h6><p>You must be in the Security Administrator role in the global zone.</p><p>All hosts that you want to assign to a template must exist
in the Computers and Networks tool. For details, see <a href="#txconf-9">How to Add Hosts to the System's Known Network</a>.</p><ol>
<li><b>In the Solaris Management Console, navigate to the Security Templates tool.</b><p>For details, see <a href="#managetnet-15">How to Open the Trusted Networking Tools</a>.</p></li>
<li><b>Double-click the appropriate template name.</b></li>
<li><b>Click the Hosts Assigned to Template tab.</b></li>
<li><b>To assign the template to a single host, do the following:</b><ol style="list-style-type: lower-alpha">
<li><b>In the Hostname field, type the host's name.</b></li>
<li><b>In the IP Address field, type the host's address.</b></li>
<li><b>Click the Add button.</b></li>
<li><b>To save your changes, click OK.</b></li></ol></li>
<li><b>To assign a template to a group of hosts with contiguous addresses, do
the following:</b><ol style="list-style-type: lower-alpha">
<li><b>Click Wildcard.</b></li>
<li><b>In the IP Address field, type the IP address.</b></li>
<li><b>In the Prefix field, type the prefix that describes the group of contiguous
addresses.</b></li>
<li><b>Click the Add button.</b></li>
<li><b>To save your changes, click OK.</b></li></ol></li></ol><a name="managetnet-26"></a><h6>Example&nbsp;19-8 Adding an IPv4 Network as a Wildcard Entry</h6><p>In the following example, a security administrator assigns several IPv4 subnetworks to the
same security template. In the Hosts Assigned to Template tab, the administrator adds
the following wildcard entries:</p><pre>IP Address: 192.168.113.0
IP address: 192.168.75.0</pre><a name="managetnet-27"></a><h6>Example&nbsp;19-9 Adding a List of IPv4 Hosts as a Wildcard Entry</h6><p>In the following example, a security administrator assigns contiguous IPv4 addresses that are
not along octet boundaries to the same security template. In the Hosts Assigned
to Template tab, the administrator adds the following wildcard entries:</p><pre>IP Address: 192.168.113.100
Prefix Length: 25</pre><p>This wildcard entry covers the address range of <tt>192.168.113.0</tt> to <tt>192.168.113.127</tt>. The
address includes <tt>192.168.113.100</tt>.</p><a name="managetnet-28"></a><h6>Example&nbsp;19-10 Adding a List of IPv6 Hosts as a Wildcard Entry</h6><p>In the following example, a security administrator assigns contiguous IPv6 addresses to the
same security template. In the Hosts Assigned to Template tab, the administrator adds
the following wildcard entries:</p><pre>IP Address: 2001:a08:3903:200::0
Prefix Length: 56</pre><p>This wildcard entry covers the address range of <tt>2001:a08:3903:200::0</tt> to <tt>2001:a08:3903:2ff:ffff:ffff:ffff:ffff</tt>. The address
includes <tt>2001:a08:3903:201:20e:cff:fe08:58c</tt>.</p>

<a name="managetnet-8"></a><h4>How to Limit the Hosts That Can Be Contacted on the Trusted Network</h4><a name="indexterm-1028"></a><a name="indexterm-1029"></a><a name="indexterm-1030"></a><a name="indexterm-1031"></a><p>This procedure protects labeled hosts from being contacted by arbitrary unlabeled hosts. When
Trusted Extensions is installed, this default template defines every host on the network.
Use this procedure to enumerate specific unlabeled hosts.</p><p>The local <tt>tnrhdb</tt> file on each system is used to contact the network
at boot time. By default, every host that is not provided with a
CIPSO template is defined by the <tt>admin_low</tt> template. This template assigns every system
that is not otherwise defined (<tt>0.0.0.0</tt>) to be an unlabeled system with
the default label of <tt>admin_low</tt>.</p>
<hr><p><b>Caution - </b><a name="indexterm-1032"></a>The default <tt>admin_low</tt> template can be a security risk on a Trusted
Extensions network. If site security requires strong protection, the security administrator can remove the
<tt>0.0.0.0</tt> wildcard entry after the system is installed. The entry must be replaced
with entries for every host that the system contacts during boot.</p><p>For example, DNS servers, home directory servers, audit servers, broadcast and multicast addresses,
and routers must be in the local <tt>tnrhdb</tt> file after the <tt>0.0.0.0</tt> wildcard entry
is removed.</p><p><a name="indexterm-1033"></a>If an application initially recognizes clients at the host address <tt>0.0.0.0</tt>, then you
must add the <tt>0.0.0.0/32:admin_low</tt> host entry to the <tt>tnrhdb</tt> database. For example, to receive
initial connection requests from potential Sun Ray clients, Sun Ray servers must include
this entry. Then, when the server recognizes the clients, the clients are provided
an IP address and connected as CIPSO clients.</p>
<hr>
<h6>Before You Begin</h6><p>You must be in the Security Administrator role in the global zone.</p><p>All hosts that are to be contacted at boot time must exist
in the Computers and Networks tool.</p><ol>
<li><b>In the Solaris Management Console, navigate to the Security Templates tool in
the Files scope.</b><p>The Files scope protects the system during boot. To access the Security Templates
tool, see <a href="#managetnet-15">How to Open the Trusted Networking Tools</a>.</p></li>
<li><b>Modify the hosts that are assigned to the <tt>admin_low</tt> template.</b><ol style="list-style-type: lower-alpha">
<li><b>Double-click the <tt>admin_low</tt> template.</b><p>Every host that is added can be contacted during boot at the label
<tt>ADMIN_LOW</tt>.</p></li>
<li><b>Click the Hosts Assigned to Template tab.</b><p>Every host that is added can be contacted during boot at the label
<tt>ADMIN_LOW</tt>.</p></li>
<li><b>Add each unlabeled host that must be contacted at boot time.</b><p>For details, see <a href="#managetnet-16">How to Assign a Security Template to a Host or a Group of Hosts</a>.</p><p>Include every on-link router that is not running Trusted Extensions, through which this
host must communicate.</p></li>
<li><b>Add the ranges of hosts that must be contacted at boot time.</b></li>
<li><b>Remove the <tt>0.0.0.0</tt> entry.</b></li></ol></li>
<li><b>Modify the hosts that are assigned to the <tt>cipso</tt> template.</b><ol style="list-style-type: lower-alpha">
<li><b>Double-click the <tt>cipso</tt> template.</b><p>Every host that is added can be contacted during boot.</p></li>
<li><b>Click the Hosts Assigned to Template tab.</b><p>Every host that is added can be contacted during boot at the label
<tt>ADMIN_LOW</tt>.</p></li>
<li><b>Add each labeled host that must be contacted at boot time.</b><p>For details, see <a href="#managetnet-16">How to Assign a Security Template to a Host or a Group of Hosts</a>.</p>
<ul><li><p>Include the LDAP server.</p></li>
<li><p>Include every on-link router that is running Trusted Extensions, through which this host must communicate</p></li>
<li><p>Make sure that all network interfaces are assigned to the template.</p></li>
<li><p>Include broadcast addresses.</p></li></ul>
</li>
<li><b>Add the ranges of hosts that must be contacted at boot time.</b></li></ol></li>
<li><b>Verify that the host assignments allow the system to boot.</b></li></ol><a name="managetnet-43"></a><h6>Example&nbsp;19-11 Changing the Label of the <tt>0.0.0.0</tt> <tt>tnrhdb</tt> Entry</h6><p>In this example, the security administrator creates a public gateway system. The administrator
removes the <tt>0.0.0.0</tt> entry from the <tt>admin_low</tt> template and assigns the entry to
an unlabeled template that is named <tt>public</tt>. The system then recognizes any system that
is not listed in its <tt>tnrhdb</tt> file as an unlabeled system with the
security attributes of the <tt>public</tt> security template.</p><p>The following describes an unlabeled template that was created specifically for public gateways.</p><pre>Template Name: public
Host Type: Unlabeled
Default Label: Public
Minimum Label: Public
Maximum Label: Public
DOI: 1</pre><a name="managetnet-45"></a><h6>Example&nbsp;19-12 Enumerating Computers to Contact During Boot in the <tt>tnrhdb</tt> Database</h6><p>The following example shows the local <tt>tnrhdb</tt> database with entries for an LDAP
client with two network interfaces. The client communicates with another network and with
routers.</p><pre>127.0.0.1:cipso       Loopback address
192.168.112.111:cipso Interface 1 of this host
192.168.113.111:cipso Interface 2 of this host
10.6.6.2:cipso        LDAP server
192.168.113.6:cipso   Audit server
192.168.112.255:cipso Subnet broadcast address
192.168.113.255:cipso Subnet broadcast address
192.168.113.1:cipso   Router
192.168.117.0:cipso   Another Trusted Extensions network
192.168.112.12:public Specific network router
192.168.113.12:public Specific network router
224.0.0.2:public      Multicast address
255.255.255.255:admin_low Broadcast address</pre><a name="managetnet-35"></a><h6>Example&nbsp;19-13 Making the Host Address <tt>0.0.0.0</tt> a Valid <tt>tnrhdb</tt> Entry</h6><p><a name="indexterm-1034"></a><a name="indexterm-1035"></a>In this example, the security administrator configures a Sun Ray server to accept
initial connection requests from potential clients. The server is using a private topology
and is using the defaults:</p><pre># <tt><b>utadm -a bge0</b></tt></pre><p>First, the administrator determines the Solaris Management Console domain name:</p><pre>SMCserver # <tt><b>/usr/sadm/bin/dtsetup scopes</b></tt>
Getting list of managable scopes...
Scope 1 file:/machine1.ExampleCo.COM/machine1.ExampleCo.COM</pre><p>Then, the administrator adds the entry for client initial connection to the Sun
Ray server's <tt>tnrhdb</tt> database. Because the administrator is testing, the default wildcard address
is still used for all unknown addresses:</p><pre>SunRayServer # <tt><b>/usr/sadm/bin/smtnrhdb \</b></tt>
<tt><b>add -D file:/machine1.ExampleCo.COM/machine1.ExampleCo.COM \</b></tt>
<tt><b>-- -w 0.0.0.0 -p 32 -n admin_low</b></tt>
Authenticating as user: root

Please enter a string value for: password :: 
... from machine1.ExampleCo.COM was successful.</pre><p>After this command, the <tt>tnhrdb</tt> database appears similar to the following. The result
of the <tt>smtnrhdb</tt> command is highlighted:</p><pre>## tnrhdb database
## Sun Ray server address
       192.168.128.1:cipso
## Sun Ray client addresses on 192.168.128 network
       192.168.128.0/24:admin_low
## Initial address for new clients
       <tt><b>0.0.0.0/32:admin_low</b></tt>
## Default wildcard address
0.0.0.0:admin_low
Other addresses to be contacted at boot</pre><pre># <tt><b>tnchkdb -h /etc/security/tsol/tnrhdb</b></tt></pre><p>After this phase of testing succeeds, the administrator makes the configuration more secure
by removing the default wildcard address, checks the syntax of the <tt>tnrhdb</tt> database,
and tests again. The final <tt>tnhrdb</tt> database appears similar to the following:</p><pre>## tnrhdb database
## Sun Ray server address
       192.168.128.1:cipso
## Sun Ray client addresses on 192.168.128 network
       192.168.128.0/24:admin_low
## Initial address for new clients
       0.0.0.0/32:admin_low
## 0.0.0.0:admin_low - no other systems can enter network at admin_low
Other addresses to be contacted at boot</pre>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="managetnet-6.html">Previous</a>
             </td>
             <td align="right">
                 <a href="managetnet-14.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

