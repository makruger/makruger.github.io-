<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>The Trusted Network - Solaris Trusted Extensions Administrator's Procedures</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2009-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">Solaris Trusted Extensions Administrator's Procedures</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="txnet-1.html">Previous</a>
             </td>
             <td align="right">
                 <a href="tnetov-40.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-4.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="trp-part-1.html">Part&nbsp;I&nbsp;Initial Configuration of Trusted Extensions</a></p>
<p class="toc level2"><a href="ovw-1.html">1.&nbsp;&nbsp;Security Planning for Trusted Extensions</a></p>
<p class="toc level2"><a href="tmap-1.html">2.&nbsp;&nbsp;Configuration Roadmap for Trusted Extensions</a></p>
<p class="toc level2"><a href="startinst-1.html">3.&nbsp;&nbsp;Adding Solaris Trusted Extensions Software to the Solaris OS (Tasks)</a></p>
<p class="toc level2"><a href="txconf-1.html">4.&nbsp;&nbsp;Configuring Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="txldap-1.html">5.&nbsp;&nbsp;Configuring LDAP for Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="headl-1.html">6.&nbsp;&nbsp;Configuring a Headless System With Trusted Extensions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="trp-part-2.html">Part&nbsp;II&nbsp;Administration of Trusted Extensions</a></p>
<p class="toc level2"><a href="txintro-1.html">7.&nbsp;&nbsp;Trusted Extensions Administration Concepts</a></p>
<p class="toc level2"><a href="txtool-1.html">8.&nbsp;&nbsp;Trusted Extensions Administration Tools</a></p>
<p class="toc level2"><a href="roles-1.html">9.&nbsp;&nbsp;Getting Started as a Trusted Extensions Administrator (Tasks)</a></p>
<p class="toc level2"><a href="secreq-1.html">10.&nbsp;&nbsp;Security Requirements on a Trusted Extensions System (Overview)</a></p>
<p class="toc level2"><a href="commontasks-1.html">11.&nbsp;&nbsp;Administering Security Requirements in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="useraccts-1.html">12.&nbsp;&nbsp;Users, Rights, and Roles in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="manageusers-1.html">13.&nbsp;&nbsp;Managing Users, Rights, and Roles in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="remotead-1.html">14.&nbsp;&nbsp;Remote Administration in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="manageldap-1.html">15.&nbsp;&nbsp;Trusted Extensions and LDAP (Overview)</a></p>
<p class="toc level2"><a href="managezones-1.html">16.&nbsp;&nbsp;Managing Zones in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="managefiles-1.html">17.&nbsp;&nbsp;Managing and Mounting Files in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="txnet-1.html">18.&nbsp;&nbsp;Trusted Networking (Overview)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">The Trusted Network</a></p>
</div>
<p class="toc level3"><a href="tnetov-40.html">Network Security Attributes in Trusted Extensions</a></p>
<p class="toc level3"><a href="tnetov-2.html">Trusted Network Fallback Mechanism</a></p>
<p class="toc level3"><a href="txnet-3.html">Overview of Routing in Trusted Extensions</a></p>
<p class="toc level3"><a href="txnet-26.html">Administration of Routing in Trusted Extensions</a></p>
<p class="toc level2 tocsp"><a href="managetnet-1.html">19.&nbsp;&nbsp;Managing Networks in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="managemail-1.html">20.&nbsp;&nbsp;Multilevel Mail in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="manageprint-1.html">21.&nbsp;&nbsp;Managing Labeled Printing (Tasks)</a></p>
<p class="toc level2"><a href="gentextid-15538.html">22.&nbsp;&nbsp;Devices in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="managedev-1.html">23.&nbsp;&nbsp;Managing Devices for Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="audtask-1.html">24.&nbsp;&nbsp;Trusted Extensions Auditing (Overview)</a></p>
<p class="toc level2"><a href="softmgt-1.html">25.&nbsp;&nbsp;Software Management in Trusted Extensions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="appol-1.html">A.&nbsp;&nbsp;Site Security Policy</a></p>
<p class="toc level2"><a href="appol-12.html">Creating and Managing a Security Policy</a></p>
<p class="toc level2"><a href="appol-11.html">Site Security Policy and Trusted Extensions</a></p>
<p class="toc level2"><a href="appol-2.html">Computer Security Recommendations</a></p>
<p class="toc level2"><a href="appol-3.html">Physical Security Recommendations</a></p>
<p class="toc level2"><a href="appol-4.html">Personnel Security Recommendations</a></p>
<p class="toc level2"><a href="appol-5.html">Common Security Violations</a></p>
<p class="toc level2"><a href="appol-6.html">Additional Security References</a></p>
<p class="toc level1 tocsp"><a href="aptxconf-1.html">B.&nbsp;&nbsp;Using CDE Actions to Install Zones in Trusted Extensions</a></p>
<p class="toc level2"><a href="aptxconf-62.html">Associating Network Interfaces With Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level2"><a href="aptxconf-40.html">Preparing to Create Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level2"><a href="aptxconf-20.html">Creating Labeled Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level1 tocsp"><a href="checklist-1.html">C.&nbsp;&nbsp;Configuration Checklist for Trusted Extensions</a></p>
<p class="toc level2"><a href="checklist-2.html">Checklist for Configuring Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="txapp-1.html">D.&nbsp;&nbsp;Quick Reference to Trusted Extensions Administration</a></p>
<p class="toc level2"><a href="txapp-2.html">Administrative Interfaces in Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-3.html">Solaris Interfaces Extended by Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-4.html">Tighter Security Defaults in Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-5.html">Limited Options in Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="txmp-1.html">E.&nbsp;&nbsp;List of Trusted Extensions Man Pages</a></p>
<p class="toc level2"><a href="txmp-2.html">Trusted Extensions Man Pages in Alphabetical Order</a></p>
<p class="toc level2"><a href="txmp-3.html">Solaris Man Pages That Are Modified by Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="txnet-2"></a><h3>The Trusted Network</h3>
<a name="indexterm-941"></a><a name="indexterm-942"></a><p>Trusted Extensions assigns security attributes to zones, hosts, and networks. These attributes ensure
that the following security features are enforced on the network:</p>
<ul><li><p>Data is properly labeled in network communications.</p></li>
<li><p>Mandatory access control (MAC) rules are enforced when data is sent or received across a local network and when file systems are mounted.</p></li>
<li><p>MAC rules are enforced when data is routed to distant networks.</p></li>
<li><p>MAC rules are enforced when data is routed to zones.</p></li></ul>
<p>In Trusted Extensions, network packets are protected by MAC. Labels are used for
MAC decisions. Data is labeled explicitly or implicitly with a sensitivity label. A
label has an ID field, a classification or &ldquo;level&rdquo; field, and a compartment
or &ldquo;category&rdquo; field. Data must pass an accreditation check. This check  determines
if the label is well formed, and if the label lies within the
accreditation range of the receiving host. Well-formed packets that are within the receiving
host's accreditation range are granted access.</p><p>IP packets that are exchanged between trusted systems can be labeled. Trusted
Extensions supports Commercial IP Security Option (CIPSO) labels. A CIPSO label on a
packet serves to classify, segregate, and route IP packets. Routing decisions compare the sensitivity
label of the data with the label of the destination.</p><p>Typically on a trusted network, the label is generated by a sending host
and processed by the receiving host. However, a trusted router can also add
or strip labels while forwarding packets in a trusted network. A sensitivity label
is mapped to a CIPSO label before transmission. The CIPSO label is
embedded in the IP packet. Typically, a packet sender and the packet's receiver
operate at the same label.</p><p>Trusted networking software ensures that the Trusted Extensions security policy is enforced even
when the subjects (processes) and objects (data) are located on different hosts. Trusted
Extensions networking preserves MAC across distributed applications.</p>

<a name="txnet-5"></a><h4>Trusted Extensions Data Packets</h4>
<p><a name="indexterm-943"></a><a name="indexterm-944"></a>Trusted Extensions data packets include a CIPSO label option. The data packets can
be sent over IPv4 or IPv6 networks.</p><p>In the standard IPv4 format, the IPv4 header with options is followed by
a TCP, UDP, or SCTP header and then the actual data. The
Trusted Extensions version of an IPv4 packet uses the CIPSO option in the
IP header for the security attributes.</p><table><col width="50%"><col width="31%"><col width="18%"><tr><td align="left" valign="top" scope="row"><p>IPv4 Header With CIPSO Option</p></td>
<td align="left" valign="top" scope="row"><p>TCP, UDP, or SCTP</p></td>
<td align="left" valign="top" scope="row"><p>Data</p></td>
</tr>
</table><p>In the standard IPv6 format, an IPv6 header with extensions is followed by
a TCP, UDP, or SCTP header and then the actual data. The
Trusted Extensions IPv6 packet includes a multilevel security option in the header extensions.</p><table><col width="50%"><col width="31%"><col width="18%"><tr><td align="left" valign="top" scope="row"><p>IPv6
Header With Extensions</p></td>
<td align="left" valign="top" scope="row"><p>TCP, UDP, or SCTP</p></td>
<td align="left" valign="top" scope="row"><p>Data</p></td>
</tr>
</table>

<a name="tnetov-42"></a><h4>Trusted Network Communications</h4>
<a name="indexterm-945"></a><a name="indexterm-946"></a><p>Trusted Extensions supports labeled and unlabeled hosts on a trusted network. LDAP is
a fully supported naming service. Various commands and GUIs enable the network to
be administered.</p><p>Systems that run Trusted Extensions software support network communications between Trusted Extensions hosts
and any of the following types of systems:</p>
<ul><li><p>Other systems that are running Trusted Extensions</p></li>
<li><p>Systems that are running operating systems that do not recognize security attributes, but do support TCP/IP, such as Solaris systems, other UNIX<sup>&reg;</sup> systems, Microsoft Windows, and Macintosh OS systems</p></li>
<li><p>Systems that are running other trusted operating systems that recognize CIPSO labels</p></li></ul>
<p>As in the Solaris OS, Trusted Extensions network communications and services can be
managed by a naming service. Trusted Extensions adds the following interfaces to Solaris
network interfaces:</p>
<ul><li><p>Trusted Extensions adds three network configuration databases, <tt>tnzonecfg</tt>, <tt>tnrhdb</tt>, and <tt>tnrhtp</tt>. For details, see <a href="#txnet-53">Network Configuration Databases in Trusted Extensions</a>.</p></li>
<li><p>The Trusted Extensions version of the naming service switch file, <tt>nsswitch.conf</tt>, includes entries for the <tt>tnrhtp</tt> and <tt>tnrhdb</tt> databases. These entries can be modified to suit each site's configuration.</p><p>Trusted Extensions uses the LDAP naming service to centrally manage configuration files that define hosts, networks, and users. The default <tt>nsswitch.conf</tt> entries for the trusted network databases for the LDAP naming service follow:</p><pre># Trusted Extensions
tnrhtp: files ldap
tnrhdb: files ldap</pre><p>The LDAP naming service on a Sun Java System Directory Server is the only fully supported naming service in Trusted Extensions. For information about the use of LDAP on a system that is configured with Trusted Extensions, see <a href="manageldap-1.html">Chapter&nbsp;15, Trusted Extensions and LDAP (Overview)</a>.</p></li>
<li><p>Trusted Extensions adds tools to the Solaris Management Console. The console is used to centrally manage zones, hosts, and networks. The network tools are described in <a href="txtool-8.html">Solaris Management Console Tools</a>.</p><p>The <a href="trp-part-1.html">Part&nbsp;I, Initial Configuration of Trusted Extensions</a> describes how to define zones and hosts when you configure the network. For additional details, see <a href="managetnet-1.html">Chapter&nbsp;19, Managing Networks in Trusted Extensions (Tasks)</a>.</p></li>
<li><p>Trusted Extensions adds commands to administer trusted networking. Trusted Extensions also adds options to the Solaris network commands. For a description of these commands, see <a href="#txnet-36">Network Commands in Trusted Extensions</a>.</p></li></ul>


<a name="txnet-53"></a><h4>Network Configuration Databases in Trusted Extensions</h4>
<a name="indexterm-947"></a><a name="indexterm-948"></a><p>Trusted Extensions loads three network configuration databases into the kernel. These databases are
used in accreditation checks as data is transmitted from one host to another
host.</p>
<ul><li><p><tt>tnzonecfg</tt> &ndash; This local database stores zone attributes that are security-related. The attributes for each zone specify the zone label and the zone's access to single-level and multilevel ports. Another attribute handles responses to control messages, such as <tt>ping</tt>. The labels for zones are defined in the <tt>label_encodings</tt> file. For more information, see the <a href="http://docs.sun.com/doc/819-2251/label-encodings-4?a=view"><tt>label_encodings</tt>(4)</a> and <a href="http://docs.sun.com/doc/819-2240/smtnzonecfg-1m?a=view"><tt>smtnzonecfg</tt>(1M)</a> man pages. For a discussion of multilevel ports, see <a href="managezones-16.html#managezones-31">Zones and Multilevel Ports</a>.</p></li>
<li><p><tt>tnrhtp</tt> &ndash; This database stores templates that describe the security attributes of hosts and gateways. <tt>tnrhtp</tt> can be a local database or stored on the LDAP server. Hosts and gateways use the attributes of the destination host and next-hop gateway to enforce MAC when sending traffic. When receiving traffic, hosts and gateways use the attributes of the sender. For details of the security attributes, see <a href="#txnet-29">Trusted Network Security Attributes</a>. For more information, see the <a href="http://docs.sun.com/doc/819-2240/smtnrhtp-1m?a=view"><tt>smtnrhtp</tt>(1M)</a> man page.</p></li>
<li><p><tt>tnrhdb</tt> &ndash; This database holds the IP addresses and network prefixes (fallback mechanism) that correspond to all hosts that are allowed to communicate. <tt>tnrhdb</tt> can be a local database or stored on the LDAP server. Each host or network prefix is assigned a security template from the <tt>tnrhtp</tt> database. The attributes in the template define the attributes of the assigned host. For more information, see the <a href="http://docs.sun.com/doc/819-2240/smtnrhdb-1m?a=view"><tt>smtnrhdb</tt>(1M)</a> man page.</p></li></ul>
<p>In Trusted Extensions, the Solaris Management Console has been extended to handle
these databases. For details, see <a href="txtool-8.html">Solaris Management Console Tools</a>.</p>

<a name="txnet-36"></a><h4>Network Commands in Trusted Extensions</h4>
<p>Trusted Extensions adds the following commands to administer trusted networking:</p>
<ul><li><p><a name="indexterm-949"></a><tt>tnchkdb</tt> &ndash; This command is used to verify the correctness of the trusted network databases. The <tt>tnchkdb</tt> command is used whenever you change a security template (<tt>tnrhtp</tt>), a security template assignment (<tt>tnrhdb</tt>), or the configuration of a zone (<tt>tnzonecfg</tt>). The Solaris Management Console tools run this command automatically when a database is modified. For details, see the <a href="http://docs.sun.com/doc/819-2240/tnchkdb-1m?a=view"><tt>tnchkdb</tt>(1M)</a> man page.</p></li>
<li><p><a name="indexterm-950"></a><tt>tnctl</tt> &ndash; This command can be used to update the trusted network information in the kernel. <tt>tnctl</tt> is also a system service. A restart with the command <tt>svcadm restart /network/tnctl</tt> refreshes the kernel cache from the trusted network databases on the local system. The Solaris Management Console tools run this command automatically when a database is modified in the Files scope. For details, see the <a href="http://docs.sun.com/doc/819-2240/tnctl-1m?a=view"><tt>tnctl</tt>(1M)</a> man page.</p></li>
<li><p><a name="indexterm-951"></a><tt>tnd</tt> &ndash; This daemon pulls <tt>tnrhdb</tt> and <tt>tnrhtp</tt> information from the LDAP directory. <tt>tnd</tt> is started at boot time as a service, as in <tt>svcadm start /network/tnd</tt>. This command also can be used for debugging and for changing the polling interval. For details, see the <a href="http://docs.sun.com/doc/819-2240/tnd-1m?a=view"><tt>tnd</tt>(1M)</a> man page.</p></li>
<li><p><a name="indexterm-952"></a><tt>tninfo</tt> &ndash; This command displays the details of the current state of the trusted network kernel cache. The output can be filtered by host name, zone, or security template. For details, see the <a href="http://docs.sun.com/doc/819-2240/tninfo-1m?a=view"><tt>tninfo</tt>(1M)</a> man page.</p></li></ul>
<p>Trusted Extensions adds options to the following Solaris network commands:</p>
<ul><li><p><a name="indexterm-953"></a><tt>ifconfig</tt> &ndash; The <tt>all-zones</tt> interface flag for this command makes the specified interface available to every zone on the system. The appropriate zone to deliver data to is determined by the label that is associated with the data. For details, see the <a href="http://docs.sun.com/doc/819-2240/ifconfig-1m?a=view"><tt>ifconfig</tt>(1M)</a> man page.</p></li>
<li><p><a name="indexterm-954"></a><tt>netstat</tt> &ndash; The <tt>-R</tt> option extends Solaris <tt>netstat</tt> usage to display Trusted Extensions-specific information, such as security attributes for multilevel sockets and routing table entries. The extended security attributes include the label of the peer, and whether the socket is specific to a zone, or available to several zones. For details, see the <a href="http://docs.sun.com/doc/819-2240/netstat-1m?a=view"><tt>netstat</tt>(1M)</a> man page.</p></li>
<li><p><a name="indexterm-955"></a><tt>route</tt> &ndash; The <tt>-secattr</tt> option extends Solaris <tt>route</tt> usage to display the security attributes of the route. The value of the option has the following format:</p><pre>min_sl=<i>label</i>,max_sl=<i>label</i>,doi=<i>integer</i>,cipso</pre><p>The <tt>cipso</tt> keyword is optional and set by default. For details, see the <a href="http://docs.sun.com/doc/819-2240/route-1m?a=view"><tt>route</tt>(1M)</a> man page.</p></li>
<li><p><a name="indexterm-956"></a><tt>snoop</tt> &ndash; As in the Solaris OS, the <tt>-v</tt> option to this command can be used to display the IP headers in detail. In Trusted Extensions, the headers contain label information.</p></li></ul>


<a name="txnet-29"></a><h4>Trusted Network Security Attributes</h4>
<p>Network administration in Trusted Extensions is based on security templates. A security template
describes a set of hosts that have common protocols and identical security attributes.</p><p>Security attributes are administratively assigned to systems, both hosts and routers, by means
of templates. The security administrator administers templates and assigns them to systems. If
a system does not have an assigned template, no communications are allowed with
that system.</p><p>Every template is named, and includes the following:</p>
<ul><li><p>A host type of either Unlabeled or CIPSO. The protocol that is used for network communications is determined by the host type of the template.</p><p>The host type is used to determine whether to use CIPSO options and affects MAC. See <a href="tnetov-40.html#txnet-34">Host Type and Template Name in Security Templates</a>.</p></li>
<li><p>A set of security attributes that are applied to each host type.</p></li></ul>
<p>For more detail about host types and security attributes, see <a href="tnetov-40.html">Network Security Attributes in Trusted Extensions</a>.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="txnet-1.html">Previous</a>
             </td>
             <td align="right">
                 <a href="tnetov-40.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

