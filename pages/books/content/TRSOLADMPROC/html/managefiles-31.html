<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Access to NFS Mounted Directories in Trusted Extensions - Solaris Trusted Extensions Administrator's Procedures</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2009-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">Solaris Trusted Extensions Administrator's Procedures</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="managefiles-18.html">Previous</a>
             </td>
             <td align="right">
                 <a href="managefiles-26.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-4.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="trp-part-1.html">Part&nbsp;I&nbsp;Initial Configuration of Trusted Extensions</a></p>
<p class="toc level2"><a href="ovw-1.html">1.&nbsp;&nbsp;Security Planning for Trusted Extensions</a></p>
<p class="toc level2"><a href="tmap-1.html">2.&nbsp;&nbsp;Configuration Roadmap for Trusted Extensions</a></p>
<p class="toc level2"><a href="startinst-1.html">3.&nbsp;&nbsp;Adding Solaris Trusted Extensions Software to the Solaris OS (Tasks)</a></p>
<p class="toc level2"><a href="txconf-1.html">4.&nbsp;&nbsp;Configuring Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="txldap-1.html">5.&nbsp;&nbsp;Configuring LDAP for Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="headl-1.html">6.&nbsp;&nbsp;Configuring a Headless System With Trusted Extensions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="trp-part-2.html">Part&nbsp;II&nbsp;Administration of Trusted Extensions</a></p>
<p class="toc level2"><a href="txintro-1.html">7.&nbsp;&nbsp;Trusted Extensions Administration Concepts</a></p>
<p class="toc level2"><a href="txtool-1.html">8.&nbsp;&nbsp;Trusted Extensions Administration Tools</a></p>
<p class="toc level2"><a href="roles-1.html">9.&nbsp;&nbsp;Getting Started as a Trusted Extensions Administrator (Tasks)</a></p>
<p class="toc level2"><a href="secreq-1.html">10.&nbsp;&nbsp;Security Requirements on a Trusted Extensions System (Overview)</a></p>
<p class="toc level2"><a href="commontasks-1.html">11.&nbsp;&nbsp;Administering Security Requirements in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="useraccts-1.html">12.&nbsp;&nbsp;Users, Rights, and Roles in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="manageusers-1.html">13.&nbsp;&nbsp;Managing Users, Rights, and Roles in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="remotead-1.html">14.&nbsp;&nbsp;Remote Administration in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="manageldap-1.html">15.&nbsp;&nbsp;Trusted Extensions and LDAP (Overview)</a></p>
<p class="toc level2"><a href="managezones-1.html">16.&nbsp;&nbsp;Managing Zones in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="managefiles-1.html">17.&nbsp;&nbsp;Managing and Mounting Files in Trusted Extensions (Tasks)</a></p>
<p class="toc level3"><a href="managefiles-16.html">Sharing and Mounting Files in Trusted Extensions</a></p>
<p class="toc level3"><a href="txnet-10.html">NFS Mounts in Trusted Extensions</a></p>
<p class="toc level3"><a href="managefiles-18.html">Sharing Files From a Labeled Zone</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Access to NFS Mounted Directories in Trusted Extensions</a></p>
</div>
<p class="toc level3"><a href="managefiles-26.html">Trusted Extensions Software and NFS Protocol Versions</a></p>
<p class="toc level3"><a href="managefiles-6.html">Backing Up, Sharing, and Mounting Labeled Files (Task Map)</a></p>
<p class="toc level2 tocsp"><a href="txnet-1.html">18.&nbsp;&nbsp;Trusted Networking (Overview)</a></p>
<p class="toc level2"><a href="managetnet-1.html">19.&nbsp;&nbsp;Managing Networks in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="managemail-1.html">20.&nbsp;&nbsp;Multilevel Mail in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="manageprint-1.html">21.&nbsp;&nbsp;Managing Labeled Printing (Tasks)</a></p>
<p class="toc level2"><a href="gentextid-15538.html">22.&nbsp;&nbsp;Devices in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="managedev-1.html">23.&nbsp;&nbsp;Managing Devices for Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="audtask-1.html">24.&nbsp;&nbsp;Trusted Extensions Auditing (Overview)</a></p>
<p class="toc level2"><a href="softmgt-1.html">25.&nbsp;&nbsp;Software Management in Trusted Extensions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="appol-1.html">A.&nbsp;&nbsp;Site Security Policy</a></p>
<p class="toc level2"><a href="appol-12.html">Creating and Managing a Security Policy</a></p>
<p class="toc level2"><a href="appol-11.html">Site Security Policy and Trusted Extensions</a></p>
<p class="toc level2"><a href="appol-2.html">Computer Security Recommendations</a></p>
<p class="toc level2"><a href="appol-3.html">Physical Security Recommendations</a></p>
<p class="toc level2"><a href="appol-4.html">Personnel Security Recommendations</a></p>
<p class="toc level2"><a href="appol-5.html">Common Security Violations</a></p>
<p class="toc level2"><a href="appol-6.html">Additional Security References</a></p>
<p class="toc level1 tocsp"><a href="aptxconf-1.html">B.&nbsp;&nbsp;Using CDE Actions to Install Zones in Trusted Extensions</a></p>
<p class="toc level2"><a href="aptxconf-62.html">Associating Network Interfaces With Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level2"><a href="aptxconf-40.html">Preparing to Create Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level2"><a href="aptxconf-20.html">Creating Labeled Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level1 tocsp"><a href="checklist-1.html">C.&nbsp;&nbsp;Configuration Checklist for Trusted Extensions</a></p>
<p class="toc level2"><a href="checklist-2.html">Checklist for Configuring Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="txapp-1.html">D.&nbsp;&nbsp;Quick Reference to Trusted Extensions Administration</a></p>
<p class="toc level2"><a href="txapp-2.html">Administrative Interfaces in Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-3.html">Solaris Interfaces Extended by Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-4.html">Tighter Security Defaults in Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-5.html">Limited Options in Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="txmp-1.html">E.&nbsp;&nbsp;List of Trusted Extensions Man Pages</a></p>
<p class="toc level2"><a href="txmp-2.html">Trusted Extensions Man Pages in Alphabetical Order</a></p>
<p class="toc level2"><a href="txmp-3.html">Solaris Man Pages That Are Modified by Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="managefiles-31"></a><h3>Access to NFS Mounted Directories in Trusted Extensions</h3>
<a name="indexterm-913"></a><p>By default, NFS-mounted file systems are visible at the label of the exported
file system. If the file system is exported with read/write permissions, users at
that label can write to the files. NFS mounts that are at
a lower label than the user's current session are visible to the user,
but cannot be written to. Even if a file system is shared with
read/write permissions, the mounting system can write to it only at the label
of the mount.</p><p>To make lower-level directories that are NFS-mounted visible to users in a higher-level
zone, the administrator of the global zone on the NFS server must export
the parent directory. The parent directory is exported at its label. On the
client side, each zone must have the <tt>net_mac_aware</tt> privilege. By default, labeled zones
include the <tt>net_mac_aware</tt> privilege in their <tt>limitpriv</tt> set.</p>
<ul><li><p><b>Server configuration &ndash;</b> On the NFS server, you export the parent directory in a <tt>dfstab</tt> file. If the parent directory is in a labeled zone, the <tt>dfstab</tt> file must be modified in the labeled zone of the parent directory. The <tt>dfstab</tt> file for a labeled zone is visible only from the global zone. For the procedure, see <a href="managefiles-6.html#txconf-43">How to Share Directories From a Labeled Zone</a>.</p></li>
<li><p><b>Client configuration &ndash;</b> The <tt>net_mac_aware</tt> privilege must be specified in the zone configuration file that is used during initial zone configuration. So, a user who is permitted to view all lower-level home directories must have the <tt>net_mac_aware</tt> privilege in every zone, except the lowest zone. For an example, see <a href="managefiles-6.html#txconf-41">How to NFS Mount Files in a Labeled Zone</a>.</p></li></ul>
<a name="managefiles-22"></a><h6>Example&nbsp;17-1 Providing Access to Lower-Level Home Directories</h6><a name="indexterm-914"></a><a name="indexterm-915"></a><a name="indexterm-916"></a><p>On the home directory server, the administrator creates and modifies the <tt>/zone/</tt><i>labeled-zone</i><tt>/etc/dfs/dfstab</tt> file in
every labeled zone. The <tt>dfstab</tt> file exports the <tt>/export/home</tt> directory with read/write
permissions. Thus, when the directory is mounted at the same label, the home
directory is writable. To export the <tt>/export/home</tt> directory of <tt>PUBLIC</tt>, the administrator creates a
workspace at the <tt>PUBLIC</tt> label on the home directory server, and from
the global zone, modifies the <tt>/zone/public/etc/dfs/dfstab</tt> file.</p><p>On the client, the administrator of the global zone checks that every labeled
zone, except the lowest label, has the <tt>net_mac_aware</tt> privilege. This privilege permits the
mount. This privilege can be specified by using the <tt>zonecfg</tt> command during zone
configuration. The lower-level home directory can only be viewed. MAC protects the files
in the directory from modification.</p>

<a name="txnet-12"></a><h4>Home Directory Creation in Trusted Extensions</h4>
<a name="indexterm-917"></a><a name="indexterm-918"></a><p>Home directories are a special case in Trusted Extensions. You need to
make sure that the home directories are created in every zone that a
user can use. Also, the home directory mount points must be created in
the zones on the user's system. For NFS-mounted home directories to work correctly,
the conventional location for directories, <tt>/export/home</tt>, must be used. In Trusted Extensions, the automounter
has been modified to handle home directories in every zone, that is, at
every label. For details, see <a href="#managefiles-19">Changes to the Automounter in Trusted Extensions</a>.</p><p>Home directories are created when users are created. In Trusted Extensions, the Solaris
Management Console (Console) is used to create users, so the Console creates
the home directories. However, the Console creates the home directories in the global zone
of the home directory server. On that server, the directories are mounted by
LOFS. Home directories are automatically created by the automounter if they are specified
as LOFS mounts.</p><p>However, the automounter cannot automatically create home directories on remote NFS servers. Either
the user must first log in to the NFS server or administrative intervention
is required. To create home directories for users, see <a href="txconf-50.html#txconf-56">Enable Users to Access Their Home Directories in Trusted Extensions</a>.</p>

<a name="managefiles-19"></a><h4>Changes to the Automounter in Trusted Extensions</h4>
<p>In Trusted Extensions, each label requires a separate home directory mount. The <tt>automount</tt>
command has been modified to handle these labeled automounts. For each zone, the
automounter, <tt>autofs</tt>, mounts an <tt>auto_home_</tt><i>zone-name</i> file. For example, the following is the entry for
the global zone in the <tt>auto_home_global</tt> file:</p><pre>+auto_home_global
*       -fstype=lofs    :/export/home/&amp;</pre><p>When a zone that permits lower-level zones to be mounted is booted, the
following occurs. The home directories of lower-level zones are mounted read only under
<tt>/zone/&lt;</tt><i>zone-name</i><tt>&gt;/export/home</tt>. The <tt>auto_home_&lt;</tt><i>zone-name</i><tt>&gt;</tt> map specifies the <tt>/zone</tt> path as the source directory for
an <tt>lofs</tt> remount onto <tt>/zone/&lt;</tt><i>zone-name</i><tt>&gt;/home/&lt;</tt><i>username</i><tt>&gt;</tt>.</p><p>For example, the following is an <tt>auto_home_public</tt> entry in an <tt>auto_home_</tt><i>zone-at-higher-label</i> map that is
generated from a higher-level zone:</p><pre>+auto_home_public
*       -fstype=lofs    :/zone/public/export/home/&amp;</pre><p>The following is the corresponding entry in the public zone:</p><pre>auto_home_public
*       -fstype=lofs    :/export/home/&amp;</pre><p>When a home directory is referenced and the name does not match
any entries in the <tt>auto_home_&lt;</tt><i>zone-name</i><tt>&gt;</tt> map, the map tries to match this loopback
mount specification. The software creates the home directory when the following two conditions are
met:</p>
<ol><li><p>The map finds the match of the loopback mount specification</p></li>
<li><p>The home directory name matches a valid user whose home directory does not yet exist in <i>zone-name</i></p></li></ol>
<p>For details on changes to the automounter, see the <a href="http://docs.sun.com/doc/819-2240/automount-1m?a=view"><tt>automount</tt>(1M)</a> man page.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="managefiles-18.html">Previous</a>
             </td>
             <td align="right">
                 <a href="managefiles-26.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

