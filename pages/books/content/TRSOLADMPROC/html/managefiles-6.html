<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Backing Up, Sharing, and Mounting Labeled Files (Task Map) - Solaris Trusted Extensions Administrator's Procedures</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2009-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">Solaris Trusted Extensions Administrator's Procedures</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="managefiles-26.html">Previous</a>
             </td>
             <td align="right">
                 <a href="txnet-1.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-4.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="trp-part-1.html">Part&nbsp;I&nbsp;Initial Configuration of Trusted Extensions</a></p>
<p class="toc level2"><a href="ovw-1.html">1.&nbsp;&nbsp;Security Planning for Trusted Extensions</a></p>
<p class="toc level2"><a href="tmap-1.html">2.&nbsp;&nbsp;Configuration Roadmap for Trusted Extensions</a></p>
<p class="toc level2"><a href="startinst-1.html">3.&nbsp;&nbsp;Adding Solaris Trusted Extensions Software to the Solaris OS (Tasks)</a></p>
<p class="toc level2"><a href="txconf-1.html">4.&nbsp;&nbsp;Configuring Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="txldap-1.html">5.&nbsp;&nbsp;Configuring LDAP for Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="headl-1.html">6.&nbsp;&nbsp;Configuring a Headless System With Trusted Extensions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="trp-part-2.html">Part&nbsp;II&nbsp;Administration of Trusted Extensions</a></p>
<p class="toc level2"><a href="txintro-1.html">7.&nbsp;&nbsp;Trusted Extensions Administration Concepts</a></p>
<p class="toc level2"><a href="txtool-1.html">8.&nbsp;&nbsp;Trusted Extensions Administration Tools</a></p>
<p class="toc level2"><a href="roles-1.html">9.&nbsp;&nbsp;Getting Started as a Trusted Extensions Administrator (Tasks)</a></p>
<p class="toc level2"><a href="secreq-1.html">10.&nbsp;&nbsp;Security Requirements on a Trusted Extensions System (Overview)</a></p>
<p class="toc level2"><a href="commontasks-1.html">11.&nbsp;&nbsp;Administering Security Requirements in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="useraccts-1.html">12.&nbsp;&nbsp;Users, Rights, and Roles in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="manageusers-1.html">13.&nbsp;&nbsp;Managing Users, Rights, and Roles in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="remotead-1.html">14.&nbsp;&nbsp;Remote Administration in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="manageldap-1.html">15.&nbsp;&nbsp;Trusted Extensions and LDAP (Overview)</a></p>
<p class="toc level2"><a href="managezones-1.html">16.&nbsp;&nbsp;Managing Zones in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="managefiles-1.html">17.&nbsp;&nbsp;Managing and Mounting Files in Trusted Extensions (Tasks)</a></p>
<p class="toc level3"><a href="managefiles-16.html">Sharing and Mounting Files in Trusted Extensions</a></p>
<p class="toc level3"><a href="txnet-10.html">NFS Mounts in Trusted Extensions</a></p>
<p class="toc level3"><a href="managefiles-18.html">Sharing Files From a Labeled Zone</a></p>
<p class="toc level3"><a href="managefiles-31.html">Access to NFS Mounted Directories in Trusted Extensions</a></p>
<p class="toc level3"><a href="managefiles-26.html">Trusted Extensions Software and NFS Protocol Versions</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Backing Up, Sharing, and Mounting Labeled Files (Task Map)</a></p>
</div>
<p class="toc level2 tocsp"><a href="txnet-1.html">18.&nbsp;&nbsp;Trusted Networking (Overview)</a></p>
<p class="toc level2"><a href="managetnet-1.html">19.&nbsp;&nbsp;Managing Networks in Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="managemail-1.html">20.&nbsp;&nbsp;Multilevel Mail in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="manageprint-1.html">21.&nbsp;&nbsp;Managing Labeled Printing (Tasks)</a></p>
<p class="toc level2"><a href="gentextid-15538.html">22.&nbsp;&nbsp;Devices in Trusted Extensions (Overview)</a></p>
<p class="toc level2"><a href="managedev-1.html">23.&nbsp;&nbsp;Managing Devices for Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="audtask-1.html">24.&nbsp;&nbsp;Trusted Extensions Auditing (Overview)</a></p>
<p class="toc level2"><a href="softmgt-1.html">25.&nbsp;&nbsp;Software Management in Trusted Extensions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="appol-1.html">A.&nbsp;&nbsp;Site Security Policy</a></p>
<p class="toc level2"><a href="appol-12.html">Creating and Managing a Security Policy</a></p>
<p class="toc level2"><a href="appol-11.html">Site Security Policy and Trusted Extensions</a></p>
<p class="toc level2"><a href="appol-2.html">Computer Security Recommendations</a></p>
<p class="toc level2"><a href="appol-3.html">Physical Security Recommendations</a></p>
<p class="toc level2"><a href="appol-4.html">Personnel Security Recommendations</a></p>
<p class="toc level2"><a href="appol-5.html">Common Security Violations</a></p>
<p class="toc level2"><a href="appol-6.html">Additional Security References</a></p>
<p class="toc level1 tocsp"><a href="aptxconf-1.html">B.&nbsp;&nbsp;Using CDE Actions to Install Zones in Trusted Extensions</a></p>
<p class="toc level2"><a href="aptxconf-62.html">Associating Network Interfaces With Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level2"><a href="aptxconf-40.html">Preparing to Create Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level2"><a href="aptxconf-20.html">Creating Labeled Zones by Using CDE Actions (Task Map)</a></p>
<p class="toc level1 tocsp"><a href="checklist-1.html">C.&nbsp;&nbsp;Configuration Checklist for Trusted Extensions</a></p>
<p class="toc level2"><a href="checklist-2.html">Checklist for Configuring Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="txapp-1.html">D.&nbsp;&nbsp;Quick Reference to Trusted Extensions Administration</a></p>
<p class="toc level2"><a href="txapp-2.html">Administrative Interfaces in Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-3.html">Solaris Interfaces Extended by Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-4.html">Tighter Security Defaults in Trusted Extensions</a></p>
<p class="toc level2"><a href="txapp-5.html">Limited Options in Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="txmp-1.html">E.&nbsp;&nbsp;List of Trusted Extensions Man Pages</a></p>
<p class="toc level2"><a href="txmp-2.html">Trusted Extensions Man Pages in Alphabetical Order</a></p>
<p class="toc level2"><a href="txmp-3.html">Solaris Man Pages That Are Modified by Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="managefiles-6"></a><h3>Backing Up, Sharing, and Mounting Labeled Files (Task Map)</h3>
<a name="indexterm-920"></a><a name="indexterm-921"></a><p>The following task map describes common tasks that are used to back up
and restore data from labeled file systems, and to share and mount
directories and files that are labeled.</p><table><col width="33%"><col width="33%"><col width="33%"><tr><th align="left" valign="top" scope="column"><p>Task</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>For Instructions</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Back up files.</p></td>
<td align="left" valign="top" scope="row"><p>Protects your data by backing
it up.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#managefiles-13">How to Back Up Files in Trusted Extensions</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Restore data.</p></td>
<td align="left" valign="top" scope="row"><p>Restores data from a backup.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#managefiles-14">How to Restore Files in Trusted Extensions</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Share the contents of a directory
from a labeled zone.</p></td>
<td align="left" valign="top" scope="row"><p>Allows the contents of a labeled directory to be
shared among users.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#txconf-43">How to Share Directories From a Labeled Zone</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Mount the contents of a directory that was shared by
a labeled zone.</p></td>
<td align="left" valign="top" scope="row"><p>Allows the contents of a directory to be mounted in
a zone at the same label for read/write. When a higher-level zone mounts
the shared directory, the directory is mounted read-only.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#txconf-41">How to NFS Mount Files in a Labeled Zone</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Create home directory mount points.</p></td>
<td align="left" valign="top" scope="row"><p>Creates mount
points for every user at every label. This task enables users to access
their home directory on a system that is not the NFS home directory
server.</p></td>
<td align="left" valign="top" scope="row"><p><a href="txconf-50.html#txconf-56">Enable Users to Access Their Home Directories in Trusted Extensions</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Hide lower-level information from a user who is working at a higher label.</p></td>
<td align="left" valign="top" scope="row"><p>Prevent
the viewing of lower-level information from a higher-level window.</p></td>
<td align="left" valign="top" scope="row"><p><a href="managezones-6.html#managezones-3">How to Disable the Mounting of Lower-Level Files</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Troubleshoot file system mounting
problems.</p></td>
<td align="left" valign="top" scope="row"><p>Resolve problems with mounting a file system.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#managefiles-20">How to Troubleshoot Mount Failures in Trusted Extensions</a></p></td>
</tr>
</table>

<a name="managefiles-13"></a><h4>How to Back Up Files in Trusted Extensions</h4><a name="indexterm-922"></a><a name="indexterm-923"></a><ol>
<li><b>Assume the Operator role.</b><p>This role includes the Media Backup rights profile.</p></li>
<li><b>Use one of the following backup methods:</b>
<ul><li><p><tt>/usr/lib/fs/ufs/ufsdump</tt> for major backups</p></li>
<li><p><tt>/usr/sbin/tar cT</tt> for small backups</p></li>
<li><p>A script calling either of these commands</p><p>For example, the Budtool backup application calls the <tt>ufsdump</tt> command. See the <a href="http://docs.sun.com/doc/819-2240/ufsdump-1m?a=view"><tt>ufsdump</tt>(1M)</a> man page. For details on the <tt>T</tt> option to the <tt>tar</tt> command, see the <a href="http://docs.sun.com/doc/819-2239/tar-1?a=view"><tt>tar</tt>(1)</a> man page.</p></li></ul>
</li></ol>

<a name="managefiles-14"></a><h4>How to Restore Files in Trusted Extensions</h4><a name="indexterm-924"></a><a name="indexterm-925"></a><ol>
<li><b>Assume the System Administrator role.</b><p>This role includes the Media Restore rights profile.</p></li>
<li><b>Use one of the following methods:</b>
<ul><li><p><tt>/usr/lib/fs/ufs/ufsrestore</tt> for major restores</p></li>
<li><p><tt>/usr/sbin/tar xT</tt> for small restores</p></li>
<li><p>A script calling either of these commands</p></li></ul>
<p>For details on the <tt>T</tt> option to the <tt>tar</tt> command, see the
<a href="http://docs.sun.com/doc/819-2239/tar-1?a=view"><tt>tar</tt>(1)</a> man page.</p>
<hr><p><b>Caution - </b>Only these commands preserve labels.</p>
<hr>
</li></ol>

<a name="txconf-43"></a><h4>How to Share Directories From a Labeled Zone</h4><a name="indexterm-926"></a><a name="indexterm-927"></a><a name="indexterm-928"></a><a name="indexterm-929"></a><a name="indexterm-930"></a><a name="indexterm-931"></a><p>As in the Solaris OS, the Mounts and Shares tool in the
Solaris Management Console is used to share and mount files from the global
zone. The tool cannot be used to mount or share directories that originate
in labeled zones. Create a <tt>dfstab</tt> file at the label of the zone,
and then restart the zone to share the labeled directories.</p>
<hr><p><b>Caution - </b><a name="indexterm-932"></a><a name="indexterm-933"></a><a name="indexterm-934"></a>Do not use proprietary names for shared file systems. The names of shared
file systems are visible to every user.</p>
<hr>
<h6>Before You Begin</h6><p>You must be superuser, or in the System Administrator role in the
global zone on the file server.</p><ol>
<li><b>Create a workspace at the label of the directory that is going to
be shared.</b><p>For details, see <a href="http://docs.sun.com/doc/819-7313/shared-commontasks-37?a=view">How to Add a Workspace at a Particular Label in <i>Solaris Trusted Extensions User&rsquo;s Guide</i></a>.</p></li>
<li><b>Create a <tt>dfstab</tt> file in at the label of that zone.</b><p>For each zone that will share a directory, repeat the following steps:</p><ol style="list-style-type: lower-alpha">
<li><b>Create the <tt>/etc/dfs</tt> directory in the zone.</b><pre># mkdir -p <tt>/zone/</tt><i>zone-name</i><tt>/etc/dfs</tt></pre></li>
<li><b>Open the trusted editor.</b><p>For details, see <a href="roles-4.html#roles-10">How to Edit Administrative Files in Trusted Extensions</a>.</p></li>
<li><b>Type the full pathname of the <tt>dfstab</tt> file into the editor.</b><pre># /zone/<i>zone-name</i>/etc/dfs/dfstab</pre></li>
<li><b>Add an entry to share a directory from that zone.</b><p>The entry describes the directory from the perspective of the zone root path. For
example, the following entry shares an application's files at the label of the
containing zone:</p><pre>share -F nfs -o ro /<i>viewdir</i>/<i>viewfiles</i></pre></li></ol></li>
<li><b>For each zone, share the directories by starting the zone.</b><p>In the global zone, run one of the following commands for each
zone. Each zone can share its directories in any of these ways. The
actual sharing occurs when each zone is brought into the <tt>ready</tt> or <tt>running</tt>
state.</p><ul>
<li><b>If the zone is not in the running state and you do
not want users to log in to the server at the label of
the zone, set the zone state to <tt>ready</tt>.</b><pre># zoneadm -z <i>zone-name</i> ready</pre></li>
<li><b>If the zone is not in the running state and users are
allowed to log in to the server at the label of the zone,
boot the zone.</b><pre># zoneadm -z <i>zone-name</i> boot</pre></li>
<li><b>If the zone is already running, reboot the zone.</b><pre># zoneadm -z <i>zone-name</i> reboot</pre></li></ul></li>
<li><b>Display the directories that are shared from your system.</b><pre># <tt><b>showmount -e</b></tt></pre></li>
<li><b>To enable the client to mount the exported files, see <a href="#txconf-41">How to NFS Mount Files in a Labeled Zone</a>.</b></li></ol><a name="managefiles-15"></a><h6>Example&nbsp;17-2 Sharing the <tt>/export/share</tt> Directory at the <tt>PUBLIC</tt> Label</h6><p>For applications that run at the label <tt>PUBLIC</tt>, the system administrator enables users
to read the documentation in the <tt>/export/share</tt> directory of the <tt>public</tt> zone. The
zone named <tt>public</tt> runs at the label <tt>PUBLIC</tt>. </p><p>First, the administrator creates a <tt>public</tt> workspace and edits the <tt>dfstab</tt> file.</p><pre># <tt><b>mkdir -p /zone/public/etc/dfs</b></tt>
# <tt><b>/usr/dt/bin/trusted_edit /zone/public/etc/dfs/dfstab</b></tt></pre><p>In the file, the administrator adds the following entry:</p><pre>## Sharing PUBLIC user manuals
share -F nfs -o ro /export/appdocs</pre><p>The administrator leaves the <tt>public</tt> workspace and returns to the Trusted Path workspace.
Because users are not allowed to log in to this system, the administrator
shares the files by putting the zone in the ready state:</p><pre># zoneadm -z public ready</pre><p>Users can access the shared directories once the directories are mounted on the
users' systems.</p>

<a name="txconf-41"></a><h4>How to NFS Mount Files in a Labeled Zone</h4><a name="indexterm-935"></a><a name="indexterm-936"></a><p>In Trusted Extensions, a labeled zone manages the mounting of files in
its zone.</p><p>Files from unlabeled and labeled hosts can be mounted on a Trusted
Extensions labeled host.</p>
<ul><li><p>To mount the files read/write from a single-label host, the assigned label of the remote host must be identical to the zone in which the file is being mounted.</p></li>
<li><p>Files that are mounted by a higher-level zone are read-only.</p></li>
<li><p>In Trusted Extensions, the <tt>auto_home</tt> configuration file is customized per zone. The file is named by zone name. For example, a system with a global zone and a public zone has two <tt>auto_home</tt> files, <tt>auto_home_global</tt> and <tt>auto_home_public</tt>.</p></li></ul>
<p>Trusted Extensions uses the same mounting interfaces as the Solaris OS:</p>
<ul><li><p>To mount files at boot, use the <tt>/etc/vfstab</tt> file in the labeled zone.</p></li>
<li><p>To mount files dynamically, use the <tt>mount</tt> command in the labeled zone.</p></li>
<li><p>To automount home directories, use the <tt>auto_home_</tt><i>zone-name</i><tt></tt> files.</p></li>
<li><p>To automount other directories, use the standard automount maps. If the automount maps are in LDAP, use LDAP commands to manage them.</p></li></ul>
<h6>Before You Begin</h6><p>You must be on the client system, in the zone at the
label of the files that you want to mount. Unless you are using
the automounter, you must be superuser, or be in the System Administrator role.
To mount from lower-level servers, the zone must be configured with the <tt>net_mac_aware</tt>
privilege.</p><ul>
<li><b>To NFS mount files in a labeled zone, use the following procedures.</b><p>Most procedures include creating a workspace at a particular label. To create a
workspace, see <a href="http://docs.sun.com/doc/819-7313/shared-commontasks-37?a=view">How to Add a Workspace at a Particular Label in <i>Solaris Trusted Extensions User&rsquo;s Guide</i></a>.</p><ul>
<li><b>Mount files dynamically.</b><p>In the labeled zone, use the <tt>mount</tt> command. For an example of mounting
files dynamically, see <a href="#managefiles-28">Example&nbsp;17-3</a>.</p></li>
<li><b>Mount files when the zone boots</b><p>In the labeled zone, add the mounts to the <tt>vfstab</tt> file.</p><p>For examples of mounting files when a labeled zone boots, see <a href="#managefiles-27">Example&nbsp;17-4</a>
and <a href="#managefiles-29">Example&nbsp;17-5</a>.</p></li>
<li><b>Mount home directories for systems that are administered with LDAP.</b><ol style="list-style-type: lower-alpha">
<li><b>At every label, add the user specifications to the <tt>auto_home_</tt><i>zone-name</i><tt></tt> files.</b></li>
<li><b>Then, use these files to populate the <tt>auto_home_</tt><i>zone-name</i><tt></tt> database on the LDAP
server.</b></li></ol><p>For an example, see <a href="#managefiles-25">Example&nbsp;17-6</a>.</p></li>
<li><b>Mount home directories for systems that are administered with files.</b><ol style="list-style-type: lower-alpha">
<li><a name="managefiles-step-homedirfiles-1"></a><b>Create and populate an <tt>/export/home/auto_home_</tt><i>lowest-labeled-zone-name</i><tt></tt> file.</b></li>
<li><b>Edit the <tt>/etc/auto_home_</tt><i>lowest-labeled-zone-name</i><tt></tt> file to point to the newly populated file.</b></li>
<li><b>Modify the <tt>/etc/auto_home_</tt><i>lowest-labeled-zone-name</i><tt></tt> file in every higher-level zone to point to the file
that you created in <a href="#managefiles-step-homedirfiles-1">Step&nbsp;a</a>.</b></li></ol><p>For an example, see <a href="#managefiles-33">Example&nbsp;17-7</a>.</p></li></ul></li></ul><a name="managefiles-28"></a><h6>Example&nbsp;17-3 Mounting Files in a Labeled Zone by Using the <tt>mount</tt> Command</h6><p>In this example, the system administrator mounts a remote file system from a
public zone. The public zone is on a multilevel server.</p><p>After assuming the System Administrator role, the administrator creates a workspace at the
label <tt>PUBLIC</tt>. In that workspace, the administrator runs the <tt>mount</tt> command.</p><pre># <tt><b>zonename</b></tt>
public
# <tt><b>mount -F nfs remote-sys:/zone/public/root/opt/docs /opt/docs</b></tt></pre><p>A single-label file server at the label <tt>PUBLIC</tt> also contains documents to be
mounted:</p><pre># <tt><b>mount -F nfs public-sys:/publicdocs /opt/publicdocs</b></tt></pre><p>When the public zone of the <tt>remote-sys</tt> file server is in the <tt>ready</tt>
or <tt>running</tt> state, the <tt>remote-sys</tt> files successfully mount on this system. When
the <tt>public-sys</tt> file server is running, the files successfully mount.</p><a name="managefiles-27"></a><h6>Example&nbsp;17-4 Mounting Files Read/Write in a Labeled Zone by Modifying the <tt>vfstab</tt> File</h6><p>In this example, the system administrator mounts two remote file systems at the
label <tt>PUBLIC</tt> in the local system's public zone when the public zone boots.
One file system mount is from a multilevel system, and one file system
mount is from a single-label system.</p><p>After assuming the System Administrator role, the administrator creates a workspace at the
label <tt>PUBLIC</tt>. In that workspace, the administrator modifies the <tt>vfstab</tt> file in that
zone.</p><pre>## Writable books directories at PUBLIC
remote-sys:/zone/public/root/opt/docs  - /opt/docs  nfs  no  yes  rw
public-sys:/publicdocs    - /opt/publicdocs  nfs no yes rw</pre><p>To access the files in the remote labeled zone of the multilevel
system, the <tt>vfstab</tt> entry uses the zone root path of the remote system's public
zone, <tt>/zone/public/root</tt>, as the directory pathname to the directories to mount. The path
to the single-label system is identical to the path that would be used
on a Solaris system.</p><p>In a terminal window at the label <tt>PUBLIC</tt>, the administrator mounts the files.</p><pre># <tt><b>mountall</b></tt></pre><a name="managefiles-29"></a><h6>Example&nbsp;17-5 Mounting Lower-Level Files in a Labeled Zone by Modifying the <tt>vfstab</tt> File</h6><p>In this example, the system administrator mounts a remote file system from a
public zone in the local system's internal zone. After assuming the System Administrator
role, the administrator creates a workspace at the label <tt>INTERNAL</tt>, then modifies
the <tt>vfstab</tt> file in that zone.</p><pre>## Readable books directory at PUBLIC
## ro entry indicates that PUBLIC docs can never be mounted rw in internal zone
remote-sys:/zone/public/root/opt/docs  - /opt/docs  nfs  no  yes  ro</pre><p>To access the files in the remote labeled zone, the <tt>vfstab</tt> entry uses
the zone root path of the remote system's public zone, <tt>/zone/public/root</tt>, as
the directory pathname to the directories to mount.</p><p>From the perspective of a user in the internal zone, the files
can be accessed at <tt>/opt/docs</tt>.</p><p>In a terminal window at the label <tt>INTERNAL</tt>, the administrator mounts the files.</p><pre># <tt><b>mountall</b></tt></pre><a name="managefiles-25"></a><h6>Example&nbsp;17-6 Mounting Labeled Home Directories in a Network That Is Administered by Using LDAP</h6><p>In this example, the system administrator enables a new user, <tt>ikuk</tt>, to
access her home directory at every label. This site uses two home directory
servers, and is administered by using LDAP. The second server contains the home
directories for the users <tt>jdoe</tt> and <tt>pkai</tt>. The new user is added
to this list.</p><p>First, after assuming the System Administrator role, the administrator modifies the <tt>auto_home_</tt><i>zone-name</i><tt></tt> files in
the <tt>/etc</tt> directory of the global zone to include the new user on
the second home directory server.</p><pre>## auto_home_global file
jdoe   homedir2-server:/export/home/jdoe
pkai   homedir2-server:/export/home/pkai
<tt><b>ikuk homedir2-server:/export/home/ikuk</b></tt>
*      homedir-server:/export/home/&amp;</pre><pre>## auto_home_internal file
## Mount the home directory from the internal zone of the NFS server
jdoe   homedir2-server:/export/home/jdoe
pkai   homedir2-server:/export/home/pkai
<tt><b>ikuk homedir2-server:/export/home/ikuk</b></tt>
*      homedir-server:/export/home/&amp;</pre><pre>## auto_home_public
## Mount the home directory from the public zone of the NFS server
jdoe   homedir2-server:/export/home/jdoe
pkai   homedir2-server:/export/home/pkai
<tt><b>ikuk homedir2-server:/export/home/ikuk</b></tt>
*      homedir-server:/export/home/&amp;</pre><p>Next, to enable the users to log in at all labels, the
administrator repeats these edits for the <tt>auto_home_</tt><i>zone-name</i><tt></tt> files at every label.</p><p>Finally, after modifying every <tt>auto_home_</tt><i>zone-name</i><tt></tt> file on this system, the administrator uses these
files to add entries to the LDAP database. </p><p>Similar to the Solaris OS, the <tt>+auto_home_public</tt> entry in the <tt>/etc/auto_home_</tt><i>zone-name</i><tt></tt> files directs the
automounter to the LDAP entries. The <tt>auto_home_</tt><i>zone-name</i><tt></tt> files on other systems on
the network are updated from the LDAP database.</p><a name="managefiles-33"></a><h6>Example&nbsp;17-7 Mounting a Lower-Level Home Directory on a System That Is Administered by Using Files</h6><p>In this example, the system administrator enables users to access their home directories
at every label. The labels at the site are <tt>PUBLIC</tt>, <tt>INTERNAL</tt>, and
<tt>NEEDTOKNOW</tt>. This site uses two home directory servers, and is administered by using
files. The second server contains the home directories for the users <tt>jdoe</tt> and
<tt>pkai</tt>.</p><p>To accomplish this task, the system administrator defines the public zone NFS home
directories in the public zone, and shares this configuration with the internal and
needtoknow zones.</p><p>First, after assuming the System Administrator role, the administrator creates a workspace at
the label <tt>PUBLIC</tt>. In this workspace, the administrator creates a new file, <tt>/export/home/auto_home_public</tt>. This
file contains all the customized per-user NFS specification entries.</p><pre><tt><b>## /export/home/auto_home_public file at PUBLIC label</b></tt>
<tt><b>jdoe homedir2-server:/export/home/jdoe</b></tt>
<tt><b>pkai homedir2-server:/export/home/pkai</b></tt>
<tt><b>* homedir-server:/export/home/&amp;</b></tt></pre><p>Second, the administrator modifies the <tt>/etc/auto_home_public</tt> file to point to this new file.</p><pre>## /etc/auto_home_public file in the public zone
## Use /export/home/auto_home_public for the user entries
<tt><b>##</b></tt> +auto_home_public
<tt><b>+ /export/home/auto_home_public</b></tt></pre><p>This entry directs the automounter to use the contents of the local file.</p><p>Third, the administrator similarly modifies the <tt>/etc/auto_home_public</tt> file in the internal and
needtoknow zones. The administrator uses the pathname to the public zone that is
visible to the internal and needtoknow zones.</p><pre>## /etc/auto_home_public file in the internal zone
## Use /zone/public/export/home/auto_home_public for PUBLIC user home dirs
<tt><b>##</b></tt> +auto_home_public
<tt><b>+ /zone/public/export/home/auto_home_public</b></tt></pre><pre>## /etc/auto_home_public file in the needtoknow zone
## Use /zone/public/export/home/auto_home_public for PUBLIC user home dirs
<tt><b>##</b></tt> +auto_home_public
<tt><b>+ /zone/public/export/home/auto_home_public</b></tt></pre><p>When the administrator adds the new user <tt>ikuk</tt>, the addition is made to
the <tt>/export/home/auto_home_public</tt> file at the <tt>PUBLIC</tt> label.</p><pre>## /export/home/auto_home_public file at PUBLIC label
jdoe   homedir2-server:/export/home/jdoe
pkai   homedir2-server:/export/home/pkai
<tt><b>ikuk homedir2-server:/export/home/ikuk</b></tt>
*      homedir-server:/export/home/&amp;</pre><p>The higher-level zones read down to obtain the per-user home directories from the
lower-level public zone.</p>

<a name="managefiles-20"></a><h4>How to Troubleshoot Mount Failures in Trusted Extensions</h4><a name="indexterm-937"></a><a name="indexterm-938"></a><a name="indexterm-939"></a><h6>Before You Begin</h6><p>You must be in the zone at the label of the files
that you want to mount. You must be the superuser, or in the
System Administrator role.</p><ol>
<li><b>Check the security attributes of the NFS server.</b><p>Use the Security Templates tool in the Solaris Management Console at the appropriate
scope. For details, see <a href="txconf-60.html#confsys-21">Initialize the Solaris Management Console Server in Trusted Extensions</a>.</p><ol style="list-style-type: lower-alpha">
<li><b>Verify that the IP address of the NFS server is an assigned
host in one of the security templates.</b><p>The address might be directly assigned, or indirectly assigned through a wildcard mechanism.
The address can be in a labeled template, or in an unlabeled template.</p></li>
<li><b>Check the label that the template assigns to the NFS server.</b><p>The label must be consistent with the label at which you are
trying to mount the files.</p></li></ol></li>
<li><b>Check the label of the current zone.</b><p>If the label is higher than the label of the mounted file system,
then you cannot write to the mount even if the remote file system
is exported with read/write permissions. You can only write to the mounted file
system at the label of the mount.</p></li>
<li><b>To mount file systems from an NFS server that is running earlier versions
of Trusted Solaris software, do the following:</b><ul>
<li><b>For a Trusted Solaris 1 NFS server, use the <tt>vers=2</tt> and <tt>proto=udp</tt>
options to the <tt>mount</tt> command.</b></li>
<li><b>For a Trusted Solaris 2.5.1 NFS server, use the <tt>vers=2</tt> and <tt>proto=udp</tt>
options to the <tt>mount</tt> command.</b></li>
<li><b>For a Trusted Solaris 8 NFS server, use the <tt>vers=3</tt> and <tt>proto=udp</tt>
options to the <tt>mount</tt> command.</b></li></ul><p>To mount file systems from any of these servers, the server must
be assigned to an unlabeled template.</p></li></ol>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="managefiles-26.html">Previous</a>
             </td>
             <td align="right">
                 <a href="txnet-1.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

