<?Pub UDT _bookmark _target?><?Pub CX solbook(?><chapter id="txldap-1"><?Pub Tag atict:info tracking="on" ref="0"?><?Pub Tag atict:user
user="sharonr" fullname="Sharon Veach"?><title>Configuring LDAP for Trusted Extensions (Tasks)</title><highlights><para>This chapter covers how to configure the Sun <trademark>Java</trademark> System Directory Server and the Solaris Management Console for
use with Solaris Trusted Extensions. The Directory Server provides LDAP services. LDAP is the
supported naming service for Trusted Extensions. The Solaris Management Console is the administrative
GUI for local and LDAP databases.</para><itemizedlist><para>You have two options when configuring the Directory Server. You can
configure an LDAP server on a Trusted Extensions system, or you can use an existing
server and connect to it by using a Trusted Extensions proxy server. Follow the
instructions in <emphasis>one</emphasis> of the following task maps:</para><listitem><para><olink targetptr="txldap-16" remap="internal">Configuring an LDAP Server on
a Trusted Extensions Host (Task Map)</olink></para>
</listitem><listitem><para><olink targetptr="txldap-18" remap="internal">Configuring an LDAP Proxy Server
on a Trusted Extensions Host (Task Map)</olink></para>
</listitem>
</itemizedlist>
</highlights><sect1 id="txldap-16"><title>Configuring an LDAP Server on a Trusted Extensions Host
(Task Map)</title><indexterm><primary>tasks and task maps</primary><secondary>Configuring an LDAP Server on a Trusted Extensions Host (Task Map)</secondary>
</indexterm><indexterm><primary>Configuring an LDAP Server on a Trusted Extensions Host (Task Map)</primary>
</indexterm><informaltable frame="topbot" pgwide="1"><tgroup cols="3" colsep="1" rowsep="1"><colspec colname="colspec2" colwidth="21.17*"/><colspec colname="colspec1" colwidth="41.68*"/><colspec colname="colspec0" colwidth="36.12*"/><thead><row><entry><para>Task</para>
</entry><entry><para>Description</para>
</entry><entry><para>For Instructions</para>
</entry>
</row>
</thead><tbody><row><entry><para>Set up a Trusted Extensions LDAP server.</para>
</entry><entry><para>If you do not have an existing Sun Java System Directory Server, make your first Trusted Extensions system
the Directory Server. The other Trusted Extensions systems are clients of this
server.</para>
</entry><entry><para><olink targetptr="txldap-3" remap="internal">Collect Information for the Directory Server
for LDAP</olink></para><para><olink targetptr="txldap-4" remap="internal">Install the Sun Java System Directory Server</olink></para><para><olink targetptr="txldap-12" remap="internal">Configure the Logs for the Sun Java System
Directory Server</olink></para>
</entry>
</row><row><entry><para>Add Trusted Extensions databases to the server.</para>
</entry><entry><para>Populate the LDAP server with data from the Trusted Extensions system files.</para>
</entry><entry><para><olink targetptr="txldap-2" remap="internal">Populate the Sun Java System Directory Server</olink></para>
</entry>
</row><row><entry><para>Configure the Solaris Management Console to work with the Directory Server.</para>
</entry><entry><para>Manually set up an LDAP toolbox for the Solaris Management Console. The toolbox can be used
to modify Trusted Extensions attributes on network objects.</para>
</entry><entry><para><olink targetptr="confsys-10" remap="internal">Configuring the Solaris Management Console
for LDAP (Task Map)</olink></para>
</entry>
</row><row><entry><para>Configure all other Trusted Extensions systems as clients of this server.</para>
</entry><entry><para>When you configure another system with Trusted Extensions, make the system
a client of this LDAP server.</para>
</entry><entry><para><olink targetptr="txldap-8" remap="internal">Make the Global Zone an LDAP Client in Trusted
Extensions</olink></para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable>
</sect1><sect1 id="txldap-18"><title>Configuring an LDAP Proxy Server on a Trusted Extensions Host
(Task Map)</title><indexterm><primary>tasks and task maps</primary><secondary>Configuring an LDAP Proxy Server on a Trusted Extensions Host (Task Map)</secondary>
</indexterm><indexterm><primary>Configuring an LDAP Proxy Server on a Trusted Extensions Host (Task Map)</primary>
</indexterm><para>Use this task map if you have an existing Sun Java System Directory Server that is running on
a Solaris system.</para><informaltable frame="topbot" pgwide="1"><tgroup cols="3" colsep="1" rowsep="1"><colspec colname="colspec2" colwidth="26.01*"/><colspec colname="colspec1" colwidth="36.49*"/><colspec colname="colspec0" colwidth="36.49*"/><thead><row><entry><para>Task</para>
</entry><entry><para>Description</para>
</entry><entry><para>For Instructions</para>
</entry>
</row>
</thead><tbody><row><entry><para>Add Trusted Extensions databases to the server.</para>
</entry><entry><para>The Trusted Extensions network databases, <filename>tnrhdb</filename> and <filename>tnrhtp</filename>, need to be added to the LDAP server.</para>
</entry><entry><para><olink targetptr="txldap-2" remap="internal">Populate the Sun Java System Directory Server</olink></para>
</entry>
</row><row><entry><para>Set up an LDAP proxy server.</para>
</entry><entry><para>Make one Trusted Extensions system the proxy server for the other Trusted Extensions systems.
The other Trusted Extensions systems use this proxy server to reach the LDAP server.</para>
</entry><entry><para><olink targetptr="txldap-6" remap="internal">Create an LDAP Proxy Server</olink></para>
</entry>
</row><row><entry><para>Configure the proxy server to have a multilevel port for LDAP.</para>
</entry><entry><para>Enable the Trusted Extensions proxy server to communicate with the LDAP
server at specific labels.</para>
</entry><entry><para><olink targetptr="txldap-10" remap="internal">Configure a Multilevel Port for the Sun
Java System Directory Server</olink></para>
</entry>
</row><row><entry><para>Configure the Solaris Management Console to work with the LDAP proxy server.</para>
</entry><entry><para>You manually set up an LDAP toolbox for the Solaris Management Console. The toolbox can be
used to modify Trusted Extensions attributes on network objects.</para>
</entry><entry><para><olink targetptr="confsys-10" remap="internal">Configuring the Solaris Management Console
for LDAP (Task Map)</olink></para>
</entry>
</row><row><entry><para>Configure all other Trusted Extensions systems as clients of the LDAP proxy
server.</para>
</entry><entry><para>When you configure another system with Trusted Extensions, make the system
a client of the LDAP proxy server.</para>
</entry><entry><para><olink targetptr="txldap-8" remap="internal">Make the Global Zone an LDAP Client in Trusted
Extensions</olink></para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable>
</sect1><sect1 id="txconf-8"><title>Configuring the Sun Java System Directory Server on a Trusted Extensions System</title><indexterm><primary>Sun Java System Directory Server</primary><see>LDAP server</see>
</indexterm><indexterm><primary>installing</primary><secondary>Sun Java System Directory Server</secondary>
</indexterm><indexterm><primary>Trusted Extensions configuration</primary><secondary>LDAP</secondary>
</indexterm><indexterm><primary>LDAP configuration</primary><secondary>for Trusted Extensions</secondary>
</indexterm><indexterm><primary>configuring</primary><secondary>LDAP for Trusted Extensions</secondary>
</indexterm><indexterm><primary>Trusted Extensions configuration</primary><secondary>databases for LDAP</secondary>
</indexterm><para>The LDAP naming service is the supported naming service for Trusted Extensions.
If your site is not yet running the LDAP naming service, configure a Sun Java System Directory Server (Directory
Server) on a system that is configured with Trusted Extensions. If your site is
already running a Directory Server, then you need to add the Trusted Extensions databases
to the server. To access the Directory Server, you then set up an LDAP proxy
on a Trusted Extensions system.</para><note><para>If you do not use this LDAP server as an NFS server or as a server
for Sun <trademark>Ray</trademark> clients, then you do not need to install
any labeled zones on this server.</para>
</note><task id="txldap-3"><title>Collect Information for the Directory
Server for LDAP</title><indexterm><primary>LDAP server</primary><secondary>collecting information for</secondary>
</indexterm><indexterm><primary>collecting information</primary><secondary>for LDAP service</secondary>
</indexterm><procedure remap="single-step"><step><para>Determine the values for the following items.</para><para>The
items are listed in the order of their appearance in the Sun Java Enterprise
System Install Wizard.</para><informaltable frame="topbot"><tgroup cols="2" colsep="0" rowsep="0"><colspec colname="colspec0" colwidth="31.24*"/><colspec colname="colspec1" colwidth="68.76*"/><thead><row><entry rowsep="1"><para>Install Wizard Prompt</para>
</entry><entry rowsep="1"><para>Action or Information</para>
</entry>
</row>
</thead><tbody><row><entry namest="colspec0" nameend="colspec1" colsep="1"><para>Sun Java System Directory Server <replaceable>version</replaceable></para>
</entry>
</row><row><entry><para>Administrator User ID</para>
</entry><entry><para>The default value is <literal>admin</literal>.</para>
</entry>
</row><row><entry><para>Administrator Password</para>
</entry><entry><para>Create a password, such as <literal>admin123</literal>.</para>
</entry>
</row><row><entry><para>Directory Manager DN</para>
</entry><entry><para>The default value is <literal>cn=Directory Manager</literal>.</para>
</entry>
</row><row><entry><para>Directory Manager Password</para>
</entry><entry><para>Create a password, such as <literal>dirmgr89</literal>.</para>
</entry>
</row><row><entry><para>Directory Server Root</para>
</entry><entry><para>The default value is <filename>/var/Sun/mps</filename>. This path is
also used later if the proxy software is installed.</para>
</entry>
</row><row><entry><para>Server Identifier</para>
</entry><entry><para>The default value is the local system.</para>
</entry>
</row><row><entry><para>Server Port</para>
</entry><entry><para>If you plan to use the Directory Server to provide standard LDAP naming
services to client systems, use the default value, <literal>389</literal>.</para><para>If you plan to use the Directory Server to support a subsequent installation
of a proxy server, enter a nonstandard port, such as <literal>10389</literal>.</para>
</entry>
</row><row><entry><para>Suffix</para>
</entry><entry><para>Include your domain component, as in <literal>dc=example-domain,dc=com</literal>.</para>
</entry>
</row><row><entry><para>Administration Domain</para>
</entry><entry><para>Construct to correspond to the Suffix, as in, <literal>example-domain.com</literal>.</para>
</entry>
</row><row><entry><para>System User</para>
</entry><entry><para>The default value is <literal>root</literal>.</para>
</entry>
</row><row><entry><para>System Group</para>
</entry><entry><para>The default value is <literal>root</literal>.</para>
</entry>
</row><row><entry><para>Data Storage Location</para>
</entry><entry><para>The default value is <literal>Store configuration data on this server</literal>.</para>
</entry>
</row><row><entry><para>Data Storage Location</para>
</entry><entry><para>The default value is <literal>Store user data and group data on this
server</literal>.</para>
</entry>
</row><row><entry><para>Administration Port</para>
</entry><entry><para>The default value is the Server Port. A suggested convention for changing
the default is <literal>software-version TIMES 1000</literal>. For software
version 5.2, this convention would result in port <literal>5200</literal>.</para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable>
</step>
</procedure>
</task><task id="txldap-4"><title>Install the Sun Java System Directory Server</title><indexterm><primary>LDAP server</primary><secondary>installing in Trusted Extensions</secondary>
</indexterm><indexterm><primary>LDAP server</primary><secondary>configuring naming service</secondary>
</indexterm><tasksummary><para>The Directory Server packages are available from the <ulink url="http://www.sun.com/software/solaris" type="text_url">Sun Software Gateway
web site</ulink>. </para>
</tasksummary><procedure><step><para>Find the Sun Java System Directory Server packages on the Sun web site.</para><substeps><step><para>On the <ulink url="http://www.sun.com/software/solaris" type="text_url">Sun Software Gateway</ulink> page, click the Get It tab.</para>
</step><step><para>Click the checkbox for the Sun Java Identity Management Suite.</para>
</step><step><para>Click the Submit button.</para>
</step><step><para>If you are not registered, register.</para>
</step><step><para>Log in to download the software.</para>
</step><step><para>Click the Download Center at the upper left of the screen.</para>
</step><step><para>Under Identity Management, download the most recent software that
is appropriate for your platform.</para>
</step>
</substeps>
</step><step><para>In the <filename>/etc/hosts</filename> file, add the FQDN to your
system's hostname entry.</para><para>The FQDN is the Fully Qualified Domain
Name. This name is a combination of the host name and the administration domain,
as in:</para><screen>192.168.5.5 myhost myhost.example-domain.com</screen>
</step><step><para>Install the Directory Server packages.</para><para>Answer the
questions by using the information from <olink targetptr="txldap-3" remap="internal">Collect
Information for the Directory Server for LDAP</olink>.</para>
</step><step><para>Ensure that the Directory Server starts at every boot.</para><para><indexterm><primary>service management framework (SMF)</primary><secondary><literal>dsadm</literal></secondary></indexterm><indexterm><primary><literal>dsadm</literal> service</primary></indexterm><indexterm><primary>enabling</primary><secondary><literal>dsadm</literal> service</secondary></indexterm>Templates for the SMF services for the Directory Server
are in the Sun Java System Directory Server packages. </para><stepalternatives><step><para>For a Trusted Extensions Directory Server, enable the service.</para><screen># dsadm stop /export/home/ds/instances/<replaceable>your-instance</replaceable>
# dsadm enable-service -T SMF /export/home/ds/instances/<replaceable>your-instance</replaceable>
# dsadm start /export/home/ds/instances/<replaceable>your-instance</replaceable></screen><para>For information about the <command>dsadm</command> command, see the <command>dsadm</command>(1M) man page.</para>
</step><step><para><indexterm><primary>service management framework (SMF)</primary><secondary><literal>dpadm</literal></secondary></indexterm><indexterm><primary><literal>dpadm</literal> service</primary></indexterm><indexterm><primary>enabling</primary><secondary><literal>dpadm</literal> service</secondary></indexterm>For a proxy
Directory Server, enable the service.</para><screen># dpadm stop /export/home/ds/instances/<replaceable>your-instance</replaceable>
# dpadm enable-service -T SMF /export/home/ds/instances/<replaceable>your-instance</replaceable>
# dpadm start /export/home/ds/instances/<replaceable>your-instance</replaceable></screen><para>For information about the <command>dpadm</command> command, see the <command>dpadm</command>(1M) man page.</para>
</step>
</stepalternatives>
</step><step><para>Verify your installation.</para><screen># dsadm info /export/home/ds/instances/<replaceable>your-instance</replaceable>
Instance Path:         /export/home/ds/instances/<replaceable>your-instance</replaceable>
Owner:                 root(root)
Non-secure port:       389
Secure port:           636
Bit format:            32-bit
State:                 Running
Server PID:            298
DSCC url:              -
SMF application name:  ds--export-home-ds-instances-<replaceable>your-instance</replaceable>
Instance version:      D-A00</screen>
</step>
</procedure><taskrelated role="troubleshooting"><para>For strategies to solve LDAP configuration problems, see <olink targetdoc="group-sa" targetptr="setupproblems-1" remap="external">Chapter 13, <citetitle remap="chapter">LDAP Troubleshooting (Reference),</citetitle> in <citetitle remap="book">System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</citetitle></olink>.</para>
</taskrelated>
</task><task id="txldap-12"><title>Configure the Logs for the Sun Java System Directory Server</title><indexterm><primary>LDAP server</primary><secondary>protecting log files</secondary>
</indexterm><indexterm><primary>log files</primary><secondary>protecting Directory Server logs</secondary>
</indexterm><tasksummary><itemizedlist><para>This procedure configures three types of logs: access logs, audit logs,
and error logs. The following default settings are not changed:</para><listitem><para>All logs are enabled and buffered.</para>
</listitem><listitem><para>Logs are placed in the appropriate <filename class="directory">/export/home/ds/instances/<replaceable>your-instance</replaceable>/logs/<replaceable>LOG_TYPE</replaceable></filename> directory.</para>
</listitem><listitem><para>Events are logged at log level 256.</para>
</listitem><listitem><para>Logs are protected with <literal>600</literal> file permissions.</para>
</listitem><listitem><para>Access logs are rotated daily.</para>
</listitem><listitem><para>Error logs are rotated weekly.</para>
</listitem>
</itemizedlist><itemizedlist><para>The settings in this procedure meet the following requirements:</para><listitem><para>Audit logs are rotated daily.</para>
</listitem><listitem><para>Log files that are older than 3 months expire.</para>
</listitem><listitem><para>All log files use a maximum of 20,000 MBytes of disk space.</para>
</listitem><listitem><para>A maximum of 100 log files is kept, and each file is at most
500 MBytes.</para>
</listitem><listitem><para>The oldest logs are deleted if less than 500 MBytes free disk
space is available.</para>
</listitem><listitem><para>Additional information is collected in the error logs.</para>
</listitem>
</itemizedlist>
</tasksummary><procedure><step><para>Configure the access logs.</para><para>The <replaceable>LOG_TYPE</replaceable> for
access is <literal>ACCESS</literal>. The syntax for configuring logs is the
following:</para><screen>dsconf set-log-prop <replaceable>LOG_TYPE</replaceable> <replaceable>property</replaceable>:<replaceable>value</replaceable></screen><screen># <userinput>dsconf set-log-prop ACCESS max-age:3M</userinput>
# <userinput>dsconf set-log-prop ACCESS max-disk-space-size:20000M</userinput>
# <userinput>dsconf set-log-prop ACCESS max-file-count:100</userinput>
# <userinput>dsconf set-log-prop ACCESS max-size:500M</userinput>
# <userinput>dsconf set-log-prop ACCESS min-free-disk-space:500M</userinput></screen>
</step><step><para>Configure the audit logs.</para><screen># <userinput>dsconf set-log-prop AUDIT max-age:3M</userinput>
# <userinput>dsconf set-log-prop AUDIT max-disk-space-size:20000M</userinput>
# <userinput>dsconf set-log-prop AUDIT max-file-count:100</userinput>
# <userinput>dsconf set-log-prop AUDIT max-size:500M</userinput>
# <userinput>dsconf set-log-prop AUDIT min-free-disk-space:500M</userinput>
# <userinput>dsconf set-log-prop AUDIT rotation-interval:1d</userinput></screen><para>By default, the rotation interval for audit logs is one week.</para>
</step><step><para>Configure the error logs.</para><para>In this configuration, you
specify additional data to be collected in the error log.</para><screen># <userinput>dsconf set-log-prop ERROR max-age:3M</userinput>
# <userinput>dsconf set-log-prop ERROR max-disk-space-size:20000M</userinput>
# <userinput>dsconf set-log-prop ERROR max-file-count:30</userinput>
# <userinput>dsconf set-log-prop ERROR max-size:500M</userinput>
# <userinput>dsconf set-log-prop ERROR min-free-disk-space:500M</userinput>
# <userinput>dsconf set-log-prop ERROR verbose-enabled:on</userinput></screen>
</step><step performance="optional"><para>Further configure the logs.</para><para>You
can also configure the following settings for each log:</para><screen># dsconf set-log-prop <replaceable>LOG_TYPE</replaceable> rotation-min-file-size:<replaceable>undefined</replaceable>
# dsconf set-log-prop <replaceable>LOG_TYPE</replaceable> rotation-time:<replaceable>undefined</replaceable></screen><para>For information about the <command>dsconf</command> command, see the <command>dsconf</command>(1M) man page.</para>
</step>
</procedure>
</task><task id="txldap-10"><title>Configure a Multilevel Port for the Sun Java System Directory Server</title><indexterm><primary>LDAP server</primary><secondary>configuring multilevel port</secondary>
</indexterm><tasksummary><para>To work in Trusted Extensions, the server port of the Directory Server must
be configured as a multilevel port (MLP) in the global zone.</para>
</tasksummary><procedure><step><para>Start the Solaris Management Console.</para><screen># <userinput>/usr/sbin/smc &amp;</userinput></screen>
</step><step><para>Select the This Computer (<replaceable>this-host</replaceable>: <literal>Scope=Files, Policy=TSOL</literal>) toolbox.</para>
</step><step><para>Click System Configuration, then click Computers and Networks.</para><para>You are prompted for your password.</para>
</step><step><para>Type the appropriate password.</para>
</step><step><para>Double-click Trusted Network Zones.</para>
</step><step><para>Double-click the global zone.</para>
</step><step><para>Add a multilevel port for the TCP protocol:</para><substeps><step><para>Click Add for the Multilevel Ports for Zone's IP Addresses.</para>
</step><step><para>Type 389 for the port number, and click OK.</para>
</step>
</substeps>
</step><step><para>Add a multilevel port for the UDP protocol:</para><substeps><step><para>Click Add for the Multilevel Ports for Zone's IP Addresses.</para>
</step><step><para>Type 389 for the port number.</para>
</step><step><para>Choose the udp protocol, and click OK.</para>
</step>
</substeps>
</step><step><para>Click OK to save the settings.</para>
</step><step><para>Update the kernel.</para><screen># <userinput>tnctl -fz /etc/security/tsol/tnzonecfg</userinput></screen>
</step>
</procedure>
</task><task id="txldap-2"><title>Populate the Sun Java System Directory Server</title><indexterm><primary>Trusted Extensions configuration</primary><secondary>adding network databases to LDAP server</secondary>
</indexterm><indexterm><primary>adding</primary><secondary>network databases to LDAP server</secondary>
</indexterm><tasksummary><para>Several LDAP databases have been created or modified to hold Trusted Extensions data
about label configuration, users, and remote systems. In this procedure, you
populate the Directory Server databases with Trusted Extensions information.</para>
</tasksummary><taskprerequisites><itemizedlist><para><indexterm><primary>separation of duty</primary><secondary>planning for LDAP</secondary></indexterm><indexterm><primary>LDAP server</primary><secondary>planning for separation of duty</secondary></indexterm>If site
security requires <olink targetptr="glossary-148" remap="internal">separation of duty</olink>,
complete the following before populating the Directory server:</para><listitem><para><olink targetptr="txconf-95" remap="internal">Create Rights Profiles That Enforce
Separation of Duty</olink></para>
</listitem><listitem><para><olink targetptr="txconf-23" remap="internal">Create the Security Administrator
Role in Trusted Extensions</olink></para>
</listitem><listitem><para><olink targetptr="txconf-97" remap="internal">Create a Restricted System Administrator
Role</olink></para>
</listitem>
</itemizedlist>
</taskprerequisites><procedure><step><para><indexterm><primary>directories</primary><secondary>for naming service setup</secondary></indexterm>Create a staging area for files that
you plan to use to populate the naming service databases.</para><screen># <userinput>mkdir -p /setup/files</userinput></screen>
</step><step><para>Copy the sample <filename class="directory">/etc</filename> files
into the staging area.</para><screen># <userinput>cd /etc</userinput>
# <userinput>cp aliases group networks netmasks protocols /setup/files</userinput>
# <userinput>cp rpc services auto_master /setup/files</userinput>

# <userinput>cd /etc/security</userinput>
# <userinput>cp auth_attr prof_attr exec_attr /setup/files/</userinput>
#
# <userinput>cd /etc/security/tsol</userinput>
# <userinput>cp tnrhdb tnrhtp /setup/files</userinput></screen><screen># <userinput>cd /etc/inet</userinput>
# <userinput>cp ipnodes /setup/files</userinput></screen>
</step><step><para>Remove the <literal>+auto_master</literal> entry from the <filename>/setup/files/auto_master</filename> file.</para>
</step><step><para>Remove the <literal>?:::::?</literal> entry from the <filename>/setup/files/auth_attr</filename> file.</para>
</step><step><para>Remove
the <literal>::::</literal> entry from the <filename>/setup/files/prof_attr</filename> file.</para>
</step><step><para>Create the zone automaps in the staging area.</para><itemizedlist><para>In the following list of automaps, the first of each pair of lines shows
the name of the file. The second line of each pair shows the file contents.
The zone names identify labels from the default <filename>label_encodings</filename> file
that is included with the Trusted Extensions software.</para><listitem><para>Substitute your zone names for the zone names in these lines.</para>
</listitem><listitem><para><replaceable>myNFSserver</replaceable> identifies the NFS
server for the home directories.</para>
</listitem>
</itemizedlist><screen>/setup/files/auto_home_public
 * <replaceable>myNFSserver</replaceable>_FQDN:/zone/public/root/export/home/&amp;

/setup/files/auto_home_internal
 * <replaceable>myNFSserve</replaceable>r_FQDN:/zone/internal/root/export/home/&amp;

/setup/files/auto_home_needtoknow
 * <replaceable>myNFSserver</replaceable>_FQDN:/zone/needtoknow/root/export/home/&amp;

/setup/files/auto_home_restricted
 * <replaceable>myNFSserver</replaceable>_FQDN:/zone/restricted/root/export/home/&amp;</screen>
</step><step><para>Add every system on the network to the <filename>/setup/files/tnrhdb</filename> file. </para><para>No wildcard mechanism can be used here. The IP address of every
system to be contacted, including the IP addresses of labeled zones, <emphasis>must</emphasis> be in this file.</para><substeps><step><para>Open the trusted editor and edit <filename>/setup/files/tnrhdb</filename>.</para>
</step><step><para>Add every IP address on a labeled system in the Trusted Extensions domain.</para><para>Labeled systems are of type <literal>cipso</literal>. Also, the
name of the security template for labeled systems is <literal>cipso</literal>.
Therefore, in the default configuration, a <literal>cipso</literal> entry
is similar to the following:</para><screen>192.168.25.2:cipso</screen><note><para>This list includes the IP addresses of global zones and labeled
zones.</para>
</note>
</step><step><para>Add every unlabeled system with which the domain can communicate.</para><para>Unlabeled systems are of type <literal>unlabeled</literal>. The name
of the security template for unlabeled systems is <literal>admin_low</literal>.
Therefore, in the default configuration, an entry for an unlabeled system
is similar to the following:</para><screen>192.168.35.2:admin_low</screen>
</step><step><para>Save the file, and exit the editor.</para>
</step><step><para>Check the syntax of the file.</para><screen># <userinput>tnchkdb -h /setup/files/tnrhdb</userinput></screen>
</step><step><para>Fix any errors before continuing.</para>
</step>
</substeps>
</step><step><para>Copy the <filename>/setup/files/tnrhdb</filename> file to the <filename>/etc/security/tsol/tnrhdb</filename> file.</para>
</step><step id="nisp-step-64"><para>Use the <command>ldapaddent</command> command
to populate every file in the staging area.</para><screen># <userinput>/usr/sbin/ldapaddent -D "cn=directory manager" \
-w dirmgr123 -a simple -f /setup/files/hosts hosts</userinput></screen>
</step>
</procedure>
</task>
</sect1><sect1 id="txconf-37"><title>Creating a Trusted Extensions Proxy for
an Existing Sun Java System Directory Server</title><indexterm><primary>LDAP server</primary><secondary>configuring proxy for Trusted Extensions clients</secondary>
</indexterm><indexterm><primary>configuring</primary><secondary>LDAP proxy server for Trusted Extensions clients</secondary>
</indexterm><para>First, you need to add the Trusted Extensions databases to the existing
Directory Server on a Solaris system. Second, to enable Trusted Extensions systems
to access the Directory Server, you then need to configure a Trusted Extensions system
to be the LDAP proxy server.</para><task id="txldap-6"><title>Create an LDAP Proxy Server</title><indexterm><primary>LDAP server</primary><secondary>creating proxy for Trusted Extensions clients</secondary>
</indexterm><indexterm><primary>creating</primary><secondary>LDAP proxy server for Trusted Extensions clients</secondary>
</indexterm><tasksummary><para>If an LDAP server already exists at your site, create a proxy server
on a Trusted Extensions system.</para>
</tasksummary><taskprerequisites><para>You have added the databases that contain Trusted Extensions information
to the LDAP server. For details, see <olink targetptr="txldap-2" remap="internal">Populate
the Sun Java System Directory Server</olink>.</para>
</taskprerequisites><procedure><step><para>On a system that is configured with Trusted Extensions, create a proxy
server.</para><para>For details, see <olink targetdoc="sysadv5" targetptr="clientsetup-1" remap="external">Chapter 12, <citetitle remap="chapter">Setting Up LDAP Clients (Tasks),</citetitle> in <citetitle remap="book">System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</citetitle></olink>.</para>
</step><step><para>Verify that the Trusted Extensions databases can be viewed by the
proxy server.</para><screen># <userinput>ldaplist -l</userinput> <replaceable>database</replaceable></screen>
</step>
</procedure><taskrelated role="troubleshooting"><para>For strategies to solve LDAP configuration problems, see <olink targetdoc="group-sa" targetptr="setupproblems-1" remap="external">Chapter 13, <citetitle remap="chapter">LDAP Troubleshooting (Reference),</citetitle> in <citetitle remap="book">System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</citetitle></olink>.</para>
</taskrelated>
</task>
</sect1><sect1 id="confsys-10"><title>Configuring the Solaris Management Console for LDAP (Task Map)</title><indexterm><primary>Solaris Management Console</primary><secondary>working with Sun Java System Directory Server</secondary>
</indexterm><indexterm><primary>Solaris Management Console</primary><secondary>configuring for LDAP</secondary>
</indexterm><indexterm><primary>configuring</primary><secondary>Solaris Management Console for LDAP</secondary>
</indexterm><indexterm><primary>tasks and task maps</primary><secondary>Configuring the Solaris Management Console for LDAP (Task Map)</secondary>
</indexterm><indexterm><primary>Configuring the Solaris Management Console for LDAP (Task Map)</primary>
</indexterm><para>The Solaris Management Console is the GUI for administering the network of systems that are
running Trusted Extensions.</para><informaltable frame="topbot" pgwide="1"><tgroup cols="3" colsep="1" rowsep="1"><colspec colname="colspec2" colwidth="21.13*"/><colspec colname="colspec1" colwidth="44.28*"/><colspec colname="colspec0" colwidth="33.56*"/><thead><row><entry><para>Task</para>
</entry><entry><para>Description</para>
</entry><entry><para>For Instructions</para>
</entry>
</row>
</thead><tbody><row><entry><para>Initialize the Solaris Management Console.</para>
</entry><entry><para>Initialize the Solaris Management Console. This procedure is performed once per system in
the global zone.</para>
</entry><entry><para><olink targetptr="confsys-21" remap="internal">Initialize the Solaris Management Console
Server in Trusted Extensions</olink></para>
</entry>
</row><row><entry><para>Register credentials.</para>
</entry><entry><para>Authenticate the Solaris Management Console with the LDAP server.</para>
</entry><entry><para><olink targetptr="txldap-11" remap="internal">Register LDAP Credentials With the Solaris
Management Console</olink></para>
</entry>
</row><row><entry><para>Enable remote administration on a system.</para>
</entry><entry><para>By default, a Solaris Management Console client cannot communicate with a Console server
on another system. You must explicitly enable remote administration.</para>
</entry><entry><para><olink targetptr="txldap-19" remap="internal">Enable the Solaris Management Console to
Accept Network Communications</olink></para>
</entry>
</row><row><entry><para>Create the LDAP toolbox.</para>
</entry><entry><para>Create the LDAP toolbox in the Solaris Management Console for Trusted Extensions.</para>
</entry><entry><para><olink targetptr="txldap-7" remap="internal">Edit the LDAP Toolbox in the Solaris Management
Console</olink></para>
</entry>
</row><row><entry><para>Verify communications.</para>
</entry><entry><para>Verify that Trusted Extensions hosts can become LDAP clients.</para>
</entry><entry><para><olink targetptr="txldap-9" remap="internal">Verify That the Solaris Management Console
Contains Trusted Extensions Information</olink></para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable><task id="txldap-11"><title>Register LDAP Credentials With the Solaris Management Console</title><indexterm><primary>credentials</primary><secondary>registering LDAP with the Solaris Management Console</secondary>
</indexterm><indexterm><primary>registering</primary><secondary>LDAP credentials with the Solaris Management Console</secondary>
</indexterm><indexterm><primary>Solaris Management Console</primary><secondary>registering LDAP credentials</secondary>
</indexterm><indexterm><primary>LDAP server</primary><secondary>registering credentials with Solaris Management Console</secondary>
</indexterm><indexterm><primary>toolboxes</primary><secondary>Scope=LDAP</secondary>
</indexterm><taskprerequisites><para>You must be the <literal>root</literal> user on an LDAP server that
is running Trusted Extensions. The server can be a proxy server.</para><itemizedlist><para>Your Sun Java System Directory Server must be configured. You have completed one of the following
configurations:</para><listitem><para><olink targetptr="txldap-16" remap="internal">Configuring an LDAP Server on
a Trusted Extensions Host (Task Map)</olink></para>
</listitem><listitem><para><olink targetptr="txldap-18" remap="internal">Configuring an LDAP Proxy Server
on a Trusted Extensions Host (Task Map)</olink></para>
</listitem>
</itemizedlist>
</taskprerequisites><procedure><step><para>Register the LDAP administrative credentials.</para><screen><replaceable>LDAP-Server</replaceable> # <userinput>/usr/sadm/bin/dtsetup storeCred</userinput>
Administrator DN:<lineannotation>Type the value for cn on your system</lineannotation>
Password:<lineannotation>Type the Directory Manager password</lineannotation>
Password (confirm):<lineannotation>Retype the password</lineannotation></screen>
</step><step><para>List the scopes on the Directory Server.</para><screen><replaceable>LDAP-Server</replaceable> # <userinput>/usr/sadm/bin/dtsetup scopes</userinput>
Getting list of manageable scopes...
Scope 1 file:<lineannotation>Displays name of file scope</lineannotation>
Scope 2 ldap:<lineannotation>Displays name of ldap scope</lineannotation></screen><para>Your LDAP server setup determines the scopes that are listed. The LDAP
scope is not listed until the LDAP toolbox is edited. The toolbox cannot be
edited until after the server is registered.</para>
</step>
</procedure><example id="txldap-ex-cred-1"><title>Registering LDAP Credentials</title><para>In this example, the name of the LDAP server is <literal>LDAP1</literal> and
the value for <literal>cn</literal> is the default, <literal>Directory Manager</literal>.</para><screen># <userinput>/usr/sadm/bin/dtsetup storeCred</userinput>
Administrator DN:<userinput>cn=Directory Manager</userinput>
Password:<userinput>abcde1;!</userinput>
Password (confirm):<userinput>abcde1;!</userinput>
# <userinput>/usr/sadm/bin/dtsetup scopes</userinput>
Getting list of manageable scopes...
Scope 1 file:/LDAP1/LDAP1
Scope 2 ldap:/LDAP1/cd=LDAP1,dc=example,dc=com</screen>
</example>
</task><task id="txldap-19"><title>Enable the Solaris Management Console to Accept Network Communications</title><indexterm><primary>LDAP</primary><secondary>enabling administration from a client</secondary>
</indexterm><indexterm><primary>enabling</primary><secondary>LDAP administration from a client</secondary>
</indexterm><indexterm><primary><literal>tcp_listen=true</literal> LDAP setting</primary>
</indexterm><indexterm><primary>Solaris Management Console</primary><secondary>enabling LDAP toolbox to be used</secondary>
</indexterm><tasksummary><para>By default, Solaris systems are not configured to listen on ports
that present security risks. Therefore, you must explicitly configure any
system that you plan to administer remotely to accept network communications.
For example, to administer network databases on the LDAP server from a client,
the Solaris Management Console server on the LDAP server must accept network communications.</para><para>For an illustration of the Solaris Management Console configuration requirements for a network
with an LDAP server, see <olink targetptr="txtool-16" remap="internal">Client-Server Communication With the Solaris Management Console</olink>.</para>
</tasksummary><taskprerequisites><para>You must be superuser in the global zone on the Solaris Management Console server system.
In this procedure, that system is called the remote system. Also, you must
have command line access to the client system as superuser.</para>
</taskprerequisites><procedure><step><para>On the remote system, enable the system to accept remote connections.</para><para>The <command>smc</command> daemon is controlled by the <literal>wbem</literal> service. If the <literal>options/tcp_listen</literal> property
to the <literal>wbem</literal> service is set to <literal>true</literal>,
the Solaris Management Console server accepts remote connections.</para><screen># <userinput>/usr/sbin/svcprop -p options wbem</userinput>
options/tcp_listen boolean false
# <userinput>svccfg -s wbem setprop options/tcp_listen=true</userinput></screen>
</step><step><para>Refresh and restart the <command>wbem</command> service.</para><screen># <userinput>svcadm refresh wbem</userinput>
# <userinput>svcadm restart wbem</userinput></screen>
</step><step><para>Verify that the <literal>wbem</literal> service is set to accept
remote connections.</para><screen># <userinput>svcprop -p options wbem</userinput>
options/tcp_listen boolean true</screen>
</step><step><para>On the remote system and on any client that needs to access the Solaris Management Console,
ensure that remote connections are enabled in the <filename>smcserver.config</filename> file.</para><substeps><step><para>Open the <filename>smcserver.config</filename> file in the trusted
editor.</para><screen># <userinput>/usr/dt/bin/trusted_edit /etc/smc/smcserver.config</userinput></screen>
</step><step><para>Set the <literal>remote.connections</literal> parameter to <literal>true</literal>.</para><screen>## remote.connections=false
<userinput>remote.connections=true</userinput></screen>
</step><step><para>Save the file and exit the trusted editor.</para>
</step>
</substeps>
</step>
</procedure><taskrelated role="troubleshooting"><para>If you restart or enable the <literal>wbem</literal> service, you must
ensure that the <literal>remote.connections</literal> parameter in the <filename>smcserver.config</filename> file remains set to <literal>true</literal>.</para>
</taskrelated>
</task><task id="txldap-7"><title>Edit the LDAP Toolbox in the Solaris Management Console</title><indexterm><primary>toolboxes</primary><secondary>adding LDAP server to <filename>tsol_ldap.tbx</filename></secondary>
</indexterm><indexterm><primary>adding</primary><secondary>LDAP toolbox</secondary>
</indexterm><indexterm><primary>creating</primary><secondary>LDAP toolbox</secondary>
</indexterm><indexterm><primary><filename>tsol_ldap.tbx</filename> file</primary>
</indexterm><indexterm><primary>Solaris Management Console</primary><secondary>configuring LDAP toolbox</secondary>
</indexterm><taskprerequisites><para>You must be superuser on the LDAP server. The LDAP credentials must
be registered with the Solaris Management Console, and you must know the output of the <command>/usr/sadm/bin/dtsetup
scopes</command> command. For details, see <olink targetptr="txldap-11" remap="internal">Register
LDAP Credentials With the Solaris Management Console</olink>.</para>
</taskprerequisites><procedure><step><para>Find the LDAP toolbox.</para><screen># <userinput>cd /var/sadm/smc/toolboxes/tsol_ldap</userinput>
# <userinput>ls *tbx</userinput>
tsol_ldap.tbx</screen>
</step><step><para>Provide the LDAP server name.</para><substeps><step><para>Open the trusted editor.</para>
</step><step><para>Copy and paste the full pathname of the <filename>tsol_ldap.tbx</filename> toolbox
as the argument to the editor.</para><para>For example, the following path
is the default location of the LDAP toolbox:</para><screen>/var/sadm/smc/toolboxes/tsol_ldap/tsol_ldap.tbx</screen>
</step><step><para>Replace the scope information.</para><para>Replace the <literal>server</literal> tags between the <literal>&lt;Scope&gt;</literal> and <literal>&lt;/Scope&gt;</literal> tags with the output of the <literal>ldap:/......</literal> line
from the <command>/usr/sadm/bin/dtsetup scopes</command> command.</para><screen>&lt;Scope&gt;ldap:/&lt;<replaceable>ldap-server-name</replaceable>&gt;/&lt;dc=<replaceable>domain</replaceable>,dc=<replaceable>suffix</replaceable>&gt;&lt;/Scope&gt;</screen>
</step><step><para>Replace every instance of <literal>&lt;?server?&gt;</literal> or <literal>&lt;?server ?&gt;</literal> with the LDAP server.</para><screen>&lt;Name&gt;This Computer (<replaceable>ldap-server-name</replaceable>: Scope=ldap, Policy=TSOL)&lt;/Name&gt;
services and configuration of <replaceable>ldap-server-name</replaceable>.&lt;/Description&gt;
and configuring <replaceable>ldap-server-name</replaceable>.&lt;/Description&gt;
...</screen>
</step><step><para>Save the file, and exit the editor.</para>
</step>
</substeps>
</step><step><para>Refresh and restart the <command>wbem</command> service.</para><screen># <userinput>svcadm refresh wbem</userinput>
# <userinput>svcadm restart wbem</userinput></screen>
</step>
</procedure><example id="txldap-17"><title>Configuring the LDAP Toolbox</title><para>In this example, the name of the LDAP server is <literal>LDAP1</literal>.
To configure the toolbox, the administrator replaces the instances of <literal>&lt;?server
?&gt;</literal> with <literal>LDAP1</literal>.</para><screen># <userinput>cd /var/sadm/smc/toolboxes/tsol_ldap</userinput>
# <userinput>/usr/dt/bin/trusted_edit /tsol_ldap.tbx</userinput>
&lt;Scope&gt;ldap:<userinput>/LDAP1/cd=LDAP1,dc=example,dc=com</userinput>&lt;/Scope

...
&lt;Name&gt;This Computer (<userinput>LDAP1</userinput>: Scope=ldap, Policy=TSOL)&lt;/Name&gt;
services and configuration of <userinput>LDAP1</userinput>.&lt;/Description&gt;
and configuring <userinput>LDAP1</userinput>.&lt;/Description&gt;
...</screen>
</example>
</task><task id="txldap-9"><title>Verify That the Solaris Management Console Contains Trusted Extensions Information</title><tasksummary><para>For an illustration of the Solaris Management Console configuration requirements for a network
with an LDAP server and for a network without an LDAP server, see <olink targetptr="txtool-16" remap="internal">Client-Server Communication With the Solaris Management Console</olink>.</para>
</tasksummary><taskprerequisites><para>You must be logged in to an LDAP client in an administrative role, or
as superuser. To make a system an LDAP client, see <olink targetptr="txldap-8" remap="internal">Make
the Global Zone an LDAP Client in Trusted Extensions</olink>.</para><para>To administer the local system, you must have completed <olink targetptr="confsys-21" remap="internal">Initialize the Solaris Management Console Server in
Trusted Extensions</olink>.</para><para>To connect to a Console server on a remote system from the local system,
you must have completed <olink targetptr="confsys-21" remap="internal">Initialize the Solaris
Management Console Server in Trusted Extensions</olink> on both systems. Also,
on the remote system, you must have completed <olink targetptr="txldap-19" remap="internal">Enable
the Solaris Management Console to Accept Network Communications</olink>.</para><para>To administer the databases in the LDAP naming service from the LDAP
client, on the LDAP server you must have completed <olink targetptr="txldap-7" remap="internal">Edit
the LDAP Toolbox in the Solaris Management Console</olink>, in addition to
the preceding procedures.</para>
</taskprerequisites><procedure><step><para>Start the Solaris Management Console.</para><screen># <userinput>/usr/sbin/smc &amp;</userinput></screen>
</step><step><para>Open a Trusted Extensions toolbox.</para><para>A Trusted Extensions toolbox
has the value <literal>Policy=TSOL</literal>.</para><stepalternatives><step><para>On a trusted network that uses LDAP as a naming service, perform
the following tests:</para><substeps><step><para>To check that local administrative databases can be accessed,
open the following toolbox:</para><screen>This Computer (<replaceable>this-host</replaceable>: <literal>Scope=Files, Policy=TSOL</literal>)</screen>
</step><step><para>To check that the LDAP server's local administrative databases
can be accessed, specify the following toolbox:</para><screen>This Computer (<replaceable>ldap-server</replaceable>: <literal>Scope=Files, Policy=TSOL</literal>)</screen>
</step><step><para>To check that the naming service databases on the LDAP server
can be accessed, specify the following toolbox:</para><screen>This Computer (<replaceable>ldap-server</replaceable>: <literal>Scope=LDAP, Policy=TSOL</literal>)</screen>
</step>
</substeps>
</step><step><para>On a trusted network that does not use LDAP as a naming service,
perform the following tests:</para><substeps><step><para>To check that local administrative databases can be accessed,
open the following toolbox:</para><screen>This Computer (<replaceable>this-host</replaceable>: <literal>Scope=Files, Policy=TSOL</literal>)</screen>
</step><step><para>To check that a remote system's local administrative databases
can be accessed, specify the following toolbox:</para><screen>This Computer (<replaceable>remote-system</replaceable>: <literal>Scope=Files, Policy=TSOL</literal>)</screen>
</step>
</substeps>
</step>
</stepalternatives>
</step><step><para>Under System Configuration, navigate to Computers and Networks,
then Security Templates.</para>
</step><step><para>Check that the correct templates and labels have been applied
to the remote systems.</para>&noteldapsvr;
</step>
</procedure><taskrelated role="troubleshooting"><para>To troubleshoot LDAP configuration, see <olink targetdoc="group-sa" targetptr="setupproblems-1" remap="external">Chapter 13, <citetitle remap="chapter">LDAP Troubleshooting (Reference),</citetitle> in <citetitle remap="book">System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</citetitle></olink>.</para>
</taskrelated>
</task>
</sect1>
</chapter><?Pub *0000046276 0?>