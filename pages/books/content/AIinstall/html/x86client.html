<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">

<!--   The contents of this Documentation are subject to the Public Documentation
License Version 1.01 (the "License"); you may only use this Documentation if
you comply with the terms of this License. A copy of the License is
available at http://www.opensolaris.org/os/community/documentation/license.
  -->
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>x86 Client Installations - OpenSolaris Automated Installer Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2009-06-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/opensol.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.com"><img border="0" src="graphics/opensolaris_logo_trans.png"></img></a>
   </div>
   <div class="Title">OpenSolaris Automated Installer Guide</div>
</div>
<div class="headerbar"></div>


<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="sparcclient.html">Previous</a>
             </td>
             <td align="right">
                 <a href="bothclient.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="index.html">1.&nbsp;&nbsp;Introduction to the Automated Installer</a></p>
<p class="toc level1 tocsp"><a href="tasks.html">2.&nbsp;&nbsp;Automated Installer Task Map</a></p>
<p class="toc level1 tocsp"><a href="setup.html">3.&nbsp;&nbsp;Automated Installer Setup Instructions</a></p>
<p class="toc level1 tocsp"><a href="administer.html">4.&nbsp;&nbsp;How to Administer an Automated Install Server</a></p>
<p class="toc level1 tocsp"><a href="client.html">5.&nbsp;&nbsp;How to Administer a Custom Install Client</a></p>
<p class="toc level1 tocsp"><a href="manifest.html">6.&nbsp;&nbsp;How to Administer the Manifest Files for an Install Service</a></p>
<p class="toc level1 tocsp"><a href="clients.html">7.&nbsp;&nbsp;How to Manage Client Installations</a></p>
<p class="toc level2"><a href="clientreq.html">Client System Requirements</a></p>
<p class="toc level2"><a href="sparcclient.html">SPARC Client Installations</a></p>
<div class="onpage">
<p class="toc level2"><a href="">x86 Client Installations</a></p>
</div>
<p class="toc level2"><a href="bothclient.html">SPARC and x86 Client Installation Messages and Errors</a></p>
<p class="toc level1 tocsp"><a href="trouble.html">8.&nbsp;&nbsp;Troubleshooting and FAQs for the Automated Installer</a></p>
<p class="toc level1 tocsp"><a href="appendix.html">9.&nbsp;&nbsp;Appendix</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="x86client"></a><h3>x86 Client Installations</h3>
<p>Review the following information about x86 client installations:</p>
<ul><li><p><a href="#x86boot">What Happens During the x86 Client Boot Sequence?</a></p></li>
<li><p><a href="#x86boot2">What Should I see During the x86 Client AI Boot Sequence?</a></p></li>
<li><p><a href="#x86err">x86 Booting Errors and Possible Causes</a></p></li></ul>


<a name="x86boot"></a><h4>What Happens During the x86 Client Boot Sequence?</h4>
<p>Boot the client from the network. For x86 clients, select the network device
to boot from.</p>
<hr><p><b>Note - </b>It may be necessary to modify the BIOS configuration to select network booting.</p>
<hr>
<p>The technical details of what occurs during the automated installer (AI) boot of
an x86 client are as follows:</p>
<ol><li><p>The client boots and gets an IP address and the bootfile, <tt>pxegrub</tt>, from the DHCP server.</p></li>
<li><p><tt>pxegrub</tt> is loaded and reads <tt>menu.lst</tt> file by using TFTP.</p></li>
<li><p><tt>pxegrub</tt> gets the <tt>boot_archive</tt> file and Solaris is booted by using TFTP.</p></li>
<li><p>The net image archives, <tt>solaris.zlib</tt> and <tt>solarismisc.zlib</tt>, are downloaded using HTTP.</p></li>
<li><p>The client contacts the install service through the AI HTTP server, and gets the install service by using multicast DNS, a DNS service.</p></li>
<li><p>The client contacts the server, <tt>http server</tt>, by using the information in the install service and gets the AI manifest.</p></li>
<li><p>The AI install program is invoked with the AI manifest to perform the installation.</p></li></ol>


<a name="x86boot2"></a><h4>What Should I see During the x86 Client AI Boot Sequence?</h4>
<p>The x86 client installation is initiated by booting from the network, either by
pressing the appropriate function key, for example, some systems use F12 to boot
from the network, or by changing the boot order in the BIOS.</p><p>The first screen displays the following message when the client receives  the
correct DHCP response:</p><pre>Intel(R) Boot Agent PXE Base Code (PXE-2.1 build 0.86)
Copyright(C) 1997-2007, Intel Corporation

CLIENT MAC ADDR 00 14 4F 29 04 12 GUID FF2000008 FFFF FFFF FFFF 7BDA264F1400
CLIENT IP: 10.6.68.29   MASK: 255.255.255.0    DHCP IP:  10.6.68.49
GATEWAY: 10.6.68.1</pre><p>Next, the display shows the AI image that will be booted. Typically, there
should  be only one entry such as:</p><pre>OpenSolaris 2009.06 snv_111 X86</pre><p>Once the image is selected, the following messages are displayed.</p>
<hr><p><b>Note - </b>The image is selected automatically after a timeout.</p>
<hr>
<pre>SunOS Release 5.11 Version snv_111 64-bit
Copyright 1983-2009 Sun Microsystems, Inc.  All rights reserved.
Use is subject to license terms.
Hostname: opensolaris
Remounting root read/write
Probing for device nodes ...
Preparing automated install image for use
Downloading solaris.zlib archive
--11:09:11--  http://10.6.35.226:5555//export/home \
/images/osol-0906-ai-x86//solaris.zlib
           =&gt; `/tmp/solaris.zlib'
Connecting to 10.6.35.226:5555... connected.
HTTP request sent, awaiting response... 200 OK
Length: 82,679,296 (79M) [text/plain]

100%[====================================&gt;] 82,679,296    33.39M/s             

11:09:13 (33.36 MB/s) - `/tmp/solaris.zlib' saved [82679296/82679296]

Downloading solarismisc.zlib archive
--11:09:13--  http://10.6.35.226:5555//export/home/images \
/osol-0906-ai-x86//solarismisc.zlib
           =&gt; `/tmp/solarismisc.zlib'
Connecting to 10.6.35.226:5555... connected.
HTTP request sent, awaiting response... 200 OK
Length: 620,032 (606K) [text/plain]

100%[====================================&gt;] 620,032       --.--K/s             

11:09:13 (36.48 MB/s) - `/tmp/solarismisc.zlib' saved [620032/620032]

--11:09:13--  http://10.6.35.226:5555//export/home/images/ \
osol-0906-ai-x86//install.conf
           =&gt; `/tmp/install.conf'
Connecting to 10.6.35.226:5555... connected.
HTTP request sent, awaiting response... 200 OK
Length: 39 [text/plain]

100%[====================================&gt;] 39            --.--K/s             

11:09:13 (953.58 KB/s) - `/tmp/install.conf' saved [39/39]

Done mounting automated install image
Configuring devices.
Reading ZFS config: done.

Automated Installation started
The progress of the Automated Installation can be followed by 
viewing the logfile at /tmp/install_log</pre>

<a name="x86err"></a><h4>x86 Booting Errors and Possible Causes</h4>
<p>Review the following information about x86 booting errors:</p><p><a href="#nodhcp">1. No DHCP or ProxyDHCP Offers Were Received</a></p><p><a href="#violation">2. TFTP Error or System Hangs After GATEWAY Message</a></p><p><a href="#hangs">3. System Hangs After GRUB Menu Entry is Selected</a></p><p><a href="#forbid2">4. HTTP Request Sent Results in 403 Forbidden</a></p>

<a name="nodhcp"></a><h5>1. No DHCP or ProxyDHCP Offers Were Received</h5>
<p>If a DHCP server is not responding to an x86 client's request,
you see the following messages:</p><pre>Intel(R) Boot Agent PXE Base Code (PXE-2.1 build 0.86)
   Copyright(C) 1997-2007, Intel Corporation

   CLIENT MAC ADDR 00 14 4F 29 04 12 GUID FF2000008 FFFF FFFF FFFF 7BDA264F1400
   DHCP......... No DHCP or ProxyDHCP offers were received
   PXE-MOF: Exiting Intel Boot Agent</pre><p>The timeout message indicates that the client is sending a DHCP request and
not getting a response. This issue is probably due to an error
in the DHCP configuration. Check to see if your client is configured correctly
in the DHCP server.</p>

<a name="violation"></a><h5>2. TFTP Error or System Hangs After GATEWAY Message</h5>
<p>The DHCP server provides an IP address and a location of the
initial boot program as part of the DHCP response.</p>
<ul><li><p>If the boot program doesn't exist, then the AI client boot cannot proceed. The following message displays:</p><pre>Intel(R) Boot Agent PXE Base Code (PXE-2.1 build 0.86)
     Copyright(C) 1997-2007, Intel Corporation

     CLIENT MAC ADDR 00 14 4F 29 04 12 GUID FF2000008 FFFF FFFF FFFF 7BDA264F1400
     CLIENT IP: 10.6.68.29   MASK: 255.255.255.0    DHCP IP:  10.6.68.49
     GATEWAY: 10.6.68.1
     TFTP.
     PXE-T02:    Access Violation
     PXE-E3C: TFTP Error - Access violation
     PXE-MOF: Exiting Intel Boot Agent</pre></li>
<li><p>If the boot program exists, but it's an incorrect program, the AI client hangs after displaying this message:</p><pre>Intel(R) Boot Agent PXE Base Code (PXE-2.1 build 0.86)
     Copyright(C) 1997-2007, Intel Corporation

     CLIENT MAC ADDR 00 14 4F 29 04 12 GUID FF2000008 FFFF FFFF FFFF 7BDA264F1400
     CLIENT IP: 10.6.68.29   MASK: 255.255.255.0    DHCP IP:  10.6.68.49
     GATEWAY: 10.6.68.1</pre></li></ul>


<a name="hangs"></a><h5>3. System Hangs After GRUB Menu Entry is Selected</h5>
<p>If the client is able to do the initial boot, but the
OpenSolaris kernel cannot be booted, the system hangs after the user selects the
entry from the GRUB menu.</p><p>On the install server, check whether the <tt>menu.lst</tt> file for this client
is pointing to a valid boot archive. The boot directory of the image
on the server should be loop-back mounted under the<tt> /tftpboot</tt> directory as shown
in this snippet from <tt>df -k</tt>:</p><pre><tt>/export/home/images/osol-0906-ai-x86/boot</tt> \
<tt>60450439 21678071 38772368 36% /tftpboot/I86PC.OpenSolaris-12</tt></pre><p>If you know the name of the target directory that you used
in the <tt>installadm create-service</tt> command, then you can use that information to find out
whether that target directory is mounted. Also, check whether you can access the
<tt>/tftpboot/I86PC.OpenSolaris-12/boot_archive</tt> file.</p>

<a name="forbid2"></a><h5>4. HTTP Request Sent Results in 403 Forbidden</h5>
<p>On the install server, if one of the install programs doesn't exist in
the location specified in the<tt> menu.lst</tt> file under <tt>/tftpboot</tt>, then the client is
able to boot, but is not able to download that file. An error
message is displayed indicating which file is causing the problem. For example, in
the output below, the <tt>solaris.zlib</tt> file does not exist at the specified
location.</p><pre>SunOS Release 5.11 Version snv_111 64-bit
   Copyright 1983-2009 Sun Microsystems, Inc.  All rights reserved.
   Use is subject to license terms.
   Hostname: opensolaris
   Remounting root read/write
   Probing for device nodes ...
   Preparing automated install image for use
   Downloading solaris.zlib archive
   --15:40:37--  http://10.6.35.226:5555//export/home/images/ai_x86_111/solaris.zlib
           =&gt; `/tmp/solaris.zlib'
   Connecting to 10.6.35.226:5555... connected.
   HTTP request sent, awaiting response... 403 Forbidden
   15:40:37 ERROR 403: Forbidden.

   FAILED
   Requesting System Maintenance Mode
   (See /lib/svc/share/README for more information.)
   Console login service(s) cannot run</pre><p>Check the contents of the target directory that you specified when you ran
the <tt>installadm create-service</tt> command.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="sparcclient.html">Previous</a>
             </td>
             <td align="right">
                 <a href="bothclient.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

