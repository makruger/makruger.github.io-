<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Overview of the nss_ad Naming Service Module - System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2009-01-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ghnov.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ghnqm.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="intro-1.html">Part&nbsp;I&nbsp;About Naming and Directory Services</a></p>
<p class="toc level2"><a href="intro2ns-2.html">1.&nbsp;&nbsp;Naming and Directory Services (Overview)</a></p>
<p class="toc level2"><a href="a12swit-86415.html">2.&nbsp;&nbsp;The Name Service Switch (Overview)</a></p>
<p class="toc level1 tocsp"><a href="dnsadmin-1.html">Part&nbsp;II&nbsp;DNS Setup and Administration</a></p>
<p class="toc level2"><a href="dnsref-1.html">3.&nbsp;&nbsp;DNS Setup and Administration (Reference)</a></p>
<p class="toc level1 tocsp"><a href="nissetup-1.html">Part&nbsp;III&nbsp;NIS Setup and Administration</a></p>
<p class="toc level2"><a href="anis1-25461.html">4.&nbsp;&nbsp;Network Information Service (NIS) (Overview)</a></p>
<p class="toc level2"><a href="cnis1-25208.html">5.&nbsp;&nbsp;Setting Up and Configuring NIS Service</a></p>
<p class="toc level2"><a href="anis2-22217.html">6.&nbsp;&nbsp;Administering NIS (Tasks)</a></p>
<p class="toc level2"><a href="abtrbl-18694.html">7.&nbsp;&nbsp;NIS Troubleshooting</a></p>
<p class="toc level1 tocsp"><a href="ldapsetup-1.html">Part&nbsp;IV&nbsp;LDAP Naming Services Setup and Administration</a></p>
<p class="toc level2"><a href="overview-1.html">8.&nbsp;&nbsp;Introduction to LDAP Naming Services (Overview/Reference)</a></p>
<p class="toc level2"><a href="ldapsecure-1.html">9.&nbsp;&nbsp;LDAP Basic Components and Concepts (Overview)</a></p>
<p class="toc level2"><a href="planldap-1.html">10.&nbsp;&nbsp;Planning Requirements for LDAP Naming Services (Tasks)</a></p>
<p class="toc level2"><a href="sundssetup-13.html">11.&nbsp;&nbsp;Setting Up Sun Java System Directory Server With LDAP Clients (Tasks)</a></p>
<p class="toc level2"><a href="clientsetup-1.html">12.&nbsp;&nbsp;Setting Up LDAP Clients (Tasks)</a></p>
<p class="toc level2"><a href="setupproblems-1.html">13.&nbsp;&nbsp;LDAP Troubleshooting (Reference)</a></p>
<p class="toc level2"><a href="schemas-1.html">14.&nbsp;&nbsp;LDAP General Reference (Reference)</a></p>
<p class="toc level2"><a href="nis2ldap-34.html">15.&nbsp;&nbsp;Transitioning From NIS to LDAP (Overview/Tasks)</a></p>
<p class="toc level2"><a href="nisplus2ldap-1.html">16.&nbsp;&nbsp;Transitioning From NIS+ to LDAP</a></p>
<p class="toc level1 tocsp"><a href="ghnmu.html">Part&nbsp;V&nbsp;Active Directory Naming Service</a></p>
<p class="toc level2"><a href="ghnov.html">17.&nbsp;&nbsp;Setting Up Solaris Active Directory Clients</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Overview of the <tt>nss_ad</tt> Naming Service Module</a></p>
</div>
<p class="toc level3"><a href="ghnqm.html">Password Updates</a></p>
<p class="toc level3"><a href="ghuiq.html">How the <tt>nss_ad</tt> Naming Service Module Retrieves Data From AD</a></p>
<p class="toc level1 tocsp"><a href="whatsnew-1.html">A.&nbsp;&nbsp;Solaris 10 Software Updates to DNS, NIS, and LDAP</a></p>
<p class="toc level2"><a href="whatsnew-5.html">Service Management Facility Changes</a></p>
<p class="toc level2"><a href="whatsnew-2.html">DNS BIND</a></p>
<p class="toc level2"><a href="schemas-290.html"><tt>pam_ldap</tt> Changes</a></p>
<p class="toc level2"><a href="whatsnew-3.html">Documentation Errors</a></p>
<p class="toc level1 tocsp"><a href="aagloss-87604.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="gentextid-12998"></a><h3>Overview of the <tt>nss_ad</tt> Naming Service Module</h3>
<p><a name="indexterm-603"></a>The Solaris client must be joined to an AD domain before any
of the AD interoperability functionality, including <tt>nss_ad</tt>, can be used. The <tt>kclient</tt> utility is
used to join the client to AD. During the join operation, <tt>kclient</tt> configures Kerberos
v5 on the client. Thereafter, <tt>nss_ad</tt> can be used to resolve naming service
requests by specifying <tt>ad</tt> as a source in the <tt>nsswitch.conf</tt> file for the
supported databases. The <tt>nss_ad</tt> module uses host credentials to look up naming service information
in AD.</p><p>The <tt>nss_ad</tt> module uses DNS server records to auto-discover AD directory servers, such
as domain controllers and global catalog servers. Therefore, DNS must be properly configured
on the Solaris client. The <tt>nss_ad</tt> module also uses the LDAP v3
protocol to access naming information from AD servers. The AD server schema requires
no modification because <tt>nss_ad</tt> works with the native AD schema.</p><p>The <tt>nss_ad</tt> module does not currently support logins of Windows users onto a
Solaris system. Until such logins are supported, such users should continue to log
in by using traditional back ends such as <tt>nis</tt> and <tt>ldap</tt>.</p><p>The <tt>idmap</tt> and <tt>nscd</tt> services must be enabled to use <tt>nss_ad</tt>. The <tt>nss_ad</tt>
module uses the <tt>idmap</tt> service to map between Windows security identifiers (SIDs), Solaris user
identifiers (UIDs), and group identifiers (GIDs).</p><p>Ensure that all AD user and group names are qualified with domain
names such as <tt>user@domain</tt> or <tt>group@domain</tt>. For example, <tt>getpwnam(dana)</tt> will fail, but <tt>getpwnam(dana@domain)</tt> will
succeed, provided that <tt>dana</tt> is a valid Windows user in the domain named
<tt>domain</tt>. </p><p>The following additional rules also pertain to the <tt>nss_ad</tt> module:</p>
<ul><li><p>Like AD, <tt>nss_ad</tt> performs case-insensitive matching of user and group names.</p></li>
<li><p>Only use the <tt>nss_ad</tt> module in UTF-8 locales or in domains where users and groups have only ASCII characters in their names.</p></li>
<li><p>Well-known SIDs are a set of SIDs that identify generic users or generic groups in the Windows world. They are not domain specific and their values remain constant across all Windows operating systems. The names of well-known SIDs are qualified with the string <tt>BUILTIN</tt>, for example, <tt>Remote Desktop Users@BUILTIN</tt>.</p></li>
<li><p>The <tt>nss_ad</tt> module does not support enumeration. Therefore, the <tt>getpwent()</tt> and <tt>getgrent()</tt> interfaces and commands that use them such as <tt>getent passwd</tt> and <tt>getent group</tt> cannot retrieve information from AD.</p></li>
<li><p>The <tt>nss_ad</tt> module currently supports only the <tt>passwd</tt> and <tt>group</tt> files. <tt>nss_ad</tt> does not support other naming service databases that follow the <tt>passwd</tt> entry, such as <tt>audit_user</tt> and <tt>user_attr</tt>. If the <tt>ad</tt> back end is processed (based on the configuration), it returns NOT FOUND for these databases.</p></li></ul>


<a name="gentextid-13061"></a><h4>Configuring the <tt>nss_ad</tt> Naming Service Module</h4>
<p><a name="indexterm-604"></a>The <tt>nss_ad</tt> module requires that the Solaris client use DNS for host resolution.</p>

<a name="ghqce"></a><h5>How to Configure the <tt>nss_ad</tt> Module</h5>
<ol>
<li><b>Edit the <tt>/etc/resolv.conf</tt> file to point to the correct domain, using the correct
search order.</b><p>Pointing to the correct DNS domain and servers in the <tt>/etc/resolv.conf</tt> file usually involves
specifying the domain controller as the DNS server.</p>
<hr><p><b>Note - </b>The AD domain name must be specified in <tt>/etc/resolv.conf</tt> either by means of
the <tt>domain</tt> directive or as the first item in the list specified by
the <tt>search</tt> directive.</p><p>If both directives are specified, then whichever is last takes precedence. This is required
for the <tt>idmap</tt> auto-discovery feature to work properly.</p>
<hr>
<p>In the following example, the AD domain, <tt>ad.example</tt>, is specified by the <tt>domain</tt>
directive. The <tt>dig</tt> commands verify that the AD server, which is specified by
the <tt>nameserver</tt> directive, can be resolved by using its name and IP address.</p><pre><tt><b>% cat /etc/resolv.conf domain ad.example nameserver 192.168.11.22 % dig -x 192.168.11.22 +short myserver.ad.example % dig myserver.ad.example +short 192.168.11.22</b></tt></pre></li>
<li><b>Edit the <tt>etc/nsswitch.conf</tt> file, and add <tt>dns</tt> to the list of naming
services for <tt>hosts</tt> and <tt>ipnodes</tt>. </b><p>For example, the file might look like the following:</p><pre><tt><b>% egrep '^hosts|^ipnodes' /etc/nsswitch.conf hosts: files dns ipnodes: files dns</b></tt></pre>
<hr><p><b>Note - </b>To include additional naming services such as <tt>nis</tt> or <tt>ldap</tt> for host
resolution, add them after <tt>dns</tt> in the <tt>/etc/nsswitch.conf</tt> file.</p>
<hr>
</li>
<li><b>Verify that the DNS service is enabled and online.</b><p>For example:</p><pre><tt><b>% svcs svc:/network/dns/client STATE STIME FMRI online Oct_14 svc:/network/dns/client:default</b></tt></pre></li>
<li><b>Use the <tt>kclient</tt> utility to join the system to the AD domain.</b><p>For example:</p><pre><tt><b>% /usr/sbin/kclient -T ms_ad</b></tt></pre></li>
<li><b>Edit the <tt>nsswitch.conf</tt> file by adding <tt>ad</tt> to <tt>passwd</tt> and <tt>group</tt>.</b><p>For example:</p><pre><tt><b>% egrep '^passwd|^group' /etc/nsswitch.conf passwd: files nis ad group: files nis ad</b></tt></pre>
<hr><p><b>Note - </b><tt>/etc/nsswitch.ad</tt> is a sample configuration file that can be copied to <tt>/etc/nsswitch.conf</tt>. It
uses AD for <tt>passwd</tt> and <tt>group</tt>, DNS for host lookups, and <tt>files</tt> for the
remaining databases. Because the AD naming service is not yet a complete Solaris
solution, add other naming services as appropriate to the <tt>nsswitch.conf</tt> file.</p>
<hr>
</li>
<li><b>Enable the<tt> idmap</tt> service.</b><pre><tt><b>% svcadm enable idmap</b></tt></pre></li>
<li><b>Enable the <tt>nscd</tt> service.</b><pre><tt><b>% svcs name-service-cache STATE STIME FMRI disabled 13:15:48 svc:/system/name-service-cache:default % svcadm enable name-service-cache</b></tt></pre>
<hr><p><b>Note - </b>The <tt>nscd</tt> module automatically restarts whenever <tt>/etc/nsswitch.conf</tt> is changed.</p>
<hr>
</li>
<li><b>Verify that you can access <tt>user</tt> and <tt>group</tt> information from AD.</b><p>For example:</p><pre><tt><b>% getent passwd 'test_user@example' test_user@example:x:2154266625:2154266626:test_user:: % getent passwd 2154266625 test_user@example:x:2154266625:2154266626:test_user::</b></tt></pre></li></ol>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ghnov.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ghnqm.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

