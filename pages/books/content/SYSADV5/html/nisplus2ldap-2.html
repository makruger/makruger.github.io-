<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>NIS+ to LDAP Overview - System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2009-01-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="nisplus2ldap-1.html">Previous</a>
             </td>
             <td align="right">
                 <a href="nisplus2ldap-5.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="intro-1.html">Part&nbsp;I&nbsp;About Naming and Directory Services</a></p>
<p class="toc level2"><a href="intro2ns-2.html">1.&nbsp;&nbsp;Naming and Directory Services (Overview)</a></p>
<p class="toc level2"><a href="a12swit-86415.html">2.&nbsp;&nbsp;The Name Service Switch (Overview)</a></p>
<p class="toc level1 tocsp"><a href="dnsadmin-1.html">Part&nbsp;II&nbsp;DNS Setup and Administration</a></p>
<p class="toc level2"><a href="dnsref-1.html">3.&nbsp;&nbsp;DNS Setup and Administration (Reference)</a></p>
<p class="toc level1 tocsp"><a href="nissetup-1.html">Part&nbsp;III&nbsp;NIS Setup and Administration</a></p>
<p class="toc level2"><a href="anis1-25461.html">4.&nbsp;&nbsp;Network Information Service (NIS) (Overview)</a></p>
<p class="toc level2"><a href="cnis1-25208.html">5.&nbsp;&nbsp;Setting Up and Configuring NIS Service</a></p>
<p class="toc level2"><a href="anis2-22217.html">6.&nbsp;&nbsp;Administering NIS (Tasks)</a></p>
<p class="toc level2"><a href="abtrbl-18694.html">7.&nbsp;&nbsp;NIS Troubleshooting</a></p>
<p class="toc level1 tocsp"><a href="ldapsetup-1.html">Part&nbsp;IV&nbsp;LDAP Naming Services Setup and Administration</a></p>
<p class="toc level2"><a href="overview-1.html">8.&nbsp;&nbsp;Introduction to LDAP Naming Services (Overview/Reference)</a></p>
<p class="toc level2"><a href="ldapsecure-1.html">9.&nbsp;&nbsp;LDAP Basic Components and Concepts (Overview)</a></p>
<p class="toc level2"><a href="planldap-1.html">10.&nbsp;&nbsp;Planning Requirements for LDAP Naming Services (Tasks)</a></p>
<p class="toc level2"><a href="sundssetup-13.html">11.&nbsp;&nbsp;Setting Up Sun Java System Directory Server With LDAP Clients (Tasks)</a></p>
<p class="toc level2"><a href="clientsetup-1.html">12.&nbsp;&nbsp;Setting Up LDAP Clients (Tasks)</a></p>
<p class="toc level2"><a href="setupproblems-1.html">13.&nbsp;&nbsp;LDAP Troubleshooting (Reference)</a></p>
<p class="toc level2"><a href="schemas-1.html">14.&nbsp;&nbsp;LDAP General Reference (Reference)</a></p>
<p class="toc level2"><a href="nis2ldap-34.html">15.&nbsp;&nbsp;Transitioning From NIS to LDAP (Overview/Tasks)</a></p>
<p class="toc level2"><a href="nisplus2ldap-1.html">16.&nbsp;&nbsp;Transitioning From NIS+ to LDAP</a></p>
<div class="onpage">
<p class="toc level3"><a href="">NIS+ to LDAP Overview</a></p>
</div>
<p class="toc level3"><a href="nisplus2ldap-5.html">Getting Started With the NIS+ to LDAP Transition</a></p>
<p class="toc level3"><a href="nisplus2ldap-41.html">Masters and Replicas (NIS+ to LDAP)</a></p>
<p class="toc level3"><a href="nisplus2ldap-43.html">The Directory Server (NIS+ to LDAP)</a></p>
<p class="toc level3"><a href="nisplus2ldap-49.html">Mapping NIS+ Objects Other Than Table Entries</a></p>
<p class="toc level3"><a href="nisplus2ldap-50.html">NIS+ Entry Owner, Group, Access, and TTL</a></p>
<p class="toc level3"><a href="nisplus2ldap-56.html">Principal Names and Netnames (NIS+ to LDAP)</a></p>
<p class="toc level3"><a href="nisplus2ldap-57.html"><tt>client_info</tt> and <tt>timezone</tt> Tables (NIS+ to LDAP)</a></p>
<p class="toc level3"><a href="nisplus2ldap-60.html">Adding New Object Mappings (NIS+ to LDAP)</a></p>
<p class="toc level3"><a href="nisplus2ldap-70.html">Storing Configuration Information in LDAP</a></p>
<p class="toc level1 tocsp"><a href="ghnmu.html">Part&nbsp;V&nbsp;Active Directory Naming Service</a></p>
<p class="toc level2"><a href="ghnov.html">17.&nbsp;&nbsp;Setting Up Solaris Active Directory Clients</a></p>
<p class="toc level1 tocsp"><a href="whatsnew-1.html">A.&nbsp;&nbsp;Solaris 10 Software Updates to DNS, NIS, and LDAP</a></p>
<p class="toc level2"><a href="whatsnew-5.html">Service Management Facility Changes</a></p>
<p class="toc level2"><a href="whatsnew-2.html">DNS BIND</a></p>
<p class="toc level2"><a href="schemas-290.html"><tt>pam_ldap</tt> Changes</a></p>
<p class="toc level2"><a href="whatsnew-3.html">Documentation Errors</a></p>
<p class="toc level1 tocsp"><a href="aagloss-87604.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="nisplus2ldap-2"></a><h3>NIS+ to LDAP Overview</h3>
<p><a name="indexterm-585"></a>The NIS+ server daemon, <tt>rpc.nisd</tt>, stores NIS+ data in proprietary-format files in the
<tt>/var/nis/data</tt> directory. While it is entirely possible to keep NIS+ data synchronized with
LDAP, such synchronization has previously required an external agent. However, the NIS+ daemon now
enables you to use an LDAP server as a data repository for
NIS+ data. Since this makes it possible for NIS+ and LDAP clients to
share the same naming service information, it is easier to transition from using
NIS+ as the main naming service, to using LDAP for the same role.</p><p>By default, the <tt>rpc.nisd</tt> daemon continues to work as before, relying only on
the<tt>/var/nis/data</tt> NIS+ database. If desired, the system administrator can choose to use an
LDAP server as the authoritative data repository for any subset of the NIS+
database. In this case, the <tt>/var/nis/data</tt> files serve as a cache for the
<tt>rpc.nisd</tt> daemon, reducing LDAP lookup traffic, and enabling the <tt>rpc.nisd</tt> to continue
working if the LDAP server is temporarily unavailable. In addition to continuous synchronization
between NIS+ and LDAP, you can also perform uploads of NIS+ data to
LDAP, or downloads of LDAP data to NIS+.</p><p>Mapping of data to and from LDAP is controlled by a flexible
configuration file syntax. (All standard NIS+ tables (except for <tt>client_info.org_dir</tt> and <tt>timezone.org_dir</tt>) are
covered by a template mapping file, <tt>/var/nis/NIS+LDAPmapping.template</tt>), which should require little or
no change for most NIS+ installations. (See <a href="nisplus2ldap-57.html"><tt>client_info</tt> and <tt>timezone</tt> Tables (NIS+ to LDAP)</a> for information on <tt>client_info.org_dir</tt> and
<tt>timezone.org_dir</tt> .) In addition to locations for NIS+ data in the LDAP Directory
Information Tree (DIT), the mapping file also allows establishing time-to-live (TTL) for NIS+
data sourced from LDAP. While there often is a one-to-one mapping between NIS+
column values and LDAP attribute values, the mapping file can be used to
maintain more complicated relationships as well.</p><p>The <tt>/etc/default/rpc.nisd</tt> file is used to select LDAP server and authentication, and controls
some general <tt>rpc.nisd</tt> behavior. See <a href="http://docs.sun.com/doc/819-2251/rpc.nisd-4?a=view"><tt>rpc.nisd</tt>(4)</a>. The details of the mapping are specified via
the <tt>/var/nis/NIS+LDAPmapping</tt> file. For more information, see  <a href="http://docs.sun.com/doc/819-2251/nis-plus-ldapmapping-4?a=view"><tt>NIS+LDAPmapping</tt>(4)</a>. The name of
the mapping file can be changed by editing the <tt>/lib/svc/method/nisplus</tt> file. See <a href="#nisplus2ldap-66">NIS+ to LDAP Tools and the Service Management Facility</a> for
more information.</p><p>The following terms are used in this chapter.</p>
<ul><li><p>Container</p><p>A container is the location in the LDAP DIT where all related entries are stored. For example, user account information is often stored in the <tt>ou=People</tt> container, while host address information can be stored in the <tt>ou=Hosts</tt> container.</p></li>
<li><p>Netname</p><p>A netname is an entity in secure RPC (user or machine) that can be authenticated.</p></li>
<li><p>Mapping</p><p>Mapping is the relationship between an NIS+ object and an LDAP entry. For example, data from the <tt>name</tt> column in the <tt>passwd.org_dir</tt> NIS+ table (such as the user name of an account) corresponds to the LDAP <tt>uid</tt> attribute of the <tt>posixAccount</tt> object class in the <tt>ou=People</tt> container. The configuration can establish a mapping between the <tt>name</tt> column and the <tt>uid</tt> attribute. You can also say that the <tt>name</tt> column is mapped to the <tt>uid</tt> attribute (or vice versa).</p></li>
<li><p>Principal</p><p>A principal is an entity in NIS+ (user or machine) that can be authenticated. Usually, there is a one-to&ndash;one correspondence between netnames and principal names.</p></li></ul>


<a name="nisplus2ldap-3"></a><h4><tt>rpc.nisd</tt> Configuration Files</h4>
<p><a name="indexterm-586"></a>Two configuration files control <tt>rpc.nisd</tt> operation.</p>
<ul><li><p><tt>/etc/default/rpc.nisd</tt></p><p>This file contains information regarding the LDAP server and authentication, the NIS+ base domain, the LDAP default search base, exception processing, and general <tt>rpc.nisd</tt> configuration, which applies whether or not LDAP mapping is in effect.</p></li>
<li><p><tt>/var/nis/NIS+LDAPmapping</tt></p><p>This file contains information on mapping of NIS+ data to and from LDAP. The template file (<tt>/var/nis/NIS+LDAPmapping.template</tt>) covers all standard NIS+ objects, except <tt>client_info.org_dir</tt> and <tt>timezone.org_dir</tt>. See <a href="nisplus2ldap-57.html"><tt>client_info</tt> and <tt>timezone</tt> Tables (NIS+ to LDAP)</a> and <a href="http://docs.sun.com/doc/819-2251/nis-plus-ldapmapping-4?a=view"><tt>NIS+LDAPmapping</tt>(4)</a>.</p></li></ul>
<p>Configuration is done by assigning values to pre-defined attributes. In addition to the
configuration files, the configuration attributes can also be read from LDAP (see <a href="nisplus2ldap-70.html">Storing Configuration Information in LDAP</a>)
or can be specified on the <tt>rpc.nisd</tt> command line by way of the
<tt>-x</tt> option. If the same attribute is specified in more than one place,
the priority order is (from higher to lower) as follows.</p>
<ol><li><p><tt>rpc.nisd</tt> <tt>-x</tt><tt></tt> option</p></li>
<li><p>Configuration file</p></li>
<li><p>LDAP</p></li></ol>


<a name="nisplus2ldap-66"></a><h4>NIS+ to LDAP Tools and the Service Management Facility</h4>
<a name="indexterm-587"></a><a name="indexterm-588"></a><a name="indexterm-589"></a><p>Most of the command line administrative tasks associated with the NIS+ to LDAP
transition are managed by the Service Management Facility. For an overview of SMF,
refer to <a href="http://docs.sun.com/doc/819-2379/hbrunlevels-25516?a=view">Chapter 16, Managing Services (Overview), in <i>System Administration Guide: Basic Administration</i></a>. Also refer to the <a href="http://docs.sun.com/doc/819-2240/svcadm-1m?a=view"><tt>svcadm</tt>(1M)</a> and <a href="http://docs.sun.com/doc/819-2239/svcs-1?a=view"><tt>svcs</tt>(1)</a> man pages
for more details.</p>
<ul><li><p>Administrative actions on the NIS+ to LDAP transition service, such as enabling, disabling, or restarting, can be performed using the <tt>svcadm</tt> command.</p>
<hr><p><b>Tip - </b>Temporarily disabling a service by using the <tt>-t</tt> option provides some protection for the service configuration. If the service is disabled with the <tt>-t</tt> option, the original settings would be restored for the service after a reboot. If the service is disabled without <tt>-t</tt>, the service will remain disabled after reboot.</p>
<hr>
</li>
<li><p>The NIS+ Fault Managed Resource Identifier (FMRI) is <tt>svc:/network/rpc/nisplus:</tt><i>&lt;instance&gt;</i><tt></tt>. The FMRI for the LDAP client service is <tt>svc:/network/ldap/client:</tt><i>&lt;instance&gt;</i><tt></tt>.</p></li>
<li><p>You can query the status of NIS+ by using the <tt>svcs</tt> command.</p>
<ul><li><p>Example of <tt>svcs</tt> command and output.</p></li></ul>
<pre># <tt><b>svcs \*nisplus\*</b></tt>
STATE        STIME    FMRI
online       Sep_01   svc:/network/rpc/nisplus:default</pre></li>
<li><p>Example of <tt>svcs</tt> <tt>-l</tt> command and output. To get the output shown below, you must use the instance name in the FMRI.</p><pre># <tt><b>svcs</b></tt> <tt>-l</tt> <tt><b>network/rpc/nisplus:default</b></tt>
fmri         svc:/network/rpc/nisplus:default
enabled      false
state        disabled
next_state   none
restarter    svc:/system/svc/restarter:default
dependency   require_all/none svc:/network/rpc/keyserv (online)</pre></li>
<li><p>You can check a daemon's presence by using the <tt>ps</tt> command.</p><pre># <tt><b>ps</b></tt> <tt>-e</tt> <tt><b>| grep rpc.nisd</b></tt>
  root 23320     1   0   Aug 27 ?        16:30 ./ns-slapd -D \
  /usr/iplanet/ds5/slapd-lastrev -i /usr/iplanet/ds5/slapd-lastrev/
  root 25367 25353   0 15:35:19 pts/1     0:00 grep slapd</pre>
<hr><p><b>Note - </b>Do not use the <tt>-f</tt> option with <tt>ps</tt> because this option attempts to translate user IDs to names, which causes more naming service lookups that might not succeed.</p>
<hr>
</li></ul>


<a name="nisplus2ldap-150"></a><h5>When Not to Use SMF With NIS+ to LDAP</h5>
<a name="indexterm-590"></a><a name="indexterm-591"></a><p>In general, the <tt>/usr/sbin/rpc.nisd</tt> daemon is administered using the <tt>svcadm</tt> command. However, when
<tt>rpc.nisd</tt> is invoked with <tt>-x</tt> <tt>nisplusLDAPinitialUpdateOnly=yes</tt>, <tt>rpc.nisd</tt> performs the specified initial update action, then
exits. That is, <tt>rpc.nisd</tt> does not daemonize. The Service Management Facility should not
be used in conjunction with <tt>-x</tt> <tt>nisplusLDAPinitialUpdateOnly=yes</tt>. SMF can be used any other
time you want to start, stop, or restart the <tt>rpc.nisd</tt> daemon.</p><p>The following example shows <tt>rpc.nisd</tt> used with <tt>-x</tt> <tt>nisplusLDAPinitialUpdateOnly=yes</tt>.</p><pre># <tt><b>/usr/sbin/rpc.nisd</b></tt> <tt>-m</tt> <tt><b></tt><i>mappingfile</i><tt> \</b></tt>
<tt><b></b></tt><tt>-x</tt> <tt><b>nisplusLDAPinitialUpdateAction=from_ldap \</b></tt>
<tt><b></b></tt><tt>-x</tt> <tt><b>nisplusLDAPinitialUpdateOnly=yes</b></tt></pre>

<a name="nisplus2ldap-160"></a><h5>Modifying the <tt>/lib/svc/method/nisplus</tt> File</h5>
<a name="indexterm-592"></a><p>If you want to include specific options when you invoke the <tt>rpc.nisd</tt>
daemon with the Service Management Facility, you can use the <tt>svcprop</tt> command
or modify the <tt>/lib/svc/method/nisplus</tt> file. See the <a href="http://docs.sun.com/doc/819-2239/svcprop-1?a=view"><tt>svcprop</tt>(1)</a> man page for more information about
using the <tt>svcprop</tt> command. The following procedure describes how to modify the <tt>/lib/svc/method/nisplus</tt>
file.</p>

<a name="nisplus2ldap-proc-9"></a><h5>How to Modify the <tt>/lib/svc/method/nisplus</tt> File</h5>
<ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-1?a=view">Chapter 9, Using Role-Based Access Control (Tasks), in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="nisplus2ldap-step-10"></a><b>Stop the NIS+ service.</b><pre># <tt><b>svcadm disable network/rpc/nisplus:default</b></tt></pre></li>
<li><a name="nisplus2ldap-step-11"></a><b>Open the <tt>/lib/svc/method/nisplus</tt> file.</b><p>Use the editor of your choice.</p></li>
<li><a name="nisplus2ldap-step-12"></a><b>Edit the file to add the desired options.</b><p>Change:</p><pre>if [ -d /var/nis/data -o -d /var/nis/$hostname ]; then
                    /usr/sbin/rpc.nisd || exit $</pre><p>To:</p><pre>if [ -d /var/nis/data -o -d /var/nis/$hostname ]; then
                     /usr/sbin/rpc.nisd -Y -B || exit $?</pre><p>In this example, the <tt>-Y</tt> and <tt>-B</tt> options are added to <tt>rpc.nisd</tt>, so
the options are automatically implemented at startup.</p></li>
<li><a name="nisplus2ldap-step-14"></a><b>Save and quit the <tt>/lib/svc/method/nisplus</tt> file.</b></li>
<li><a name="nisplus2ldap-step-13"></a><b>Start the NIS+ service.</b><pre># <tt><b>svcadm enable network/rpc/nisplus:default</b></tt></pre></li></ol>

<a name="nisplus2ldap-4"></a><h4>Creating Attributes and Object Classes</h4>
<p>Depending on how you configure the NIS+/LDAP mapping, you might need to create
a number of new LDAP attributes and object classes. The examples show how
to do this by specifying LDIF data that can be used as
input to the <tt>ldapadd</tt> command. Create a file containing the LDIF data,
and then invoke <a href="http://docs.sun.com/doc/819-2239/ldapadd-1?a=view"><tt>ldapadd</tt>(1)</a>.</p><pre># <tt><b>ldapadd</b></tt> <tt>-D</tt> <tt><b></tt><i>bind-DN</i><tt></b></tt> <tt>-f</tt> <tt><b>ldif</b></tt> <tt>-file</tt><tt><b></b></tt></pre><p>This method works with Sun Java System Directory Server, and might work with
other LDAP servers as well.</p>
<hr><p><b>Note - </b>Except for the <tt>defaultSearchBase</tt>, <tt>preferredServerList</tt>, and <tt>authenticationMethod</tt> attributes, as well as the SYNTAX
specifications, the object identifiers (OIDs) used in this chapter are intended for illustration
only. As no official OIDs have been assigned, you are free to use
any suitable OIDs.</p>
<hr>

         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="nisplus2ldap-1.html">Previous</a>
             </td>
             <td align="right">
                 <a href="nisplus2ldap-5.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

