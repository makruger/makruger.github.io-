<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Administering NIS Users - System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2009-01-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="anis2-32914.html">Previous</a>
             </td>
             <td align="right">
                 <a href="anis2-11278.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="intro-1.html">Part&nbsp;I&nbsp;About Naming and Directory Services</a></p>
<p class="toc level2"><a href="intro2ns-2.html">1.&nbsp;&nbsp;Naming and Directory Services (Overview)</a></p>
<p class="toc level2"><a href="a12swit-86415.html">2.&nbsp;&nbsp;The Name Service Switch (Overview)</a></p>
<p class="toc level1 tocsp"><a href="dnsadmin-1.html">Part&nbsp;II&nbsp;DNS Setup and Administration</a></p>
<p class="toc level2"><a href="dnsref-1.html">3.&nbsp;&nbsp;DNS Setup and Administration (Reference)</a></p>
<p class="toc level1 tocsp"><a href="nissetup-1.html">Part&nbsp;III&nbsp;NIS Setup and Administration</a></p>
<p class="toc level2"><a href="anis1-25461.html">4.&nbsp;&nbsp;Network Information Service (NIS) (Overview)</a></p>
<p class="toc level2"><a href="cnis1-25208.html">5.&nbsp;&nbsp;Setting Up and Configuring NIS Service</a></p>
<p class="toc level2"><a href="anis2-22217.html">6.&nbsp;&nbsp;Administering NIS (Tasks)</a></p>
<p class="toc level3"><a href="anis2-32914.html">Password Files and Namespace Security</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Administering NIS Users</a></p>
</div>
<p class="toc level3"><a href="anis2-11278.html">Working With NIS Maps</a></p>
<p class="toc level3"><a href="anis2-1010.html">Updating and Modifying Existing Maps</a></p>
<p class="toc level3"><a href="anis2-34392.html">Adding a Slave Server</a></p>
<p class="toc level3"><a href="anis2-25789.html">Using NIS With C2 Security</a></p>
<p class="toc level3"><a href="anis2-manualbind-1.html">Binding to a Specific NIS Server</a></p>
<p class="toc level3"><a href="anis2-16615.html">Changing a Machine's NIS Domain</a></p>
<p class="toc level3"><a href="anis2-21536.html">Using NIS in Conjunction With DNS</a></p>
<p class="toc level3"><a href="anis2-22142.html">Turning Off NIS Services</a></p>
<p class="toc level2 tocsp"><a href="abtrbl-18694.html">7.&nbsp;&nbsp;NIS Troubleshooting</a></p>
<p class="toc level1 tocsp"><a href="ldapsetup-1.html">Part&nbsp;IV&nbsp;LDAP Naming Services Setup and Administration</a></p>
<p class="toc level2"><a href="overview-1.html">8.&nbsp;&nbsp;Introduction to LDAP Naming Services (Overview/Reference)</a></p>
<p class="toc level2"><a href="ldapsecure-1.html">9.&nbsp;&nbsp;LDAP Basic Components and Concepts (Overview)</a></p>
<p class="toc level2"><a href="planldap-1.html">10.&nbsp;&nbsp;Planning Requirements for LDAP Naming Services (Tasks)</a></p>
<p class="toc level2"><a href="sundssetup-13.html">11.&nbsp;&nbsp;Setting Up Sun Java System Directory Server With LDAP Clients (Tasks)</a></p>
<p class="toc level2"><a href="clientsetup-1.html">12.&nbsp;&nbsp;Setting Up LDAP Clients (Tasks)</a></p>
<p class="toc level2"><a href="setupproblems-1.html">13.&nbsp;&nbsp;LDAP Troubleshooting (Reference)</a></p>
<p class="toc level2"><a href="schemas-1.html">14.&nbsp;&nbsp;LDAP General Reference (Reference)</a></p>
<p class="toc level2"><a href="nis2ldap-34.html">15.&nbsp;&nbsp;Transitioning From NIS to LDAP (Overview/Tasks)</a></p>
<p class="toc level2"><a href="nisplus2ldap-1.html">16.&nbsp;&nbsp;Transitioning From NIS+ to LDAP</a></p>
<p class="toc level1 tocsp"><a href="ghnmu.html">Part&nbsp;V&nbsp;Active Directory Naming Service</a></p>
<p class="toc level2"><a href="ghnov.html">17.&nbsp;&nbsp;Setting Up Solaris Active Directory Clients</a></p>
<p class="toc level1 tocsp"><a href="whatsnew-1.html">A.&nbsp;&nbsp;Solaris 10 Software Updates to DNS, NIS, and LDAP</a></p>
<p class="toc level2"><a href="whatsnew-5.html">Service Management Facility Changes</a></p>
<p class="toc level2"><a href="whatsnew-2.html">DNS BIND</a></p>
<p class="toc level2"><a href="schemas-290.html"><tt>pam_ldap</tt> Changes</a></p>
<p class="toc level2"><a href="whatsnew-3.html">Documentation Errors</a></p>
<p class="toc level1 tocsp"><a href="aagloss-87604.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="anis2-38485"></a><h3>Administering NIS Users</h3>
<a name="indexterm-314"></a><a name="indexterm-315"></a><p>This section includes information about setting user passwords, adding new users to an
NIS domain, and assigning users to <tt>netgroups</tt>.</p>

<a name="anis2-1"></a><h4>How to Add a New NIS User to an NIS Domain</h4><ol>
<li><a name="anis2-step-33"></a><b>On the master NIS server, become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-1?a=view">Chapter 9, Using Role-Based Access Control (Tasks), in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="anis2-step-4"></a><b><a name="indexterm-316"></a><a name="indexterm-317"></a><a name="indexterm-318"></a>Create the new user's login ID with the <tt>useradd</tt> command.</b><pre># <tt><b>useradd </tt><i>userID</i><tt></b></tt></pre><p><i>userID</i> is the login ID of the new user. This command creates entries
in the <tt>/etc/passwd</tt> and <tt>/etc/shadow</tt> files on the master NIS server.</p></li>
<li><a name="anis2-step-5"></a><b>Create the new user's initial password.</b><p>To create an initial password that the new user can use to
log in, run the <tt>passwd</tt> command.</p><pre># <tt><b>passwd </tt><i>userID</i><tt></b></tt></pre><p>Where <i>userID</i> is the login ID of the new user. You will be
prompted for the password to assign to this user.</p><p><a name="indexterm-319"></a><a name="indexterm-320"></a>This step is necessary because the password entry created by the <tt>useradd</tt> command
is locked, which means that the new user cannot log in. By specifying
an initial password, you unlock the entry.</p></li>
<li><a name="anis2-step-6"></a><b><a name="indexterm-321"></a>If necessary, copy the new entry into the server's <tt>passwd</tt> map input files.</b><p>The map source files on your master server should be in a
directory other than <tt>/etc</tt>. Copy and paste the new lines from the <tt>/etc/passwd</tt>
and <tt>/etc/shadow</tt> files into the <tt>passwd</tt> map input files on the server.
See <a href="anis2-32914.html">Password Files and Namespace Security</a> for additional information.</p><p>For example, if you added the new user <tt>brown</tt>, the line from <tt>/etc/passwd</tt>
that you would copy to your <tt>passwd</tt> input file would look like
the following.</p><pre>brown:x:123:10:User brown:/home/brown:/bin/csh:</pre><p>The line for <tt>brown</tt> that you would copy from <tt>/etc/shadow</tt> would look
like:</p><pre>brown:W12345GkHic:6445::::::</pre></li>
<li><a name="anis2-step-7"></a><b>Make sure that the <tt>Makefile</tt> correctly specifies the directory where the password input
file resides.</b></li>
<li><a name="anis2-step-88"></a><b>If appropriate, delete the new user's entries from <tt>/etc/passwd</tt> and <tt>/etc/shadow</tt> input files.</b><p><a name="indexterm-322"></a><a name="indexterm-323"></a><a name="indexterm-324"></a>For security reasons, do not keep user entries in the NIS master server
<tt>/etc/passwd</tt> and <tt>/etc/shadow</tt> files. After copying the entries for the new user to
the NIS map source files that are stored in some other directory, use
the <tt>userdel</tt> command on the master server to delete the new user.</p><p>For example, to delete the new user <tt>brown</tt> from the master server's <tt>/etc</tt>
files, you would enter the following.</p><pre># <tt><b>userdel brown</b></tt></pre><p><a name="indexterm-325"></a>For more information about <tt>userdel</tt>, see the <tt>userdel</tt> man page.</p></li>
<li><a name="anis2-step-999"></a><b><a name="indexterm-326"></a><a name="indexterm-327"></a>Update the NIS <tt>passwd</tt> maps.</b><p>After you have updated the <tt>passwd</tt> input file on the master server, update
the <tt>passwd</tt> maps by running <tt>make</tt> in the directory containing the source file.</p><pre># <tt><b>userdel brown</b></tt>
# <tt><b>cd /var/yp</b></tt>
# <tt><b>/usr/ccs/bin/make passwd</b></tt></pre></li>
<li><a name="anis2-step-1000"></a><b>Tell the new user the initial password you have assigned to his or
her login ID.</b><p>After logging in, the new user can run <tt>passwd</tt> at any time to
establish a different password.</p></li></ol>

<a name="anis2-11"></a><h4>Setting User Passwords</h4>
<a name="indexterm-328"></a><a name="indexterm-329"></a><a name="indexterm-330"></a><p><a name="indexterm-331"></a>Users run <tt>passwd</tt> to change their passwords.</p><p>% <tt><b>passwd </tt><i>username</i><tt></b></tt></p><p><a name="indexterm-332"></a><a name="indexterm-333"></a><a name="indexterm-334"></a>Before users can change their passwords, you must start the <tt>rpc.yppasswdd</tt> daemon
on the master server to update the password file.</p><p>The <tt>rpc.yppasswdd</tt> daemon starts automatically on the master server. Notice that when the
<tt>-m</tt> option is given to <tt>rpc.yppasswdd</tt>, a <tt>make</tt> is forced in <tt>/var/yp</tt> immediately
following a modification of the file. If you want to avoid having this
<tt>make</tt> take place each time the <tt>passwd</tt> file is changed, remove the
<tt>-m</tt> option from the <tt>rpc.yppasswd</tt> command in the <tt>ypstart</tt> script and control the pushing
of the <tt>passwd</tt> maps through the <tt>crontab</tt> file.</p>
<hr><p><b>Note - </b><a name="indexterm-335"></a><a name="indexterm-336"></a><a name="indexterm-337"></a>No arguments should follow the <tt>rpc.yppasswd</tt> <tt>-m</tt> command. Although you can edit
the <tt>ypstart</tt> script file to achieve a different action, it is not recommended
that you modify this file other than optionally removing the <tt>-m</tt> option. All commands
and daemons invoked by this file with the proper set of command
line parameters. If you choose to edit this file, be especially careful when
editing the <tt>rpc.yppasswdd</tt> command. If you add an explicit call to the <tt>passwd.adjunct</tt> file,
the exact <tt>$PWDIR/security/passwd.adjunct</tt> path must be used; otherwise, incorrect processing results.</p>
<hr>


<a name="anis2-14244"></a><h4>NIS Netgroups</h4>
<a name="indexterm-338"></a><a name="indexterm-339"></a><a name="indexterm-340"></a><p>NIS netgroups are groups (sets) of users or machines that you define for
your administrative purposes. For example, you can create netgroups that do the following.</p>
<ul><li><p>Define a set of users who can access a specific machine</p></li>
<li><p>Define a set of NFS client machines to be given some specific file system access</p></li>
<li><p>Define a set of users who are to have administrator privileges on all the machines in a particular NIS domain</p></li></ul>
<p>Each netgroup is given a netgroup name. Netgroups do not directly set permissions
or access rights. Instead, the netgroup names are used by other NIS maps
in places where a user name or machine name would normally be
used. For example, suppose you created a netgroup of network administrators called <tt>netadmins</tt>.
To grant all members of the <tt>netadmins</tt> group access to a given machine,
you need only add a <tt>netadmin</tt> entry to that machine's  <tt>/etc/passwd</tt> file.
Netgroup names can also be added to the <tt>/etc/netgroup</tt> file and propagated to the
NIS <tt>netgroup</tt> map. See <a href="http://docs.sun.com/doc/819-2251/netgroup-4?a=view"><tt>netgroup</tt>(4)</a> for more detailed information on using netgroups.</p><p><a name="indexterm-341"></a><a name="indexterm-342"></a><a name="indexterm-343"></a>On a network using NIS, the <tt>netgroup</tt> input file on the master NIS
server is used for generating three maps: <tt>netgroup</tt>, <tt>netgroup.byuser</tt>, and <tt>netgroup.byhost</tt>. The 
<tt>netgroup</tt> map contains the basic information in the <tt>netgroup</tt> input file. The
two other NIS maps contain information in a format that speeds lookups of
netgroup information, given the machine or user.</p><p>Entries in the <tt>netgroup</tt> input file are in the format: <i>name ID</i>, where
<i>name</i> is the name you give to a netgroup, and <i>ID</i> identifies a
machine or user who belongs to the netgroup. You can specify as many
IDs (members) to a netgroup as you want, separated by commas. For example,
to create a netgroup with three members, the <tt>netgroup</tt> input file entry would be
in the format:  <i>name</i> <i>ID</i>, <i>ID</i>, <i>ID</i>. The member IDs in
a <tt>netgroup</tt> input file entry are in the following format.</p><pre>([-|<i>machine</i>], [-|<i>user</i>], [<i>domain</i>])</pre><p>Where <i>machine</i> is a machine name, <i>user</i> is a user ID, and
<i>domain</i> is the machine or user's NIS domain. The <b>domain</b> element is optional and
should only be used to identify machines or users in some other
NIS domain. The <i>machine</i> and <i>user</i> element of each member's entry are required, but
a dash (<tt>-</tt>) is used to denote a null. There is no necessary
relationship between the machine and user elements in an entry.</p><p><a name="indexterm-344"></a>The following are two sample <tt>netgroup</tt> input file entries, each of which
create a netgroup named <tt>admins</tt> composed of the users <tt>hauri</tt> and <tt>juanita</tt>
who is in the remote domain <tt>sales</tt> and the machines <tt>altair</tt> and
<tt>sirius</tt>.</p><pre>admins (altair, hauri), (sirius,juanita,sales)</pre><pre>admins (altair,-), (sirius,-), (-,hauri), (-,juanita,sales)</pre><p><a name="indexterm-345"></a><a name="indexterm-346"></a><a name="indexterm-347"></a>Various programs use the netgroup NIS maps for permission checking during login, remote
mount, remote login, and remote shell creation. These programs include <tt>mountd</tt>, <tt>login</tt>, <tt>rlogin</tt>,
and <tt>rsh</tt> . The <tt>login</tt> command consults the netgroup maps for user classifications
if it encounters netgroup names in the <tt>passwd</tt> database. The <tt>mountd</tt> daemon consults the
netgroup maps for machine classifications if it encounters netgroup names in the <tt>/etc/dfs/dfstab</tt>
file. <tt>rlogin</tt> and <tt>rsh</tt> In fact, any program that uses the <tt>ruserok</tt>
interface consults the netgroup maps for both machine and user classifications if they encounter
netgroup names in the <tt>/etc/hosts.equiv</tt> or <tt>.rhosts</tt> files.</p><p>If you add a new NIS user or machine to your network,
be sure to add them to appropriate netgroups in the <tt>netgroup</tt> input file. Then
use the <tt>make</tt> and <tt>yppush</tt> commands to create the netgroup maps and push
them to all of your NIS servers. See <a href="http://docs.sun.com/doc/819-2251/netgroup-4?a=view"><tt>netgroup</tt>(4)</a> for detailed information on
using netgroups and netgroup input file syntax.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="anis2-32914.html">Previous</a>
             </td>
             <td align="right">
                 <a href="anis2-11278.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

