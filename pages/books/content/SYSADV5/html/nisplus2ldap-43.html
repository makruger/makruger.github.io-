<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>The Directory Server (NIS+ to LDAP) - System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2009-01-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="nisplus2ldap-41.html">Previous</a>
             </td>
             <td align="right">
                 <a href="nisplus2ldap-49.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="intro-1.html">Part&nbsp;I&nbsp;About Naming and Directory Services</a></p>
<p class="toc level2"><a href="intro2ns-2.html">1.&nbsp;&nbsp;Naming and Directory Services (Overview)</a></p>
<p class="toc level2"><a href="a12swit-86415.html">2.&nbsp;&nbsp;The Name Service Switch (Overview)</a></p>
<p class="toc level1 tocsp"><a href="dnsadmin-1.html">Part&nbsp;II&nbsp;DNS Setup and Administration</a></p>
<p class="toc level2"><a href="dnsref-1.html">3.&nbsp;&nbsp;DNS Setup and Administration (Reference)</a></p>
<p class="toc level1 tocsp"><a href="nissetup-1.html">Part&nbsp;III&nbsp;NIS Setup and Administration</a></p>
<p class="toc level2"><a href="anis1-25461.html">4.&nbsp;&nbsp;Network Information Service (NIS) (Overview)</a></p>
<p class="toc level2"><a href="cnis1-25208.html">5.&nbsp;&nbsp;Setting Up and Configuring NIS Service</a></p>
<p class="toc level2"><a href="anis2-22217.html">6.&nbsp;&nbsp;Administering NIS (Tasks)</a></p>
<p class="toc level2"><a href="abtrbl-18694.html">7.&nbsp;&nbsp;NIS Troubleshooting</a></p>
<p class="toc level1 tocsp"><a href="ldapsetup-1.html">Part&nbsp;IV&nbsp;LDAP Naming Services Setup and Administration</a></p>
<p class="toc level2"><a href="overview-1.html">8.&nbsp;&nbsp;Introduction to LDAP Naming Services (Overview/Reference)</a></p>
<p class="toc level2"><a href="ldapsecure-1.html">9.&nbsp;&nbsp;LDAP Basic Components and Concepts (Overview)</a></p>
<p class="toc level2"><a href="planldap-1.html">10.&nbsp;&nbsp;Planning Requirements for LDAP Naming Services (Tasks)</a></p>
<p class="toc level2"><a href="sundssetup-13.html">11.&nbsp;&nbsp;Setting Up Sun Java System Directory Server With LDAP Clients (Tasks)</a></p>
<p class="toc level2"><a href="clientsetup-1.html">12.&nbsp;&nbsp;Setting Up LDAP Clients (Tasks)</a></p>
<p class="toc level2"><a href="setupproblems-1.html">13.&nbsp;&nbsp;LDAP Troubleshooting (Reference)</a></p>
<p class="toc level2"><a href="schemas-1.html">14.&nbsp;&nbsp;LDAP General Reference (Reference)</a></p>
<p class="toc level2"><a href="nis2ldap-34.html">15.&nbsp;&nbsp;Transitioning From NIS to LDAP (Overview/Tasks)</a></p>
<p class="toc level2"><a href="nisplus2ldap-1.html">16.&nbsp;&nbsp;Transitioning From NIS+ to LDAP</a></p>
<p class="toc level3"><a href="nisplus2ldap-2.html">NIS+ to LDAP Overview</a></p>
<p class="toc level3"><a href="nisplus2ldap-5.html">Getting Started With the NIS+ to LDAP Transition</a></p>
<p class="toc level3"><a href="nisplus2ldap-41.html">Masters and Replicas (NIS+ to LDAP)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">The Directory Server (NIS+ to LDAP)</a></p>
</div>
<p class="toc level3"><a href="nisplus2ldap-49.html">Mapping NIS+ Objects Other Than Table Entries</a></p>
<p class="toc level3"><a href="nisplus2ldap-50.html">NIS+ Entry Owner, Group, Access, and TTL</a></p>
<p class="toc level3"><a href="nisplus2ldap-56.html">Principal Names and Netnames (NIS+ to LDAP)</a></p>
<p class="toc level3"><a href="nisplus2ldap-57.html"><tt>client_info</tt> and <tt>timezone</tt> Tables (NIS+ to LDAP)</a></p>
<p class="toc level3"><a href="nisplus2ldap-60.html">Adding New Object Mappings (NIS+ to LDAP)</a></p>
<p class="toc level3"><a href="nisplus2ldap-70.html">Storing Configuration Information in LDAP</a></p>
<p class="toc level1 tocsp"><a href="ghnmu.html">Part&nbsp;V&nbsp;Active Directory Naming Service</a></p>
<p class="toc level2"><a href="ghnov.html">17.&nbsp;&nbsp;Setting Up Solaris Active Directory Clients</a></p>
<p class="toc level1 tocsp"><a href="whatsnew-1.html">A.&nbsp;&nbsp;Solaris 10 Software Updates to DNS, NIS, and LDAP</a></p>
<p class="toc level2"><a href="whatsnew-5.html">Service Management Facility Changes</a></p>
<p class="toc level2"><a href="whatsnew-2.html">DNS BIND</a></p>
<p class="toc level2"><a href="schemas-290.html"><tt>pam_ldap</tt> Changes</a></p>
<p class="toc level2"><a href="whatsnew-3.html">Documentation Errors</a></p>
<p class="toc level1 tocsp"><a href="aagloss-87604.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="nisplus2ldap-43"></a><h3>The Directory Server (NIS+ to LDAP)</h3>
<p><a name="indexterm-596"></a>The LDAP mapping portion of the <tt>rpc.nisd</tt> daemon uses LDAP protocol version 3 to
talk to the LDAP server. The default mapping configuration (<tt>/var/nis/NIS+LDAPmapping.template</tt>) expects that
the LDAP server supports an extended version of RFC 2307. RFCs can be
retrieved from <tt>http://www.ietf.org/rfc.html</tt>. While the mapping between NIS+ and LDAP data can be
modified using <a href="http://docs.sun.com/doc/819-2251/nis-plus-ldapmapping-4?a=view"><tt>NIS+LDAPmapping</tt>(4)</a>, there is a basic assumption that the LDAP data is
organized along the principles laid out in RFC 2307.</p><p>For example, in order to share account information between direct LDAP clients and
NIS+ clients, the LDAP server must support storing account (user) passwords in the
UNIX <tt>crypt</tt> format. If the LDAP server cannot be configured to do so,
you can still store NIS+ data, including accounts, in LDAP. However, you will
not be able to fully share account information between NIS+ users and LDAP
<tt>bindDN</tt>s.</p>

<a name="nisplus2ldap-44"></a><h4>Configuring the Sun Java System Directory Server</h4>
<p>Refer to the Sun Java System Directory Server Collection for detailed instructions
on the installation, setup and administration of Sun Java System Directory Server.</p><p>You can use <a href="http://docs.sun.com/doc/819-2240/idsconfig-1m?a=view"><tt>idsconfig</tt>(1M)</a> to configure Sun Java System Directory Server for LDAP
clients using LDAP as a naming service. The setup provided by <a href="http://docs.sun.com/doc/819-2240/idsconfig-1m?a=view"><tt>idsconfig</tt>(1M)</a> is also
appropriate when using NIS+ with an LDAP data repository.</p>
<hr><p><b>Note - </b>If you are using an LDAP server other than Sun Java System
Directory Server, you must manually configure the server to support the RFC 2307
schemas.</p>
<hr>


<a name="nisplus2ldap-45"></a><h4>Assigning Server Address and Port Number</h4>
<p>The <tt>/etc/default/rpc.nisd</tt> file is set up to use a local LDAP server at
port <tt>389</tt>. If this is not correct in your configuration, establish a new
value for the <tt>preferredServerList</tt> attribute. For example, to use an LDAP server
at IP address <tt>192.0.0.1</tt> and port <tt>65535</tt>, you specify the following.</p><pre>preferredServerList=192.0.0.1:65535</pre>

<a name="nisplus2ldap-46"></a><h4>Security and Authentication</h4>
<p>Authentication between NIS+ clients and the NIS+ server is not affected when the
NIS+ server is obtaining data from LDAP. However, in order to maintain the
integrity of the NIS+ data when it is stored in LDAP, consider
configuring authentication between the <tt>rpc.nisd</tt> daemon and the LDAP server. Several different types of
authentication are available, depending on the capabilities of the LDAP server.</p><p>The LDAP authentication supported by the <tt>rpc.nisd</tt> daemon includes the following.</p>
<ul><li><p><tt>none</tt></p><p>The <tt>none</tt> authentication method is the default. While using <tt>none</tt> requires no setup, it also provides no security. It is only suitable for use in environments that have no security requirements at all.</p><p>To use the <tt>none</tt> authentication, make sure that the <tt>authenticationMethod</tt> attribute has the following value.</p><pre>authenticationMethod=none</pre></li></ul>
<p>The authentication methods that actually provide at least some security typically require that
you associate a shared secret (a password or key) with a DN in
LDAP. The DN you select for use by the <tt>rpc.nisd</tt> daemon can be
unique, or can also be used for other purposes. It should have
appropriate capabilities to support the expected LDAP traffic. For example, if the <tt>rpc.nisd</tt>
daemon should be able to write data to LDAP, the selected DN
must have the right to add/update/delete LDAP data in the containers used for
the NIS+ data. Also, the LDAP server might, by default, impose limitations on resource
usage (such as search time limits or search result size limitations). If this
is the case, the selected DN must have sufficient capabilities to support enumeration
of the NIS+ data containers.</p>
<ul><li><p><tt>simple</tt></p><p>The <tt>simple</tt> authentication method provides authentication by unencrypted exchange of a password string. Since the password is sent in the clear between the LDAP client (the <tt>rpc.nisd</tt> daemon) and LDAP server, the <tt>simple</tt> method is suitable only when information exchange between the NIS+ and LDAP servers is protected by some other method.</p><p>For instance, transport layer encryption of LDAP traffic, or the special case where the NIS+ and LDAP server is one and the same system, and the NIS+/LDAP traffic stays in the kernel, protected from the eyes of unauthorized users.</p><p>Modify the configuration of the <tt>rpc.nisd</tt> daemon with the DN and password to use for the <tt>simple</tt> authentication. For example, if the DN is <tt>cn=nisplusAdmin,ou=People,dc=some,dc=domain</tt>, and the password <tt>aword</tt>, establish the following.</p><pre>authenticationMethod=simple
nisplusLDAPproxyUser=cn=nisplusAdmin,ou=People,dc=some,dc=domain
nisplusLDAPproxyPassword=aword</pre><p>Be sure to protect the place where the password is stored from unauthorized access. Remember that if the password is specified on the <tt>rpc.nisd</tt> command line, it might be visible to any user on the system via commands such as <a href="http://docs.sun.com/doc/819-2239/ps-1?a=view"><tt>ps</tt>(1)</a>.</p></li>
<li><p><tt>sasl/digest-md5</tt></p><p>The <tt>sasl/digest-md5</tt> authentication method provides authentication using the <tt>digest/md5</tt> algorithm.</p><p>Consult your LDAP server documentation for information on how to set up an authorization identity for use with <tt>digest-md5</tt>, and modify the <tt>/etc/default/rpc.nisd</tt> file to specify this identity and its associated password.</p><pre>authenticationMethod=sasl/digest-md5
nisplusLDAPproxyUser=cn=nisplusAdmin,ou=People,dc=some,dc=domain
nisplusLDAPproxyPassword=aword</pre><p>Be sure to protect the file where the password is stored from unauthorized access.</p></li>
<li><p><tt>sasl/cram-md5</tt></p><p>Authentication using the <tt>cram/md5</tt> algorithm. Probably only supported by the obsolete SunDS LDAP server.</p><p>Consult your LDAP server documentation for information on how to set up a bind DN for use with <tt>cram-md5</tt>, and modify the <tt>/etc/default/rpc.nisd</tt> file to specify this DN and its associated password.</p><pre>authenticationMethod=sasl/cram-md5
nisplusLDAPproxyUser=cn=nisplusAdmin,ou=People,dc=some,dc=domain
nisplusLDAPproxyPassword=aword</pre><p>Be sure to protect the file where the password is stored from unauthorized access.</p></li></ul>


<a name="nisplus2ldap-47"></a><h5>Using SSL</h5>
<p>The <tt>rpc.nisd</tt> daemon also supports transport layer encryption of LDAP traffic using SSL.
Consult your LDAP server documentation to generate an SSL certificate for LDAP server
authentication. Store the certificate in a file on the NIS+ server (<tt>/var/nis/cert7.db</tt>, for example)
and modify <tt>/etc/default/rpc.nisd</tt> as follows.</p><pre>nisplusLDAPTLS=ssl
nisplusLDAPTLSCertificateDBPath=/var/nis/cert7.db</pre><p>Be sure to protect the certificate file from unauthorized access.  Note that
the above provides session encryption and authentication of the LDAP server to the
<tt>rpc.nisd</tt>. It does not provide authentication of the <tt>rpc.nisd</tt> to the LDAP server,
since the certificate does not contain anything that identifies the LDAP client (<tt>rpc.nisd</tt>). However, you
can combine SSL with another authentication method (<tt>simple</tt>, <tt>sasl/digest-md5</tt> ) in order
to achieve mutual authentication.</p>

<a name="nisplus2ldap-48"></a><h4>Performance and Indexing</h4>
<p>When the <tt>rpc.nisd</tt> daemon is asked to enumerate an NIS+ table (using <a href="http://docs.sun.com/doc/819-2239/niscat-1?a=view"><tt>niscat</tt>(1)</a>
for example) that is mapped from LDAP, it will enumerate the corresponding LDAP container
if at least one entry in the table has an expired TTL.
Although this container enumeration is done in the background, so that LDAP performance is
of limited importance, it can nevertheless be beneficial to establish LDAP indices to
speed up container enumeration for large containers.</p><p>To obtain an estimate of the amount of time required for enumeration of
a particular container, you can use a command like the following.</p><p>% <tt><b>/bin/time ldapsearch</b></tt> <tt>-h</tt> <tt><b></tt><i>server-address</i><tt></b></tt> <tt>-D</tt> <tt><b></tt><i>bind-DN</i><tt></b></tt> <tt>-w</tt> <tt><b></tt><i>password</i><tt> \</b></tt></p><p><tt><b></b></tt><tt>-b</tt> <tt><b></tt><i>container</i><tt>, </tt><i>search-base 'cn=*'</i><tt> /dev/null</b></tt></p><p>where</p>
<ul><li><p><i>server-address</i></p><p>IP address portion of <tt>preferredServerList</tt> value from <tt>/etc/default/rpc.nisd</tt></p></li>
<li><p><i>bind-DN</i></p><p><tt>nisplusLDAPproxyUser</tt> value from <tt>/etc/default/rpc.nisd</tt></p></li>
<li><p><i>password</i></p><p><tt>nisplusLDAPproxyPassword</tt> value from <tt>/etc/default/rpc.nisd</tt></p></li>
<li><p><i>container</i></p><p>One of the RFC 2307 container names (<tt>ou=Services</tt>, <tt>ou=Rpc</tt>, and so on)</p></li>
<li><p><i>search-base</i></p><p><tt>defaultSearchBase</tt> value from <tt>/etc/default/rpc.nisd</tt></p></li></ul>
<p>The &ldquo;real&rdquo; value printed by <tt>/bin/time</tt> is the elapsed (wall-clock) time. If this
value exceeds a significant fraction (25 percent or more) of the TTL for
the corresponding table entries (see <a href="nisplus2ldap-5.html#nisplus2ldap-10">Authentication and Security</a>),  it might be beneficial to index
the LDAP container.</p><p>The <tt>rpc.nisd</tt> supports the <tt>simple page</tt> and VLV indexing methods. Refer to your LDAP
server documentation to find out which indexing methods it supports, and how to
create such indices.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="nisplus2ldap-41.html">Previous</a>
             </td>
             <td align="right">
                 <a href="nisplus2ldap-49.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

