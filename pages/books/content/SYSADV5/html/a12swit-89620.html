<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>About the Name Service Switch - System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2009-01-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="a12swit-86415.html">Previous</a>
             </td>
             <td align="right">
                 <a href="a12swit-22067.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="intro-1.html">Part&nbsp;I&nbsp;About Naming and Directory Services</a></p>
<p class="toc level2"><a href="intro2ns-2.html">1.&nbsp;&nbsp;Naming and Directory Services (Overview)</a></p>
<p class="toc level2"><a href="a12swit-86415.html">2.&nbsp;&nbsp;The Name Service Switch (Overview)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">About the Name Service Switch</a></p>
</div>
<p class="toc level3"><a href="a12swit-22067.html">The <tt>nsswitch.conf</tt> Template Files</a></p>
<p class="toc level3"><a href="c8switch-18904.html">Selecting a Different Configuration File</a></p>
<p class="toc level3"><a href="a12swit-66520.html">DNS and Internet Access</a></p>
<p class="toc level3"><a href="a12swit-7.html">IPv6 and Solaris Naming Services</a></p>
<p class="toc level3"><a href="a12swit-11308.html">Ensuring Compatibility With +/- Syntax</a></p>
<p class="toc level3"><a href="a12swit-27155.html">The Switch File and Password Information</a></p>
<p class="toc level1 tocsp"><a href="dnsadmin-1.html">Part&nbsp;II&nbsp;DNS Setup and Administration</a></p>
<p class="toc level2"><a href="dnsref-1.html">3.&nbsp;&nbsp;DNS Setup and Administration (Reference)</a></p>
<p class="toc level1 tocsp"><a href="nissetup-1.html">Part&nbsp;III&nbsp;NIS Setup and Administration</a></p>
<p class="toc level2"><a href="anis1-25461.html">4.&nbsp;&nbsp;Network Information Service (NIS) (Overview)</a></p>
<p class="toc level2"><a href="cnis1-25208.html">5.&nbsp;&nbsp;Setting Up and Configuring NIS Service</a></p>
<p class="toc level2"><a href="anis2-22217.html">6.&nbsp;&nbsp;Administering NIS (Tasks)</a></p>
<p class="toc level2"><a href="abtrbl-18694.html">7.&nbsp;&nbsp;NIS Troubleshooting</a></p>
<p class="toc level1 tocsp"><a href="ldapsetup-1.html">Part&nbsp;IV&nbsp;LDAP Naming Services Setup and Administration</a></p>
<p class="toc level2"><a href="overview-1.html">8.&nbsp;&nbsp;Introduction to LDAP Naming Services (Overview/Reference)</a></p>
<p class="toc level2"><a href="ldapsecure-1.html">9.&nbsp;&nbsp;LDAP Basic Components and Concepts (Overview)</a></p>
<p class="toc level2"><a href="planldap-1.html">10.&nbsp;&nbsp;Planning Requirements for LDAP Naming Services (Tasks)</a></p>
<p class="toc level2"><a href="sundssetup-13.html">11.&nbsp;&nbsp;Setting Up Sun Java System Directory Server With LDAP Clients (Tasks)</a></p>
<p class="toc level2"><a href="clientsetup-1.html">12.&nbsp;&nbsp;Setting Up LDAP Clients (Tasks)</a></p>
<p class="toc level2"><a href="setupproblems-1.html">13.&nbsp;&nbsp;LDAP Troubleshooting (Reference)</a></p>
<p class="toc level2"><a href="schemas-1.html">14.&nbsp;&nbsp;LDAP General Reference (Reference)</a></p>
<p class="toc level2"><a href="nis2ldap-34.html">15.&nbsp;&nbsp;Transitioning From NIS to LDAP (Overview/Tasks)</a></p>
<p class="toc level2"><a href="nisplus2ldap-1.html">16.&nbsp;&nbsp;Transitioning From NIS+ to LDAP</a></p>
<p class="toc level1 tocsp"><a href="ghnmu.html">Part&nbsp;V&nbsp;Active Directory Naming Service</a></p>
<p class="toc level2"><a href="ghnov.html">17.&nbsp;&nbsp;Setting Up Solaris Active Directory Clients</a></p>
<p class="toc level1 tocsp"><a href="whatsnew-1.html">A.&nbsp;&nbsp;Solaris 10 Software Updates to DNS, NIS, and LDAP</a></p>
<p class="toc level2"><a href="whatsnew-5.html">Service Management Facility Changes</a></p>
<p class="toc level2"><a href="whatsnew-2.html">DNS BIND</a></p>
<p class="toc level2"><a href="schemas-290.html"><tt>pam_ldap</tt> Changes</a></p>
<p class="toc level2"><a href="whatsnew-3.html">Documentation Errors</a></p>
<p class="toc level1 tocsp"><a href="aagloss-87604.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="a12swit-89620"></a><h3>About the Name Service Switch</h3>
<p><a name="indexterm-19"></a><a name="indexterm-20"></a>The name service switch is a file which is named,  <tt>nsswitch.conf</tt>. The
name service switch controls how a client machine or application obtains network information. The
name service switch is used by client applications that call any of
the <tt>getXbyY()</tt> interfaces such as the following.</p>
<ul><li><p><a name="indexterm-21"></a><tt>gethostbyname()</tt></p></li>
<li><p><a name="indexterm-22"></a><tt>getpwuid()</tt></p></li>
<li><p><a name="indexterm-23"></a><tt>getpwnam()</tt></p></li>
<li><p><a name="indexterm-24"></a><tt>getaddrinfo()</tt></p></li></ul>
<p>Each machine has a switch file in its <tt>/etc</tt> directory. Each line of
that file identifies a particular type of network information, such as host, password,
and group, followed by one or more locations of that information.</p><p>A client can obtain naming information from one or more of the
switch's sources. For example, an NIS+ client could obtain its hosts information from an
NIS+ table and its password information from a local <tt>/etc</tt> file. In addition,
the client could specify the conditions under which the switch must use each
source. See <a href="#a12swit-tbl-1">Table&nbsp;2-1</a>.</p><p><a name="indexterm-25"></a>The Solaris system automatically loads an <tt>nsswitch.conf</tt> file into every machine's <tt>/etc</tt> directory
as part of the installation process. Four alternate (template) versions of the switch
file are also loaded into <tt>/etc</tt> for LDAP, NIS, NIS+, or files. See
<a href="a12swit-22067.html">The <tt>nsswitch.conf</tt> Template Files</a>.</p><p>These four files are alternate default switch files. Each file is designed for
a different primary naming service: <tt>/etc</tt> files, NIS, NIS+, or LDAP. When 
the Solaris software is first installed on a machine, the installer selects the
machine's default naming service: NIS+, NIS, local files, or LDAP. During installation, the
corresponding template file is copied to <tt>nsswitch.conf</tt>. For example, for a machine client
using LDAP, the installation process copies  <tt>nsswitch.ldap</tt> to <tt>nsswitch.conf</tt>. Unless you have
an unusual namespace, the default template file as copied to <tt>nsswitch.conf</tt> should be
sufficient for normal operation.</p><p><a name="indexterm-26"></a><a name="indexterm-27"></a>No default file is provided for DNS, but you can edit any of
these files to use DNS. For more information see <a href="a12swit-66520.html">DNS and Internet Access</a>.</p><p>If you later change a machine's primary naming service, you copy the appropriate
alternate switch file to <tt>nsswitch.conf</tt>. See <a href="a12swit-22067.html">The <tt>nsswitch.conf</tt> Template Files</a>. You can also change the sources
of particular types of network information used by the client by editing the
appropriate lines of the <tt>/etc/nsswitch.conf</tt> file. The syntax is described below, and additional
instructions are provided in <a href="c8switch-18904.html#c8switch-2">How to Modify the Name Service Switch</a>.</p>

<a name="a12swit-84565"></a><h4>Format of the <tt>nsswitch.conf</tt> File</h4>
<p><a name="indexterm-28"></a>The <tt>nsswitch.conf</tt> file is essentially a list of 16 types of information and
the sources that <tt>getXXbyYY()</tt> routines search for that information. The 16 types
of information, not necessarily in this order, are the following.</p>
<ul><li><p><tt>aliases</tt></p></li>
<li><p><tt>bootparams</tt></p></li>
<li><p><tt>ethers</tt></p></li>
<li><p><tt>group</tt></p></li>
<li><p><tt>hosts</tt></p></li>
<li><p><tt>ipnodes</tt></p></li>
<li><p><tt>netgroup</tt></p></li>
<li><p><tt>netmasks</tt></p></li>
<li><p><tt>networks</tt></p></li>
<li><p><tt>passwd</tt>, which includes shadow information</p></li>
<li><p><tt>protocols</tt></p></li>
<li><p><tt>publickey</tt></p></li>
<li><p><tt>rpc</tt></p></li>
<li><p><tt>services</tt></p></li>
<li><p><tt>automount</tt></p></li>
<li><p><tt>sendmailvars</tt></p></li></ul>
<p>The following table provides a description of the kind of sources that can
be listed in the switch file for the information types above.</p><a name="a12swit-tbl-1"></a><h6>Table&nbsp;2-1 Switch File Information Sources</h6><table><col width="19%"><col width="80%"><tr><th align="left" valign="top" scope="column"><p>Information Sources</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>files</tt></p></td>
<td align="left" valign="top" scope="row"><p>A
file stored in the client's <tt>/etc</tt> directory. For example, <tt>/etc/passwd</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>nisplus</tt></p></td>
<td align="left" valign="top" scope="row"><p>An NIS+ table. For
example, the <tt>hosts</tt> table.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>nis</tt></p></td>
<td align="left" valign="top" scope="row"><p>An NIS map. For example, the <tt>hosts</tt> map.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>compat</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>compat</tt> can
be used for password and group information to support old-style + or -
syntax in <tt>/etc/passwd</tt>, <tt>/etc/shadow</tt>, and <tt>/etc/group</tt> files.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>dns</tt></p></td>
<td align="left" valign="top" scope="row"><p>Can be used to specify that
host information be obtained from DNS.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>ldap</tt></p></td>
<td align="left" valign="top" scope="row"><p>Can be used to specify entries be
obtained from the LDAP directory.</p></td>
</tr>
</table>

<a name="a12swit-39858"></a><h5>Search Criteria</h5>
<a name="indexterm-29"></a><p><b>Single Source.</b> If an information type has only one source, such as <tt>nisplus</tt> a
routine using the switch searches for the information in that source <b>only</b>. If the
routine finds the information, the routine returns a <tt>success</tt> status message. If the
routine does not find the information, the routine stops searching and returns a
different status message. What the routine does with the status message varies from
routine to routine.</p><p><b>Multiple Sources.</b>  If a table contains multiple sources for a given information type,
the switch directs the routine to  search in the first listed source.
If the routine finds the information, the routine returns a <tt>success</tt> status message.
If the routine does not find the information in the first source, the
routine tries the next source. The routine searches  all sources until the
routine has found the information, or until the routine is halted by a
<tt>return</tt> specification. If all of the listed sources are searched without finding the
information, the routine stops searching and returns a <tt>non-success</tt> status message.</p>

<a name="a12swit-2"></a><h5>Switch Status Messages</h5>
<a name="indexterm-30"></a><a name="indexterm-31"></a><p>If a routine finds the information, the routine returns a <tt>success</tt> status
message. If the routine does not find the information, the routine returns one
of three error status messages. Possible status messages are listed in the following
table.</p><a name="a12swit-tbl-3111"></a><h6>Table&nbsp;2-2 Switch Search Status Messages</h6><table><col width="22%"><col width="77%"><tr><th align="left" valign="top" scope="column"><p>Status Message</p></th>
<th align="left" valign="top" scope="column"><p>Meaning of Message</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>SUCCESS</tt></p></td>
<td align="left" valign="top" scope="row"><p>The requested entry was found in the specified source.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>UNAVAIL</tt></p></td>
<td align="left" valign="top" scope="row"><p>The
source is either unresponsive or  unavailable. In other words, neither the NIS+
table, the NIS map, nor the <tt>/etc</tt> file could be found or be
accessed.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>NOTFOUND</tt></p></td>
<td align="left" valign="top" scope="row"><p>The source responded with &ldquo;No such entry.&rdquo; In other words, the table, map,
or file was accessed but the needed information was not found.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>TRYAGAIN</tt></p></td>
<td align="left" valign="top" scope="row"><p>The source
is busy. The source might respond next time. In other words, the table,
map, or file was found, but could not respond to the query.</p></td>
</tr>
</table>

<a name="a12swit-3"></a><h5>Switch Action Options</h5>
<a name="indexterm-32"></a><a name="indexterm-33"></a><p>You can instruct the switch to respond to status messages with either of
the two <b>actions</b> shown in the following table.</p><a name="a12swit-32878"></a><h6>Table&nbsp;2-3 Responses to Switch Status Messages</h6><table><col width="22%"><col width="77%"><tr><th align="left" valign="top" scope="column"><p>Action</p></th>
<th align="left" valign="top" scope="column"><p>Meaning</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>return</tt></p></td>
<td align="left" valign="top" scope="row"><p>Stop looking for the information.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>continue</tt></p></td>
<td align="left" valign="top" scope="row"><p>Try
the next source.</p></td>
</tr>
</table>

<a name="a12swit-4"></a><h5>Default Search Criteria</h5>
<a name="indexterm-34"></a><p>The combination of <tt>nsswitch.conf</tt> file status message and action option determines what the
routine does at each step. The combination of status and action make up
the search <b>criteria</b>.</p><p><a name="indexterm-35"></a>The switch's default search criteria are the same for every source. As described
in terms of the status messages listed above, see the following.</p>
<ul><li><p><a name="indexterm-36"></a><tt>SUCCESS=return</tt>. Stop looking for the information. Proceed using the information that has been found.</p></li>
<li><p><a name="indexterm-37"></a><tt>UNAVAIL=continue</tt>. Go to the next <tt>nsswitch.conf</tt> file source and continue searching. If this source is the last or only source, return with a <tt>NOTFOUND</tt> status.</p></li>
<li><p><a name="indexterm-38"></a><tt>NOTFOUND=continue</tt>. Go to the next <tt>nsswitch.conf</tt> file source and continue searching. If this source is the last or only source, return with a <tt>NOTFOUND</tt> status.</p></li>
<li><p><a name="indexterm-39"></a><tt>TRYAGAIN=continue</tt>. Go to the next <tt>nsswitch.conf</tt> file source and continue searching. If this source is the last or only source, return with a <tt>NOTFOUND</tt> status.</p></li></ul>
<p><a name="indexterm-40"></a>You can change default search criteria by explicitly specifying some other criteria by
using the <i>STATUS=action</i> syntax shown above. For example, the default action for
a <tt>NOTFOUND</tt> condition is to continue the search to the next source. For
example, to specify for  <tt>networks</tt>, the search should stop in  a
 <tt>NOTFOUND</tt> condition, edit the <tt>networks</tt> line of the switch file. The
line would read as follows.</p><pre>networks: nis [NOTFOUND=return] files</pre><p>The <tt>networks: nis [NOTFOUND=return] files</tt> line specifies a nondefault criterion for the <tt>NOTFOUND</tt> status. Nondefault criteria are
delimited by square brackets.</p><p>In this example, the search routine behaves as follows:</p>
<ul><li><p>If the <tt>networks</tt> map is available, and contains the needed information, the routine returns with a <tt>SUCCESS</tt> status message.</p></li>
<li><p>If the <tt>networks</tt> map is not available, the routine returns with an <tt>UNAVAIL</tt> status message. By default, the routine continues to search the appropriate <tt>/etc</tt> file.</p></li>
<li><p>If the <tt>networks</tt> map is available and found, but the map does not contain the needed information, the routine returns with a <tt>NOTFOUND</tt> message. But, instead of continuing on to search the appropriate <tt>/etc</tt> file, which would be the default behavior, the routine stops searching.</p></li>
<li><p>If the <tt>networks</tt> map is busy, the routine returns with an <tt>TRYAGAIN</tt> status message and by default continues on to search the appropriate <tt>/etc</tt> file.</p></li></ul>

<hr><p><b>Note - </b>Lookups in the <tt>nsswitch.conf</tt> file are done in the order in which items
are listed. However, password updates are done in reverse order, unless otherwise specified
by using the <tt>passwd</tt> <tt>-r</tt> <i>repository</i> command. See <a href="a12swit-27155.html">The Switch File and Password Information</a> for more information.</p>
<hr>


<a name="a12swit-4a"></a><h5>What if the Syntax is Wrong?</h5>
<a name="indexterm-41"></a><a name="indexterm-42"></a><p>Client library routines contain compiled-in default entries that are used if an entry
in the <tt>nsswitch.conf</tt> file is either missing or syntactically incorrect. These entries are
the same as the switch file's defaults.</p><p>The name service switch assumes that the table and source names are spelled
correctly. If you misspell a table or source name, the switch uses default
values.</p>

<a name="a12swit-5"></a><h5><tt>Auto_home</tt> and <tt>Auto_master</tt></h5>
<a name="indexterm-43"></a><a name="indexterm-44"></a><a name="indexterm-45"></a><a name="indexterm-46"></a><p>The switch search criteria for the <tt>auto_home</tt> and <tt>auto_master</tt> tables and maps
is combined into one category, which is called <tt>automount</tt>.</p>

<a name="a12swit-6"></a><h5>Timezone and the Switch File</h5>
<a name="indexterm-47"></a><p><a name="indexterm-48"></a>The <tt>timezone</tt> table does not use the switch, so the table is not
included in the switch file's list. </p>

<a name="a12swit-8"></a><h4>Comments in <tt>nsswitch.conf</tt> Files</h4>
<a name="indexterm-49"></a><p><a name="indexterm-50"></a>Any <tt>nsswitch.conf</tt> file line beginning with a comment character (<tt>#</tt>) is interpreted as
a comment line. A comment line is ignored by routines that search the
file.</p><p>Characters preceding a comment mark <b>are</b> interpreted by routines that search the <tt>nsswitch.conf</tt>
file. Characters to the right of the comment mark are interpreted as comments
and ignored.</p><a name="a12swit-tbl-9"></a><h6>Table&nbsp;2-4 Switch File Comment Examples</h6><table><col width="30%"><col width="69%"><tr><th align="left" valign="top" scope="column"><p>Type of Line</p></th>
<th align="left" valign="top" scope="column"><p>Example</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Comment line.</p></td>
<td align="left" valign="top" scope="row"><p># hosts: nisplus [NOTFOUND=return] files</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Interpreted line.</p></td>
<td align="left" valign="top" scope="row"><p>hosts: nisplus [NOTFOUND=return]
file</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Partially interpreted line. The <tt>files</tt> element is not interpreted.</p></td>
<td align="left" valign="top" scope="row"><p>hosts: nisplus [NOTFOUND=return] # files</p></td>
</tr>
</table>

<a name="a12swit-10"></a><h4>Keyserver and <tt>publickey</tt> Entry in the Switch File</h4>

<hr><p><b>Caution - </b><a name="indexterm-51"></a><a name="indexterm-52"></a><a name="indexterm-53"></a>You must restart the keyserver after you make a change to <tt>nsswitch.conf</tt>.</p>
<hr>
<p>The keyserver reads the <tt>publickey</tt> entry in the name service switch configuration file
only when the keyserver is started. If you change the switch configuration file,
the keyserver does not register the changes until the keyserver is restarted.<tt></tt> </p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="a12swit-86415.html">Previous</a>
             </td>
             <td align="right">
                 <a href="a12swit-22067.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

