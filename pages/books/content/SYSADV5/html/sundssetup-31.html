<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Configuring the Directory Server to Enable Account Management - System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2009-01-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="sundssetup-26.html">Previous</a>
             </td>
             <td align="right">
                 <a href="sundssetup-40.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="intro-1.html">Part&nbsp;I&nbsp;About Naming and Directory Services</a></p>
<p class="toc level2"><a href="intro2ns-2.html">1.&nbsp;&nbsp;Naming and Directory Services (Overview)</a></p>
<p class="toc level2"><a href="a12swit-86415.html">2.&nbsp;&nbsp;The Name Service Switch (Overview)</a></p>
<p class="toc level1 tocsp"><a href="dnsadmin-1.html">Part&nbsp;II&nbsp;DNS Setup and Administration</a></p>
<p class="toc level2"><a href="dnsref-1.html">3.&nbsp;&nbsp;DNS Setup and Administration (Reference)</a></p>
<p class="toc level1 tocsp"><a href="nissetup-1.html">Part&nbsp;III&nbsp;NIS Setup and Administration</a></p>
<p class="toc level2"><a href="anis1-25461.html">4.&nbsp;&nbsp;Network Information Service (NIS) (Overview)</a></p>
<p class="toc level2"><a href="cnis1-25208.html">5.&nbsp;&nbsp;Setting Up and Configuring NIS Service</a></p>
<p class="toc level2"><a href="anis2-22217.html">6.&nbsp;&nbsp;Administering NIS (Tasks)</a></p>
<p class="toc level2"><a href="abtrbl-18694.html">7.&nbsp;&nbsp;NIS Troubleshooting</a></p>
<p class="toc level1 tocsp"><a href="ldapsetup-1.html">Part&nbsp;IV&nbsp;LDAP Naming Services Setup and Administration</a></p>
<p class="toc level2"><a href="overview-1.html">8.&nbsp;&nbsp;Introduction to LDAP Naming Services (Overview/Reference)</a></p>
<p class="toc level2"><a href="ldapsecure-1.html">9.&nbsp;&nbsp;LDAP Basic Components and Concepts (Overview)</a></p>
<p class="toc level2"><a href="planldap-1.html">10.&nbsp;&nbsp;Planning Requirements for LDAP Naming Services (Tasks)</a></p>
<p class="toc level2"><a href="sundssetup-13.html">11.&nbsp;&nbsp;Setting Up Sun Java System Directory Server With LDAP Clients (Tasks)</a></p>
<p class="toc level3"><a href="sundssetup-233.html">Configuring Sun Java System Directory Server Using <tt>idsconfig</tt></a></p>
<p class="toc level3"><a href="sundssetup-1.html">Using Service Search Descriptors to Modify Client Access to Various Services</a></p>
<p class="toc level3"><a href="sundssetup-33.html">Running <tt>idsconfig</tt></a></p>
<p class="toc level3"><a href="sundssetup-70.html">Populating the Directory Server Using <tt>ldapaddent</tt></a></p>
<p class="toc level3"><a href="sundssetup-27.html">Managing Printer Entries</a></p>
<p class="toc level3"><a href="sundssetup-26.html">Populating the Directory Server With Additional Profiles</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Configuring the Directory Server to Enable Account Management</a></p>
</div>
<p class="toc level3"><a href="sundssetup-40.html">Migrating Your Sun Java System Directory Server</a></p>
<p class="toc level2 tocsp"><a href="clientsetup-1.html">12.&nbsp;&nbsp;Setting Up LDAP Clients (Tasks)</a></p>
<p class="toc level2"><a href="setupproblems-1.html">13.&nbsp;&nbsp;LDAP Troubleshooting (Reference)</a></p>
<p class="toc level2"><a href="schemas-1.html">14.&nbsp;&nbsp;LDAP General Reference (Reference)</a></p>
<p class="toc level2"><a href="nis2ldap-34.html">15.&nbsp;&nbsp;Transitioning From NIS to LDAP (Overview/Tasks)</a></p>
<p class="toc level2"><a href="nisplus2ldap-1.html">16.&nbsp;&nbsp;Transitioning From NIS+ to LDAP</a></p>
<p class="toc level1 tocsp"><a href="ghnmu.html">Part&nbsp;V&nbsp;Active Directory Naming Service</a></p>
<p class="toc level2"><a href="ghnov.html">17.&nbsp;&nbsp;Setting Up Solaris Active Directory Clients</a></p>
<p class="toc level1 tocsp"><a href="whatsnew-1.html">A.&nbsp;&nbsp;Solaris 10 Software Updates to DNS, NIS, and LDAP</a></p>
<p class="toc level2"><a href="whatsnew-5.html">Service Management Facility Changes</a></p>
<p class="toc level2"><a href="whatsnew-2.html">DNS BIND</a></p>
<p class="toc level2"><a href="schemas-290.html"><tt>pam_ldap</tt> Changes</a></p>
<p class="toc level2"><a href="whatsnew-3.html">Documentation Errors</a></p>
<p class="toc level1 tocsp"><a href="aagloss-87604.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="sundssetup-31"></a><h3>Configuring the Directory Server to Enable Account Management</h3>
<p>In order for <tt>pam_ldap</tt> to work properly, the password and account lockout policy
must be properly configured on the server. You can use the Directory Server
Console or <tt>ldapmodify</tt> to configure the account management policy for the LDAP directory.
For procedures and more information, see the &ldquo;User Account Management&rdquo; chapter in the
<i>Administration Guide</i> for the version of Sun Java System Directory Server that you
are using.</p>
<hr><p><b>Note - </b>Previously, if you enabled <tt>pam_ldap</tt> account management, all users needed to provide a
login password for authentication any time they logged in to the system. Therefore,
nonpassword-based logins using tools such as <tt>rsh</tt>, <tt>rlogin</tt>, or <tt>ssh</tt> would fail.</p><p>Now, however, <a href="http://docs.sun.com/doc/819-2252/pam-ldap-5?a=view"><tt>pam_ldap</tt>(5)</a>, when used with Sun Java System Directory Servers DS5.2p4 and
newer releases, enables users to log in with <tt>rsh</tt>, <tt>rlogin</tt>, <tt>rcp</tt> and
<tt>ssh</tt> without giving a password.</p><p><a href="http://docs.sun.com/doc/819-2252/pam-ldap-5?a=view"><tt>pam_ldap</tt>(5)</a> is now modified to do account management and retrieve the account status
of users without authenticating to Directory Server as the user logging in. The
new control to this on Directory Server is 1.3.6.1.4.1.42.2.27.9.5.8, which is enabled by
default.</p><p>To modify this control for other than default, add Access Control Instructions (ACI) on
Directory Server:</p><pre>dn: oid=1.3.6.1.4.1.42.2.27.9.5.8,cn=features,cn=config
objectClass: top
objectClass: directoryServerFeature
oid:1.3.6.1.4.1.42.2.27.9.5.8
cn:Password Policy Account Usable Request Control
aci: (targetattr != "aci")(version 3.0; acl "Account Usable"; 
     allow (read, search, compare, proxy)
     (groupdn = "ldap:///cn=Administrators,cn=config");)
creatorsName: cn=server,cn=plugins,cn=config
modifiersName: cn=server,cn=plugins,cn=config</pre>
<hr>
<p>Passwords for <tt>proxy</tt> users should <b>never</b> be allowed to expire.  If proxy
passwords expire, clients using the <tt>proxy</tt> credential level  cannot retrieve naming service
information from the server. To ensure that proxy users have passwords that do
not expire, modify the proxy accounts with the following script.</p><pre># <tt><b>ldapmodify</b></tt> <tt>-h</tt> <tt><b></tt><i>ldapserver</i><tt></b></tt> <tt>-D</tt> <tt><b></tt><i>administrator DN</i><tt> \</b></tt>
<tt><b></b></tt><tt>-w</tt> <tt><b></tt><i>administrator password</i><tt> &lt;&lt;EOF</b></tt>
<tt><b>dn: </tt><i>proxy user DN</i><tt></b></tt>
<tt><b>DNchangetype: modify</b></tt>
<tt><b>replace: passwordexpirationtime</b></tt>
<tt><b>passwordexpirationtime: 20380119031407Z</b></tt>
<tt><b>EOF</b></tt></pre>
<hr><p><b>Note - </b><tt>pam_ldap</tt> account management relies on Sun Java System Directory Server to maintain and
provide password aging and account expiration information for users. The directory server does
not interpret the corresponding data from shadow entries to validate user accounts. <tt>pam_unix</tt>,
however, examines the shadow data to determine if accounts are locked or if
passwords are aged. Since the shadow data is not kept up to date
by the LDAP naming services or the directory server, <tt>pam_unix</tt> should not grant access
based on the shadow data. The shadow data is retrieved using the
<tt>proxy</tt> identity.  Therefore, do not allow <tt>proxy</tt> users to have read access
to the <tt>userPassword</tt> attribute. Denying <tt>proxy</tt> users read access to <tt>userPassword</tt> prevents
<tt>pam_unix</tt> from making an invalid account validation.</p>
<hr>

         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="sundssetup-26.html">Previous</a>
             </td>
             <td align="right">
                 <a href="sundssetup-40.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

