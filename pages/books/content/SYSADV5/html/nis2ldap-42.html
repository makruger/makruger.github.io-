<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Reverting to NIS - System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2009-01-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="nis2ldap-58.html">Previous</a>
             </td>
             <td align="right">
                 <a href="nisplus2ldap-1.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="intro-1.html">Part&nbsp;I&nbsp;About Naming and Directory Services</a></p>
<p class="toc level2"><a href="intro2ns-2.html">1.&nbsp;&nbsp;Naming and Directory Services (Overview)</a></p>
<p class="toc level2"><a href="a12swit-86415.html">2.&nbsp;&nbsp;The Name Service Switch (Overview)</a></p>
<p class="toc level1 tocsp"><a href="dnsadmin-1.html">Part&nbsp;II&nbsp;DNS Setup and Administration</a></p>
<p class="toc level2"><a href="dnsref-1.html">3.&nbsp;&nbsp;DNS Setup and Administration (Reference)</a></p>
<p class="toc level1 tocsp"><a href="nissetup-1.html">Part&nbsp;III&nbsp;NIS Setup and Administration</a></p>
<p class="toc level2"><a href="anis1-25461.html">4.&nbsp;&nbsp;Network Information Service (NIS) (Overview)</a></p>
<p class="toc level2"><a href="cnis1-25208.html">5.&nbsp;&nbsp;Setting Up and Configuring NIS Service</a></p>
<p class="toc level2"><a href="anis2-22217.html">6.&nbsp;&nbsp;Administering NIS (Tasks)</a></p>
<p class="toc level2"><a href="abtrbl-18694.html">7.&nbsp;&nbsp;NIS Troubleshooting</a></p>
<p class="toc level1 tocsp"><a href="ldapsetup-1.html">Part&nbsp;IV&nbsp;LDAP Naming Services Setup and Administration</a></p>
<p class="toc level2"><a href="overview-1.html">8.&nbsp;&nbsp;Introduction to LDAP Naming Services (Overview/Reference)</a></p>
<p class="toc level2"><a href="ldapsecure-1.html">9.&nbsp;&nbsp;LDAP Basic Components and Concepts (Overview)</a></p>
<p class="toc level2"><a href="planldap-1.html">10.&nbsp;&nbsp;Planning Requirements for LDAP Naming Services (Tasks)</a></p>
<p class="toc level2"><a href="sundssetup-13.html">11.&nbsp;&nbsp;Setting Up Sun Java System Directory Server With LDAP Clients (Tasks)</a></p>
<p class="toc level2"><a href="clientsetup-1.html">12.&nbsp;&nbsp;Setting Up LDAP Clients (Tasks)</a></p>
<p class="toc level2"><a href="setupproblems-1.html">13.&nbsp;&nbsp;LDAP Troubleshooting (Reference)</a></p>
<p class="toc level2"><a href="schemas-1.html">14.&nbsp;&nbsp;LDAP General Reference (Reference)</a></p>
<p class="toc level2"><a href="nis2ldap-34.html">15.&nbsp;&nbsp;Transitioning From NIS to LDAP (Overview/Tasks)</a></p>
<p class="toc level3"><a href="nis2ldap-35.html">NIS-to-LDAP Service Overview</a></p>
<p class="toc level3"><a href="nis2ldap-6.html">Transitioning From NIS to LDAP (Task Map)</a></p>
<p class="toc level3"><a href="nis2ldap-15.html">Prerequisites for the NIS-to-LDAP Transition</a></p>
<p class="toc level3"><a href="nis2ldap-2.html">Setting Up the NIS-to-LDAP Service</a></p>
<p class="toc level3"><a href="nis2ldap-16.html">NIS-to-LDAP Best Practices With Sun Java System Directory Server</a></p>
<p class="toc level3"><a href="nis2ldap-24.html">NIS-to-LDAP Restrictions</a></p>
<p class="toc level3"><a href="nis2ldap-58.html">NIS-to-LDAP Troubleshooting</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Reverting to NIS</a></p>
</div>
<p class="toc level2 tocsp"><a href="nisplus2ldap-1.html">16.&nbsp;&nbsp;Transitioning From NIS+ to LDAP</a></p>
<p class="toc level1 tocsp"><a href="ghnmu.html">Part&nbsp;V&nbsp;Active Directory Naming Service</a></p>
<p class="toc level2"><a href="ghnov.html">17.&nbsp;&nbsp;Setting Up Solaris Active Directory Clients</a></p>
<p class="toc level1 tocsp"><a href="whatsnew-1.html">A.&nbsp;&nbsp;Solaris 10 Software Updates to DNS, NIS, and LDAP</a></p>
<p class="toc level2"><a href="whatsnew-5.html">Service Management Facility Changes</a></p>
<p class="toc level2"><a href="whatsnew-2.html">DNS BIND</a></p>
<p class="toc level2"><a href="schemas-290.html"><tt>pam_ldap</tt> Changes</a></p>
<p class="toc level2"><a href="whatsnew-3.html">Documentation Errors</a></p>
<p class="toc level1 tocsp"><a href="aagloss-87604.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="nis2ldap-42"></a><h3>Reverting to NIS</h3>
<a name="indexterm-582"></a><a name="indexterm-583"></a><a name="indexterm-584"></a><p>A site that has transitioned from NIS to LDAP using the N2L
service is expected to gradually replace all NIS clients with Solaris LDAP naming services
clients. Support for NIS clients eventually becomes redundant. However, if required, the N2L
service provides two ways to return to traditional NIS, as explained in the
next two procedures.</p>
<hr><p><b>Tip - </b>Traditional NIS ignores the N2L versions of the NIS maps if those maps
are present. After reverting to NIS, if you leave the N2L versions
of the maps on the server, the N2L maps do not cause problems.
Therefore, it might be useful to keep the N2L maps in case you
later decide to re-enable N2L. However, the maps do take up disk space.</p>
<hr>


<a name="nis2ldap-proc-43"></a><h4>How to Revert to Maps Based on Old Source Files</h4><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-1?a=view">Chapter 9, Using Role-Based Access Control (Tasks), in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="nis2ldap-step-44"></a><b>Stop the <tt>NIS</tt> daemons.</b><pre># <tt><b>svcadm disable network/nis/server:default</b></tt></pre></li>
<li><a name="nis2ldap-step-45"></a><b>Disable N2L.</b><p>This command backs up and moves the N2L mapping file.</p><pre># <tt><b>mv /var/yp/NISLDAPmapping </tt><i>backup_filename</i><tt></b></tt></pre></li>
<li><a name="nis2ldap-step-27"></a><b>Set the <tt>NOPUSH</tt> environment variable so the new maps are not pushed by
<tt>ypmake</tt>.</b><pre># <tt><b>NOPUSH=1</b></tt></pre></li>
<li><a name="nis2ldap-step-46"></a><b>Make a new set of NIS maps that are based on the old
sources.</b><pre># <tt><b>cd /var/yp</b></tt>
# <tt><b>make</b></tt></pre></li>
<li><a name="nis2ldap-step-47"></a><b>(<b>Optional</b>) Remove N2L versions of the NIS maps.</b><pre># <tt><b>rm /var/yp/</tt><i>domainname</i><tt>/LDAP_*</b></tt></pre></li>
<li><a name="nis2ldap-step-48"></a><b>Start the <tt>NIS</tt> daemons.</b><pre># <tt><b>svcadm enable network/nis/server:default</b></tt></pre></li></ol>

<a name="nis2ldap-proc-49"></a><h4>How to Revert to Maps Based on Current DIT Contents</h4><p>Back up the old NIS source files before performing this procedure. </p><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-1?a=view">Chapter 9, Using Role-Based Access Control (Tasks), in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="nis2ldap-step-50"></a><b>Stop the <tt>NIS</tt> daemons.</b><pre># <tt><b>svcadm disable network/nis/server:default</b></tt></pre></li>
<li><a name="nis2ldap-step-51"></a><b>Update the maps from the DIT.</b><pre># <tt><b>ypserv</b></tt> <tt>-r</tt><tt><b></b></tt></pre><p>Wait for <tt>ypserv</tt> to exit.</p></li>
<li><a name="nis2ldap-step-53"></a><b>Disable N2L.</b><p>This command backs up and moves the N2L mapping file.</p><pre># <tt><b>mv /var/yp/NISLDAPmapping </tt><i>backup_filename</i><tt></b></tt></pre></li>
<li><a name="nis2ldap-step-54"></a><b>Regenerate the NIS source files.</b><pre># <tt><b>ypmap2src</b></tt></pre></li>
<li><a name="nis2ldap-step-55"></a><b>Manually check that regenerated NIS source files have the correct content and structure.</b></li>
<li><a name="nis2ldap-step-49"></a><b>Move the regenerated NIS source files to the appropriate directories.</b></li>
<li><a name="nis2ldap-step-56"></a><b>(<b>Optional</b>) Remove the N2L versions of the mapping files.</b><pre># <tt><b>rm /var/yp/</tt><i>domainname</i><tt>/LDAP_*</b></tt></pre></li>
<li><a name="nis2ldap-step-57"></a><b>Start the <tt>NIS</tt> daemons.</b><pre># <tt><b>svcadm enable network/nis/server:default</b></tt></pre></li></ol>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="nis2ldap-58.html">Previous</a>
             </td>
             <td align="right">
                 <a href="nisplus2ldap-1.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

