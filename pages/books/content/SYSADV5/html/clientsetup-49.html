<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Initializing an LDAP Client - System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2009-01-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="clientsetup-95.html">Previous</a>
             </td>
             <td align="right">
                 <a href="clientsetup-59.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="intro-1.html">Part&nbsp;I&nbsp;About Naming and Directory Services</a></p>
<p class="toc level2"><a href="intro2ns-2.html">1.&nbsp;&nbsp;Naming and Directory Services (Overview)</a></p>
<p class="toc level2"><a href="a12swit-86415.html">2.&nbsp;&nbsp;The Name Service Switch (Overview)</a></p>
<p class="toc level1 tocsp"><a href="dnsadmin-1.html">Part&nbsp;II&nbsp;DNS Setup and Administration</a></p>
<p class="toc level2"><a href="dnsref-1.html">3.&nbsp;&nbsp;DNS Setup and Administration (Reference)</a></p>
<p class="toc level1 tocsp"><a href="nissetup-1.html">Part&nbsp;III&nbsp;NIS Setup and Administration</a></p>
<p class="toc level2"><a href="anis1-25461.html">4.&nbsp;&nbsp;Network Information Service (NIS) (Overview)</a></p>
<p class="toc level2"><a href="cnis1-25208.html">5.&nbsp;&nbsp;Setting Up and Configuring NIS Service</a></p>
<p class="toc level2"><a href="anis2-22217.html">6.&nbsp;&nbsp;Administering NIS (Tasks)</a></p>
<p class="toc level2"><a href="abtrbl-18694.html">7.&nbsp;&nbsp;NIS Troubleshooting</a></p>
<p class="toc level1 tocsp"><a href="ldapsetup-1.html">Part&nbsp;IV&nbsp;LDAP Naming Services Setup and Administration</a></p>
<p class="toc level2"><a href="overview-1.html">8.&nbsp;&nbsp;Introduction to LDAP Naming Services (Overview/Reference)</a></p>
<p class="toc level2"><a href="ldapsecure-1.html">9.&nbsp;&nbsp;LDAP Basic Components and Concepts (Overview)</a></p>
<p class="toc level2"><a href="planldap-1.html">10.&nbsp;&nbsp;Planning Requirements for LDAP Naming Services (Tasks)</a></p>
<p class="toc level2"><a href="sundssetup-13.html">11.&nbsp;&nbsp;Setting Up Sun Java System Directory Server With LDAP Clients (Tasks)</a></p>
<p class="toc level2"><a href="clientsetup-1.html">12.&nbsp;&nbsp;Setting Up LDAP Clients (Tasks)</a></p>
<p class="toc level3"><a href="clientsetup-48.html">Prerequisites to LDAP Client Setup</a></p>
<p class="toc level3"><a href="clientsetup-95.html">LDAP and the Service Management Facility</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Initializing an LDAP Client</a></p>
</div>
<p class="toc level3"><a href="clientsetup-59.html">Retrieving LDAP Naming Services Information</a></p>
<p class="toc level3"><a href="clientsetup-63.html">Customizing the LDAP Client Environment</a></p>
<p class="toc level2 tocsp"><a href="setupproblems-1.html">13.&nbsp;&nbsp;LDAP Troubleshooting (Reference)</a></p>
<p class="toc level2"><a href="schemas-1.html">14.&nbsp;&nbsp;LDAP General Reference (Reference)</a></p>
<p class="toc level2"><a href="nis2ldap-34.html">15.&nbsp;&nbsp;Transitioning From NIS to LDAP (Overview/Tasks)</a></p>
<p class="toc level2"><a href="nisplus2ldap-1.html">16.&nbsp;&nbsp;Transitioning From NIS+ to LDAP</a></p>
<p class="toc level1 tocsp"><a href="ghnmu.html">Part&nbsp;V&nbsp;Active Directory Naming Service</a></p>
<p class="toc level2"><a href="ghnov.html">17.&nbsp;&nbsp;Setting Up Solaris Active Directory Clients</a></p>
<p class="toc level1 tocsp"><a href="whatsnew-1.html">A.&nbsp;&nbsp;Solaris 10 Software Updates to DNS, NIS, and LDAP</a></p>
<p class="toc level2"><a href="whatsnew-5.html">Service Management Facility Changes</a></p>
<p class="toc level2"><a href="whatsnew-2.html">DNS BIND</a></p>
<p class="toc level2"><a href="schemas-290.html"><tt>pam_ldap</tt> Changes</a></p>
<p class="toc level2"><a href="whatsnew-3.html">Documentation Errors</a></p>
<p class="toc level1 tocsp"><a href="aagloss-87604.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="clientsetup-49"></a><h3>Initializing an LDAP Client</h3>
<p><a href="http://docs.sun.com/doc/819-2240/ldapclient-1m?a=view"><tt>ldapclient</tt>(1M)</a> is a utility used to set up LDAP clients in the
Solaris system. <tt>ldapclient</tt> assumes the server has already been configured with the appropriate client
profiles. You must install and configure the server with the appropriate profiles before
you can set up clients.</p>
<hr><p><b>Note - </b>The Solaris operating system does not support a configuration in which a NIS
client and a Native LDAP client co-exist on the same client machine.</p>
<hr>
<p>There are two main ways to set up a client by using
<tt>ldapclient</tt>.</p>
<ul><li><p><b>Profile</b></p><p>At a minimum, you need to specify the server address containing the profile and domain you want to use. If no profile is specified, then the &ldquo;default&rdquo; profile is assumed. The server will provide the rest of the required information, except for proxy and certificate database information. If a client's credential level is <tt>proxy</tt> or <tt>proxy anonymous</tt>, you must supply the proxy bind DN and password. See <a href="ldapsecure-66.html#ldapsecure-74">Assigning Client Credential Levels</a> for more information.</p></li>
<li><p><b>Manual</b></p><p>You configure the profile on the client itself, which means defining all parameters from the command line. Thus, the profile information is stored in cache files and is never refreshed by the server.</p></li></ul>

<hr><p><b>Note - </b>Though you can manually configure clients, it is not recommended. Using the configuration
profiles decreases the complexity and cost of managing clients.</p>
<hr>


<a name="clientsetup-50"></a><h4>Using Profiles to Initialize a Client</h4>


<a name="clientsetup-proc-52"></a><h5>How to Initialize a Client Using Profiles</h5>
<ol>
<li><a name="clientsetup-step-79"></a><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-1?a=view">Chapter 9, Using Role-Based Access Control (Tasks), in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="clientsetup-step-53"></a><b>Run <tt>ldapclient</tt> with <tt>init</tt>.</b><pre># <tt><b>ldapclient init \</b></tt>
<tt><b></b></tt><tt>-a</tt> <tt><b>profileName=new \</b></tt>
<tt><b></b></tt><tt>-a</tt> <tt><b>domainName=west.example.com 192.168.0.1</b></tt>
System successfully configured</pre></li></ol>

<a name="gdzpf"></a><h4>Using Per-User Credentials</h4>

<hr><p><b>Note - </b>Do not edit either of the client configuration files directly. Use <tt>ldapclient</tt> to
create or modify the content of these files.</p>
<hr>


<a name="gdzpl"></a><h5>How to Initialize a Client Using Per-User Credentials</h5>
<h6>Before You Begin</h6><p>Before you set up a client with per-user credentials the following items must
already be configured:</p>
<ul><li><p>One or more Kerberos KDC servers must be configured and running.</p></li>
<li><p>DNS, client access to a DNS server, and at least one DNS server, must be configured and running.</p></li>
<li><p>Kerberos on the client machine must be configured and enabled.</p></li>
<li><p>A Kerberos client installation profile must exist. Such a profile might be:</p><pre># cat /usr/tmp/krb5.profile
REALM SPARKS.COM
KDC kdc.example.com
ADMIN super/admin
FILEPATH /usr/tmp/krb5.conf
NFS 1
DNSLOOKUP none</pre></li>
<li><p>The LDAP server must be installed and configured to support the <tt>sasl/GSSAPI</tt>. </p></li>
<li><p>Appropriate identity mapping configurations must exist.</p></li>
<li><p>Kerberos host principals for the directory server and the KDC must be set up in the KDC.</p></li>
<li><p><tt>idsconfig</tt> must have been run on the directory server DIT to be used.</p></li>
<li><p>An appropriate per-user profile gssapi profile (such as <tt>gssapi_EXAMPLE.COM</tt>) must have been created.</p><p>An illustration of a per-user profile in idsconfig is shown in the following partial example:</p><pre># /usr/lib/ldap/idsconfig
Do you wish to continue with server setup (y/n/h)? [n] y
Enter the iPlanet Directory Server's (iDS) hostname to setup: kdc.example.com
Enter the port number for iDS (h=help): [389] &lt;Enter your port&gt;
Enter the directory manager DN: [cn=Directory Manager] &lt;Enter your DN&gt;
Enter passwd for cn=Directory Manager : &lt;Enter your password&gt;
Enter the domainname to be served (h=help): [example.com] &lt;Enter your domain&gt;
Enter LDAP Base DN (h=help): [dc=example,dc=com] &lt;Enter your DN&gt;
GSSAPI is supported. Do you want to set up gssapi:(y/n) [n] y
Enter Kerberos Realm: [EXAMPLE.COM] EXAMPLE.COM
You can create a sasl/GSSAPI enabled profile with default values now.
Do you want to create a sasl/GSSAPI default profile ? [n] y
Enter. the profile name (h=help): [gssapi_EXAMPLE.COM] &lt;Enter&gt;
GSSAPI setup is done. ...</pre></li>
<li><p>The necessary user principals must exist in the Key Distribution Center (KDC).</p></li>
<li><p>On the client machine, Kerberos must be initialized using the client profile with a command such as:</p><p><tt><b># /usr/sbin/kclient -p /usr/tmp/krb5.profile</b></tt></p></li>
<li><p><tt>/etc/nsswitch.ldap</tt> must be configured to use dns for hosts and ipnodes like this:</p><p>host: files dns</p><p>ipnodes: files dns</p><p>(Modify this file with an editor as necessary)</p></li>
<li><p><tt>/etc/resolv.conf</tt> must be configured and the dns service must be running (See the DNS chapters in this document for details)</p></li>
<li><p>The directory server DIT must be pre-loaded with (at a minimum) the users of this client machine, the client host and necessary auto_home LDAP entries. See other sections of this manual for details on how to add entries using <tt>ldapaddent</tt>.</p></li></ul>
<ol>
<li><b>Run<tt><b> ldapclient init</b></tt> to initialize the client using the gssapi profile</b><p><tt><b># /usr/sbin/ldapclient init -a profilename=gssapi_SPARKS.COM -a \</b></tt></p><p><tt><b>domainname=example.com 9.9.9.50</b></tt></p></li>
<li><b>Try to log in as a user:</b><p>Run <tt><b>kinit -p user</b></tt>.</p><p>Run <tt><b>ldaplist -l passwd</b></tt> user in user's login session and you should see &ldquo;userpassword.&rdquo;</p><p>But <tt><b>ldaplist -l passwd bar</b></tt> can get the entry without <tt><b>userpassword</b></tt>. By default root can still
see <tt>userpassword</tt> of everybody.</p></li></ol><h6>More Information<br>Notes About Using Per-User Credentials
<ul><li><p>If the syslog has messages: <tt>libsldap: Status: 7 Mesg: openConnection: GSSAPI bind failed - 82 Local error</tt>, it is likely that Kerberos is not initialized or its ticket is expired. Run <tt><b>klist</b></tt> to browse it. Run <tt><b>kinit -p foo</b></tt> or <tt><b>kinit -R -p foo</b></tt> and try again.</p></li>
<li><p>If you want to, you can add <tt><b>pam_krb5.so.1</b></tt> to <tt>/etc/pam.conf</tt> so it will automatically <tt>kinit</tt> when you log in.</p></li>
<li><p>For example:</p><pre><tt><b>login auth optional pam_krb5.so.1 </b></tt></pre><pre><tt><b>rlogin auth optional pam_krb5.so.1</b></tt></pre><pre><tt><b>other auth optional pam_krb5.so.1</b></tt></pre></li>
<li><p>If a user is <tt>kinited</tt> and the syslog message indicates <tt>Invalid credential</tt>, then the problem could be the host entry (root) or user entry is not in LDAP directory or mapping rules are not correct.</p></li>
<li><p>When <tt>ldapclient init</tt> is executed, it makes some checks if the LDAP profile contains self/ sasl/GSSAPI configuration. If it fails at <tt>/etc/nsswitch.ldap</tt> check, then the usual reason is that dns was not added to <tt>host:</tt> and <tt>ipnodes:</tt>.</p></li>
<li><p>If it fails because the DNS client not enabled, run <tt><b>svcs -l dns/client</b></tt> to see if <tt>/etc/resolv.conf</tt> is missing or it is just disabled. Run <tt><b>svcadm enable dns/client</b></tt> to enable it.</p></li>
<li><p>If the check fails because of sasl/GSSAPI bind, check syslog to find out what went wrong.</p></li></ul>
<p>See other references in this guide and in the <a href="http://docs.sun.com/doc/819-3321"><i>System Administration Guide: Security Services</i></a> for details.</p></h6>

<a name="clientsetup-90"></a><h4>Using Proxy Credentials</h4>


<a name="clientsetup-proc-54"></a><h5>How to Initialize a Client Using Proxy Credentials</h5>

<hr><p><b>Note - </b><b>Do not</b> edit either of the client configuration files directly.  Use <tt>ldapclient</tt> to
create or modify the content of these files.</p>
<hr>
<ol>
<li><a name="clientsetup-step-80"></a><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-1?a=view">Chapter 9, Using Role-Based Access Control (Tasks), in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="clientsetup-step-55"></a><b>Run <tt>ldapclient</tt> (defining proxy values).</b><pre># <tt><b>ldapclient init \</b></tt>
<tt><b></b></tt><tt>-a</tt> <tt><b>proxyDN=cn=proxyagent,ou=profile,dc=west,dc=example,dc=com \</b></tt>
<tt><b></b></tt><tt>-a</tt> <tt><b>domainName=west.example.com \</b></tt>
<tt><b></b></tt><tt>-a</tt> <tt><b>profileName=pit1 \</b></tt>
<tt><b></b></tt><tt>-a</tt> <tt><b>proxyPassword=test1234 192.168.0.1</b></tt>
System successfully configured</pre><p>The <tt>-a</tt> proxyDN and <tt>-a</tt> proxyPassword are <b>required</b> if the profile to be
used is set up for <tt>proxy</tt>.  As the credentials are not
stored in the profile saved on the server, you must supply the information
when you initialize the client.  This method is more secure than the
older method of storing the proxy credentials on the server.</p><p>The proxy information is used to create <tt>/var/ldap/ldap_client_cred</tt>. The rest of the
information is put in <tt>/var/ldap/ldap_client_file</tt>.</p></li></ol>

<a name="clientsetup-51"></a><h4>Initializing a Client Manually</h4>
<p>Superusers. or administrators with an equivalent role, can perform manual client configurations. However,
many of the checks are bypassed during the process, so it is relatively
easy to misconfigure your system.  In addition, you must change settings <b>on every machine</b>,
instead of in one central place, as is done when using profiles.</p>

<a name="clientsetup-proc-75"></a><h5>How to Initialize a Client Manually</h5>
<ol>
<li><a name="clientsetup-step-81"></a><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-1?a=view">Chapter 9, Using Role-Based Access Control (Tasks), in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="clientsetup-step-76"></a><b>Use <tt>ldapclient manual</tt> to initialize the client.</b><pre># <tt><b>ldapclient manual \</b></tt>
<tt><b></b></tt><tt>-a</tt> <tt><b>domainName=dc=west.example.com \</b></tt>
<tt><b></b></tt><tt>-a</tt> <tt><b>credentialLevel=proxy \</b></tt>
<tt><b></b></tt><tt>-a</tt> <tt><b>defaultSearchBase=dc=west,dc=example,dc=com \</b></tt> 
<tt><b></b></tt><tt>-a</tt> <tt><b>proxyDN=cn=proxyagent,ou=profile,dc=west,dc=example,dc=com \</b></tt> 
<tt><b></b></tt><tt>-a</tt> <tt><b>proxyPassword=testtest 192.168.0.1</b></tt></pre></li>
<li><a name="clientsetup-step-77"></a><b>Use <tt>ldapclient list</tt> to verify.</b><pre>NS_LDAP_FILE_VERSION= 2.0
NS_LDAP_BINDDN= cn=proxyagent,ou=profile,dc=west,dc=example,dc=com
NS_LDAP_BINDPASSWD= {NS1}4a3788e8c053424f
NS_LDAP_SERVERS= 192.168.0.1
NS_LDAP_SEARCH_BASEDN= dc=west,dc=example,dc=com
NS_LDAP_CREDENTIAL_LEVEL= proxy</pre></li></ol>

<a name="clientsetup-78"></a><h4>Modifying a Manual Client Configuration</h4>


<a name="clientsetup-proc-84"></a><h5>How to Modify a Manual Configuration</h5>
<ol>
<li><a name="clientsetup-step-87"></a><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-1?a=view">Chapter 9, Using Role-Based Access Control (Tasks), in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="clientsetup-step-85"></a><b>Use the <tt>ldapclient mod</tt> command to change the authentication method to <tt>simple</tt>.</b><pre># <tt><b>ldapclient mod</b></tt> <tt>-a</tt> <tt><b>authenticationMethod=simple</b></tt></pre></li>
<li><a name="clientsetup-step-86"></a><b>Use <tt>ldapclient list</tt> to verify the change was made.</b><pre># <tt><b>ldapclient list</b></tt>
NS_LDAP_FILE_VERSION= 2.0
NS_LDAP_BINDDN= cn=proxyagent,ou=profile,dc=west,dc=example,dc=com
NS_LDAP_BINDPASSWD= {NS1}4a3788e8c053424f
NS_LDAP_SERVERS= 192.168.0.1
NS_LDAP_SEARCH_BASEDN= dc=west,dc=example,dc=com
NS_LDAP_AUTH= simple
NS_LDAP_CREDENTIAL_LEVEL= proxy</pre></li></ol><h6>Troubleshooting</h6><p>You cannot change some attributes of an LDAP client configuration by using the
<tt>mod</tt> subcommand. For example, you cannot change the <tt>profileName</tt> and <tt>profileTTL</tt> attributes. To change
these attributes, create a new profile by using the <tt>ldapclient init</tt> command, as
described in <a href="#clientsetup-50">Using Profiles to Initialize a Client</a>. Or, run the <tt>ldapclient manual</tt> command, as described in <a href="#clientsetup-51">Initializing a Client Manually</a>.</p>

<a name="clientsetup-71"></a><h4>Uninitializing a Client</h4>
<p><tt>ldapclient uninit</tt> restores the client name service to what it was prior to the
most recent <tt>init</tt>, <tt>modify</tt>, or <tt>manual</tt> operation. In other words, it performs an
&ldquo;undo&rdquo; on the last step taken. For example, if the client was configured
to use <tt>profile1</tt> and was then changed to use <tt>profile2</tt>, using <tt>ldapclient uninit</tt> would
revert the client back to using  <tt>profile1</tt>.</p>

<a name="clientsetup-proc-72"></a><h5>How to Uninitialize a Client</h5>
<ol>
<li><a name="clientsetup-step-82"></a><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-1?a=view">Chapter 9, Using Role-Based Access Control (Tasks), in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="clientsetup-step-83"></a><b>Use <tt>ldapclient uninit</tt>.</b><pre># <tt><b>ldapclient uninit</b></tt>
System successfully recovered</pre></li></ol>

<a name="clientsetup-57"></a><h4>Setting Up TLS Security</h4>

<hr><p><b>Note - </b>The security database files must be readable by everyone. Do not include any
private keys in the <tt>key3.db</tt>.</p>
<hr>
<p>If using TLS, the necessary security databases must be installed. In particular, the
certificate and key database files  are needed. For example, if you adopt
an older database format from Netscape Communicator, two files, <tt>cert7.db</tt> and <tt>key3.db</tt>,
are required. Or if you use a new database format from Mozilla, three
files, <tt>cert8.db</tt>, <tt>key3.db</tt> and <tt>secmod.db</tt> are needed. The <tt>cert7.db</tt> or <tt>cert8.db</tt> file
contains trusted certificates. The <tt>key3.db</tt> file contains the client's keys. Even if the LDAP
naming service client does not use client keys, this file must be present.
The <tt>secmod.db</tt> file contains the security modules such as <tt>PKCS#11</tt> module. This file
is not required if the older format is used.</p>
<hr><p><b>Note - </b>Before running <tt>ldapclient</tt>, you should set up and install the needed security database
files described in this section.</p>
<hr>
<p>See the section about configuring LDAP clients to use SSL in the
&ldquo;Managing SSL&rdquo; chapter of the Administrator's Guide for the version of Sun Java
System Directory Server you are using. For information on how to create and
manage these files. Once configured, these files must be stored in the location
expected by the LDAP naming services client. The attribute <tt>certificatePath</tt> is used to
determine this location.  This is by default <tt>/var/ldap</tt>.</p><p>For example, after setting up the necessary <tt>cert7.db</tt> and <tt>key3.db</tt> files using
Netscape Communicator<sup>TM</sup>, copy the files to the default location.</p><pre># <tt><b>cp $HOME/.netscape/cert7.db /var/ldap</b></tt>
# <tt><b>cp $HOME/.netscape/key3.db /var/ldap</b></tt></pre><p>Next, give everyone read access.</p><pre># <tt><b>chmod 444 /var/ldap/cert7.db</b></tt>
# <tt><b>chmod 444 /var/ldap/key3.db</b></tt></pre>
<hr><p><b>Note - </b>While Netscape manages the <tt>cert7.db</tt> and <tt>key3.db</tt> files in the <tt>$HOME/.netscape</tt> directory, Mozilla
has its <tt>cert8.db</tt>, <tt>key3.db</tt> and <tt>secmod.db</tt> files managed in a sub-directory under
<tt>$HOME/.mozilla</tt>. Copies of these security databases must be stored on a local
file system if you are using them for an LDAP naming services client.</p>
<hr>


<a name="clientsetup-89"></a><h4>Configuring PAM</h4>
<p><tt>pam_ldap</tt> is one authentication and account management PAM module option for LDAP. See
the <a href="http://docs.sun.com/doc/819-2252/pam-ldap-5?a=view"><tt>pam_ldap</tt>(5)</a> man page and <a href="whatsnew-1.html">Appendix&nbsp;A, Solaris 10 Software Updates to DNS, NIS, and LDAP</a> for more information about the features
currently supported with <tt>pam_ldap</tt>.</p><p>If you have selected both the per-user mode and the self credentials option,
then you must also enable the PAM Kerberos pam_krb5(5) pam modules.  See
<a href="http://docs.sun.com/doc/819-2252/pam-krb5-5?a=view"><tt>pam_krb5</tt>(5)</a> and the <a href="http://docs.sun.com/doc/819-3321"><i>System Administration Guide: Security Services</i></a> documentation for further details.</p>

<a name="clientsetup-91"></a><h5>Configuring PAM to Use UNIX <tt>policy</tt></h5>
<p>To configure PAM to use UNIX <tt>policy</tt>, follow the sample in <a href="schemas-111.html">Example <tt>pam.conf</tt> File for <tt>pam_ldap</tt></a>. Add the
lines that contain <tt>pam_ldap.so.1</tt> to the client's <tt>/etc/pam.conf</tt> file. For details, see
the <a href="http://docs.sun.com/doc/819-2251/pam.conf-4?a=view"><tt>pam.conf</tt>(4)</a> man page.</p>

<a name="clientsetup-92"></a><h5>Configuring PAM to Use LDAP <tt>server_policy</tt></h5>
<p>To configure PAM to use LDAP <tt>server_policy</tt>, follow the sample in <a href="schemas-250.html">Example <tt>pam_conf</tt> file for <tt>pam_ldap</tt> Configured for Account Management</a>. Add
the lines that contain <tt>pam_ldap.so.1</tt> to the client's <tt>/etc/pam.conf</tt> file. In addition, if
any PAM module in the sample <tt>pam.conf</tt> file specifies the <tt>binding</tt> flag and
 the <tt>server_policy</tt> option, use the same flag and option for the corresponding
module in the client's  <tt>/etc/pam.conf</tt> file.   Also, add the <tt>server_policy</tt>
option to the line that contains the service module <tt>pam_authtok_store.so.1</tt>.</p>
<hr><p><b>Note - </b>Previously, if you enabled <tt>pam_ldap</tt> account management, all users needed to provide a
login password for authentication any time they logged in to the system. Therefore,
nonpassword-based logins using tools such as <tt>rsh</tt>, <tt>rlogin</tt>, or <tt>ssh</tt> would fail.</p><p>Now, however, <a href="http://docs.sun.com/doc/819-2252/pam-ldap-5?a=view"><tt>pam_ldap</tt>(5)</a>, when used with Sun Java System Directory Servers DS5.2p4 and
newer releases, enables users to log in with <tt>rsh</tt>, <tt>rlogin</tt>, <tt>rcp</tt> and
<tt>ssh</tt> without giving a password.</p><p><a href="http://docs.sun.com/doc/819-2252/pam-ldap-5?a=view"><tt>pam_ldap</tt>(5)</a> is now modified to do account management and retrieve the account status
of users without authenticating to Directory Server as the user logging in. The
new control to this on Directory Server is 1.3.6.1.4.1.42.2.27.9.5.8, which is enabled by
default.</p><p>To modify this control for other than default, add Access Control Instructions (ACI) on
Directory Server:</p><pre>dn: oid=1.3.6.1.4.1.42.2.27.9.5.8,cn=features,cn=config
objectClass: top
objectClass: directoryServerFeature
oid:1.3.6.1.4.1.42.2.27.9.5.8
cn:Password Policy Account Usable Request Control
aci: (targetattr != "aci")(version 3.0; acl "Account Usable"; 
     allow (read, search, compare, proxy)
     (groupdn = "ldap:///cn=Administrators,cn=config");)
creatorsName: cn=server,cn=plugins,cn=config
modifiersName: cn=server,cn=plugins,cn=config</pre>
<hr>

<ul><li><p>The <tt>binding</tt> control flag</p><p>Using the <tt>binding</tt> control flag allows a local password override of a remote (LDAP) password. For example, if a user account is found on both the local files and the LDAP namespace, the password associated with the local account takes precedence over the remote password. Thus, if the local password expires, authentication fails even if the remote LDAP password is still valid.</p></li>
<li><p>The <tt>server_policy</tt> option</p><p>The <tt>server_policy</tt> option instructs <tt>pam_unix_auth</tt>, <tt>pam_unix_account</tt>, and <tt>pam_passwd_auth</tt> to ignore a user found in the LDAP namespace and to allow <tt>pam_ldap</tt> to perform authentication or account validation. In the case of <tt>pam_authtok_store</tt>, a new password is passed to the LDAP server without encryption. The password is thereby stored in the directory according to the password encryption scheme configured on the server. For more information, see <a href="http://docs.sun.com/doc/819-2251/pam.conf-4?a=view"><tt>pam.conf</tt>(4)</a> and <a href="http://docs.sun.com/doc/819-2252/pam-ldap-5?a=view"><tt>pam_ldap</tt>(5)</a>.</p></li></ul>

         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="clientsetup-95.html">Previous</a>
             </td>
             <td align="right">
                 <a href="clientsetup-59.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

