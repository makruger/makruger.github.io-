<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Monitoring LDAP Client Status - System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2009-01-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="setupproblems-1.html">Previous</a>
             </td>
             <td align="right">
                 <a href="setupproblems-3.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="intro-1.html">Part&nbsp;I&nbsp;About Naming and Directory Services</a></p>
<p class="toc level2"><a href="intro2ns-2.html">1.&nbsp;&nbsp;Naming and Directory Services (Overview)</a></p>
<p class="toc level2"><a href="a12swit-86415.html">2.&nbsp;&nbsp;The Name Service Switch (Overview)</a></p>
<p class="toc level1 tocsp"><a href="dnsadmin-1.html">Part&nbsp;II&nbsp;DNS Setup and Administration</a></p>
<p class="toc level2"><a href="dnsref-1.html">3.&nbsp;&nbsp;DNS Setup and Administration (Reference)</a></p>
<p class="toc level1 tocsp"><a href="nissetup-1.html">Part&nbsp;III&nbsp;NIS Setup and Administration</a></p>
<p class="toc level2"><a href="anis1-25461.html">4.&nbsp;&nbsp;Network Information Service (NIS) (Overview)</a></p>
<p class="toc level2"><a href="cnis1-25208.html">5.&nbsp;&nbsp;Setting Up and Configuring NIS Service</a></p>
<p class="toc level2"><a href="anis2-22217.html">6.&nbsp;&nbsp;Administering NIS (Tasks)</a></p>
<p class="toc level2"><a href="abtrbl-18694.html">7.&nbsp;&nbsp;NIS Troubleshooting</a></p>
<p class="toc level1 tocsp"><a href="ldapsetup-1.html">Part&nbsp;IV&nbsp;LDAP Naming Services Setup and Administration</a></p>
<p class="toc level2"><a href="overview-1.html">8.&nbsp;&nbsp;Introduction to LDAP Naming Services (Overview/Reference)</a></p>
<p class="toc level2"><a href="ldapsecure-1.html">9.&nbsp;&nbsp;LDAP Basic Components and Concepts (Overview)</a></p>
<p class="toc level2"><a href="planldap-1.html">10.&nbsp;&nbsp;Planning Requirements for LDAP Naming Services (Tasks)</a></p>
<p class="toc level2"><a href="sundssetup-13.html">11.&nbsp;&nbsp;Setting Up Sun Java System Directory Server With LDAP Clients (Tasks)</a></p>
<p class="toc level2"><a href="clientsetup-1.html">12.&nbsp;&nbsp;Setting Up LDAP Clients (Tasks)</a></p>
<p class="toc level2"><a href="setupproblems-1.html">13.&nbsp;&nbsp;LDAP Troubleshooting (Reference)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Monitoring LDAP Client Status</a></p>
</div>
<p class="toc level3"><a href="setupproblems-3.html">LDAP Configuration Problems and Solutions</a></p>
<p class="toc level2 tocsp"><a href="schemas-1.html">14.&nbsp;&nbsp;LDAP General Reference (Reference)</a></p>
<p class="toc level2"><a href="nis2ldap-34.html">15.&nbsp;&nbsp;Transitioning From NIS to LDAP (Overview/Tasks)</a></p>
<p class="toc level2"><a href="nisplus2ldap-1.html">16.&nbsp;&nbsp;Transitioning From NIS+ to LDAP</a></p>
<p class="toc level1 tocsp"><a href="ghnmu.html">Part&nbsp;V&nbsp;Active Directory Naming Service</a></p>
<p class="toc level2"><a href="ghnov.html">17.&nbsp;&nbsp;Setting Up Solaris Active Directory Clients</a></p>
<p class="toc level1 tocsp"><a href="whatsnew-1.html">A.&nbsp;&nbsp;Solaris 10 Software Updates to DNS, NIS, and LDAP</a></p>
<p class="toc level2"><a href="whatsnew-5.html">Service Management Facility Changes</a></p>
<p class="toc level2"><a href="whatsnew-2.html">DNS BIND</a></p>
<p class="toc level2"><a href="schemas-290.html"><tt>pam_ldap</tt> Changes</a></p>
<p class="toc level2"><a href="whatsnew-3.html">Documentation Errors</a></p>
<p class="toc level1 tocsp"><a href="aagloss-87604.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="clientsetup-66"></a><h3>Monitoring LDAP Client Status</h3>
<p>The following sections show various commands to help determine the state of the
LDAP client environment. Also see the man pages for additional information about the
options that can be used.</p><p>For an overview of the Service Management Facility, refer to <a href="http://docs.sun.com/doc/819-2379/hbrunlevels-25516?a=view">Chapter 16, Managing Services (Overview), in <i>System Administration Guide: Basic Administration</i></a>. Also refer
to the <a href="http://docs.sun.com/doc/819-2240/svcadm-1m?a=view"><tt>svcadm</tt>(1M)</a> and <a href="http://docs.sun.com/doc/819-2239/svcs-1?a=view"><tt>svcs</tt>(1)</a> man pages for more details.</p>

<a name="clientsetup-67"></a><h4>Verifying <tt>ldap_cachemgr</tt> Is Running</h4>
<p>The <tt>ldap_cachemgr</tt> daemon must be running and functioning correctly at all times. Otherwise,
the system doesn't work. When you start the LDAP client, the client starts
<tt>ldap_cachemgr</tt> daemon automatically. So, if the <tt>ldap_cachemgr</tt> is not running, the LDAP client will
be disabled. Following are two methods for determining if the LDAP client is
online.</p>
<ul><li><p>Use the <tt>svcs</tt> command.</p><pre># <tt><b>svcs \*ldap\*</b></tt>
STATE          STIME    FMRI
disabled       Aug_24   svc:/network/ldap/client:default</pre><p>or</p><pre># <tt><b>svcs</b></tt> <tt>-l</tt> <tt><b>network/ldap/client:default</b></tt>
fmri         svc:/network/ldap/client:default
enabled      true
state        online
next_state   none
restarter    svc:/system/svc/restarter:default
contract_id  1598 
dependency   require_all/none file://localhost/var/ldap/ldap_client_file (-)
dependency   require_all/none svc:/network/initial (online)
dependency   require_all/none svc:/system/filesystem/minimal (online)</pre></li>
<li><p>Pass the <tt>-g</tt> option to <tt>ldap_cachemgr</tt>.</p><p>This option provides more extensive status information, which is useful when you diagnose a problem.</p><pre># <tt><b>/usr/lib/ldap/ldap_cachemgr</b></tt> <tt>-g</tt><tt><b></b></tt>
cachemgr configuration:
server debug level          0
server log file "/var/ldap/cachemgr.log"
number of calls to ldapcachemgr         19

cachemgr cache data statistics:
Configuration refresh information:
  Previous refresh time: 2001/11/16 18:33:28
  Next refresh time:     2001/11/16 18:43:28
Server information:
  Previous refresh time: 2001/11/16 18:33:28
  Next refresh time:     2001/11/16 18:36:08
  server: 192.168.0.0, status: UP
  server: 192.168.0.1, status: ERROR
    error message: Can't connect to the LDAP server
Cache data information:
  Maximum cache entries:          256
  Number of cache entries:          2</pre></li></ul>
<p>For more information about the <tt>ldap_cachemgr</tt> daemon, see the <a href="http://docs.sun.com/doc/819-2240/ldap-cachemgr-1m?a=view"><tt>ldap_cachemgr</tt>(1M)</a> man page.</p>

<a name="clientsetup-68"></a><h4>Checking the Current Profile Information</h4>
<p>Become superuser or assume an equivalent role, and run <tt>ldapclient</tt> with the <tt>list</tt>
option.</p><pre># <tt><b>ldapclient list</b></tt>
NS_LDAP_FILE_VERSION= 2.0
NS_LDAP_BINDDN= cn=proxyagent,ou=profile,dc=west,dc=example,dc=com
NS_LDAP_BINDPASSWD= {NS1}4a3788e8c053424f
NS_LDAP_SERVERS= 192.168.0.1, 192.168.0.10
NS_LDAP_SEARCH_BASEDN= dc=west,dc=example,dc=com
NS_LDAP_AUTH= simple
NS_LDAP_SEARCH_REF= TRUE
NS_LDAP_SEARCH_SCOPE= one
NS_LDAP_SEARCH_TIME= 30
NS_LDAP_SERVER_PREF= 192.168.0.1
NS_LDAP_PROFILE= pit1
NS_LDAP_CREDENTIAL_LEVEL= proxy
NS_LDAP_SERVICE_SEARCH_DESC= passwd:ou=people,?sub
NS_LDAP_SERVICE_SEARCH_DESC= group:ou=group,dc=west,dc=example,dc=com?one
NS_LDAP_BIND_TIME= 5</pre><p>Currently the <tt>/var/ldap</tt> files are in ASCII format. Because the files could change
to binary at some time, concatenating the files would cause problems.  <tt>ldapclient</tt>
<tt>list</tt> is the supported method for accessing this information. See the <a href="http://docs.sun.com/doc/819-2240/ldapclient-1m?a=view"><tt>ldapclient</tt>(1M)</a> man
page for more information.</p>

<a name="clientsetup-70"></a><h4>Verifying Basic Client-Server Communication</h4>
<p>The best way to show that your client is talking to the
LDAP server is with the <tt>ldaplist</tt> command.  Using <tt>ldaplist</tt> with no arguments dumps
all the containers on the server.  This works as long as the
containers exist, and do not have to be populated. See the <a href="http://docs.sun.com/doc/819-2239/ldaplist-1?a=view"><tt>ldaplist</tt>(1)</a>
man page for more information.</p><p>If the first step works, you can try <tt>ldaplist passwd <i>username</i></tt> or <tt>ldaplist hosts <i>hostname</i></tt> but
if they contain lots of data you might want to pick a less
populated service, or pipe them to <tt>head</tt> or <tt>more</tt>.</p>

<a name="clientsetup-69"></a><h4>Checking Server Data From a Non-Client Machine</h4>
<p>Most of the commands in the previous sections assume you already have created
an LDAP client.  If you have not created a client and
want to check the data on the server, use the <tt>ldapsearch</tt> command. 
The following example lists all of the containers.</p><pre># <tt><b>ldapsearch</b></tt> <tt>-h</tt> <tt><b>server1</b></tt> <tt>-b</tt> <tt><b>"dc=west,dc=example,dc=com"</b></tt> <tt>-s</tt> <tt><b>one "objectclass=*"</b></tt></pre><p>In Solaris 9 and earlier releases, the <tt>ldapsearch</tt> command, by default, produced output
in a nonstandard textual representation. The default output for <tt>ldapsearch</tt> in later Solaris
releases is the industry standardized LDIF format that is defined by RFC-2849. All
versions of <tt>ldapsearch</tt> can output LDIF format using the <tt>-L</tt> option.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="setupproblems-1.html">Previous</a>
             </td>
             <td align="right">
                 <a href="setupproblems-3.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

