<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>DMA Software Components: Handles, Windows, and Cookies - Writing Device Drivers</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-08-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">Writing Device Drivers</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="dma-6a.html">Previous</a>
             </td>
             <td align="right">
                 <a href="dma-36180.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="eqbvu.html">Part&nbsp;I&nbsp;Designing Device Drivers for the Solaris Platform</a></p>
<p class="toc level2"><a href="eqbqn.html">1.&nbsp;&nbsp;Overview of Solaris Device Drivers</a></p>
<p class="toc level2"><a href="kernelovr-77198.html">2.&nbsp;&nbsp;Solaris Kernel and Device Tree</a></p>
<p class="toc level2"><a href="mt-17026.html">3.&nbsp;&nbsp;Multithreading</a></p>
<p class="toc level2"><a href="properties-1.html">4.&nbsp;&nbsp;Properties</a></p>
<p class="toc level2"><a href="events-1.html">5.&nbsp;&nbsp;Managing Events and Queueing Tasks</a></p>
<p class="toc level2"><a href="autoconf-17.html">6.&nbsp;&nbsp;Driver Autoconfiguration</a></p>
<p class="toc level2"><a href="devaccess-3.html">7.&nbsp;&nbsp;Device Access: Programmed I/O</a></p>
<p class="toc level2"><a href="interrupt-15678.html">8.&nbsp;&nbsp;Interrupt Handlers</a></p>
<p class="toc level2"><a href="dma-29901.html">9.&nbsp;&nbsp;Direct Memory Access (DMA)</a></p>
<p class="toc level3"><a href="dma-1.html">DMA Model</a></p>
<p class="toc level3"><a href="dma-2.html">Types of Device DMA</a></p>
<p class="toc level3"><a href="dma-6a.html">Types of Host Platform DMA</a></p>
<div class="onpage">
<p class="toc level3"><a href="">DMA Software Components:  Handles, Windows, and Cookies</a></p>
</div>
<p class="toc level3"><a href="dma-36180.html">DMA Operations</a></p>
<p class="toc level3"><a href="dma-6.html">Managing DMA Resources</a></p>
<p class="toc level3"><a href="dma-35348.html">DMA Windows</a></p>
<p class="toc level2 tocsp"><a href="devmap-24338.html">10.&nbsp;&nbsp;Mapping Device and Kernel Memory</a></p>
<p class="toc level2"><a href="devcnmgt-19679.html">11.&nbsp;&nbsp;Device Context Management</a></p>
<p class="toc level2"><a href="powermgt-37437.html">12.&nbsp;&nbsp;Power Management</a></p>
<p class="toc level2"><a href="gevsi.html">13.&nbsp;&nbsp;Hardening Solaris Drivers</a></p>
<p class="toc level2"><a href="ldi-1.html">14.&nbsp;&nbsp;Layered Driver Interface (LDI)</a></p>
<p class="toc level1 tocsp"><a href="eqbvb.html">Part&nbsp;II&nbsp;Designing Specific Kinds of Device Drivers</a></p>
<p class="toc level2"><a href="character-21002.html">15.&nbsp;&nbsp;Drivers for Character Devices</a></p>
<p class="toc level2"><a href="block-34861.html">16.&nbsp;&nbsp;Drivers for Block Devices</a></p>
<p class="toc level2"><a href="scsi-36812.html">17.&nbsp;&nbsp;SCSI Target Drivers</a></p>
<p class="toc level2"><a href="scsihba-32898.html">18.&nbsp;&nbsp;SCSI Host Bus Adapter Drivers</a></p>
<p class="toc level2"><a href="gld-1.html">19.&nbsp;&nbsp;Drivers for Network Devices</a></p>
<p class="toc level2"><a href="usb-1.html">20.&nbsp;&nbsp;USB Drivers</a></p>
<p class="toc level1 tocsp"><a href="eqbvo.html">Part&nbsp;III&nbsp;Building a Device Driver</a></p>
<p class="toc level2"><a href="loading-15035.html">21.&nbsp;&nbsp;Compiling, Loading, Packaging, and Testing Drivers</a></p>
<p class="toc level2"><a href="debug-60.html">22.&nbsp;&nbsp;Debugging, Testing, and Tuning Device Drivers</a></p>
<p class="toc level2"><a href="coding-practices.html">23.&nbsp;&nbsp;Recommended Coding Practices</a></p>
<p class="toc level1 tocsp"><a href="eqbva.html">Part&nbsp;IV&nbsp;Appendixes</a></p>
<p class="toc level2"><a href="hwovr-18191.html">A.&nbsp;&nbsp;Hardware Overview</a></p>
<p class="toc level2"><a href="ddidkisvc-29227.html">B.&nbsp;&nbsp;Summary of Solaris DDI/DKI Services</a></p>
<p class="toc level2"><a href="lp64-35004.html">C.&nbsp;&nbsp;Making a Device Driver 64-Bit Ready</a></p>
<p class="toc level2"><a href="euazz.html">D.&nbsp;&nbsp;Console Frame Buffer Drivers</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="dma-7"></a><h3>DMA Software Components: Handles, Windows, and Cookies</h3>
<p><a name="dma-ix305"></a>A DMA <b>handle</b> is an opaque pointer that represents an object, usually a
memory buffer or address. A DMA handle enables a device to perform DMA
transfers. Several different calls to DMA routines use the handle to identify the
DMA resources that are allocated for the object.</p><p><a name="dma-ix306"></a>An object represented by a DMA handle is completely covered by one or
more <b>DMA cookies</b>. A DMA cookie represents a contiguous piece of memory that is
used in data transfers by the DMA engine. The system divides objects into
multiple cookies based on the following information:</p>
<ul><li><p>The <tt>ddi_dma_attr(9S)</tt> attribute structure provided by the driver</p></li>
<li><p>Memory location of the target object</p></li>
<li><p>Alignment of the target object</p></li></ul>
<p><a name="dma-ix307"></a><a name="dma-ix308"></a>If an object does not fit within the limitations of the DMA engine,
that object must be broken into multiple <b>DMA windows</b>. You can only activate and
allocate resources for one window at a time. Use the <a href="http://docs.sun.com/doc/819-2256/ddi-dma-getwin-9f?a=view"><tt>ddi_dma_getwin</tt>(9F)</a> function to
position between windows within an object. Each DMA window consists of one or
more DMA cookies. For more information, see <a href="dma-35348.html">DMA Windows</a>.</p><p><a name="indexterm-193"></a><a name="dma-ix309a"></a>Some DMA engines can accept more than one cookie. Such engines perform scatter-gather
I/O without the help of the system. If multiple cookies are returned from
a bind, the driver should call <a href="http://docs.sun.com/doc/819-2256/ddi-dma-nextcookie-9f?a=view"><tt>ddi_dma_nextcookie</tt>(9F)</a> repeatedly to retrieve each cookie.
These cookies must then be programmed into the engine. The device can then
be programmed to transfer the total number of bytes covered by the aggregate
of these DMA cookies.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="dma-6a.html">Previous</a>
             </td>
             <td align="right">
                 <a href="dma-36180.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

