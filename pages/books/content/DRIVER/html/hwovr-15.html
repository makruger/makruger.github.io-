<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>System Memory Model - Writing Device Drivers</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-08-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">Writing Device Drivers</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="hwovr-14.html">Previous</a>
             </td>
             <td align="right">
                 <a href="hwovr-18.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="eqbvu.html">Part&nbsp;I&nbsp;Designing Device Drivers for the Solaris Platform</a></p>
<p class="toc level2"><a href="eqbqn.html">1.&nbsp;&nbsp;Overview of Solaris Device Drivers</a></p>
<p class="toc level2"><a href="kernelovr-77198.html">2.&nbsp;&nbsp;Solaris Kernel and Device Tree</a></p>
<p class="toc level2"><a href="mt-17026.html">3.&nbsp;&nbsp;Multithreading</a></p>
<p class="toc level2"><a href="properties-1.html">4.&nbsp;&nbsp;Properties</a></p>
<p class="toc level2"><a href="events-1.html">5.&nbsp;&nbsp;Managing Events and Queueing Tasks</a></p>
<p class="toc level2"><a href="autoconf-17.html">6.&nbsp;&nbsp;Driver Autoconfiguration</a></p>
<p class="toc level2"><a href="devaccess-3.html">7.&nbsp;&nbsp;Device Access: Programmed I/O</a></p>
<p class="toc level2"><a href="interrupt-15678.html">8.&nbsp;&nbsp;Interrupt Handlers</a></p>
<p class="toc level2"><a href="dma-29901.html">9.&nbsp;&nbsp;Direct Memory Access (DMA)</a></p>
<p class="toc level2"><a href="devmap-24338.html">10.&nbsp;&nbsp;Mapping Device and Kernel Memory</a></p>
<p class="toc level2"><a href="devcnmgt-19679.html">11.&nbsp;&nbsp;Device Context Management</a></p>
<p class="toc level2"><a href="powermgt-37437.html">12.&nbsp;&nbsp;Power Management</a></p>
<p class="toc level2"><a href="gevsi.html">13.&nbsp;&nbsp;Hardening Solaris Drivers</a></p>
<p class="toc level2"><a href="ldi-1.html">14.&nbsp;&nbsp;Layered Driver Interface (LDI)</a></p>
<p class="toc level1 tocsp"><a href="eqbvb.html">Part&nbsp;II&nbsp;Designing Specific Kinds of Device Drivers</a></p>
<p class="toc level2"><a href="character-21002.html">15.&nbsp;&nbsp;Drivers for Character Devices</a></p>
<p class="toc level2"><a href="block-34861.html">16.&nbsp;&nbsp;Drivers for Block Devices</a></p>
<p class="toc level2"><a href="scsi-36812.html">17.&nbsp;&nbsp;SCSI Target Drivers</a></p>
<p class="toc level2"><a href="scsihba-32898.html">18.&nbsp;&nbsp;SCSI Host Bus Adapter Drivers</a></p>
<p class="toc level2"><a href="gld-1.html">19.&nbsp;&nbsp;Drivers for Network Devices</a></p>
<p class="toc level2"><a href="usb-1.html">20.&nbsp;&nbsp;USB Drivers</a></p>
<p class="toc level1 tocsp"><a href="eqbvo.html">Part&nbsp;III&nbsp;Building a Device Driver</a></p>
<p class="toc level2"><a href="loading-15035.html">21.&nbsp;&nbsp;Compiling, Loading, Packaging, and Testing Drivers</a></p>
<p class="toc level2"><a href="debug-60.html">22.&nbsp;&nbsp;Debugging, Testing, and Tuning Device Drivers</a></p>
<p class="toc level2"><a href="coding-practices.html">23.&nbsp;&nbsp;Recommended Coding Practices</a></p>
<p class="toc level1 tocsp"><a href="eqbva.html">Part&nbsp;IV&nbsp;Appendixes</a></p>
<p class="toc level2"><a href="hwovr-18191.html">A.&nbsp;&nbsp;Hardware Overview</a></p>
<p class="toc level3"><a href="hwovr-1.html">SPARC Processor Issues</a></p>
<p class="toc level3"><a href="hwovr-35423.html">x86 Processor Issues</a></p>
<p class="toc level3"><a href="hwovr-66.html">Endianness</a></p>
<p class="toc level3"><a href="hwovr-14.html">Store Buffers</a></p>
<div class="onpage">
<p class="toc level3"><a href="">System Memory Model</a></p>
</div>
<p class="toc level3"><a href="hwovr-18.html">Bus Architectures</a></p>
<p class="toc level3"><a href="hwovr-25520.html">Bus Specifics</a></p>
<p class="toc level3"><a href="hwovr-100.html">Device Issues</a></p>
<p class="toc level3"><a href="hwovr-101.html">PROM on SPARC Machines</a></p>
<p class="toc level2 tocsp"><a href="ddidkisvc-29227.html">B.&nbsp;&nbsp;Summary of Solaris DDI/DKI Services</a></p>
<p class="toc level2"><a href="lp64-35004.html">C.&nbsp;&nbsp;Making a Device Driver 64-Bit Ready</a></p>
<p class="toc level2"><a href="euazz.html">D.&nbsp;&nbsp;Console Frame Buffer Drivers</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="hwovr-15"></a><h3>System Memory Model</h3>
<p><a name="hwovr-ix42"></a>The system memory model defines the semantics of memory operations such as <b>load</b>
and <b>store</b> and specifies how the order in which these operations are issued
by a processor is related to the order in which they reach memory.
The memory model applies to both uniprocessors and shared-memory multiprocessors. Two memory models
are supported: total store ordering (TSO) and partial store ordering (PSO).</p>

<a name="hwovr-16"></a><h4>Total Store Ordering (TSO)</h4>
<p>TSO guarantees that the sequence in which store, FLUSH, and atomic load-store instructions
appear in memory for a given processor is identical to the sequence in
which they were issued by the processor.</p><p><a name="indexterm-1234"></a>Both x86 and SPARC processors support TSO.</p>

<a name="hwovr-17"></a><h4>Partial Store Ordering (PSO)</h4>
<p><a name="indexterm-1235"></a>PSO does not guarantee that the sequence in which store, FLUSH, and atomic
load-store instructions appear in memory for a given processor is identical to the
sequence in which they were issued by the processor. The processor can reorder
the stores so that the sequence of stores to memory is not the
same as the sequence of stores issued by the CPU.</p><p>SPARC processors support PSO; x86 processors do not.</p><p>For SPARC processors, conformance between <b>issuing</b> order and <b>memory</b> order is provided by
the system framework using the STBAR instruction. If two of the above instructions
are separated by an STBAR instruction in the issuing order of a processor,
or if the instructions reference the same location, the memory order of the
two instructions is the same as the issuing order. Enforcement of strong data-ordering
in DDI-compliant drivers is provided by the <a href="http://docs.sun.com/doc/819-2256/ddi-regs-map-setup-9f?a=view"><tt>ddi_regs_map_setup</tt>(9F)</a> interface. Compliant drivers cannot use the
STBAR instruction directly.</p><p>See the <i>SPARC Architecture Manual, Version 9</i>, for more details on the SPARC memory model.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="hwovr-14.html">Previous</a>
             </td>
             <td align="right">
                 <a href="hwovr-18.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

