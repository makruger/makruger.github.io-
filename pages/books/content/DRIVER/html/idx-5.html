<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title> - Writing Device Drivers</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-08-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">Writing Device Drivers</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="idx-4.html">Previous</a>
             </td>
             <td align="right">
                 <a href="idx-6.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="eqbvu.html">Part&nbsp;I&nbsp;Designing Device Drivers for the Solaris Platform</a></p>
<p class="toc level2"><a href="eqbqn.html">1.&nbsp;&nbsp;Overview of Solaris Device Drivers</a></p>
<p class="toc level2"><a href="kernelovr-77198.html">2.&nbsp;&nbsp;Solaris Kernel and Device Tree</a></p>
<p class="toc level2"><a href="mt-17026.html">3.&nbsp;&nbsp;Multithreading</a></p>
<p class="toc level2"><a href="properties-1.html">4.&nbsp;&nbsp;Properties</a></p>
<p class="toc level2"><a href="events-1.html">5.&nbsp;&nbsp;Managing Events and Queueing Tasks</a></p>
<p class="toc level2"><a href="autoconf-17.html">6.&nbsp;&nbsp;Driver Autoconfiguration</a></p>
<p class="toc level2"><a href="devaccess-3.html">7.&nbsp;&nbsp;Device Access: Programmed I/O</a></p>
<p class="toc level2"><a href="interrupt-15678.html">8.&nbsp;&nbsp;Interrupt Handlers</a></p>
<p class="toc level2"><a href="dma-29901.html">9.&nbsp;&nbsp;Direct Memory Access (DMA)</a></p>
<p class="toc level2"><a href="devmap-24338.html">10.&nbsp;&nbsp;Mapping Device and Kernel Memory</a></p>
<p class="toc level2"><a href="devcnmgt-19679.html">11.&nbsp;&nbsp;Device Context Management</a></p>
<p class="toc level2"><a href="powermgt-37437.html">12.&nbsp;&nbsp;Power Management</a></p>
<p class="toc level2"><a href="gevsi.html">13.&nbsp;&nbsp;Hardening Solaris Drivers</a></p>
<p class="toc level2"><a href="ldi-1.html">14.&nbsp;&nbsp;Layered Driver Interface (LDI)</a></p>
<p class="toc level1 tocsp"><a href="eqbvb.html">Part&nbsp;II&nbsp;Designing Specific Kinds of Device Drivers</a></p>
<p class="toc level2"><a href="character-21002.html">15.&nbsp;&nbsp;Drivers for Character Devices</a></p>
<p class="toc level2"><a href="block-34861.html">16.&nbsp;&nbsp;Drivers for Block Devices</a></p>
<p class="toc level2"><a href="scsi-36812.html">17.&nbsp;&nbsp;SCSI Target Drivers</a></p>
<p class="toc level2"><a href="scsihba-32898.html">18.&nbsp;&nbsp;SCSI Host Bus Adapter Drivers</a></p>
<p class="toc level2"><a href="gld-1.html">19.&nbsp;&nbsp;Drivers for Network Devices</a></p>
<p class="toc level2"><a href="usb-1.html">20.&nbsp;&nbsp;USB Drivers</a></p>
<p class="toc level1 tocsp"><a href="eqbvo.html">Part&nbsp;III&nbsp;Building a Device Driver</a></p>
<p class="toc level2"><a href="loading-15035.html">21.&nbsp;&nbsp;Compiling, Loading, Packaging, and Testing Drivers</a></p>
<p class="toc level2"><a href="debug-60.html">22.&nbsp;&nbsp;Debugging, Testing, and Tuning Device Drivers</a></p>
<p class="toc level2"><a href="coding-practices.html">23.&nbsp;&nbsp;Recommended Coding Practices</a></p>
<p class="toc level1 tocsp"><a href="eqbva.html">Part&nbsp;IV&nbsp;Appendixes</a></p>
<p class="toc level2"><a href="hwovr-18191.html">A.&nbsp;&nbsp;Hardware Overview</a></p>
<p class="toc level2"><a href="ddidkisvc-29227.html">B.&nbsp;&nbsp;Summary of Solaris DDI/DKI Services</a></p>
<p class="toc level2"><a href="lp64-35004.html">C.&nbsp;&nbsp;Making a Device Driver 64-Bit Ready</a></p>
<p class="toc level2"><a href="euazz.html">D.&nbsp;&nbsp;Console Frame Buffer Drivers</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             <h4>K</h4>
<div class="indexdiv">
<dl>
<dd><tt>_KERNEL</tt> symbol, <a href="loading-1.html#indexterm-1091">Compiling and Linking the Driver</a></dd>
</dl>
<dl>
<dd>kernel<dl>
<dd>debugger<dl>
<dd><i>See </i><tt>kmdb</tt> debugger</dd>
</dl>
device tree, <a href="kernelovr-1.html#indexterm-23">What Is the Kernel?</a></dd>
<dd>memory<dl>
<dd>allocation, <a href="kernelovr-41.html#drvovr-ix146">Dynamic Memory Allocation</a></dd>
<dd>associating with user applications, <a href="devmap-4.html#indexterm-206">Associating Kernel Memory With User Mappings</a></dd>
<dd>detecting leaks with <tt>mdb</tt>, <a href="euxdb.html#indexterm-1182">Detecting Kernel Memory Leaks</a></dd>
</dl>
module directory, <a href="loading-85890.html#loading-ix581">Copying the Driver to a Module Directory</a></dd>
<dd>overview, <a href="kernelovr-1.html#indexterm-19">What Is the Kernel?</a></dd>
</dl>
</dd>
</dl>
<dl>
<dd>kernel data structures, <a href="euxdb.html#indexterm-1186">Obtaining Kernel Data Structure Information</a></dd>
</dl>
<dl>
<dd>kernel logging functions, <a href="ddidkisvc-57.html#indexterm-1296">Kernel Logging and Printing Functions</a></dd>
</dl>
<dl>
<dd>kernel statistics, <i>See </i>kstats</dd>
</dl>
<dl>
<dd>kernel statistics functions, <a href="ddidkisvc-55.html#indexterm-1294">Kernel Statistics Functions</a></dd>
</dl>
<dl>
<dd>kernel terminal emulator, <a href="eveno.html#indexterm-1369">Solaris Consoles and the Kernel Terminal Emulator</a></dd>
</dl>
<dl>
<dd>kernel thread functions, <a href="ddidkisvc-26.html#indexterm-1259">Kernel Thread Control and Synchronization Functions</a></dd>
</dl>
<dl>
<dd>kernel variables<dl>
<dd>setting, <a href="debug-61.html#indexterm-1138">Setting Kernel Variables</a></dd>
<dd>use with debuggers, <a href="euxdb.html#indexterm-1193">Modifying Kernel Variables</a></dd>
<dd>using, <a href="debug-61.html#indexterm-1137">Setting Up Test Modules</a></dd>
</dl>
</dd>
</dl>
<dl>
<dd><tt>kmdb</tt> debugger, <a href="euxdb.html#indexterm-1165">Using the kmdb Kernel Debugger</a><dl>
<dd>booting on SPARC systems, <a href="euxdb.html#indexterm-1167">Booting kmdb With an Alternate Kernel on the SPARC Platform</a></dd>
<dd>booting on x86 systems, <a href="euxdb.html#indexterm-1169">Booting kmdb With an Alternate Kernel on the x86 Platform</a></dd>
<dd>macros, <a href="euxdb.html#indexterm-1171">kmdb Macros for Driver Developers</a></dd>
<dd>setting breakpoints, <a href="euxdb.html#indexterm-1170">Setting Breakpoints in kmdb</a></dd>
</dl>
</dd>
</dl>
<dl>
<dd><tt>kmdb</tt> kernel debugger, <a href="debug-61.html#indexterm-1125">Enable the Deadman Feature to Avoid a Hard Hang</a></dd>
</dl>
<dl>
<dd><tt>kmem_alloc()</tt> function, <a href="kernelovr-41.html#drvovr-ix148">Dynamic Memory Allocation</a></dd>
</dl>
<dl>
<dd><tt>kmem_flags</tt> kernel variable, <a href="debug-61.html#indexterm-1147">Setting kmem_flags Debugging Flags</a></dd>
</dl>
<dl>
<dd><tt>kmem_free()</tt> function, <a href="ldi-2.html#indexterm-502">Retrieving Target Device Information</a></dd>
</dl>
<dl>
<dd>kstats<dl>
<dd><i>See also </i>network statistics<dd>definition, <a href="euxde.html#indexterm-1199">Kernel Statistics</a></dd>
<dd>Ethernet drivers, <a href="euxde.html#indexterm-1203">Kernel Statistics for Solaris Ethernet Drivers</a></dd>
<dd>functions<dl>
<dd><a href="euxde.html#indexterm-1202">Kernel Statistics Functions</a></dd>
<dd><a href="ddidkisvc-55.html#indexterm-1295">Kernel Statistics Functions</a></dd>
</dl>
</dd>
<dd>structure members, <a href="euxde.html#indexterm-1200">Kernel Statistics Structure Members</a></dd>
<dd>structures, <a href="euxde.html#indexterm-1201">Kernel Statistics Structures</a></dd>
<dd>task queues, <a href="task_queues.html#indexterm-72">Task Queue Kernel Statistics Counters</a></dd>
</dl>
</dd>
</dl>
</div><h4>L</h4>
<div class="indexdiv">
<dl>
<dd>latent fault, definition of, <a href="serviceability.html#indexterm-1224">Periodic Health Checks</a></dd>
</dl>
<dl>
<dd>layered driver handle, <i>See </i>LDI</dd>
</dl>
<dl>
<dd>Layered Driver Interface, <i>See </i>LDI</dd>
</dl>
<dl>
<dd>layered identifier, <i>See </i>LDI</dd>
</dl>
<dl>
<dd><tt>ld</tt> command, <a href="loading-1.html#indexterm-1088">Compiling and Linking the Driver</a></dd>
</dl>
<dl>
<dd>LDI, <a href="ldi-1.html#indexterm-455">Layered Driver Interface (LDI)</a><dl>
<dd>definition, <a href="kernelovr-1.html#indexterm-25">What Is the Kernel?</a></dd>
<dd>device access, <a href="ldi-2.html#indexterm-466">Kernel Interfaces</a></dd>
<dd>device consumer, <a href="ewpre.html#indexterm-461">LDI Overview</a></dd>
<dd>device information, <a href="ldi-2.html#indexterm-467">Kernel Interfaces</a></dd>
<dd>device layering, <a href="ldi-5.html#indexterm-536">User Interfaces</a></dd>
<dd>device usage<dl>
<dd><a href="ldi-2.html#indexterm-465">Kernel Interfaces</a></dd>
<dd><a href="ldi-5.html#indexterm-537">User Interfaces</a></dd>
<dd><a href="ldi-5.html#indexterm-562">Print System Configuration Command Interfaces</a></dd>
<dd><a href="ldi-5.html#indexterm-565">Device User Command Interfaces</a></dd>
</dl>
</dd>
<dd>event notification interfaces, <a href="ldi-2.html#indexterm-514">Receiving Asynchronous Device Event Notification</a></dd>
<dd><tt>fuser</tt> command, <a href="ldi-5.html#indexterm-564">Device User Command Interfaces</a></dd>
<dd>kernel device consumer, <a href="ewpre.html#indexterm-462">LDI Overview</a></dd>
<dd>layered driver, <a href="ewpre.html#indexterm-463">LDI Overview</a></dd>
<dd>layered driver handle<dl>
<dd><a href="ldi-2.html#indexterm-476">Layered Driver Handles &ndash; Target Devices</a></dd>
<dd><a href="ldi-2.html#indexterm-522">Driver Source File</a></dd>
</dl>
</dd>
<dd>layered identifier<dl>
<dd><a href="ldi-2.html#indexterm-469">Layered Identifiers &ndash; Kernel Device Consumers</a></dd>
<dd><a href="ldi-2.html#indexterm-523">Driver Source File</a></dd>
</dl>
</dd>
<dd><tt>libdevinfo</tt> interfaces, <a href="ldi-5.html#indexterm-538">User Interfaces</a></dd>
<dd><tt>prtconf</tt> command, <a href="ldi-5.html#indexterm-561">Print System Configuration Command Interfaces</a></dd>
<dd>target device<dl>
<dd><a href="ewpre.html#indexterm-460">LDI Overview</a></dd>
<dd><a href="ldi-2.html#indexterm-478">Layered Driver Handles &ndash; Target Devices</a></dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<dl>
<dd>LDI functions<dl>
<dd><tt>ldi_add_event_handler()</tt> function, <a href="ldi-2.html#indexterm-518">Receiving Asynchronous Device Event Notification</a></dd>
<dd><tt>ldi_aread()</tt> function, <a href="ldi-2.html#indexterm-485">Accessing Target Devices</a></dd>
<dd><tt>ldi_awrite()</tt> function, <a href="ldi-2.html#indexterm-487">Accessing Target Devices</a></dd>
<dd><tt>ldi_close()</tt> function<dl>
<dd><a href="ldi-2.html#indexterm-482">Opening and Closing Target Devices</a></dd>
<dd><a href="ldi-2.html#indexterm-527">Driver Source File</a></dd>
</dl>
</dd>
<dd><tt>ldi_devmap()</tt> function, <a href="ldi-2.html#indexterm-492">Accessing Target Devices</a></dd>
<dd><tt>ldi_dump()</tt> function, <a href="ldi-2.html#indexterm-489">Accessing Target Devices</a></dd>
<dd><tt>ldi_get_dev()</tt> function, <a href="ldi-2.html#indexterm-496">Retrieving Target Device Information</a></dd>
<dd><tt>ldi_get_devid()</tt> function, <a href="ldi-2.html#indexterm-498">Retrieving Target Device Information</a></dd>
<dd><tt>ldi_get_eventcookie()</tt> function, <a href="ldi-2.html#indexterm-517">Receiving Asynchronous Device Event Notification</a></dd>
<dd><tt>ldi_get_minor_name()</tt> function, <a href="ldi-2.html#indexterm-499">Retrieving Target Device Information</a></dd>
<dd><tt>ldi_get_otyp()</tt> function, <a href="ldi-2.html#indexterm-497">Retrieving Target Device Information</a></dd>
<dd><tt>ldi_get_size()</tt> function, <a href="ldi-2.html#indexterm-500">Retrieving Target Device Information</a></dd>
<dd><tt>ldi_getmsg()</tt> function, <a href="ldi-2.html#indexterm-493">Accessing Target Devices</a></dd>
<dd><tt>ldi_ident_from_dev()</tt> function<dl>
<dd><a href="ldi-2.html#indexterm-471">Layered Identifiers &ndash; Kernel Device Consumers</a></dd>
<dd><a href="ldi-2.html#indexterm-525">Driver Source File</a></dd>
</dl>
</dd>
<dd><tt>ldi_ident_from_dip()</tt> function, <a href="ldi-2.html#indexterm-472">Layered Identifiers &ndash; Kernel Device Consumers</a></dd>
<dd><tt>ldi_ident_from_stream()</tt> function, <a href="ldi-2.html#indexterm-473">Layered Identifiers &ndash; Kernel Device Consumers</a></dd>
<dd><tt>ldi_ident_release()</tt> function<dl>
<dd><a href="ldi-2.html#indexterm-474">Layered Identifiers &ndash; Kernel Device Consumers</a></dd>
<dd><a href="ldi-2.html#indexterm-528">Driver Source File</a></dd>
</dl>
</dd>
<dd><tt>ldi_ioctl()</tt> function, <a href="ldi-2.html#indexterm-491">Accessing Target Devices</a></dd>
<dd><tt>ldi_open_by_dev()</tt> function, <a href="ldi-2.html#indexterm-479">Opening and Closing Target Devices</a></dd>
<dd><tt>ldi_open_by_devid()</tt> function, <a href="ldi-2.html#indexterm-480">Opening and Closing Target Devices</a></dd>
<dd><tt>ldi_open_by_name()</tt> function<dl>
<dd><a href="ldi-2.html#indexterm-481">Opening and Closing Target Devices</a></dd>
<dd><a href="ldi-2.html#indexterm-526">Driver Source File</a></dd>
</dl>
</dd>
<dd><tt>ldi_poll()</tt> function, <a href="ldi-2.html#indexterm-490">Accessing Target Devices</a></dd>
<dd><tt>ldi_prop_exists()</tt> function, <a href="ldi-2.html#indexterm-505">Retrieving Target Device Property Values</a></dd>
<dd><tt>ldi_prop_get_int()</tt> function, <a href="ldi-2.html#indexterm-506">Retrieving Target Device Property Values</a></dd>
<dd><tt>ldi_prop_get_int64()</tt> function, <a href="ldi-2.html#indexterm-507">Retrieving Target Device Property Values</a></dd>
<dd><tt>ldi_prop_lookup_byte_array()</tt> function, <a href="ldi-2.html#indexterm-512">Retrieving Target Device Property Values</a></dd>
<dd><tt>ldi_prop_lookup_int_array()</tt> function, <a href="ldi-2.html#indexterm-508">Retrieving Target Device Property Values</a></dd>
<dd><tt>ldi_prop_lookup_int64_array()</tt> function, <a href="ldi-2.html#indexterm-509">Retrieving Target Device Property Values</a></dd>
<dd><tt>ldi_prop_lookup_string_array()</tt> function, <a href="ldi-2.html#indexterm-511">Retrieving Target Device Property Values</a></dd>
<dd><tt>ldi_prop_lookup_string()</tt> function, <a href="ldi-2.html#indexterm-510">Retrieving Target Device Property Values</a></dd>
<dd><tt>ldi_putmsg()</tt> function, <a href="ldi-2.html#indexterm-494">Accessing Target Devices</a></dd>
<dd><tt>ldi_read()</tt> function, <a href="ldi-2.html#indexterm-484">Accessing Target Devices</a></dd>
<dd><tt>ldi_remove_event_handler()</tt> function, <a href="ldi-2.html#indexterm-519">Receiving Asynchronous Device Event Notification</a></dd>
<dd><tt>ldi_strategy()</tt> function, <a href="ldi-2.html#indexterm-488">Accessing Target Devices</a></dd>
<dd><tt>ldi_write()</tt> function<dl>
<dd><a href="ldi-2.html#indexterm-486">Accessing Target Devices</a></dd>
<dd><a href="ldi-2.html#indexterm-530">Driver Source File</a></dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<dl>
<dd>LDI types<dl>
<dd><tt>ldi_callback_id_t</tt>, <a href="ldi-2.html#indexterm-516">Receiving Asynchronous Device Event Notification</a></dd>
<dd><tt>ldi_handle_t</tt>, <a href="ldi-2.html#indexterm-477">Layered Driver Handles &ndash; Target Devices</a></dd>
<dd><tt>ldi_ident_t</tt>, <a href="ldi-2.html#indexterm-470">Layered Identifiers &ndash; Kernel Device Consumers</a></dd>
</dl>
</dd>
</dl>
<dl>
<dd>leaf devices, description of, <a href="kernelovr-64300.html#indexterm-33">Device Tree Components</a></dd>
</dl>
<dl>
<dd>leaf nodes, <a href="gemgi.html#indexterm-434">Fault Injection</a></dd>
</dl>
<dl>
<dd>legacy interrupts<dl>
<dd>defined, <a href="interrupt-11.html#fxjzi">Device Interrupts</a></dd>
<dd>using, <a href="interrupt-11.html#indexterm-93">Legacy Interrupts</a></dd>
</dl>
</dd>
</dl>
<dl>
<dd><i>length</i> argument, <tt>ddi_dma_mem_alloc()</tt>, changes to, <a href="lp64-54.html#indexterm-1345">ddi_dma_mem_alloc() Argument Changes</a></dd>
</dl>
<dl>
<dd><tt>libdevinfo()</tt>, displaying the device tree, <a href="kernelovr-64300.html#indexterm-37">libdevinfo Library</a></dd>
</dl>
<dl>
<dd><tt>libdevinfo</tt> device information library, <a href="ldi-5.html#indexterm-539">User Interfaces</a></dd>
</dl>
<dl>
<dd>linking drivers, <a href="loading-1.html#indexterm-1081">Compiling and Linking the Driver</a></dd>
</dl>
<dl>
<dd><tt>lint</tt> command, 64-bit environment, <a href="lp64-54.html#indexterm-1310">General Conversion Steps</a></dd>
</dl>
<dl>
<dd>list suspect, definition, <a href="fmaiofs.html#indexterm-284">Diagnosis, Suspect Lists, and Fault Events</a></dd>
</dl>
<dl>
<dd>lnode, <a href="ldi-5.html#indexterm-540">Device Information Library Interfaces</a></dd>
</dl>
<dl>
<dd>loadable module functions, <a href="ddidkisvc-8.html#indexterm-1247">Module Functions</a></dd>
</dl>
<dl>
<dd>loading drivers, <a href="loading-1.html#indexterm-1082">Compiling and Linking the Driver</a><dl>
<dd><tt>add_drv</tt> command, <a href="loading-85890.html#loading-ix583">Installing Drivers with add_drv</a></dd>
<dd>hardware configuration file, <a href="loading-1.html#loading-ix576">Writing a Hardware Configuration File</a></dd>
</dl>
</dd>
</dl>
<dl>
<dd>loading modules<dl>
<dd><a href="eqbqy.html#indexterm-9">Loadable Module Entry Points</a></dd>
<dd><a href="loading-85890.html#loading-ix579">Copying the Driver to a Module Directory</a></dd>
</dl>
</dd>
</dl>
<dl>
<dd>loading test modules, <a href="debug-61.html#indexterm-1139">Loading and Unloading Test Modules</a></dd>
</dl>
<dl>
<dd>locking primitives, types of, <a href="mt-8.html#mt-ix185">Locking Primitives</a></dd>
</dl>
<dl>
<dd>locks<dl>
<dd>manipulating, <a href="ddidkisvc-26.html#indexterm-1260">Kernel Thread Control and Synchronization Functions</a></dd>
<dd>mutex, <a href="mt-8.html#indexterm-46">Mutual-Exclusion Locks</a></dd>
<dd>readers/writer, <a href="mt-8.html#indexterm-48">Readers/Writer Locks</a></dd>
<dd>scheme for, <a href="mt-35265.html#mt-ix207">Choosing a Locking Scheme</a></dd>
</dl>
</dd>
</dl>
<dl>
<dd>LP64<dl>
<dd>use in <tt>devmap()</tt>, <a href="lp64-54.html#indexterm-1356">Data Sharing in devmap()</a></dd>
<dd>use in <tt>ioctl()</tt>, <a href="lp64-54.html#indexterm-1350">Data Sharing in ioctl()</a></dd>
</dl>
</dd>
</dl>
<dl>
<dd>LUN bits, <a href="scsi-15.html#indexterm-595">Building a Command</a></dd>
</dl>
</div>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="idx-4.html">Previous</a>
             </td>
             <td align="right">
                 <a href="idx-6.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

