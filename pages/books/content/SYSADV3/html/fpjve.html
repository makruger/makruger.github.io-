<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Administering Virtual Local Area Networks - System Administration Guide: IP Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: IP Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="fpcso.html">Previous</a>
             </td>
             <td align="right">
                 <a href="fpjvl.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="iptm-1.html">Part&nbsp;I&nbsp;TCP/IP Administration</a></p>
<p class="toc level2"><a href="ipov-1.html">1.&nbsp;&nbsp;Solaris TCPIP Protocol Suite (Overview)</a></p>
<p class="toc level2"><a href="ipplan-1.html">2.&nbsp;&nbsp;Planning an IPv4 Addressing Scheme (Tasks</a></p>
<p class="toc level2"><a href="ipv6-overview-7.html">3.&nbsp;&nbsp;Planning an IPv6 Addressing Scheme (Overview)</a></p>
<p class="toc level2"><a href="ipv6-planning-1.html">4.&nbsp;&nbsp;Planning an IPv6 Network (Tasks)</a></p>
<p class="toc level2"><a href="ipconfig-1.html">5.&nbsp;&nbsp;Configuring TCP/IP Network Services and IPv4 Addressing (Tasks)</a></p>
<p class="toc level2"><a href="fwawf.html">6.&nbsp;&nbsp;Administering Network Interfaces (Tasks)</a></p>
<p class="toc level3"><a href="fpdih.html">Interface Administration (Task Map)</a></p>
<p class="toc level3"><a href="fpcwh.html">Basics for Administering Physical Interfaces</a></p>
<p class="toc level3"><a href="fpcso.html">Administering Individual Network Interfaces</a></p>
<p class="toc level4"><a href="fpcso.html#fpdik">How to Obtain Interface Status</a></p>
<p class="toc level4"><a href="fpcso.html#fpdcn">How to Configure a Physical Interface After System Installation</a></p>
<p class="toc level4"><a href="fpcso.html#fpcvg">How to Remove a Physical Interface</a></p>
<p class="toc level4"><a href="fpcso.html#eyprp">SPARC: How to Ensure That the MAC Address of an Interface Is Unique</a></p>
<div class="onpage">
<p class="toc level3 tocsp"><a href="">Administering Virtual Local Area Networks</a></p>
</div>
<p class="toc level3"><a href="fpjvl.html">Administering Link Aggregations</a></p>
<p class="toc level4"><a href="fpjvl.html#gafxi">How to Create a Link Aggregation</a></p>
<p class="toc level4"><a href="fpjvl.html#gafxe">How to Modify an Aggregation</a></p>
<p class="toc level4"><a href="fpjvl.html#gaxdg">How to Remove an Interface From an Aggregation</a></p>
<p class="toc level4"><a href="fpjvl.html#galsb">How to Delete an Aggregation</a></p>
<p class="toc level3 tocsp"><a href="gduew.html">Configuring and Communicating Over WiFi Interfaces</a></p>
<p class="toc level4"><a href="gduew.html#gdwra">How to Connect to a WiFi Network</a></p>
<p class="toc level4"><a href="gduew.html#gdwrw">How to Monitor the WiFi Link</a></p>
<p class="toc level2 tocsp"><a href="ipv6-config-tasks-1.html">7.&nbsp;&nbsp;Enabling IPv6 on a Network (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-admintasks-1.html">8.&nbsp;&nbsp;Administering a TCP/IP Network (Tasks)</a></p>
<p class="toc level2"><a href="gegel.html">9.&nbsp;&nbsp;Troubleshooting Network Problems (Tasks)</a></p>
<p class="toc level2"><a href="ipref-8.html">10.&nbsp;&nbsp;TCP/IP and IPv4 in Depth (Reference)</a></p>
<p class="toc level2"><a href="ipv6-ref-76.html">11.&nbsp;&nbsp;IPv6 in Depth (Reference)</a></p>
<p class="toc level1 tocsp"><a href="dhcptm-1.html">Part&nbsp;II&nbsp;DHCP</a></p>
<p class="toc level2"><a href="dhcp-overview-1.html">12.&nbsp;&nbsp;About Solaris DHCP (Overview)</a></p>
<p class="toc level2"><a href="chap2-26.html">13.&nbsp;&nbsp;Planning for DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="chapter3-20.html">14.&nbsp;&nbsp;Configuring the DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="dhcp-admin-9.html">15.&nbsp;&nbsp;Administering DHCP (Tasks)</a></p>
<p class="toc level2"><a href="eyatl.html">16.&nbsp;&nbsp;Configuring and Administering  DHCP Clients</a></p>
<p class="toc level2"><a href="dhcp-trouble-1.html">17.&nbsp;&nbsp;Troubleshooting DHCP (Reference)</a></p>
<p class="toc level2"><a href="dhcp-ref-4.html">18.&nbsp;&nbsp;DHCP Commands and Files (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipsectm-1.html">Part&nbsp;III&nbsp;IP Security</a></p>
<p class="toc level2"><a href="ipsec-ov-1.html">19.&nbsp;&nbsp;IP Security Architecture (Overview)</a></p>
<p class="toc level2"><a href="ipsec-mgtasks-1.html">20.&nbsp;&nbsp;Configuring IPsec (Tasks)</a></p>
<p class="toc level2"><a href="ipsecref-1.html">21.&nbsp;&nbsp;IP Security Architecture (Reference)</a></p>
<p class="toc level2"><a href="ike-1.html">22.&nbsp;&nbsp;Internet Key Exchange (Overview)</a></p>
<p class="toc level2"><a href="ike-task-1.html">23.&nbsp;&nbsp;Configuring IKE (Tasks)</a></p>
<p class="toc level2"><a href="ikeref-1.html">24.&nbsp;&nbsp;Internet Key Exchange (Reference)</a></p>
<p class="toc level2"><a href="eupsq.html">25.&nbsp;&nbsp;Solaris IP Filter (Overview)</a></p>
<p class="toc level2"><a href="ipfilter-admin-1.html">26.&nbsp;&nbsp;Solaris IP Filter (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="miptm-1.html">Part&nbsp;IV&nbsp;Mobile IP</a></p>
<p class="toc level2"><a href="mipoverview-1.html">27.&nbsp;&nbsp;Mobile IP (Overview)</a></p>
<p class="toc level2"><a href="mipimplementing-1.html">28.&nbsp;&nbsp;Administering Mobile IP (Tasks)</a></p>
<p class="toc level2"><a href="mipmanaging-22.html">29.&nbsp;&nbsp;Mobile IP Files and Commands (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipmptm-1.html">Part&nbsp;V&nbsp;IPMP</a></p>
<p class="toc level2"><a href="mpoverview.html">30.&nbsp;&nbsp;Introducing IPMP (Overview)</a></p>
<p class="toc level2"><a href="deploynetmult-56.html">31.&nbsp;&nbsp;Administering IPMP (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ipqostm-1.html">Part&nbsp;VI&nbsp;IP Quality of Service (IPQoS)</a></p>
<p class="toc level2"><a href="ipqos-intro-1.html">32.&nbsp;&nbsp;Introducing IPQoS (Overview)</a></p>
<p class="toc level2"><a href="ipqos-config-planning-1.html">33.&nbsp;&nbsp;Planning for an IPQoS-Enabled Network (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-policy-planning-1.html">34.&nbsp;&nbsp;Creating the IPQoS Configuration File (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-isp-setup-1.html">35.&nbsp;&nbsp;Starting and Maintaining IPQoS (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-accounting-1.html">36.&nbsp;&nbsp;Using Flow Accounting and Statistics Gathering (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-reference-1.html">37.&nbsp;&nbsp;IPQoS in Detail (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="fpjve"></a><h3>Administering Virtual Local Area Networks</h3>
<a name="indexterm-642"></a><a name="indexterm-643"></a><a name="indexterm-644"></a><a name="indexterm-645"></a><p>A <b>virtual local area network (VLAN)</b> is a subdivision of a local area network at the data
link layer of the TCP/IP protocol stack. You can create VLANs for local
area networks that use switch technology. By dividing groups of users into VLANs,
you can improve network administration and security for the entire local network. You
can also assign interfaces on the same system to different VLANs.</p><p>Consider dividing your local network into VLANs if you need to do
the following:<a name="indexterm-646"></a></p>
<ul><li><p>Create a logical division of workgroups.</p><p>For example, suppose all hosts on a floor of a building are connected on one switched-based local network. You could create a separate VLAN for each workgroup on the floor.</p></li>
<li><p>Enforce differing security policies for the workgroups.</p><p>For example, the security needs of a Finance department and an Information Technologies department are quite different. If systems for both departments share the same local network, you could create a separate VLAN for each department. Then, you could enforce the appropriate security policy on a per-VLAN basis.</p></li>
<li><p>Split workgroups into manageable broadcast domains.</p><p>The use of VLANs reduces the size of broadcast domains and improves network efficiency.</p></li></ul>


<a name="fumvy"></a><h4>Overview of VLAN Topology</h4>
<a name="indexterm-647"></a><p>Switched LAN technology enables you to organize the systems on a local network
into VLANs. Before you can divide a local network into VLANs, you must
obtain switches that support VLAN technology. You can configure all ports on a
switch to serve a single VLAN or multiple VLANs, depending on the
VLAN topology design. Each switch manufacturer has different procedures for configuring the ports of
a switch.</p><p><a href="#gatoo">Figure&nbsp;6-1</a> shows a local area network that has the subnet address <tt>192.168.84.0</tt>. This LAN
is subdivided into three VLANs, Red, Yellow, and blue.</p><a name="gatoo"></a><h6>Figure&nbsp;6-1 Local Area Network With Three VLANs</h6><img src="figures/VLAN-top.gif" alt="The surrounding context describes the figure's content."></img><p>Connectivity on LAN <tt>192.168.84.0</tt> is handled by Switches 1 and 2. Systems of
the Information Technologies workgroup are assigned to the Blue VLAN. The Human Resources
workgroup's systems are on the Yellow VLAN. The Red VLAN contains systems in
the Accounting workgroup. </p>

<a name="fumva"></a><h5>VLAN Tags and Physical Points of Attachment</h5>
<a name="indexterm-648"></a><p>Each VLAN in a local area network is identified by a VLAN
tag, or <b>VLAN ID (VID)</b>. The VID is assigned during VLAN configuration. The VID is
a 12-bit identifier between 1 and 4094 that provides a unique identity for
each VLAN. In <a href="#gatoo">Figure&nbsp;6-1</a>, the Blue VLAN has the VID 123, the Yellow
VLAN has the VID 456, and the Red VLAN has the VID 789.
</p><p>When you configure switches to support VLANs, you need to assign a
VID to each port. The VID on the port must be the same
as the VID assigned to the interface that connects to the port, as
shown in the following figure.</p><a name="gatol"></a><h6>Figure&nbsp;6-2 Switch Configuration for a Network with VLANs</h6><a name="indexterm-649"></a><a name="indexterm-650"></a><img src="figures/VLAN-config-switch.gif" alt="The surrounding context describes the figure's content."></img><p>In this figure, the primary network interfaces of three hosts connect into Switch
1. Host A is a member of the Blue VLAN. Therefore, Host
A's interface is configured with the VID 123. This interface connects to Port
1 on Switch 1, which is then configured with the VID 123. Host
B is a member of the Yellow VLAN, with the VID 456. Host
B's interface connects to Port 5 on Switch 1, which is configured with
the VID 456, and so on.</p><p><a name="indexterm-651"></a><a name="indexterm-652"></a>During VLAN configuration, you have to specify the <b>physical point of attachment</b>, or <b>PPA</b>, of
the VLAN. You obtain the PPA value by using this formula:</p><pre><i>driver-name</i> + VID * 1000 + <i>device-instance</i></pre><p>Note that the <i>device-instance</i> number must be less than 1000.</p><p>For example, you would create the following PPA for a <tt>ce1</tt> interface to
be configured as part of VLAN 456:</p><pre>ce + 456 * 1000 + 1= ce456001</pre>

<a name="fumzn"></a><h4>Planning for VLANs on a Network</h4>
<p>Use the next procedure for planning for VLANs on your network. </p>

<a name="fumzp"></a><h5>How to Plan for VLAN Configuration</h5>
<a name="indexterm-653"></a><ol>
<li><b>Examine the local network topology and determine where subdivision into VLANs is appropriate.</b><p>For a basic example of such a topology, refer to <a href="#gatoo">Figure&nbsp;6-1</a>.</p></li>
<li><b>Create a numbering scheme for the VIDs and assign a VID to
each VLAN.</b>
<hr><p><b>Note - </b>A VLAN numbering scheme might already exist on the network. If so, you
must create VIDs within the existing VLAN numbering framework.</p>
<hr>
</li>
<li><b>On each system, determine which interfaces should be members of a particular VLAN.</b><ol style="list-style-type: lower-alpha">
				 
<li><b>Find out which interfaces are configured on a host.</b><pre># <tt><b>dladm show-link</b></tt></pre></li>
<li><b>Identify which VID should be associated with each data link on the system.</b></li>
<li><b>Create PPAs for each interface to be configured with a VLAN.</b></li></ol><p>All interfaces on a system do not necessarily have to be configured on
the same VLAN.</p></li>
<li><b>Check the connections of the interfaces to the network's switches.</b><p>Note the VID of each interface and the switch port where each
interface is connected.</p></li>
<li><b>Configure each port of the switch with the same VID as the
interface to which it is connected.</b><p>Refer to the switch manufacturer's documentation for configuration instructions.</p></li></ol>

<a name="fpdga"></a><h4>Configuring VLANs</h4>
<a name="indexterm-654"></a><a name="indexterm-655"></a><p>The Solaris OS now supports VLANs on the following interface types:<a name="indexterm-656"></a></p>
<ul><li><p><tt>ce</tt></p></li>
<li><p><tt>bge</tt></p></li>
<li><p><tt>xge</tt></p></li>
<li><p><tt>e1000g</tt></p></li></ul>
<p>Of the legacy interface types, only the <tt>ce</tt> interface can become a member
of a VLAN. You can configure interfaces of different types in the same
VLAN. For information about the interface types that are supported by the Solaris
OS, refer to <a href="fpcwh.html#gaugz">Solaris OS Interface Types</a>.</p>

<a name="fpden"></a><h5>How to Configure a VLAN</h5>
<a name="indexterm-657"></a><a name="indexterm-658"></a><ol>
<li><b>Assume the Primary Administrator role, or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b>Determine the types of interfaces in use on your system.</b><pre># <tt><b>dladm show-link</b></tt></pre><p>The output shows the available interface types:</p><pre>ce0             type: legacy    mtu: 1500       device: ce0
ce1             type: legacy    mtu: 1500       device: ce1
bge0            type: non-vlan  mtu: 1500       device: bge0
bge1            type: non-vlan  mtu: 1500       device: bge1
bge2            type: non-vlan  mtu: 1500       device: bge2</pre></li>
<li><a name="fpdak"></a><b>Configure an interface as part of a VLAN. <a name="indexterm-659"></a></b><pre># <tt><b>ifconfig</b></tt> <i>interface-PPA</i> <tt><b>plumb </tt><i>IP-address</i><tt> up</b></tt></pre><p>For example, you would use the following command to configure the interface
<tt>ce1</tt> with a new IP address <tt>10.0.0.2</tt> into a VLAN with the VID
123:</p><pre># <tt><b>ifconfig ce123001 plumb 10.0.0.2 up</b></tt></pre></li>
<li><b>(Optional) To make the VLAN settings persist across reboots, create a <tt>hostname.</tt><i>interface-PPA</i> file
for each interface that is configured as part of a VLAN. </b><pre># <tt><b>cat hostname.</b></tt><i>interface-PPA</i>
<i>IPv4-address</i></pre></li>
<li><b>On the switch, set VLAN tagging and VLAN ports to correspond with the
VLANs that you have set up on the system. </b></li></ol><a name="gamkn"></a>Example&nbsp;6-3 Configuring a VLAN<p>This example shows how to configure devices <tt>bge1</tt> and <tt>bge2</tt> into a
VLAN with the VID 123.</p><pre># <tt><b>dladm show-link</b></tt>
ce0             type: legacy    mtu: 1500       device: ce0
ce1             type: legacy    mtu: 1500       device: ce1
bge0            type: non-vlan  mtu: 1500       device: bge0
bge1            type: non-vlan  mtu: 1500       device: bge1
bge2            type: non-vlan  mtu: 1500       device: bge2
# <tt><b>ifconfig bge123001 plumb 10.0.0.1 up</b></tt>
# <tt><b>ifconfig bge123002 plumb 10.0.0.2 up</b></tt> 
# <tt><b>cat hostname.bge123001 10.0.0.1</b></tt>
# <tt><b>cat hostname.bge123002 10.0.0.2</b></tt>
# <tt><b>ifconfig -a</b></tt>

lo0: flags=2001000849 &lt;UP,LOOPBACK,RUNNING,MULTICAST,IPv4,VIRTUAL> 
     mtu 8232 index 1
        inet 127.0.0.1 netmask ff000000 
bge123001: flags=201000803 &lt;UP,BROADCAST,MULTICAST,IPv4,CoS> mtu 1500 index 2
        inet 10.0.0.1 netmask ff000000 broadcast 10.255.255.255
        ether 0:3:ba:7:84:5e 
bge123002: flags=201000803 &lt;UP,BROADCAST,MULTICAST,IPv4,CoS> mtu 1500 index 3
        inet 10.0.0.2 netmask ff000000 broadcast 10.255.255.255
        ether 0:3:ba:7:84:5e 
ce0: flags=1000843 &lt;UP,BROADCAST,RUNNING,MULTICAST,IPv4> mtu 1500 index 4
        inet 192.168.84.253 netmask ffffff00 broadcast 192.168.84.255
        ether 0:3:ba:7:84:5e 
# <tt><b>dladm show-link</b></tt>
ce0             type: legacy    mtu: 1500       device: ce0
ce1             type: legacy    mtu: 1500       device: ce1
bge0            type: non-vlan  mtu: 1500       device: bge0
bge1            type: non-vlan  mtu: 1500       device: bge1
bge2            type: non-vlan  mtu: 1500       device: bge2
bge123001       type: vlan 123  mtu: 1500       device: bge1
bge123002       type: vlan 123  mtu: 1500       device: bge2</pre>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="fpcso.html">Previous</a>
             </td>
             <td align="right">
                 <a href="fpjvl.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

