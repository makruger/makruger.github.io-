<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Configuring Solaris IP Filter - System Administration Guide: IP Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: IP Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ipfilter-admin-1.html">Previous</a>
             </td>
             <td align="right">
                 <a href="fabar.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="iptm-1.html">Part&nbsp;I&nbsp;TCP/IP Administration</a></p>
<p class="toc level2"><a href="ipov-1.html">1.&nbsp;&nbsp;Solaris TCPIP Protocol Suite (Overview)</a></p>
<p class="toc level2"><a href="ipplan-1.html">2.&nbsp;&nbsp;Planning an IPv4 Addressing Scheme (Tasks</a></p>
<p class="toc level2"><a href="ipv6-overview-7.html">3.&nbsp;&nbsp;Planning an IPv6 Addressing Scheme (Overview)</a></p>
<p class="toc level2"><a href="ipv6-planning-1.html">4.&nbsp;&nbsp;Planning an IPv6 Network (Tasks)</a></p>
<p class="toc level2"><a href="ipconfig-1.html">5.&nbsp;&nbsp;Configuring TCP/IP Network Services and IPv4 Addressing (Tasks)</a></p>
<p class="toc level2"><a href="fwawf.html">6.&nbsp;&nbsp;Administering Network Interfaces (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-config-tasks-1.html">7.&nbsp;&nbsp;Enabling IPv6 on a Network (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-admintasks-1.html">8.&nbsp;&nbsp;Administering a TCP/IP Network (Tasks)</a></p>
<p class="toc level2"><a href="gegel.html">9.&nbsp;&nbsp;Troubleshooting Network Problems (Tasks)</a></p>
<p class="toc level2"><a href="ipref-8.html">10.&nbsp;&nbsp;TCP/IP and IPv4 in Depth (Reference)</a></p>
<p class="toc level2"><a href="ipv6-ref-76.html">11.&nbsp;&nbsp;IPv6 in Depth (Reference)</a></p>
<p class="toc level1 tocsp"><a href="dhcptm-1.html">Part&nbsp;II&nbsp;DHCP</a></p>
<p class="toc level2"><a href="dhcp-overview-1.html">12.&nbsp;&nbsp;About Solaris DHCP (Overview)</a></p>
<p class="toc level2"><a href="chap2-26.html">13.&nbsp;&nbsp;Planning for DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="chapter3-20.html">14.&nbsp;&nbsp;Configuring the DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="dhcp-admin-9.html">15.&nbsp;&nbsp;Administering DHCP (Tasks)</a></p>
<p class="toc level2"><a href="eyatl.html">16.&nbsp;&nbsp;Configuring and Administering  DHCP Clients</a></p>
<p class="toc level2"><a href="dhcp-trouble-1.html">17.&nbsp;&nbsp;Troubleshooting DHCP (Reference)</a></p>
<p class="toc level2"><a href="dhcp-ref-4.html">18.&nbsp;&nbsp;DHCP Commands and Files (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipsectm-1.html">Part&nbsp;III&nbsp;IP Security</a></p>
<p class="toc level2"><a href="ipsec-ov-1.html">19.&nbsp;&nbsp;IP Security Architecture (Overview)</a></p>
<p class="toc level2"><a href="ipsec-mgtasks-1.html">20.&nbsp;&nbsp;Configuring IPsec (Tasks)</a></p>
<p class="toc level2"><a href="ipsecref-1.html">21.&nbsp;&nbsp;IP Security Architecture (Reference)</a></p>
<p class="toc level2"><a href="ike-1.html">22.&nbsp;&nbsp;Internet Key Exchange (Overview)</a></p>
<p class="toc level2"><a href="ike-task-1.html">23.&nbsp;&nbsp;Configuring IKE (Tasks)</a></p>
<p class="toc level2"><a href="ikeref-1.html">24.&nbsp;&nbsp;Internet Key Exchange (Reference)</a></p>
<p class="toc level2"><a href="eupsq.html">25.&nbsp;&nbsp;Solaris IP Filter (Overview)</a></p>
<p class="toc level2"><a href="ipfilter-admin-1.html">26.&nbsp;&nbsp;Solaris IP Filter (Tasks)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Configuring Solaris IP Filter</a></p>
<p class="toc level4"><a href="#gdwzk">How to Enable Solaris IP Filter</a></p>
<p class="toc level4"><a href="#eubbr">How to Re-Enable Solaris IP Filter</a></p>
<p class="toc level4"><a href="#gdwzr">How to Enable Loopback Filtering</a></p>
</div>
<p class="toc level3 tocsp"><a href="fabar.html">Deactivating and Disabling Solaris IP Filter</a></p>
<p class="toc level4"><a href="fabar.html#ettms">How to Deactivate Packet Filtering</a></p>
<p class="toc level4"><a href="fabar.html#ettmt">How to Deactivate NAT</a></p>
<p class="toc level4"><a href="fabar.html#ettmo">How to Disable Packet Filtering</a></p>
<p class="toc level3 tocsp"><a href="eubbd.html">Working With Solaris IP Filter Rule Sets</a></p>
<p class="toc level3"><a href="faaxo.html">Displaying Statistics and Information for Solaris IP Filter</a></p>
<p class="toc level4"><a href="faaxo.html#faapk">How to View State Tables for Solaris IP Filter</a></p>
<p class="toc level4"><a href="faaxo.html#faapx">How to View State Statistics for Solaris IP Filter</a></p>
<p class="toc level4"><a href="faaxo.html#faapy">How to View NAT Statistics for Solaris IP Filter</a></p>
<p class="toc level4"><a href="faaxo.html#faapz">How to View Address Pool Statistics for Solaris IP Filter</a></p>
<p class="toc level3 tocsp"><a href="faavk.html">Working With Log Files for Solaris IP Filter</a></p>
<p class="toc level4"><a href="faavk.html#gdfwa">How to Set Up a Log File for Solaris IP Filter</a></p>
<p class="toc level4"><a href="faavk.html#faaqc">How to View Solaris IP Filter Log Files</a></p>
<p class="toc level4"><a href="faavk.html#faaqf">How to Flush the Packet Log File</a></p>
<p class="toc level4"><a href="faavk.html#faard">How to Save Logged Packets to a File</a></p>
<p class="toc level3 tocsp"><a href="ipfilter-admin-2.html">Creating and Editing Solaris IP Filter Configuration Files</a></p>
<p class="toc level4"><a href="ipfilter-admin-2.html#fahpp">How to Create a Configuration File for Solaris IP Filter</a></p>
<p class="toc level1 tocsp"><a href="miptm-1.html">Part&nbsp;IV&nbsp;Mobile IP</a></p>
<p class="toc level2"><a href="mipoverview-1.html">27.&nbsp;&nbsp;Mobile IP (Overview)</a></p>
<p class="toc level2"><a href="mipimplementing-1.html">28.&nbsp;&nbsp;Administering Mobile IP (Tasks)</a></p>
<p class="toc level2"><a href="mipmanaging-22.html">29.&nbsp;&nbsp;Mobile IP Files and Commands (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipmptm-1.html">Part&nbsp;V&nbsp;IPMP</a></p>
<p class="toc level2"><a href="mpoverview.html">30.&nbsp;&nbsp;Introducing IPMP (Overview)</a></p>
<p class="toc level2"><a href="deploynetmult-56.html">31.&nbsp;&nbsp;Administering IPMP (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ipqostm-1.html">Part&nbsp;VI&nbsp;IP Quality of Service (IPQoS)</a></p>
<p class="toc level2"><a href="ipqos-intro-1.html">32.&nbsp;&nbsp;Introducing IPQoS (Overview)</a></p>
<p class="toc level2"><a href="ipqos-config-planning-1.html">33.&nbsp;&nbsp;Planning for an IPQoS-Enabled Network (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-policy-planning-1.html">34.&nbsp;&nbsp;Creating the IPQoS Configuration File (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-isp-setup-1.html">35.&nbsp;&nbsp;Starting and Maintaining IPQoS (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-accounting-1.html">36.&nbsp;&nbsp;Using Flow Accounting and Statistics Gathering (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-reference-1.html">37.&nbsp;&nbsp;IPQoS in Detail (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="etmhi"></a><h3>Configuring Solaris IP Filter</h3>
<p>The following task map identifies the procedures associated with configuring Solaris IP Filter.</p><a name="euazt"></a><h6>Table&nbsp;26-1 Configuring Solaris IP Filter (Task Map)</h6><table><col width="33*"><col width="33*"><col width="33*"><tr><th align="left" valign="top" scope="column"><p>Task</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>For
Instructions</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Initially enable Solaris IP Filter.</p></td>
<td align="left" valign="top" scope="row"><p>Solaris IP Filter is not enabled by default.
You must either enable it manually or use the configuration files in the
<tt>/etc/ipf/</tt> directory and reboot the system. Beginning with Solaris Express, Developer Edition 2/07 release, packet
filter hooks replaced the <tt>pfil</tt> module to enable Solaris IP filter.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#gdwzk">How to Enable Solaris IP Filter</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Re-enable Solaris IP
Filter.</p></td>
<td align="left" valign="top" scope="row"><p>If Solaris IP Filter is deactivated or disabled, you can re-enable Solaris IP
Filter either by rebooting the system or by using the <tt>ipf</tt> command.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#eubbr">How to Re-Enable Solaris IP Filter</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Enable
loopback filtering</p></td>
<td align="left" valign="top" scope="row"><p>As an option, you can enable loopback filtering, for example, to
filter traffic between zones.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#gdwzr">How to Enable Loopback Filtering</a></p></td>
</tr>
</table>

<a name="gdwzk"></a><h4>How to Enable Solaris IP Filter</h4><a name="indexterm-2343"></a><p>Use this procedure to enable Solaris IP Filter on a system that
is running at least  Solaris Express, Developer Edition 2/07 OS.</p><ol>
<li><b>Assume a role that includes the IP Filter Management rights profile, or become
superuser.</b><p>You can assign the IP Filter Management rights profile to a role that
you create. To create the role and assign the role to a user,
see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><b>Create a packet filtering rule set.</b><p>The packet filtering rule set contains packet filtering rules that are used by
Solaris IP Filter. If you want the packet filtering rules to be loaded
at boot time, edit the <tt>/etc/ipf/ipf.conf</tt> file to implement IPv4 packet filtering. Use
the <tt>/etc/ipf/ipf6.conf</tt> file for IPv6 packet filtering rules. If you do not want
the packet filtering rules loaded at boot time, put the rules in a
file of your choice, and manually activate packet filtering. For information about packet
filtering, see <a href="ezecx.html#euqfb">Using Solaris IP Filter's Packet Filtering Feature</a>. For information about working with configuration files, see <a href="ipfilter-admin-2.html">Creating and Editing Solaris IP Filter Configuration Files</a>.</p></li>
<li><b>(Optional) Create a network address translation (NAT) configuration file.</b>
<hr><p><b>Note - </b>Network Address Translation (NAT) does not support IPv6.</p>
<hr>
<p>Create an <tt>ipnat.conf</tt> file if you want to use network address translation.
If you want the NAT rules to be loaded at boot time, create
a file called <tt>/etc/ipf/ipnat.conf</tt> in which to put NAT rules. If you
do not want the NAT rules loaded at boot time, put the <tt>ipnat.conf</tt>
file in a location of your choice, and manually activate the NAT rules.</p><p>For more information about NAT, see <a href="ezecx.html#euqfc">Using Solaris IP Filter's NAT Feature</a>.</p></li>
<li><b>(Optional) Create an address pool configuration file.</b><p>Create an <tt>ipool.conf</tt> file if you want to refer to a group of addresses
as a single address pool. If you want the address pool configuration file
to be loaded at boot time, create a file called <tt>/etc/ipf/ippool.conf</tt> in
which to put the address pool. If you do not want the
address pool configuration file to be loaded at boot time, put the <tt>ippool.conf</tt>
file in a location of your choice, and manually activate the rules.</p><p>An address pool can contain only IPv4 addresses or only IPv6 addresses.
It can also contain both IPv4 and IPv6 addresses.</p><p>For more information about address pools, see <a href="ezecx.html#euqfe">Using Solaris IP Filter's Address Pools Feature</a>.</p></li>
<li><b>(Optional) Enable filtering of loopback traffic.</b><p>If you intend to filter traffic between zones that are configured in your
system, you must enable loopback filtering. See <a href="#gdwzr">How to Enable Loopback Filtering</a>. Make sure that you also
define the appropriate rule sets that apply to the zones.</p></li>
<li><b>Activate Solaris IP Filter.</b><pre># <tt><b>svcadm enable network/ipfilter</b></tt></pre></li></ol>

<a name="eubbr"></a><h4>How to Re-Enable Solaris IP Filter</h4><a name="indexterm-2344"></a><a name="indexterm-2345"></a><a name="indexterm-2346"></a><a name="indexterm-2347"></a><a name="indexterm-2348"></a><a name="indexterm-2349"></a><a name="indexterm-2350"></a><p>You can re-enable packet filtering after it has been temporarily disabled.</p><ol>
<li><b>Assume a role that includes the IP Filter Management rights profile, or become
superuser.</b><p>You can assign the IP Filter Management rights profile to a role that
you create. To create the role and assign the role to a user,
see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><b>Enable Solaris IP Filter and activate filtering using one of the following methods:</b>
<ul><li><p>Reboot the machine.</p><pre># <tt><b>reboot</b></tt></pre>
<hr><p><b>Note - </b>When IP Filter is enabled, after a reboot the following files are loaded if they are present: the <tt>/etc/ipf/ipf.conf</tt> file, the <tt>/etc/ipf/ipf6.conf</tt> file when using IPv6, or the <tt>/etc/ipf/ipnat.conf</tt>.</p>
<hr>
</li>
<li><p>Perform the following series of commands to enable Solaris IP Filter and activate filtering:</p>
<ol><li><p>Enable Solaris IP Filter.</p><pre># <tt><b>ipf -E</b></tt></pre></li>
<li><p>Activate packet filtering.</p><pre># <tt><b>ipf -f </tt><i>filename</i><tt></b></tt></pre></li>
<li><p>(Optional) Activate NAT.</p><pre># <tt><b>ipnat -f </tt><i>filename</i><tt></b></tt></pre>
<hr><p><b>Note - </b>Network Address Translation (NAT) does not support IPv6.</p>
<hr>
</li></ol>
</li></ul>
</li></ol>

<a name="gdwzr"></a><h4>How to Enable Loopback Filtering</h4><a name="indexterm-2351"></a>
<hr><p><b>Note - </b>You can filter loopback traffic only if your system is running at least
Solaris Express, Developer Edition 2/07 release. In previous Solaris 10 releases, loopback filtering
is not supported.</p>
<hr>
<ol>
<li><b>Assume a role that includes the IP Filter Management rights profile, or become
superuser.</b><p>You can assign the IP Filter Management rights profile to a role that
you create. To create the role and assign the role to a user,
see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><b>Stop Solaris IP Filter if it is running.</b><pre># <tt><b>svcadm disable network/ipfilter</b></tt></pre></li>
<li><b>Edit the <tt>/etc/ipf.conf</tt> or <tt>/etc/ipf6.conf</tt> file by adding the following line at
the beginning of the file:</b><pre>set intercept_loopback true;</pre><p>This line must precede all the IP filter rules that are defined
in the file. However, you can insert comments before the line, similar to
the following example:</p><pre># 
# Enable loopback filtering to filter between zones 
# 
set intercept_loopback true; 
# 
# Define policy 
# 
block in all 
block out all 
&lt;other rules>
...</pre></li>
<li><b>Start the Solaris IP filter.</b><pre># <tt><b>svcadm enable network/ipfilter</b></tt></pre></li>
<li><b>To verify the status of loopback filtering, use the following command:</b><pre># <tt><b>ipf &mdash;T ipf_loopback</b></tt>
ipf_loopback    min 0   max 0x1 current 1
#</pre><p>If loopback filtering is disabled, the command would generate the following output:</p><pre>ipf_loopback    min 0   max 0x1 current 0</pre></li></ol>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ipfilter-admin-1.html">Previous</a>
             </td>
             <td align="right">
                 <a href="fabar.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

