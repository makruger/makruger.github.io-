<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>DHCP Client Systems and Name Services - System Administration Guide: IP Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: IP Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="eyhuv.html">Previous</a>
             </td>
             <td align="right">
                 <a href="extkj.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="iptm-1.html">Part&nbsp;I&nbsp;TCP/IP Administration</a></p>
<p class="toc level2"><a href="ipov-1.html">1.&nbsp;&nbsp;Solaris TCPIP Protocol Suite (Overview)</a></p>
<p class="toc level2"><a href="ipplan-1.html">2.&nbsp;&nbsp;Planning an IPv4 Addressing Scheme (Tasks</a></p>
<p class="toc level2"><a href="ipv6-overview-7.html">3.&nbsp;&nbsp;Planning an IPv6 Addressing Scheme (Overview)</a></p>
<p class="toc level2"><a href="ipv6-planning-1.html">4.&nbsp;&nbsp;Planning an IPv6 Network (Tasks)</a></p>
<p class="toc level2"><a href="ipconfig-1.html">5.&nbsp;&nbsp;Configuring TCP/IP Network Services and IPv4 Addressing (Tasks)</a></p>
<p class="toc level2"><a href="fwawf.html">6.&nbsp;&nbsp;Administering Network Interfaces (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-config-tasks-1.html">7.&nbsp;&nbsp;Enabling IPv6 on a Network (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-admintasks-1.html">8.&nbsp;&nbsp;Administering a TCP/IP Network (Tasks)</a></p>
<p class="toc level2"><a href="gegel.html">9.&nbsp;&nbsp;Troubleshooting Network Problems (Tasks)</a></p>
<p class="toc level2"><a href="ipref-8.html">10.&nbsp;&nbsp;TCP/IP and IPv4 in Depth (Reference)</a></p>
<p class="toc level2"><a href="ipv6-ref-76.html">11.&nbsp;&nbsp;IPv6 in Depth (Reference)</a></p>
<p class="toc level1 tocsp"><a href="dhcptm-1.html">Part&nbsp;II&nbsp;DHCP</a></p>
<p class="toc level2"><a href="dhcp-overview-1.html">12.&nbsp;&nbsp;About Solaris DHCP (Overview)</a></p>
<p class="toc level2"><a href="chap2-26.html">13.&nbsp;&nbsp;Planning for DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="chapter3-20.html">14.&nbsp;&nbsp;Configuring the DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="dhcp-admin-9.html">15.&nbsp;&nbsp;Administering DHCP (Tasks)</a></p>
<p class="toc level2"><a href="eyatl.html">16.&nbsp;&nbsp;Configuring and Administering  DHCP Clients</a></p>
<p class="toc level3"><a href="geflo.html">About the Solaris DHCP Client</a></p>
<p class="toc level3"><a href="dhcp-config-67.html">Enabling and Disabling a Solaris DHCP Client</a></p>
<p class="toc level4"><a href="dhcp-config-67.html#dhcp-config-105">How to Enable the Solaris DHCP Client</a></p>
<p class="toc level4"><a href="dhcp-config-67.html#dhcp-config-104">How to Disable a Solaris DHCP Client</a></p>
<p class="toc level3 tocsp"><a href="dhcp-overview-33a.html">DHCP Client Administration</a></p>
<p class="toc level3"><a href="dhcp-overview-35a.html">DHCP Client Systems With Multiple Network Interfaces</a></p>
<p class="toc level3"><a href="eyhuv.html">DHCP Client Host Names</a></p>
<p class="toc level4"><a href="eyhuv.html#dhcp-admin-1058sm">How to Enable a Solaris Client to Request a Specific Host Name</a></p>
<div class="onpage">
<p class="toc level3 tocsp"><a href="">DHCP Client Systems and Name Services</a></p>
</div>
<p class="toc level3"><a href="extkj.html">DHCP Client Event Scripts</a></p>
<p class="toc level2 tocsp"><a href="dhcp-trouble-1.html">17.&nbsp;&nbsp;Troubleshooting DHCP (Reference)</a></p>
<p class="toc level2"><a href="dhcp-ref-4.html">18.&nbsp;&nbsp;DHCP Commands and Files (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipsectm-1.html">Part&nbsp;III&nbsp;IP Security</a></p>
<p class="toc level2"><a href="ipsec-ov-1.html">19.&nbsp;&nbsp;IP Security Architecture (Overview)</a></p>
<p class="toc level2"><a href="ipsec-mgtasks-1.html">20.&nbsp;&nbsp;Configuring IPsec (Tasks)</a></p>
<p class="toc level2"><a href="ipsecref-1.html">21.&nbsp;&nbsp;IP Security Architecture (Reference)</a></p>
<p class="toc level2"><a href="ike-1.html">22.&nbsp;&nbsp;Internet Key Exchange (Overview)</a></p>
<p class="toc level2"><a href="ike-task-1.html">23.&nbsp;&nbsp;Configuring IKE (Tasks)</a></p>
<p class="toc level2"><a href="ikeref-1.html">24.&nbsp;&nbsp;Internet Key Exchange (Reference)</a></p>
<p class="toc level2"><a href="eupsq.html">25.&nbsp;&nbsp;Solaris IP Filter (Overview)</a></p>
<p class="toc level2"><a href="ipfilter-admin-1.html">26.&nbsp;&nbsp;Solaris IP Filter (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="miptm-1.html">Part&nbsp;IV&nbsp;Mobile IP</a></p>
<p class="toc level2"><a href="mipoverview-1.html">27.&nbsp;&nbsp;Mobile IP (Overview)</a></p>
<p class="toc level2"><a href="mipimplementing-1.html">28.&nbsp;&nbsp;Administering Mobile IP (Tasks)</a></p>
<p class="toc level2"><a href="mipmanaging-22.html">29.&nbsp;&nbsp;Mobile IP Files and Commands (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipmptm-1.html">Part&nbsp;V&nbsp;IPMP</a></p>
<p class="toc level2"><a href="mpoverview.html">30.&nbsp;&nbsp;Introducing IPMP (Overview)</a></p>
<p class="toc level2"><a href="deploynetmult-56.html">31.&nbsp;&nbsp;Administering IPMP (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ipqostm-1.html">Part&nbsp;VI&nbsp;IP Quality of Service (IPQoS)</a></p>
<p class="toc level2"><a href="ipqos-intro-1.html">32.&nbsp;&nbsp;Introducing IPQoS (Overview)</a></p>
<p class="toc level2"><a href="ipqos-config-planning-1.html">33.&nbsp;&nbsp;Planning for an IPQoS-Enabled Network (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-policy-planning-1.html">34.&nbsp;&nbsp;Creating the IPQoS Configuration File (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-isp-setup-1.html">35.&nbsp;&nbsp;Starting and Maintaining IPQoS (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-accounting-1.html">36.&nbsp;&nbsp;Using Flow Accounting and Statistics Gathering (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-reference-1.html">37.&nbsp;&nbsp;IPQoS in Detail (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="dhcp-overview-5"></a><h3>DHCP Client Systems and Name Services</h3>
<p>Solaris systems support the following name services: DNS, NIS, NIS+, and a local
file store (<tt>/etc/inet/hosts</tt>). Each name service requires some configuration before it is usable.
The name service switch configuration file (see <a href="http://docs.sun.com/doc/819-2251/nsswitch.conf-4?a=view"><tt>nsswitch.conf</tt>(4)</a>) must also be set up
appropriately to indicate the name services to be used.</p><p>Before a DHCP client system can use a name service, you must
configure the system as a client of the name service.</p><p>The following table summarizes issues that are related to each name service and
DHCP. The table includes links to documentation that can help you set up
clients for each name service.</p><a name="dhcp-overview-tbl-3"></a><h6>Table&nbsp;16-1 Name Service Client Setup Information for DHCP Client Systems</h6><table><col width="23.57*"><col width="76.43*"><tr><th align="left" valign="top" scope="column"><p>Name Service </p></th>
<th align="left" valign="top" scope="column"><p>Client Setup Information</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>NIS</p></td>
<td align="left" valign="top" scope="row"><p>If you are using
Solaris DHCP to send Solaris network install information to a client system, you
can use a configuration macro that contains the <tt>NISservs</tt> and <tt>NISdmain</tt> options.
These options pass the IP addresses of NIS servers and the NIS domain
name to the client. The client then automatically becomes an NIS client.</p><p>If a
DHCP client system is already running the Solaris OS, the NIS client is
not automatically configured on that system when the DHCP server sends NIS information
to the client.</p><p>If the DHCP server is configured to send NIS information
to the DHCP client system, you can see the values given to the
client if you use the <tt>dhcpinfo</tt> command on the client as follows:</p><p>#
<tt>/sbin/dhcpinfo NISdmain</tt></p><p># <tt>/sbin/dhcpinfo NISservs</tt></p><p>Use the values returned for the NIS domain name and NIS
servers when you set up the system as an NIS client.</p><p>You set up
an NIS client for a Solaris DHCP client system in the standard way,
as documented in <a href="http://docs.sun.com/doc/819-3194/cnis1-25208?a=view">Chapter 5, Setting Up and Configuring NIS Service, in <i>System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</i></a>. </p>
<hr><p><b>Tip - </b>You can write a script that uses <tt>dhcpinfo</tt>
and <tt>ypinit</tt> to automate NIS client configuration on DHCP client systems.</p>
<hr>
</td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>NIS+</p></td>
<td align="left" valign="top" scope="row"><p>If the
DHCP client system receives a nonreserved IP address, the address might not always
be the same. You must set up the NIS+ client for a
DHCP client system in a nonstandard way, which is documented in <a href="#dhcp-admin-77">Setting Up DHCP Clients as NIS+ Clients</a>. This procedure
is necessary because NIS+ uses security measures to authenticate requests for service. The
security measures depend upon the IP address.</p><p>If the DHCP client system has
been manually assigned an IP address, the client's address is always the same.
You can set up the NIS+ client in the standard way, which is
documented in <a href="http://docs.sun.com/doc/819-3195/c2setup-14140?a=view">Setting Up NIS+ Client Machines in <i>System Administration Guide: Naming and Directory Services (NIS+)</i></a>.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>/etc/inet/hosts</tt></p></td>
<td align="left" valign="top" scope="row"><p>You must set up the <tt>/etc/inet/hosts</tt> file for a DHCP client
system that is to use <tt>/etc/inet/hosts</tt> for its name service.</p><p>The DHCP client system's
host name is added to its own <tt>/etc/inet/hosts</tt> file by the DHCP
tools. However, you must manually add the host name to the <tt>/etc/inet/hosts</tt> files
of other systems in the network. If the DHCP server system uses <tt>/etc/inet/hosts</tt>
for name resolution, you must also manually add the client's host name on
the system.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>DNS</p></td>
<td align="left" valign="top" scope="row"><p>If the DHCP client system receives the DNS domain name through DHCP, the
client system's <tt>/etc/resolv.conf</tt> file is configured automatically. The <tt>/etc/nsswitch.conf</tt> file is also automatically updated
to append <tt>dns</tt> to the <tt>hosts</tt> line after any other name services in
the search order. See <a href="http://docs.sun.com/doc/819-3194"><i>System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</i></a>for more information about DNS.</p></td>
</tr>
</table>

<a name="dhcp-admin-77"></a><h4>Setting Up DHCP Clients as NIS+ Clients</h4>
<p>You can use the NIS+ name service on Solaris systems that are
DHCP clients. However, to do so requires you to partially circumvent one of
the security-enhancing features of NIS+, the creation of Data Encryption Standard (DES) credentials. When
you set up an NIS+ client that is <b>not</b> using DHCP, you add
unique DES credentials for the client to the NIS+ server. There are several
ways to create credentials, such as using the <tt>nisclient</tt> script or the <tt>nisaddcred</tt>
command.</p><p>For DHCP clients, you <b>cannot</b> use these methods. NIS+ credential generation requires a
client to have a static host name to create and store the credentials.
If you want to use NIS+ and DHCP, you must create identical credentials
to be used for all the host names of DHCP clients. In this
way, no matter what IP address and associated host name that a
DHCP client receives, the client can use the same DES credentials.</p>
<hr><p><b>Caution - </b>Before performing the following procedure, be aware that NIS+ was designed for increased
security. This procedure weakens that security by allowing random DHCP clients to receive
NIS+ credentials.</p>
<hr>
<p>The following procedure shows you how to create identical credentials for all DHCP
host names. This procedure is valid only if you know the host names
that DHCP clients use. For example, when the DHCP server generates the host
names, you know the possible host names that a client can receive.</p>

<a name="dhcp-admin-22"></a><h5>How to Set Up Solaris DHCP Clients as NIS+ Clients</h5>
<p>A DHCP client system that is to be an NIS+ client must
use credentials that belong to another NIS+ client system in the NIS+ domain.
This procedure only produces credentials for the system, which apply only to the
superuser logged in to the system. Other users who log in to the
DHCP client system must have their own unique credentials in the NIS+ server.
These credentials are created according to a procedure in the <a href="http://docs.sun.com/doc/819-3195"><i>System Administration Guide: Naming and Directory Services (NIS+)</i></a>.</p><ol>
<li><a name="dhcp-admin-step-564"></a><b>Create the credentials for a client by typing the following command on the
NIS+ server:</b><pre># <tt><b>nisgrep </tt><i>nisplus-client-name</i><tt> cred.org_dir > /tmp/</tt><i>file</i><tt></b></tt></pre><p>This command writes the <tt>cred.org_dir</tt> table entry for the NIS+ client to a
temporary file.</p></li>
<li><a name="dhcp-admin-step-565"></a><b>Use the <tt>cat</tt> command to view the contents of the temporary file.</b><p>Or, use a text editor.</p></li>
<li><a name="dhcp-admin-step-565a"></a><b>Copy the credentials to use for DHCP clients.</b><p>You must copy the public key and private key, which are long strings
of numbers and letters separated by colons. The credentials are to be pasted
into the command issued in the next step.</p></li>
<li><a name="dhcp-admin-step-566"></a><b>Add credentials for a DHCP client by typing the following command:</b><pre># <tt><b>nistbladm -a cname="</b></tt> <i>dhcp-client-name</i>@<i>nisplus-domain</i><tt><b>" auth_type=DES \</b></tt>
<tt><b>auth_name="unix.</b></tt><i>dhcp-client-name</i>@<i>nisplus-domain</i><tt><b>" \</b></tt>
<tt><b>public_data=</b></tt><i>copied-public-key</i> <tt><b>\</b></tt> 
<tt><b>private_data=</b></tt><i>copied-private-key</i></pre><p>For the <i>copied-public-key</i>, paste the public key information that you copied from the
temporary file. For the <i>copied-private-key</i>, paste the private key information that you
copied from the temporary file.</p></li>
<li><a name="dhcp-admin-step-567"></a><b>Remote copy files from the NIS+ client system to the DHCP client system
by typing the following commands on the DHCP client system:</b><pre># <tt><b>rcp</b></tt> <i>nisplus-client-name</i><tt><b>:/var/nis/NIS_COLD_START /var/nis</b></tt>
# <tt><b>rcp</b></tt> <i>nisplus-client-name</i><tt><b>:/etc/.rootkey /etc</b></tt>
# <tt><b>rcp</b></tt> <i>nisplus-client-name</i><tt><b>:/etc/defaultdomain /etc</b></tt></pre><p>If you get a &ldquo;permission denied&rdquo; message, the systems might not be set
up to allow remote copying. In this case, you can copy the
files as a regular user to an intermediate location. As superuser, copy the
files from the intermediate location to the proper location on the DHCP client
system.</p></li>
<li><a name="dhcp-admin-step-568"></a><b>Copy the correct name service switch file for NIS+ by typing the following
command on the DHCP client system:</b><pre># <tt><b>cp /etc/nsswitch.nisplus /etc/nsswitch.conf</b></tt></pre></li>
<li><a name="dhcp-admin-step-569"></a><b>Reboot the DHCP client system.</b><p>The DHCP client system should now be able to use NIS+ services.</p></li></ol><a name="dhcp-admin-570"></a>Example&nbsp;16-1 Setting up a Solaris DHCP Client System as an NIS+ Client<p>The following example assumes that you have one system <tt>nisei</tt>, which is an
NIS+ client in the NIS+ domain <tt>dev.example.net</tt>. You also have one DHCP client
system, <tt>dhow</tt>, and you want <tt>dhow</tt> to be an NIS+ client.</p><pre>(First log in as superuser on the NIS+ server)
# <tt><b>nisgrep nisei cred.org_dir > /tmp/nisei-cred</b></tt>
# <tt><b>cat /tmp/nisei-cred</b></tt>
nisei.dev.example.net.:DES:unix.nisei@dev.example.net:46199279911a84045b8e0
c76822179138173a20edbd8eab4:90f2e2bb6ffe7e3547346dda624ec4c7f0fe1d5f37e21cff63830
c05bc1c724b
# <tt><b>nistbladm -a cname="dhow@dev.example.net." \</b></tt>
<tt><b>auth_type=DES auth_name="unix.dhow@dev.example.net" \</b></tt>
<tt><b>public_data=46199279911a84045b8e0c76822179138173a20edbd8eab4 \</b></tt>
<tt><b>private_data=90f2e2bb6ffe7e3547346dda624ec4c7f0fe1d5f37e21cff63830\</b></tt>
<tt><b>c05bc1c724b</b></tt>
# <tt><b>rlogin dhow</b></tt>
(Log in as superuser on dhow)
# <tt><b>rcp nisei:/var/nis/NIS_COLD_START /var/nis</b></tt>
# <tt><b>rcp nisei:/etc/.rootkey /etc</b></tt>
# <tt><b>rcp nisei:/etc/defaultdomain /etc</b></tt>
# <tt><b>cp /etc/nsswitch.nisplus /etc/nsswitch.conf</b></tt>
# <tt><b>reboot</b></tt></pre><p>The DHCP client system <tt>dhow</tt> should now be able to use NIS+ services.</p><a name="eojcc"></a>Example&nbsp;16-2 Adding Credentials With a Script<p>If you want to set up a large number of DHCP client
systems as NIS+ clients, you can write a script. A script can quickly
add the entries to the <tt>cred.org_dir</tt> NIS+ table. The following example shows
a sample script.</p><pre>#! /usr/bin/ksh  
# 
# Copyright (c) by Sun Microsystems, Inc. All rights reserved. 
# 
# Sample script for cloning a credential. Hosts file is already populated  
# with entries of the form dhcp-[0-9][0-9][0-9]. The entry we're cloning 
# is dhcp-001. 
#  
#  
PUBLIC_DATA=6e72878d8dc095a8b5aea951733d6ea91b4ec59e136bd3b3 
PRIVATE_DATA=3a86729b685e2b2320cd7e26d4f1519ee070a60620a93e48a8682c5031058df4
HOST="dhcp-" 
DOMAIN="mydomain.example.com"  
 
for 
i in 002 003 004 005 006 007 008 009 010 011 012 013 014 015 016 017 018 019
do         
     print - ${HOST}${i}         
     #nistbladm -r [cname="${HOST}${i}.${DOMAIN}."]cred.org_dir         
     nistbladm -a cname="${HOST}${i}.${DOMAIN}." \
         auth_type=DES auth_name="unix.${HOST}${i}@${DOMAIN}" \
         public_data=${PUBLIC_DATA} private_data=${PRIVATE_DTA} cred.org_Dir
done  
 
exit 0</pre>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="eyhuv.html">Previous</a>
             </td>
             <td align="right">
                 <a href="extkj.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

