<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Packet Forwarding and Routing on IPv4 Networks - System Administration Guide: IP Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: IP Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ipconfig-63.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ipconfig-111.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="iptm-1.html">Part&nbsp;I&nbsp;TCP/IP Administration</a></p>
<p class="toc level2"><a href="ipov-1.html">1.&nbsp;&nbsp;Solaris TCPIP Protocol Suite (Overview)</a></p>
<p class="toc level2"><a href="ipplan-1.html">2.&nbsp;&nbsp;Planning an IPv4 Addressing Scheme (Tasks</a></p>
<p class="toc level2"><a href="ipv6-overview-7.html">3.&nbsp;&nbsp;Planning an IPv6 Addressing Scheme (Overview)</a></p>
<p class="toc level2"><a href="ipv6-planning-1.html">4.&nbsp;&nbsp;Planning an IPv6 Network (Tasks)</a></p>
<p class="toc level2"><a href="ipconfig-1.html">5.&nbsp;&nbsp;Configuring TCP/IP Network Services and IPv4 Addressing (Tasks)</a></p>
<p class="toc level3"><a href="gcwwj.html">What's New in This Chapter</a></p>
<p class="toc level3"><a href="ipconfig-2a.html">Before You Configure an IPv4 Network (Task Map)</a></p>
<p class="toc level3"><a href="ipconfig-3.html">Determining Host Configuration Modes</a></p>
<p class="toc level3"><a href="ipconfig-2.html">Adding a Subnet to a Network (Task Map)</a></p>
<p class="toc level3"><a href="ipconfig-4.html">Network Configuration Task Map</a></p>
<p class="toc level3"><a href="ipconfig-63.html">Configuring Systems on the Local Network </a></p>
<p class="toc level4"><a href="ipconfig-63.html#ipconfig-64">How to Configure a Host for Local Files Mode</a></p>
<p class="toc level4"><a href="ipconfig-63.html#ipconfig-79">How to Set Up a Network Configuration Server</a></p>
<p class="toc level4"><a href="ipconfig-63.html#ipconfig-90">How to Configure Hosts for Network Client Mode</a></p>
<p class="toc level4"><a href="ipconfig-63.html#gbwxb">How to Change the IPv4 Address and Other Network Configuration Parameters</a></p>
<div class="onpage">
<p class="toc level3 tocsp"><a href="">Packet Forwarding and Routing on IPv4 Networks</a></p>
</div>
<p class="toc level3"><a href="ipconfig-111.html">Monitoring and Modifying Transport Layer Services</a></p>
<p class="toc level4"><a href="ipconfig-111.html#ipconfig-6">How to Log the IP Addresses of All Incoming TCP Connections</a></p>
<p class="toc level4"><a href="ipconfig-111.html#ermig">How to Add Services That Use the SCTP Protocol</a></p>
<p class="toc level4"><a href="ipconfig-111.html#ipconfig-86">How to Use TCP Wrappers to Control Access to TCP Services</a></p>
<p class="toc level2 tocsp"><a href="fwawf.html">6.&nbsp;&nbsp;Administering Network Interfaces (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-config-tasks-1.html">7.&nbsp;&nbsp;Enabling IPv6 on a Network (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-admintasks-1.html">8.&nbsp;&nbsp;Administering a TCP/IP Network (Tasks)</a></p>
<p class="toc level2"><a href="gegel.html">9.&nbsp;&nbsp;Troubleshooting Network Problems (Tasks)</a></p>
<p class="toc level2"><a href="ipref-8.html">10.&nbsp;&nbsp;TCP/IP and IPv4 in Depth (Reference)</a></p>
<p class="toc level2"><a href="ipv6-ref-76.html">11.&nbsp;&nbsp;IPv6 in Depth (Reference)</a></p>
<p class="toc level1 tocsp"><a href="dhcptm-1.html">Part&nbsp;II&nbsp;DHCP</a></p>
<p class="toc level2"><a href="dhcp-overview-1.html">12.&nbsp;&nbsp;About Solaris DHCP (Overview)</a></p>
<p class="toc level2"><a href="chap2-26.html">13.&nbsp;&nbsp;Planning for DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="chapter3-20.html">14.&nbsp;&nbsp;Configuring the DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="dhcp-admin-9.html">15.&nbsp;&nbsp;Administering DHCP (Tasks)</a></p>
<p class="toc level2"><a href="eyatl.html">16.&nbsp;&nbsp;Configuring and Administering  DHCP Clients</a></p>
<p class="toc level2"><a href="dhcp-trouble-1.html">17.&nbsp;&nbsp;Troubleshooting DHCP (Reference)</a></p>
<p class="toc level2"><a href="dhcp-ref-4.html">18.&nbsp;&nbsp;DHCP Commands and Files (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipsectm-1.html">Part&nbsp;III&nbsp;IP Security</a></p>
<p class="toc level2"><a href="ipsec-ov-1.html">19.&nbsp;&nbsp;IP Security Architecture (Overview)</a></p>
<p class="toc level2"><a href="ipsec-mgtasks-1.html">20.&nbsp;&nbsp;Configuring IPsec (Tasks)</a></p>
<p class="toc level2"><a href="ipsecref-1.html">21.&nbsp;&nbsp;IP Security Architecture (Reference)</a></p>
<p class="toc level2"><a href="ike-1.html">22.&nbsp;&nbsp;Internet Key Exchange (Overview)</a></p>
<p class="toc level2"><a href="ike-task-1.html">23.&nbsp;&nbsp;Configuring IKE (Tasks)</a></p>
<p class="toc level2"><a href="ikeref-1.html">24.&nbsp;&nbsp;Internet Key Exchange (Reference)</a></p>
<p class="toc level2"><a href="eupsq.html">25.&nbsp;&nbsp;Solaris IP Filter (Overview)</a></p>
<p class="toc level2"><a href="ipfilter-admin-1.html">26.&nbsp;&nbsp;Solaris IP Filter (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="miptm-1.html">Part&nbsp;IV&nbsp;Mobile IP</a></p>
<p class="toc level2"><a href="mipoverview-1.html">27.&nbsp;&nbsp;Mobile IP (Overview)</a></p>
<p class="toc level2"><a href="mipimplementing-1.html">28.&nbsp;&nbsp;Administering Mobile IP (Tasks)</a></p>
<p class="toc level2"><a href="mipmanaging-22.html">29.&nbsp;&nbsp;Mobile IP Files and Commands (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipmptm-1.html">Part&nbsp;V&nbsp;IPMP</a></p>
<p class="toc level2"><a href="mpoverview.html">30.&nbsp;&nbsp;Introducing IPMP (Overview)</a></p>
<p class="toc level2"><a href="deploynetmult-56.html">31.&nbsp;&nbsp;Administering IPMP (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ipqostm-1.html">Part&nbsp;VI&nbsp;IP Quality of Service (IPQoS)</a></p>
<p class="toc level2"><a href="ipqos-intro-1.html">32.&nbsp;&nbsp;Introducing IPQoS (Overview)</a></p>
<p class="toc level2"><a href="ipqos-config-planning-1.html">33.&nbsp;&nbsp;Planning for an IPQoS-Enabled Network (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-policy-planning-1.html">34.&nbsp;&nbsp;Creating the IPQoS Configuration File (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-isp-setup-1.html">35.&nbsp;&nbsp;Starting and Maintaining IPQoS (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-accounting-1.html">36.&nbsp;&nbsp;Using Flow Accounting and Statistics Gathering (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-reference-1.html">37.&nbsp;&nbsp;IPQoS in Detail (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="gcvjj"></a><h3>Packet Forwarding and Routing on IPv4 Networks</h3>
<p>This section contains procedures and examples that show how to configure forwarding and
routing for routers and hosts on IPv4 networks.</p><p><a name="indexterm-509"></a><b>Packet forwarding</b> is the basic method for sharing information across systems on a network.
Packets are transferred between a source interface and a destination interface, usually on
two different systems. When you issue a command or send a message to
a nonlocal interface, your system forwards those packets onto the local network. The
interface with the destination IP address that is specified in the packet headers
then retrieves the packets from the local network. If the destination address is
not on the local network, the packets are then forwarded to the next
adjacent network, or <b>hop</b>. By default, packet forwarding is automatically configured when you
install the Solaris OS.<a name="indexterm-510"></a><a name="indexterm-511"></a><a name="indexterm-512"></a></p><p><a name="indexterm-513"></a><a name="indexterm-514"></a><a name="indexterm-515"></a><b>Routing</b> is the process by which systems decide where to send a packet.
Routing protocols on a system &ldquo;discover&rdquo; the other systems on the local network.
When the source system and the destination system are on the same local
network, the path that packets travel between them is called a <b>direct route</b>. If
a packet must travel at least one hop beyond its source system, the
path between the source system and destination system is called an <b>indirect route</b>. The
routing protocols learn the path to a destination interface and retain data about
known routes in the system's <b>routing table</b>. <a name="indexterm-516"></a></p><p><a name="indexterm-517"></a><b>Routers</b> are specially configured systems with multiple physical interfaces that connect the router
to more than one local network. Therefore, the router can forward packets beyond
the home LAN, regardless of whether the router runs a routing protocol. For
more information about how routers forward packets, refer to <a href="ipplan-37.html">Planning for Routers on Your Network</a>. </p><p><a name="indexterm-518"></a><b>Routing protocols</b> handle routing activity on a system and, by exchanging routing information
with other hosts, maintain known routes to remote networks. Both routers and hosts can
run routing protocols. The routing protocols on the host communicate with routing daemons
on other routers and hosts. These protocols assist the host in determining where
to forward packets. When network interfaces  are enabled, the system automatically communicates with
the routing daemons. These daemons monitor routers on the network and advertise the
routers' addresses to the hosts on the local network. Some routing protocols, though
not all, also maintain statistics that you can use to measure routing performance.
 Unlike packet forwarding, you must explicitly configure routing on a Solaris system.
 </p><p>This section contains tasks for administering packet forwarding and routing on IPv4 routers
and hosts. For information about routing on an IPv6-enabled network, refer to <a href="ipv6-config-tasks-5.html">Configuring an IPv6 Router</a>.</p>

<a name="gcxjj"></a><h4>Routing Protocols Supported by the Solaris OS</h4>
<p><a name="indexterm-519"></a><a name="indexterm-520"></a><a name="indexterm-521"></a><a name="indexterm-522"></a><a name="indexterm-523"></a>Routing protocols are classified as interior gateway protocols (IGPs), exterior gateway protocols (EGPs),
or a combination of both. <b>Interior gateway protocols</b>  exchange routing information between routers on networks
under common administrative control. In the network topology shown in <a href="#gdcvl">Figure&nbsp;5-2</a>, the
routers run an IGP for exchanging routing information. <b>Exterior gateway protocols</b> enable the router that connects
the local internetwork to an external network to exchange information with another router
on the external network. For example, the router that connects a corporate network
to an ISP runs an EGP to exchange routing information with its router
counterpart at the ISP. Border Gateway Protocol (BGP) is a popular EGP that
is used for carrying  routing information between different organizations and IGPs.</p><p>The following table provides information about the Solaris routing protocols and the location
of each protocol's associated documentation. </p><a name="gcxiw"></a><h6>Table&nbsp;5-1 Solaris Routing Protocols</h6><a name="indexterm-524"></a><table><col width="18.11*"><col width="15.23*"><col width="33.24*"><col width="33.44*"><tr><th align="left" valign="top" scope="column"><p>Protocol</p></th>
<th align="left" valign="top" scope="column"><p>Associated Daemon</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>For Instructions</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Routing Information Protocol (RIP)</p></td>
<td align="left" valign="top" scope="row"><p><tt>in.routed</tt></p></td>
<td align="left" valign="top" scope="row"><p>IGP that
routes IPv4 packets and maintains a routing table</p></td>
<td align="left" valign="top" scope="row"><p><a href="#ipconfig-118">How to Configure an IPv4 Router</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Internet Control Message Protocol (ICMP)
Router Discovery</p></td>
<td align="left" valign="top" scope="row"><p><tt>in.routed</tt></p></td>
<td align="left" valign="top" scope="row"><p>Used by hosts to discover the presence of a router on
the network</p></td>
<td align="left" valign="top" scope="row"><p><a href="#ipconfig-125">How to Enable Static Routing on a Single-Interface Host</a> and <a href="#ipconfig-15">How to Enable Dynamic Routing on a Single-Interface Host</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Routing Information Protocol, next generation (RIPng) Protocol</p></td>
<td align="left" valign="top" scope="row"><p><tt>in.ripngd</tt></p></td>
<td align="left" valign="top" scope="row"><p>IGP that routes
IPv6 packets and maintains a routing table</p></td>
<td align="left" valign="top" scope="row"><p><a href="ipv6-config-tasks-5.html#ipv6-config-tasks-21">How to Configure an IPv6-Enabled Router</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Neighbor Discovery (ND) Protocol</p></td>
<td align="left" valign="top" scope="row"><p><tt>in.ndpd</tt></p></td>
<td align="left" valign="top" scope="row"><p>Advertises the presence
of an IPv6 router and discovers the presence of IPv6 hosts on a
network</p></td>
<td align="left" valign="top" scope="row"><p><a href="ipv6-config-tasks-64.html">Configuring an IPv6 Interface</a></p></td>
</tr>
</table>

<a name="gcxjg"></a><h4>IPv4 Autonomous System Topology</h4>
<p><a name="indexterm-525"></a>Sites with multiple routers and networks typically administer their network topology as a
single routing domain, or  <b>autonomous system (AS)</b> . The following figure shows a
typical network topology that would be considered a small AS. This topology is referenced
in the examples throughout this section.</p><a name="gdcvl"></a><h6>Figure&nbsp;5-2 Autonomous System With Multiple IPv4 Routers</h6><a name="indexterm-526"></a><img src="figures/nwt_multpl_routers.gif" alt="This topology diagram of an autonomous system is explained in the following context."></img><p>The figure shows an AS that is divided into three local networks,
<tt>10.0.5.0</tt>, <tt>172.20.1.0</tt>, and <tt>192.168.5</tt>. Four routers share packet-forwarding and routing responsibilities. The AS
 includes the following types of systems:</p>
<ul><li><p><a name="indexterm-527"></a><a name="indexterm-528"></a><a name="indexterm-529"></a><a name="indexterm-530"></a><b>Border routers</b> connect an AS to an external network, such as the Internet. Border routers interconnect with networks external to the IGP running on the local AS. A border router can run an EGP, such as Border Gateway Protocol (BGP), to exchange information with external routers, for example, the routers at the ISP. In <a href="#gdcvl">Figure&nbsp;5-2</a>, the border router's interfaces connect to internal network <tt>10.0.5.0</tt> and to a high-speed router to a service provider.</p><p>For information on configuring a border router, refer to the <a href="http://quagga.net/docs/docs-info.php#SEC72">Open Source Quagga documentation</a> for BGP.</p><p><a name="indexterm-531"></a> If you plan to use BGP to connect your AS to the Internet, you should obtain an autonomous system number (ASN) from the Internet Registry for your locale. Regional registries, such as the American Registry for Internet Numbers (ARIN), offer guidelines on how to obtain an ASN. For example, the<a href="http://www.arin.net/policy/nrpm.html#five"> ARIN Number Resource Policy Manual</a> contains instructions for getting an ASN for autonomous systems in the United States and Canada. Alternatively, your ISP might be able to obtain an ASN for you.</p></li>
<li><p><a name="indexterm-532"></a><a name="indexterm-533"></a><b>Default routers</b> maintain routing information about all the systems on the local network. These routers typically run IGPs such as RIP. In <a href="#gdcvl">Figure&nbsp;5-2</a>, Router 1s interfaces are connected to internal network <tt>10.0.5.0</tt> and internal network <tt>192.168.5</tt>. Router 1 also serves as the default router for <tt>192.168.5</tt>. Router 1 maintains routing information for all systems on <tt>192.168.5</tt> and routes to other routers, such as the border router. Router 2s interfaces connect to internal network <tt>10.0.5.0</tt> and internal network <tt>172.20.1</tt>. </p><p>For an example of configuring a default router, refer to <a href="#gcvjm">Example&nbsp;5-4</a>.</p></li>
<li><p><a name="indexterm-534"></a><a name="indexterm-535"></a><b>Packet-forwarding routers</b> forward packets but do not run routing protocols. This type of router receives packets from one of its interfaces that is connected to a single network. These packets are then forwarded through another interface on the router to another local network. In <a href="#gdcvl">Figure&nbsp;5-2</a>, Router 3 is a packet-forwarding router with connections to networks <tt>172.20.1</tt> and <tt>192.168.5</tt>. </p></li>
<li><p><a name="indexterm-536"></a><a name="indexterm-537"></a><b>Multihomed hosts</b> have two or more interfaces that are connected to the same network segment. A multihomed host can forward packets, which is the default for all systems that run the Solaris OS. <a href="#gdcvl">Figure&nbsp;5-2</a> shows a multihomed host with both interfaces connected to network <tt>192.168.5</tt>. For an example of configuring a multihomed host, refer to <a href="#geegh">Example&nbsp;5-6</a>.</p></li>
<li><p><a name="indexterm-538"></a><b>Single interface hosts</b> rely on the local routers, not only for packet forwarding but also for receiving valuable configuration information. <a href="#gdcvl">Figure&nbsp;5-2</a> includes Host A on the <tt>192.168.5</tt> network, which implements dynamic routing, and Host B on the <tt>172.20.1</tt> network, which implements static routing. To configure a host to run dynamic routing, refer to <a href="#ipconfig-15">How to Enable Dynamic Routing on a Single-Interface Host</a>. To configure a host to run static routing, refer to <a href="#ipconfig-125">How to Enable Static Routing on a Single-Interface Host</a>.</p></li></ul>


<a name="ipconfig-116"></a><h4>Configuring an IPv4 Router</h4>
<p><a name="indexterm-539"></a><a name="indexterm-540"></a><a name="indexterm-541"></a><a name="indexterm-542"></a>This section contains a procedure and example for configuring an IPv4 router. To
configure an IPv6-enabled router, refer to <a href="ipv6-config-tasks-5.html#ipv6-config-tasks-21">How to Configure an IPv6-Enabled Router</a>.</p><p>Because a router provides the interface between two or more networks, you must
assign a unique name and IP address to each of the router's
physical network interfaces. Thus, each router has a host name and an IP
address that are associated with its primary network interface, in addition to a
minimum of one more unique name and IP address for each additional network
interface. </p><p>You can also use the following procedure to configure a system with
only one physical interface (by default, a host) to be a router. You
might configure a single interface system as a router if the system serves
as one endpoint on a PPP link, as explained in <a href="http://docs.sun.com/doc/819-1634/pppsvrconfig.p2plink-4?a=view">Planning a Dial-up PPP Link in <i>System Administration Guide: Network Services</i></a>. </p>
<hr><p><b>Note - </b>You can configure all interfaces of a router during Solaris system installation. For
instructions, see <a href="http://docs.sun.com/doc/819-2393"><i>Solaris Express Installation Guide: Basic Installations</i></a>.</p>
<hr>


<a name="ipconfig-118"></a><h5>How to Configure an IPv4 Router</h5>
<p>The following instructions assume that you are configuring interfaces for the router after
installation.</p><h6>Before You Begin</h6><p><a name="indexterm-543"></a><a name="indexterm-544"></a><a name="indexterm-545"></a><a name="indexterm-546"></a>After the router is physically installed on the network, configure the router to
operate in local files mode, as described in <a href="ipconfig-63.html#ipconfig-64">How to Configure a Host for Local Files Mode</a>. This configuration ensures that
routers boot if the network configuration server is down.  </p><ol>
<li><b>On the system to be configured as a router, assume the Primary Administrator
role or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b>Use the <tt>dladm show-link</tt> command to determine which interfaces are physically installed on the
router.</b><pre># <tt><b>dladm show-link</b></tt></pre><p>The following example output from <tt>dladm show-link</tt> indicates that a <tt>qfe</tt> NIC with four
interfaces and two <tt>bge</tt> interfaces are physically available on the system.</p><pre>qfe0             type: legacy    mtu: 1500       device: qfe0
qfe1             type: legacy    mtu: 1500       device: qfe1
qfe2             type: legacy    mtu: 1500       device: qfe0
qfe3             type: legacy    mtu: 1500       device: qfe1
bge0             type: non-vlan  mtu: 1500       device: bge0
bge1             type: non-vlan  mtu: 1500       device: bge1</pre></li>
<li><a name="eypqa"></a><b>Review which interfaces on the router were configured and plumbed during installation.</b><pre># <tt><b>ifconfig -a</b></tt></pre><p>The following example output from <tt>ifconfig -a</tt> shows that the interface <tt>qfe0</tt> was configured
during installation. This interface is on the <tt>172.16.0.0</tt> network. The remaining interfaces on the
<tt>qfe</tt> NIC, <tt>qfe1</tt> - <tt>qfe3</tt>, and the <tt>bge</tt> interfaces have not been
configured.</p><pre>lo0: flags=1000849 &lt;UP,LOOPBACK,RUNNING,MULTICAST,IPv4> mtu 8232 index 1
        inet 127.0.0.1 netmask ff000000 
qfe0: flags=1000843 &lt;UP,BROADCAST,RUNNING,MULTICAST,IPv4> mtu 1500 index 2
        inet 172.16.26.232 netmask ffff0000 broadcast 172.16.26.255
        ether 0:3:ba:11:b1:15 
         </pre></li>
<li><b>Configure and plumb another interface.<a name="indexterm-547"></a><a name="indexterm-548"></a></b><pre># <tt><b>ifconfig</b></tt> <i>interface</i> <tt><b>plumb up</b></tt></pre><p>For example, for <tt>qfe1</tt>, you would type:</p><pre># <tt><b>ifconfig qfe1 plumb up</b></tt></pre>
<hr><p><b>Note - </b>Interfaces that are explicitly configured with the <tt>ifconfig</tt> command do not persist across
reboots.</p>
<hr>
</li>
<li><b>Assign an IPv4 address and a netmask to the interface.</b>
<hr><p><b>Caution - </b>You can configure an IPv4 routers to receive its IP address through DHCP,
but this is recommended only for very experienced DHCP system administrators.</p>
<hr>
<pre># <tt><b>ifconfig</b></tt> <i>interface IPv4-address</i> <tt><b>netmask+</b></tt><i>netmask</i></pre><p>For example, to assign the IP address <tt>192.168.84.3</tt> to <tt>qfe1</tt>, do either
of the following:</p>
<ul><li><p>Using traditional IPv4 notation, type the following:</p><pre># <tt><b>ifconfig qfe1 192.168.84.3 netmask + 255.255.255.0</b></tt></pre></li>
<li><p>Using CIDR notation, type the following:</p><pre># <tt><b>ifconfig qfe1 192.168.84.3/24</b></tt></pre><p>The prefix <tt>/24</tt> automatically assigns the <tt>255.255.255.0</tt> netmask to <tt>qfe1</tt>. For a table of CIDR prefixes and their dotted-decimal netmask equivalents, refer to <a href="ipplan-5.html#eypku">Figure&nbsp;2-2</a>.</p></li></ul>
</li>
<li><a name="ipconfig-step-120"></a><b><a name="indexterm-549"></a><a name="indexterm-550"></a>(Optional) To ensure that the interface configuration persists across reboots, create an <tt>/etc/hostname.</tt><i>interface</i>
file for each additional physical interface .</b><p>For example, you would create the <tt>/etc/hostname.qfe1</tt> and <tt>/etc/hostname.qfe2</tt> files. Then you would
type the host name <tt>timbuktu</tt> in <tt>/etc/hostname.qfe1</tt> file and host name <tt>timbuktu-201</tt>
in <tt>/etc/hostname.qfe1</tt> . For more information about configuring single interfaces, refer to <a href="fpcso.html#fpdcn">How to Configure a Physical Interface After System Installation</a>.</p><p>Be sure to do a configuration reboot after creating this file:</p><pre># <tt><b>reboot -- -r</b></tt></pre></li>
<li><a name="ipconfig-step-122"></a><b><a name="indexterm-551"></a>Add the host name and IP address of each interface to the
<tt>/etc/inet/hosts</tt> file. </b><p>For example:</p><pre>172.16.26.232      deadsea        #interface for network 172.16.0.0
192.168.200.20     timbuktu       #interface for network 192.168.200
192.168.201.20     timbuktu-201   #interface for network 192.168.201
192.168.200.9      gobi
192.168.200.10     mojave
192.168.200.110    saltlake
192.168.200.12     chilean</pre><p>The interfaces <tt>timbuktu</tt> and <tt>timbuktu-201</tt> are on the same system. Notice that the
network address for <tt>timbuktu-201</tt> is different from the network interface for <tt>timbuktu</tt>. The
difference exists because the physical network media for network <tt>192.168.201</tt> is connected to the
<tt>timbuktu-201</tt> network interface while the media for network <tt>192.168.200</tt> is connected to the
<tt>timbuktu</tt> interface.</p></li>
<li><a name="ipconfig-step-123"></a><b><a name="indexterm-552"></a><a name="indexterm-553"></a><a name="indexterm-554"></a><a name="indexterm-555"></a><a name="indexterm-556"></a><a name="indexterm-557"></a>If the router is connected to any subnetted network, add the network number
and the netmask to the <tt>/etc/inet/netmasks</tt> file.<a name="indexterm-558"></a><a name="indexterm-559"></a><a name="indexterm-560"></a></b>
<ul><li><p>For traditional IPv4 address notation, such as <tt>192.168.83.0</tt>, you would type:</p><pre>192.168.83.0    255.255.255.0</pre></li>
<li><p>For CIDR addresses, use the dotted-decimal version of the prefix in the entry in the <tt>/etc/inet/netmask</tt> file. Network prefixes and their dotted-decimal equivalents can be found in <a href="ipplan-5.html#eypku">Figure&nbsp;2-2</a>. For example, you would use the following entry in <tt>/etc/netmasks</tt> to express the CIDR network prefix <tt>192.168.3.0/22</tt>:</p><pre>192.168.3.0 255.255.252.0</pre></li></ul>
</li>
<li><b>Enable IPv4 packet forwarding on the router.</b><p>Use either of the following commands to enable packet forwarding:</p>
<ul><li><p>Use the <tt>routeadm</tt> command, as follows:</p><pre># <tt><b>routeadm -e ipv4-forwarding -u</b></tt></pre></li>
<li><p>Use the following service management facility (SMF) command:</p><pre># <tt><b>svcadm enable ipv4-forwarding</b></tt></pre></li></ul>
<p>At this point, the router can forward packets beyond the local network. The
router also supports <b>static routing</b>, a process where you can manually add routes to
the routing table. If you plan to use static routing on this system,
then router configuration is complete. However, you need to maintain routes in the
system routing table. For information on adding routes, see <a href="#gdwbq">Configuring Routes</a> and the <a href="http://docs.sun.com/doc/819-2240/route-1m?a=view"><tt>route</tt>(1M)</a>
man page.</p></li>
<li><b>(Optional) Start arouting protocol.</b><p>The routing daemon <tt>/usr/sbin/in.routed</tt> automatically updates the routing table, a process that
is known as <b>dynamic routing</b>. Turn on the default IPv4 routing protocols in either
of the following ways:<a name="indexterm-561"></a></p>
<ul><li><p>Use the <tt>routeadm</tt> command, as follows:</p><pre># <tt><b>routeadm -e ipv4-routing -u</b></tt></pre></li>
<li><p>Use the following SMF command to start a routing protocol such as RIP.</p><pre>#<tt><b> svcadm enable route:default</b></tt> </pre><p>The SMF FMRI associated with the <tt>in.routed</tt> daemon is <tt>svc:/network/routing/route.</tt></p></li></ul>
<p>For  information about the <tt>routeadm</tt> command, see the <a href="http://docs.sun.com/doc/819-2240/routeadm-1m?a=view"><tt>routeadm</tt>(1M)</a> man page. </p></li></ol><a name="gcvjm"></a>Example&nbsp;5-4 Configuring the Default Router for a Network<p><a name="indexterm-562"></a><a name="indexterm-563"></a>This example shows how to upgrade a system with more than one interface to become
a default router.   The goal is to make Router 2,
which is shown in <a href="#gdcvl">Figure&nbsp;5-2</a>,  the default router for network <tt>172.20.1.0</tt>. Router
2 contains two wired network connections, one connection to network <tt>172.20.1.0</tt> and one
to network <tt>10.0.5.0</tt>. The example assumes that the router operates in local
files mode, as described in <a href="ipconfig-63.html#ipconfig-64">How to Configure a Host for Local Files Mode</a>. </p><p>After becoming superuser or assuming an equivalent role, you would determine out the
status of the system's interfaces.</p><pre># <tt><b>dladm show-link</b></tt>
ce0              type: legacy    mtu: 1500       device: ce0
bge0             type: non-vlan  mtu: 1500       device: bge0
bge1             type: non-vlan  mtu: 1500       device: bge1

# <tt><b>ifconfig -a</b></tt>
lo0: flags=1000849 &lt;UP,LOOPBACK,RUNNING,MULTICAST,IPv4> mtu 8232 index 1
        inet 127.0.0.1 netmask ff000000 
ce0: flags=1000843 &lt;UP,BROADCAST,RUNNING,MULTICAST,IPv4> mtu 1500 index 2
        inet 172.20.1.10 netmask ffff0000 broadcast 172.20.10.100
        ether 8:0:20:c1:1b:c6 </pre><p>The output of <tt>dladm show-link</tt> indicates that three links are available on the system.
Only the <tt>ce0</tt> interface has been plumbed. You would begin default router configuration by
physically connecting the <tt>bge0</tt> interface to the <tt>10.0.5.0</tt> network. Then, you would plumb
the interface and make it persist across reboots.</p><pre># <tt><b>ifconfig bge0 plumb up</b></tt>
# <tt><b>ifconfig bge0 10.0.5.10</b></tt>
# <tt><b>ifconfig -a</b></tt>
lo0: flags=1000849 &lt;UP,LOOPBACK,RUNNING,MULTICAST,IPv4> mtu 8232 index 1
        inet 127.0.0.1 netmask ff000000 
ce0: flags=1000843 &lt;UP,BROADCAST,RUNNING,MULTICAST,IPv4> mtu 1500 index 2
        inet 172.20.1.10 netmask ffff0000 broadcast 172.255.255.255
        ether 8:0:20:c1:1b:c6 
bge0: flags=1000843 &lt;UP,BROADCAST,RUNNING,MULTICAST,IPv4> mtu 1500 index 2
        inet 10.0.5.10 netmask ff000000 broadcast 10.255.255.255
        ether 8:0:20:e5:95:c4
 # <tt><b>vi /etc/hostname.bge0</b></tt>
<tt><b>10.0.5.10 255.0.0.0</b></tt></pre><p>Reboot the system, using the reconfiguration boot command:</p><pre># <tt><b>reboot -- -r</b></tt></pre><p>Continue by configuring the following network databases with information about the newly plumbed interface
and the network to which it is connected:</p><pre># <tt><b>vi /etc/inet/hosts</b></tt>
127.0.0.1       localhost
172.20.1.10        router2        #interface for network 172.20.1
<tt><b>10.0.5.10 router2-out #interface for network 10.0.5</b></tt>
# <tt><b>vi /etc/inet/netmasks</b></tt>
172.20.1.0    255.255.0.0
<tt><b>10.0.5.0 255.0.0.0</b></tt></pre><p>Finally, use SMF to enable packet forwarding and then enable the <tt>in.routed</tt> routing daemon.</p><pre># <tt><b>svcadm enable ipv4-forwarding</b></tt>
#<tt><b> svcadm enable route:default</b></tt></pre><p>Now IPv4 packet forwarding and dynamic routing through RIP  are enabled
on Router 2. However, the default router configuration for network <tt>172.20.1.0</tt> is not yet complete.
You would need to do the following:</p>
<ul><li><p>Modify each host on <tt>172.10.1.10</tt> so that the host gets its routing information from the new default router. For more information, refer to <a href="#ipconfig-125">How to Enable Static Routing on a Single-Interface Host</a>.</p></li>
<li><p>Define a static route to the border router in the routing table of Router 2. For more details, refer to <a href="#gdyen"> Routing Tables and Routing Types</a>.</p></li></ul>


<a name="gdyen"></a><h4> Routing Tables and Routing Types</h4>
<p><a name="indexterm-564"></a><a name="indexterm-565"></a><a name="indexterm-566"></a>Both routers and hosts maintain a <b>routing table</b>. The routing daemon on each system
updates the table with all known routes. The system's kernel reads the routing
table before forwarding packets to the local network. The routing table lists the
IP addresses of networks that the system knows about, including the system's local,
default network. The table also lists the IP address of a gateway system
for each known network. The <b>gateway</b> is a system that can receive
outgoing packets and forward them one hop beyond the local network. The following
is a simple routing table for a system on an IPv4-only network:<a name="indexterm-567"></a><a name="indexterm-568"></a></p><pre>Routing Table: IPv4
  Destination           Gateway           Flags  Ref   Use   Interface
-------------------- -------------------- ----- ----- ------ ---------
default              172.20.1.10          UG       1    532   ce0
224.0.0.0            10.0.5.100           U        1      0   bge0
10.0.0.0             10.0.5.100           U        1      0   bge0
127.0.0.1            127.0.0.1            UH       1     57   lo0</pre><p><a name="indexterm-569"></a><a name="indexterm-570"></a>You can configure two types of routing on a Solaris system: static and
dynamic. You can configure either or both routing types on a single system.
A system that implements <b>dynamic routing</b> relies on routing protocols, such as RIP
for IPv4 networks, and RIPng for IPv6 networks, to maintain its routing tables.
A system that runs only <b>static routing </b> does not rely on a routing protocol
for routing information and for updating the routing table. Instead, you must maintain
the system's known routes manually through the <tt>route</tt> command. For complete details, refer to
the <a href="http://docs.sun.com/doc/819-2240/route-1m?a=view"><tt>route</tt>(1M)</a> man page.</p><p>When you configure routing for the local network or autonomous system, 
consider which type of routing to support on particular routers and hosts.</p><table><col width="23.00*"><col width="77.00*"><tr><th align="left" valign="top" scope="column"><p>Routing Type</p></th>
<th align="left" valign="top" scope="column"><p>Best
Used on</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Static</p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-571"></a>Small networks, hosts that get their routes from a default router, and
default routers that only need to know about one or two routers on
the next few hops. </p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Dynamic</p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-572"></a>Larger internetworks, routers on local networks with many
hosts, and hosts on large autonomous systems. Dynamic routing is the best choice for
systems on most networks.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Combined static and dynamic</p></td>
<td align="left" valign="top" scope="row"><p>Routers that connect a staticallyrouted network
and a dynamically routed network, and border routers that connect an interior autonomous system
with external networks. Combining both static and dynamic routing on a system is
a common practice.</p></td>
</tr>
</table><p>The AS that is shown is <a href="#gdcvl">Figure&nbsp;5-2</a> combines both static and dynamic routing.</p>

<a name="gdwbq"></a><h5>Configuring Routes</h5>
<p> To implement dynamic routing for an IPv4 network, use the <tt>routeadm</tt> or
<tt>svcadm</tt> command to start the <tt>in.routed</tt> routing daemon. For instructions, see <a href="#ipconfig-118">How to Configure an IPv4 Router</a>. Dynamic routing is
the preferred strategy for most networks and autonomous systems. However, your network topology
or a particular system on your network might require static routing. In that
case, you must manually edit the system routing table to reflect the known
route to the gateway. The next procedure shows how to add a
static route.</p>
<hr><p><b>Note - </b>Two routes to the same destination does not automatically cause the system to
do load balancing or failover. If you need these capabilities, use IPMP, as
explained in <a href="mpoverview.html">Chapter&nbsp;30, Introducing IPMP (Overview)</a>.</p>
<hr>


<a name="gecqy"></a><h5>How to Add a Static Route to the Routing Table</h5>
<a name="indexterm-573"></a><ol>
<li><b><a name="indexterm-574"></a><a name="indexterm-575"></a>View the current state of the routing table.</b><p>Use your regular user account to run the following form of the <tt>netstat</tt>
command:</p><pre>% <tt><b>netstat -rn</b></tt></pre><p>Your output would resemble the following:</p><pre>Routing Table: IPv4
  Destination           Gateway           Flags  Ref   Use   Interface
-------------------- -------------------- ----- ----- ------ ---------
192.168.5.125        192.168.5.10          U      1   5879   ipge0
224.0.0.0            198.168.5.10          U      1  0       ipge0
default              192.168.5.10          UG     1  91908
127.0.0.1            127.0.0.1             UH     1  811302   lo0</pre></li>
<li><b>Assume the Primary Administrator role or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role and
assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b>(Optional) Flush the existing entries in the routing table.</b><pre># <tt><b>route flush</b></tt></pre></li>
<li><b>Add a route that persists across system reboots.</b><pre># <tt><b>route -p add -net </tt><i>network-address</i><tt> -gateway </tt><i>gateway-address</i><tt></b></tt></pre><dl><dt><tt>-p</tt></dt>
<dd><p>Creates a route that must persist across system reboots. If you want the route to prevail only for the current session, do not use the <tt>-p</tt> option.</p></dd>
<dt><tt>add</tt></dt>
<dd><p>Indicates that you are about to add the following route.</p></dd>
<dt><tt>-net</tt><i>network-address</i></dt>
<dd><p>Specifies that the route goes to the network with the address in <i>network-address</i>.</p></dd>
<dt><tt>-gateway</tt><i>gateway-address</i></dt>
<dd><p>Indicates that the gateway system for the specified route has the IP address <i>gateway-address</i>.</p></dd>
</dl>
</li></ol><a name="gedsl"></a>Example&nbsp;5-5 Adding a Static Route to the Routing Table<a name="indexterm-576"></a><p>The following example shows how to add a static route to a
system. The system is Router 2, the default router for the <tt>172.20.1.0</tt> network that
is shown in <a href="#gdcvl">Figure&nbsp;5-2</a>. In <a href="#gcvjm">Example&nbsp;5-4</a>, Router 2 is configured for dynamic routing.
To better serve as the default router for the hosts on network
<tt>172.20.1.0</tt>, Router 2 additionally needs a static route to the AS's border router,
<tt>10.0.5.150</tt>. </p><p>To view the routing table on Router 2, you would do the
following:</p><pre># <tt><b>netstat -rn</b></tt>
Routing Table: IPv4
  Destination           Gateway           Flags  Ref   Use   Interface
-------------------- -------------------- ----- ----- ------ ---------
default              172.20.1.10          UG        1    249 ce0
224.0.0.0            172.20.1.10          U         1      0 ce0
10.0.5.0             10.0.5.20            U         1     78 bge0
127.0.0.1            127.0.0.1            UH        1     57 lo0</pre><p>The routing table indicates two routes that Router 2 knows about. The default
route uses Router 2's <tt>172.20.1.10</tt> interface as its gateway. The second route, <tt>10.0.5.0</tt>,
was discovered by the <tt>in.routed</tt> daemon running on Router 2. The gateway for this
route is Router 1, with the IP address <tt>10.0.5.20</tt>. </p><p>To add a second route to network <tt>10.0.5.0</tt>, which has its gateway as
the border router, you would do the following:</p><pre># <tt><b>route -p add -net 10.0.5.0/24 -gateway 10.0.5.150/24</b></tt>
add net 10.0.5.0: gateway 10.0.5.150</pre><p>Now the routing table has a route for the border router, which
has the IP address <tt>10.0.5.150/24</tt>.</p><pre># <tt><b>netstat -rn</b></tt>
Routing Table: IPv4
  Destination           Gateway           Flags  Ref   Use   Interface
-------------------- -------------------- ----- ----- ------ ---------
default              172.20.1.10          UG        1    249 ce0
224.0.0.0            172.20.1.10          U         1      0 ce0
10.0.5.0             10.0.5.20            U         1     78 bge0
10.0.5.0             10.0.5.150           U         1    375 bge0
127.0.0.1            127.0.0.1            UH        1     57 lo0</pre>

<a name="ipconfig-22a"></a><h4>Configuring Multihomed Hosts</h4>
<p><a name="indexterm-577"></a><a name="indexterm-578"></a><a name="indexterm-579"></a><a name="indexterm-580"></a>In the Solaris OS, a system with more than one interface is
considered a <b>multihomed host</b>. A multihomed host does not forward IP packets. However, you can configure
a multihomed host to run routing protocols. You typically configure the following types
of systems as multihomed hosts: </p>
<ul><li><p>NFS servers, particularly those servers that function as large data centers, can be attached to more than one network in order to share files among a large pool of users. These servers do not need to maintain routing tables.</p></li>
<li><p>Database servers can have multiple network interfaces to provide resources to a large pool of users, just like NFS servers.</p></li>
<li><p>Firewall gateways are systems that provide the connection between a company's network and public networks such as the Internet. Administrators set up firewalls as a security measure. When configured as a firewall, the host does not pass packets between the networks that are attached to the host's interfaces. However, the host can still provide standard TCP/IP services, such as <tt>ssh</tt> to authorized users.</p>
<hr><p><b>Note - </b><a name="indexterm-581"></a>When multihomed hosts have different types of firewalls on any of their interfaces, take care to avoid unintentional disruption of the host's packets. This problem arises particularly with stateful firewalls. One solution might be to configure stateless firewalling. For more information about firewalls, refer to <a href="http://docs.sun.com/doc/819-3321/concept-25?a=view">Firewall Systems in <i>System Administration Guide: Security Services</i></a> or the documentation for your third-party firewall. </p>
<hr>
</li></ul>


<a name="ipconfig-130"></a><h5>How to Create a Multihomed Host</h5>
<a name="indexterm-582"></a><ol>
<li><b> On the prospective multihomed host, assume the Primary Administrator role, or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role and
assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="ipconfig-step-132"></a><b> Configure and plumb each additional network interface that was not configured as
part of the Solaris OS installation. </b><p>Refer to <a href="fpcso.html#fpdcn">How to Configure a Physical Interface After System Installation</a>.</p></li>
<li><b>Verify that IP forwarding is not enabled on the multihomed host.<a name="indexterm-583"></a></b><pre># <tt><b>routeadm</b></tt>
 </pre><p>The <tt>routeadm</tt> command without options reports the state of the routing daemons. The
following  output from <tt>routeadm</tt> shows that IPv4 forwarding is enabled:</p><pre>   Configuration   Current              Current
                     Option   Configuration        System State
---------------------------------------------------------------
               IPv4 routing   disabled             disabled
               IPv6 routing   disabled             disabled
            IPv4 forwarding   enabled              disabled
            IPv6 forwarding   disabled             disabled
            Routing services   "route:default ripng:default"</pre></li>
<li><b>Turn off packet forwarding, if it is enabled on the system.</b><p>Use either of the following commands:</p>
<ul><li><p>For the <tt>routeadm</tt> command, type the following:</p><pre># <tt><b>routeadm -d ipv4-forwarding -u</b></tt></pre></li>
<li><p>To use SMF, type the following:</p><pre># <tt><b>svcadm disable ipv4-forwarding</b></tt></pre></li></ul>
</li>
<li><b>(Optional) Turn on dynamic routing for the multihomed host.</b><p>Use either of the following commands to enable the <tt>in.routed</tt> daemon:</p>
<ul><li><p>For the <tt>routeadm</tt> command, type the following:</p><pre># <tt><b>routeadm -e ipv4-routing -u</b></tt></pre></li>
<li><p>To use SMF, type the following:</p><pre>#<tt><b>svcadm enable route:default</b></tt> </pre></li></ul>
</li></ol><a name="geegh"></a>Example&nbsp;5-6 Configuring a Multihomed Host<p><a name="indexterm-584"></a>The  following example shows how to configure the multihomed host that is
shown in <a href="#gdcvl">Figure&nbsp;5-2</a>. In the example, the system has the host name
<tt>hostc</tt>. This host has two interfaces, which are both connected to network
<tt>192.168.5.0</tt> .</p><p>To begin, you would display the status of the system's interfaces.</p><pre># <tt><b>dladm show-link</b></tt>
hme0            type: legacy    mtu: 1500       device: hme0
qfe0            type: legacy    mtu: 1500       device: qfe0
qfe1            type: legacy    mtu: 1500       device: qfe1
qfe2            type: legacy    mtu: 1500       device: qfe2
qfe3            type: legacy    mtu: 1500       device: qfe3
# <tt><b>ifconfig -a</b></tt>
# ifconfig -a
lo0: flags=1000849 &lt;UP,LOOPBACK,RUNNING,MULTICAST,IPv4> mtu 8232 index 1
        inet 127.0.0.1 netmask ff000000 
hme0: flags=1000843 &lt;UP,BROADCAST,RUNNING,MULTICAST,IPv4> mtu 1500 index 2
      inet 192.168.5.82 netmask ff000000 broadcast 192.255.255.255
      ether 8:0:20:c1:1b:c6 
 </pre><p>The <tt>dladm show-link</tt> command reports that <tt>hostc</tt> has two interfaces with a total of
five possible links. However, only <tt>hme0</tt>  has been plumbed. To configure <tt>hostc</tt>
as a multihomed host, you must add <tt>qfe0</tt> or another link on the
<tt>qfe</tt> NIC . First, you would physically connect the <tt>qfe0</tt> interface to the
<tt>192.168.5.0</tt> network. Then you would plumb the <tt>qfe0</tt> interface, and  make the
interface persist across reboots.</p><pre># <tt><b>ifconfig qf0 plumb up</b></tt>
# <tt><b>ifconfig qfe0 192.168.5.85</b></tt>
# <tt><b>ifconfig -a</b></tt>
lo0: flags=1000849 &lt;UP,LOOPBACK,RUNNING,MULTICAST,IPv4> mtu 8232 index 1
        inet 127.0.0.1 netmask ff000000 
hme0: flags=1000843 &lt;UP,BROADCAST,RUNNING,MULTICAST,IPv4> mtu 1500 index 2
        inet 192.168.5.82 netmask ff0000 broadcast 192.255.255.255
        ether 8:0:20:c1:1b:c6 
qfe0: flags=1000843 &lt;UP,BROADCAST,RUNNING,MULTICAST,IPv4> mtu 1500 index 2
        inet 192.168.5.85 netmask ff000000 broadcast 192.255.255.255
        ether 8:0:20:e1:3b:c4
 # <tt><b>vi /etc/hostname.qfe0</b></tt>
<tt><b>192.168.5.85 255.0.0.0</b></tt></pre><p>Reboot the system, using the reconfiguration command:</p><pre># <tt><b>reboot -- -r</b></tt></pre><p>Next, you would add the <tt>qfe0</tt> interface to the <tt>hosts</tt> database:</p><pre># <tt><b>vi /etc/inet/hosts</b></tt>
127.0.0.1           localhost
192.168.5.82        host3    #primary network interface for host3
<tt><b>192.168.5.85 host3-2 #second interface</b></tt></pre><p>Then, you would check the state of packet forwarding and routing on <tt>host3</tt>:</p><pre># <tt><b>routeadm</b></tt>
              Configuration   Current              Current
                     Option   Configuration        System State
---------------------------------------------------------------
               IPv4 routing   enabled              enabled
               IPv6 routing   disabled             disabled
            IPv4 forwarding   enabled              enabled
            IPv6 forwarding   disabled             disabled

           Routing services   "route:default ripng:default"</pre><p>The <tt>routeadm</tt> command reports that dynamic routing through the <tt>in.routed</tt> daemon and packet forwarding
are currently enabled. However, you would need to disable packet forwarding:</p><pre># <tt><b>svcadm disable ipv4-forwarding</b></tt></pre><p>You can also use the <tt>routeadm</tt> commands as shown in <a href="#ipconfig-130">How to Create a Multihomed Host</a> to turn
off packet forwarding. When packet forwarding is disabled, <tt>host3</tt> becomes a multihomed host.</p>

<a name="gcvjx"></a><h4>Configuring Routing for Single-Interface Systems</h4>
<p><a name="indexterm-585"></a>Single-interface hostsneed to implement some form of routing. If the host is to obtain
its routes from one or more local default routers, then you must
configure the host to use static routing. Otherwise,  dynamic routing is recommended for
the host. The following procedures contain the instructions for enabling both routing
types.</p>

<a name="ipconfig-125"></a><h5>How to Enable Static Routing on a Single-Interface Host</h5>
<p><a name="indexterm-586"></a><a name="indexterm-587"></a>This procedure enables static routing on a single-interface host. Hosts that use
static routing do not run a dynamic routing protocolsuch as RIP. Instead, the host
must rely on the services of a default router for routing information. The
figure <a href="#gcxjg">IPv4 Autonomous System Topology</a> shows several default routers and their client hosts. If you supplied
the name of a default router when you installed a particular host,
 that host is already configured to use static routing. </p>
<hr><p><b>Note - </b>You can also use the following procedure to configure static routing on a
multihomed host.</p>
<hr>
<p>For  information about the <tt>/etc/defaultrouter</tt> file, see <a href="ipconfig-12.html#ipconfig-17"><tt>/etc/defaultrouter</tt> File</a>. For information about static
routing and the routing table, refer to <a href="#gdyen"> Routing Tables and Routing Types</a>.</p><ol>
<li><b>On the single interface host, assume the Primary Administrator role, or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b>Verify whether the <tt>/etc/defaultrouter </tt>file is present on the host.</b><pre># <tt><b>cd /etc</b></tt>
# <tt><b>ls | grep defaultrouter</b></tt></pre></li>
<li><b>Open a text editor to create or modify the <tt>/etc/defaultrouter</tt> file </b></li>
<li><a name="ipconfig-step-14"></a><b>Add an entry for thedefault router.</b><pre># <tt><b>vi /etc/defaultrouter</b></tt>
<i>router-IP</i>
       </pre><p><a name="indexterm-588"></a><a name="indexterm-589"></a><a name="indexterm-590"></a>where <i>router-IP</i> indicates the IP address of the default router for the host
to use.</p></li>
<li><b>Verify that routing and packet forwarding are not running on the host.</b><pre># <tt><b>routeadm</b></tt>
   Configuration   Current              Current
                     Option   Configuration        System State
---------------------------------------------------------------
               IPv4 routing   disabled             disabled
               IPv6 routing   disabled             disabled
            IPv4 forwarding   disabled            disabled
            IPv6 forwarding   disabled             disabled

           Routing services   "route:default ripng:default"</pre></li>
<li><b>Add an entry for the default router in the local <tt>/etc/inet/hosts</tt> file.</b><p>For information about configuring <tt>/etc/inet/hosts</tt>, refer to <a href="ipconfig-63.html#gbwxb">How to Change the IPv4 Address and Other Network Configuration Parameters</a>.</p></li></ol><a name="geegq"></a>Example&nbsp;5-7 Configuring a Default Router and Static Routing for a Single-Interface Host<p><a name="indexterm-591"></a>The following example shows how to configure static routing for <tt>hostb</tt>, a
single-interface host on the network <tt>172.20.1.0</tt> that is shown in <a href="#gdcvl">Figure&nbsp;5-2</a>. <tt>hostb</tt> needs to
use Router 2 as its default router.</p><p>First, you would log in to <tt>hostb</tt> as superuser, or assume an equivalent
role. Then, you would determine whether the <tt>/etc/defaultrouter</tt> file is present on
the host:</p><pre># <tt><b>cd /etc</b></tt>
# <tt><b>ls | grep defaultrouter</b></tt></pre><p>No response from <tt>grep</tt> indicates that you need to create the <tt>/etc/defaultrouter</tt> file.</p><pre># <tt><b>vi /etc/defaultrouter</b></tt>
<tt><b>172.20.1.10</b></tt></pre><p>The entry in the <tt>/etc/defaultrouter</tt> file is the IP address of the interface
on Router 2, which is attached to the <tt>172.20.1.0</tt> network. Next, you
verify whether the host currently enables packet forwarding or routing.</p><pre># <tt><b>routeadm</b></tt>
   Configuration   Current              Current
                     Option   Configuration        System State
---------------------------------------------------------------
               IPv4 routing   disabled             disabled
               IPv6 routing   disabled             disabled
            IPv4 forwarding   enabled              enabled
            IPv6 forwarding   disabled             disabled

           Routing services   "route:default ripng:default"</pre><p>Packet forwarding is enabled for this particular host. You would turn it off
as follows:</p><pre># <tt><b>svcadm disable ipv4-forwarding</b></tt></pre><p>Lastly, you would make sure that the host's <tt>/etc/inet/hosts</tt> file has an entry
for the new default router.</p><pre># <tt><b>vi /etc/inet/hosts</b></tt>
127.0.0.1           localhost
172.20.1.18         host2    #primary network interface for host2
<tt><b>172.20.1.10 router2 #default router for host2</b></tt></pre>

<a name="ipconfig-15"></a><h5>How to Enable Dynamic Routing on a Single-Interface Host</h5>
<p><a name="indexterm-592"></a>Dynamic routing is the easiest way to manage routing on a host. Hosts
that use dynamic routing run the routing protocols provided by the <tt>in.routed</tt> daemon
for IPv4 or <tt>in.ripngd</tt> daemon for IPv6. Use the next procedure to enable IPv4
dynamic routing on a single interface host. For more information about dynamic routing, refer to
<a href="">Packet Forwarding and Routing on IPv4 Networks</a>.</p><ol>
<li><b>On the host, assume the Primary Administrator role or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="ipconfig-step-18"></a><b><a name="indexterm-593"></a><a name="indexterm-594"></a><a name="indexterm-595"></a><a name="indexterm-596"></a>Verify whether the <tt>/etc/defaultrouter</tt> file exists.</b><pre># <tt><b>cd /etc</b></tt>
# <tt><b>ls | grep defaultrouter</b></tt></pre></li>
<li><b>If <tt>/etc/defaultrouter</tt> exists, delete any entry that you find there.</b><p>An empty <tt>/etc/defaultrouter</tt> file forces the host to use dynamic routing.</p></li>
<li><b>Verify whether packet forwarding and routing are enabled on the host.</b><pre># <tt><b>routeadm</b></tt>
   Configuration   Current              Current
                     Option   Configuration        System State
---------------------------------------------------------------
               IPv4 routing   disabled             disabled
               IPv6 routing   disabled             disabled
            IPv4 forwarding   enabled              enabled
            IPv6 forwarding   disabled             disabled

           Routing services   "route:default ripng:default"</pre></li>
<li><b>If packet forwarding is enabled, turn it off </b><p>Use either of the following commands:</p>
<ul><li><p>For the <tt>routeadm</tt> command, type the following:</p><pre># <tt><b>routeadm -d ipv4-forwarding -u</b></tt></pre></li>
<li><p>To use SMF, type the following:</p><pre># <tt><b>svcadm disable ipv4-forwarding</b></tt></pre></li></ul>
</li>
<li><b>Enable routing protocols on the host.<a name="indexterm-597"></a></b><p>Use either of the following commands:</p>
<ul><li><p>For the <tt>routeadm</tt> command, type the following:</p><pre># <tt><b>routeadm -e ipv4-routing -u</b></tt></pre></li>
<li><p>To use SMF, type the following:</p><pre>#<tt><b>svcadm enable route:default</b></tt> </pre></li></ul>
<p>Now IPv4 dynamic routing is enabled. The host's routing table is dynamically
maintained by the <tt>in.routed</tt> daemon.</p></li></ol><a name="geekw"></a>Example&nbsp;5-8 Running Dynamic Routing on a Single-Interface Host<p><a name="indexterm-598"></a>The following example shows how to configure dynamic routing for <tt>hosta</tt>, a
single-interface host on the network <tt>192.168.5.0</tt> that is shown in <a href="#gdcvl">Figure&nbsp;5-2</a>. <tt>hosta</tt> currently uses
Router 1 as its default router. However, <tt>hosta</tt> now needs to run dynamic
routing.</p><p>First, you would log in to <tt>hosta</tt> as superuser or assume an equivalent
role. Then, you would determine whether the <tt>/etc/defaultrouter</tt> file is present on
the host:</p><pre># <tt><b>cd /etc</b></tt>
# <tt><b>ls | grep defaultrouter</b></tt>
defaultrouter</pre><p>The response from <tt>grep</tt> indicates that a <tt>/etc/defaultrouter</tt> file exists for <tt>hosta</tt>.
</p><pre># <tt><b>vi /etc/defaultrouter</b></tt>
192.168.5.10</pre><p>The file has the entry <tt>192.168.5.10</tt>, which is the IP address for Router
1. You would delete this entry to enable static routing. Next, you would
need to verify whether packet forwarding and routing are already enabled for the
host.</p><pre># <tt><b>routeadm</b></tt>   Configuration   Current              Current
                     Option   Configuration        System State
---------------------------------------------------------------
               IPv4 routing   disabled             disabled
               IPv6 routing   disabled             disabled
            IPv4 forwarding   disabled             disabled
            IPv6 forwarding   disabled             disabled

           Routing services   "route:default ripng:default"</pre><p>Both routing and packet forwarding are turned off for <tt>hosta</tt>. Turn on routing
to complete the configuration of dynamic routing for <tt>hosta</tt>, as follows:</p><p>#<tt><b>svcadm enable route:default</b></tt></p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ipconfig-63.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ipconfig-111.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

