<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Why You Should Use IPMP - System Administration Guide: IP Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: IP Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="mpoverview.html">Previous</a>
             </td>
             <td align="right">
                 <a href="eyprl.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="iptm-1.html">Part&nbsp;I&nbsp;TCP/IP Administration</a></p>
<p class="toc level2"><a href="ipov-1.html">1.&nbsp;&nbsp;Solaris TCPIP Protocol Suite (Overview)</a></p>
<p class="toc level2"><a href="ipplan-1.html">2.&nbsp;&nbsp;Planning an IPv4 Addressing Scheme (Tasks</a></p>
<p class="toc level2"><a href="ipv6-overview-7.html">3.&nbsp;&nbsp;Planning an IPv6 Addressing Scheme (Overview)</a></p>
<p class="toc level2"><a href="ipv6-planning-1.html">4.&nbsp;&nbsp;Planning an IPv6 Network (Tasks)</a></p>
<p class="toc level2"><a href="ipconfig-1.html">5.&nbsp;&nbsp;Configuring TCP/IP Network Services and IPv4 Addressing (Tasks)</a></p>
<p class="toc level2"><a href="fwawf.html">6.&nbsp;&nbsp;Administering Network Interfaces (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-config-tasks-1.html">7.&nbsp;&nbsp;Enabling IPv6 on a Network (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-admintasks-1.html">8.&nbsp;&nbsp;Administering a TCP/IP Network (Tasks)</a></p>
<p class="toc level2"><a href="gegel.html">9.&nbsp;&nbsp;Troubleshooting Network Problems (Tasks)</a></p>
<p class="toc level2"><a href="ipref-8.html">10.&nbsp;&nbsp;TCP/IP and IPv4 in Depth (Reference)</a></p>
<p class="toc level2"><a href="ipv6-ref-76.html">11.&nbsp;&nbsp;IPv6 in Depth (Reference)</a></p>
<p class="toc level1 tocsp"><a href="dhcptm-1.html">Part&nbsp;II&nbsp;DHCP</a></p>
<p class="toc level2"><a href="dhcp-overview-1.html">12.&nbsp;&nbsp;About Solaris DHCP (Overview)</a></p>
<p class="toc level2"><a href="chap2-26.html">13.&nbsp;&nbsp;Planning for DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="chapter3-20.html">14.&nbsp;&nbsp;Configuring the DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="dhcp-admin-9.html">15.&nbsp;&nbsp;Administering DHCP (Tasks)</a></p>
<p class="toc level2"><a href="eyatl.html">16.&nbsp;&nbsp;Configuring and Administering  DHCP Clients</a></p>
<p class="toc level2"><a href="dhcp-trouble-1.html">17.&nbsp;&nbsp;Troubleshooting DHCP (Reference)</a></p>
<p class="toc level2"><a href="dhcp-ref-4.html">18.&nbsp;&nbsp;DHCP Commands and Files (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipsectm-1.html">Part&nbsp;III&nbsp;IP Security</a></p>
<p class="toc level2"><a href="ipsec-ov-1.html">19.&nbsp;&nbsp;IP Security Architecture (Overview)</a></p>
<p class="toc level2"><a href="ipsec-mgtasks-1.html">20.&nbsp;&nbsp;Configuring IPsec (Tasks)</a></p>
<p class="toc level2"><a href="ipsecref-1.html">21.&nbsp;&nbsp;IP Security Architecture (Reference)</a></p>
<p class="toc level2"><a href="ike-1.html">22.&nbsp;&nbsp;Internet Key Exchange (Overview)</a></p>
<p class="toc level2"><a href="ike-task-1.html">23.&nbsp;&nbsp;Configuring IKE (Tasks)</a></p>
<p class="toc level2"><a href="ikeref-1.html">24.&nbsp;&nbsp;Internet Key Exchange (Reference)</a></p>
<p class="toc level2"><a href="eupsq.html">25.&nbsp;&nbsp;Solaris IP Filter (Overview)</a></p>
<p class="toc level2"><a href="ipfilter-admin-1.html">26.&nbsp;&nbsp;Solaris IP Filter (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="miptm-1.html">Part&nbsp;IV&nbsp;Mobile IP</a></p>
<p class="toc level2"><a href="mipoverview-1.html">27.&nbsp;&nbsp;Mobile IP (Overview)</a></p>
<p class="toc level2"><a href="mipimplementing-1.html">28.&nbsp;&nbsp;Administering Mobile IP (Tasks)</a></p>
<p class="toc level2"><a href="mipmanaging-22.html">29.&nbsp;&nbsp;Mobile IP Files and Commands (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipmptm-1.html">Part&nbsp;V&nbsp;IPMP</a></p>
<p class="toc level2"><a href="mpoverview.html">30.&nbsp;&nbsp;Introducing IPMP (Overview)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Why You Should Use IPMP</a></p>
</div>
<p class="toc level3"><a href="eyprl.html">Basic Requirements of IPMP</a></p>
<p class="toc level3"><a href="emqwq.html">IPMP Addressing</a></p>
<p class="toc level3"><a href="eobra.html">IPMP Interface Configurations</a></p>
<p class="toc level3"><a href="emqqq.html">IPMP Failure Detection and Recovery Features</a></p>
<p class="toc level3"><a href="esqdy.html">IPMP and Dynamic Reconfiguration</a></p>
<p class="toc level2 tocsp"><a href="deploynetmult-56.html">31.&nbsp;&nbsp;Administering IPMP (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ipqostm-1.html">Part&nbsp;VI&nbsp;IP Quality of Service (IPQoS)</a></p>
<p class="toc level2"><a href="ipqos-intro-1.html">32.&nbsp;&nbsp;Introducing IPQoS (Overview)</a></p>
<p class="toc level2"><a href="ipqos-config-planning-1.html">33.&nbsp;&nbsp;Planning for an IPQoS-Enabled Network (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-policy-planning-1.html">34.&nbsp;&nbsp;Creating the IPQoS Configuration File (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-isp-setup-1.html">35.&nbsp;&nbsp;Starting and Maintaining IPQoS (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-accounting-1.html">36.&nbsp;&nbsp;Using Flow Accounting and Statistics Gathering (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-reference-1.html">37.&nbsp;&nbsp;IPQoS in Detail (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="chapter1-2"></a><h3>Why You Should Use IPMP</h3>
<a name="indexterm-2807"></a><a name="indexterm-2808"></a><p>IPMP provides increased reliability, availability, and network performance for systems with multiple physical
interfaces.  Occasionally, a physical interface or the networking hardware attached to that interface
might fail or require maintenance. Traditionally, at that point, the system can no
longer be contacted through any of the IP addresses that are associated with
the failed interface.  Additionally, any existing connections to the system using those IP
addresses are disrupted.</p><p>By using IPMP, you can configure one or more physical interfaces into an
IP multipathing group, or <b>IPMP group</b>.  After configuring IPMP, the system automatically monitors
the interfaces in the IPMP group for failure. If an interface in the
group fails or is removed for maintenance, IPMP automatically migrates, or <b>fails over</b>, the
failed interface's IP addresses. The recipient of these addresses is a functioning interface in
the failed interface's IPMP group. The failover feature of IPMP preserves connectivity and
prevents disruption of any existing connections.  Additionally, IPMP improves  overall network
performance by automatically spreading out network traffic across the set of interfaces in
the IPMP group. This process is called <b>load spreading</b>.<a name="indexterm-2809"></a><a name="indexterm-2810"></a></p>

<a name="mpoverview-22"></a><h4>Solaris IPMP Components</h4>
<p><a name="indexterm-2811"></a>Solaris IPMP involves the following software:</p>
<ul><li><p>The <tt>in.mpathd</tt> daemon, which is explained fully in the <a href="http://docs.sun.com/doc/819-2240/in.mpathd-1m?a=view"><tt>in.mpathd</tt>(1M)</a> man page.</p></li>
<li><p>The <tt>/etc/default/mpathd</tt> configuration file, which is also described in the <tt>in.mpathd</tt>(1M) man page.</p></li>
<li><p><tt>ifconfig</tt> options for IPMP configuration, as described in the <a href="http://docs.sun.com/doc/819-2240/ifconfig-1m?a=view"><tt>ifconfig</tt>(1M)</a> man page.<a name="indexterm-2812"></a></p></li></ul>


<a name="mpoverview-11"></a><h5>Multipathing Daemon, <tt>in.mpathd</tt></h5>
<a name="indexterm-2813"></a><a name="indexterm-2814"></a><a name="indexterm-2815"></a><p>The <tt>in.mpathd</tt> daemon detects interface failures, and then implements various procedures for failover
and failback. After <tt>in.mpathd</tt> detects a failure or a repair, the daemon
sends an <tt>ioctl</tt> to perform the failover or failback. The <tt>ip</tt> kernel module,
which implements the <tt>ioctl</tt>, does the network access failover transparently and automatically.</p>
<hr><p><b>Note - </b>Do not use Alternate Pathing while using IPMP on the same set of
network interface cards. Likewise, you should not use IPMP while you are using
Alternate Pathing. You can use Alternate Pathing and IPMP at the same time
on different sets of interfaces. For more information about Alternate Pathing, refer to
the <i>Sun Enterprise Server Alternate Pathing 2.3.1 User Guide</i>.</p>
<hr>
<p><a name="indexterm-2816"></a><a name="indexterm-2817"></a>The <tt>in.mpathd</tt> daemon detects failures and repairs by sending out probes on all
the interfaces that are part of an IPMP group. The <tt>in.mpathd</tt> daemon also
detects failures and repairs by monitoring the <tt>RUNNING</tt> flag on each interface in the
group. Refer to the <a href="http://docs.sun.com/doc/819-2240/in.mpathd-1m?a=view"><tt>in.mpathd</tt>(1M)</a> man page for more information.</p>

<a name="mpoverview-2"></a><h4>IPMP Terminology and Concepts</h4>
<a name="indexterm-2818"></a><p>This section introduces terms and concepts that are used throughout <a href="ipmptm-1.html">Part&nbsp;V, IPMP</a>.</p>

<a name="emjhn"></a><h5>IP Link</h5>
<a name="indexterm-2819"></a><a name="indexterm-2820"></a><p>In IPMP terminology, an <b>IP link</b> is a communication facility or medium over which
nodes can communicate at the data-link layer of the Internet protocol suite. Types
of IP links might include simple Ethernets, bridged Ethernets, hubs, or Asynchronous Transfer
Mode (ATM) networks. An IP link can have one or more IPv4 subnet
numbers, and, if applicable, one or more IPv6 subnet prefixes. A subnet number
or prefix cannot be assigned to more than one IP link. In ATM
LANE, an IP link is a single emulated local area network (LAN). With
the Address Resolution Protocol (ARP), the scope of the ARP protocol is a
single IP link.</p>
<hr><p><b>Note - </b>Other IP-related documents, such as RFC 2460, <i>Internet Protocol, Version 6 (IPv6) Specification</i>, use the term <b>link</b> instead
of <b>IP link</b>. Part VI uses the term <b>IP link</b> to avoid confusion with IEEE 802.
In IEEE 802, <b>link</b> refers to a single wire from an Ethernet network
interface card (NIC) to an Ethernet switch.</p>
<hr>


<a name="emjhd"></a><h5>Physical Interface</h5>
<a name="indexterm-2821"></a><p>The <b>physical interface</b> provides a system's attachment to an IP link. This attachment is
often implemented as a device driver and a NIC. If a system has
multiple interfaces attached to the same link, you can configure IPMP to perform
failover if one of the interfaces fails. For more information on physical interfaces,
refer to <a href="eobra.html">IPMP Interface Configurations</a>.</p>

<a name="elfqr"></a><h5>Network Interface Card</h5>
<a name="indexterm-2822"></a><a name="indexterm-2823"></a><p>A <b>network interface card</b> is a network adapter that can be built in to the
system. Or, the NIC can be a  separate card that serves as
an interface from the system to an IP link. Some NICs can
have multiple physical interfaces. For example, a <tt>qfe</tt> NIC can have four interfaces, <tt>qfe0</tt>
through <tt>qfe3</tt>, and so on. </p>

<a name="emjid"></a><h5>IPMP Group</h5>
<a name="indexterm-2824"></a><a name="indexterm-2825"></a><a name="indexterm-2826"></a><p>An IP multipathing group, or <b>IPMP</b> group, consists of one or more physical
interfaces on the same system that are configured with the same IPMP group
name. All interfaces in the IPMP group must be connected to the same
IP link. The same (non-null) character string IPMP group name identifies all interfaces
in the group. You can place interfaces from NICs of different speeds within
the same IPMP group, as long as the NICs are of the same
type. For example, you can configure the interfaces of 100-megabit Ethernet NICs and
the interfaces of one gigabit Ethernet NICs in the same group.  As
another example, suppose you have two 100-megabit Ethernet NICs. You can configure one
of the interfaces down to 10 megabits and still place the two interfaces
into the same IPMP group. </p><p>You cannot place two interfaces of different media types into an IPMP group.
For example, you cannot place an ATM interface in the same group
as an Ethernet interface.</p>

<a name="elfqt"></a><h5>Failure Detection and Failover</h5>
<a name="indexterm-2827"></a><a name="indexterm-2828"></a><a name="indexterm-2829"></a><p><b>Failure detection</b> is the process of detecting when an interface or the path from
an interface to an Internet layer device no longer works. IPMP provides systems
with the ability to detect when an interface has failed. IPMP detects the
following types of communication failures:</p>
<ul><li><p>The transmit or receive path of the interface has failed.</p></li>
<li><p>The attachment of the interface to the IP link is down.</p></li>
<li><p>The port on the switch does not transmit or receive packets.</p></li>
<li><p>The physical interface in an IPMP group is not present at system boot.</p></li></ul>
<p>After detecting a failure, IPMP begins failover. <b>Failover</b> is the automatic process of
switching the network access from a failed interface to a functioning physical interface
in the same group. Network access includes IPv4 unicast, multicast, and broadcast traffic,
as well as IPv6 unicast and multicast traffic. Failover can only occur when
you have configured more than one interface in the IPMP group. The failover
process ensures uninterrupted access to the network. <a name="indexterm-2830"></a><a name="indexterm-2831"></a></p>

<a name="elfre"></a><h5>Repair Detection and Failback</h5>
<a name="indexterm-2832"></a><a name="indexterm-2833"></a><a name="indexterm-2834"></a><a name="indexterm-2835"></a><p><b>Repair detection</b> is the process of detecting when a NIC or the path from
 a NIC to an Internet layer device starts operating correctly after a
failure. After detecting that a NIC has been repaired, IPMP performs <b>failback</b>, the
process of switching network access back to the repaired interface. Repair detection assumes
that you have enabled failbacks. See <a href="emqqq.html#mpoverview-24">Detecting Physical Interface Repairs</a> for more information.</p>

<a name="epmpt"></a><h5>Target Systems</h5>
<a name="indexterm-2836"></a><a name="indexterm-2837"></a><p>Probe-based failure detection uses <b>target systems</b> to determine the condition of an interface. Each
target system must be attached to the same IP link as the members
of the  IPMP group. The <tt>in.mpathd</tt> daemon on the local system sends
ICMP probe messages to each target system. The probe messages help to determine
the health of each interface in the IPMP group. </p><p>For more information about target system use in probe-based failure detection, refer to
<a href="emqqq.html#emqra">Probe-Based Failure Detection</a>.</p>

<a name="emjif"></a><h5>Outbound Load Spreading</h5>
<a name="indexterm-2838"></a><p>With IPMP configured, outbound network packets are spread across multiple NICs without affecting
the ordering of packets. This process is known as <b>load spreading</b>. As a
result of load spreading, higher throughput is achieved. Load spreading occurs only when
the network traffic is flowing to multiple destinations that use multiple connections.</p>

<a name="emjim"></a><h5>Dynamic Reconfiguration</h5>
<a name="indexterm-2839"></a><a name="indexterm-2840"></a><a name="indexterm-2841"></a><p><b>Dynamic reconfiguration</b> (DR) is the ability to reconfigure a system while the system is
running, with little or no impact on existing operations.  Not all Sun
platforms support DR. Some Sun platforms might only support DR of certain types
of hardware.  On platforms that support DR of NIC's, IPMP can be
used to transparently fail over network access, providing  uninterrupted network access to the
system.</p><p>For more information on how IPMP supports DR, refer to <a href="esqdy.html">IPMP and Dynamic Reconfiguration</a>.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="mpoverview.html">Previous</a>
             </td>
             <td align="right">
                 <a href="eyprl.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

