<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Recovering a Physical Interface That Was Not Present at System Boot - System Administration Guide: IP Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: IP Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="deploynetmult-92.html">Previous</a>
             </td>
             <td align="right">
                 <a href="gbdbr.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="iptm-1.html">Part&nbsp;I&nbsp;TCP/IP Administration</a></p>
<p class="toc level2"><a href="ipov-1.html">1.&nbsp;&nbsp;Solaris TCPIP Protocol Suite (Overview)</a></p>
<p class="toc level2"><a href="ipplan-1.html">2.&nbsp;&nbsp;Planning an IPv4 Addressing Scheme (Tasks</a></p>
<p class="toc level2"><a href="ipv6-overview-7.html">3.&nbsp;&nbsp;Planning an IPv6 Addressing Scheme (Overview)</a></p>
<p class="toc level2"><a href="ipv6-planning-1.html">4.&nbsp;&nbsp;Planning an IPv6 Network (Tasks)</a></p>
<p class="toc level2"><a href="ipconfig-1.html">5.&nbsp;&nbsp;Configuring TCP/IP Network Services and IPv4 Addressing (Tasks)</a></p>
<p class="toc level2"><a href="fwawf.html">6.&nbsp;&nbsp;Administering Network Interfaces (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-config-tasks-1.html">7.&nbsp;&nbsp;Enabling IPv6 on a Network (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-admintasks-1.html">8.&nbsp;&nbsp;Administering a TCP/IP Network (Tasks)</a></p>
<p class="toc level2"><a href="gegel.html">9.&nbsp;&nbsp;Troubleshooting Network Problems (Tasks)</a></p>
<p class="toc level2"><a href="ipref-8.html">10.&nbsp;&nbsp;TCP/IP and IPv4 in Depth (Reference)</a></p>
<p class="toc level2"><a href="ipv6-ref-76.html">11.&nbsp;&nbsp;IPv6 in Depth (Reference)</a></p>
<p class="toc level1 tocsp"><a href="dhcptm-1.html">Part&nbsp;II&nbsp;DHCP</a></p>
<p class="toc level2"><a href="dhcp-overview-1.html">12.&nbsp;&nbsp;About Solaris DHCP (Overview)</a></p>
<p class="toc level2"><a href="chap2-26.html">13.&nbsp;&nbsp;Planning for DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="chapter3-20.html">14.&nbsp;&nbsp;Configuring the DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="dhcp-admin-9.html">15.&nbsp;&nbsp;Administering DHCP (Tasks)</a></p>
<p class="toc level2"><a href="eyatl.html">16.&nbsp;&nbsp;Configuring and Administering  DHCP Clients</a></p>
<p class="toc level2"><a href="dhcp-trouble-1.html">17.&nbsp;&nbsp;Troubleshooting DHCP (Reference)</a></p>
<p class="toc level2"><a href="dhcp-ref-4.html">18.&nbsp;&nbsp;DHCP Commands and Files (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipsectm-1.html">Part&nbsp;III&nbsp;IP Security</a></p>
<p class="toc level2"><a href="ipsec-ov-1.html">19.&nbsp;&nbsp;IP Security Architecture (Overview)</a></p>
<p class="toc level2"><a href="ipsec-mgtasks-1.html">20.&nbsp;&nbsp;Configuring IPsec (Tasks)</a></p>
<p class="toc level2"><a href="ipsecref-1.html">21.&nbsp;&nbsp;IP Security Architecture (Reference)</a></p>
<p class="toc level2"><a href="ike-1.html">22.&nbsp;&nbsp;Internet Key Exchange (Overview)</a></p>
<p class="toc level2"><a href="ike-task-1.html">23.&nbsp;&nbsp;Configuring IKE (Tasks)</a></p>
<p class="toc level2"><a href="ikeref-1.html">24.&nbsp;&nbsp;Internet Key Exchange (Reference)</a></p>
<p class="toc level2"><a href="eupsq.html">25.&nbsp;&nbsp;Solaris IP Filter (Overview)</a></p>
<p class="toc level2"><a href="ipfilter-admin-1.html">26.&nbsp;&nbsp;Solaris IP Filter (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="miptm-1.html">Part&nbsp;IV&nbsp;Mobile IP</a></p>
<p class="toc level2"><a href="mipoverview-1.html">27.&nbsp;&nbsp;Mobile IP (Overview)</a></p>
<p class="toc level2"><a href="mipimplementing-1.html">28.&nbsp;&nbsp;Administering Mobile IP (Tasks)</a></p>
<p class="toc level2"><a href="mipmanaging-22.html">29.&nbsp;&nbsp;Mobile IP Files and Commands (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipmptm-1.html">Part&nbsp;V&nbsp;IPMP</a></p>
<p class="toc level2"><a href="mpoverview.html">30.&nbsp;&nbsp;Introducing IPMP (Overview)</a></p>
<p class="toc level2"><a href="deploynetmult-56.html">31.&nbsp;&nbsp;Administering IPMP (Tasks)</a></p>
<p class="toc level3"><a href="deploynetmult-58.html">Configuring IPMP (Task Maps)</a></p>
<p class="toc level3"><a href="deploynetmult-57.html">Configuring IPMP Groups</a></p>
<p class="toc level3"><a href="enflg.html">Maintaining IPMP Groups</a></p>
<p class="toc level4"><a href="enflg.html#deploynetmult-6">How to Display the IPMP Group Membership of an Interface</a></p>
<p class="toc level4"><a href="enflg.html#deploynetmult-103">How to Add an Interface to an IPMP Group</a></p>
<p class="toc level4"><a href="enflg.html#deploynetmult-7">How to Remove an Interface From an IPMP Group</a></p>
<p class="toc level4"><a href="enflg.html#deploynetmult-8">How to Move an Interface From One IPMP Group to Another Group</a></p>
<p class="toc level3 tocsp"><a href="deploynetmult-92.html">Replacing a Failed Physical Interface on Systems That Support Dynamic Reconfiguration</a></p>
<p class="toc level4"><a href="deploynetmult-92.html#deploynetmult-93">How to Remove a Physical Interface That Has Failed (DR-Detach)</a></p>
<p class="toc level4"><a href="deploynetmult-92.html#deploynetmult-97">How to Replace a Physical Interface That Has Failed (DR-Attach)</a></p>
<div class="onpage">
<p class="toc level3 tocsp"><a href="">Recovering a Physical Interface That Was Not Present at System Boot</a></p>
<p class="toc level4"><a href="#deploynetmult-107">How to Recover a Physical Interface That Was Not Present at System Boot</a></p>
</div>
<p class="toc level3 tocsp"><a href="gbdbr.html">Modifying the <tt>/etc/default/mpathd</tt> IPMP Configuration File</a></p>
<p class="toc level4"><a href="gbdbr.html#gbdbf">How to Configure the <tt>/etc/default/mpathd</tt> File</a></p>
<p class="toc level3 tocsp"><a href="deploynetmult-47.html">Modifying IPMP Configurations</a></p>
<p class="toc level4"><a href="deploynetmult-47.html#deploynetmult-48">How to Configure the <tt>/etc/default/mpathd</tt> File</a></p>
<p class="toc level1 tocsp"><a href="ipqostm-1.html">Part&nbsp;VI&nbsp;IP Quality of Service (IPQoS)</a></p>
<p class="toc level2"><a href="ipqos-intro-1.html">32.&nbsp;&nbsp;Introducing IPQoS (Overview)</a></p>
<p class="toc level2"><a href="ipqos-config-planning-1.html">33.&nbsp;&nbsp;Planning for an IPQoS-Enabled Network (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-policy-planning-1.html">34.&nbsp;&nbsp;Creating the IPQoS Configuration File (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-isp-setup-1.html">35.&nbsp;&nbsp;Starting and Maintaining IPQoS (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-accounting-1.html">36.&nbsp;&nbsp;Using Flow Accounting and Statistics Gathering (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-reference-1.html">37.&nbsp;&nbsp;IPQoS in Detail (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="deploynetmult-116"></a><h3>Recovering a Physical Interface That Was Not Present at System Boot</h3>
<a name="indexterm-2973"></a><a name="indexterm-2974"></a>
<hr><p><b>Note - </b>The following procedure pertains only to IP layers that are configured by using
the <tt>ifconfig</tt> command. Layers before or after the IP layer, such as ATM
or other services, require specific manual steps if the layers are not automated.
The specific steps in the next procedure are used to unconfigure interfaces during
predetachment and to configure interfaces after postattachment. </p>
<hr>
<p>Recovery after dynamic reconfiguration is automatic for an interface that is part of
the I/O board on a Sun Fire&trade; platform. If the NIC is a
Sun Crypto Accelerator I - cPCI board, the recovery is also 
automatic. Consequently, the following steps are not required for an interface that is coming
back as part of a DR operation. For more information on the
Sun Fire x800 and Sun Fire 15000 systems, see the <a href="http://docs.sun.com/doc/819-2240/cfgadm-sbd-1m?a=view"><tt>cfgadm_sbd</tt>(1M)</a> man page.
The physical interface fails back to the configuration that is specified in the
<tt>/etc/hostname.</tt><i>interface</i> file. See <a href="deploynetmult-57.html">Configuring IPMP Groups</a> for details on how to configure interfaces to preserve
the configuration across reboots.</p>
<hr><p><b>Note - </b>On Sun Fire legacy (Exx00) systems, DR detachments are still subject to manual
procedures. However, DR attachments are automated.</p>
<hr>


<a name="deploynetmult-107"></a><h4>How to Recover a Physical Interface That Was Not Present at System Boot</h4><p>You must complete the following procedure before you recover a physical interface that
was not present at system boot. The  example in this procedure has
the following configuration:</p>
<ul><li><p>Physical interfaces <tt>hme0</tt> and <tt>hme1</tt> are the interfaces. </p></li>
<li><p>Both interfaces are in the same IPMP group. </p></li>
<li><p><tt>hme0</tt> was not installed at system boot.</p></li></ul>

<hr><p><b>Note - </b>The failback of IP addresses during the recovery of a failed physical interface
takes up to three minutes. This time might vary, depending on network traffic.
The time also depends on the stability of the incoming interface to fail
back the failed-over interfaces by the <tt>in.mpathd</tt> daemon.</p>
<hr>
<ol>
<li><b>On the system with the IPMP group configuration, assume the Primary Administrator role
or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="deploynetmult-step-109"></a><b>Retrieve the failed network information from the failure error message of the console
log.</b><p>See the <a href="http://docs.sun.com/doc/819-2243/syslog-3c?a=view"><tt>syslog</tt>(3C)</a>man page. The error message might be similar to the following:</p><pre>moving addresses from failed IPv4 interfaces:
hme1 (moved to hme0)</pre><p>This message indicates that the IPv4 addresses on the failed interface <tt>hme1</tt>
have failed over to the <tt>hme0</tt> interface.</p><p>Alternatively, you might receive the following similar message:</p><pre>moving addresses from failed IPv4 interfaces:
hme1 (couldn't move, no alternative interface)</pre><p>This message indicates that no active interface could be found in the same
group as failed interface <tt>hme1</tt>. Therefore, the IPv4 addresses on <tt>hme1</tt> could not
fail over.</p></li>
<li><a name="deploynetmult-step-110"></a><b>Attach the physical interface to the system. </b><p>Refer to the following for instructions on how to replace the physical interface:</p>
<ul><li><p><a href="http://docs.sun.com/doc/819-2240/cfgadm-1m?a=view"><tt>cfgadm</tt>(1M)</a> man page</p></li>
<li><p><i>Sun Enterprise 10000 DR Configuration Guide</i></p></li>
<li><p><i>Sun Enterprise 6x00, 5x00, 4x00, and 3x00 Systems Dynamic Reconfiguration User's Guide</i></p></li></ul>
</li>
<li><a name="deploynetmult-step-111"></a><b>Refer to the message content from Step 2. If the addresses could not
be moved, go to Step 6. If the addresses were moved, continue to
Step 5.</b></li>
<li><a name="deploynetmult-step-112"></a><b>Unplumb the logical interfaces that were configured as part of the failover process.</b><ol style="list-style-type: lower-alpha">
				 
<li><a name="deploynetmult-step-113"></a><b>Review the contents of the <tt>/etc/hostname.</tt><i>moved-from-interface</i><tt></tt> file to determine what logical interfaces were
configured as part of the failover process.</b></li>
<li><a name="deploynetmult-step-114"></a><b>Unplumb each failover IP address.</b><pre># ifconfig <i>moved-to-interface</i> removeif <i>moved-ip-address</i></pre>
<hr><p><b>Note - </b>Failover addresses are marked with the <tt>failover</tt> parameter, or are not marked with
the <tt>-failover</tt> parameter. You do not need to unplumb IP addresses that are
marked <tt>-failover</tt>.</p>
<hr>
<p>For example, assume that the contents of the <tt>/etc/hostname.hme0</tt> file contains the following
lines:</p><pre>inet 10.0.0.4 -failover up group one
addif 10.0.0.5 failover up
addif 10.0.0.6 failover up</pre><p>To unplumb each failover IP address, you would type the following commands:</p><pre># ifconfig hme0 removeif 10.0.0.5
# ifconfig hme0 removeif 10.0.0.6</pre></li></ol></li>
<li><a name="deploynetmult-step-115"></a><b>Reconfigure the IPv4 information for the replaced physical interface by typing the following
command for each interface that was removed:</b><pre># ifconfig <i>removed-from-NIC</i> &lt;parameters></pre><p>For example, you would type the following commands:</p><pre># ifconfig hme1 inet plumb
# ifconfig hme1 inet 10.0.0.4 -failover up group one
# ifconfig hme1 addif 10.0.0.5 failover up
# ifconfig hme1 addif 10.0.0.6 failover up</pre></li></ol>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="deploynetmult-92.html">Previous</a>
             </td>
             <td align="right">
                 <a href="gbdbr.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

