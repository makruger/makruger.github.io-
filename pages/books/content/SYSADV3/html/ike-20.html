<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>IKE Public Key Databases and Commands - System Administration Guide: IP Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: IP Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ike-15.html">Previous</a>
             </td>
             <td align="right">
                 <a href="eupsq.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="iptm-1.html">Part&nbsp;I&nbsp;TCP/IP Administration</a></p>
<p class="toc level2"><a href="ipov-1.html">1.&nbsp;&nbsp;Solaris TCPIP Protocol Suite (Overview)</a></p>
<p class="toc level2"><a href="ipplan-1.html">2.&nbsp;&nbsp;Planning an IPv4 Addressing Scheme (Tasks</a></p>
<p class="toc level2"><a href="ipv6-overview-7.html">3.&nbsp;&nbsp;Planning an IPv6 Addressing Scheme (Overview)</a></p>
<p class="toc level2"><a href="ipv6-planning-1.html">4.&nbsp;&nbsp;Planning an IPv6 Network (Tasks)</a></p>
<p class="toc level2"><a href="ipconfig-1.html">5.&nbsp;&nbsp;Configuring TCP/IP Network Services and IPv4 Addressing (Tasks)</a></p>
<p class="toc level2"><a href="fwawf.html">6.&nbsp;&nbsp;Administering Network Interfaces (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-config-tasks-1.html">7.&nbsp;&nbsp;Enabling IPv6 on a Network (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-admintasks-1.html">8.&nbsp;&nbsp;Administering a TCP/IP Network (Tasks)</a></p>
<p class="toc level2"><a href="gegel.html">9.&nbsp;&nbsp;Troubleshooting Network Problems (Tasks)</a></p>
<p class="toc level2"><a href="ipref-8.html">10.&nbsp;&nbsp;TCP/IP and IPv4 in Depth (Reference)</a></p>
<p class="toc level2"><a href="ipv6-ref-76.html">11.&nbsp;&nbsp;IPv6 in Depth (Reference)</a></p>
<p class="toc level1 tocsp"><a href="dhcptm-1.html">Part&nbsp;II&nbsp;DHCP</a></p>
<p class="toc level2"><a href="dhcp-overview-1.html">12.&nbsp;&nbsp;About Solaris DHCP (Overview)</a></p>
<p class="toc level2"><a href="chap2-26.html">13.&nbsp;&nbsp;Planning for DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="chapter3-20.html">14.&nbsp;&nbsp;Configuring the DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="dhcp-admin-9.html">15.&nbsp;&nbsp;Administering DHCP (Tasks)</a></p>
<p class="toc level2"><a href="eyatl.html">16.&nbsp;&nbsp;Configuring and Administering  DHCP Clients</a></p>
<p class="toc level2"><a href="dhcp-trouble-1.html">17.&nbsp;&nbsp;Troubleshooting DHCP (Reference)</a></p>
<p class="toc level2"><a href="dhcp-ref-4.html">18.&nbsp;&nbsp;DHCP Commands and Files (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipsectm-1.html">Part&nbsp;III&nbsp;IP Security</a></p>
<p class="toc level2"><a href="ipsec-ov-1.html">19.&nbsp;&nbsp;IP Security Architecture (Overview)</a></p>
<p class="toc level2"><a href="ipsec-mgtasks-1.html">20.&nbsp;&nbsp;Configuring IPsec (Tasks)</a></p>
<p class="toc level2"><a href="ipsecref-1.html">21.&nbsp;&nbsp;IP Security Architecture (Reference)</a></p>
<p class="toc level2"><a href="ike-1.html">22.&nbsp;&nbsp;Internet Key Exchange (Overview)</a></p>
<p class="toc level2"><a href="ike-task-1.html">23.&nbsp;&nbsp;Configuring IKE (Tasks)</a></p>
<p class="toc level2"><a href="ikeref-1.html">24.&nbsp;&nbsp;Internet Key Exchange (Reference)</a></p>
<p class="toc level3"><a href="ike-17.html">IKE Daemon</a></p>
<p class="toc level3"><a href="ike-6.html">IKE Policy File</a></p>
<p class="toc level3"><a href="ike-19.html">IKE Administration Command</a></p>
<p class="toc level3"><a href="ike-15.html">IKE Preshared Keys Files</a></p>
<div class="onpage">
<p class="toc level3"><a href="">IKE Public Key Databases and Commands</a></p>
</div>
<p class="toc level2 tocsp"><a href="eupsq.html">25.&nbsp;&nbsp;Solaris IP Filter (Overview)</a></p>
<p class="toc level2"><a href="ipfilter-admin-1.html">26.&nbsp;&nbsp;Solaris IP Filter (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="miptm-1.html">Part&nbsp;IV&nbsp;Mobile IP</a></p>
<p class="toc level2"><a href="mipoverview-1.html">27.&nbsp;&nbsp;Mobile IP (Overview)</a></p>
<p class="toc level2"><a href="mipimplementing-1.html">28.&nbsp;&nbsp;Administering Mobile IP (Tasks)</a></p>
<p class="toc level2"><a href="mipmanaging-22.html">29.&nbsp;&nbsp;Mobile IP Files and Commands (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipmptm-1.html">Part&nbsp;V&nbsp;IPMP</a></p>
<p class="toc level2"><a href="mpoverview.html">30.&nbsp;&nbsp;Introducing IPMP (Overview)</a></p>
<p class="toc level2"><a href="deploynetmult-56.html">31.&nbsp;&nbsp;Administering IPMP (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ipqostm-1.html">Part&nbsp;VI&nbsp;IP Quality of Service (IPQoS)</a></p>
<p class="toc level2"><a href="ipqos-intro-1.html">32.&nbsp;&nbsp;Introducing IPQoS (Overview)</a></p>
<p class="toc level2"><a href="ipqos-config-planning-1.html">33.&nbsp;&nbsp;Planning for an IPQoS-Enabled Network (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-policy-planning-1.html">34.&nbsp;&nbsp;Creating the IPQoS Configuration File (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-isp-setup-1.html">35.&nbsp;&nbsp;Starting and Maintaining IPQoS (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-accounting-1.html">36.&nbsp;&nbsp;Using Flow Accounting and Statistics Gathering (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-reference-1.html">37.&nbsp;&nbsp;IPQoS in Detail (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="ike-20"></a><h3>IKE Public Key Databases and Commands</h3>
<a name="indexterm-2228"></a><a name="indexterm-2229"></a><a name="indexterm-2230"></a><p><a name="indexterm-2231"></a><a name="indexterm-2232"></a><a name="indexterm-2233"></a>The <tt>ikecert</tt> command manipulates the local system's public key databases. You use this
command when the <tt>ike/config</tt> file requires public key certificates. Because IKE uses these
databases to authenticate the Phase 1 exchange, the databases must be populated before
activating the <tt>in.iked</tt> daemon. Three subcommands handle each of the three databases:
<tt>certlocal</tt>, <tt>certdb</tt>, and <tt>certrldb</tt>.</p><p><a name="indexterm-2234"></a><a name="indexterm-2235"></a><a name="indexterm-2236"></a><a name="indexterm-2237"></a><a name="indexterm-2238"></a><a name="indexterm-2239"></a><a name="indexterm-2240"></a>The <tt>ikecert</tt> command also handles key storage. Keys can be stored on disk,
on an attached Sun Crypto Accelerator 4000 board, or in a softtoken keystore.
The softtoken keystore is available when the metaslot in the Solaris cryptographic framework
is used to communicate with the hardware device. The <tt>ikecert</tt> command uses
the PKCS&nbsp;#11 library to locate key storage.</p>
<ul><li><p><b>Solaris 10 1/06</b>: In this release, the library does not have to be specified. By default, the PKCS&nbsp;#11 library is <tt>/usr/lib/libpkcs11.so</tt>.</p></li>
<li><p><b>Solaris 10</b>: In this release, the PKCS&nbsp;#11 entry must be specified. Otherwise, the <tt>-T</tt> option to the <tt>ikecert</tt> command cannot work. The entry appears similar to the following:</p><pre>pkcs11_path <tt><b>"/opt/SUNWconn/cryptov2/lib/libvpkcs11.so"</b></tt></pre></li></ul>
<p>For more information, see the <a href="http://docs.sun.com/doc/819-2240/ikecert-1m?a=view"><tt>ikecert</tt>(1M)</a> man page. For information about metaslot and
the softtoken keystore, see the <a href="http://docs.sun.com/doc/819-2240/cryptoadm-1m?a=view"><tt>cryptoadm</tt>(1M)</a> man page.</p>

<a name="ike-25"></a><h4><tt>ikecert tokens</tt> Command</h4>
<p><a name="indexterm-2241"></a>The <tt>tokens</tt> argument lists the token IDs that are available. Token IDs enable
the <tt>ikecert certlocal</tt> and <tt>ikecert certdb</tt> commands to generate public key certificates and certificate requests.
The certificates and certificate requests can also be stored by the cryptographic framework
in the softtoken keystore, or on an attached Sun Crypto Accelerator 4000 board.
The <tt>ikecert</tt> command uses the PKCS&nbsp;#11 library to locate certificate storage.</p>

<a name="ike-27"></a><h4><tt>ikecert certlocal</tt> Command</h4>
<p><a name="indexterm-2242"></a><a name="indexterm-2243"></a><a name="indexterm-2244"></a><a name="indexterm-2245"></a><a name="indexterm-2246"></a><a name="indexterm-2247"></a><a name="indexterm-2248"></a>The <tt>certlocal</tt> subcommand manages the private key database. Options to this subcommand enable
you to add, view, and remove private keys. This subcommand also creates either
a self-signed certificate or a certificate request. The <tt>-ks</tt> option creates a self-signed certificate.
The <tt>-kc</tt> option creates a certificate request. Keys are stored on the system
in the <tt>/etc/inet/secret/ike.privatekeys</tt> directory, or on attached hardware with the <tt>-T</tt> option.</p><p><a name="indexterm-2249"></a>When you create a private key, the options to the <tt>ikecert certlocal</tt> command
must have related entries in the <tt>ike/config</tt> file. The correspondences between <tt>ikecert</tt>
options and <tt>ike/config</tt> entries are shown in the following table.</p><a name="ike-tbl-1"></a><h6>Table&nbsp;24-1 Correspondences Between <tt>ikecert</tt> Options and <tt>ike/config</tt> Entries</h6><table><col width="24.80*"><col width="28.80*"><col width="45.41*"><tr><th align="left" valign="top" scope="column"><p><tt>ikecert</tt> Option</p></th>
<th align="left" valign="top" scope="column"><p><tt>ike/config</tt> Entry</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><a name="indexterm-2250"></a><a name="indexterm-2251"></a><tt>-A</tt> <i>subject-alternate-name</i></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-2252"></a><tt>cert_trust</tt> <i>subject-alternate-name</i></p></td>
<td align="left" valign="top" scope="row"><p>A
nickname that uniquely identifies the certificate. Possible values are an IP address, an
email address, or a domain name.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><a name="indexterm-2253"></a><tt>-D</tt> <i>X.509-distinguished-name</i></p></td>
<td align="left" valign="top" scope="row"><p><i>X.509-distinguished-name</i></p></td>
<td align="left" valign="top" scope="row"><p>The full name of the certificate
authority that includes the country (C), organization name (ON), organizational unit (OU), and
common name (CN).</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><a name="indexterm-2254"></a><a name="indexterm-2255"></a><tt>-t dsa-sha1</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-2256"></a><a name="indexterm-2257"></a><a name="indexterm-2258"></a><tt>auth_method dss_sig</tt></p></td>
<td align="left" valign="top" scope="row"><p>An authentication method that is slightly slower than <a href="glossary-1.html#glossary-59">RSA</a>.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>-t rsa-md5</tt> and</p><p><tt>-t rsa-sha1</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>auth_method rsa_sig</tt></p></td>
<td align="left" valign="top" scope="row"><p>An
authentication method that is slightly faster than <a href="glossary-1.html#glossary-45">DSA</a>.</p><p>The RSA public key must
be large enough to encrypt the biggest <a href="glossary-1.html#glossary-122">payload</a>. Typically, an identity payload, such
as the X.509 distinguished name, is the biggest payload.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>-t rsa-md5</tt> and</p><p><tt>-t rsa-sha1</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-2259"></a><a name="indexterm-2260"></a><tt>auth_method rsa_encrypt</tt></p></td>
<td align="left" valign="top" scope="row"><p>RSA encryption hides
identities in IKE from eavesdroppers, but requires that the IKE peers know each
other's public keys.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><a name="indexterm-2261"></a><a name="indexterm-2262"></a><tt>-T</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-2263"></a><a name="indexterm-2264"></a><a name="indexterm-2265"></a><a name="indexterm-2266"></a><tt>pkcs11_path</tt></p></td>
<td align="left" valign="top" scope="row"><p>The PKCS&nbsp;#11 library handles key acceleration on the Sun Crypto
Accelerator 1000 board and the Sun Crypto Accelerator 4000 board. The library also
provides the tokens that handle key storage on the Sun Crypto Accelerator 4000
board.</p></td>
</tr>
</table><p><a name="indexterm-2267"></a>If you issue a certificate request with the <tt>ikecert certlocal -kc</tt> command, you send
the output of the command to a PKI organization or to a certificate
authority (CA). If your company runs its own PKI, you send the output
to your PKI administrator. The PKI organization, the CA, or your PKI administrator
then creates certificates. The certificates that the PKI or CA returns to you
are input to the <tt>certdb</tt> subcommand. The certificate revocation list (CRL) that the
PKI returns to you is input for the <tt>certrldb</tt> subcommand.</p>

<a name="ike-18"></a><h4><tt>ikecert certdb</tt> Command</h4>
<p><a name="indexterm-2268"></a>The <tt>certdb</tt> subcommand manages the public key database. Options to this subcommand enable
you to add, view, and remove certificates and public keys. The command accepts,
as input, certificates that were generated by the <tt>ikecert certlocal -ks</tt> command on a remote
system. For the procedure, see <a href="ike-task-25.html#ike-task-42">How to Configure IKE With Self-Signed Public Key Certificates</a>. This command also accepts the certificate that you
receive from a PKI or CA as input.  For the procedure, see
<a href="ike-task-25.html#ike-task-41">How to Configure IKE With Certificates Signed by a CA</a>.</p><p><a name="indexterm-2269"></a><a name="indexterm-2270"></a><a name="indexterm-2271"></a><a name="indexterm-2272"></a><a name="indexterm-2273"></a><a name="indexterm-2274"></a><a name="indexterm-2275"></a><a name="indexterm-2276"></a><a name="indexterm-2277"></a>The certificates and public keys are stored on the system in the
<tt>/etc/inet/ike/publickeys</tt> directory. The <tt>-T</tt> option stores the certificates, private keys, and public keys
on attached hardware.</p>

<a name="ike-30"></a><h4><tt>ikecert certrldb</tt> Command</h4>
<p><a name="indexterm-2278"></a><a name="indexterm-2279"></a>The <tt>certrldb</tt> subcommand manages the certificate revocation list (CRL) database, <tt>/etc/inet/ike/crls</tt>. The CRL database
maintains the revocation lists for public keys. Certificates that are no longer valid
are on this list. When PKIs provide you with a CRL, you can
install the CRL in the CRL database with the <tt>ikecert certrldb</tt> command.  For
the procedure, see <a href="ike-task-25.html#ike-task-22">How to Handle a Certificate Revocation List</a>.</p>

<a name="ike-21"></a><h4><tt>/etc/inet/ike/publickeys</tt> Directory</h4>
<p><a name="indexterm-2280"></a><a name="indexterm-2281"></a><a name="indexterm-2282"></a><a name="indexterm-2283"></a><a name="indexterm-2284"></a><a name="indexterm-2285"></a><a name="indexterm-2286"></a>The <tt>/etc/inet/ike/publickeys</tt> directory contains the public part of a public-private key pair and
its certificate in files, or <b>slots</b>. The directory is protected at <tt>0755</tt>. The
<tt>ikecert certdb</tt> command populates the directory. The <tt>-T</tt> option stores the keys on the
Sun Crypto Accelerator 4000 board rather than in the <tt>publickeys</tt> directory.</p><p><a name="indexterm-2287"></a><a name="indexterm-2288"></a>The slots contain, in encoded form, the X.509 distinguished name of a certificate
that was generated on another system. If you are using self-signed certificates, you
use the certificate that you receive from the administrator of the remote system
as input to the command. If you are using certificates from a PKI,
you install two pieces of keying material from the PKI into this database.
You install a certificate that is based on material that you sent to
the PKI. You also install a CA from the PKI.</p>

<a name="ike-8"></a><h4><tt>/etc/inet/secret/ike.privatekeys</tt> Directory</h4>
<p><a name="indexterm-2289"></a><a name="indexterm-2290"></a><a name="indexterm-2291"></a><a name="indexterm-2292"></a><a name="indexterm-2293"></a><a name="indexterm-2294"></a>The <tt>/etc/inet/secret/ike.privatekeys</tt> directory holds private key files that are part of a public-private
key pair, which is keying material for ISAKMP SAs. The directory is protected
at <tt>0700</tt>. The <tt>ikecert certlocal</tt> command populates the <tt>ike.privatekeys</tt> directory. Private keys are not effective
until their public key counterparts, self-signed certificates or CAs, are installed. The public
key counterparts are stored in the <tt>/etc/inet/ike/publickeys</tt> directory or on a Sun
Crypto Accelerator 4000 board.</p>

<a name="ike-16"></a><h4><tt>/etc/inet/ike/crls</tt> Directory</h4>
<p><a name="indexterm-2295"></a><a name="indexterm-2296"></a><a name="indexterm-2297"></a><a name="indexterm-2298"></a><a name="indexterm-2299"></a>The <tt>/etc/inet/ike/crls</tt> directory contains certificate revocation list (CRL) files. Each file corresponds to a
public certificate file in the <tt>/etc/inet/ike/publickeys</tt> directory. PKI organizations provide the CRLs
for their certificates. You can use the <tt>ikecert certrldb</tt> command to populate the database.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ike-15.html">Previous</a>
             </td>
             <td align="right">
                 <a href="eupsq.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

