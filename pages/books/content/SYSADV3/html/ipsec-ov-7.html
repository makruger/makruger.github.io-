<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>IPsec Protection Mechanisms - System Administration Guide: IP Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: IP Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ipsec-ov-5.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ipsec-ov-12.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="iptm-1.html">Part&nbsp;I&nbsp;TCP/IP Administration</a></p>
<p class="toc level2"><a href="ipov-1.html">1.&nbsp;&nbsp;Solaris TCPIP Protocol Suite (Overview)</a></p>
<p class="toc level2"><a href="ipplan-1.html">2.&nbsp;&nbsp;Planning an IPv4 Addressing Scheme (Tasks</a></p>
<p class="toc level2"><a href="ipv6-overview-7.html">3.&nbsp;&nbsp;Planning an IPv6 Addressing Scheme (Overview)</a></p>
<p class="toc level2"><a href="ipv6-planning-1.html">4.&nbsp;&nbsp;Planning an IPv6 Network (Tasks)</a></p>
<p class="toc level2"><a href="ipconfig-1.html">5.&nbsp;&nbsp;Configuring TCP/IP Network Services and IPv4 Addressing (Tasks)</a></p>
<p class="toc level2"><a href="fwawf.html">6.&nbsp;&nbsp;Administering Network Interfaces (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-config-tasks-1.html">7.&nbsp;&nbsp;Enabling IPv6 on a Network (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-admintasks-1.html">8.&nbsp;&nbsp;Administering a TCP/IP Network (Tasks)</a></p>
<p class="toc level2"><a href="gegel.html">9.&nbsp;&nbsp;Troubleshooting Network Problems (Tasks)</a></p>
<p class="toc level2"><a href="ipref-8.html">10.&nbsp;&nbsp;TCP/IP and IPv4 in Depth (Reference)</a></p>
<p class="toc level2"><a href="ipv6-ref-76.html">11.&nbsp;&nbsp;IPv6 in Depth (Reference)</a></p>
<p class="toc level1 tocsp"><a href="dhcptm-1.html">Part&nbsp;II&nbsp;DHCP</a></p>
<p class="toc level2"><a href="dhcp-overview-1.html">12.&nbsp;&nbsp;About Solaris DHCP (Overview)</a></p>
<p class="toc level2"><a href="chap2-26.html">13.&nbsp;&nbsp;Planning for DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="chapter3-20.html">14.&nbsp;&nbsp;Configuring the DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="dhcp-admin-9.html">15.&nbsp;&nbsp;Administering DHCP (Tasks)</a></p>
<p class="toc level2"><a href="eyatl.html">16.&nbsp;&nbsp;Configuring and Administering  DHCP Clients</a></p>
<p class="toc level2"><a href="dhcp-trouble-1.html">17.&nbsp;&nbsp;Troubleshooting DHCP (Reference)</a></p>
<p class="toc level2"><a href="dhcp-ref-4.html">18.&nbsp;&nbsp;DHCP Commands and Files (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipsectm-1.html">Part&nbsp;III&nbsp;IP Security</a></p>
<p class="toc level2"><a href="ipsec-ov-1.html">19.&nbsp;&nbsp;IP Security Architecture (Overview)</a></p>
<p class="toc level3"><a href="ipsec-ov-25.html">What's New in IPsec?</a></p>
<p class="toc level3"><a href="ipsec-ov-2.html">Introduction to IPsec</a></p>
<p class="toc level3"><a href="ipsec-ov-54.html">IPsec Packet Flow</a></p>
<p class="toc level3"><a href="ipsec-ov-5.html">IPsec Security Associations</a></p>
<div class="onpage">
<p class="toc level3"><a href="">IPsec Protection Mechanisms</a></p>
</div>
<p class="toc level3"><a href="ipsec-ov-12.html">IPsec Protection Policies</a></p>
<p class="toc level3"><a href="ipsec-ov-13.html">Transport and Tunnel Modes in IPsec</a></p>
<p class="toc level3"><a href="ipsec-ov-15.html">Virtual Private Networks and IPsec</a></p>
<p class="toc level3"><a href="ipsec-ov-24.html">IPsec and NAT Traversal</a></p>
<p class="toc level3"><a href="ipsec-ov-22.html">IPsec and SCTP</a></p>
<p class="toc level3"><a href="ipsec-ov-18.html">IPsec and Solaris Zones</a></p>
<p class="toc level3"><a href="ipsec-ov-21.html">IPsec Utilities and Files</a></p>
<p class="toc level3"><a href="ipsec-ov-16.html">Changes to IPsec for the Solaris 10 Release</a></p>
<p class="toc level2 tocsp"><a href="ipsec-mgtasks-1.html">20.&nbsp;&nbsp;Configuring IPsec (Tasks)</a></p>
<p class="toc level2"><a href="ipsecref-1.html">21.&nbsp;&nbsp;IP Security Architecture (Reference)</a></p>
<p class="toc level2"><a href="ike-1.html">22.&nbsp;&nbsp;Internet Key Exchange (Overview)</a></p>
<p class="toc level2"><a href="ike-task-1.html">23.&nbsp;&nbsp;Configuring IKE (Tasks)</a></p>
<p class="toc level2"><a href="ikeref-1.html">24.&nbsp;&nbsp;Internet Key Exchange (Reference)</a></p>
<p class="toc level2"><a href="eupsq.html">25.&nbsp;&nbsp;Solaris IP Filter (Overview)</a></p>
<p class="toc level2"><a href="ipfilter-admin-1.html">26.&nbsp;&nbsp;Solaris IP Filter (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="miptm-1.html">Part&nbsp;IV&nbsp;Mobile IP</a></p>
<p class="toc level2"><a href="mipoverview-1.html">27.&nbsp;&nbsp;Mobile IP (Overview)</a></p>
<p class="toc level2"><a href="mipimplementing-1.html">28.&nbsp;&nbsp;Administering Mobile IP (Tasks)</a></p>
<p class="toc level2"><a href="mipmanaging-22.html">29.&nbsp;&nbsp;Mobile IP Files and Commands (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipmptm-1.html">Part&nbsp;V&nbsp;IPMP</a></p>
<p class="toc level2"><a href="mpoverview.html">30.&nbsp;&nbsp;Introducing IPMP (Overview)</a></p>
<p class="toc level2"><a href="deploynetmult-56.html">31.&nbsp;&nbsp;Administering IPMP (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ipqostm-1.html">Part&nbsp;VI&nbsp;IP Quality of Service (IPQoS)</a></p>
<p class="toc level2"><a href="ipqos-intro-1.html">32.&nbsp;&nbsp;Introducing IPQoS (Overview)</a></p>
<p class="toc level2"><a href="ipqos-config-planning-1.html">33.&nbsp;&nbsp;Planning for an IPQoS-Enabled Network (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-policy-planning-1.html">34.&nbsp;&nbsp;Creating the IPQoS Configuration File (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-isp-setup-1.html">35.&nbsp;&nbsp;Starting and Maintaining IPQoS (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-accounting-1.html">36.&nbsp;&nbsp;Using Flow Accounting and Statistics Gathering (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-reference-1.html">37.&nbsp;&nbsp;IPQoS in Detail (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="ipsec-ov-7"></a><h3>IPsec Protection Mechanisms</h3>
<a name="indexterm-1647"></a><a name="indexterm-1648"></a><a name="indexterm-1649"></a><a name="indexterm-1650"></a><a name="indexterm-1651"></a><a name="indexterm-1652"></a><p><a name="indexterm-1653"></a>IPsec provides two security protocols for protecting data:</p>
<ul><li><p>Authentication Header (AH)</p></li>
<li><p>Encapsulating Security Payload (ESP)</p></li></ul>
<p>An AH protects data with an authentication algorithm. An ESP protects data with
an encryption algorithm. Optionally, an ESP protects data with an authentication algorithm. Each
implementation of an algorithm is called a <b>mechanism</b>.</p>

<a name="ipsec-ov-27"></a><h4>Authentication Header</h4>
<a name="indexterm-1654"></a><a name="indexterm-1655"></a><p>The <a href="glossary-1.html#glossary-34">authentication header</a> provides data authentication, strong integrity, and replay protection to IP datagrams. AH
protects the greater part of the IP datagram. As the following illustration shows,
AH is inserted between the IP header and the transport header.</p><img src="figures/IPsecHdr3.gif" alt="Diagram shows the AH header between the IP header and the TCP header."></img><p>The transport header can be TCP, UDP, SCTP, or ICMP. If a
<a href="glossary-1.html#glossary-95">tunnel</a> is being used, the transport header can be another IP header.</p>

<a name="ipsec-ov-8"></a><h4>Encapsulating Security Payload</h4>
<a name="indexterm-1656"></a><a name="indexterm-1657"></a><a name="indexterm-1658"></a><p>The <a href="glossary-1.html#glossary-35">encapsulating security payload (ESP)</a> module provides confidentiality over what the ESP encapsulates. ESP also provides the
services that AH provides. However, ESP only provides its protections over the part
of the datagram that ESP encapsulates. The authentication services of ESP are optional.
These services enable you to use ESP and AH together on the same
datagram without redundancy. Because ESP uses encryption-enabling technology, ESP must conform to U.S.
export control laws.</p><p><a name="indexterm-1659"></a><a name="indexterm-1660"></a>ESP encapsulates its data, so ESP only protects the data that follows its
beginning in the datagram, as shown in the following illustration.</p><img src="figures/IPsecHdr2.gif" alt="Diagram shows the ESP header between the IP header and the TCP header. The TCP header is encrypted by the ESP header."></img><p>In a TCP packet, ESP encapsulates only the TCP header and its
data. If the packet is an IP-in-IP datagram, ESP protects the inner IP
datagram. Per-socket policy allows <b>self-encapsulation</b>, so ESP can encapsulate IP options when ESP needs
to.</p><p>If self-encapsulation is set, a copy of the IP header is made to
construct an IP-in-IP datagram. For example, when self-encapsulation is not set on a
TCP socket, the datagram is sent in the following format:</p><pre>[ IP(a -> b) <i>options</i> + TCP + data ]</pre><p>When self-encapsulation is set on that TCP socket, the datagram is sent in
the following format:</p><pre>[ IP(a -> b) + ESP [ IP(a -> b) <i>options</i> + TCP + data ] ]</pre><p>For further discussion, see <a href="ipsec-ov-13.html">Transport and Tunnel Modes in IPsec</a>.</p>

<a name="ipsec-ov-10"></a><h5>Security Considerations When Using AH and ESP</h5>
<p><a name="indexterm-1661"></a><a name="indexterm-1662"></a><a name="indexterm-1663"></a><a name="indexterm-1664"></a><a name="indexterm-1665"></a><a name="indexterm-1666"></a>The following table compares the protections that are provided by AH and ESP.</p><a name="ipsec-ov-tbl-5"></a><h6>Table&nbsp;19-2 Protections Provided by AH and ESP in IPsec</h6><table><col width="12.07*"><col width="35.24*"><col width="61.36*"><col width="30.33*"><tr><th align="left" valign="top" scope="column"><p>Protocol</p></th>
<th align="left" valign="top" scope="column"><p>Packet
Coverage</p></th>
<th align="left" valign="top" scope="column"><p>Protection</p></th>
<th align="left" valign="top" scope="column"><p>Against Attacks</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>AH</p></td>
<td align="left" valign="top" scope="row"><p>Protects packet from the IP header to the transport header</p></td>
<td align="left" valign="top" scope="row"><p>Provides strong
integrity, data authentication:</p>
<ul><li><p>Ensures that the receiver receives exactly what the sender sent</p></li>
<li><p>Is susceptible to replay attacks when an AH does not enable replay protection</p></li></ul>
</td>
<td align="left" valign="top" scope="row"><p>Replay, cut-and-paste</p></td>
</tr>
<tr><td rowspan="3" align="left" valign="top" scope="row"><p>ESP</p></td>
<td rowspan="3" align="left" valign="top" scope="row"><p>Protects packet following the beginning of ESP in the
datagram.</p></td>
<td align="left" valign="top" scope="row"><p>With encryption option, encrypts the IP datagram. Ensures confidentiality</p></td>
<td align="left" valign="top" scope="row"><p>Eavesdropping</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>With authentication option, provides
the same protection as AH</p></td>
<td align="left" valign="top" scope="row"><p>Replay, cut-and-paste</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>With both options, provides strong integrity, data
authentication, and confidentiality</p></td>
<td align="left" valign="top" scope="row"><p>Replay, cut-and-paste, eavesdropping</p></td>
</tr>
</table>

<a name="ipsec-ov-11"></a><h4>Authentication and Encryption Algorithms in IPsec</h4>
<p><a name="indexterm-1667"></a>IPsec security protocols use two types of algorithms, authentication and encryption. The AH
module uses authentication algorithms. The ESP module can use encryption as well as
authentication algorithms. You can obtain a list of the algorithms on your system
and their properties by using the <tt>ipsecalgs</tt> command. For more information, see
the <a href="http://docs.sun.com/doc/819-2240/ipsecalgs-1m?a=view"><tt>ipsecalgs</tt>(1M)</a> man page. You can also use the functions that are described
in the <a href="http://docs.sun.com/doc/819-2244/getipsecalgbyname-3nsl?a=view"><tt>getipsecalgbyname</tt>(3NSL)</a> man page to retrieve the properties of algorithms.</p><p>IPsec on a Solaris system uses the Solaris cryptographic framework to access the
algorithms. The framework provides a central repository for algorithms, in addition to other
services. The framework enables IPsec to take advantage of high performance cryptographic hardware
accelerators. The framework also provides resource control features. For example, the framework enables
you to limit the amount of CPU time spent in cryptographic operations in
the kernel. For more information, see the following:</p>
<ul><li><p><a href="http://docs.sun.com/doc/819-3321/scf-1?a=view">Chapter 12, Solaris Cryptographic Framework (Overview), in <i>System Administration Guide: Security Services</i></a></p></li>
<li><p><a href="http://docs.sun.com/doc/819-2145/chapter1-1?a=view">Chapter 8, Introduction to the Solaris Cryptographic Framework, in <i>Solaris Security for Developers Guide</i></a></p></li></ul>


<a name="ipsec-ov-19"></a><h5>Authentication Algorithms in IPsec</h5>
<p><a name="indexterm-1668"></a><a name="indexterm-1669"></a><a name="indexterm-1670"></a>Authentication algorithms produce an integrity checksum value or <b>digest</b> that is based on
the data and a key. The AH module uses authentication algorithms. The ESP
module can use authentication algorithms as well.</p>

<a name="ipsec-ov-20"></a><h5>Encryption Algorithms in IPsec</h5>
<p><a name="indexterm-1671"></a><a name="indexterm-1672"></a><a name="indexterm-1673"></a><a name="indexterm-1674"></a><a name="indexterm-1675"></a><a name="indexterm-1676"></a><a name="indexterm-1677"></a><a name="indexterm-1678"></a><a name="indexterm-1679"></a><a name="indexterm-1680"></a>Encryption algorithms encrypt data with a key. The ESP module in IPsec uses
encryption algorithms. The algorithms operate on data in units of a <b>block size</b>. By
default, the <a href="glossary-1.html#glossary-37">DES</a>-CBC, 3DES-CBC, AES-CBC, and Blowfish-CBC algorithms are installed. The key sizes
that are supported by the AES-CBC and Blowfish-CBC algorithms are limited to 128
bits.</p><p>AES-CBC and Blowfish-CBC algorithms that support key sizes that are greater than 128
bits are available to IPsec when you install the Solaris Encryption Kit. However,
not all encryption algorithms are available outside of the United States. The kit
is available on a separate CD that is <b>not</b> part of the Solaris
10 installation box. The <i>Solaris 10 Encryption Kit Installation Guide</i> describes how to install the kit. For more information,
see the <a href="http://www.sun.com/download">Sun Downloads</a> web site. To download the kit, click the Downloads A-Z
tab, then click the letter S. The Solaris 10 Encryption Kit is
among the first twenty entries.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ipsec-ov-5.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ipsec-ov-12.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

