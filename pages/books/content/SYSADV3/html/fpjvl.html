<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Administering Link Aggregations - System Administration Guide: IP Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: IP Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="fpjve.html">Previous</a>
             </td>
             <td align="right">
                 <a href="gduew.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="iptm-1.html">Part&nbsp;I&nbsp;TCP/IP Administration</a></p>
<p class="toc level2"><a href="ipov-1.html">1.&nbsp;&nbsp;Solaris TCPIP Protocol Suite (Overview)</a></p>
<p class="toc level2"><a href="ipplan-1.html">2.&nbsp;&nbsp;Planning an IPv4 Addressing Scheme (Tasks</a></p>
<p class="toc level2"><a href="ipv6-overview-7.html">3.&nbsp;&nbsp;Planning an IPv6 Addressing Scheme (Overview)</a></p>
<p class="toc level2"><a href="ipv6-planning-1.html">4.&nbsp;&nbsp;Planning an IPv6 Network (Tasks)</a></p>
<p class="toc level2"><a href="ipconfig-1.html">5.&nbsp;&nbsp;Configuring TCP/IP Network Services and IPv4 Addressing (Tasks)</a></p>
<p class="toc level2"><a href="fwawf.html">6.&nbsp;&nbsp;Administering Network Interfaces (Tasks)</a></p>
<p class="toc level3"><a href="fpdih.html">Interface Administration (Task Map)</a></p>
<p class="toc level3"><a href="fpcwh.html">Basics for Administering Physical Interfaces</a></p>
<p class="toc level3"><a href="fpcso.html">Administering Individual Network Interfaces</a></p>
<p class="toc level4"><a href="fpcso.html#fpdik">How to Obtain Interface Status</a></p>
<p class="toc level4"><a href="fpcso.html#fpdcn">How to Configure a Physical Interface After System Installation</a></p>
<p class="toc level4"><a href="fpcso.html#fpcvg">How to Remove a Physical Interface</a></p>
<p class="toc level4"><a href="fpcso.html#eyprp">SPARC: How to Ensure That the MAC Address of an Interface Is Unique</a></p>
<p class="toc level3 tocsp"><a href="fpjve.html">Administering Virtual Local Area Networks</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Administering Link Aggregations</a></p>
<p class="toc level4"><a href="#gafxi">How to Create a Link Aggregation</a></p>
<p class="toc level4"><a href="#gafxe">How to Modify an Aggregation</a></p>
<p class="toc level4"><a href="#gaxdg">How to Remove an Interface From an Aggregation</a></p>
<p class="toc level4"><a href="#galsb">How to Delete an Aggregation</a></p>
</div>
<p class="toc level3 tocsp"><a href="gduew.html">Configuring and Communicating Over WiFi Interfaces</a></p>
<p class="toc level4"><a href="gduew.html#gdwra">How to Connect to a WiFi Network</a></p>
<p class="toc level4"><a href="gduew.html#gdwrw">How to Monitor the WiFi Link</a></p>
<p class="toc level2 tocsp"><a href="ipv6-config-tasks-1.html">7.&nbsp;&nbsp;Enabling IPv6 on a Network (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-admintasks-1.html">8.&nbsp;&nbsp;Administering a TCP/IP Network (Tasks)</a></p>
<p class="toc level2"><a href="gegel.html">9.&nbsp;&nbsp;Troubleshooting Network Problems (Tasks)</a></p>
<p class="toc level2"><a href="ipref-8.html">10.&nbsp;&nbsp;TCP/IP and IPv4 in Depth (Reference)</a></p>
<p class="toc level2"><a href="ipv6-ref-76.html">11.&nbsp;&nbsp;IPv6 in Depth (Reference)</a></p>
<p class="toc level1 tocsp"><a href="dhcptm-1.html">Part&nbsp;II&nbsp;DHCP</a></p>
<p class="toc level2"><a href="dhcp-overview-1.html">12.&nbsp;&nbsp;About Solaris DHCP (Overview)</a></p>
<p class="toc level2"><a href="chap2-26.html">13.&nbsp;&nbsp;Planning for DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="chapter3-20.html">14.&nbsp;&nbsp;Configuring the DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="dhcp-admin-9.html">15.&nbsp;&nbsp;Administering DHCP (Tasks)</a></p>
<p class="toc level2"><a href="eyatl.html">16.&nbsp;&nbsp;Configuring and Administering  DHCP Clients</a></p>
<p class="toc level2"><a href="dhcp-trouble-1.html">17.&nbsp;&nbsp;Troubleshooting DHCP (Reference)</a></p>
<p class="toc level2"><a href="dhcp-ref-4.html">18.&nbsp;&nbsp;DHCP Commands and Files (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipsectm-1.html">Part&nbsp;III&nbsp;IP Security</a></p>
<p class="toc level2"><a href="ipsec-ov-1.html">19.&nbsp;&nbsp;IP Security Architecture (Overview)</a></p>
<p class="toc level2"><a href="ipsec-mgtasks-1.html">20.&nbsp;&nbsp;Configuring IPsec (Tasks)</a></p>
<p class="toc level2"><a href="ipsecref-1.html">21.&nbsp;&nbsp;IP Security Architecture (Reference)</a></p>
<p class="toc level2"><a href="ike-1.html">22.&nbsp;&nbsp;Internet Key Exchange (Overview)</a></p>
<p class="toc level2"><a href="ike-task-1.html">23.&nbsp;&nbsp;Configuring IKE (Tasks)</a></p>
<p class="toc level2"><a href="ikeref-1.html">24.&nbsp;&nbsp;Internet Key Exchange (Reference)</a></p>
<p class="toc level2"><a href="eupsq.html">25.&nbsp;&nbsp;Solaris IP Filter (Overview)</a></p>
<p class="toc level2"><a href="ipfilter-admin-1.html">26.&nbsp;&nbsp;Solaris IP Filter (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="miptm-1.html">Part&nbsp;IV&nbsp;Mobile IP</a></p>
<p class="toc level2"><a href="mipoverview-1.html">27.&nbsp;&nbsp;Mobile IP (Overview)</a></p>
<p class="toc level2"><a href="mipimplementing-1.html">28.&nbsp;&nbsp;Administering Mobile IP (Tasks)</a></p>
<p class="toc level2"><a href="mipmanaging-22.html">29.&nbsp;&nbsp;Mobile IP Files and Commands (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipmptm-1.html">Part&nbsp;V&nbsp;IPMP</a></p>
<p class="toc level2"><a href="mpoverview.html">30.&nbsp;&nbsp;Introducing IPMP (Overview)</a></p>
<p class="toc level2"><a href="deploynetmult-56.html">31.&nbsp;&nbsp;Administering IPMP (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ipqostm-1.html">Part&nbsp;VI&nbsp;IP Quality of Service (IPQoS)</a></p>
<p class="toc level2"><a href="ipqos-intro-1.html">32.&nbsp;&nbsp;Introducing IPQoS (Overview)</a></p>
<p class="toc level2"><a href="ipqos-config-planning-1.html">33.&nbsp;&nbsp;Planning for an IPQoS-Enabled Network (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-policy-planning-1.html">34.&nbsp;&nbsp;Creating the IPQoS Configuration File (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-isp-setup-1.html">35.&nbsp;&nbsp;Starting and Maintaining IPQoS (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-accounting-1.html">36.&nbsp;&nbsp;Using Flow Accounting and Statistics Gathering (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-reference-1.html">37.&nbsp;&nbsp;IPQoS in Detail (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="fpjvl"></a><h3>Administering Link Aggregations</h3>
<a name="indexterm-660"></a><a name="indexterm-661"></a><a name="indexterm-662"></a><p><a name="indexterm-663"></a>The Solaris OS supports the organization of network interfaces into link aggregations. A
<b>link aggregation</b> consists of several interfaces on a system that are configured together as
a single, logical unit. Link aggregation, also referred to as <b>trunking</b>, is defined in
the <a href="www.ieee802.org/3/index.html">IEEE 802.3ad Link Aggregation Standard</a>. </p><p>The IEEE 802.3ad Link Aggregation Standard provides a method to combine the capacity
of multiple full-duplex Ethernet links into a single logical link. This link aggregation
group is then treated as though it were, in fact, a single link.
</p><p>The following are features of link aggregations:<a name="indexterm-664"></a></p>
<ul><li><p><b>Increased bandwidth</b> &ndash; The capacity of multiple links is combined into one logical link.</p></li>
<li><p><b>Automatic failover/failback</b> &ndash; Traffic from a failed link is failed over to working links in the aggregation.</p></li>
<li><p><b>Load balancing</b> &ndash; Both inbound and outbound traffic is distributed according to user selected load balancing policies, such as source and destination MAC or IP addresses.</p></li>
<li><p><b>Support for redundancy</b> &ndash; Two systems can be configured with parallel aggregations.</p></li>
<li><p><b>Improved administration</b> &ndash; All interfaces are administered as a single unit.</p></li>
<li><p><b>Less drain on the network address pool</b> &ndash; The entire aggregation is assigned one IP address.</p></li></ul>


<a name="gafjy"></a><h4>Link Aggregation Basics</h4>
<p>The basic link aggregation topology involves a single aggregation that is composed of
a set of physical interfaces. You might use the basic link aggregation in
the following situations:</p>
<ul><li><p>For systems that run an application with distributed heavy traffic, you can dedicate an aggregation to that application's traffic.</p></li>
<li><p>For sites with limited IP address space that nevertheless require large amounts of bandwidth, you need only one IP address for a large aggregation of interfaces. </p></li>
<li><p>For sites that need to hide the existence of internal interfaces, the IP address of the aggregation hides its interfaces from external applications.</p></li></ul>
<p><a href="#gatnz">Figure&nbsp;6-3</a> shows an aggregation for a server that hosts a popular web site.
The site requires increased bandwidth for query traffic between Internet customers and the
site's database server. For security purposes, the existence of the individual interfaces on
the server must be hidden from external applications. The solution is the aggregation
<tt>aggr1</tt> with the IP address <tt>192.168.50.32</tt>. This aggregation consists of three interfaces,<tt>bge0&ndash;2</tt>. These interfaces
are dedicated to sending out traffic in response to customer queries. The outgoing
address on packet traffic from all the interfaces is the IP address of
<tt>aggr1</tt>, <tt>192.168.50.32</tt>.<a name="indexterm-665"></a></p><a name="gatnz"></a><h6>Figure&nbsp;6-3 Basic Link Aggregation Topology</h6><img src="figures/virtualLinkAg.gif" alt="The figure shows a block for the link aggr1. Three physical interfaces, bge0&ndash;bge2, descend from the link block."></img><p><a name="indexterm-666"></a><a href="#gatog">Figure&nbsp;6-4</a> depicts a local network with two systems, each of which has an
aggregation configured. The two systems are connected by a switch. If you need
to run an aggregation through a switch, that switch must support aggregation technology.
This type of configuration is particularly useful for high availability and redundant systems.</p><p>In the figure, System A has an aggregation that consists of two
interfaces, <tt>bge0</tt> and <tt>bge1</tt>. These interfaces are connected to the switch through aggregated
ports. System B has an aggregation of four interfaces, <tt>e1000g0</tt> through<tt>e100g3</tt>. These interfaces are
also connected to aggregated ports on the switch.</p><a name="gatog"></a><h6>Figure&nbsp;6-4 Aggregation Topology With Switch</h6><a name="indexterm-667"></a><img src="figures/backToBackLinkAg.gif" alt="The figure is explained in the preceding context."></img>

<a name="gafjl"></a><h4>Back-to-Back Link Aggregations</h4>
<p>The back-to-back link aggregation topology involves two separate systems that are cabled directly
to each other, as shown in the following figure. The systems run parallel
aggregations. </p><a name="gazxe"></a><h6>Figure&nbsp;6-5 Basic Back-to-Back Aggregation Topology</h6><a name="indexterm-668"></a><img src="figures/BasicB2bAg.gif" alt="The figure is explained in the following context."></img><p>In this example, device <tt>bge0</tt> on System A is directly linked to <tt>bge0</tt>
on System B, and so on. In this way, Systems A and B
can support redundancy and high availability, as well as high-speed communications between both
servers. Each server also has interface <tt>ce0</tt> configured for traffic flow with the
local network.</p><p>The most common application for back-to-back aggregations is mirrored database servers. Both servers
need to be updated together and therefore require significant bandwidth, high-speed traffic flow,
and reliability. Data centers are the most common users of back-to-back link aggregations.</p>

<a name="gafwr"></a><h4>Policies and Load Balancing</h4>
<a name="indexterm-669"></a><a name="indexterm-670"></a><a name="indexterm-671"></a><p>If you plan to use a link aggregation, consider defining a policy
for outgoing traffic. This policy specifies how you want packets to be distributed across
the available links of an aggregation, thus establishing load balancing. The following are
the possible layer specifiers and their significance for the aggregation policy:</p>
<ul><li><p><b>L2</b> - Determines the outgoing link by hashing the MAC (L2) header of each packet</p></li>
<li><p><b>L3</b> - Determines the outgoing link by hashing the IP (L3) header of each packet</p></li>
<li><p><b>L4</b> - Determines the outgoing link by hashing the TCP, UDP, or other ULP (L4) header of each packet</p></li></ul>
<p>Any combination of these policies is also valid. The default policy is L4.
For more information, refer to the <tt>dladm</tt>(1M) man page.</p>

<a name="gaiam"></a><h4>Aggregation Mode and Switches</h4>
<a name="indexterm-672"></a><a name="indexterm-673"></a><p>If your aggregation topology involves connection through a switch, you must note whether
the switch supports <b>link aggregation control protocol (LACP)</b>. If the switch supports LACP, you must configure
LACP for the switch and the aggregation. However, you can define one of
the following <b>modes</b> in which LACP is to operate:</p>
<ul><li><p><b>Off mode</b> &ndash; The default mode for aggregations. LACP packets, which are called <b>LACPDUs</b> are not generated.</p></li>
<li><p><b>Active mode</b> &ndash; The system generates <tt>LACPDU</tt>s at regular intervals, which you can specify.</p></li>
<li><p><b>Passive mode</b> &ndash; The system generates an <tt>LACPDU</tt> only when it receives an <tt>LACPDU</tt> from the switch. When both the aggregation and the switch are configured in passive mode, they cannot exchange <tt>LACPDU</tt>s.</p></li></ul>
<p>See the <tt>dladm</tt>(1M) man page and the switch manufacturer's documentation for syntax information.</p>

<a name="gafij"></a><h4>Requirements for Aggregations</h4>
<a name="indexterm-674"></a><p>Your aggregation configuration is bound by the following requirements:</p>
<ul><li><p>You must use the <tt>dladm</tt> command to configure aggregations. </p></li>
<li><p>An interface that has been plumbed cannot become a member of an aggregation.</p></li>
<li><p><a name="indexterm-675"></a>Interfaces must be of the GLDv3 type: <tt>xge</tt>, <tt>e1000g</tt>, and <tt>bge</tt>. </p></li>
<li><p>All interfaces in the aggregation must run at the same speed and in full duplex mode.</p></li>
<li><p>You must set the value for MAC addresses to &ldquo;true&rdquo; in the EEPROM parameter <tt>local-mac-address?</tt> For instructions, refer to <a href="fpcso.html#eyprp">SPARC: How to Ensure That the MAC Address of an Interface Is Unique</a>.</p></li>
<li><p>&ldquo;Legacy&rdquo; <b>data link provider interfaces (DLPI )</b>, such as the <tt>ce</tt> interface do not support Solaris link aggregations. Instead, you must configure aggregations for legacy devices by using Sun Trunking. You cannot configure aggregations for legacy devices by using the <tt>dladm</tt> command. For more information about Sun Trunking, refer to the <i>Sun Trunking 1.3 Installation and User's Guide.</i></p></li></ul>


<a name="gafxi"></a><h4>How to Create a Link Aggregation</h4><a name="indexterm-676"></a><a name="indexterm-677"></a><h6>Before You Begin</h6>
<hr><p><b>Note - </b>Link aggregation only works on full-duplex, point-to-point links that operate at identical speeds.
Make sure that the interfaces in your aggregation conform to this requirement.</p>
<hr>
<p>If you are using a switch in your aggregation topology, make sure
that you have done the following on the switch:</p>
<ul><li><p>Configured the ports to be used as an aggregation</p></li>
<li><p>If the switch supports LACP, configured LACP in either active mode or passive mode</p></li></ul>
<ol>
<li><b>Assume the Primary Administrator role, or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b>Determine which interfaces are currently installed on your system.</b><pre># <tt><b>dladm show-link</b></tt></pre></li>
<li><b>Determine which interfaces have been plumbed.</b><pre># <tt><b>ifconfig -a</b></tt></pre></li>
<li><b>Create an aggregation.<a name="indexterm-678"></a></b><pre># <tt><b>dladm create-aggr -d </tt><i>interface</i><tt> </tt><i>key</i><tt></b></tt></pre><dl><dt><i>interface</i></dt>
<dd><p>Represents the device name of the interface to become part of the aggregation.</p></dd>
<dt><i>key</i></dt>
<dd><p>Is the number that identifies the aggregation. The lowest key number is 1. Zeroes are not allowed as keys.</p></dd>
</dl>
<p>For example:</p><pre># <tt><b>dladm create-aggr -d bge0 -d bge1 1</b></tt></pre></li>
<li><b>Configure and plumb the newly created aggregation.</b><pre># <tt><b>ifconfig aggr</b></tt><i>key</i> <tt><b>plumb</b></tt> <i>IP-address</i> <tt><b>up</b></tt></pre><p>For example:</p><pre># <tt><b>ifconfig aggr1 plumb 192.168.84.14 up</b></tt></pre></li>
<li><b>Check the status of the aggregation you just created.<a name="indexterm-679"></a></b><pre># <tt><b>dladm show-aggr</b></tt></pre><p>You receive the following output:</p><pre>key: 1 (0x0001) policy: L4      address: 0:3:ba:7:84:5e (auto)
           device   address           speed         duplex  link    state
           bge0     0:3:ba:7:84:5e    1000  Mbps    full    up      attached
           bge1     0:3:ba:7:84:5e    0     Mbps    unknown down    standby</pre><p>The output shows that an aggregation with the key of 1 and
a policy of L4 was created. Note that the interfaces are known by
the MAC address <tt>0:3:ba:7:84:5e</tt>, which is the system MAC address.</p></li>
<li><b>(Optional) Make the IP configuration of the link aggregation persist across reboots.</b><ol style="list-style-type: lower-alpha">
				 
<li><b>For link aggregations with IPv4 addresses, create an <tt>/etc/hostname.aggr.</tt><i>key</i> file. For IPv6&ndash;based
link aggregations, create an <tt>/etc/hostname6.aggr.</tt><i>key</i> file. </b></li>
<li><b>Enter the IPv4 or IPv6 address of the link aggregation into the file.</b><p>For example, you would create the following file for the aggregation that is
created in this procedure:</p><pre># <tt><b>vi /etc/hostname.aggr1</b></tt>
<tt><b>192.168.84.14</b></tt></pre></li>
<li><b>Perform a reconfiguration boot.</b><pre># <tt><b>reboot -- -r</b></tt></pre></li>
<li><b>Verify that the link aggregation configuration you entered in the <tt>/etc/hostname.aggr</tt><i>key</i> file has been
configured.</b><pre># <tt><b>ifconfig -a</b></tt>
.
.
aggr1: flags=1000843 &lt;UP,BROADCAST,RUNNING,MULTICAST,IPv4> mtu 1500 index 3
        inet 192.168.84.14 netmask ff000000 broadcast 192.255.255.</pre></li></ol></li></ol><a name="galii"></a>Example&nbsp;6-4 Creating a Link Aggregation<p>This example shows the commands that are used to create a link
aggregation with two devices, <tt>bge0</tt> and <tt>bge1</tt>, and the resulting output.</p><pre># <tt><b>dladm show-link</b></tt>
ce0             type: legacy    mtu: 1500       device: ce0
ce1             type: legacy    mtu: 1500       device: ce1
bge0            type: non-vlan  mtu: 1500       device: bge0
bge1            type: non-vlan  mtu: 1500       device: bge1
bge2            type: non-vlan  mtu: 1500       device: bge2
# <tt><b>ifconfig -a</b></tt>
lo0: flags=2001000849 &lt;UP,LOOPBACK,RUNNING,MULTICAST,IPv4,VIRTUAL> mtu 8232 index 1
        inet 127.0.0.1 netmask ff000000 
ce0: flags=1000843 &lt;UP,BROADCAST,RUNNING,MULTICAST,IPv4> mtu 1500 index 2
        inet 192.168.84.253 netmask ffffff00 broadcast 192.168.84.255
        ether 0:3:ba:7:84:5e 
# <tt><b>dladm create-aggr -d bge0 -d bge1 1</b></tt>
# <tt><b>ifconfig aggr1 plumb 192.168.84.14 up</b></tt>
# <tt><b>dladm show-aggr</b></tt>
key: 1 (0x0001) policy: L4      address: 0:3:ba:7:84:5e (auto)
     device   address           speed         duplex  link    state
     bge0     0:3:ba:7:84:5e    1000  Mbps    full    up      attached
     bge1     0:3:ba:7:84:5e    0     Mbps    unknown down    standby

# <tt><b>ifconfig -a</b></tt>
lo0: flags=2001000849 &lt;UP,LOOPBACK,RUNNING,MULTICAST,IPv4,VIRTUAL> mtu 8232 index 1
        inet 127.0.0.1 netmask ff000000 
ce0: flags=1000843 &lt;UP,BROADCAST,RUNNING,MULTICAST,IPv4> mtu 1500 index 2
        inet 192.168.84.253 netmask ffffff00 broadcast 192.168.84.255
        ether 0:3:ba:7:84:5e 
aggr1: flags=1000843 &lt;UP,BROADCAST,RUNNING,MULTICAST,IPv4> mtu 1500 index 3
        inet 192.168.84.14 netmask ff000000 broadcast 192.255.255.255
        ether 0:3:ba:7:84:5e </pre><p>Note that the two interfaces that were used for the aggregation were not
previously plumbed by <tt>ifconfig</tt>.</p>

<a name="gafxe"></a><h4>How to Modify an Aggregation</h4><a name="indexterm-680"></a><p>This procedure shows how to make the following changes to an aggregation definition:</p>
<ul><li><p>Modifying the policy for the aggregation</p></li>
<li><p>Changing the mode for the aggregation</p></li>
<li><p>Removing an interface from the aggregation</p></li></ul>
<ol>
<li><b>Assume the Primary Administrator role, or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b>Modify the aggregation to change the policy.<a name="indexterm-681"></a></b><pre># <tt><b>dladm modify-aggr -P</b></tt><i>policy key</i>   </pre><dl><dt><i>policy</i></dt>
<dd><p>Represents one or more of the policies L2, L3, and L4, as explained in <a href="#gafwr">Policies and Load Balancing</a>. </p></dd>
<dt><i>key</i></dt>
<dd><p>Is a number that identifies the aggregation. The lowest key number is 1. Zeroes are not allowed as keys.</p></dd>
</dl>
</li>
<li><b>If LACP is running on the switch to which the devices in
the aggregation are attached, modify the aggregation to support LACP.<a name="indexterm-682"></a><a name="indexterm-683"></a></b><p>If the switch runs LACP in passive mode, be sure to configure active
mode for your aggregation.</p><pre># <tt><b>dladm modify-aggr -l</b></tt> <i>LACP mode</i> <tt><b>-t</b></tt> <i>timer-value key</i></pre><dl><dt><tt>-l</tt> <i>LACP mode</i></dt>
<dd><p>Indicates the LACP mode in which the aggregation is to run. The values are <tt>active</tt>, <tt>passive</tt>, and <tt>off</tt>.</p></dd>
<dt><tt>-t</tt> <i>timer-value</i></dt>
<dd><p>Indicates the LACP timer value, either <tt>short</tt> or <tt>long</tt>.</p></dd>
<dt><i>key</i></dt>
<dd><p> Is a number that identifies the aggregation. The lowest key number is 1. Zeroes are not allowed as keys.</p></dd>
</dl>
</li></ol><a name="galre"></a>Example&nbsp;6-5 Modifying a Link Aggregation<p>This example shows how to modify the policy of aggregation <tt>aggr1</tt> to L2
and then turn on active LACP mode.</p><pre># <tt><b>dladm modify-aggr -P L2 1</b></tt>
# <tt><b>dladm modify-aggr -l active -t short 1</b></tt>
# <tt><b>dladm show-aggr</b></tt>
key: 1 (0x0001) policy: L2      address: 0:3:ba:7:84:5e (auto)
     device   address           speed         duplex  link    state
     bge0     0:3:ba:7:84:5e    1000  Mbps    full    up      attached
     bge1     0:3:ba:7:84:5e    0     Mbps    unknown down    standby</pre>

<a name="gaxdg"></a><h4>How to Remove an Interface From an Aggregation</h4><a name="indexterm-684"></a><ol>
<li><b>Assume the Primary Administrator role, or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b>Remove an interface from the aggregation.<a name="indexterm-685"></a></b><pre># <tt><b>dladm remove-aggr -d</b></tt> <i>interface</i></pre></li></ol><a name="galsm"></a>Example&nbsp;6-6 Removing Interfaces From an Aggregation<p>This example shows how to remove the interfaces of the aggregation <tt>aggr1</tt>.</p><pre># <tt><b>dladm show-aggr</b></tt>
key: 1 (0x0001) policy: L2      address: 0:3:ba:7:84:5e (auto)
     device   address           speed         duplex  link    state
     bge0     0:3:ba:7:84:5e    1000  Mbps    full    up      attached
     bge1     0:3:ba:7:84:5e    0     Mbps    unknown down    standby
# <tt><b>dladm remove-aggr -d bge1 1</b></tt>
# <tt><b>dladm show-aggr</b></tt>
key: 1 (0x0001) policy: L2      address: 0:3:ba:7:84:5e (auto)
     device    address           speed         duplex  link    state
     bge0      0:3:ba:7:84:5e    1000  Mbps    full    up      attached
          </pre>

<a name="galsb"></a><h4>How to Delete an Aggregation</h4><ol>
<li><b>Assume the Primary Administrator role, or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b>Delete the aggregation.</b><pre># <tt><b>dladm remove-aggr</b></tt> <i>key</i></pre><dl><dt><i>key</i></dt>
<dd><p>Is a number that identifies the aggregation. The lowest key number is 1. Zeroes are not allowed as keys.</p></dd>
</dl>
</li></ol><a name="gaxed"></a>Example&nbsp;6-7 How to Delete an Aggregation<p>This example shows how to remove the aggregation <tt>aggr1</tt>.</p><pre># <tt><b>dladm show-aggr</b></tt>
key: 1 (0x0001) policy: L2      address: 0:3:ba:7:84:5e (auto)
     device   address           speed     duplex  link    state
          # <tt><b>dladm remove-aggr -d bge0 1</b></tt></pre>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="fpjve.html">Previous</a>
             </td>
             <td align="right">
                 <a href="gduew.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

