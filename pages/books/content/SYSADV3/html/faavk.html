<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Working With Log Files for Solaris IP Filter - System Administration Guide: IP Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: IP Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="faaxo.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ipfilter-admin-2.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="iptm-1.html">Part&nbsp;I&nbsp;TCP/IP Administration</a></p>
<p class="toc level2"><a href="ipov-1.html">1.&nbsp;&nbsp;Solaris TCPIP Protocol Suite (Overview)</a></p>
<p class="toc level2"><a href="ipplan-1.html">2.&nbsp;&nbsp;Planning an IPv4 Addressing Scheme (Tasks</a></p>
<p class="toc level2"><a href="ipv6-overview-7.html">3.&nbsp;&nbsp;Planning an IPv6 Addressing Scheme (Overview)</a></p>
<p class="toc level2"><a href="ipv6-planning-1.html">4.&nbsp;&nbsp;Planning an IPv6 Network (Tasks)</a></p>
<p class="toc level2"><a href="ipconfig-1.html">5.&nbsp;&nbsp;Configuring TCP/IP Network Services and IPv4 Addressing (Tasks)</a></p>
<p class="toc level2"><a href="fwawf.html">6.&nbsp;&nbsp;Administering Network Interfaces (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-config-tasks-1.html">7.&nbsp;&nbsp;Enabling IPv6 on a Network (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-admintasks-1.html">8.&nbsp;&nbsp;Administering a TCP/IP Network (Tasks)</a></p>
<p class="toc level2"><a href="gegel.html">9.&nbsp;&nbsp;Troubleshooting Network Problems (Tasks)</a></p>
<p class="toc level2"><a href="ipref-8.html">10.&nbsp;&nbsp;TCP/IP and IPv4 in Depth (Reference)</a></p>
<p class="toc level2"><a href="ipv6-ref-76.html">11.&nbsp;&nbsp;IPv6 in Depth (Reference)</a></p>
<p class="toc level1 tocsp"><a href="dhcptm-1.html">Part&nbsp;II&nbsp;DHCP</a></p>
<p class="toc level2"><a href="dhcp-overview-1.html">12.&nbsp;&nbsp;About Solaris DHCP (Overview)</a></p>
<p class="toc level2"><a href="chap2-26.html">13.&nbsp;&nbsp;Planning for DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="chapter3-20.html">14.&nbsp;&nbsp;Configuring the DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="dhcp-admin-9.html">15.&nbsp;&nbsp;Administering DHCP (Tasks)</a></p>
<p class="toc level2"><a href="eyatl.html">16.&nbsp;&nbsp;Configuring and Administering  DHCP Clients</a></p>
<p class="toc level2"><a href="dhcp-trouble-1.html">17.&nbsp;&nbsp;Troubleshooting DHCP (Reference)</a></p>
<p class="toc level2"><a href="dhcp-ref-4.html">18.&nbsp;&nbsp;DHCP Commands and Files (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipsectm-1.html">Part&nbsp;III&nbsp;IP Security</a></p>
<p class="toc level2"><a href="ipsec-ov-1.html">19.&nbsp;&nbsp;IP Security Architecture (Overview)</a></p>
<p class="toc level2"><a href="ipsec-mgtasks-1.html">20.&nbsp;&nbsp;Configuring IPsec (Tasks)</a></p>
<p class="toc level2"><a href="ipsecref-1.html">21.&nbsp;&nbsp;IP Security Architecture (Reference)</a></p>
<p class="toc level2"><a href="ike-1.html">22.&nbsp;&nbsp;Internet Key Exchange (Overview)</a></p>
<p class="toc level2"><a href="ike-task-1.html">23.&nbsp;&nbsp;Configuring IKE (Tasks)</a></p>
<p class="toc level2"><a href="ikeref-1.html">24.&nbsp;&nbsp;Internet Key Exchange (Reference)</a></p>
<p class="toc level2"><a href="eupsq.html">25.&nbsp;&nbsp;Solaris IP Filter (Overview)</a></p>
<p class="toc level2"><a href="ipfilter-admin-1.html">26.&nbsp;&nbsp;Solaris IP Filter (Tasks)</a></p>
<p class="toc level3"><a href="etmhi.html">Configuring Solaris IP Filter</a></p>
<p class="toc level4"><a href="etmhi.html#gdwzk">How to Enable Solaris IP Filter</a></p>
<p class="toc level4"><a href="etmhi.html#eubbr">How to Re-Enable Solaris IP Filter</a></p>
<p class="toc level4"><a href="etmhi.html#gdwzr">How to Enable Loopback Filtering</a></p>
<p class="toc level3 tocsp"><a href="fabar.html">Deactivating and Disabling Solaris IP Filter</a></p>
<p class="toc level4"><a href="fabar.html#ettms">How to Deactivate Packet Filtering</a></p>
<p class="toc level4"><a href="fabar.html#ettmt">How to Deactivate NAT</a></p>
<p class="toc level4"><a href="fabar.html#ettmo">How to Disable Packet Filtering</a></p>
<p class="toc level3 tocsp"><a href="eubbd.html">Working With Solaris IP Filter Rule Sets</a></p>
<p class="toc level3"><a href="faaxo.html">Displaying Statistics and Information for Solaris IP Filter</a></p>
<p class="toc level4"><a href="faaxo.html#faapk">How to View State Tables for Solaris IP Filter</a></p>
<p class="toc level4"><a href="faaxo.html#faapx">How to View State Statistics for Solaris IP Filter</a></p>
<p class="toc level4"><a href="faaxo.html#faapy">How to View NAT Statistics for Solaris IP Filter</a></p>
<p class="toc level4"><a href="faaxo.html#faapz">How to View Address Pool Statistics for Solaris IP Filter</a></p>
<div class="onpage">
<p class="toc level3 tocsp"><a href="">Working With Log Files for Solaris IP Filter</a></p>
<p class="toc level4"><a href="#gdfwa">How to Set Up a Log File for Solaris IP Filter</a></p>
<p class="toc level4"><a href="#faaqc">How to View Solaris IP Filter Log Files</a></p>
<p class="toc level4"><a href="#faaqf">How to Flush the Packet Log File</a></p>
<p class="toc level4"><a href="#faard">How to Save Logged Packets to a File</a></p>
</div>
<p class="toc level3 tocsp"><a href="ipfilter-admin-2.html">Creating and Editing Solaris IP Filter Configuration Files</a></p>
<p class="toc level4"><a href="ipfilter-admin-2.html#fahpp">How to Create a Configuration File for Solaris IP Filter</a></p>
<p class="toc level1 tocsp"><a href="miptm-1.html">Part&nbsp;IV&nbsp;Mobile IP</a></p>
<p class="toc level2"><a href="mipoverview-1.html">27.&nbsp;&nbsp;Mobile IP (Overview)</a></p>
<p class="toc level2"><a href="mipimplementing-1.html">28.&nbsp;&nbsp;Administering Mobile IP (Tasks)</a></p>
<p class="toc level2"><a href="mipmanaging-22.html">29.&nbsp;&nbsp;Mobile IP Files and Commands (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipmptm-1.html">Part&nbsp;V&nbsp;IPMP</a></p>
<p class="toc level2"><a href="mpoverview.html">30.&nbsp;&nbsp;Introducing IPMP (Overview)</a></p>
<p class="toc level2"><a href="deploynetmult-56.html">31.&nbsp;&nbsp;Administering IPMP (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ipqostm-1.html">Part&nbsp;VI&nbsp;IP Quality of Service (IPQoS)</a></p>
<p class="toc level2"><a href="ipqos-intro-1.html">32.&nbsp;&nbsp;Introducing IPQoS (Overview)</a></p>
<p class="toc level2"><a href="ipqos-config-planning-1.html">33.&nbsp;&nbsp;Planning for an IPQoS-Enabled Network (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-policy-planning-1.html">34.&nbsp;&nbsp;Creating the IPQoS Configuration File (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-isp-setup-1.html">35.&nbsp;&nbsp;Starting and Maintaining IPQoS (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-accounting-1.html">36.&nbsp;&nbsp;Using Flow Accounting and Statistics Gathering (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-reference-1.html">37.&nbsp;&nbsp;IPQoS in Detail (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="faavk"></a><h3>Working With Log Files for Solaris IP Filter</h3>
<a name="faawy"></a><h6>Table&nbsp;26-5 Working With Solaris IP Filter Log Files (Task Map)</h6><table><col width="33*"><col width="33*"><col width="33*"><tr><th align="left" valign="top" scope="column"><p>Task</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>For Instructions</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Create a
log file.</p></td>
<td align="left" valign="top" scope="row"><p>Create a separate Solaris IP filter log file.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#gdfwa">How to Set Up a Log File for Solaris IP Filter</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>View log files.</p></td>
<td align="left" valign="top" scope="row"><p>View state,
NAT, and normal log files using the <tt>ipmon</tt> command.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#faaqc">How to View Solaris IP Filter Log Files</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Flush the packet log
buffer.</p></td>
<td align="left" valign="top" scope="row"><p>Remove the contents of the packet log buffer using the <tt>ipmon</tt> <tt>-F</tt>
command.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#faaqf">How to Flush the Packet Log File</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Save logged packets to a file.</p></td>
<td align="left" valign="top" scope="row"><p>Save logged packets to a file for
later reference.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#faard">How to Save Logged Packets to a File</a></p></td>
</tr>
</table>

<a name="gdfwa"></a><h4>How to Set Up a Log File for Solaris IP Filter</h4><a name="indexterm-2437"></a><a name="indexterm-2438"></a><p>By default, all log information for Solaris IP Filter is recorded in the
<tt>syslogd</tt> file. You should set up a log file to record Solaris IP
Filter traffic information separately from other data that might be logged in the
default log file. Perform the following steps.</p><ol>
<li><b>Assume a role that includes the IP Filter Management rights profile, or become
superuser.</b><p>You can assign the IP Filter Management rights profile to a role that
you create. To create the role and assign the role to a user,
see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><b>Edit the <tt>/etc/syslog.conf</tt> file by adding the following two lines:</b><pre># Save IPFilter log output to its own file 
local0.debug             /var/log/<i>log-name</i></pre>
<hr><p><b>Note - </b>On the second line, make sure to use the Tab key, not
the Spacebar, to separate <tt>local0.debug</tt> from <tt>/var/log/</tt><i>log-name</i><tt></tt>. </p>
<hr>
</li>
<li><b>Create the new log file.</b><pre># <tt><b>touch /var/log/</tt><i>log-name</i><tt></b></tt></pre></li>
<li><b>Restart the system-log service.</b><pre># <tt><b>svcadm restart system-log</b></tt></pre></li></ol><a name="gdgtw"></a>Example&nbsp;26-20 Creating a Solaris IP Filter Log<p>The following example shows how to create <tt>ipmon.log</tt> to archive IP filter information.</p><p>In <tt>/etc/syslog.conf</tt>:</p><pre># Save IPFilter log output to its own file 
local0.debug             /var/log/ipmon.log</pre><p>At the command line:</p><pre># <tt><b>touch /var/log/ipmon.log</b></tt>
# <tt><b>svcadm restart system-log</b></tt></pre>

<a name="faaqc"></a><h4>How to View Solaris IP Filter Log Files</h4><a name="indexterm-2439"></a><a name="indexterm-2440"></a><a name="indexterm-2441"></a><a name="indexterm-2442"></a><a name="indexterm-2443"></a><h6>Before You Begin</h6><p>You should create a separate log file to record Solaris IP Filter
data. Refer to <a href="#gdfwa">How to Set Up a Log File for Solaris IP Filter</a>.</p><ol>
<li><b>Assume a role that includes the IP Filter Management rights profile, or become
superuser.</b><p>You can assign the IP Filter Management rights profile to a role that
you create. To create the role and assign the role to a user,
see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><b>View the state, NAT, or normal log files. To view a log
file, type the following command, using the appropriate option:</b><pre># <tt><b>ipmon -o [S|N|I] </tt><i>filename</i><tt></b></tt></pre><dl><dt><tt>S</tt></dt>
<dd><p>Displays the state log file.</p></dd>
<dt><tt>N</tt></dt>
<dd><p>Displays the NAT log file.</p></dd>
<dt><tt>I</tt></dt>
<dd><p>Displays the normal IP log file.</p></dd>
</dl>
<p>To view all state, NAT, and normal log files, use all the
options:</p><pre># <tt><b>ipmon -o SNI </tt><i>filename</i><tt></b></tt></pre><ul>
<li><b>Provided that you have manually stopped the <tt>ipmon</tt> daemon first, you can also
use the following command to display state, NAT, and Solaris IP filter log
files:</b><pre># <tt><b>ipmon -a </tt><i>filename</i><tt></b></tt></pre>
<hr><p><b>Note - </b>Do not use the <tt>ipmon <tt>-a</tt></tt> syntax if the <tt>ipmon</tt> daemon is still running.
Normally, the daemon is automatically started during system boot. Issuing the <tt>ipmon <tt>-a</tt></tt> command
also opens another copy of <tt>ipmon</tt>. In such a case, both copies read
the same log information, and only one gets a particular log message.</p>
<hr>
</li></ul><p>For more information about viewing log files, see the <a href="http://docs.sun.com/doc/819-2240/ipmon-1m?a=view"><tt>ipmon</tt>(1M)</a> man page.</p></li></ol><a name="fapjl"></a>Example&nbsp;26-21 Viewing Solaris IP Filter Log Files<p>The following example shows the output from <tt>/var/ipmon.log</tt>.</p><pre># <tt><b>ipmon -o SNI /var/ipmon.log</b></tt>
02/09/2004 15:27:20.606626 hme0 @0:1 p 129.146.157.149 -> 
129.146.157.145 PR icmp len 20 84 icmp echo/0 IN</pre><p>or</p><pre># <tt><b>pkill ipmon</b></tt>
# <tt><b>ipmon -aD /var/ipmon.log</b></tt>
02/09/2004 15:27:20.606626 hme0 @0:1 p 129.146.157.149 -> 
129.146.157.145 PR icmp len 20 84 icmp echo/0 IN</pre>

<a name="faaqf"></a><h4>How to Flush the Packet Log File</h4><a name="indexterm-2444"></a><a name="indexterm-2445"></a><a name="indexterm-2446"></a><ol>
<li><b>Assume a role that includes the IP Filter Management rights profile, or become
superuser.</b><p>You can assign the IP Filter Management rights profile to a role that
you create. To create the role and assign the role to a user,
see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><b>Flush the pack log buffer.</b><pre># <tt><b>ipmon -F</b></tt></pre></li></ol><a name="fapix"></a>Example&nbsp;26-22 Flushing the Packet Log File<p>The following example shows the output when a log file is removed.
The system provides a report even when there is nothing stored in the
log file, as in this example.</p><pre># <tt><b>ipmon -F</b></tt>
0 bytes flushed from log buffer
0 bytes flushed from log buffer
0 bytes flushed from log buffer</pre>

<a name="faard"></a><h4>How to Save Logged Packets to a File</h4><a name="indexterm-2447"></a><a name="indexterm-2448"></a><ol>
<li><b>Assume a role that includes the IP Filter Management rights profile, or become
superuser.</b><p>You can assign the IP Filter Management rights profile to a role that
you create. To create the role and assign the role to a user,
see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><b>Save the logged packets to a file.</b><pre># <tt><b>cat /dev/ipl > </tt><i>filename</i><tt></b></tt></pre><p>Continue logging packets to the <i>filename</i> file until you interrupt the procedure by
typing <tt>Control-C</tt> to get the command line prompt back.</p></li></ol><a name="fapjn"></a>Example&nbsp;26-23 Saving Logged Packets to a File<p>The following example shows the result when logged packets are saved to a
file.</p><pre># <tt><b>cat /dev/ipl > /tmp/logfile</b></tt>
<tt><b>^C</b></tt>#

# <tt><b>ipmon -f /tmp/logfile</b></tt>
02/09/2004 15:30:28.708294 hme0 @0:1 p 129.146.157.149,33923 -> 
  129.146.157.145,23 PR tcp len 20 52 -S IN
02/09/2004 15:30:28.708708 hme0 @0:1 p 129.146.157.149,33923 -> 
  129.146.157.145,23 PR tcp len 20 40 -A IN
02/09/2004 15:30:28.792611 hme0 @0:1 p 129.146.157.149,33923 -> 
  129.146.157.145,23 PR tcp len 20 70 -AP IN
02/09/2004 15:30:28.872000 hme0 @0:1 p 129.146.157.149,33923 -> 
 129.146.157.145,23 PR tcp len 20 40 -A IN
02/09/2004 15:30:28.872142 hme0 @0:1 p 129.146.157.149,33923 -> 
  129.146.157.145,23 PR tcp len 20 43 -AP IN
02/09/2004 15:30:28.872808 hme0 @0:1 p 129.146.157.149,33923 -> 
  129.146.157.145,23 PR tcp len 20 40 -A IN
02/09/2004 15:30:28.872951 hme0 @0:1 p 129.146.157.149,33923 -> 
  129.146.157.145,23 PR tcp len 20 47 -AP IN
02/09/2004 15:30:28.926792 hme0 @0:1 p 129.146.157.149,33923 -> 
  129.146.157.145,23 PR tcp len 20 40 -A IN 
.
.
(output truncated)</pre>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="faaxo.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ipfilter-admin-2.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

