<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Configuring Tunnels for IPv6 Support - System Administration Guide: IP Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: IP Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ipv6-config-tasks-17.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ipv6-config-tasks-10.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="iptm-1.html">Part&nbsp;I&nbsp;TCP/IP Administration</a></p>
<p class="toc level2"><a href="ipov-1.html">1.&nbsp;&nbsp;Solaris TCPIP Protocol Suite (Overview)</a></p>
<p class="toc level2"><a href="ipplan-1.html">2.&nbsp;&nbsp;Planning an IPv4 Addressing Scheme (Tasks</a></p>
<p class="toc level2"><a href="ipv6-overview-7.html">3.&nbsp;&nbsp;Planning an IPv6 Addressing Scheme (Overview)</a></p>
<p class="toc level2"><a href="ipv6-planning-1.html">4.&nbsp;&nbsp;Planning an IPv6 Network (Tasks)</a></p>
<p class="toc level2"><a href="ipconfig-1.html">5.&nbsp;&nbsp;Configuring TCP/IP Network Services and IPv4 Addressing (Tasks)</a></p>
<p class="toc level2"><a href="fwawf.html">6.&nbsp;&nbsp;Administering Network Interfaces (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-config-tasks-1.html">7.&nbsp;&nbsp;Enabling IPv6 on a Network (Tasks)</a></p>
<p class="toc level3"><a href="ipv6-config-tasks-64.html">Configuring an IPv6 Interface</a></p>
<p class="toc level4"><a href="ipv6-config-tasks-64.html#ipv6-config-tasks-119">How to Enable an IPv6 Interface for the Current Session</a></p>
<p class="toc level4"><a href="ipv6-config-tasks-64.html#ipv6-config-tasks-28">How to Enable Persistent IPv6 Interfaces</a></p>
<p class="toc level4"><a href="ipv6-config-tasks-64.html#gbuzm">How to Turn Off IPv6 Address Autoconfiguration</a></p>
<p class="toc level3 tocsp"><a href="ipv6-config-tasks-5.html">Configuring an IPv6 Router</a></p>
<p class="toc level4"><a href="ipv6-config-tasks-5.html#ipv6-config-tasks-21">How to Configure an IPv6-Enabled Router</a></p>
<p class="toc level3 tocsp"><a href="ipv6-config-tasks-6.html">Modifying an IPv6 Interface Configuration for Hosts and Servers</a></p>
<p class="toc level3"><a href="ipv6-config-tasks-17.html">Tasks for Configuring Tunnels for IPv6 Support (Task Map)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Configuring Tunnels for IPv6 Support</a></p>
<p class="toc level4"><a href="#ipv6-config-tasks-20">How to Manually Configure IPv6 Over IPv4 Tunnels</a></p>
<p class="toc level4"><a href="#ipv6-config-tasks-37">How to Manually Configure IPv6 Over IPv6 Tunnels</a></p>
<p class="toc level4"><a href="#ipv6-config-tasks-40">How to Configure IPv4 Over IPv6 Tunnels</a></p>
<p class="toc level4"><a href="#ipv6-config-tasks-24">How to Configure a 6to4 Tunnel</a></p>
<p class="toc level4"><a href="#ipv6-config-tasks-48">How to Configure a 6to4 Tunnel to a 6to4 Relay Router</a></p>
</div>
<p class="toc level3 tocsp"><a href="ipv6-config-tasks-10.html">Configuring Name Service Support for IPv6</a></p>
<p class="toc level4"><a href="ipv6-config-tasks-10.html#ipv6-config-tasks-11">How to Add IPv6 Addresses to DNS</a></p>
<p class="toc level4"><a href="ipv6-config-tasks-10.html#ipv6-config-tasks-116">How to Display IPv6 Name Service Information</a></p>
<p class="toc level4"><a href="ipv6-config-tasks-10.html#ipv6-admintasks-34">How to Verify That DNS IPv6 PTR Records Are Updated Correctly</a></p>
<p class="toc level4"><a href="ipv6-config-tasks-10.html#ipv6-admintasks-37">How to Display IPv6 Information Through NIS</a></p>
<p class="toc level2 tocsp"><a href="ipv6-admintasks-1.html">8.&nbsp;&nbsp;Administering a TCP/IP Network (Tasks)</a></p>
<p class="toc level2"><a href="gegel.html">9.&nbsp;&nbsp;Troubleshooting Network Problems (Tasks)</a></p>
<p class="toc level2"><a href="ipref-8.html">10.&nbsp;&nbsp;TCP/IP and IPv4 in Depth (Reference)</a></p>
<p class="toc level2"><a href="ipv6-ref-76.html">11.&nbsp;&nbsp;IPv6 in Depth (Reference)</a></p>
<p class="toc level1 tocsp"><a href="dhcptm-1.html">Part&nbsp;II&nbsp;DHCP</a></p>
<p class="toc level2"><a href="dhcp-overview-1.html">12.&nbsp;&nbsp;About Solaris DHCP (Overview)</a></p>
<p class="toc level2"><a href="chap2-26.html">13.&nbsp;&nbsp;Planning for DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="chapter3-20.html">14.&nbsp;&nbsp;Configuring the DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="dhcp-admin-9.html">15.&nbsp;&nbsp;Administering DHCP (Tasks)</a></p>
<p class="toc level2"><a href="eyatl.html">16.&nbsp;&nbsp;Configuring and Administering  DHCP Clients</a></p>
<p class="toc level2"><a href="dhcp-trouble-1.html">17.&nbsp;&nbsp;Troubleshooting DHCP (Reference)</a></p>
<p class="toc level2"><a href="dhcp-ref-4.html">18.&nbsp;&nbsp;DHCP Commands and Files (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipsectm-1.html">Part&nbsp;III&nbsp;IP Security</a></p>
<p class="toc level2"><a href="ipsec-ov-1.html">19.&nbsp;&nbsp;IP Security Architecture (Overview)</a></p>
<p class="toc level2"><a href="ipsec-mgtasks-1.html">20.&nbsp;&nbsp;Configuring IPsec (Tasks)</a></p>
<p class="toc level2"><a href="ipsecref-1.html">21.&nbsp;&nbsp;IP Security Architecture (Reference)</a></p>
<p class="toc level2"><a href="ike-1.html">22.&nbsp;&nbsp;Internet Key Exchange (Overview)</a></p>
<p class="toc level2"><a href="ike-task-1.html">23.&nbsp;&nbsp;Configuring IKE (Tasks)</a></p>
<p class="toc level2"><a href="ikeref-1.html">24.&nbsp;&nbsp;Internet Key Exchange (Reference)</a></p>
<p class="toc level2"><a href="eupsq.html">25.&nbsp;&nbsp;Solaris IP Filter (Overview)</a></p>
<p class="toc level2"><a href="ipfilter-admin-1.html">26.&nbsp;&nbsp;Solaris IP Filter (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="miptm-1.html">Part&nbsp;IV&nbsp;Mobile IP</a></p>
<p class="toc level2"><a href="mipoverview-1.html">27.&nbsp;&nbsp;Mobile IP (Overview)</a></p>
<p class="toc level2"><a href="mipimplementing-1.html">28.&nbsp;&nbsp;Administering Mobile IP (Tasks)</a></p>
<p class="toc level2"><a href="mipmanaging-22.html">29.&nbsp;&nbsp;Mobile IP Files and Commands (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipmptm-1.html">Part&nbsp;V&nbsp;IPMP</a></p>
<p class="toc level2"><a href="mpoverview.html">30.&nbsp;&nbsp;Introducing IPMP (Overview)</a></p>
<p class="toc level2"><a href="deploynetmult-56.html">31.&nbsp;&nbsp;Administering IPMP (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ipqostm-1.html">Part&nbsp;VI&nbsp;IP Quality of Service (IPQoS)</a></p>
<p class="toc level2"><a href="ipqos-intro-1.html">32.&nbsp;&nbsp;Introducing IPQoS (Overview)</a></p>
<p class="toc level2"><a href="ipqos-config-planning-1.html">33.&nbsp;&nbsp;Planning for an IPQoS-Enabled Network (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-policy-planning-1.html">34.&nbsp;&nbsp;Creating the IPQoS Configuration File (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-isp-setup-1.html">35.&nbsp;&nbsp;Starting and Maintaining IPQoS (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-accounting-1.html">36.&nbsp;&nbsp;Using Flow Accounting and Statistics Gathering (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-reference-1.html">37.&nbsp;&nbsp;IPQoS in Detail (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="ipv6-config-tasks-16"></a><h3>Configuring Tunnels for IPv6 Support</h3>
<p>IPv6 networks are often isolated entities within the larger IPv4 world. Nodes on
your IPv6 network might need to communicate with nodes on isolated IPv6 networks,
either within your enterprise or remotely. Typically, you configure a tunnel between IPv6
routers, although IPv6 hosts can also function as tunnel endpoints. For tunnel planning
information, refer to <a href="ipv6-planning-7.html#ipv6-planning-31">Planning for Tunnels in the Network Topology</a>.</p><p>You can set up automatically or manually configured tunnels for the IPv6 network.
The Solaris IPv6 implementation supports the following types of tunnel encapsulation:</p>
<ul><li><p>IPv6 over IPv4 tunnels</p></li>
<li><p>IPv6 over IPv6 tunnels</p></li>
<li><p>IPv4 over IPv6 tunnels</p></li>
<li><p>6to4 tunnels</p></li></ul>
<p>For conceptual descriptions of tunnels, see <a href="ipv6-ref-47.html">IPv6 Tunnels</a>.</p>

<a name="ipv6-config-tasks-20"></a><h4>How to Manually Configure IPv6 Over IPv4 Tunnels</h4><a name="indexterm-757"></a><a name="indexterm-758"></a><p>This procedure describes how to set up a tunnel from an IPv6
node to a remote IPv6 node over an IPv4 network.</p><ol>
<li><b>Log in to the local tunnel endpoint as Primary Administrator or as superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b>Create the <tt>/etc/hostname6.ip.tun</tt><i>n</i> file. <a name="indexterm-759"></a><a name="indexterm-760"></a></b><p>where <i>n</i> represents the tunnel number, beginning at zero for the first tunnel.
 Then, add entries by following these substeps:</p><ol style="list-style-type: lower-alpha">
				 
<li><b>Add the tunnel source address and the tunnel destination address.</b><pre>tsrc <i>IPv4-source-address</i> tdst <i>IPv4-destination-address</i> up</pre></li>
<li><b>(Optional) Add a logical interface for the source IPv6 address and the destination
IPv6 addresses.<a name="indexterm-761"></a></b><pre>addif <i>IPv6-source-address</i>  <i>IPv6-destination-address</i> </pre><p>Omit this substep if you want the address autoconfigured for this interface. You
do not need to configure link-local addresses for your tunnel.</p></li></ol></li>
<li><a name="ipv6-config-tasks-step-83"></a><b>Reboot the system.</b></li>
<li><a name="ipv6-config-tasks-step-84"></a><b>Repeat this task on the opposite endpoint of the tunnel.</b></li></ol><a name="ipv6-config-tasks-36"></a>Example&nbsp;7-7 Entry in the <tt>/etc/hostname6.ip.tun</tt> File for a Manual, IPv6 Over IPv4 Tunnel<a name="indexterm-762"></a><a name="indexterm-763"></a><p>This sample <tt>/etc/hostname6.ip.tun</tt> file shows a tunnel for which global source addresses and
global destination addresses are manually configured. </p><pre>tsrc 192.168.8.20 tdst 192.168.7.19 up
addif 2001:db8:3c4d:8::fe12:528 2001:db8:3c4d:7:a00:20ff:fe12:1234</pre>

<a name="ipv6-config-tasks-37"></a><h4>How to Manually Configure IPv6 Over IPv6 Tunnels</h4><p>This procedure describes how to set up a tunnel from an IPv6
node to a remote IPv6 node over an IPv6 network.<a name="indexterm-764"></a></p><ol>
<li><b>Log in to the local tunnel endpoint as Primary Administrator or as superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b>Create the <tt>/etc/hostname6.ip6.tun</tt> <i>n</i> file. </b><p>Use the values 0, 1, 2, and so on, for <i>n</i>. Then,
add entries by following these substeps.</p><ol style="list-style-type: lower-alpha">
				 
<li><b>Add the tunnel source address and the tunnel destination address.</b><pre>tsrc <i>IPv6-source-address</i> tdst <i>IPv6-destination-address</i>
<i>IPv6-packet-source-address</i> <i>IPv6-packet-destination-address</i> up</pre></li>
<li><b>(Optional) Add a logical interface for the source IPv6 address and destination IPv6
address.<a name="indexterm-765"></a></b><pre>addif <i>IPv6-source-address</i>  <i>IPv6-destination-address</i> up</pre><p>Omit this step if you want the address autoconfigured for this interface. You
do not need to configure link-local addresses for your tunnel. </p></li></ol></li>
<li><a name="ipv6-config-tasks-step-86"></a><b>Reboot the system.</b></li>
<li><a name="ipv6-config-tasks-step-87"></a><b>Repeat this procedure at the opposite endpoint of the tunnel.</b></li></ol><a name="eojaz"></a>Example&nbsp;7-8 Entry in the <tt>/etc/hostname6.ip6.tun</tt> File for an IPv6 Over IPv6 Tunnel<p><a name="indexterm-766"></a><a name="indexterm-767"></a>This example shows the entry for an IPv6 over IPv6 tunnel.</p><pre>tsrc 2001:db8:3c4d:22:20ff:0:fe72:668c tdst 2001:db8:3c4d:103:a00:20ff:fe9b:a1c3
fe80::4 fe80::61 up</pre>

<a name="ipv6-config-tasks-40"></a><h4>How to Configure IPv4 Over IPv6 Tunnels</h4><p>This procedure explains how to configure a tunnel between two IPv4 hosts over
an IPv6 network. You would use this procedure if your corporate network is
heterogeneous, with IPv6 subnets that separate IPv4 subnets.<a name="indexterm-768"></a></p><ol>
<li><b>Log in to the local IPv4 tunnel endpoint as Primary Administrator or as
superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b>Create the <tt>/etc/hostname.ip6.tun</tt><i>n</i> file. </b><p>Use the values 0, 1, 2, and    so on,
for <i>n</i>. Then, add entries by following these steps:</p><ol style="list-style-type: lower-alpha">
				 
<li><b>Add the tunnel source address and the tunnel destination address.</b><pre>tsrc <i>IPv6-source-address</i> tdst <i>IPv6-destination-address</i></pre></li>
<li><b>(Optional) Add a logical interface for the source IPv6 address and destination IPv6
address.<a name="indexterm-769"></a><a name="indexterm-770"></a><a name="indexterm-771"></a></b><pre>addif <i>IPv6-source-address</i>  <i>IPv6-destination-address</i> up</pre></li></ol></li>
<li><a name="ipv6-config-tasks-step-89"></a><b>Reboot the local host.</b></li>
<li><a name="ipv6-config-tasks-step-90"></a><b>Repeat this procedure at the opposite endpoint of the tunnel.</b></li></ol><a name="eojaw"></a>Example&nbsp;7-9 Entry in the <tt>/etc/hostname6.ip6.tun</tt> for an IPv4 Over IPv6 Tunnel<p>This example shows the entry for an IPv4 over IPv6 tunnel.</p><pre>tsrc 2001:db8:3c4d:114:a00:20ff:fe72:668c tdst 2001:db8:3c4d:103:a00:20ff:fe9b:a1c3
10.0.0.4 10.0.0.61 up</pre>

<a name="ipv6-config-tasks-24"></a><h4>How to Configure a 6to4 Tunnel</h4><p><a name="indexterm-772"></a><a name="indexterm-773"></a>If your IPv6 network needs to communicate with a remote IPv6 network, consider
using automatic, 6to4 tunnels. The process of configuring a 6to4 tunnel includes configuring
the boundary router as a <b>6to4</b> router. The 6to4 router functions as the
endpoint of a 6to4 tunnel between your network and an endpoint router at
a remote IPv6 network. </p><h6>Before You Begin</h6><p>Before you configure 6to4 routing on an IPv6 network, you must have done
the following:</p>
<ul><li><p>Configured IPv6 on all appropriate nodes at the prospective 6to4 site, as described in <a href="ipv6-config-tasks-6.html">Modifying an IPv6 Interface Configuration for Hosts and Servers</a>.</p></li>
<li><p>Selected at least one router with a connection to an IPv4 network to become the 6to4 router.</p></li>
<li><p>Configured a globally unique IPv4 address for the prospective 6to4 router's interface to the IPv4 network. The IPv4 address must be static.</p>
<hr><p><b>Note - </b>Do not use a dynamically allocated IPv4 address, as described in <a href="dhcp-overview-1.html">Chapter&nbsp;12, About Solaris DHCP (Overview)</a>. Global dynamically allocated addresses might change over time, which can adversely affect your IPv6 addressing plan.</p>
<hr>
</li></ul>
<ol>
<li><b>Log in to the prospective 6to4 router as Primary Administrator or as superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b><a name="indexterm-774"></a><a name="indexterm-775"></a><a name="indexterm-776"></a><a name="indexterm-777"></a>Configure a 6to4 pseudo-interface on the router by creating the <tt>/etc/hostname6.ip.6to4tun0</tt> file.</b>
<ul><li><p>If you plan to use the recommended convention of subnet ID=0 and host ID=1, use the short format for <tt>/etc/hostname6.ip.6to4tun0</tt>:</p><pre>tsrc <i>IPv4-address</i> up</pre></li>
<li><p>If you plan to use other conventions for the subnet ID and host ID, use the long format for <tt>/etc/hostname6.ip.6to4tun0</tt>:</p><pre>tsrc <i>IPv4-address</i> 2002:<i>IPv4-address</i>:<i>subnet-ID</i>:<i>interface-ID</i>:/64 up</pre></li></ul>
<p><a name="indexterm-778"></a>The required parameters for <tt>/etc/hostname6.ip.6to4tun0</tt> follow:</p><dl><dt><tt>tsrc</tt></dt>
<dd><p>Indicates that this interface is used as a tunnel source.</p></dd>
<dt><i>IPv4-address</i></dt>
<dd><p>Specifies, in dotted-decimal format, the IPv4 address that is configured on the physical interface to become the 6to4 pseudo-interface.</p></dd>
</dl>
<p>The remaining parameters are optional. However, if you specify one optional parameter, you
must specify all optional parameters.</p><dl><dt><tt>2002</tt></dt>
<dd><p>Specifies the 6to4 prefix.</p></dd>
<dt><i>IPv4&ndash;address</i></dt>
<dd><p>Specifies, in hexadecimal notation, the IPv4 address of the pseudo-interface.</p></dd>
<dt><i>subnet-ID</i></dt>
<dd><p>Specifies, in hexadecimal notation, a subnet ID other than 0.</p></dd>
<dt><i>interface-ID</i></dt>
<dd><p>Specifies an interface ID other than 1.</p></dd>
<dt><tt>/64</tt></dt>
<dd><p>Indicates that the 6to4 prefix has a length of 64 bits.</p></dd>
<dt><tt>up</tt></dt>
<dd><p>Configures the 6to4 interface as &ldquo;up.&rdquo;</p></dd>
</dl>

<hr><p><b>Note - </b>Two IPv6 tunnels on your network cannot have the same source address and
the same destination address. Packets are dropped as a result. This type of
event can happen if a 6to4 router also performs tunneling through the
<tt>atun</tt> command. For information about <tt>atun</tt>, refer to the <a href="http://docs.sun.com/doc/819-2254/lc-tun-7m?a=view"><tt>tun</tt>(7M)</a> man page.</p>
<hr>
</li>
<li><b>(Optional) Create additional 6to4 pseudo-interfaces on the router.</b><p>Each prospective 6to4 pseudo-interface must have an already configured, globally unique IPv4 address.
</p></li>
<li><a name="ipv6-config-tasks-step-118"></a><b>Reboot the 6to4 router.</b></li>
<li><b><a name="indexterm-779"></a>Verify the status of the interface.</b><pre># <tt><b>ifconfig ip.6to4tun0 inet6</b></tt>
        </pre><p>If the interface is correctly configured, you receive output that is similar to
the following:</p><pre>ip.6to4tun0: flags=2200041&lt;UP,RUNNING,NONUD,IPv6>mtu 1480 index 11
        inet tunnel src 111.222.33.44 
        tunnel hop limit 60 
        inet6 2002:6fde:212c:10:/64 </pre></li>
<li><b><a name="indexterm-780"></a><a name="indexterm-781"></a>Edit the <tt>/etc/inet/ndpd.conf</tt> file to advertise 6to4 routing.</b><p><a name="indexterm-782"></a>For detailed information, refer to the <a href="http://docs.sun.com/doc/819-2251/ndpd.conf-4?a=view"><tt>ndpd.conf</tt>(4)</a> man page.</p><ol style="list-style-type: lower-alpha">
				 
<li><b>Specify the subnet to receive the advertisement in the first line.</b><p>Create an <tt>if</tt> entry with the following format:</p><pre>if <i>subnet-interface</i> AdvSendAdvertisements 1</pre><p>For example, to advertise 6to4 routing to the subnet that is connected to
interface <tt>hme0</tt>, replace <i>subnet-interface</i> with <tt>hme0</tt>. </p><pre>if hme0 AdvSendAdvertisements 1</pre></li>
<li><b><a name="indexterm-783"></a>Add the 6to4 prefix as the second line of the advertisement.</b><p>Create a <tt>prefix</tt> entry with following format:</p><pre>prefix 2002:<i>IPv4-address</i>:<i>subnet-ID</i>::/64 <i>subnet-interface</i></pre></li></ol></li>
<li><b>Reboot the router.</b><p>Alternatively, you can issue a <tt>sighup</tt> to the <tt>/etc/inet/in.ndpd</tt> daemon to begin sending
router advertisements. The IPv6 nodes on each subnet to receive the 6to4 prefix
now autoconfigure with new 6to4-derived addresses.</p></li>
<li><b>Add the new 6to4-derived addresses of the nodes to the name service that
is used at the 6to4 site.</b><p>For instructions, go to <a href="ipv6-config-tasks-10.html">Configuring Name Service Support for IPv6</a>.</p></li></ol><a name="eojbe"></a>Example&nbsp;7-10 6to4 Router Configuration (Short Form)<p><a name="indexterm-784"></a>The following is an example of the short form of <tt>/etc/hostname6.ip.6to4tun0</tt>:</p><pre># <tt><b>cat</b></tt> <tt>/etc/hostname6.ip.6to4tun0</tt>
<tt><b>tsrc 111.222.33.44 up</b></tt></pre><a name="ekqvt"></a>Example&nbsp;7-11 6to4 Router Configuration (Long Form)<p>Here is an example of the long form of <tt>/etc/hostname6.ip.6to4tun0</tt>:</p><pre># <tt><b>cat</b></tt> <tt>/etc/hostname6.ip.6to4tun0</tt>
<tt><b>tsrc 111.222.33.44 2002:6fde:212c:20:1/64 up</b></tt></pre><a name="ekqvw"></a>Example&nbsp;7-12 <tt>ifconfig</tt> Output Showing 6to4 Pseudo-Interface<p>The following sample shows output of the <tt>ifconfig</tt> command for a 6to4 pseudo-interface:</p><pre># <tt><b>ifconfig ip.6to4tun0 inet6</b></tt>
ip.6to4tun0: flags=2200041&lt;UP,RUNNING,NONUD,IPv6> mtu 1480 index 11
        inet tunnel src 192.168.87.188
        tunnel hop limit 60 
        inet6 2002:c0a8:57bc::1/64 </pre><a name="ekqwh"></a>Example&nbsp;7-13 6to4 Advertisements in<tt>/etc/inet/ndpd.conf</tt><p>The following sample <tt>/etc/inet/ndpd.conf</tt> file advertises 6to4 routing on two subnets:</p><pre>if qfe0 AdvSendAdvertisements 1
prefix  2002:c0a8:57bc:10::/64 qfe0 

if qfe1 AdvSendAdvertisements 1
prefix  2002:c0a8:57bc:2::/64 qfe1</pre><h6><h6>More Information</h6>Configuring Multiple Routers at the 6to4 Site<p>For a multiple router site, the routers behind the 6to4 router might require
further configuration to support 6to4. If your site uses RIP, you must configure
on each non-6to4 router the static routes to the 6to4 router. If you
use a commercial routing protocol, you do not need to create static routes
to the 6to4 router.</p></h6>

<a name="ipv6-config-tasks-48"></a><h4>How to Configure a 6to4 Tunnel to a 6to4 Relay Router</h4>
<hr><p><b>Caution - </b><a name="indexterm-785"></a><a name="indexterm-786"></a><a name="indexterm-787"></a><a name="indexterm-788"></a>Because of major security issues, by default, 6to4 relay router support is disabled
in the Solaris OS.  See <a href="ipv6-troubleshoot-2.html#ipv6-ref-58">Security Issues When Tunneling to a 6to4 Relay Router</a>.</p>
<hr>
<h6>Before You Begin</h6><p>Before you enable a tunnel to a 6to4 relay router, you must
have completed the following tasks:</p>
<ul><li><p>Configured a 6to4 router at your site, as explained in <a href="#ipv6-config-tasks-24">How to Configure a 6to4 Tunnel</a></p></li>
<li><p>Reviewed the security issues that are involved in tunneling to a 6to4 relay router</p></li></ul>
<ol>
<li><b>Log in to the 6to4 router as Primary Administrator or as superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b><a name="indexterm-789"></a>Enable a tunnel to the 6to4 relay router by using either of
the following formats:</b>
<ul><li><p>Enable a tunnel to an anycast 6to4 relay router.</p><pre># <tt><b>/usr/sbin/6to4relay -e</b></tt></pre><p><a name="indexterm-790"></a><a name="indexterm-791"></a><a name="indexterm-792"></a><a name="indexterm-793"></a>The <tt>-e</tt> option sets up a tunnel between the 6to4 router and an anycast 6to4 relay router. Anycast 6to4 relay routers have the well-known IPv4 address <tt>192.88.99.1</tt>. The anycast relay router that is physically nearest to your site becomes the endpoint for the 6to4 tunnel. This relay router then handles packet forwarding between your 6to4 site and a native IPv6 site.</p><p>For detailed information about anycast 6to4 relay routers, refer to <a href="ftp://ftp.rfc-editor.org/in-notes/rfc3068.txt">RFC 3068, "An Anycast Prefix for 6to4 Relay Routers"</a>.</p></li>
<li><p>Enable a tunnel to a specific 6to4 relay router.</p><pre># <tt><b>/usr/sbin/6to4relay -e -a </tt><i>relay-router-address</i><tt></b></tt></pre><p>The <tt>-a</tt> option indicates that a specific router address is to follow. Replace <i>relay-router-address</i> with the IPv4 address of the specific 6to4 relay router with which you want to enable a tunnel.</p></li></ul>
<p>The tunnel to the 6to4 relay router remains active until you remove the
6to4 tunnel pseudo-interface.</p></li>
<li><b>Delete the tunnel to the 6to4 relay router, when the tunnel is no
longer needed:</b><pre># <tt><b>/usr/sbin/6to4relay -d</b></tt></pre></li>
<li><b>(Optional) Make the tunnel to the 6to4 relay router persistent across reboots.</b><p>Your site might have a compelling reason to have the tunnel to the
6to4 relay router reinstated each time the 6to4 router reboots. To support this
scenario, you must do the following:</p><ol style="list-style-type: lower-alpha">
				 
<li><b>Edit the<tt>/etc/default/inetinit</tt> file.</b><p>The line that you need to modify is at the end of
the file.</p></li>
<li><b>Change the &ldquo;NO&rdquo; value in the line <tt>ACCEPT6TO4RELAY=NO</tt> to &ldquo;YES.&rdquo;</b></li>
<li><b>(Optional) Create a tunnel to a specific 6to4 relay router that persists across
reboots.</b><p><a name="indexterm-794"></a><a name="indexterm-795"></a>For the parameter <tt>RELAY6TO4ADDR</tt>, change the address <tt>192.88.99.1</tt> to the IPv4 address of
the 6to4 relay router that you want to use.</p></li></ol></li></ol><a name="eojav"></a>Example&nbsp;7-14 Getting Status Information About 6to4 Relay Router Support<p>You can use the <tt>/usr/bin/6to4relay</tt> command to find out whether support for 6to4
relay routers is enabled. The next example shows the output when support for
6to4 relay routers is disabled, as is the default in the Solaris OS:</p><pre># <tt><b>/usr/sbin/6to4relay</b></tt>
6to4relay: 6to4 Relay Router communication support is disabled.</pre><p>When support for 6to4 relay routers is enabled, you receive the following output:</p><pre># <tt><b>/usr/sbin/6to4relay</b></tt>
6to4relay: 6to4 Relay Router communication support is enabled.
IPv4 destination address of Relay Router=192.88.99.1</pre>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ipv6-config-tasks-17.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ipv6-config-tasks-10.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

