<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>IKE Key Negotiation - System Administration Guide: IP Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: IP Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ike-2.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ike-5.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="iptm-1.html">Part&nbsp;I&nbsp;TCP/IP Administration</a></p>
<p class="toc level2"><a href="ipov-1.html">1.&nbsp;&nbsp;Solaris TCPIP Protocol Suite (Overview)</a></p>
<p class="toc level2"><a href="ipplan-1.html">2.&nbsp;&nbsp;Planning an IPv4 Addressing Scheme (Tasks</a></p>
<p class="toc level2"><a href="ipv6-overview-7.html">3.&nbsp;&nbsp;Planning an IPv6 Addressing Scheme (Overview)</a></p>
<p class="toc level2"><a href="ipv6-planning-1.html">4.&nbsp;&nbsp;Planning an IPv6 Network (Tasks)</a></p>
<p class="toc level2"><a href="ipconfig-1.html">5.&nbsp;&nbsp;Configuring TCP/IP Network Services and IPv4 Addressing (Tasks)</a></p>
<p class="toc level2"><a href="fwawf.html">6.&nbsp;&nbsp;Administering Network Interfaces (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-config-tasks-1.html">7.&nbsp;&nbsp;Enabling IPv6 on a Network (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-admintasks-1.html">8.&nbsp;&nbsp;Administering a TCP/IP Network (Tasks)</a></p>
<p class="toc level2"><a href="gegel.html">9.&nbsp;&nbsp;Troubleshooting Network Problems (Tasks)</a></p>
<p class="toc level2"><a href="ipref-8.html">10.&nbsp;&nbsp;TCP/IP and IPv4 in Depth (Reference)</a></p>
<p class="toc level2"><a href="ipv6-ref-76.html">11.&nbsp;&nbsp;IPv6 in Depth (Reference)</a></p>
<p class="toc level1 tocsp"><a href="dhcptm-1.html">Part&nbsp;II&nbsp;DHCP</a></p>
<p class="toc level2"><a href="dhcp-overview-1.html">12.&nbsp;&nbsp;About Solaris DHCP (Overview)</a></p>
<p class="toc level2"><a href="chap2-26.html">13.&nbsp;&nbsp;Planning for DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="chapter3-20.html">14.&nbsp;&nbsp;Configuring the DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="dhcp-admin-9.html">15.&nbsp;&nbsp;Administering DHCP (Tasks)</a></p>
<p class="toc level2"><a href="eyatl.html">16.&nbsp;&nbsp;Configuring and Administering  DHCP Clients</a></p>
<p class="toc level2"><a href="dhcp-trouble-1.html">17.&nbsp;&nbsp;Troubleshooting DHCP (Reference)</a></p>
<p class="toc level2"><a href="dhcp-ref-4.html">18.&nbsp;&nbsp;DHCP Commands and Files (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipsectm-1.html">Part&nbsp;III&nbsp;IP Security</a></p>
<p class="toc level2"><a href="ipsec-ov-1.html">19.&nbsp;&nbsp;IP Security Architecture (Overview)</a></p>
<p class="toc level2"><a href="ipsec-mgtasks-1.html">20.&nbsp;&nbsp;Configuring IPsec (Tasks)</a></p>
<p class="toc level2"><a href="ipsecref-1.html">21.&nbsp;&nbsp;IP Security Architecture (Reference)</a></p>
<p class="toc level2"><a href="ike-1.html">22.&nbsp;&nbsp;Internet Key Exchange (Overview)</a></p>
<p class="toc level3"><a href="ike-13.html">What's New in IKE?</a></p>
<p class="toc level3"><a href="ike-2.html">Key Management With IKE</a></p>
<div class="onpage">
<p class="toc level3"><a href="">IKE Key Negotiation</a></p>
</div>
<p class="toc level3"><a href="ike-5.html">IKE Configuration Choices</a></p>
<p class="toc level3"><a href="ike-23.html">IKE and Hardware Acceleration</a></p>
<p class="toc level3"><a href="ike-24.html">IKE and Hardware Storage</a></p>
<p class="toc level3"><a href="ike-12.html">IKE Utilities and Files</a></p>
<p class="toc level3"><a href="ike-10.html">Changes to IKE for the Solaris 10 Release</a></p>
<p class="toc level2 tocsp"><a href="ike-task-1.html">23.&nbsp;&nbsp;Configuring IKE (Tasks)</a></p>
<p class="toc level2"><a href="ikeref-1.html">24.&nbsp;&nbsp;Internet Key Exchange (Reference)</a></p>
<p class="toc level2"><a href="eupsq.html">25.&nbsp;&nbsp;Solaris IP Filter (Overview)</a></p>
<p class="toc level2"><a href="ipfilter-admin-1.html">26.&nbsp;&nbsp;Solaris IP Filter (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="miptm-1.html">Part&nbsp;IV&nbsp;Mobile IP</a></p>
<p class="toc level2"><a href="mipoverview-1.html">27.&nbsp;&nbsp;Mobile IP (Overview)</a></p>
<p class="toc level2"><a href="mipimplementing-1.html">28.&nbsp;&nbsp;Administering Mobile IP (Tasks)</a></p>
<p class="toc level2"><a href="mipmanaging-22.html">29.&nbsp;&nbsp;Mobile IP Files and Commands (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipmptm-1.html">Part&nbsp;V&nbsp;IPMP</a></p>
<p class="toc level2"><a href="mpoverview.html">30.&nbsp;&nbsp;Introducing IPMP (Overview)</a></p>
<p class="toc level2"><a href="deploynetmult-56.html">31.&nbsp;&nbsp;Administering IPMP (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ipqostm-1.html">Part&nbsp;VI&nbsp;IP Quality of Service (IPQoS)</a></p>
<p class="toc level2"><a href="ipqos-intro-1.html">32.&nbsp;&nbsp;Introducing IPQoS (Overview)</a></p>
<p class="toc level2"><a href="ipqos-config-planning-1.html">33.&nbsp;&nbsp;Planning for an IPQoS-Enabled Network (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-policy-planning-1.html">34.&nbsp;&nbsp;Creating the IPQoS Configuration File (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-isp-setup-1.html">35.&nbsp;&nbsp;Starting and Maintaining IPQoS (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-accounting-1.html">36.&nbsp;&nbsp;Using Flow Accounting and Statistics Gathering (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-reference-1.html">37.&nbsp;&nbsp;IPQoS in Detail (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="ike-3"></a><h3>IKE Key Negotiation</h3>
<p><a name="indexterm-1953"></a><a name="indexterm-1954"></a><a name="indexterm-1955"></a><a name="indexterm-1956"></a><a name="indexterm-1957"></a><a name="indexterm-1958"></a><a name="indexterm-1959"></a><a name="indexterm-1960"></a><a name="indexterm-1961"></a><a name="indexterm-1962"></a>The IKE daemon, <tt>in.iked</tt>, negotiates and authenticates keying material for SAs in a
protected manner. The daemon uses random seeds for keys from internal functions provided
by the Solaris Operating System. IKE provides perfect forward secrecy (PFS). In PFS,
the keys that protect data transmission are not used to derive additional keys.
Also, seeds used to create data transmission keys are not reused. See the
<a href="http://docs.sun.com/doc/819-2240/in.iked-1m?a=view"><tt>in.iked</tt>(1M)</a> man page.</p><p>When the IKE daemon discovers a remote system's public encryption key, the local
system can then use that key. The system encrypts messages by using the
remote system's public key. The messages can be read only by that
remote system. The IKE daemon performs its job in two phases. The phases
are called <b>exchanges</b>.</p>

<a name="ike-32"></a><h4>IKE Key Terminology</h4>
<p>The following table lists terms that are used in key negotiation, provides their
commonly used acronyms, and gives a definition and use for each term.</p><a name="ike-tbl-2"></a><h6>Table&nbsp;22-1 Key Negotiation Terms, Acronyms, and Uses</h6><table><col width="20.20*"><col width="11.40*"><col width="67.40*"><tr><th align="left" valign="top" scope="column"><p>Key
Negotiation Term</p></th>
<th align="left" valign="top" scope="column"><p>Acronym</p></th>
<th align="left" valign="top" scope="column"><p>Definition and Use</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Key exchange</p></td>
<td align="left" valign="top" scope="row"><p></p></td>
<td align="left" valign="top" scope="row"><p>The process of generating keys for asymmetric cryptographic
algorithms. The two main methods are RSA protocols and the Diffie-Hellman protocol.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Diffie-Hellman protocol</p></td>
<td align="left" valign="top" scope="row"><p>DH</p></td>
<td align="left" valign="top" scope="row"><p>A
key exchange protocol that involves key generation and key authentication. Often called <b>authenticated key exchange</b>.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>RSA
protocol</p></td>
<td align="left" valign="top" scope="row"><p>RSA</p></td>
<td align="left" valign="top" scope="row"><p>A key exchange protocol that involves key generation and key transport. The protocol
is named for its three creators, Rivest, Shamir, and Adleman.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><a name="indexterm-1963"></a>Perfect forward secrecy</p></td>
<td align="left" valign="top" scope="row"><p>PFS</p></td>
<td align="left" valign="top" scope="row"><p>Applies
to authenticated key exchange only. PFS ensures that long-term secret material for keys
does not compromise the secrecy of the exchanged keys from previous communications. </p><p>In
PFS, the key that is used to protect transmission of data is
not used to derive additional keys. Also, the source of the key that
is used to protect data transmission is never used to derive additional keys.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Oakley
method</p></td>
<td align="left" valign="top" scope="row"><p></p></td>
<td align="left" valign="top" scope="row"><p>A method for establishing keys for Phase 2 in a secure manner.
This protocol is analogous to the Diffie-Hellman method of key exchange. Similar to Diffie-Hellman,
Oakley group key exchange involves key generation and key authentication. The Oakley method
is used to negotiate PFS.</p></td>
</tr>
</table>

<a name="ike-26"></a><h4>IKE Phase 1 Exchange</h4>
<p><a name="indexterm-1964"></a><a name="indexterm-1965"></a><a name="indexterm-1966"></a><a name="indexterm-1967"></a>The Phase 1 exchange is known as <b>Main Mode</b>. In the Phase 1 exchange,
IKE uses public key encryption methods to authenticate itself with peer IKE entities.
The result is an Internet Security Association and Key Management Protocol (ISAKMP) security
association (SA). An ISAKMP SA is a secure channel for IKE to negotiate
keying material for the IP datagrams. Unlike IPsec SAs, the ISAKMP SAs are
bidirectional, so only one security association is needed.</p><p><a name="indexterm-1968"></a><a name="indexterm-1969"></a>How IKE negotiates keying material in the Phase 1 exchange is configurable. IKE
reads the configuration information from the <tt>/etc/inet/ike/config</tt> file. Configuration information includes the
following:</p>
<ul><li><p>Global parameters, such as the names of public key certificates</p></li>
<li><p>Whether perfect forward secrecy (PFS) is used</p></li>
<li><p>The interfaces that are affected</p></li>
<li><p>The security protocols and their algorithms</p></li>
<li><p>The authentication method</p></li></ul>
<p>The two authentication methods are preshared keys and public key certificates. The public
key certificates can be self-signed. Or, the certificates can be issued by a
<a href="glossary-1.html#glossary-41">certificate authority (CA)</a> from a public key infrastructure (<a href="glossary-1.html#glossary-29">PKI</a>) organization. Organizations include beTrusted, Entrust, GeoTrust, RSA
Security, and Verisign.</p>

<a name="ike-14"></a><h4>IKE Phase 2 Exchange</h4>
<p><a name="indexterm-1970"></a><a name="indexterm-1971"></a>The Phase 2 exchange is known as <b>Quick Mode</b>. In the Phase 2 exchange,
IKE creates and manages the IPsec SAs between systems that are running the
IKE daemon. IKE uses the secure channel that was created in the Phase
1 exchange to protect the transmission of keying material. The IKE daemon creates
the keys from a random number generator by using the <tt>/dev/random</tt> device.
The daemon refreshes the keys at a configurable rate. The keying material is
available to algorithms that are specified in the configuration file for IPsec policy,
<tt>ipsecinit.conf</tt>.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ike-2.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ike-5.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

