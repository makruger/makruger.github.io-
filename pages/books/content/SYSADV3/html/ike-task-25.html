<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Configuring IKE With Public Key Certificates - System Administration Guide: IP Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: IP Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ike-task-12.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ike-task-38.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="iptm-1.html">Part&nbsp;I&nbsp;TCP/IP Administration</a></p>
<p class="toc level2"><a href="ipov-1.html">1.&nbsp;&nbsp;Solaris TCPIP Protocol Suite (Overview)</a></p>
<p class="toc level2"><a href="ipplan-1.html">2.&nbsp;&nbsp;Planning an IPv4 Addressing Scheme (Tasks</a></p>
<p class="toc level2"><a href="ipv6-overview-7.html">3.&nbsp;&nbsp;Planning an IPv6 Addressing Scheme (Overview)</a></p>
<p class="toc level2"><a href="ipv6-planning-1.html">4.&nbsp;&nbsp;Planning an IPv6 Network (Tasks)</a></p>
<p class="toc level2"><a href="ipconfig-1.html">5.&nbsp;&nbsp;Configuring TCP/IP Network Services and IPv4 Addressing (Tasks)</a></p>
<p class="toc level2"><a href="fwawf.html">6.&nbsp;&nbsp;Administering Network Interfaces (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-config-tasks-1.html">7.&nbsp;&nbsp;Enabling IPv6 on a Network (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-admintasks-1.html">8.&nbsp;&nbsp;Administering a TCP/IP Network (Tasks)</a></p>
<p class="toc level2"><a href="gegel.html">9.&nbsp;&nbsp;Troubleshooting Network Problems (Tasks)</a></p>
<p class="toc level2"><a href="ipref-8.html">10.&nbsp;&nbsp;TCP/IP and IPv4 in Depth (Reference)</a></p>
<p class="toc level2"><a href="ipv6-ref-76.html">11.&nbsp;&nbsp;IPv6 in Depth (Reference)</a></p>
<p class="toc level1 tocsp"><a href="dhcptm-1.html">Part&nbsp;II&nbsp;DHCP</a></p>
<p class="toc level2"><a href="dhcp-overview-1.html">12.&nbsp;&nbsp;About Solaris DHCP (Overview)</a></p>
<p class="toc level2"><a href="chap2-26.html">13.&nbsp;&nbsp;Planning for DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="chapter3-20.html">14.&nbsp;&nbsp;Configuring the DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="dhcp-admin-9.html">15.&nbsp;&nbsp;Administering DHCP (Tasks)</a></p>
<p class="toc level2"><a href="eyatl.html">16.&nbsp;&nbsp;Configuring and Administering  DHCP Clients</a></p>
<p class="toc level2"><a href="dhcp-trouble-1.html">17.&nbsp;&nbsp;Troubleshooting DHCP (Reference)</a></p>
<p class="toc level2"><a href="dhcp-ref-4.html">18.&nbsp;&nbsp;DHCP Commands and Files (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipsectm-1.html">Part&nbsp;III&nbsp;IP Security</a></p>
<p class="toc level2"><a href="ipsec-ov-1.html">19.&nbsp;&nbsp;IP Security Architecture (Overview)</a></p>
<p class="toc level2"><a href="ipsec-mgtasks-1.html">20.&nbsp;&nbsp;Configuring IPsec (Tasks)</a></p>
<p class="toc level2"><a href="ipsecref-1.html">21.&nbsp;&nbsp;IP Security Architecture (Reference)</a></p>
<p class="toc level2"><a href="ike-1.html">22.&nbsp;&nbsp;Internet Key Exchange (Overview)</a></p>
<p class="toc level2"><a href="ike-task-1.html">23.&nbsp;&nbsp;Configuring IKE (Tasks)</a></p>
<p class="toc level3"><a href="ike-task-7.html">Configuring IKE (Task Map)</a></p>
<p class="toc level3"><a href="ike-task-13.html">Configuring IKE With Preshared Keys (Task Map)</a></p>
<p class="toc level3"><a href="ike-task-15.html">Configuring IKE With Preshared Keys</a></p>
<p class="toc level4"><a href="ike-task-15.html#ike-task-24">How to Configure IKE With Preshared Keys</a></p>
<p class="toc level4"><a href="ike-task-15.html#ike-task-10">How to Refresh IKE Preshared Keys</a></p>
<p class="toc level4"><a href="ike-task-15.html#ike-task-18">How to Add an IKE Preshared Key for a New Policy Entry in <tt>ipsecinit.conf</tt></a></p>
<p class="toc level4"><a href="ike-task-15.html#ike-task-44">How to Verify That IKE Preshared Keys Are Identical</a></p>
<p class="toc level3 tocsp"><a href="ike-task-12.html">Configuring IKE With Public Key Certificates (Task Map)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Configuring IKE With Public Key Certificates</a></p>
<p class="toc level4"><a href="#ike-task-42">How to Configure IKE With Self-Signed Public Key Certificates</a></p>
<p class="toc level4"><a href="#ike-task-41">How to Configure IKE With Certificates Signed by a CA</a></p>
<p class="toc level4"><a href="#ike-task-14">How to Generate and Store Public Key Certificates on Hardware</a></p>
<p class="toc level4"><a href="#ike-task-22">How to Handle a Certificate Revocation List</a></p>
</div>
<p class="toc level3 tocsp"><a href="ike-task-38.html">Configuring IKE for Mobile Systems (Task Map)</a></p>
<p class="toc level3"><a href="ike-task-48.html">Configuring IKE for Mobile Systems</a></p>
<p class="toc level4"><a href="ike-task-48.html#ike-task-40">How to Configure IKE for Off-Site Systems</a></p>
<p class="toc level3 tocsp"><a href="ike-task-17.html">Configuring IKE to Find Attached Hardware (Task Map)</a></p>
<p class="toc level3"><a href="ike-task-35.html">Configuring IKE to Find Attached Hardware</a></p>
<p class="toc level4"><a href="ike-task-35.html#ike-task-32">How to Configure IKE to Find the Sun Crypto Accelerator 1000 Board</a></p>
<p class="toc level4"><a href="ike-task-35.html#ike-task-11">How to Configure IKE to Find the Sun Crypto Accelerator 4000 Board</a></p>
<p class="toc level3 tocsp"><a href="ike-task-19.html">Changing IKE Transmission Parameters (Task Map)</a></p>
<p class="toc level3"><a href="ike-task-20.html">Changing IKE Transmission Parameters</a></p>
<p class="toc level4"><a href="ike-task-20.html#ike-task-34">How to Change the Duration of Phase 1 IKE Key Negotiation</a></p>
<p class="toc level2 tocsp"><a href="ikeref-1.html">24.&nbsp;&nbsp;Internet Key Exchange (Reference)</a></p>
<p class="toc level2"><a href="eupsq.html">25.&nbsp;&nbsp;Solaris IP Filter (Overview)</a></p>
<p class="toc level2"><a href="ipfilter-admin-1.html">26.&nbsp;&nbsp;Solaris IP Filter (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="miptm-1.html">Part&nbsp;IV&nbsp;Mobile IP</a></p>
<p class="toc level2"><a href="mipoverview-1.html">27.&nbsp;&nbsp;Mobile IP (Overview)</a></p>
<p class="toc level2"><a href="mipimplementing-1.html">28.&nbsp;&nbsp;Administering Mobile IP (Tasks)</a></p>
<p class="toc level2"><a href="mipmanaging-22.html">29.&nbsp;&nbsp;Mobile IP Files and Commands (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipmptm-1.html">Part&nbsp;V&nbsp;IPMP</a></p>
<p class="toc level2"><a href="mpoverview.html">30.&nbsp;&nbsp;Introducing IPMP (Overview)</a></p>
<p class="toc level2"><a href="deploynetmult-56.html">31.&nbsp;&nbsp;Administering IPMP (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ipqostm-1.html">Part&nbsp;VI&nbsp;IP Quality of Service (IPQoS)</a></p>
<p class="toc level2"><a href="ipqos-intro-1.html">32.&nbsp;&nbsp;Introducing IPQoS (Overview)</a></p>
<p class="toc level2"><a href="ipqos-config-planning-1.html">33.&nbsp;&nbsp;Planning for an IPQoS-Enabled Network (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-policy-planning-1.html">34.&nbsp;&nbsp;Creating the IPQoS Configuration File (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-isp-setup-1.html">35.&nbsp;&nbsp;Starting and Maintaining IPQoS (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-accounting-1.html">36.&nbsp;&nbsp;Using Flow Accounting and Statistics Gathering (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-reference-1.html">37.&nbsp;&nbsp;IPQoS in Detail (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="ike-task-25"></a><h3>Configuring IKE With Public Key Certificates</h3>
<p><a name="indexterm-2067"></a>Public key certificates eliminate the need for communicating systems to share secret keying
material out of band. Unlike preshared keys, a public key certificate can be
used on a mobile machine or on a system that might be renumbered.</p><p>Public key certificates can also be stored on attached hardware. For the procedure,
see <a href="ike-task-17.html">Configuring IKE to Find Attached Hardware (Task Map)</a>.</p>

<a name="ike-task-42"></a><h4>How to Configure IKE With Self-Signed Public Key Certificates</h4><a name="indexterm-2068"></a><a name="indexterm-2069"></a><p>Self-signed certificates require less overhead than public certificates from a CA, but do
not scale very easily.</p><ol>
<li><b>On the system console, assume the Primary Administrator role or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p>
<hr><p><b>Note - </b><a name="indexterm-2070"></a>Logging in remotely exposes security-critical traffic to eavesdropping. Even if you somehow protect
the remote login, the security of the system is reduced to the security
of the remote login session.</p>
<hr>
</li>
<li><a name="ike-task-step-ksgen-1"></a><b><a name="indexterm-2071"></a><a name="indexterm-2072"></a><a name="indexterm-2073"></a><a name="indexterm-2074"></a><a name="indexterm-2075"></a><a name="indexterm-2076"></a><a name="indexterm-2077"></a>Add a self-signed certificate to the <tt>ike.privatekeys</tt> database. </b><pre># ikecert certlocal -ks|-kc -m <i>keysize</i> -t <i>keytype</i> \
-D <i>dname</i> -A <i>altname</i> \
[<tt>-S</tt> <i>validity-start-time</i>] [<tt>-F</tt> <i>validity-end-time</i>] [<tt>-T</tt> <i>token-ID</i></pre><dl><dt><tt>-ks</tt></dt>
<dd><p>Creates a self-signed certificate.</p></dd>
<a name="indexterm-2078"></a><dt><tt>-kc</tt></dt>
<dd><p>Creates a certificate request. For the procedure, see <a href="#ike-task-41">How to Configure IKE With Certificates Signed by a CA</a>.</p></dd>
<a name="indexterm-2079"></a><dt><tt>-m</tt> <i>keysize</i></dt>
<dd><p>Is the size of the key. The <i>keysize</i> can be 512, 1024, 2048, 3072, or 4096.</p></dd>
<a name="indexterm-2080"></a><dt><tt>-t</tt> <i>keytype</i></dt>
<dd><p>Specifies the type of algorithm to use. The <i>keytype</i> can be <tt>rsa-sha1</tt>, <tt>rsa-md5</tt>, or <tt>dsa-sha1</tt>.</p></dd>
<a name="indexterm-2081"></a><dt><tt>-D</tt> <i>dname</i></dt>
<dd><p>Is the X.509 distinguished name for the certificate subject. The <i>dname</i> typically has the form: C=country, O=organization, OU=organizational unit, CN=common name. Valid tags are C, O, OU, and CN.</p></dd>
<a name="indexterm-2082"></a><dt><tt>-A</tt> <i>altname</i></dt>
<dd><p>Is the alternate name for the certificate. The <i>altname</i> is in the form of <tt>tag=value</tt>. Valid tags are <tt>IP</tt>, <tt>DNS</tt>, <tt>email</tt>, and <tt>DN</tt>.</p></dd>
<a name="indexterm-2083"></a><dt><tt>-S</tt> <i>validity-start-time</i></dt>
<dd><p>Provides an absolute or relative valid start time for the certificate.</p></dd>
<a name="indexterm-2084"></a><dt><tt>-F</tt> <i>validity-end-time</i></dt>
<dd><p>Provides an absolute or relative valid end time for the certificate.</p></dd>
<a name="indexterm-2085"></a><dt><tt>-T</tt> <i>token-ID</i></dt>
<dd><p>Enables a PKCS&nbsp;#11 hardware token to generate the keys. The certificates are then stored in the hardware.</p></dd>
</dl>
<ol style="list-style-type: lower-alpha">
				 
<li><b>For example, the command on the <tt>partym</tt> system would appear similar to the
following:</b><pre># <tt><b>ikecert certlocal -ks -m 1024 -t rsa-md5 \</b></tt>
<tt><b>-D "C=US, O=PartyCompany, OU=US-Partym, CN=Partym" \</b></tt>
<tt><b>-A IP=192.168.13.213</b></tt>
Creating software private keys.
  Writing private key to file /etc/inet/secret/ike.privatekeys/0.
Enabling external key providers - done.
Acquiring private keys for signing - done.
Certificate: 
 Proceeding with the signing operation.
 Certificate generated successfully (&hellip;/publickeys/0)
Finished successfully.
Certificate added to database.
-----BEGIN X509 CERTIFICATE-----
MIICLTCCAZagAwIBAgIBATANBgkqhkiG9w0BAQQFADBNMQswCQYDVQQGEwJVUzEX
&hellip;
6sKTxpg4GP3GkQGcd0r1rhW/3yaWBkDwOdFCqEUyffzU
-----END X509 CERTIFICATE-----</pre></li>
<li><b>The command on the <tt>enigma</tt> system would appear similar to the following:</b><pre># <tt><b>ikecert certlocal -ks -m 1024 -t rsa-md5 \</b></tt>
<tt><b>-D "C=JA, O=EnigmaCo, OU=JA-Enigmax, CN=Enigmax" \</b></tt>
<tt><b>-A IP=192.168.116.16</b></tt>
Creating software private keys.
  &hellip;
Certificate added to database.
-----BEGIN X509 CERTIFICATE-----
MIICKDCCAZGgAwIBAgIBATANBgkqhkiG9w0BAQQFADBJMQswCQYDVQQGEwJVUzEV
&hellip;
jpxfLM98xyFVyLCbkr3dZ3Tvxvi732BXePKF2A==
-----END X509 CERTIFICATE-----</pre></li></ol></li>
<li><b>Save the certificate and send it to the remote system.</b><p>You can paste the certificate into an email.</p><ol style="list-style-type: lower-alpha">
				 
<li><b>For example, you would send the following <tt>partym</tt> certificate to the <tt>enigma</tt> administrator:</b><pre>To: admin@ja.enigmaexample.com
From: admin@us.partyexample.com
Message: -----BEGIN X509 CERTIFICATE-----
MIICLTCCAZagAwIBAgIBATANBgkqhkiG9w0BAQQFADBNMQswCQYDVQQGEwJVUzEX
&hellip;
6sKTxpg4GP3GkQGcd0r1rhW/3yaWBkDwOdFCqEUyffzU
-----END X509 CERTIFICATE-----</pre></li>
<li><b>The <tt>enigma</tt> administrator would send you the following <tt>enigma</tt> certificate:</b><pre>To: admin@us.partyexample.com
From: admin@ja.enigmaexample.com
Message: -----BEGIN X509 CERTIFICATE-----
MIICKDCCAZGgAwIBAgIBATANBgkqhkiG9w0BAQQFADBJMQswCQYDVQQGEwJVUzEV
&hellip;
jpxfLM98xyFVyLCbkr3dZ3Tvxvi732BXePKF2A==
-----END X509 CERTIFICATE-----</pre></li></ol></li>
<li><a name="iketask-verify-cert-1"></a><b>Verify with the other administrator that the keys have not been tampered with.</b><p>For example, you can phone the other administrator to compare the values of
the public key hash. The public key hash for the shared certificate should
be identical on the two systems. </p><ol style="list-style-type: lower-alpha">
				 
<li><b><a name="indexterm-2086"></a><a name="indexterm-2087"></a><a name="indexterm-2088"></a>List the stored certificate on your system.</b><p>For example, on the <tt>partym</tt> system, the public certificate is in slot 1, and
the private certificate is in slot 0.</p><pre>partym # <tt><b>ikecert certdb -l</b></tt>
Certificate Slot Name: 0   Type: rsa-md5 Private Key
    Subject Name: &lt;C=US, O=PartyCompany, OU=US-Partym, CN=Partym>
    Key Size: 1024
    Public key hash: B2BD13FCE95FD27ECE6D2DCD0DE760E2

Certificate Slot Name: 1   Type: rsa-md5 Public Certificate
    (Private key in certlocal slot 0) Points to certificate's private key
    Subject Name: &lt;C=JA, O=EnigmaCo, OU=JA-Enigmax, CN=Enigmax>
    Key Size: 1024
    Public key hash: <tt><b>2239A6A127F88EE0CB40F7C24A65B818</b></tt></pre></li>
<li><b>Compare this value with the public key hash on the <tt>enigma</tt> system.</b><p>You can read the public key hash over the phone.</p><pre>enigma # <tt><b>ikecert certdb -l</b></tt>
Certificate Slot Name: 4   Type: rsa-md5 Private Key
    Subject Name: &lt;C=JA, O=EnigmaCo, OU=JA-Enigmax, CN=Enigmax>
    Key Size: 1024
    Public key hash: DF3F108F6AC669C88C6BD026B0FCE3A0

Certificate Slot Name: 5   Type: rsa-md5 Public Certificate
    (Private key in certlocal slot 4)
    Subject Name: &lt;C=US, O=PartyCompany, OU=US-Partym, CN=Partym>
    Key Size: 1024
    Public key hash: <tt><b>2239A6A127F88EE0CB40F7C24A65B818</b></tt></pre></li></ol></li>
<li><b><a name="indexterm-2089"></a>On each system, trust both certificates.</b><p>Edit the <tt>/etc/inet/ike/config</tt> file to recognize the certificates.</p><p><a name="indexterm-2090"></a><a name="indexterm-2091"></a>The administrator of the remote system provides the values for the <tt>cert_trust</tt>, <tt>remote_addr</tt>,
and <tt>remote_id</tt> parameters.</p><ol style="list-style-type: lower-alpha">
				 
<li><b>For example, on the <tt>partym</tt> system, the <tt>ike/config</tt> file would appear similar
to the following:</b><pre># Explicitly trust the following self-signed certs
# Use the Subject Alternate Name to identify the cert

# Verified remote address and remote ID
# Verified public key hash per phone call from administrator
cert_trust "192.168.13.213" Local system's certificate Subject Alt Name
cert_trust "192.168.116.16" Remote system's certificate Subject Alt Name

## Parameters that may also show up in rules.

p1_xform 
  { auth_method preshared oakley_group 5 auth_alg sha encr_alg des }
p2_pfs 5

{
 label "US-partym to JA-enigmax"
 local_id_type dn
 local_id "C=US, O=PartyCompany, OU=US-Partym, CN=Partym"
 remote_id "C=JA, O=EnigmaCo, OU=JA-Enigmax, CN=Enigmax"

 local_addr  192.168.13.213
 remote_addr 192.168.116.16

 p1_xform
  {auth_method rsa_sig oakley_group 2 auth_alg md5 encr_alg 3des}
}</pre></li>
<li><b>On the <tt>enigma</tt> system, add <tt>enigma</tt> values for local parameters in the <tt>ike/config</tt>
file.</b><p>For the remote parameters, use <tt>partym</tt> values. Ensure that the value for the <tt>label</tt>
keyword is unique. This value must be different from the remote system's <tt>label</tt>
value.</p><pre>&hellip;
{
 label "JA-enigmax to US-partym"
 local_id_type dn
 local_id "C=JA, O=EnigmaCo, OU=JA-Enigmax, CN=Enigmax"
 remote_id "C=US, O=PartyCompany, OU=US-Partym, CN=Partym"

 local_addr  192.168.116.16
 remote_addr 192.168.13.213
&hellip;</pre></li></ol></li>
<li><b><a name="indexterm-2092"></a><a name="indexterm-2093"></a>On each system, add the certificate that you received. </b><ol style="list-style-type: lower-alpha">
				 
<li><b>Copy the public key from the administrator's email.</b></li>
<li><b>Type the <tt>ikecert certdb -a</tt> command and press the Return key. </b><p>No prompts display when you press the Return key.</p><pre># <tt><b>ikecert certdb -a</b></tt> Press the Return key</pre></li>
<li><b>Paste the public key. Then press the Return key. To end the entry,
press Control-D.</b><pre><tt><b>-----BEGIN X509 CERTIFICATE----- MIIC&hellip; &hellip; ----END X509 CERTIFICATE-----</b></tt> Press the Return key
<tt><b>&lt;Control>-D</b></tt></pre></li></ol></li></ol><a name="ike-task-51"></a>Example&nbsp;23-2 Giving a Start Time and an End Time to a Certificate<p>The administrator on the machine <tt>partym</tt> establishes dates within which the certificate is
valid. The certificate is backdated by 2 1/2 days, and is valid for
4 years and 6 months from the date of creation.</p><pre># <tt><b>ikecert certlocal -ks -m 1024 -t rsa-md5 \</b></tt>
<tt><b>-D "C=US, O=PartyCompany, OU=US-Partym, CN=Partym" \</b></tt>
<tt><b>-A IP=192.168.13.213 \</b></tt>
<tt><b>-S -2d12h -F +4y6m</b></tt></pre><p>The administrator on the machine <tt>enigma</tt> establishes dates within which the certificate is
valid. The certificate is backdated by 2 days, and is valid until midnight
of December 31, 2010.</p><pre># <tt><b>ikecert certlocal -ks -m 1024 -t rsa-md5 \</b></tt>
<tt><b>-D "C=JA, O=EnigmaCo, OU=JA-Enigmax, CN=Enigmax" \</b></tt>
<tt><b>-A IP=192.168.116.16 \</b></tt>
<tt><b>-S -2d -F "12/31/2010 12:00 AM"</b></tt></pre>

<a name="ike-task-41"></a><h4>How to Configure IKE With Certificates Signed by a CA</h4><a name="indexterm-2094"></a><a name="indexterm-2095"></a><a name="indexterm-2096"></a><a name="indexterm-2097"></a><p>Public certificates from a Certificate Authority (CA) require negotiation with an outside organization.
The certificates very easily scale to protect a large number of communicating systems.</p><ol>
<li><b>On the system console, assume the Primary Administrator role or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p>
<hr><p><b>Note - </b>Logging in remotely exposes security-critical traffic to eavesdropping. Even if you somehow protect
the remote login, the security of the system is reduced to the security
of the remote login session.</p>
<hr>
</li>
<li><b><a name="indexterm-2098"></a><a name="indexterm-2099"></a><a name="indexterm-2100"></a><a name="indexterm-2101"></a><a name="indexterm-2102"></a><a name="indexterm-2103"></a>Use the <tt>ikecert certlocal -kc</tt> command to create a certificate request.</b><p>For a description of the arguments to the command, see <a href="#ike-task-step-ksgen-1">Step&nbsp;2</a> in <a href="#ike-task-42">How to Configure IKE With Self-Signed Public Key Certificates</a>.</p><pre># ikecert certlocal -kc -m <i>keysize</i> -t <i>keytype</i> \
-D <i>dname</i> -A <i>altname</i></pre><ol style="list-style-type: lower-alpha">
				 
<li><b>For example, the following command creates a certificate request on the <tt>partym</tt> system:</b><pre># <tt><b>ikecert certlocal -kc -m 1024 -t rsa-md5 \</b></tt>
> <tt><b>-D "C=US, O=PartyCompany\, Inc., OU=US-Partym, CN=Partym" \</b></tt>
> <tt><b>-A "DN=C=US, O=PartyCompany\, Inc., OU=US-Partym"</b></tt>
Creating software private keys.
  Writing private key to file /etc/inet/secret/ike.privatekeys/2.
Enabling external key providers - done.
Certificate Request: 
  Proceeding with the signing operation.
  Certificate request generated successfully (&hellip;/publickeys/0)
Finished successfully.
-----BEGIN CERTIFICATE REQUEST-----
MIIByjCCATMCAQAwUzELMAkGA1UEBhMCVVMxHTAbBgNVBAoTFEV4YW1wbGVDb21w
&hellip;
lcM+tw0ThRrfuJX9t/Qa1R/KxRlMA3zckO80mO9X
-----END CERTIFICATE REQUEST-----</pre></li>
<li><b>The following command creates a certificate request on the <tt>enigma</tt> system:</b><pre># <tt><b>ikecert certlocal -kc -m 1024 -t rsa-md5 \</b></tt>
> <tt><b>-D "C=JA, O=EnigmaCo\, Inc., OU=JA-Enigmax, CN=Enigmax" \</b></tt>
> <tt><b>-A "DN=C=JA, O=EnigmaCo\, Inc., OU=JA-Enigmax"</b></tt>
Creating software private keys.
&hellip;
Finished successfully.
-----BEGIN CERTIFICATE REQUEST-----
MIIBuDCCASECAQAwSTELMAkGA1UEBhMCVVMxFTATBgNVBAoTDFBhcnR5Q29tcGFu
&hellip;
8qlqdjaStLGfhDOO
-----END CERTIFICATE REQUEST-----</pre></li></ol></li>
<li><a name="ike-task-pki-1"></a><b>Submit the certificate request to a PKI organization.</b><p><a name="indexterm-2104"></a>The PKI organization can tell you how to submit the certificate request. Most
organizations have a web site with a submission form. The form requires proof
that the submission is legitimate. Typically, you paste your certificate request into the
form. When your request has been checked by the organization, the organization issues
you the following two certificate objects and a list of revoked certificates:</p>
<ul><li><p>Your public key certificate &ndash; This certificate is based on the request that you submitted to the organization. The request that you submitted is part of this public key certificate. The certificate uniquely identifies you.</p></li>
<li><p>A Certificate Authority &ndash; The organization's signature. The CA verifies that your public key certificate is legitimate.</p></li>
<li><p>A Certificate Revocation List (CRL) &ndash; The latest list of certificates that the organization has revoked. The CRL is not sent separately as a certificate object if access to the CRL is embedded in the public key certificate.</p><p>When a URI for the CRL is embedded in the public key certificate, IKE can automatically retrieve the CRL for you. Similarly, when a DN (directory name on an LDAP server) entry is embedded in the public key certificate, IKE can retrieve and cache the CRL from an LDAP server that you specify.</p><p>See <a href="#ike-task-22">How to Handle a Certificate Revocation List</a> for an example of an embedded URI and an embedded DN entry in a public key certificate.</p></li></ul>
</li>
<li><b><a name="indexterm-2105"></a><a name="indexterm-2106"></a><a name="indexterm-2107"></a><a name="indexterm-2108"></a><a name="indexterm-2109"></a><a name="indexterm-2110"></a>Add each certificate to your system.</b><p>The <tt>-a</tt> option to the <tt>ikecert certdb -a</tt> adds the pasted object to the appropriate certificate
database on your system. For more information, see <a href="ike-5.html#ike-29">IKE With Public Key Certificates</a>.</p><ol style="list-style-type: lower-alpha">
				 
<li><b>On the system console, assume the Primary Administrator role or become superuser.</b></li>
<li><b>Add the public key certificate that you received from the PKI organization.</b><pre># <tt><b>ikecert certdb -a</b></tt>
Press the Return key
Paste the certificate:
<tt><b>-----BEGIN X509 CERTIFICATE----- &hellip; -----END X509 CERTIFICATE----</b></tt>
Press the Return key
<tt><b>&lt;Control>-D</b></tt></pre></li>
<li><b>Add the CA from the PKI organization.</b><pre># <tt><b>ikecert certdb -a</b></tt>
Press the Return key
Paste the CA:
<tt><b>-----BEGIN X509 CERTIFICATE----- &hellip; -----END X509 CERTIFICATE----</b></tt>
Press the Return key
<tt><b>&lt;Control>-D</b></tt></pre></li>
<li><b>If the PKI organization has sent a list of revoked certificates, add the
CRL to the <tt>certrldb</tt> database:</b><pre># <tt><b>ikecert certrldb -a</b></tt>
Press the Return key
Paste the CRL:
<tt><b>-----BEGIN CRL----- &hellip; -----END CRL----</b></tt>
Press the Return key
<tt><b>&lt;Control>-D</b></tt></pre></li></ol></li>
<li><b><a name="indexterm-2111"></a><a name="indexterm-2112"></a><a name="indexterm-2113"></a>Use the <tt>cert_root</tt> keyword to identify the PKI organization in the <tt>/etc/inet/ike/config</tt> file.</b><p>Use the name that the PKI organization provides.</p><ol style="list-style-type: lower-alpha">
				 
<li><b>For example, the <tt>ike/config</tt> file on the <tt>partym</tt> system might appear similar to
the following:</b><pre># Trusted root cert
# This certificate is from Example PKI
# This is the X.509 distinguished name for the CA that it issues.

<tt><b>cert_root "C=US, O=ExamplePKI\, Inc., OU=PKI-Example, CN=Example PKI"</b></tt>

## Parameters that may also show up in rules.

p1_xform 
 { auth_method rsa_sig oakley_group 1 auth_alg sha1 encr_alg des }
p2_pfs 2

{
 label "US-partym to JA-enigmax - Example PKI"
 local_id_type dn
 local_id  "C=US, O=PartyCompany, OU=US-Partym, CN=Partym"
 remote_id "C=JA, O=EnigmaCo, OU=JA-Enigmax, CN=Enigmax"

 local_addr  192.168.13.213
 remote_addr 192.168.116.16

 p1_xform
  {auth_method rsa_sig oakley_group 2 auth_alg md5 encr_alg 3des}
}</pre>
<hr><p><b>Note - </b>All arguments to the <tt>auth_method</tt> parameter must be on the same line. </p>
<hr>
</li>
<li><b>On the <tt>enigma</tt> system, create a similar file.</b><p>Specifically, the <tt>enigma</tt> <tt>ike/config</tt> file should do the following:</p>
<ul><li><p>Include the same <tt>cert_root</tt> value.</p></li>
<li><p>Use <tt>enigma</tt> values for local parameters.</p></li>
<li><p>Use <tt>partym</tt> values for remote parameters.</p></li>
<li><p>Create a unique value for the <tt>label</tt> keyword. This value must be different from the remote system's <tt>label</tt> value.</p></li></ul>
<pre>&hellip;
cert_root "C=US, O=ExamplePKI\, Inc., OU=PKI-Example, CN=Example PKI"
&hellip;
{
 label "JA-enigmax to US-partym - Example PKI"
 local_id_type dn
 local_id   "C=JA, O=EnigmaCo, OU=JA-Enigmax, CN=Enigmax"
 remote_id  "C=US, O=PartyCompany, OU=US-Partym, CN=Partym"
 
 local_addr  192.168.116.16
 remote_addr 192.168.13.213
&hellip;</pre></li></ol></li>
<li><a name="ike-task-trcert-1"></a><b><a name="indexterm-2114"></a><a name="indexterm-2115"></a><a name="indexterm-2116"></a><a name="indexterm-2117"></a>Tell IKE how to handle CRLs.</b><p>Choose the appropriate option:</p><ul>
<li><b>No CRL available</b><p>If the PKI organization does not provide a CRL, add the keyword <tt>ignore_crls</tt>
to the <tt>ike/config</tt> file.</p><pre># Trusted root cert
&hellip;
cert_root "C=US, O=ExamplePKI\, Inc., OU=PKI-Example,&hellip;
<tt><b>ignore_crls</b></tt>
&hellip;</pre><p>The <tt>ignore_crls</tt> keyword tells IKE not to search for CRLs.</p></li>
<li><b>CRL available</b><p>If the PKI organization provides a central distribution point for CRLs, you can
modify the <tt>ike/config</tt> file to point to that location.</p><p>See <a href="#ike-task-22">How to Handle a Certificate Revocation List</a> for examples.</p></li></ul></li></ol><a name="ike-task-45"></a>Example&nbsp;23-3 Using <tt>rsa_encrypt</tt> When Configuring IKE<p>When you use <tt>auth_method rsa_encrypt</tt> in the <tt>ike/config</tt> file, you must add the
peer's certificate to the <tt>publickeys</tt> database.</p>
<ol><li><p>Send the certificate to the remote system's administrator. </p><p>You can paste the certificate into an email.</p><p>For example, the <tt>partym</tt> administrator would send the following email:</p><pre>To: admin@ja.enigmaexample.com
From: admin@us.partyexample.com
Message: -----BEGIN X509 CERTIFICATE-----
MII&hellip;
----END X509 CERTIFICATE-----</pre><p>The <tt>enigma</tt> administrator would send the following email:</p><pre>To: admin@us.partyexample.com
From: admin@ja.enigmaexample.com
Message: -----BEGIN X509 CERTIFICATE-----
MII
&hellip;
-----END X509 CERTIFICATE-----</pre></li>
<li><p>On each system, add the emailed certificate to the local <tt>publickeys</tt> database. </p><pre># <tt><b>ikecert certdb -a</b></tt>
Press the Return key
<tt><b>-----BEGIN X509 CERTIFICATE----- MII&hellip; -----END X509 CERTIFICATE-----</b></tt>
Press the Return key
<tt><b>&lt;Control>-D</b></tt></pre></li></ol>
<p>The authentication method for RSA encryption hides identities in IKE from eavesdroppers. Because
the <tt>rsa_encrypt</tt> method hides the peer's identity, IKE cannot retrieve the peer's certificate.
As a result, the <tt>rsa_encrypt</tt> method requires that the IKE peers know each other's
public keys.</p><p>Therefore, when you use an <tt>auth_method</tt> of <tt>rsa_encrypt</tt> in the <tt>/etc/inet/ike/config</tt> file,
you must add the peer's certificate to the <tt>publickeys</tt> database. The <tt>publickeys</tt> database then
holds three certificates for each communicating pair of systems:</p>
<ul><li><p>Your public key certificate</p></li>
<li><p>The CA certificate</p></li>
<li><p>The peer's public key certificate</p></li></ul>
<p><a name="indexterm-2118"></a><b>Troubleshooting &ndash;</b> The IKE payload, which includes the three certificates, can become too large
for <tt>rsa_encrypt</tt> to encrypt. Errors such as &ldquo;authorization failed&rdquo; and &ldquo;malformed payload&rdquo; can
indicate that the <tt>rsa_encrypt</tt> method cannot encrypt the total payload. Reduce the size
of the payload by using a method, such as <tt>rsa_sig</tt>, that requires only
two certificates.</p>

<a name="ike-task-14"></a><h4>How to Generate and Store Public Key Certificates on Hardware</h4><a name="indexterm-2119"></a><p>Generating and storing public key certificates on hardware is similar to generating and
storing public key certificates on your system. On hardware, the <tt>ikecert certlocal</tt> and
<tt>ikecert certdb</tt> commands must identify the hardware. The <tt>-T</tt> option with the token ID
identifies the hardware to the commands.</p><h6>Before You Begin</h6>
<ul><li><p>The hardware must be configured.</p></li>
<li><p>The hardware uses the <tt>/usr/lib/libpkcs11.so</tt> library unless the <tt>pkcs11_path</tt> keyword in the <tt>/etc/inet/ike/config</tt> file points to a different library. The library must be implemented according to the following standard: RSA Security Inc. PKCS&nbsp;#11 Cryptographic Token Interface (Cryptoki), that is, a PKCS&nbsp;#11 library.</p><p><a name="indexterm-2120"></a><a name="indexterm-2121"></a>See <a href="ike-task-35.html#ike-task-11">How to Configure IKE to Find the Sun Crypto Accelerator 4000 Board</a> for setup instructions.</p></li></ul>
<ol>
<li><b>On the system console, assume the Primary Administrator role or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p>
<hr><p><b>Note - </b><a name="indexterm-2122"></a>Logging in remotely exposes security-critical traffic to eavesdropping. Even if you somehow protect
the remote login, the security of the system is reduced to the security
of the remote login session.</p>
<hr>
</li>
<li><b><a name="indexterm-2123"></a><a name="indexterm-2124"></a><a name="indexterm-2125"></a><a name="indexterm-2126"></a>Generate a self-signed certificate or a certificate request, and specify the token ID.</b><p>Choose one of the following options:</p>
<hr><p><b>Note - </b>The Sun Crypto Accelerator 4000 board supports keys up to 2048 bits
for RSA. For DSA, this board supports keys up to 1024 bits.</p>
<hr>
<ul>
<li><b>For a self-signed certificate, use this syntax.</b><pre># <tt><b>ikecert certlocal -ks -m 1024 -t rsa-md5 \</b></tt>
> <tt><b>-D "C=US, O=PartyCompany, OU=US-Partym, CN=Partym" \</b></tt>
> <tt><b>-a -T dca0-accel-stor IP=192.168.116.16</b></tt>
Creating hardware private keys.
Enter PIN for PKCS#11 token: Type user:password</pre><p>The argument to the <tt>-T</tt> option is the token ID from the attached
Sun Crypto Accelerator 4000 board.</p></li>
<li><b><a name="indexterm-2127"></a><a name="indexterm-2128"></a>For a certificate request, use this syntax.</b><pre># <tt><b>ikecert certlocal -kc -m 1024 -t rsa-md5 \</b></tt>
> <tt><b>-D "C=US, O=PartyCompany, OU=US-Partym, CN=Partym" \</b></tt>
> <tt><b>-a -T dca0-accel-stor IP=192.168.116.16</b></tt>
Creating hardware private keys.
Enter PIN for PKCS#11 token: Type user:password</pre></li></ul><p>For a description of the arguments to the <tt>ikecert</tt> command, see the <a href="http://docs.sun.com/doc/819-2240/ikecert-1m?a=view"><tt>ikecert</tt>(1M)</a>
man page.</p></li>
<li><a name="ike-task-pin-1"></a><b>At the prompt for a PIN, type the Sun Crypto Accelerator 4000
user, a colon, and the user's password. </b><p>If the Sun Crypto Accelerator 4000 board has a user <tt>ikemgr</tt> whose
password is <tt>rgm4tigt</tt>, you would type the following:</p><pre>Enter PIN for PKCS#11 token: <tt><b>ikemgr:rgm4tigt</b></tt></pre>
<hr><p><b>Note - </b>The PIN response is stored on disk <b>as clear text</b>.</p>
<hr>
<p>After you type the password, the certificate prints out:</p><pre>Enter PIN for PKCS#11 token: <tt><b>ikemgr:rgm4tigt</b></tt>
-----BEGIN X509 CERTIFICATE-----
MIIBuDCCASECAQAwSTELMAkGA1UEBhMCVVMxFTATBgNVBAoTDFBhcnR5Q29tcGFu
&hellip;
oKUDBbZ9O/pLWYGr
-----END X509 CERTIFICATE-----</pre></li>
<li><b>Send your certificate for use by the other party.</b><p>Choose one of the following options:</p><ul>
<li><b>Send the self-signed certificate to the remote system.</b><p>You can paste the certificate into an email.</p></li>
<li><b>Send the certificate request to an organization that handles PKI.</b><p>Follow the instructions of the PKI organization to submit the certificate request. For
a more detailed discussion, see <a href="#ike-task-pki-1">Step&nbsp;3</a> of <a href="#ike-task-41">How to Configure IKE With Certificates Signed by a CA</a>.</p></li></ul></li>
<li><b><a name="indexterm-2129"></a><a name="indexterm-2130"></a>On your system, edit the <tt>/etc/inet/ike/config</tt> file to recognize the certificates.</b><p>Choose one of the following options.</p><ul>
<li><b><a name="indexterm-2131"></a><a name="indexterm-2132"></a>Self-signed certificate</b><p>Use the values that the administrator of the remote system provides for the
<tt>cert_trust</tt>, <tt>remote_id</tt>, and <tt>remote_addr</tt> parameters. For example, on the <tt>enigma</tt> system, the <tt>ike/config</tt>
file would appear similar to the following:</p><pre># Explicitly trust the following self-signed certs
# Use the Subject Alternate Name to identify the cert

cert_trust "192.168.116.16"  Local system's certificate Subject Alt Name
cert_trust "192.168.13.213"  Remote system's certificate Subject Alt name


# Solaris 10 1/06 release: default path does not have to be typed in
#pkcs11_path "/usr/lib/libpkcs11.so" Hardware connection

# Solaris 10 release: use this path
#pkcs11_path "/opt/SUNWconn/cryptov2/lib/libvpkcs11.so"
&hellip;
{
 label "JA-enigmax to US-partym"
 local_id_type dn
 local_id "C=JA, O=EnigmaCo, OU=JA-Enigmax, CN=Enigmax"
 remote_id "C=US, O=PartyCompany, OU=US-Partym, CN=Partym"

 local_addr  192.168.116.16
 remote_addr 192.168.13.213

 p1_xform
  {auth_method rsa_sig oakley_group 2 auth_alg md5 encr_alg 3des}
}</pre></li>
<li><b>Certificate request</b><p><a name="indexterm-2133"></a><a name="indexterm-2134"></a><a name="indexterm-2135"></a>Type the name that the PKI organization provides as the value for the
<tt>cert_root</tt> keyword. For example, the <tt>ike/config</tt> file on the <tt>enigma</tt> system might
appear similar to the following:</p><pre># Trusted root cert
# This certificate is from Example PKI
# This is the X.509 distinguished name for the CA that it issues.

cert_root "C=US, O=ExamplePKI\, Inc., OU=PKI-Example, CN=Example PKI"

# Solaris 10 1/06 release: default path does not have to be typed in
#pkcs11_path "/usr/lib/libpkcs11.so" Hardware connection

# Solaris 10 release: use this path
#pkcs11_path "/opt/SUNWconn/cryptov2/lib/libvpkcs11.so"
&hellip;
{
 label "JA-enigmax to US-partym - Example PKI"
 local_id_type dn
 local_id "C=JA, O=EnigmaCo, OU=JA-Enigmax, CN=Enigmax"
 remote_id  "C=US, O=PartyCompany, OU=US-Partym, CN=Partym"

 local_addr  192.168.116.16
 remote_addr 192.168.13.213

 p1_xform
  {auth_method rsa_sig oakley_group 2 auth_alg md5 encr_alg 3des}
}</pre></li></ul></li>
<li><b>Place the certificates from the other party in the hardware.</b><p>Respond to the PIN request as you responded in <a href="#ike-task-pin-1">Step&nbsp;3</a>.</p>
<hr><p><b>Note - </b>You <b>must</b> add the public key certificates to the same attached hardware that
generated your private key.</p>
<hr>
<ul>
<li><b>Self-signed certificate.</b><p>Add the remote system's self-signed certificate. In this example, the certificate is stored in
the file, <tt>DCA.ACCEL.STOR.CERT</tt>.</p><pre># <tt><b>ikecert certdb -a -T dca0-accel-stor &lt; DCA.ACCEL.STOR.CERT</b></tt>
Enter PIN for PKCS#11 token: Type user:password</pre><p>If the self-signed certificate used <tt>rsa_encrypt</tt> as the value for the <tt>auth_method</tt> parameter,
add the peer's certificate to the hardware store.</p></li>
<li><b><a name="indexterm-2136"></a>Certificates from a PKI organization.</b><p>Add the certificate that the organization generated from your certificate request, and add
the certificate authority (CA).</p><pre># <tt><b>ikecert certdb -a -T dca0-accel-stor &lt; DCA.ACCEL.STOR.CERT</b></tt>
Enter PIN for PKCS#11 token: Type user:password</pre><pre># <tt><b>ikecert certdb -a -T dca0-accel-stor &lt; DCA.ACCEL.STOR.CA.CERT</b></tt>
Enter PIN for PKCS#11 token: Type user:password</pre><p>To add a certificate revocation list (CRL) from the PKI organization, see <a href="#ike-task-22">How to Handle a Certificate Revocation List</a>.</p></li></ul></li></ol>

<a name="ike-task-22"></a><h4>How to Handle a Certificate Revocation List</h4><p>A certificate revocation list (CRL) contains outdated or compromised certificates from a Certificate
Authority. You have four ways to handle CRLs.</p>
<ul><li><p>You must instruct IKE to ignore CRLs if your CA organization does not issue CRLs. This option is shown in <a href="#ike-task-trcert-1">Step&nbsp;6</a> in <a href="#ike-task-41">How to Configure IKE With Certificates Signed by a CA</a>.</p></li>
<li><p><a name="indexterm-2137"></a>You can instruct IKE to access the CRLs from a URI (uniform resource indicator) whose address is embedded in the public key certificate from the CA.</p></li>
<li><p><a name="indexterm-2138"></a>You can instruct IKE to access the CRLs from an LDAP server whose DN (directory name) entry is embedded in the public key certificate from the CA.</p></li>
<li><p><a name="indexterm-2139"></a>You can provide the CRL as an argument to the <tt>ikecert certrldb</tt> command. For an example, see <a href="#ike-task-23">Example&nbsp;23-4</a>.</p></li></ul>
<p>The following procedure describes how to instruct IKE to use CRLs from a
central distribution point.</p><ol>
<li><b><a name="indexterm-2140"></a>Display the certificate that you received from the CA.</b><pre># ikecert certdb -lv <i>certspec</i></pre><dl><dt><tt>-l</tt></dt>
<dd><p>Lists certificates in the IKE certificate database.</p></dd>
<dt><tt>-v</tt></dt>
<dd><p>Lists the certificates in verbose mode. Use this option with care.</p></dd>
<dt><i>certspec</i></dt>
<dd><p>Is a pattern that matches a certificate in the IKE certificate database.</p></dd>
</dl>
<p><a name="indexterm-2141"></a><a name="indexterm-2142"></a>For example, the following certificate was issued by Sun Microsystems. Details have been
altered.</p><pre># <tt><b>ikecert certdb -lv example-protect.sun.com</b></tt>
Certificate Slot Name: 0   Type: dsa-sha1
   (Private key in certlocal slot 0)
 Subject Name: &lt;O=Sun Microsystems Inc, CN=example-protect.sun.com>
 Issuer Name: &lt;CN=Sun Microsystems Inc CA (Cl B), O=Sun Microsystems Inc>
 SerialNumber: 14000D93
   Validity:
      Not Valid Before: 2002 Jul 19th, 21:11:11 GMT
      Not Valid After:  2005 Jul 18th, 21:11:11 GMT
   Public Key Info:
      Public Modulus  (n) (2048 bits): C575A&hellip;A5
      Public Exponent (e) (  24 bits): 010001
   Extensions:
      Subject Alternative Names:
              DNS = example-protect.sun.com
      Key Usage: DigitalSignature KeyEncipherment
      [CRITICAL]
   <tt><b>CRL Distribution Points</b></tt>:
      Full Name:
         URI = #Ihttp://www.sun.com/pki/pkismica.crl#i
         DN = &lt;CN=Sun Microsystems Inc CA (Cl B), O=Sun Microsystems Inc>
      CRL Issuer: 
      Authority Key ID:
      Key ID:              4F &hellip; 6B
      SubjectKeyID:        A5 &hellip; FD
      Certificate Policies
      Authority Information Access</pre><p>Notice the <tt>CRL Distribution Points</tt> entry. The URI entry indicates that this organization's CRL is
available on the web. The DN entry indicates that the CRL is available
on an LDAP server. Once accessed by IKE, the CRL is cached for
further use.</p><p>To access the CRL, you need to reach a distribution point.</p></li>
<li><b>Choose one of the following methods to access the CRL from a
central distribution point.</b><ul>
<li><b><a name="indexterm-2143"></a><a name="indexterm-2144"></a><a name="indexterm-2145"></a>Use the URI.</b><p>Add the keyword <tt>use_http</tt> to the host's <tt>/etc/inet/ike/config</tt> file. For example, the <tt>ike/config</tt>
file would appear similar to the following:</p><pre># Use CRL from organization's URI
<tt><b>use_http</b></tt>
&hellip;</pre></li>
<li><b><a name="indexterm-2146"></a><a name="indexterm-2147"></a>Use a web proxy.</b><p>Add the keyword <tt>proxy</tt> to the <tt>ike/config</tt> file. The <tt>proxy</tt> keyword takes a URL
as an argument, as in the following:</p><pre># Use own web proxy
<tt><b>proxy "http://proxy1:8080"</b></tt></pre></li>
<li><b><a name="indexterm-2148"></a><a name="indexterm-2149"></a>Use an LDAP server.</b><p>Name the LDAP server as an argument to the <tt>ldap-list</tt> keyword in the
host's <tt>/etc/inet/ike/config</tt> file. Your organization provides the name of the LDAP server. The
entry in the <tt>ike/config</tt> file would appear similar to the following:</p><pre># Use CRL from organization's LDAP
ldap-list "ldap1.sun.com:389,ldap2.sun.com"
&hellip;</pre></li></ul><p>IKE retrieves the CRL and caches the CRL until the certificate expires.</p></li></ol><a name="ike-task-23"></a>Example&nbsp;23-4 Pasting a CRL Into the Local <tt>certrldb</tt> Database<p><a name="indexterm-2150"></a><a name="indexterm-2151"></a><a name="indexterm-2152"></a>If the PKI organization's CRL is not available from a central distribution point,
you can add the CRL manually to the local <tt>certrldb</tt> database. Follow the
PKI organization's instructions for extracting the CRL into a file, then add
the CRL to the database with the <tt>ikecert certrldb -a</tt> command.</p><pre># <tt><b>ikecert certrldb -a &lt; Sun.Cert.CRL</b></tt></pre>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ike-task-12.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ike-task-38.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

