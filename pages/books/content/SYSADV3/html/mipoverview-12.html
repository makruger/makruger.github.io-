<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Mobile IP Registration - System Administration Guide: IP Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: IP Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="mipoverview-45.html">Previous</a>
             </td>
             <td align="right">
                 <a href="mipoverview-18.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="iptm-1.html">Part&nbsp;I&nbsp;TCP/IP Administration</a></p>
<p class="toc level2"><a href="ipov-1.html">1.&nbsp;&nbsp;Solaris TCPIP Protocol Suite (Overview)</a></p>
<p class="toc level2"><a href="ipplan-1.html">2.&nbsp;&nbsp;Planning an IPv4 Addressing Scheme (Tasks</a></p>
<p class="toc level2"><a href="ipv6-overview-7.html">3.&nbsp;&nbsp;Planning an IPv6 Addressing Scheme (Overview)</a></p>
<p class="toc level2"><a href="ipv6-planning-1.html">4.&nbsp;&nbsp;Planning an IPv6 Network (Tasks)</a></p>
<p class="toc level2"><a href="ipconfig-1.html">5.&nbsp;&nbsp;Configuring TCP/IP Network Services and IPv4 Addressing (Tasks)</a></p>
<p class="toc level2"><a href="fwawf.html">6.&nbsp;&nbsp;Administering Network Interfaces (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-config-tasks-1.html">7.&nbsp;&nbsp;Enabling IPv6 on a Network (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-admintasks-1.html">8.&nbsp;&nbsp;Administering a TCP/IP Network (Tasks)</a></p>
<p class="toc level2"><a href="gegel.html">9.&nbsp;&nbsp;Troubleshooting Network Problems (Tasks)</a></p>
<p class="toc level2"><a href="ipref-8.html">10.&nbsp;&nbsp;TCP/IP and IPv4 in Depth (Reference)</a></p>
<p class="toc level2"><a href="ipv6-ref-76.html">11.&nbsp;&nbsp;IPv6 in Depth (Reference)</a></p>
<p class="toc level1 tocsp"><a href="dhcptm-1.html">Part&nbsp;II&nbsp;DHCP</a></p>
<p class="toc level2"><a href="dhcp-overview-1.html">12.&nbsp;&nbsp;About Solaris DHCP (Overview)</a></p>
<p class="toc level2"><a href="chap2-26.html">13.&nbsp;&nbsp;Planning for DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="chapter3-20.html">14.&nbsp;&nbsp;Configuring the DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="dhcp-admin-9.html">15.&nbsp;&nbsp;Administering DHCP (Tasks)</a></p>
<p class="toc level2"><a href="eyatl.html">16.&nbsp;&nbsp;Configuring and Administering  DHCP Clients</a></p>
<p class="toc level2"><a href="dhcp-trouble-1.html">17.&nbsp;&nbsp;Troubleshooting DHCP (Reference)</a></p>
<p class="toc level2"><a href="dhcp-ref-4.html">18.&nbsp;&nbsp;DHCP Commands and Files (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipsectm-1.html">Part&nbsp;III&nbsp;IP Security</a></p>
<p class="toc level2"><a href="ipsec-ov-1.html">19.&nbsp;&nbsp;IP Security Architecture (Overview)</a></p>
<p class="toc level2"><a href="ipsec-mgtasks-1.html">20.&nbsp;&nbsp;Configuring IPsec (Tasks)</a></p>
<p class="toc level2"><a href="ipsecref-1.html">21.&nbsp;&nbsp;IP Security Architecture (Reference)</a></p>
<p class="toc level2"><a href="ike-1.html">22.&nbsp;&nbsp;Internet Key Exchange (Overview)</a></p>
<p class="toc level2"><a href="ike-task-1.html">23.&nbsp;&nbsp;Configuring IKE (Tasks)</a></p>
<p class="toc level2"><a href="ikeref-1.html">24.&nbsp;&nbsp;Internet Key Exchange (Reference)</a></p>
<p class="toc level2"><a href="eupsq.html">25.&nbsp;&nbsp;Solaris IP Filter (Overview)</a></p>
<p class="toc level2"><a href="ipfilter-admin-1.html">26.&nbsp;&nbsp;Solaris IP Filter (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="miptm-1.html">Part&nbsp;IV&nbsp;Mobile IP</a></p>
<p class="toc level2"><a href="mipoverview-1.html">27.&nbsp;&nbsp;Mobile IP (Overview)</a></p>
<p class="toc level3"><a href="mipoverview-25.html">Introduction to Mobile IP</a></p>
<p class="toc level3"><a href="mipoverview-29.html">Mobile IP Functional Entities</a></p>
<p class="toc level3"><a href="mipoverview-2.html">How Mobile IP Works</a></p>
<p class="toc level3"><a href="mipoverview-5.html">Agent Discovery</a></p>
<p class="toc level3"><a href="mipoverview-30.html">Care-of Addresses</a></p>
<p class="toc level3"><a href="mipoverview-45.html">Mobile IP With Reverse Tunneling</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Mobile IP Registration</a></p>
</div>
<p class="toc level3"><a href="mipoverview-18.html">Routing Datagrams to and From Mobile Nodes</a></p>
<p class="toc level3"><a href="mipoverview-23.html">Security Considerations for Mobile IP</a></p>
<p class="toc level2 tocsp"><a href="mipimplementing-1.html">28.&nbsp;&nbsp;Administering Mobile IP (Tasks)</a></p>
<p class="toc level2"><a href="mipmanaging-22.html">29.&nbsp;&nbsp;Mobile IP Files and Commands (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipmptm-1.html">Part&nbsp;V&nbsp;IPMP</a></p>
<p class="toc level2"><a href="mpoverview.html">30.&nbsp;&nbsp;Introducing IPMP (Overview)</a></p>
<p class="toc level2"><a href="deploynetmult-56.html">31.&nbsp;&nbsp;Administering IPMP (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ipqostm-1.html">Part&nbsp;VI&nbsp;IP Quality of Service (IPQoS)</a></p>
<p class="toc level2"><a href="ipqos-intro-1.html">32.&nbsp;&nbsp;Introducing IPQoS (Overview)</a></p>
<p class="toc level2"><a href="ipqos-config-planning-1.html">33.&nbsp;&nbsp;Planning for an IPQoS-Enabled Network (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-policy-planning-1.html">34.&nbsp;&nbsp;Creating the IPQoS Configuration File (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-isp-setup-1.html">35.&nbsp;&nbsp;Starting and Maintaining IPQoS (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-accounting-1.html">36.&nbsp;&nbsp;Using Flow Accounting and Statistics Gathering (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-reference-1.html">37.&nbsp;&nbsp;IPQoS in Detail (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="mipoverview-12"></a><h3>Mobile IP Registration</h3>
<p><a name="indexterm-2530"></a><a name="indexterm-2531"></a><a name="indexterm-2532"></a><a name="indexterm-2533"></a>Mobile nodes detect when they have moved from one subnet to another
subnet through the use of agent advertisements. When the mobile node receives an
agent advertisement that indicates that the mobile node has changed locations, the mobile
node registers through a foreign agent. Even though the mobile node might have
acquired its own colocated care-of address, this feature is provided to enable sites
to restrict access to mobility services.</p><p>Mobile IP registration provides a flexible mechanism for mobile nodes to communicate the
current reachability information to the home agent. The registration process enables mobile nodes
to perform the following tasks:</p>
<ul><li><p><a name="indexterm-2534"></a>Request forwarding services when visiting a foreign network</p></li>
<li><p>Inform the home agent of the current care-of address</p></li>
<li><p>Renew a registration that is about to expire</p></li>
<li><p><a name="indexterm-2535"></a><a name="indexterm-2536"></a>Deregister when the mobile node returns home</p></li>
<li><p>Request a reverse tunnel</p></li></ul>
<p><a name="indexterm-2537"></a><a name="indexterm-2538"></a><a name="indexterm-2539"></a><a name="indexterm-2540"></a>Registration messages exchange information between a mobile node, a foreign agent, and the
home agent. Registration creates or modifies a mobility binding at the home agent.
Registration associates the home address of the mobile node with the care-of address
of the mobile node for the specified lifetime.</p><p>The registration process also enables mobile nodes to do the following functions:</p>
<ul><li><p><a name="indexterm-2541"></a>Register with multiple foreign agents</p></li>
<li><p>Deregister specific care-of addresses while retaining other mobility bindings</p></li>
<li><p>Discover the address of a home agent if the mobile node is not configured with this information</p></li></ul>
<p>Mobile IP defines the following registration processes for a mobile node: </p>
<ul><li><p><a name="indexterm-2542"></a><a name="indexterm-2543"></a>If a mobile node registers a foreign agent care-of address, the mobile node is informing the home agent that it is reachable through that foreign agent.</p></li>
<li><p>If a mobile node receives an agent advertisement that requires the mobile node to register through a foreign agent, the mobile node can still attempt to obtain a colocated care-of address. The mobile node can also register with that foreign agent or any other foreign agent on that link.</p></li>
<li><p>If a mobile node uses a colocated care-of address, the mobile node registers directly with the home agent.</p></li>
<li><p><a name="indexterm-2544"></a><a name="indexterm-2545"></a><a name="indexterm-2546"></a><a name="indexterm-2547"></a>If a mobile node returns to the home network, the mobile node deregisters with the home agent.</p></li></ul>
<p><a name="indexterm-2548"></a><a name="indexterm-2549"></a><a name="indexterm-2550"></a>These registration processes involve the exchange of registration requests and registration reply messages.
When the mobile node registers by using a foreign agent, the registration process
takes the following steps, which the subsequent figure shows:</p>
<ol><li><p>The mobile node sends a registration request to the prospective foreign agent to begin the registration process.</p></li>
<li><p>The foreign agent processes the registration request and then relays the request to the home agent.</p></li>
<li><p>The home agent sends a registration reply to the foreign agent to grant or deny the request.</p></li>
<li><p>The foreign agent processes the registration reply and then relays the reply to the mobile node to inform the mobile node of the disposition of the request.</p></li></ol>
<a name="mipoverview-fig-31"></a><h6>Figure&nbsp;27-7 Mobile IP Registration Process</h6><img src="figures/registration.gif" alt="Illustrates a mobile node registering with the home agent through the foreign agent."></img><p>When the mobile node registers directly with the home agent, the registration process
requires only the following steps:</p>
<ul><li><p><a name="indexterm-2551"></a><a name="indexterm-2552"></a>The mobile node sends a registration request to the home agent.</p></li>
<li><p><a name="indexterm-2553"></a>The home agent sends a registration reply to the mobile node that grants or denies the request.</p></li></ul>
<p><a name="indexterm-2554"></a><a name="indexterm-2555"></a>Also, either the foreign agent or the home agent might require a
reverse tunnel. If the foreign agent supports reverse tunneling, the mobile node uses
the registration process to request a reverse tunnel. The mobile node sets the
reverse tunnel flag in the registration request to request a reverse tunnel.</p>

<a name="mipoverview-33"></a><h4>Network Access Identifier (NAI)</h4>
<p>Authentication, authorization, and accounting (AAA) servers, in use within the Internet, provide authentication
and authorization services for dialup computers. These services are likely to be equally
valuable for mobile nodes that use Mobile IP when the nodes attempt to
connect to foreign domains with AAA servers. AAA servers use the Network Access
Identifier (NAI) to identify clients. A mobile node can identify itself by including
the NAI in the Mobile IP registration request.</p><p>Because the NAI is typically used to uniquely identify the mobile node,
the home address of the mobile node is not always necessary to provide
that function. Thus, a mobile node can authenticate itself. Consequently, a mobile node
can be authorized for connection to the foreign domain without even having a
home address. To request that a home address be assigned, a message that
contains the mobile node NAI extension can set the home address field to
zero in the registration request.</p>

<a name="mipoverview-13"></a><h4>Mobile IP Message Authentication</h4>
<a name="indexterm-2556"></a><a name="indexterm-2557"></a><p><a name="indexterm-2558"></a><a name="indexterm-2559"></a><a name="indexterm-2560"></a><a name="indexterm-2561"></a><a name="indexterm-2562"></a><a name="indexterm-2563"></a><a name="indexterm-2564"></a><a name="indexterm-2565"></a><a name="indexterm-2566"></a><a name="indexterm-2567"></a><a name="indexterm-2568"></a>Each mobile node, foreign agent, and home agent supports a mobility security association
between the various Mobile IP components. The security association is indexed by the
security parameter index (SPI) and IP address. In the instance of the mobile
node, this address is the home address of the mobile node. Registration
messages between a mobile node and the home agent are authenticated with the
mobile-home authentication extension. In addition to mobile-home authentication, which is mandatory, you can use
the optional mobile-foreign agent and home-foreign agent authentications.</p>

<a name="mipoverview-14"></a><h4>Mobile Node Registration Request</h4>
<p><a name="indexterm-2569"></a><a name="indexterm-2570"></a><a name="indexterm-2571"></a><a name="indexterm-2572"></a><a name="indexterm-2573"></a><a name="indexterm-2574"></a><a name="indexterm-2575"></a>A mobile node uses a <b>registration request</b> message to register with the home agent.
Thus, the home agent can create or modify a mobility binding for that
mobile node (for example, with a new lifetime). The foreign agent can relay
the registration request to the home agent. However, if the mobile node is
registering a colocated care-of address, then the mobile node can send the
registration request directly to the home agent. If the foreign agent advertises that
registration messages must be sent to the foreign agent, then the mobile node
must send the registration request to the foreign agent.</p>

<a name="mipoverview-15"></a><h4>Registration Reply Message</h4>
<a name="indexterm-2576"></a><a name="indexterm-2577"></a><p><a name="indexterm-2578"></a><a name="indexterm-2579"></a><a name="indexterm-2580"></a><a name="indexterm-2581"></a>A mobility agent returns a <b>registration reply</b> message to a mobile node that has
sent a registration request message. If the mobile node requests service from a
foreign agent, that foreign agent receives the reply from the home agent. Subsequently,
the foreign agent relays the reply to the mobile node. The reply message
contains the necessary codes to inform the mobile node and the foreign agent
about the status of the registration request. The message also contains the lifetime
that is granted by the home agent. The lifetime can be smaller
than the original request. The registration reply can also contain a dynamic home
address assignment.</p>

<a name="mipoverview-16"></a><h4>Foreign Agent Considerations</h4>
<a name="indexterm-2582"></a><p><a name="indexterm-2583"></a><a name="indexterm-2584"></a><a name="indexterm-2585"></a><a name="indexterm-2586"></a>The foreign agent plays a mostly passive role in Mobile IP registration. The
foreign agent adds all mobile nodes that are registered to the visitor
table. The foreign agent relays registration requests between mobile nodes and home agents. Also,
when the foreign agent provides the care-of address, the foreign agent de-encapsulates datagrams
for delivery to the mobile node. The foreign agent also sends periodic
agent advertisement messages to advertise the presence of the foreign agent.</p><p>If home agents and foreign agents support reverse tunnels, and the mobile
node requests a reverse tunnel, the foreign agent then tunnels all the packets
from the mobile node to the home agent. The home agent then sends
the packets to the correspondent node. This process is the reverse of the
home agent tunneling all of the mobile node's packets to the foreign agent
for delivery to the mobile node. A foreign agent that supports reverse tunnels
advertises that the reverse tunnel is supported for registration. Because of the local
policy, the foreign agent can deny a registration request when the reverse tunnel
flag is not set. The foreign agent can only distinguish multiple mobile nodes
with the same (private) IP address when these mobile nodes are visiting different
interfaces on the foreign agent. In the forward tunnel situation, the foreign agent
distinguishes between multiple mobile nodes that share the same private addresses by looking
at the incoming tunnel interface. The incoming tunnel interface maps to a unique
home agent address.</p>

<a name="mipoverview-17"></a><h4>Home Agent Considerations</h4>
<p><a name="indexterm-2587"></a><a name="indexterm-2588"></a><a name="indexterm-2589"></a><a name="indexterm-2590"></a><a name="indexterm-2591"></a><a name="indexterm-2592"></a><a name="indexterm-2593"></a>Home agents play an active role in the registration process. The home agent
receives registration requests from the mobile node. The registration request might be relayed
by the foreign agent. The home agent updates its record of the
mobility bindings for this mobile node. The home agent issues a suitable registration
reply in response to each registration request. The home agent also forwards packets
to the mobile node when the mobile node is away from the home
network.</p><p>A home agent might not have to have a physical subnet configured
for mobile nodes. However, the home agent must recognize the home address of
the mobile node through the <tt>mipagent.conf</tt> file or some other mechanism when the home
agent grants registration. For more information about <tt>mipagent.conf</tt>, refer to <a href="mipimplementing-2.html">Creating the Mobile IP Configuration File</a>.</p><p>A home agent can support private addressed mobile nodes by configuring the
private addressed mobile nodes in the <tt>mipagent.conf</tt> file. The home addresses that are used
by the home agent must be unique.</p>

<a name="mipoverview-32"></a><h4>Dynamic Home Agent Discovery</h4>
<a name="indexterm-2594"></a><p>In some situations, the mobile node might not know the home agent
address when the mobile node attempts to register. If the mobile node does
not know the home agent address, the mobile node can use dynamic home
agent address resolution to learn the address. In this situation, the mobile node
sets the home agent field of the registration request to the subnet-directed broadcast
address of its home network. Each home agent that receives a registration request
with a broadcast destination address rejects the mobile node's registration by returning a
rejection registration reply. By doing so, the mobile node can use the home
agent's unicast IP address that is indicated in the rejection reply when the
mobile node next attempts registration.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="mipoverview-45.html">Previous</a>
             </td>
             <td align="right">
                 <a href="mipoverview-18.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

