<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Planning the Diffserv Network Topology - System Administration Guide: IP Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: IP Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ipqos-config-planning-2.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ipqos-config-planning-7.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="iptm-1.html">Part&nbsp;I&nbsp;TCP/IP Administration</a></p>
<p class="toc level2"><a href="ipov-1.html">1.&nbsp;&nbsp;Solaris TCPIP Protocol Suite (Overview)</a></p>
<p class="toc level2"><a href="ipplan-1.html">2.&nbsp;&nbsp;Planning an IPv4 Addressing Scheme (Tasks</a></p>
<p class="toc level2"><a href="ipv6-overview-7.html">3.&nbsp;&nbsp;Planning an IPv6 Addressing Scheme (Overview)</a></p>
<p class="toc level2"><a href="ipv6-planning-1.html">4.&nbsp;&nbsp;Planning an IPv6 Network (Tasks)</a></p>
<p class="toc level2"><a href="ipconfig-1.html">5.&nbsp;&nbsp;Configuring TCP/IP Network Services and IPv4 Addressing (Tasks)</a></p>
<p class="toc level2"><a href="fwawf.html">6.&nbsp;&nbsp;Administering Network Interfaces (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-config-tasks-1.html">7.&nbsp;&nbsp;Enabling IPv6 on a Network (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-admintasks-1.html">8.&nbsp;&nbsp;Administering a TCP/IP Network (Tasks)</a></p>
<p class="toc level2"><a href="gegel.html">9.&nbsp;&nbsp;Troubleshooting Network Problems (Tasks)</a></p>
<p class="toc level2"><a href="ipref-8.html">10.&nbsp;&nbsp;TCP/IP and IPv4 in Depth (Reference)</a></p>
<p class="toc level2"><a href="ipv6-ref-76.html">11.&nbsp;&nbsp;IPv6 in Depth (Reference)</a></p>
<p class="toc level1 tocsp"><a href="dhcptm-1.html">Part&nbsp;II&nbsp;DHCP</a></p>
<p class="toc level2"><a href="dhcp-overview-1.html">12.&nbsp;&nbsp;About Solaris DHCP (Overview)</a></p>
<p class="toc level2"><a href="chap2-26.html">13.&nbsp;&nbsp;Planning for DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="chapter3-20.html">14.&nbsp;&nbsp;Configuring the DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="dhcp-admin-9.html">15.&nbsp;&nbsp;Administering DHCP (Tasks)</a></p>
<p class="toc level2"><a href="eyatl.html">16.&nbsp;&nbsp;Configuring and Administering  DHCP Clients</a></p>
<p class="toc level2"><a href="dhcp-trouble-1.html">17.&nbsp;&nbsp;Troubleshooting DHCP (Reference)</a></p>
<p class="toc level2"><a href="dhcp-ref-4.html">18.&nbsp;&nbsp;DHCP Commands and Files (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipsectm-1.html">Part&nbsp;III&nbsp;IP Security</a></p>
<p class="toc level2"><a href="ipsec-ov-1.html">19.&nbsp;&nbsp;IP Security Architecture (Overview)</a></p>
<p class="toc level2"><a href="ipsec-mgtasks-1.html">20.&nbsp;&nbsp;Configuring IPsec (Tasks)</a></p>
<p class="toc level2"><a href="ipsecref-1.html">21.&nbsp;&nbsp;IP Security Architecture (Reference)</a></p>
<p class="toc level2"><a href="ike-1.html">22.&nbsp;&nbsp;Internet Key Exchange (Overview)</a></p>
<p class="toc level2"><a href="ike-task-1.html">23.&nbsp;&nbsp;Configuring IKE (Tasks)</a></p>
<p class="toc level2"><a href="ikeref-1.html">24.&nbsp;&nbsp;Internet Key Exchange (Reference)</a></p>
<p class="toc level2"><a href="eupsq.html">25.&nbsp;&nbsp;Solaris IP Filter (Overview)</a></p>
<p class="toc level2"><a href="ipfilter-admin-1.html">26.&nbsp;&nbsp;Solaris IP Filter (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="miptm-1.html">Part&nbsp;IV&nbsp;Mobile IP</a></p>
<p class="toc level2"><a href="mipoverview-1.html">27.&nbsp;&nbsp;Mobile IP (Overview)</a></p>
<p class="toc level2"><a href="mipimplementing-1.html">28.&nbsp;&nbsp;Administering Mobile IP (Tasks)</a></p>
<p class="toc level2"><a href="mipmanaging-22.html">29.&nbsp;&nbsp;Mobile IP Files and Commands (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipmptm-1.html">Part&nbsp;V&nbsp;IPMP</a></p>
<p class="toc level2"><a href="mpoverview.html">30.&nbsp;&nbsp;Introducing IPMP (Overview)</a></p>
<p class="toc level2"><a href="deploynetmult-56.html">31.&nbsp;&nbsp;Administering IPMP (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ipqostm-1.html">Part&nbsp;VI&nbsp;IP Quality of Service (IPQoS)</a></p>
<p class="toc level2"><a href="ipqos-intro-1.html">32.&nbsp;&nbsp;Introducing IPQoS (Overview)</a></p>
<p class="toc level2"><a href="ipqos-config-planning-1.html">33.&nbsp;&nbsp;Planning for an IPQoS-Enabled Network (Tasks)</a></p>
<p class="toc level3"><a href="ipqos-config-planning-2.html">General IPQoS Configuration Planning (Task Map)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Planning the Diffserv Network Topology</a></p>
</div>
<p class="toc level3"><a href="ipqos-config-planning-7.html">Planning the Quality-of-Service Policy</a></p>
<p class="toc level4"><a href="ipqos-config-planning-7.html#ipqos-config-planning-32">How to Prepare a Network for IPQoS</a></p>
<p class="toc level4"><a href="ipqos-config-planning-7.html#ipqos-config-planning-14">How to Define the Classes for Your QoS Policy</a></p>
<p class="toc level4"><a href="ipqos-config-planning-7.html#ipqos-config-planning-42">How to Define Filters in the QoS Policy</a></p>
<p class="toc level4"><a href="ipqos-config-planning-7.html#ipqos-config-planning-16">How to Plan Flow Control</a></p>
<p class="toc level4"><a href="ipqos-config-planning-7.html#ipqos-config-planning-45">How to Plan Forwarding Behavior</a></p>
<p class="toc level4"><a href="ipqos-config-planning-7.html#ipqos-config-planning-18">How to Plan for Flow Accounting</a></p>
<p class="toc level3 tocsp"><a href="ipqos-config-planning-13.html">Introducing the IPQoS Configuration Example</a></p>
<p class="toc level2 tocsp"><a href="ipqos-policy-planning-1.html">34.&nbsp;&nbsp;Creating the IPQoS Configuration File (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-isp-setup-1.html">35.&nbsp;&nbsp;Starting and Maintaining IPQoS (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-accounting-1.html">36.&nbsp;&nbsp;Using Flow Accounting and Statistics Gathering (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-reference-1.html">37.&nbsp;&nbsp;IPQoS in Detail (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="ipqos-config-planning-5"></a><h3>Planning the Diffserv Network Topology</h3>
<p><a name="indexterm-3055"></a><a name="indexterm-3056"></a>To provide differentiated services for your network, you need at least one IPQoS-enabled
system and a Diffserv-aware router. You can expand this basic scenario in a
variety of ways, as explained in this section.</p>

<a name="ipqos-config-planning-3"></a><h4>Hardware Strategies for the Diffserv Network</h4>
<p><a name="indexterm-3057"></a><a name="indexterm-3058"></a>Typically, customers run IPQoS on servers and server consolidations, such as the Sun
Enterprise&trade; 0000 server. Conversely, you can also run IPQoS on desktop systems such
as UltraSPARC&reg; systems, depending on the needs of your network. The following list
describes possible systems for an IPQoS configuration:</p>
<ul><li><p>Solaris systems that offer various services, such as web servers and database servers</p></li>
<li><p>Application servers that offer email, FTP, or other popular network applications</p></li>
<li><p>Web cache servers or proxy servers</p></li>
<li><p>Network of IPQoS-enabled server farms that are managed by Diffserv-aware load balancers</p></li>
<li><p>Firewalls that manage traffic for a single heterogeneous network</p></li>
<li><p>IPQoS systems that are part of a virtual local area network (LAN)</p></li></ul>
<p>You might introduce IPQoS systems into a network topology with already functioning Diffserv-aware
routers. If your router does not currently offer Diffserv, consider the Diffserv solutions
that are offered by Cisco Systems, Juniper Networks, and other router manufacturers. If
the local router does not implement Diffserv, then the router passes marked packets
on to the next hop without evaluating the marks.</p>

<a name="ipqos-config-planning-4"></a><h4>IPQoS Network Topologies</h4>
<p><a name="indexterm-3059"></a><a name="indexterm-3060"></a>This section illustrates IPQoS strategies for various network needs.</p>

<a name="ipqos-config-planning-9"></a><h5>IPQoS on Individual Hosts</h5>
<p><a name="indexterm-3061"></a><a name="indexterm-3062"></a>The following figure shows a single network of IPQoS-enabled systems. </p><a name="ipqos-config-planning-fig-41"></a><h6>Figure&nbsp;33-1 IPQoS Systems on a Network Segment</h6><img src="figures/IPQos-en-hosts.gif" alt="Topology diagram shows a local network with a Diffserv router, and three IPQoS-enabled systems: FTP server, database server, and a web server."></img><p>This network is but one segment of a corporate intranet. By enabling IPQoS
on the application servers and web servers, you can control the rate at
which each IPQoS system releases outgoing traffic. If you make the router Diffserv
aware, you can further control incoming and outgoing traffic.</p><p>The examples in this guide use the &ldquo;IPQoS on an individual host&rdquo; scenario.
For the example topology that is used throughout the guide, see <a href="ipqos-config-planning-13.html#ipqos-config-planning-fig-44">Figure&nbsp;33-4</a>.</p>

<a name="ipqos-config-planning-10"></a><h5>IPQoS on a Network of Server Farms</h5>
<p><a name="indexterm-3063"></a><a name="indexterm-3064"></a>The following figure shows a network with several heterogeneous server farms.</p><a name="ipqos-config-planning-fig-42"></a><h6>Figure&nbsp;33-2 Network of IPQoS-Enabled Server Farms</h6><img src="figures/IPQos-nw-serv-farm.gif" alt="Topology diagram shows a network with a Diffserv router, an IPQoS-enabled load balancer, and three server farms."></img><p>In such a topology, the router is Diffserv aware, and therefore able to
queue and rate both incoming and outgoing traffic. The load balancer is also
Diffserv-aware, and the server farms are IPQoS enabled. The load balancer can provide
additional filtering beyond the router by using selectors such as user ID and
project ID. These selectors are included in the application data.</p><p>This scenario provides flow control and traffic forwarding to manage congestion on the
local network. This scenario also prevents outgoing traffic from the server farms from
overloading other portions of the intranet.</p>

<a name="ipqos-config-planning-11"></a><h5>IPQoS on a Firewall</h5>
<p><a name="indexterm-3065"></a><a name="indexterm-3066"></a>The following figure shows a segment of a corporate network that is secured
from other segments by a firewall.</p><a name="ipqos-config-planning-fig-43"></a><h6>Figure&nbsp;33-3 Network Protected by an IPQoS-Enabled Firewall</h6><img src="figures/IPQos-firewall.gif" alt="Topology diagram shows a network consisting of a Diffserv router, an IPQoS-enabled firewall, a Solaris system, and other hosts."></img><p>In this scenario, traffic flows into a Diffserv-aware router where the packets are
filtered and queued. All incoming traffic that is forwarded by the router then
travels into the IPQoS-enabled firewall. To use IPQoS, the firewall must not bypass
the IP forwarding stack.</p><p>The firewall's security policy determines whether incoming traffic is permitted to enter or
depart the internal network. The QoS policy controls the service levels for incoming
traffic that has passed the firewall. Depending on the QoS policy, outgoing traffic
can also be marked with a forwarding behavior. </p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ipqos-config-planning-2.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ipqos-config-planning-7.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

