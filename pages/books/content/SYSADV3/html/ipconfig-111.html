<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Monitoring and Modifying Transport Layer Services - System Administration Guide: IP Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: IP Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="gcvjj.html">Previous</a>
             </td>
             <td align="right">
                 <a href="fwawf.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="iptm-1.html">Part&nbsp;I&nbsp;TCP/IP Administration</a></p>
<p class="toc level2"><a href="ipov-1.html">1.&nbsp;&nbsp;Solaris TCPIP Protocol Suite (Overview)</a></p>
<p class="toc level2"><a href="ipplan-1.html">2.&nbsp;&nbsp;Planning an IPv4 Addressing Scheme (Tasks</a></p>
<p class="toc level2"><a href="ipv6-overview-7.html">3.&nbsp;&nbsp;Planning an IPv6 Addressing Scheme (Overview)</a></p>
<p class="toc level2"><a href="ipv6-planning-1.html">4.&nbsp;&nbsp;Planning an IPv6 Network (Tasks)</a></p>
<p class="toc level2"><a href="ipconfig-1.html">5.&nbsp;&nbsp;Configuring TCP/IP Network Services and IPv4 Addressing (Tasks)</a></p>
<p class="toc level3"><a href="gcwwj.html">What's New in This Chapter</a></p>
<p class="toc level3"><a href="ipconfig-2a.html">Before You Configure an IPv4 Network (Task Map)</a></p>
<p class="toc level3"><a href="ipconfig-3.html">Determining Host Configuration Modes</a></p>
<p class="toc level3"><a href="ipconfig-2.html">Adding a Subnet to a Network (Task Map)</a></p>
<p class="toc level3"><a href="ipconfig-4.html">Network Configuration Task Map</a></p>
<p class="toc level3"><a href="ipconfig-63.html">Configuring Systems on the Local Network </a></p>
<p class="toc level4"><a href="ipconfig-63.html#ipconfig-64">How to Configure a Host for Local Files Mode</a></p>
<p class="toc level4"><a href="ipconfig-63.html#ipconfig-79">How to Set Up a Network Configuration Server</a></p>
<p class="toc level4"><a href="ipconfig-63.html#ipconfig-90">How to Configure Hosts for Network Client Mode</a></p>
<p class="toc level4"><a href="ipconfig-63.html#gbwxb">How to Change the IPv4 Address and Other Network Configuration Parameters</a></p>
<p class="toc level3 tocsp"><a href="gcvjj.html">Packet Forwarding and Routing on IPv4 Networks</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Monitoring and Modifying Transport Layer Services</a></p>
<p class="toc level4"><a href="#ipconfig-6">How to Log the IP Addresses of All Incoming TCP Connections</a></p>
<p class="toc level4"><a href="#ermig">How to Add Services That Use the SCTP Protocol</a></p>
<p class="toc level4"><a href="#ipconfig-86">How to Use TCP Wrappers to Control Access to TCP Services</a></p>
</div>
<p class="toc level2 tocsp"><a href="fwawf.html">6.&nbsp;&nbsp;Administering Network Interfaces (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-config-tasks-1.html">7.&nbsp;&nbsp;Enabling IPv6 on a Network (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-admintasks-1.html">8.&nbsp;&nbsp;Administering a TCP/IP Network (Tasks)</a></p>
<p class="toc level2"><a href="gegel.html">9.&nbsp;&nbsp;Troubleshooting Network Problems (Tasks)</a></p>
<p class="toc level2"><a href="ipref-8.html">10.&nbsp;&nbsp;TCP/IP and IPv4 in Depth (Reference)</a></p>
<p class="toc level2"><a href="ipv6-ref-76.html">11.&nbsp;&nbsp;IPv6 in Depth (Reference)</a></p>
<p class="toc level1 tocsp"><a href="dhcptm-1.html">Part&nbsp;II&nbsp;DHCP</a></p>
<p class="toc level2"><a href="dhcp-overview-1.html">12.&nbsp;&nbsp;About Solaris DHCP (Overview)</a></p>
<p class="toc level2"><a href="chap2-26.html">13.&nbsp;&nbsp;Planning for DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="chapter3-20.html">14.&nbsp;&nbsp;Configuring the DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="dhcp-admin-9.html">15.&nbsp;&nbsp;Administering DHCP (Tasks)</a></p>
<p class="toc level2"><a href="eyatl.html">16.&nbsp;&nbsp;Configuring and Administering  DHCP Clients</a></p>
<p class="toc level2"><a href="dhcp-trouble-1.html">17.&nbsp;&nbsp;Troubleshooting DHCP (Reference)</a></p>
<p class="toc level2"><a href="dhcp-ref-4.html">18.&nbsp;&nbsp;DHCP Commands and Files (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipsectm-1.html">Part&nbsp;III&nbsp;IP Security</a></p>
<p class="toc level2"><a href="ipsec-ov-1.html">19.&nbsp;&nbsp;IP Security Architecture (Overview)</a></p>
<p class="toc level2"><a href="ipsec-mgtasks-1.html">20.&nbsp;&nbsp;Configuring IPsec (Tasks)</a></p>
<p class="toc level2"><a href="ipsecref-1.html">21.&nbsp;&nbsp;IP Security Architecture (Reference)</a></p>
<p class="toc level2"><a href="ike-1.html">22.&nbsp;&nbsp;Internet Key Exchange (Overview)</a></p>
<p class="toc level2"><a href="ike-task-1.html">23.&nbsp;&nbsp;Configuring IKE (Tasks)</a></p>
<p class="toc level2"><a href="ikeref-1.html">24.&nbsp;&nbsp;Internet Key Exchange (Reference)</a></p>
<p class="toc level2"><a href="eupsq.html">25.&nbsp;&nbsp;Solaris IP Filter (Overview)</a></p>
<p class="toc level2"><a href="ipfilter-admin-1.html">26.&nbsp;&nbsp;Solaris IP Filter (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="miptm-1.html">Part&nbsp;IV&nbsp;Mobile IP</a></p>
<p class="toc level2"><a href="mipoverview-1.html">27.&nbsp;&nbsp;Mobile IP (Overview)</a></p>
<p class="toc level2"><a href="mipimplementing-1.html">28.&nbsp;&nbsp;Administering Mobile IP (Tasks)</a></p>
<p class="toc level2"><a href="mipmanaging-22.html">29.&nbsp;&nbsp;Mobile IP Files and Commands (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipmptm-1.html">Part&nbsp;V&nbsp;IPMP</a></p>
<p class="toc level2"><a href="mpoverview.html">30.&nbsp;&nbsp;Introducing IPMP (Overview)</a></p>
<p class="toc level2"><a href="deploynetmult-56.html">31.&nbsp;&nbsp;Administering IPMP (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ipqostm-1.html">Part&nbsp;VI&nbsp;IP Quality of Service (IPQoS)</a></p>
<p class="toc level2"><a href="ipqos-intro-1.html">32.&nbsp;&nbsp;Introducing IPQoS (Overview)</a></p>
<p class="toc level2"><a href="ipqos-config-planning-1.html">33.&nbsp;&nbsp;Planning for an IPQoS-Enabled Network (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-policy-planning-1.html">34.&nbsp;&nbsp;Creating the IPQoS Configuration File (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-isp-setup-1.html">35.&nbsp;&nbsp;Starting and Maintaining IPQoS (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-accounting-1.html">36.&nbsp;&nbsp;Using Flow Accounting and Statistics Gathering (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-reference-1.html">37.&nbsp;&nbsp;IPQoS in Detail (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="ipconfig-111"></a><h3>Monitoring and Modifying Transport Layer Services</h3>
<p><a name="indexterm-599"></a><a name="indexterm-600"></a><a name="indexterm-601"></a><a name="indexterm-602"></a><a name="indexterm-603"></a><a name="indexterm-604"></a><a name="indexterm-605"></a>The transport layer protocols TCP, SCTP, and UDP are part of the standard
Solaris OS package. These protocols typically need no intervention to run properly. However,
circumstances at your site might require you to log or modify services that
run over the transport layer protocols. Then, you must modify the profiles for
these services by using the Service Management Facility (SMF), which is described in
<a href="http://docs.sun.com/doc/819-2379/hbrunlevels-25516?a=view">Chapter 14, Managing Services (Overview), in <i>System Administration Guide: Basic Administration</i></a>. </p><p>The <tt>inetd</tt> daemon is responsible for starting standard Internet services when a system
boots. These services include applications that use TCP, SCTP, or UDP as their
transport layer protocol. You can modify existing Internet services or add new services
using the SMF commands. For more information about <tt>inetd</tt>, refer to <a href="ipv6-ref-32.html"><tt>inetd</tt> Internet Services Daemon</a>.</p><p>Operations that involve the transport layer protocols include:</p>
<ul><li><p>Logging of all incoming TCP connections</p></li>
<li><p>Adding services that run over a transport layer protocol, using SCTP as an example</p></li>
<li><p>Configuring the TCP wrappers facility for access control</p></li></ul>
<p>For detailed information on the <tt>inetd</tt> daemon refer to the <a href="http://docs.sun.com/doc/819-2240/inetd-1m?a=view"><tt>inetd</tt>(1M)</a>man page. </p>

<a name="ipconfig-6"></a><h4>How to Log the IP Addresses of All Incoming TCP Connections</h4><ol>
<li><a name="ipconfig-step-9"></a><b>On the local system, assume the Network Management role or become superuser.</b><p>Roles contain authorizations and privileged commands.    For more information about
roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="ipconfig-step-8"></a><b>Set TCP tracing to enabled for all services managed by <tt>inetd</tt>.</b><pre># <tt><b>inetadm -M tcp_trace=TRUE</b></tt></pre></li></ol>

<a name="ermig"></a><h4>How to Add Services That Use the SCTP Protocol</h4><a name="indexterm-606"></a><a name="indexterm-607"></a><a name="indexterm-608"></a><p>The SCTP transport protocol provides services to application layer protocols in a fashion
similar to TCP. However, SCTP enables communication between two systems, either or both
of which can be multihomed. The SCTP connection is called an <b>association</b>. In
an association, an application divides the data to be transmitted into one or
more message streams, or <b>multi-streamed</b>. An SCTP connection can go to endpoints
with multiple IP addresses, which is particularly important for telephony applications. The multihoming capabilities
of SCTP are a security consideration if your site uses IP Filter or
IPsec. Some of these considerations are described in the <a href="http://docs.sun.com/doc/819-2254/sctp-7p?a=view"><tt>sctp</tt>(7P)</a> man page.</p><p>By default, SCTP is included in the Solaris OS and does not
require additional configuration. However, you might need to explicitly configure certain application layer services
to use SCTP. Some example applications are <tt>echo</tt> and <tt>discard</tt>. The next procedure shows
how to add an echo service that uses an SCTP one-to-one style
socket.</p>
<hr><p><b>Note - </b>You can also use the following procedure to add services for the TCP
and UDP transport layer protocols.</p>
<hr>
<p>The following task shows how to add an SCTP <tt>inet</tt> service that is
managed by the <tt>inetd</tt> daemon to the SMF repository. The task then shows
how to use the Service Management Facility (SMF) commands to add the service.</p>
<ul><li><p>For information about SMF commands, refer to <a href="http://docs.sun.com/doc/819-2379/dzhqq?a=view">SMF Command-Line Administrative Utilities in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><p>For syntactical information, refer to the man pages for the SMF commands, as cited in the procedure.</p></li>
<li><p>For detailed information about SMF refer to the <a href="http://docs.sun.com/doc/819-2252/smf-5?a=view"><tt>smf</tt>(5)</a> man page.</p></li></ul>
<h6>Before You Begin</h6><p>Before you perform the following procedure, create a manifest file for the service.
The procedure uses as an example a manifest for the <tt>echo</tt> service that
is called <tt>echo.sctp.xml</tt>.</p><ol>
<li><b>Log in to the local system with a user account that has
write privileges for system files.</b></li>
<li><b>Edit the <tt>/etc/services</tt> file and add a definition for the new service.</b><p><a name="indexterm-609"></a>Use the following syntax for the service definition.</p><pre><i>service-name |port/protocol | aliases</i></pre></li>
<li><b>Add the new service.</b><p>Go to the directory where the service manifest is stored and type the
following:</p><pre># <tt><b>cd </tt><i>dir-name</i><tt></b></tt>
# <tt><b>svccfg import </tt><i>service-manifest-name</i><tt></b></tt></pre><p>For a complete syntax of <tt>svccfg</tt>, refer to the <a href="http://docs.sun.com/doc/819-2240/svccfg-1m?a=view"><tt>svccfg</tt>(1M)</a> man page.</p><p>Suppose you want to add a new SCTP <tt>echo</tt> service using the manifest
<tt>echo.sctp.xml</tt> that is currently located in the <tt>service.dir</tt> directory. You would type the
following:</p><pre># <tt><b>cd service.dir</b></tt>
# <tt><b>svccfg import echo.sctp.xml</b></tt></pre></li>
<li><b>Verify that the service manifest has been added:</b><pre># <tt><b>svcs </tt><i>FMRI</i><tt></b></tt></pre><p>For the <i>FMRI</i> argument, use the Fault Managed Resource Identifier (FMRI) of the
service manifest. For example, for the SCTP <tt>echo</tt> service, you would use
the following command:</p><pre># <tt><b>svcs svc:/network/echo:sctp_stream</b></tt></pre><p>Your output should resemble the following:</p><pre>    STATE          STIME    FMRI
disabled       16:17:00 svc:/network/echo:sctp_stream</pre><p>For detailed information about the <tt>svcs</tt> command, refer to the <a href="http://docs.sun.com/doc/819-2239/svcs-1?a=view"><tt>svcs</tt>(1)</a> man page.</p><p>The output indicates that the new service manifest is currently disabled.</p></li>
<li><b>List the properties of the service to determine if you must make modifications.</b><pre># <tt><b>inetadm -l </tt><i>FMRI</i><tt></b></tt></pre><p>For detailed information about the <tt>inetadm</tt> command, refer to the<a href="http://docs.sun.com/doc/819-2240/inetadm-1m?a=view"><tt>inetadm</tt>(1M)</a> man page.</p><p>For example, for the SCTP <tt>echo</tt> service, you would type the following:</p><pre># <tt><b>inetadm -l svc:/network/echo:sctp_stream</b></tt>
SCOPE    NAME=VALUE
             name="echo"
             endpoint_type="stream"
             proto="sctp"
             isrpc=FALSE
             wait=FALSE
             exec="/usr/lib/inet/in.echod -s"
         .
         .
         default  tcp_trace=FALSE
           default  tcp_wrappers=FALSE</pre></li>
<li><b>Enable the new service:</b><pre># <tt><b>inetadm -e </tt><i>FMRI</i><tt></b></tt></pre></li>
<li><b>Verify that the service is enabled:</b><p>For example, for the new <tt>echo</tt> service, you would type the following:</p><pre># <tt><b>inetadm | grep sctp_stream</b></tt>
.
.
    enabled   online         svc:/network/echo:sctp_stream</pre></li></ol><a name="erttc"></a>Example&nbsp;5-9 Adding a Service That Uses the SCTP Transport Protocol<p>The following example shows the commands to use and the file entries required
to have the echo service use the SCTP transport layer protocol.</p><pre>$ <tt><b>cat /etc/services</b></tt>
.
.
echo            7/tcp
echo            7/udp
<tt><b>echo 7/sctp</b></tt>

# <tt><b>cd service.dir</b></tt>

    # <tt><b>svccfg import echo.sctp.xml</b></tt>

# <tt><b>svcs network/echo*</b></tt>
    STATE          STIME    FMRI
    disabled       15:46:44 svc:/network/echo:dgram
    disabled       15:46:44 svc:/network/echo:stream
    disabled       16:17:00 svc:/network/echo:sctp_stream

# <tt><b>inetadm -l svc:/network/echo:sctp_stream</b></tt>
    SCOPE    NAME=VALUE
             name="echo"
             endpoint_type="stream"
             proto="sctp"
             isrpc=FALSE
             wait=FALSE
             exec="/usr/lib/inet/in.echod -s"
             user="root"
    default  bind_addr=""
    default  bind_fail_max=-1
    default  bind_fail_interval=-1
    default  max_con_rate=-1
    default  max_copies=-1
    default  con_rate_offline=-1
    default  failrate_cnt=40
    default  failrate_interval=60
    default  inherit_env=TRUE
    default  tcp_trace=FALSE
    default  tcp_wrappers=FALSE

# <tt><b>inetadm -e svc:/network/echo:sctp_stream</b></tt>

# <tt><b>inetadm | grep echo</b></tt>
    disabled  disabled       svc:/network/echo:stream
    disabled  disabled       svc:/network/echo:dgram
    enabled   online         svc:/network/echo:sctp_stream</pre>

<a name="ipconfig-86"></a><h4>How to Use TCP Wrappers to Control Access to TCP Services</h4><p><a name="indexterm-610"></a><a name="indexterm-611"></a>The <tt>tcpd</tt> program implements <b>TCP wrappers</b>. TCP wrappers add a measure of security
for service daemons such as <tt>ftpd</tt> by standing between the daemon and incoming
service requests. TCP wrappers log successful and unsuccessful connection attempts. Additionally, TCP wrappers can
provide access control, allowing or denying the connection depending on where the request
originates. You can use TCP wrappers to protect daemons such as SSH, Telnet,
and FTP. The <tt>sendmail</tt> application can also use TCP wrappers, as described in
<a href="http://docs.sun.com/doc/819-1634/mailrefer-125?a=view">Support for TCP Wrappers From Version 8.12 of sendmail in <i>System Administration Guide: Network Services</i></a>.</p><ol>
<li><b>On the local system, assume the Primary Administrator role, or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="fawnj"></a><b>Set TCP wrappers to enabled.</b><pre># <tt><b>inetadm -M tcp_wrappers=TRUE</b></tt></pre></li>
<li><a name="ipconfig-step-91"></a><b>Configure the TCP wrappers access control policy as described in the <tt>hosts_access</tt>(3) man
page. </b><p>This man page can be found in the <tt>/usr/sfw/man</tt> directory on the SFW
CD-ROM, which is packaged along with the Solaris OS CD-ROM.</p></li></ol>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="gcvjj.html">Previous</a>
             </td>
             <td align="right">
                 <a href="fwawf.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

