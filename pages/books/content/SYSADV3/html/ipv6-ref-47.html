<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>IPv6 Tunnels - System Administration Guide: IP Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: IP Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ipv6-ref-33.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ipv6-ref-64.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="iptm-1.html">Part&nbsp;I&nbsp;TCP/IP Administration</a></p>
<p class="toc level2"><a href="ipov-1.html">1.&nbsp;&nbsp;Solaris TCPIP Protocol Suite (Overview)</a></p>
<p class="toc level2"><a href="ipplan-1.html">2.&nbsp;&nbsp;Planning an IPv4 Addressing Scheme (Tasks</a></p>
<p class="toc level2"><a href="ipv6-overview-7.html">3.&nbsp;&nbsp;Planning an IPv6 Addressing Scheme (Overview)</a></p>
<p class="toc level2"><a href="ipv6-planning-1.html">4.&nbsp;&nbsp;Planning an IPv6 Network (Tasks)</a></p>
<p class="toc level2"><a href="ipconfig-1.html">5.&nbsp;&nbsp;Configuring TCP/IP Network Services and IPv4 Addressing (Tasks)</a></p>
<p class="toc level2"><a href="fwawf.html">6.&nbsp;&nbsp;Administering Network Interfaces (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-config-tasks-1.html">7.&nbsp;&nbsp;Enabling IPv6 on a Network (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-admintasks-1.html">8.&nbsp;&nbsp;Administering a TCP/IP Network (Tasks)</a></p>
<p class="toc level2"><a href="gegel.html">9.&nbsp;&nbsp;Troubleshooting Network Problems (Tasks)</a></p>
<p class="toc level2"><a href="ipref-8.html">10.&nbsp;&nbsp;TCP/IP and IPv4 in Depth (Reference)</a></p>
<p class="toc level2"><a href="ipv6-ref-76.html">11.&nbsp;&nbsp;IPv6 in Depth (Reference)</a></p>
<p class="toc level3"><a href="ipv6-ref-77.html">IPv6 Addressing Formats Beyond the Basics</a></p>
<p class="toc level3"><a href="ipv6-ref-2.html">IPv6 Packet Header Format</a></p>
<p class="toc level3"><a href="ipv6-ref-81.html">Dual-Stack Protocols</a></p>
<p class="toc level3"><a href="ipv6-ref-83.html">Solaris 10 IPv6 Implementation</a></p>
<p class="toc level3"><a href="ipv6-ref-34.html">IPv6 Neighbor Discovery Protocol</a></p>
<p class="toc level3"><a href="ipv6-ref-33.html">IPv6 Routing</a></p>
<div class="onpage">
<p class="toc level3"><a href="">IPv6 Tunnels</a></p>
</div>
<p class="toc level3"><a href="ipv6-ref-64.html">IPv6 Extensions to Solaris Name Services</a></p>
<p class="toc level3"><a href="ipv6-ref-71.html">NFS and RPC IPv6 Support</a></p>
<p class="toc level3"><a href="ipv6-ref-103.html">IPv6 Over ATM Support</a></p>
<p class="toc level1 tocsp"><a href="dhcptm-1.html">Part&nbsp;II&nbsp;DHCP</a></p>
<p class="toc level2"><a href="dhcp-overview-1.html">12.&nbsp;&nbsp;About Solaris DHCP (Overview)</a></p>
<p class="toc level2"><a href="chap2-26.html">13.&nbsp;&nbsp;Planning for DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="chapter3-20.html">14.&nbsp;&nbsp;Configuring the DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="dhcp-admin-9.html">15.&nbsp;&nbsp;Administering DHCP (Tasks)</a></p>
<p class="toc level2"><a href="eyatl.html">16.&nbsp;&nbsp;Configuring and Administering  DHCP Clients</a></p>
<p class="toc level2"><a href="dhcp-trouble-1.html">17.&nbsp;&nbsp;Troubleshooting DHCP (Reference)</a></p>
<p class="toc level2"><a href="dhcp-ref-4.html">18.&nbsp;&nbsp;DHCP Commands and Files (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipsectm-1.html">Part&nbsp;III&nbsp;IP Security</a></p>
<p class="toc level2"><a href="ipsec-ov-1.html">19.&nbsp;&nbsp;IP Security Architecture (Overview)</a></p>
<p class="toc level2"><a href="ipsec-mgtasks-1.html">20.&nbsp;&nbsp;Configuring IPsec (Tasks)</a></p>
<p class="toc level2"><a href="ipsecref-1.html">21.&nbsp;&nbsp;IP Security Architecture (Reference)</a></p>
<p class="toc level2"><a href="ike-1.html">22.&nbsp;&nbsp;Internet Key Exchange (Overview)</a></p>
<p class="toc level2"><a href="ike-task-1.html">23.&nbsp;&nbsp;Configuring IKE (Tasks)</a></p>
<p class="toc level2"><a href="ikeref-1.html">24.&nbsp;&nbsp;Internet Key Exchange (Reference)</a></p>
<p class="toc level2"><a href="eupsq.html">25.&nbsp;&nbsp;Solaris IP Filter (Overview)</a></p>
<p class="toc level2"><a href="ipfilter-admin-1.html">26.&nbsp;&nbsp;Solaris IP Filter (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="miptm-1.html">Part&nbsp;IV&nbsp;Mobile IP</a></p>
<p class="toc level2"><a href="mipoverview-1.html">27.&nbsp;&nbsp;Mobile IP (Overview)</a></p>
<p class="toc level2"><a href="mipimplementing-1.html">28.&nbsp;&nbsp;Administering Mobile IP (Tasks)</a></p>
<p class="toc level2"><a href="mipmanaging-22.html">29.&nbsp;&nbsp;Mobile IP Files and Commands (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipmptm-1.html">Part&nbsp;V&nbsp;IPMP</a></p>
<p class="toc level2"><a href="mpoverview.html">30.&nbsp;&nbsp;Introducing IPMP (Overview)</a></p>
<p class="toc level2"><a href="deploynetmult-56.html">31.&nbsp;&nbsp;Administering IPMP (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ipqostm-1.html">Part&nbsp;VI&nbsp;IP Quality of Service (IPQoS)</a></p>
<p class="toc level2"><a href="ipqos-intro-1.html">32.&nbsp;&nbsp;Introducing IPQoS (Overview)</a></p>
<p class="toc level2"><a href="ipqos-config-planning-1.html">33.&nbsp;&nbsp;Planning for an IPQoS-Enabled Network (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-policy-planning-1.html">34.&nbsp;&nbsp;Creating the IPQoS Configuration File (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-isp-setup-1.html">35.&nbsp;&nbsp;Starting and Maintaining IPQoS (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-accounting-1.html">36.&nbsp;&nbsp;Using Flow Accounting and Statistics Gathering (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-reference-1.html">37.&nbsp;&nbsp;IPQoS in Detail (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="ipv6-ref-47"></a><h3>IPv6 Tunnels</h3>
<p>To minimize any dependencies at a dual-stack, IPv4/IPv6 site, all the routers in
the path between two IPv6 nodes do not need to support IPv6.
The mechanism that supports such a network configuration is called <b>tunneling</b>. Basically, IPv6
packets are placed inside IPv4 packets, which are then routed through the IPv4
routers. The following figure illustrates the tunneling mechanism through IPv4 routers, which are
indicated in the figure by &ldquo;R.&rdquo;<a name="indexterm-1301"></a></p><a name="ipv6-ref-fig-95"></a><h6>Figure&nbsp;11-5 IPv6 Tunneling Mechanism</h6><img src="figures/tunnel.gif" alt="Illustrates how IPv6 packets that are placed inside IPv4 packets are tunneled through routers that use IPv4."></img><p>The Solaris IPv6 implementation includes two types of tunneling mechanisms:</p>
<ul><li><p>Configured tunnels between two routers, as in <a href="#ipv6-ref-fig-95">Figure&nbsp;11-5</a></p></li>
<li><p>Automatic tunnels that terminate at the endpoint hosts</p></li></ul>
<p>A configured tunnel is currently used on the Internet for other purposes, for
example, on the MBONE, the IPv4 multicast backbone. Operationally, the tunnel consists of
two routers that are configured to have a virtual point-to-point link between the
two routers over the IPv4 network. This kind of tunnel is likely to
be used on some parts of the Internet for the foreseeable future.</p><p><a name="indexterm-1302"></a><a name="indexterm-1303"></a>Automatic tunnels require IPv4-compatible addresses. Automatic tunnels  can be used to connect
IPv6 nodes when IPv6 routers are not available. These tunnels can originate either
on a dual-stack host or on a dual-stack router by configuring an automatic
tunneling network interface. The tunnels always terminate on the dual-stack host. These tunnels
work by dynamically determining the destination IPv4 address, which is the endpoint of
the tunnel, by extracting the address from the IPv4-compatible destination address.</p>

<a name="ipv6-ref-49"></a><h4>Configured Tunnels</h4>
<a name="indexterm-1304"></a><a name="indexterm-1305"></a><p>Tunneling interfaces have the following format:</p><pre>ip.tun <i>ppa</i></pre><p><a name="indexterm-1306"></a><i>ppa</i> is the physical point of attachment.</p><p><a name="indexterm-1307"></a>At system startup, the tunneling module (<tt>tun</tt>) is pushed, by the <tt>ifconfig</tt> command,
on top of IP to create a virtual interface. The push is accomplished
by creating the appropriate <tt>hostname6.*</tt> file.</p><p>For example, to create a tunnel to encapsulate IPv6 packets over an IPv4
network, IPv6 over IPv4, you would create the following file name:</p><pre>/etc/hostname6.ip.tun0</pre><p><a name="indexterm-1308"></a>The content of this file is passed to <tt>ifconfig</tt> after the interfaces have
been plumbed. The content becomes the parameters that are necessary to configure a
point-to-point tunnel.</p><a name="ipv6-ref-ex-96"></a>Example&nbsp;11-11 <tt>hostname6.ip.tun0</tt> File for an IPv6 Over IPv4 Tunnel<p>The following is an example of entries in the <tt>hostname6.ip.tun0</tt> file:</p><pre>tsrc 10.10.10.23 tdst 172.16.7.19 up
addif 2001:db8:3b4c:1:5678:5678::2 up</pre><p><a name="indexterm-1309"></a>In this example, the IPv4 source and destination addresses are used as tokens
to autoconfigure IPv6 link-local addresses. These addresses are the source and destination for
the <tt>ip.tun0</tt> interface.  Two interfaces are configured. The <tt>ip.tun0</tt> interface is configured. A
logical interface,  <tt>ip.tun0:1</tt>, is also configured. The logical interface has the source
and destination IPv6 addresses specified by the <tt>addif</tt> command.</p><p>The contents of these configuration files are passed to <tt>ifconfig</tt> without change when
the system is started in multiuser mode. The entries in <a href="#ipv6-ref-ex-96">Example&nbsp;11-11</a> are
equivalent to the following:</p><pre># <tt><b>ifconfig ip.tun0 inet6 plumb</b></tt>
# <tt><b>ifconfig ip.tun0 inet6 tsrc 10.0.0.23 tdst 172.16.7.19 up</b></tt>
# <tt><b>ifconfig ip.tun0 inet6 addif 2001:db8:3b4c:1:5678:5678::2 up</b></tt></pre><p>The following shows the output of <tt>ifconfig</tt> <tt>-a</tt> for this tunnel.</p><pre>ip.tun0: flags=2200850&lt;UP,POINTOPOINT,RUNNING,MULTICAST,
  NONUD,IPv6> mtu 1480 index 6
        inet tunnel src 10.0.0.23  tunnel dst 172.16.7.19
        inet6 fe80::c0a8:6417/10 --> fe80::c0a8:713
ip.tun0:1: flags=2200850&lt;UP,POINTOPOINT,RUNNING,MULTICAST,NONUD,IPv6> mtu 1480 
  index 5
        inet6 2001:db8:3b4c:1:5678:5678::2 </pre><p>You can configure more logical interfaces by adding lines to the configuration file
by using the following syntax:</p><pre>addif IPv6-source IPv6-destination up</pre>
<hr><p><b>Note - </b>When either end of the tunnel is an IPv6 router that advertises one
or more prefixes over the tunnel, you do not need <tt>addif</tt> commands in
the tunnel configuration files. Only <tt>tsrc</tt> and <tt>tdst</tt> might be required because
all other addresses are autoconfigured.</p>
<hr>
<p>In some situations, specific source and destination link-local addresses need to be manually
configured for a particular tunnel. Change the first line of the configuration file
to include these link-local addresses.  The following line is an example:</p><pre>tsrc 10.0.0.23 tdst 172.16.7.19 fe80::1/10 fe80::2 up</pre><p>Notice that the source link-local address has a prefix length of 10. 
In this example, the <tt>ip.tun0</tt> interface resembles the following:</p><pre>ip.tun0: flags=2200850&lt;UP,POINTOPOINT,RUNNING,MULTICAST,NONUD,IPv6> mtu 1480 
index 6
        inet tunnel src 10.0.0.23  tunnel dst 172.16.7.19
        inet6 fe80::1/10 --> fe80::2</pre><p>To create a tunnel to encapsulate IPv6 packets over an IPv6 network, IPv6
over IPv6, you create the following file name:</p><pre>/etc/hostname6.ip6.tun0</pre><a name="ipv6-ref-ex-97"></a>Example&nbsp;11-12 <tt>hostname6.ip6.tun0</tt> File for an IPv6 over IPv6 Tunnel<p>The following is an example of entries in the <tt>hostname6.ip6.tun0</tt> file for IPv6
encapsulation over an IPv6 network:</p><pre>tsrc 2001:db8:3b4c:114:a00:20ff:fe72:668c 
        tdst 2001:db8:15fa:25:a00:20ff:fe9b:a1c3
fe80::4 fe80::61 up</pre><p>To create a tunnel to encapsulate IPv4 packets over an IPv6 network, IPv4
over IPv6, you would create the following file name:</p><pre>/etc/hostname.ip6.tun0</pre><a name="ipv6-ref-ex-98"></a>Example&nbsp;11-13 <tt>hostname.ip6.tun0</tt> File for an IPv4 Over IPv6 Tunnel<p>The following is an example of entries in the <tt>hostname.ip6.tun0</tt> file for IPv4
encapsulation over an IPv6 network:</p><pre>tsrc 2001:db8:3b4c:114:a00:20ff:fe72:668c 
         tdst 2001:db8:15fa:25:a00:20ff:fe9b:a1c3
10.0.0.4 10.0.0.61 up</pre><p>To create a tunnel to encapsulate IPv4 packets over an IPv4 network, IPv4
over IPv4, you would create the following file name:</p><pre>/etc/hostname.ip.tun0</pre><a name="ipv6-ref-ex-99"></a>Example&nbsp;11-14 <tt>hostname.ip.tun0</tt> for an IPv4 Over IPv4 Tunnel<p>The following is an example of entries in the <tt>hostname.ip.tun0</tt> file for IPv4
encapsulation over an IPv4 network:</p><pre>tsrc 172.16.86.158 tdst 192.168.86.122
10.0.0.4 10.0.0.61 up</pre><p>For specific information about <tt>tun</tt>, see the <a href="http://docs.sun.com/doc/819-2254/lc-tun-7m?a=view"><tt>tun</tt>(7M)</a>  man page. For
a general description of tunneling concepts during the transition to IPv6, see <a href="ipv6-overview-160.html">Overview of IPv6 Tunnels</a>.
For a description of procedures for configuring tunnels, see <a href="ipv6-config-tasks-17.html">Tasks for Configuring Tunnels for IPv6 Support (Task Map)</a>.</p>

<a name="ipv6-ref-50"></a><h4>6to4 Automatic Tunnels</h4>
<a name="indexterm-1310"></a><p><a name="indexterm-1311"></a><a name="indexterm-1312"></a>The Solaris OS includes 6to4 tunnels as a preferred interim method for making
the transition from IPv4 to IPv6 addressing. 6to4 tunnels enable isolated IPv6 sites
to communicate across an automatic tunnel over an IPv4 network that does not
support IPv6. To use 6to4 tunnels, you must configure a boundary router on
your IPv6 network as one endpoint of the 6to4 automatic tunnel. Thereafter, the
6to4 router can participate in a tunnel to another 6to4 site, or, if
required, to a native IPv6, non-6to4 site.</p><p>This section provides reference materials on the following 6to4 topics:</p>
<ul><li><p>Topology of the 6to4 tunnel</p></li>
<li><p>6to4 addressing, including the format of the advertisement</p></li>
<li><p>Description of packet flow across a 6to4 tunnel</p></li>
<li><p>Topology of a tunnel between a 6to4 router and a 6to4 relay router</p></li>
<li><p>Points to consider before you configure 6to4 relay router support</p></li></ul>
<p>More information about 6to4 routing is available from the following sources.</p><table><col width="39.76*"><col width="60.24*"><tr><th align="left" valign="top" scope="column"><p>Task or Detail</p></th>
<th align="left" valign="top" scope="column"><p>For
Information</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Tasks for configuring a 6to4 tunnel</p></td>
<td align="left" valign="top" scope="row"><p><a href="ipv6-config-tasks-16.html#ipv6-config-tasks-24">How to Configure a 6to4 Tunnel</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>6to4-related RFC</p></td>
<td align="left" valign="top" scope="row"><p><a href="ftp://ftp.rfc-editor.org/in-notes/rfc3056.txt">RFC 3056, "Connection of IPv6 Domains via IPv4 Clouds"</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Detailed information about the <tt>6to4relay</tt> command, which
enables support for tunnels to a 6to4 relay router</p></td>
<td align="left" valign="top" scope="row"><p><a href="http://docs.sun.com/doc/819-2240/x-6to4relay-1m?a=view"><tt>6to4relay</tt>(1M)</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>6to4 security issues</p></td>
<td align="left" valign="top" scope="row"><p><a href="ftp://ftp.rfc-editor.org/in-notes/rfc3964.txt"> Security Considerations for 6to4</a></p></td>
</tr>
</table>

<a name="ipv6-ref-51"></a><h5>Topology of a 6to4 Tunnel</h5>
<p><a name="indexterm-1313"></a><a name="indexterm-1314"></a><a name="indexterm-1315"></a>The following figure shows a 6to4 tunnel between two 6to4 sites.</p><a name="ipv6-ref-fig-100"></a><h6>Figure&nbsp;11-6 Tunnel Between Two 6to4 Sites</h6><img src="figures/tun-6-4-sites.gif" alt="The figure shows a 6to4 tunnel, which is described in the following context."></img><p><a name="indexterm-1316"></a>The figure depicts two isolated 6to4 networks, Site A and Site B. Each
site has configured a router with an external connection to an IPv4 network.
A 6to4 tunnel across the IPv4 network connects the 6to4 sites.</p><p><a name="indexterm-1317"></a>Before an IPv6 site can become a 6to4 site, you must configure at
least one router interface for 6to4 support. This interface must provide the external
connection to the IPv4 network. The address that you configure on <tt>qfe0</tt> must
be globally unique. In this figure, boundary Router A's interface <tt>qfe0</tt> connects Site
A to the IPv4 network. Interface <tt>qfe0</tt> must already be configured with an
IPv4 address before you can configure <tt>qfe0</tt> as a 6to4 pseudo-interface. </p><p>In the figure, 6to4 Site A is composed of two subnets, which
are connected to interfaces <tt>hme0</tt> and <tt>hme1</tt> on Router A. All IPv6 hosts on
either subnet of Site A automatically reconfigure with 6to4-derived addresses on receipt of
the advertisement from Router A.</p><p>Site B is the opposite endpoint of the tunnel from Site A.
To correctly receive traffic from Site A, a boundary router on Site B
must be configured for 6to4 support. Otherwise, packets that the router receives from
Site A are not recognized and dropped.</p>

<a name="ipv6-ref-55"></a><h5>Packet Flow Through the 6to4 Tunnel</h5>
<p><a name="indexterm-1318"></a><a name="indexterm-1319"></a><a name="indexterm-1320"></a><a name="indexterm-1321"></a>This section describes the path of packets from a host at one 6to4
site to a host in a remote 6to4 site. This scenario uses
the topology that is shown in <a href="#ipv6-ref-fig-100">Figure&nbsp;11-6</a>. Moreover, the scenario assumes that the 6to4
routers and 6to4 hosts are already configured.</p>
<ol><li><p>A host on Subnet 1 of 6to4 Site A sends a transmission, with a host at 6to4 Site B as the destination. Each packet header in the flow has a source 6to4-derived address and destination 6to4-derived address. </p></li>
<li><p>6to4 Router A receives the outgoing packets and creates a tunnel over an IPv4 network to 6to4 Site B.</p></li>
<li><p>Site A's router encapsulates each 6to4 packet into an IPv4 header. Then the router uses standard IPv4 routing procedures to forward the packet over the IPv4 network.</p></li>
<li><p>Any IPv4 routers that the packets encounter use the packets' destination IPv4 address for forwarding. This address is the globally unique IPv4 address of the interface on Router B, which also serves as the 6to4 pseudo-interface.</p></li>
<li><p>Packets from Site A arrive at Router B, which decapsulates the IPv6 packets from the IPv4 header.</p></li>
<li><p>Router B then uses the destination address in the IPv6 packet to forward the packets to the recipient host at Site B.</p></li></ol>


<a name="ipv6-ref-56"></a><h5>Considerations for Tunnels to a 6to4 Relay Router</h5>
<a name="indexterm-1322"></a><p>6to4 relay routers function as endpoints for tunnels from 6to4 routers that need
to communicate with native IPv6, non-6to4 networks. Relay routers are essentially bridges between
the 6to4 site and native IPv6 sites. Because this solution is very insecure,
by default, the Solaris OS does not enable 6to4 relay router support. However,
if your site requires such a tunnel, you use the <tt>6to4relay</tt> command to
enable the following tunneling scenario.</p><a name="ipv6-ref-fig-101"></a><h6>Figure&nbsp;11-7 Tunnel From a 6to4 Site to a 6to4 Relay Router</h6><img src="figures/tun-6-4-relay.gif" alt="This figure shows a tunnel between a 6to4 router and 6to4 relay router. The following context further describes the figure."></img><p><a name="indexterm-1323"></a><a name="indexterm-1324"></a>In <a href="#ipv6-ref-fig-101">Figure&nbsp;11-7</a>, 6to4 Site A needs to communicate with a node at the
native IPv6 Site B. The figure shows the path of traffic from Site
A onto a 6to4 tunnel over an IPv4 network. The tunnel has 6to4
Router A and a 6to4 relay router as its endpoints. Beyond the 6to4
relay router is the IPv6 network, to which IPv6 Site B is connected.
</p>

<a name="ipv6-ref-57"></a><h5>Packet Flow Between a 6to4 Site and Native IPv6 Site</h5>
<p><a name="indexterm-1325"></a><a name="indexterm-1326"></a><a name="indexterm-1327"></a>This section describes the flow of packets from a 6to4 site to a
native IPv6 site. The text uses the scenario that is shown in
<a href="#ipv6-ref-fig-101">Figure&nbsp;11-7</a> as an example.</p>
<ol><li><p>A host on 6to4 Site A sends a transmission that specifies as the destination a host at native IPv6 Site B. Each packet header in the flow has a 6to4-derived address as its source address. The destination address is a standard IPv6 address.</p></li>
<li><p>6to4 Router A receives the outgoing packets and creates a tunnel over an IPv4 network to a 6to4 relay router.</p><p>6to4 relay routers that are part of the 6to4 relay router anycast group have the address <tt>192.88.99.1</tt>. This anycast address is the default address for 6to4 relay routers. If you need to use a specific 6to4 relay router, you can override the default and specify that router's IPv4 address. </p></li>
<li><p>Site A's 6to4 router encapsulates each packet into a IPv4 header, which has the IPv4 address of the 6to4 relay router as its destination. The 6to4 router uses standard IPv4 routing procedures to forward the packet over the IPv4 network. Any IPv4 routers that the packets encounter forward the packets to the 6to4 relay router.</p></li>
<li><p>The physically closest anycast 6to4 relay router to Site A retrieves the packets that are destined for the <tt>192.88.99.</tt>1 anycast group. </p></li>
<li><p>The relay router decapsulates the IPv4 header from the 6to4 packets, revealing the native IPv6 destination address. </p></li>
<li><p>The relay router then sends the now IPv6-only packets onto the IPv6 network, where the packets are ultimately retrieved by a router at Site B. The router then forwards the packets to the destination IPv6 node.</p></li></ol>

         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ipv6-ref-33.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ipv6-ref-64.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

