<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Administering Default Address Selection - System Administration Guide: IP Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: IP Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ipv6-admintasks-670.html">Previous</a>
             </td>
             <td align="right">
                 <a href="gegel.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="iptm-1.html">Part&nbsp;I&nbsp;TCP/IP Administration</a></p>
<p class="toc level2"><a href="ipov-1.html">1.&nbsp;&nbsp;Solaris TCPIP Protocol Suite (Overview)</a></p>
<p class="toc level2"><a href="ipplan-1.html">2.&nbsp;&nbsp;Planning an IPv4 Addressing Scheme (Tasks</a></p>
<p class="toc level2"><a href="ipv6-overview-7.html">3.&nbsp;&nbsp;Planning an IPv6 Addressing Scheme (Overview)</a></p>
<p class="toc level2"><a href="ipv6-planning-1.html">4.&nbsp;&nbsp;Planning an IPv6 Network (Tasks)</a></p>
<p class="toc level2"><a href="ipconfig-1.html">5.&nbsp;&nbsp;Configuring TCP/IP Network Services and IPv4 Addressing (Tasks)</a></p>
<p class="toc level2"><a href="fwawf.html">6.&nbsp;&nbsp;Administering Network Interfaces (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-config-tasks-1.html">7.&nbsp;&nbsp;Enabling IPv6 on a Network (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-admintasks-1.html">8.&nbsp;&nbsp;Administering a TCP/IP Network (Tasks)</a></p>
<p class="toc level3"><a href="ipv6-admintasks-2.html">Major TCP/IP Administrative Tasks (Task Map)</a></p>
<p class="toc level3"><a href="ipconfig-141.html">Monitoring the Interface Configuration With the <tt>ifconfig</tt> Command</a></p>
<p class="toc level4"><a href="ipconfig-141.html#ipconfig-46">How to Get Information About a Specific Interface</a></p>
<p class="toc level4"><a href="ipconfig-141.html#ipconfig-171">How to Display Interface Address Assignments</a></p>
<p class="toc level3 tocsp"><a href="ipconfig-142.html">Monitoring Network Status With the <tt>netstat</tt> Command</a></p>
<p class="toc level4"><a href="ipconfig-142.html#ipconfig-143">How to Display Statistics by Protocol</a></p>
<p class="toc level4"><a href="ipconfig-142.html#esbee">How to Display the Status of Transport Protocols</a></p>
<p class="toc level4"><a href="ipconfig-142.html#ipconfig-144">How to Display Network Interface Status</a></p>
<p class="toc level4"><a href="ipconfig-142.html#ipv6-admintasks-16">How to Display the Status of Sockets</a></p>
<p class="toc level4"><a href="ipconfig-142.html#ipv6-admintasks-48">How to Display the Status of Transmissions for Packets of a Specific Address Type</a></p>
<p class="toc level4"><a href="ipconfig-142.html#ipconfig-145">How to Display the Status of Known Routes</a></p>
<p class="toc level3 tocsp"><a href="ipv6-admintasks-53.html">Probing Remote Hosts With the <tt>ping</tt> Command</a></p>
<p class="toc level4"><a href="ipv6-admintasks-53.html#ipv6-admintasks-54">How to Determine if a Remote Host Is Running</a></p>
<p class="toc level4"><a href="ipv6-admintasks-53.html#ipv6-admintasks-56">How to Determine if a Host Is Dropping Packets</a></p>
<p class="toc level3 tocsp"><a href="ipv6-admintasks-5.html">Administering and Logging Network Status Displays</a></p>
<p class="toc level4"><a href="ipv6-admintasks-5.html#ipv6-admintasks-22">How to Control the Display Output of IP-Related Commands</a></p>
<p class="toc level4"><a href="ipv6-admintasks-5.html#ipv6-admintasks-59">How to Log Actions of the IPv4 Routing Daemon</a></p>
<p class="toc level4"><a href="ipv6-admintasks-5.html#ipv6-admintasks-62">How to Trace the Activities of the IPv6 Neighbor Discovery Daemon</a></p>
<p class="toc level3 tocsp"><a href="ipv6-admintasks-72.html">Displaying Routing Information With the <tt>traceroute</tt> Command</a></p>
<p class="toc level4"><a href="ipv6-admintasks-72.html#ipv6-admintasks-73">How to Find Out the Route to a Remote Host</a></p>
<p class="toc level4"><a href="ipv6-admintasks-72.html#ipv6-admintasks-29">How to Trace All Routes</a></p>
<p class="toc level3 tocsp"><a href="ipv6-admintasks-670.html">Monitoring Packet Transfers With the <tt>snoop</tt> Command</a></p>
<p class="toc level4"><a href="ipv6-admintasks-670.html#ipv6-admintasks-67">How to Check Packets From All Interfaces</a></p>
<p class="toc level4"><a href="ipv6-admintasks-670.html#ipv6-admintasks-674">How to Capture <tt>snoop</tt> Output Into a File</a></p>
<p class="toc level4"><a href="ipv6-admintasks-670.html#ipv6-admintasks-676">How to Check Packets Between an IPv4 Server and a Client</a></p>
<p class="toc level4"><a href="ipv6-admintasks-670.html#ipv6-admintasks-10">How to Monitor IPv6 Network Traffic</a></p>
<div class="onpage">
<p class="toc level3 tocsp"><a href="">Administering Default Address Selection</a></p>
<p class="toc level4"><a href="#ipv6-admintasks-77">How to Administer the IPv6 Address Selection Policy Table</a></p>
<p class="toc level4"><a href="#ipv6-admintasks-87">How to Modify the IPv6 Address Selection Table for the Current Session Only</a></p>
</div>
<p class="toc level2 tocsp"><a href="gegel.html">9.&nbsp;&nbsp;Troubleshooting Network Problems (Tasks)</a></p>
<p class="toc level2"><a href="ipref-8.html">10.&nbsp;&nbsp;TCP/IP and IPv4 in Depth (Reference)</a></p>
<p class="toc level2"><a href="ipv6-ref-76.html">11.&nbsp;&nbsp;IPv6 in Depth (Reference)</a></p>
<p class="toc level1 tocsp"><a href="dhcptm-1.html">Part&nbsp;II&nbsp;DHCP</a></p>
<p class="toc level2"><a href="dhcp-overview-1.html">12.&nbsp;&nbsp;About Solaris DHCP (Overview)</a></p>
<p class="toc level2"><a href="chap2-26.html">13.&nbsp;&nbsp;Planning for DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="chapter3-20.html">14.&nbsp;&nbsp;Configuring the DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="dhcp-admin-9.html">15.&nbsp;&nbsp;Administering DHCP (Tasks)</a></p>
<p class="toc level2"><a href="eyatl.html">16.&nbsp;&nbsp;Configuring and Administering  DHCP Clients</a></p>
<p class="toc level2"><a href="dhcp-trouble-1.html">17.&nbsp;&nbsp;Troubleshooting DHCP (Reference)</a></p>
<p class="toc level2"><a href="dhcp-ref-4.html">18.&nbsp;&nbsp;DHCP Commands and Files (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipsectm-1.html">Part&nbsp;III&nbsp;IP Security</a></p>
<p class="toc level2"><a href="ipsec-ov-1.html">19.&nbsp;&nbsp;IP Security Architecture (Overview)</a></p>
<p class="toc level2"><a href="ipsec-mgtasks-1.html">20.&nbsp;&nbsp;Configuring IPsec (Tasks)</a></p>
<p class="toc level2"><a href="ipsecref-1.html">21.&nbsp;&nbsp;IP Security Architecture (Reference)</a></p>
<p class="toc level2"><a href="ike-1.html">22.&nbsp;&nbsp;Internet Key Exchange (Overview)</a></p>
<p class="toc level2"><a href="ike-task-1.html">23.&nbsp;&nbsp;Configuring IKE (Tasks)</a></p>
<p class="toc level2"><a href="ikeref-1.html">24.&nbsp;&nbsp;Internet Key Exchange (Reference)</a></p>
<p class="toc level2"><a href="eupsq.html">25.&nbsp;&nbsp;Solaris IP Filter (Overview)</a></p>
<p class="toc level2"><a href="ipfilter-admin-1.html">26.&nbsp;&nbsp;Solaris IP Filter (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="miptm-1.html">Part&nbsp;IV&nbsp;Mobile IP</a></p>
<p class="toc level2"><a href="mipoverview-1.html">27.&nbsp;&nbsp;Mobile IP (Overview)</a></p>
<p class="toc level2"><a href="mipimplementing-1.html">28.&nbsp;&nbsp;Administering Mobile IP (Tasks)</a></p>
<p class="toc level2"><a href="mipmanaging-22.html">29.&nbsp;&nbsp;Mobile IP Files and Commands (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipmptm-1.html">Part&nbsp;V&nbsp;IPMP</a></p>
<p class="toc level2"><a href="mpoverview.html">30.&nbsp;&nbsp;Introducing IPMP (Overview)</a></p>
<p class="toc level2"><a href="deploynetmult-56.html">31.&nbsp;&nbsp;Administering IPMP (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ipqostm-1.html">Part&nbsp;VI&nbsp;IP Quality of Service (IPQoS)</a></p>
<p class="toc level2"><a href="ipqos-intro-1.html">32.&nbsp;&nbsp;Introducing IPQoS (Overview)</a></p>
<p class="toc level2"><a href="ipqos-config-planning-1.html">33.&nbsp;&nbsp;Planning for an IPQoS-Enabled Network (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-policy-planning-1.html">34.&nbsp;&nbsp;Creating the IPQoS Configuration File (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-isp-setup-1.html">35.&nbsp;&nbsp;Starting and Maintaining IPQoS (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-accounting-1.html">36.&nbsp;&nbsp;Using Flow Accounting and Statistics Gathering (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-reference-1.html">37.&nbsp;&nbsp;IPQoS in Detail (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="ipv6-admintasks-43"></a><h3>Administering Default Address Selection</h3>
<a name="indexterm-899"></a><a name="indexterm-900"></a><a name="indexterm-901"></a><p>The Solaris OS enables a single interface to have multiple IP addresses. For
example, technologies, such as network multipathing (IPMP) enable multiple network interface cards (NICs)
to connect to the same IP link layer. That link can have one
or more IP addresses. Additionally, interfaces on IPv6-enabled systems have a link-local IPv6
address, at least one IPv6 routing address, and an IPv4 address for at
least one interface. </p><p>When the system initiates a transaction, an application makes a call to the
<tt>getaddrinfo</tt> socket. <tt>getaddrinfo</tt> discovers the possible address in use on the destination system.
The kernel then prioritizes this list to find the best destination to use
for the packet. This process is called <b>destination address ordering</b>. The Solaris kernel then selects the
appropriate format for the source address, given the best destination address for the
packet. The process is known as <b>address selection</b>. For more information on destination
address ordering, see the <a href="http://docs.sun.com/doc/819-2244/getaddrinfo-3socket?a=view"><tt>getaddrinfo</tt>(3SOCKET)</a> man page.</p><p>Both IPv4-only and dual-stack IPv4/IPv6 systems must perform default address selection. In most
circumstances, you do not need to change the default address selection mechanisms. However,
you might need to change the priority of address formats to support IPMP
or to prefer 6to4 address formats, for example. </p>

<a name="ipv6-admintasks-77"></a><h4>How to Administer the IPv6 Address Selection Policy Table</h4><a name="indexterm-902"></a><p>The following procedure explains how to modify the address selection policy table. For
conceptual information about IPv6 default address selection, refer to <a href="ipv6-ref-83.html#ipv6-ref-108"><tt>ipaddrsel</tt> Command</a>.</p>
<hr><p><b>Caution - </b>Do not change the IPv6 address selection policy table, except for the reasons
shown in the next task. You can cause problems on the network with
a badly constructed policy table. Be sure to save a backup copy
of the policy table, as is done in the next procedure.</p>
<hr>
<ol>
<li><b>Assume the Primary Administrator role, or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="ipv6-admintasks-step-79"></a><b>Review the current IPv6 address selection policy table.<a name="indexterm-903"></a><a name="indexterm-904"></a><a name="indexterm-905"></a></b><pre># <tt><b>ipaddrsel</b></tt>
# Prefix                  Precedence Label
::1/128                           50 Loopback
::/0                              40 Default
2002::/16                         30 6to4
::/96                             20 IPv4_Compatible
::ffff:0.0.0.0/96                 10 IPv4</pre></li>
<li><a name="ipv6-admintasks-step-80"></a><b>Make a backup copy of the default address policy table.</b><pre># <tt><b>cp /etc/inet/ipaddrsel.conf /etc/inet/ipaddrsel.conf.orig</b></tt></pre></li>
<li><a name="ipv6-admintasks-step-81"></a><b>Use a text editor to add your customizations to <tt>/etc/inet/ipaddrsel.conf</tt>. </b><p>Use the following syntax for entries in <tt>/etc/inet/ipaddrsel</tt>:</p><pre><i>prefix/prefix-length precedence label [# comment ]</i> </pre><p>Here are some common modifications that you might want to make to
your policy table:</p>
<ul><li><p>Give the highest priority to 6to4 addresses.</p><pre>2002::/16                         50 6to4
::1/128                           45 Loopback</pre><p>The 6to4 address format now has the highest priority, 50. Loopback, which previously had a 50 precedence, now has a 45 precedence. The other addressing formats remain the same.</p></li>
<li><p>Designate a specific source address to be used in communications with a specific destination address.</p><pre>::1/128                           50 Loopback
2001:1111:1111::1/128             40 ClientNet
2001:2222:2222::/48               40 ClientNet
::/0                              40 Default</pre><p>This particular entry is useful for hosts with only one physical interface. Here <tt>2001:1111:1111::1/128</tt> is preferred as the source address on all packets that are bound for destinations within network <tt>2001:2222:2222::/48</tt>. The 40 priority gives higher precedence to the source address <tt>2001:1111:1111::1/128</tt> than to other address formats configured for the interface.</p></li>
<li><p>Favor IPv4 addresses over IPv6 addresses.</p><pre>::ffff:0.0.0.0/96                 60 IPv4
::1/128                           50 Loopback
.
.</pre><p>The IPv4 format <tt>::ffff:0.0.0.0/96</tt> has its precedence changed from the default 10 to 60, the highest priority in the table.</p></li></ul>
</li>
<li><a name="ipv6-admintasks-step-82"></a><b>Load the modified policy table into the kernel.</b><pre><tt><b>ipaddrsel -f /etc/inet/ipaddrsel.conf</b></tt></pre></li>
<li><a name="ipv6-admintasks-step-85"></a><b>If the modified policy table has problems, restore the default IPv6 address selection
policy table.</b><pre># <tt><b>ipaddrsel -d</b></tt></pre></li></ol>

<a name="ipv6-admintasks-87"></a><h4>How to Modify the IPv6 Address Selection Table for the Current Session Only</h4><p>When you edit the <tt>/etc/inet/ipaddrsel.conf,</tt> file, any modifications that you make persist across
reboots. If you want the modified policy table to exist only in the
current session, follow this procedure.</p><ol>
<li><b>Assume the Primary Administrator role, or become superuser.</b><p>The Primary Administrator role includes the Primary Administrator profile. To create the role
and assign the role to a user, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b>Copy the contents of <tt>/etc/inet/ipaddrsel</tt> into <i>filename</i>, where <i>filename</i> represents a name of
your choice.</b><pre># <tt><b>cp</b></tt> <tt>/etc/inet/ipaddrsel</tt> <i>filename</i></pre></li>
<li><a name="ipv6-admintasks-step-84"></a><b>Edit the policy table in <i>filename</i> to your specifications. </b></li>
<li><a name="ipv6-admintasks-step-86"></a><b>Load the modified policy table into the kernel.</b><pre><tt><b># ipaddrsel -f </tt><i>filename</i><tt></b></tt></pre><p>The kernel uses the new policy table until you reboot the system.</p></li></ol>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ipv6-admintasks-670.html">Previous</a>
             </td>
             <td align="right">
                 <a href="gegel.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

