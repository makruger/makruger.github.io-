<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>IPMP and Dynamic Reconfiguration - System Administration Guide: IP Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: IP Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="emqqq.html">Previous</a>
             </td>
             <td align="right">
                 <a href="deploynetmult-56.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="iptm-1.html">Part&nbsp;I&nbsp;TCP/IP Administration</a></p>
<p class="toc level2"><a href="ipov-1.html">1.&nbsp;&nbsp;Solaris TCPIP Protocol Suite (Overview)</a></p>
<p class="toc level2"><a href="ipplan-1.html">2.&nbsp;&nbsp;Planning an IPv4 Addressing Scheme (Tasks</a></p>
<p class="toc level2"><a href="ipv6-overview-7.html">3.&nbsp;&nbsp;Planning an IPv6 Addressing Scheme (Overview)</a></p>
<p class="toc level2"><a href="ipv6-planning-1.html">4.&nbsp;&nbsp;Planning an IPv6 Network (Tasks)</a></p>
<p class="toc level2"><a href="ipconfig-1.html">5.&nbsp;&nbsp;Configuring TCP/IP Network Services and IPv4 Addressing (Tasks)</a></p>
<p class="toc level2"><a href="fwawf.html">6.&nbsp;&nbsp;Administering Network Interfaces (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-config-tasks-1.html">7.&nbsp;&nbsp;Enabling IPv6 on a Network (Tasks)</a></p>
<p class="toc level2"><a href="ipv6-admintasks-1.html">8.&nbsp;&nbsp;Administering a TCP/IP Network (Tasks)</a></p>
<p class="toc level2"><a href="gegel.html">9.&nbsp;&nbsp;Troubleshooting Network Problems (Tasks)</a></p>
<p class="toc level2"><a href="ipref-8.html">10.&nbsp;&nbsp;TCP/IP and IPv4 in Depth (Reference)</a></p>
<p class="toc level2"><a href="ipv6-ref-76.html">11.&nbsp;&nbsp;IPv6 in Depth (Reference)</a></p>
<p class="toc level1 tocsp"><a href="dhcptm-1.html">Part&nbsp;II&nbsp;DHCP</a></p>
<p class="toc level2"><a href="dhcp-overview-1.html">12.&nbsp;&nbsp;About Solaris DHCP (Overview)</a></p>
<p class="toc level2"><a href="chap2-26.html">13.&nbsp;&nbsp;Planning for DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="chapter3-20.html">14.&nbsp;&nbsp;Configuring the DHCP Service (Tasks)</a></p>
<p class="toc level2"><a href="dhcp-admin-9.html">15.&nbsp;&nbsp;Administering DHCP (Tasks)</a></p>
<p class="toc level2"><a href="eyatl.html">16.&nbsp;&nbsp;Configuring and Administering  DHCP Clients</a></p>
<p class="toc level2"><a href="dhcp-trouble-1.html">17.&nbsp;&nbsp;Troubleshooting DHCP (Reference)</a></p>
<p class="toc level2"><a href="dhcp-ref-4.html">18.&nbsp;&nbsp;DHCP Commands and Files (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipsectm-1.html">Part&nbsp;III&nbsp;IP Security</a></p>
<p class="toc level2"><a href="ipsec-ov-1.html">19.&nbsp;&nbsp;IP Security Architecture (Overview)</a></p>
<p class="toc level2"><a href="ipsec-mgtasks-1.html">20.&nbsp;&nbsp;Configuring IPsec (Tasks)</a></p>
<p class="toc level2"><a href="ipsecref-1.html">21.&nbsp;&nbsp;IP Security Architecture (Reference)</a></p>
<p class="toc level2"><a href="ike-1.html">22.&nbsp;&nbsp;Internet Key Exchange (Overview)</a></p>
<p class="toc level2"><a href="ike-task-1.html">23.&nbsp;&nbsp;Configuring IKE (Tasks)</a></p>
<p class="toc level2"><a href="ikeref-1.html">24.&nbsp;&nbsp;Internet Key Exchange (Reference)</a></p>
<p class="toc level2"><a href="eupsq.html">25.&nbsp;&nbsp;Solaris IP Filter (Overview)</a></p>
<p class="toc level2"><a href="ipfilter-admin-1.html">26.&nbsp;&nbsp;Solaris IP Filter (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="miptm-1.html">Part&nbsp;IV&nbsp;Mobile IP</a></p>
<p class="toc level2"><a href="mipoverview-1.html">27.&nbsp;&nbsp;Mobile IP (Overview)</a></p>
<p class="toc level2"><a href="mipimplementing-1.html">28.&nbsp;&nbsp;Administering Mobile IP (Tasks)</a></p>
<p class="toc level2"><a href="mipmanaging-22.html">29.&nbsp;&nbsp;Mobile IP Files and Commands (Reference)</a></p>
<p class="toc level1 tocsp"><a href="ipmptm-1.html">Part&nbsp;V&nbsp;IPMP</a></p>
<p class="toc level2"><a href="mpoverview.html">30.&nbsp;&nbsp;Introducing IPMP (Overview)</a></p>
<p class="toc level3"><a href="chapter1-2.html">Why You Should Use IPMP</a></p>
<p class="toc level3"><a href="eyprl.html">Basic Requirements of IPMP</a></p>
<p class="toc level3"><a href="emqwq.html">IPMP Addressing</a></p>
<p class="toc level3"><a href="eobra.html">IPMP Interface Configurations</a></p>
<p class="toc level3"><a href="emqqq.html">IPMP Failure Detection and Recovery Features</a></p>
<div class="onpage">
<p class="toc level3"><a href="">IPMP and Dynamic Reconfiguration</a></p>
</div>
<p class="toc level2 tocsp"><a href="deploynetmult-56.html">31.&nbsp;&nbsp;Administering IPMP (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ipqostm-1.html">Part&nbsp;VI&nbsp;IP Quality of Service (IPQoS)</a></p>
<p class="toc level2"><a href="ipqos-intro-1.html">32.&nbsp;&nbsp;Introducing IPQoS (Overview)</a></p>
<p class="toc level2"><a href="ipqos-config-planning-1.html">33.&nbsp;&nbsp;Planning for an IPQoS-Enabled Network (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-policy-planning-1.html">34.&nbsp;&nbsp;Creating the IPQoS Configuration File (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-isp-setup-1.html">35.&nbsp;&nbsp;Starting and Maintaining IPQoS (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-accounting-1.html">36.&nbsp;&nbsp;Using Flow Accounting and Statistics Gathering (Tasks)</a></p>
<p class="toc level2"><a href="ipqos-reference-1.html">37.&nbsp;&nbsp;IPQoS in Detail (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="esqdy"></a><h3>IPMP and Dynamic Reconfiguration</h3>
<a name="indexterm-2899"></a><a name="indexterm-2900"></a><p>The dynamic reconfiguration (DR) feature enables you to reconfigure system hardware, such as
interfaces, while the system is running. This section explains how DR interoperates with
IPMP. </p><p>On a system that supports DR of NICs, IPMP can be used
to preserve connectivity and prevent disruption of existing connections. You can safely attach,
detach, or reattach NIC's on a system that supports DR and uses IPMP.
This is possible because IPMP is integrated into the Reconfiguration Coordination Manager (RCM) framework.
<b>RCM</b> manages the dynamic reconfiguration of system components. </p><p>You typically use the <tt>cfgadm</tt> command to perform DR operations. However, some platforms
provide other methods. Consult your platform's documentation for details. You can find specific
documentation about DR from the following resources.</p><a name="eterj"></a><h6>Table&nbsp;30-1 Documentation Resources for Dynamic Reconfiguration</h6><table><col width="50*"><col width="50*"><tr><th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>For Information</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Detailed information on the <tt>cfgadm</tt> command
</p></td>
<td align="left" valign="top" scope="row"><p><a href="http://docs.sun.com/doc/819-2240/cfgadm-1m?a=view"><tt>cfgadm</tt>(1M)</a> man page</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Specific information about DR in the Sun Cluster environment</p></td>
<td align="left" valign="top" scope="row"><p><i>Sun Cluster 3.1 System Administration Guide</i></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Specific information about
DR in the Sun Fire environment</p></td>
<td align="left" valign="top" scope="row"><p><i>Sun Fire 880 Dynamic Reconfiguration Guide</i></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Introductory information about DR and the <tt>cfgadm</tt>
command</p></td>
<td align="left" valign="top" scope="row"><p><a href="http://docs.sun.com/doc/819-2723/devconfig2-1?a=view">Chapter 6, Dynamically Configuring Devices (Tasks), in <i>System Administration Guide: Devices and File Systems</i></a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Tasks for administering IPMP groups on a system that supports DR</p></td>
<td align="left" valign="top" scope="row"><p><a href="deploynetmult-92.html">Replacing a Failed Physical Interface on Systems That Support Dynamic Reconfiguration</a></p></td>
</tr>
</table>

<a name="esxiu"></a><h4>Attaching NICs</h4>
<a name="indexterm-2901"></a><a name="indexterm-2902"></a><a name="indexterm-2903"></a><p>You can add interfaces to an IPMP group at any time by
using the <tt>ifconfig</tt> command, as explained in <a href="deploynetmult-57.html#emqul">How to Configure an IPMP Group With Multiple Interfaces</a>. Thus, any interfaces on
system components that you attach after system boot can be plumbed and added
to an existing IPMP group. Or, if appropriate, you can configure the newly
added interfaces into their own IPMP group. </p><p>These interfaces and the data addresses that are configured on them are immediately
available for use by the IPMP group.  However, for the system to
automatically configure and use the interfaces after a reboot, you must create an
<tt>/etc/hostname.</tt><i>interface</i> file for each new interface. For instructions, refer to  <a href="fpcso.html#fpdcn">How to Configure a Physical Interface After System Installation</a>.</p><p>If an <tt>/etc/hostname.</tt><i>interface</i> file already exists when the interface is attached, then RCM
automatically configures the interface according to the contents of this file.  Thus,
the interface receives the same configuration that it would have received after system
boot.</p>

<a name="esxjb"></a><h4>Detaching NICs</h4>
<a name="indexterm-2904"></a><a name="indexterm-2905"></a><a name="indexterm-2906"></a><a name="indexterm-2907"></a><p>All requests to detach system components that contain NICs are first checked to
ensure that connectivity can be preserved.  For instance, by default you cannot
detach a NIC that is not in an IPMP group. You also
cannot detach a NIC that contains the only functioning interfaces in an IPMP
group.  However, if you must remove the system component, you can override
this behavior by using the <tt>-f</tt> option of <tt>cfgadm</tt>, as explained in the <a href="http://docs.sun.com/doc/819-2240/cfgadm-1m?a=view"><tt>cfgadm</tt>(1M)</a>
man page.</p><p>If the checks are successful, the data addresses associated with the detached NIC
fail over to a functioning NIC in the same group, as if
the NIC being detached had failed.  When the NIC is detached, all
test addresses on the NIC's interfaces are unconfigured. Then, the NIC is unplumbed
from the system.  If any of these steps fail, or if the
DR of other hardware on the same system component fails, then the previous
configuration is restored to its original state. You should receive a status message
regarding this event. Otherwise, the detach request completes successfully. You can remove the
component from the system.  No existing connections are disrupted.</p>

<a name="esxja"></a><h4>Reattaching NICs</h4>
<a name="indexterm-2908"></a><a name="indexterm-2909"></a><a name="indexterm-2910"></a><a name="indexterm-2911"></a><a name="indexterm-2912"></a><p>RCM records the configuration information associated with any NIC's that are detached from
a running system.  As a result, RCM treats the reattachment of a
NIC that had been previously detached identically as it would to the attachment
of a new NIC. That is, RCM only performs plumbing.</p><p>However, reattached NICs typically have an existing <tt>/etc/hostname.</tt><i>interface</i> file.  In this
case, RCM automatically configures the interface according to the contents of the existing
<tt>/etc/hostname.</tt><i>interface</i> file.  Additionally, RCM informs the <tt>in.mpathd</tt> daemon of each data address
that was originally hosted on the reattached interface.  Thus, once the reattached
interface is functioning properly, all of its data addresses are failed back to
the reattached interface as if it had been repaired.</p><p>If the NIC being reattached does not have an <tt>/etc/hostname.</tt><i>interface</i> file, then
no configuration information is available. RCM has no information regarding how to configure
the interface. One consequence of this situation is that addresses that were previously
failed over to another interface are not failed back.</p>

<a name="esxji"></a><h4>NICs That Were Missing at System Boot</h4>
<a name="indexterm-2913"></a><a name="indexterm-2914"></a><a name="indexterm-2915"></a><a name="indexterm-2916"></a><p>NICs that are not present at system boot represent a special instance of
failure detection.  At boot time, the startup scripts track any interfaces with
<tt>/etc/hostname.</tt><i>interface</i> files that cannot be plumbed.  Any data addresses in such an
interface's <tt>/etc/hostname.</tt><i>interface</i> file are automatically hosted on an alternative interface in the IPMP
group.  </p><p>In such an event, you receive error messages similar to the following</p><pre>moving addresses from failed IPv4 interfaces: hme0 (moved to hme1)
moving addresses from failed IPv6 interfaces: hme0 (moved to hme1)</pre><p>If no alternative interface exists, you receive error messages similar to the following:</p><pre>moving addresses from failed IPv4 interfaces: hme0 (couldn't move; 
   no alternative interface) 
 moving addresses from failed IPv6 interfaces: hme0 (couldn't move; 
   no alternative interface) </pre>
<hr><p><b>Note - </b>In this instance of failure detection, only data addresses that are explicitly specified
in the missing interface's <tt>/etc/hostname.</tt><i>interface</i> file move to an alternative interface. Any
addresses that are usually acquired through other means, such as through RARP or
DHCP, are not acquired or moved.   </p>
<hr>
<p>If an interface with the same name as another interface that was
missing at system boot is reattached using DR, RCM automatically plumbs the interface. Then,
RCM configures the interface according to the contents of the interface's <tt>/etc/hostname.</tt><i>interface</i>
file. Finally, RCM fails back any data addresses, just as if the interface
had been repaired. Thus, the final network configuration is identical to the configuration
that would have been made if the system had been booted with the
interface present.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="emqqq.html">Previous</a>
             </td>
             <td align="right">
                 <a href="deploynetmult-56.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

