<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Enabling Remote Console Messaging - System Administration Guide: Advanced Administration</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-05-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: Advanced Administration</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="eekis.html">Previous</a>
             </td>
             <td align="right">
                 <a href="tscore-7.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="vol2preface-11.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="modconcepts-20809.html">1.&nbsp;&nbsp;Managing Terminals and Modems (Overview)</a></p>
<p class="toc level1 tocsp"><a href="modsetup-43877.html">2.&nbsp;&nbsp;Setting Up Terminals and Modems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="modsafapp-84569.html">3.&nbsp;&nbsp;Managing Serial Ports With the Service Access Facility (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresconcepts-23051.html">4.&nbsp;&nbsp;Managing System Resources (Overview)</a></p>
<p class="toc level1 tocsp"><a href="sysressysinfo-75169.html">5.&nbsp;&nbsp;Displaying and Changing System Information (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresdiskuse-61891.html">6.&nbsp;&nbsp;Managing Disk Use (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresquotas-97946.html">7.&nbsp;&nbsp;Managing Quotas (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysrescron-18108.html">8.&nbsp;&nbsp;Scheduling System Tasks (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresacctsetup-78801.html">9.&nbsp;&nbsp;Managing System Accounting (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresacctref-14910.html">10.&nbsp;&nbsp;System Accounting (Reference)</a></p>
<p class="toc level1 tocsp"><a href="spconcepts-21354.html">11.&nbsp;&nbsp;Managing System Performance (Overview)</a></p>
<p class="toc level1 tocsp"><a href="spprocess-59633.html">12.&nbsp;&nbsp;Managing System Processes (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="spmonitor-24844.html">13.&nbsp;&nbsp;Monitoring System Performance (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsoverview-10750.html">14.&nbsp;&nbsp;Troubleshooting Software Problems (Overview)</a></p>
<p class="toc level1 tocsp"><a href="eekee.html">15.&nbsp;&nbsp;Managing System Messages</a></p>
<p class="toc level2"><a href="eekec.html">Viewing System Messages</a></p>
<p class="toc level3"><a href="eekec.html#eeklc">How to View System Messages</a></p>
<p class="toc level2 tocsp"><a href="emcby.html">System Log Rotation</a></p>
<p class="toc level2"><a href="eekis.html">Customizing System Message Logging</a></p>
<p class="toc level3"><a href="eekis.html#eekii">How to Customize System Message Logging</a></p>
<div class="onpage">
<p class="toc level2 tocsp"><a href="">Enabling Remote Console Messaging</a></p>
<p class="toc level3"><a href="#eekdy">How to Enable an Auxiliary (Remote) Console</a></p>
<p class="toc level3"><a href="#eekip">How to Display a List of Auxiliary Consoles</a></p>
<p class="toc level3"><a href="#eekjg">How to Enable an Auxiliary (Remote) Console Across System Reboots</a></p>
<p class="toc level3"><a href="#eekep">How to Disable an Auxiliary (Remote) Console</a></p>
</div>
<p class="toc level1 tocsp"><a href="tscore-7.html">16.&nbsp;&nbsp;Managing Core Files (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tscrashdumps-40145.html">17.&nbsp;&nbsp;Managing System Crash Information (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsgeneral-32935.html">18.&nbsp;&nbsp;Troubleshooting Miscellaneous Software Problems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsfileaccess-28392.html">19.&nbsp;&nbsp;Troubleshooting File Access Problems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsfsck-26279.html">20.&nbsp;&nbsp;Resolving UFS File System Inconsistencies (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsswmgr-40462.html">21.&nbsp;&nbsp;Troubleshooting Software Package Problems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="eekgt"></a><h3>Enabling Remote Console Messaging</h3>
<p>The following new console features improve your ability to troubleshoot remote systems:</p>
<ul><li><p><a name="indexterm-119"></a>The <tt>consadm</tt> command enables you to select a serial device as an <b>auxiliary</b> (or remote) console. Using the <tt>consadm</tt> command, a system administrator can configure one or more serial ports to display redirected console messages and to host <tt>sulogin</tt> sessions when the system transitions between run levels. This feature enables you to dial in to a serial port with a modem to monitor console messages and participate in <tt>init</tt> state transitions. (For more information, see <a href="http://docs.sun.com/doc/819-2240/sulogin-1m?a=view"><tt>sulogin</tt>(1M)</a> and the step-by-step procedures that follow.) </p><p>While you can log in to a system using a port configured as an auxiliary console, it is primarily an output device displaying information that is also displayed on the default console. If boot scripts or other applications read and write to and from the default console, the write output displays on all the auxiliary consoles, but the input is only read from the default console. (For more information on using the <tt>consadm</tt> command during an interactive login session, see <a href="#eekjl">Using the <tt>consadm</tt> Command During an Interactive Login Session</a>.)</p></li>
<li><p>Console output now consists of kernel and <tt>syslog</tt> messages written to a new pseudo device, <tt>/dev/sysmsg</tt>. In addition, <tt>rc</tt> script startup messages are written to <tt>/dev/msglog</tt>. Previously, all of these messages were written to <tt>/dev/console</tt>.  </p><p>Scripts that direct console output to <tt>/dev/console</tt> need to be changed to <tt>/dev/msglog</tt> if you want to see script messages displayed on the auxiliary consoles. Programs referencing <tt>/dev/console</tt> should be explicitly modified to use <tt>syslog()</tt> or <tt>strlog()</tt> if you want messages to be redirected to an auxiliary device.</p></li>
<li><p>The <tt>consadm</tt> command runs a daemon to monitor auxiliary console devices. Any display device designated as an auxiliary console that disconnects, hangs up or loses carrier, is removed from the auxiliary console device list and is no longer active. Enabling one or more auxiliary consoles does not disable message display on the default console; messages continue to display on <tt>/dev/console</tt>.</p></li></ul>


<a name="eekfv"></a><h4>Using Auxiliary Console Messaging During Run Level Transitions</h4>
<p>Keep the following in mind when using auxiliary console messaging during run level
transitions:</p>
<ul><li><p>Input cannot come from an auxiliary console if user input is expected for an <tt>rc</tt> script that is run when a system is booting. The input must come from the default console. </p></li>
<li><p>The <tt>sulogin</tt> program, invoked by <tt>init</tt> to prompt for the superuser password when transitioning between run levels, has been modified to send the superuser password prompt to each auxiliary device in addition to the default console device. </p></li>
<li><p>When the system is in single-user mode and one or more auxiliary consoles are enabled using the <tt>consadm</tt> command, a console login session runs on the first device to supply the correct superuser password to the <tt>sulogin</tt> prompt. When the correct password is received from a console device, <tt>sulogin</tt> disables input from all other console devices.</p></li>
<li><p>A message is displayed on the default console and the other auxiliary consoles when one of the consoles assumes single-user privileges. This message indicates which device has become the console by accepting a correct superuser password. If there is a loss of carrier on the auxiliary console running the single-user shell, one of two actions might occur: </p>
<ul><li><p>If the auxiliary console represents a system at run level 1, the system proceeds to the default run level. </p></li>
<li><p>If the auxiliary console represents a system at run level S, the system displays the <tt>ENTER RUN LEVEL (0-6, s or S):</tt> message on the device where the <tt>init s</tt> or <tt>shutdown</tt> command had been entered from the shell. If there isn't any carrier on that device either, you will have to reestablish carrier and enter the correct run level. The <tt>init</tt> or <tt>shutdown</tt> command will not redisplay the run-level prompt.</p></li></ul>
</li>
<li><p>If you are logged in to a system using a serial port, and an <tt>init</tt> or <tt>shutdown</tt> command is issued to transition to another run level, the login session is lost whether this device is the auxiliary console or not. This situation is identical to Solaris releases without auxiliary console capabilities.</p></li>
<li><p>Once a device is selected as an auxiliary console using the <tt>consadm</tt> command, it remains the auxiliary console until the system is rebooted or the auxiliary console is unselected. However, the <tt>consadm</tt> command includes an option to set a device as the auxiliary console across system reboots. (See the following procedure for step-by-step instructions.) </p></li></ul>


<a name="eekjl"></a><h4>Using the <tt>consadm</tt> Command During an Interactive Login Session</h4>
<p>If you want to run an interactive login session by logging in
to a system using a terminal that is connected to a serial port,
and then using the <tt>consadm</tt> command to see the console messages from
the terminal, note the following behavior:</p>
<ul><li><p>If you use the terminal for an interactive login session while the auxiliary console is active, the console messages are sent to the <tt>/dev/sysmsg</tt> or <tt>/dev/msglog</tt> devices.  </p></li>
<li><p>While you issue commands on the terminal, input goes to your interactive session and not to the default console (<tt>/dev/console</tt>).</p></li>
<li><p>If you run the <tt>init</tt> command to change run levels, the remote console software kills your interactive session and runs the <tt>sulogin</tt> program. At this point, input is accepted only from the terminal and is treated like it's coming from a console device. This allows you to enter your password to the <tt>sulogin</tt> program as described in <a href="#eekfv">Using Auxiliary Console Messaging During Run Level Transitions</a>.</p><p>Then, if you enter the correct password on the (auxiliary) terminal, the auxiliary console runs an interactive <tt>sulogin</tt> session, locks out the default console and any competing auxiliary console. This means the terminal essentially functions as the system console. </p></li>
<li><p>From here you can change to run level 3 or go to another run level. If you change run levels, <tt>sulogin</tt> runs again on all console devices. If you exit or specify that the system should come up to run level 3, then all auxiliary consoles lose their ability to provide input. They revert to being display devices for console messages.</p><p>As the system is coming up, you must provide information to <tt>rc</tt> scripts on the default console device. After the system comes back up, the <tt>login</tt> program runs on the serial ports and you can log back into another interactive session. If you've designated the device to be an auxiliary console, you will continue to get console messages on your terminal, but all input from the terminal goes to your interactive session. </p></li></ul>


<a name="eekdy"></a><h4>How to Enable an Auxiliary (Remote) Console</h4><a name="indexterm-120"></a><a name="indexterm-121"></a><a name="indexterm-122"></a><p>The <tt>consadm</tt> daemon does not start monitoring the port until after you add
the auxiliary console with the <tt>consadm</tt> command. As a security feature, console messages
are only redirected until carrier drops, or the auxiliary console device is unselected.
This means carrier must be established on the port before you can successfully
use the <tt>consadm</tt> command.</p><p>For more information on enabling an auxiliary console, see the <a href="http://docs.sun.com/doc/819-2240/consadm-1m?a=view"><tt>consadm</tt>(1m)</a> man
page.</p><ol>
<li><a name="eekhb"></a><b>Log in to the system as superuser.  </b></li>
<li><a name="eekhj"></a><b>Enable the auxiliary console.  </b><pre># <tt><b>consadm -a</b></tt> <i>devicename</i></pre></li>
<li><a name="eekiu"></a><b>Verify that the current connection is the auxiliary console.</b><pre># <tt><b>consadm</b></tt></pre></li></ol><a name="emjdw"></a>Example&nbsp;15-3 Enabling an Auxiliary (Remote) Console<pre># <tt><b>consadm -a /dev/term/a</b></tt>
# <tt><b>consadm</b></tt>
 /dev/term/a</pre>

<a name="eekip"></a><h4>How to Display a List of Auxiliary Consoles</h4><ol>
<li><a name="eekgl"></a><b><a name="indexterm-123"></a>Log in to the system as superuser.  </b></li>
<li><a name="eeklk"></a><b>Select one of the following steps:</b><ol style="list-style-type: lower-alpha">
				 
<li><a name="eekig"></a><b>Display the list of auxiliary consoles. </b><pre># <tt><b>consadm</b></tt>
/dev/term/a</pre></li>
<li><a name="eekfr"></a><b>Display the list of persistent auxiliary consoles.</b><pre># <tt><b>consadm -p</b></tt>
/dev/term/b</pre></li></ol></li></ol>

<a name="eekjg"></a><h4>How to Enable an Auxiliary (Remote) Console Across System Reboots</h4><a name="indexterm-124"></a><a name="indexterm-125"></a><a name="indexterm-126"></a><ol>
<li><a name="eekko"></a><b>Log in to the system as superuser.  </b></li>
<li><a name="eekmz"></a><b>Enable the auxiliary console across system reboots. </b><pre># <tt><b>consadm -a -p</b></tt> <i>devicename</i>     </pre><p>This adds the device to the list of persistent auxiliary consoles.</p></li>
<li><a name="eekfl"></a><b>Verify that the device has been added to the list of persistent auxiliary
consoles.</b><pre># <tt><b>consadm</b></tt></pre></li></ol><a name="emjdx"></a>Example&nbsp;15-4 Enabling an Auxiliary (Remote) Console Across System Reboots<pre># <tt><b>consadm -a -p /dev/term/a</b></tt> 
# <tt><b>consadm</b></tt>
/dev/term/a</pre>

<a name="eekep"></a><h4>How to Disable an Auxiliary (Remote) Console</h4><ol>
<li><a name="eekky"></a><b>Log in to the system as superuser.  </b></li>
<li><a name="eekej"></a><b>Select one of the following steps:</b><ol style="list-style-type: lower-alpha">
				 
<li><a name="eekiv"></a><b><a name="indexterm-127"></a><a name="indexterm-128"></a>Disable the auxiliary console. </b><pre># <tt><b>consadm -d</b></tt> <i>devicename</i></pre><p>or</p></li>
<li><a name="eekgm"></a><b>Disable the auxiliary console and remove it from the list of persistent auxiliary
consoles.</b><pre># <tt><b>consadm -p -d</b></tt> <i>devicename</i></pre></li></ol></li>
<li><a name="eekio"></a><b>Verify that the auxiliary console has been disabled.</b><pre># <tt><b>consadm</b></tt></pre></li></ol><a name="emjdy"></a>Example&nbsp;15-5 Disabling an Auxiliary (Remote) Console<pre># <tt><b>consadm -d /dev/term/a</b></tt>
# <tt><b>consadm</b></tt></pre>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="eekis.html">Previous</a>
             </td>
             <td align="right">
                 <a href="tscore-7.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

