<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Setting Up Quotas (Task Map) - System Administration Guide: Advanced Administration</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-05-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: Advanced Administration</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="sysresquotas-26007.html">Previous</a>
             </td>
             <td align="right">
                 <a href="enmuy.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="vol2preface-11.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="modconcepts-20809.html">1.&nbsp;&nbsp;Managing Terminals and Modems (Overview)</a></p>
<p class="toc level1 tocsp"><a href="modsetup-43877.html">2.&nbsp;&nbsp;Setting Up Terminals and Modems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="modsafapp-84569.html">3.&nbsp;&nbsp;Managing Serial Ports With the Service Access Facility (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresconcepts-23051.html">4.&nbsp;&nbsp;Managing System Resources (Overview)</a></p>
<p class="toc level1 tocsp"><a href="sysressysinfo-75169.html">5.&nbsp;&nbsp;Displaying and Changing System Information (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresdiskuse-61891.html">6.&nbsp;&nbsp;Managing Disk Use (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresquotas-97946.html">7.&nbsp;&nbsp;Managing Quotas (Tasks)</a></p>
<p class="toc level2"><a href="sysresquotas-4.html">What Are Quotas?</a></p>
<p class="toc level2"><a href="sysresquotas-11993.html">Using Quotas</a></p>
<p class="toc level2"><a href="sysresquotas-26007.html">Setting Up Quotas</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Setting Up Quotas (Task Map)</a></p>
<p class="toc level3"><a href="#sysresquotas-61340">How to Configure File Systems for Quotas</a></p>
<p class="toc level3"><a href="#sysresquotas-28657">How to Set Up Quotas for a User</a></p>
<p class="toc level3"><a href="#sysresquotas-63864">How to Set Up Quotas for Multiple Users</a></p>
<p class="toc level3"><a href="#sysresquotas-82495">How to Check Quota Consistency</a></p>
<p class="toc level3"><a href="#sysresquotas-89063">How to Turn On Quotas</a></p>
</div>
<p class="toc level2 tocsp"><a href="enmuy.html">Maintaining Quotas (Task Map)</a></p>
<p class="toc level2"><a href="sysresquotas-36102.html">Checking Quotas</a></p>
<p class="toc level3"><a href="sysresquotas-36102.html#sysresquotas-81117">How to Check for Exceeded Quotas</a></p>
<p class="toc level3"><a href="sysresquotas-36102.html#sysresquotas-13508">How to Check Quotas on a File System</a></p>
<p class="toc level2 tocsp"><a href="sysresquotas-10332.html">Changing and Removing Quotas</a></p>
<p class="toc level3"><a href="sysresquotas-10332.html#sysresquotas-53952">How to Change the Soft Limit Default</a></p>
<p class="toc level3"><a href="sysresquotas-10332.html#sysresquotas-85417">How to Change Quotas for a User</a></p>
<p class="toc level3"><a href="sysresquotas-10332.html#sysresquotas-22999">How to Disable Quotas for a User</a></p>
<p class="toc level3"><a href="sysresquotas-10332.html#sysresquotas-45549">How to Turn Off Quotas</a></p>
<p class="toc level1 tocsp"><a href="sysrescron-18108.html">8.&nbsp;&nbsp;Scheduling System Tasks (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresacctsetup-78801.html">9.&nbsp;&nbsp;Managing System Accounting (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresacctref-14910.html">10.&nbsp;&nbsp;System Accounting (Reference)</a></p>
<p class="toc level1 tocsp"><a href="spconcepts-21354.html">11.&nbsp;&nbsp;Managing System Performance (Overview)</a></p>
<p class="toc level1 tocsp"><a href="spprocess-59633.html">12.&nbsp;&nbsp;Managing System Processes (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="spmonitor-24844.html">13.&nbsp;&nbsp;Monitoring System Performance (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsoverview-10750.html">14.&nbsp;&nbsp;Troubleshooting Software Problems (Overview)</a></p>
<p class="toc level1 tocsp"><a href="eekee.html">15.&nbsp;&nbsp;Managing System Messages</a></p>
<p class="toc level1 tocsp"><a href="tscore-7.html">16.&nbsp;&nbsp;Managing Core Files (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tscrashdumps-40145.html">17.&nbsp;&nbsp;Managing System Crash Information (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsgeneral-32935.html">18.&nbsp;&nbsp;Troubleshooting Miscellaneous Software Problems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsfileaccess-28392.html">19.&nbsp;&nbsp;Troubleshooting File Access Problems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsfsck-26279.html">20.&nbsp;&nbsp;Resolving UFS File System Inconsistencies (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsswmgr-40462.html">21.&nbsp;&nbsp;Troubleshooting Software Package Problems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="sysresquotas-67"></a><h3>Setting Up Quotas (Task Map)</h3>
<table><col width="33*"><col width="33*"><col width="33*"><tr><th align="left" valign="top" scope="column"><p>Task</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>For Instructions</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>1. Configure a file system for quotas.</p></td>
<td align="left" valign="top" scope="row"><p>Edit the <tt>/etc/vfstab</tt> file so
that quotas are activated each time the file system is mounted. Also, create
a <tt>quotas</tt> file. </p></td>
<td align="left" valign="top" scope="row"><p><a href="#sysresquotas-61340">How to Configure File Systems for Quotas</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>2. Set up quotas for a user.</p></td>
<td align="left" valign="top" scope="row"><p>Use the <tt>edquota</tt>
command to create disk quotas and inode quotas for a single user account.
</p></td>
<td align="left" valign="top" scope="row"><p><a href="#sysresquotas-28657">How to Set Up Quotas for a User</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>3. (Optional) Set up quotas for multiple users.</p></td>
<td align="left" valign="top" scope="row"><p> Use the <tt>edquota</tt> command
to apply prototype quotas to other user accounts. </p></td>
<td align="left" valign="top" scope="row"><p><a href="#sysresquotas-63864">How to Set Up Quotas for Multiple Users</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>4. Check for  consistency.</p></td>
<td align="left" valign="top" scope="row"><p>Use
the <tt>quotacheck</tt> command to compare quotas to current disk usage for consistency across
one or more file systems. </p></td>
<td align="left" valign="top" scope="row"><p><a href="#sysresquotas-82495">How to Check Quota Consistency</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>5. Turn on quotas.</p></td>
<td align="left" valign="top" scope="row"><p>Use the <tt>quotaon</tt> command
to initiate quotas on one or more file systems. </p></td>
<td align="left" valign="top" scope="row"><p><a href="#sysresquotas-89063">How to Turn On Quotas</a></p></td>
</tr>
</table>

<a name="sysresquotas-61340"></a><h4>How to Configure File Systems for Quotas</h4><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="sysresquotas-step-8"></a><b><a name="sysresquotas-ix2352"></a><a name="sysresquotas-ix2353"></a>Edit the <tt>/etc/vfstab</tt> file and add <tt>rq</tt> to the <tt>mount options</tt> field for
each UFS file system that will have quotas.  </b></li>
<li><a name="sysresquotas-step-10"></a><b>Change directory to the root of the file system that will have quotas.</b></li>
<li><a name="sysresquotas-step-11"></a><b><a name="sysresquotas-ix2354"></a>Create a file named <tt>quotas</tt>. </b><pre># <tt><b>touch quotas</b></tt></pre></li>
<li><a name="sysresquotas-step-12"></a><b>Change permissions to read/write for superuser access only.</b><pre># <tt><b>chmod 600 quotas</b></tt></pre></li></ol><a name="emjew"></a>Example&nbsp;7-1 Configuring File Systems for Quotas<p>The following <tt>/etc/vfstab</tt> example shows that the <tt>/export/home</tt> directory from the system
<tt>pluto</tt> is mounted as an NFS file system on the local system. You
can tell that quotas are enabled by the <tt>rq</tt> entry under the <tt>mount options</tt>
column.</p><pre># device   device    mount     FS    fsck   mount   mount
# to mount       to fsck  point     type   pass  at boot options
# pluto:/export/home -   /export/home nfs    -     yes    rq</pre><p>The following example line from the <tt>/etc/vfstab</tt> file shows that the local <tt>/work</tt>
directory is mounted with quotas enabled, signified by the <tt>rq</tt> entry under the
<tt>mount options</tt> column.  </p><pre>#device     device        mount  FS   fsck  mount    mount
#to mount         to fsck      point  type  pass  at boot options
#/dev/dsk/c0t4d0s0 /dev/rdsk/c0t4d0s0 /work ufs  3    yes     rq</pre><h6>See Also</h6>
<ul><li><p><a href="#sysresquotas-28657">How to Set Up Quotas for a User</a></p></li>
<li><p><a href="#sysresquotas-63864">How to Set Up Quotas for Multiple Users</a></p></li>
<li><p><a href="#sysresquotas-82495">How to Check Quota Consistency</a></p></li>
<li><p><a href="#sysresquotas-89063">How to Turn On Quotas</a></p></li></ul>


<a name="sysresquotas-28657"></a><h4>How to Set Up Quotas for a User</h4><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="sysresquotas-step-16"></a><b>Use the quota editor to create a temporary file that contains one line
of quota information for each mounted UFS file system that has a <tt>quotas</tt>
file in the file system's root directory.</b><pre># <tt><b>edquota</b></tt> <i>username</i></pre><p>where <i>username</i> is the user for whom you want to set up quotas.</p></li>
<li><a name="sysresquotas-step-17"></a><b>Change the number of 1-Kbyte disk blocks, both soft and hard, and the
number of inodes, both soft and hard, from the default of 0, to
the quotas that you specify for each file system.</b></li>
<li><a name="sysresquotas-step-66"></a><b>Verify the user's quota.</b><pre># <tt><b>quota</b></tt> <tt><b>-v</b></tt> <i>username</i></pre><dl><dt><tt>-v</tt></dt>
<dd><p>Displays the user's quota information on all mounted file systems where quotas exist.</p></dd>
<dt><i>username</i></dt>
<dd><p>Specifies the user name to view quota limits.</p></dd>
</dl>
</li></ol><a name="emjeu"></a>Example&nbsp;7-2 Setting Up Quotas for a User<p>The following example shows the contents of the temporary file opened by <tt>edquota</tt>
on a system where <tt>/files</tt> is the only mounted file system that contains
a <tt>quotas</tt> file in the root directory.</p><pre>fs /files blocks (soft = 0, hard = 0) inodes (soft = 0, hard = 0)</pre><p><a name="sysresquotas-ix2365"></a>The following example shows the same line in the temporary file after quotas
have been set up.  </p><pre>fs /files blocks (soft = 50, hard = 60) inodes (soft = 90, hard = 100)</pre>

<a name="sysresquotas-63864"></a><h4>How to Set Up Quotas for Multiple Users</h4><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="sysresquotas-step-23"></a><b><a name="sysresquotas-ix2367"></a>Use the quota editor to apply the quotas you already established for a
prototype user to the additional users that you specify.</b><pre># <tt><b>edquota -p</b></tt> <i>prototype-user username ...</i></pre><dl><dt><i>prototype-user</i></dt>
<dd><p>Is the user name of the account for which you have set up quotas. </p></dd>
<dt><i>username ...</i></dt>
<dd><p>Specifies one or more user names of additional accounts. More than one user name is specified by separating each user name with a space.</p></dd>
</dl>
</li></ol><a name="emjet"></a>Example&nbsp;7-3 Setting Up Prototype Quotas for Multiple Users<p><a name="sysresquotas-ix2368"></a><a name="sysresquotas-ix2369"></a><a name="sysresquotas-ix2370"></a>The following example shows how to apply the quotas established for user <tt>bob</tt>
to users <tt>mary</tt> and <tt>john</tt>.    </p><pre># <tt><b>edquota -p bob mary john</b></tt></pre>

<a name="sysresquotas-82495"></a><h4>How to Check Quota Consistency</h4><p>The <tt>quotacheck</tt> command is run automatically when a system is rebooted. You generally
do not have to run the <tt>quotacheck</tt> command on an empty file system
with quotas. However, if you are setting up quotas on a file system
with existing files, you need to run the <tt>quotacheck</tt> command to synchronize the
quota database with the files or inodes that already exist in the file
system.</p><p>Also keep in mind that running the <tt>quotacheck</tt> command on large file systems
can be time-consuming.</p>
<hr><p><b>Note - </b>To ensure accurate disk data, the file systems being checked should be quiescent
when you run the <tt>quotacheck</tt> command manually. </p>
<hr>
<ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="sysresquotas-step-27"></a><b>Run a consistency check on UFS file systems. </b><pre># <tt><b>quotacheck</b></tt> [<tt><b>-va</b></tt>] <i>filesystem</i> </pre><dl><dt><tt>-v</tt></dt>
<dd><p>(Optional) Identifies the disk quotas for each user on a particular file system. </p></dd>
<dt><tt>-a</tt></dt>
<dd><p>Checks all file systems with an <tt>rq</tt> entry in the <tt>/etc/vfstab</tt> file.</p></dd>
<dt><i>filesystem</i></dt>
<dd><p>Specifies the file system to check.</p></dd>
</dl>
<p>See the <a href="http://docs.sun.com/doc/819-2240/quotacheck-1m?a=view"><tt>quotacheck</tt>(1M)</a> man page for more information.</p></li></ol><a name="emjer"></a>Example&nbsp;7-4 Checking Quota Consistency<p><a name="sysresquotas-ix2379"></a><a name="sysresquotas-ix2380"></a><a name="sysresquotas-ix2381"></a><a name="sysresquotas-ix2382"></a>The following example shows how to check quotas for the <tt>/export/home</tt> file
system on  the <tt>/dev/rdsk/c0t0d0s7</tt> slice. The <tt>/export/home</tt> file system is the only
file system with an <tt>rq</tt> entry in the <tt>/etc/vfstab</tt> file.    </p><pre># <tt><b>quotacheck -va</b></tt>
*** Checking quotas for /dev/rdsk/c0t0d0s7 (/export/home)</pre>

<a name="sysresquotas-89063"></a><h4>How to Turn On Quotas</h4><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="sysresquotas-step-31"></a><b>Turn on file system quotas.</b><pre># <tt><b>quotaon</b></tt> [<tt><b>-v</b></tt>] <tt><b>-a</b></tt> <i>filesystem ...</i></pre><dl><dt><tt>-v</tt></dt>
<dd><p>Displays a message for each file system after quotas are turned on.</p></dd>
<dt><tt>-a</tt></dt>
<dd><p>Turns on quotas for all file systems with an <tt>rq</tt> entry in the <tt>/etc/vfstab</tt> file.</p></dd>
<dt><i>filesystem ...</i></dt>
<dd><p>Turns on quotas for one or more file systems that you specify. More than one file system is specified by separating each file system name with a space.</p></dd>
</dl>
</li></ol><a name="emjex"></a>Example&nbsp;7-5 Turning On Quotas<p><a name="sysresquotas-ix2386"></a><a name="sysresquotas-ix2387"></a><a name="sysresquotas-ix2388"></a>The following example shows how to turn quotas on for the file systems
on the <tt>/dev/dsk/c0t4d0s7</tt> and <tt>/dev/dsk/c0t3d0s7</tt> slices.  </p><pre># <tt><b>quotaon -v /dev/dsk/c0t4d0s7 /dev/dsk/c0t3d0s7</b></tt>
<tt><b></b></tt>/dev/dsk/c0t4d0s7: quotas turned on
/dev/dsk/c0t3d0s7: quotas turned on</pre>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="sysresquotas-26007.html">Previous</a>
             </td>
             <td align="right">
                 <a href="enmuy.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

