<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Managing System Crash Dump Information - System Administration Guide: Advanced Administration</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-05-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: Advanced Administration</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="tscrashdumps-4.html">Previous</a>
             </td>
             <td align="right">
                 <a href="tsgeneral-32935.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="vol2preface-11.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="modconcepts-20809.html">1.&nbsp;&nbsp;Managing Terminals and Modems (Overview)</a></p>
<p class="toc level1 tocsp"><a href="modsetup-43877.html">2.&nbsp;&nbsp;Setting Up Terminals and Modems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="modsafapp-84569.html">3.&nbsp;&nbsp;Managing Serial Ports With the Service Access Facility (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresconcepts-23051.html">4.&nbsp;&nbsp;Managing System Resources (Overview)</a></p>
<p class="toc level1 tocsp"><a href="sysressysinfo-75169.html">5.&nbsp;&nbsp;Displaying and Changing System Information (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresdiskuse-61891.html">6.&nbsp;&nbsp;Managing Disk Use (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresquotas-97946.html">7.&nbsp;&nbsp;Managing Quotas (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysrescron-18108.html">8.&nbsp;&nbsp;Scheduling System Tasks (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresacctsetup-78801.html">9.&nbsp;&nbsp;Managing System Accounting (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresacctref-14910.html">10.&nbsp;&nbsp;System Accounting (Reference)</a></p>
<p class="toc level1 tocsp"><a href="spconcepts-21354.html">11.&nbsp;&nbsp;Managing System Performance (Overview)</a></p>
<p class="toc level1 tocsp"><a href="spprocess-59633.html">12.&nbsp;&nbsp;Managing System Processes (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="spmonitor-24844.html">13.&nbsp;&nbsp;Monitoring System Performance (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsoverview-10750.html">14.&nbsp;&nbsp;Troubleshooting Software Problems (Overview)</a></p>
<p class="toc level1 tocsp"><a href="eekee.html">15.&nbsp;&nbsp;Managing System Messages</a></p>
<p class="toc level1 tocsp"><a href="tscore-7.html">16.&nbsp;&nbsp;Managing Core Files (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tscrashdumps-40145.html">17.&nbsp;&nbsp;Managing System Crash Information (Tasks)</a></p>
<p class="toc level2"><a href="tscrashdumps-26694.html">Managing System Crash Information (Task Map)</a></p>
<p class="toc level2"><a href="tscrashdumps-4.html">System Crashes (Overview)</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Managing System Crash Dump Information</a></p>
<p class="toc level3"><a href="#tscrashdumps-35">How to Display the Current Crash Dump Configuration</a></p>
<p class="toc level3"><a href="#tscrashdumps-37">How to Modify a Crash Dump Configuration</a></p>
<p class="toc level3"><a href="#tscrashdumps-58578">How to Examine a Crash Dump</a></p>
<p class="toc level3"><a href="#tscrashdumps-34">How to Recover From a Full Crash Dump Directory (Optional)</a></p>
<p class="toc level3"><a href="#tscrashdumps-39">How to Disable or Enable Saving Crash Dumps</a></p>
</div>
<p class="toc level1 tocsp"><a href="tsgeneral-32935.html">18.&nbsp;&nbsp;Troubleshooting Miscellaneous Software Problems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsfileaccess-28392.html">19.&nbsp;&nbsp;Troubleshooting File Access Problems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsfsck-26279.html">20.&nbsp;&nbsp;Resolving UFS File System Inconsistencies (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsswmgr-40462.html">21.&nbsp;&nbsp;Troubleshooting Software Package Problems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="tscrashdumps-31"></a><h3>Managing System Crash Dump Information</h3>
<p>Keep the following key points in mind when you are working with
system crash information:</p>
<ul><li><p>You must be superuser or assume an equivalent role to access and manage system crash information.</p></li>
<li><p>Do not disable the option of saving system crash dumps. System crash dump files provide an invaluable way to determine what is causing the system to crash.</p></li>
<li><p>Do not remove important system crash information until it has been sent to your customer service representative.</p></li></ul>


<a name="tscrashdumps-35"></a><h4>How to Display the Current Crash Dump Configuration</h4><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="tscrashdumps-step-40"></a><b>Display the current crash dump configuration.</b><pre># <tt><b>dumpadm</b></tt>
Dump content: kernel pages
Dump device: /dev/dsk/c0t3d0s1 (swap)
Savecore directory: /var/crash/venus
Savecore enabled: yes</pre><p>The preceding example output means:</p>
<ul><li><p>The dump content is kernel memory pages.</p></li>
<li><p>Kernel memory will be dumped on a swap device, <tt>/dev/dsk/c0t3d0s1</tt>. You can identify all your swap areas with the <tt>swap -l</tt> command.</p></li>
<li><p>System crash dump files will be written in the <tt>/var/crash/venus</tt> directory.</p></li>
<li><p>Saving crash dump files is enabled.</p></li></ul>
</li></ol>

<a name="tscrashdumps-37"></a><h4>How to Modify a Crash Dump Configuration</h4><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="tscrashdumps-step-43"></a><b>Identify the current crash dump configuration.</b><pre># <tt><b>dumpadm</b></tt>
      Dump content: kernel pages
       Dump device: /dev/dsk/c0t3d0s1 (swap)
Savecore directory: /var/crash/pluto
  Savecore enabled: yes</pre><p>This output identifies the default dump configuration for a system running the Solaris
10 release.</p></li>
<li><a name="tscrashdumps-step-44"></a><b>Modify the crash dump configuration.</b><pre># <tt><b>dumpadm -c</b></tt> <i>content</i> <tt><b>-d</b></tt> <i>dump-device</i> <tt><b>-m</b></tt> <i>nnnk | nnnm | nnn%</i> <tt><b>-n</b></tt> <tt><b>-s</b></tt> <i>savecore-dir</i></pre><dl><dt><tt>-c</tt> <i>content</i></dt>
<dd><p>Specifies the type of data to dump. Use <tt>kernel</tt> to dump of all kernel memory, <tt>all</tt> to dump all of memory, or <tt>curproc</tt>, to dump kernel memory and the memory pages of the process whose thread was executing when the crash occurred. The default dump content is kernel memory.</p></dd>
<dt><tt>-d</tt> <i>dump-device</i></dt>
<dd><p>Specifies the device that stores dump data temporarily as the system crashes. The primary swap device is the default dump device. </p></dd>
<dt><tt>-m</tt> <i>nnnk</i> | <i>nnnm</i> | <i>nnn%</i></dt>
<dd><p>Specifies the minimum free disk space for saving crash dump files by creating a <tt>minfree</tt> file in the current <tt>savecore</tt> directory. This parameter can be specified in Kbytes (<tt>nnnk</tt>), Mbytes (<tt>nnnm</tt>) or file system size percentage (<tt>nnn%</tt>). The <tt>savecore</tt> command consults this file prior to writing the crash dump files. If writing the crash dump files, based on their size, would decrease the amount of free space below the <tt>minfree</tt> threshold, the dump files are not written and an error message is logged. For information on recovering from this scenario, see <a href="#tscrashdumps-34">How to Recover From a Full Crash Dump Directory (Optional)</a>.</p></dd>
<dt><tt>-n</tt></dt>
<dd><p>Specifies that <tt>savecore</tt> should not be run when the system reboots. This dump configuration is not recommended. If system crash information is written to the swap device, and <tt>savecore</tt> is not enabled, the crash dump information is overwritten when the system begins to swap.</p></dd>
<dt><tt>-s</tt></dt>
<dd><p>Specifies an alternate directory for storing crash dump files. The default directory is <tt>/var/crash/hostname</tt> where <tt>hostname</tt> is the output of the <tt>uname -n</tt> command.</p></dd>
</dl>
</li></ol><a name="emjeg"></a>Example&nbsp;17-1 Modifying a Crash Dump Configuration<p>In this example, all of memory is dumped to the dedicated dump
device, <tt>/dev/dsk/c0t1d0s1</tt>, and the minimum free space that must be available after the
crash dump files are saved is 10% of the file system space.</p><pre># <tt><b>dumpadm</b></tt>
      Dump content: kernel pages
       Dump device: /dev/dsk/c0t3d0s1 (swap)
Savecore directory: /var/crash/pluto
  Savecore enabled: yes
 # <tt><b>dumpadm -c all -d /dev/dsk/c0t1d0s1 -m 10%</b></tt>
      Dump content: all pages
       Dump device: /dev/dsk/c0t1d0s1 (dedicated)
Savecore directory: /var/crash/pluto (minfree = 77071KB)
  Savecore enabled: yes</pre>

<a name="tscrashdumps-58578"></a><h4>How to Examine a Crash Dump</h4><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="tscrashdumps-step-30"></a><b><a name="tscrashdumps-ix5414"></a><a name="tscrashdumps-ix5415"></a><a name="tscrashdumps-ix5416"></a>Examine a crash dump by using the <tt>mdb</tt> utility.    </b><pre># <tt><b>/usr/bin/mdb</b></tt> [<tt><b>-k</b></tt>] <i>crashdump-file</i></pre><dl><dt><tt>-k</tt></dt>
<dd><p>Specifies kernel debugging mode by assuming the file is an operating system crash dump file.</p></dd>
<dt><i>crashdump-file</i></dt>
<dd><p>Specifies the operating system crash dump file.</p></dd>
</dl>
</li>
<li><a name="tscrashdumps-step-31"></a><b>Display crash status information.</b><pre># <tt><b>/usr/bin/mdb</b></tt> <i>file-name</i>
> <tt><b>::status</b></tt>
   .
   .
   .
> <tt><b>::system</b></tt>
   .
   .
   .</pre></li></ol><a name="emjee"></a>Example&nbsp;17-2 Examining a Crash Dump<p><a name="tscrashdumps-ix5418"></a><a name="tscrashdumps-ix5419"></a><a name="tscrashdumps-ix5420"></a><a name="tscrashdumps-ix5421"></a>The following example shows sample output from the <tt>mdb</tt> utility, which includes system information
and identifies the tunables that are set in this system's <tt>/etc/system</tt> file. 
 </p><pre># <tt><b>/usr/bin/mdb -k unix.0</b></tt> 
Loading modules: [ unix krtld genunix ip nfs ipc ptm ]
> <tt><b>::status</b></tt>
debugging crash dump /dev/mem (64-bit) from ozlo
operating system: 5.10 Generic (sun4u)
> <tt><b>::system</b></tt>
set ufs_ninode=0x9c40 [0t40000]
set ncsize=0x4e20 [0t20000]
set pt_cnt=0x400 [0t1024]</pre>

<a name="tscrashdumps-34"></a><h4>How to Recover From a Full Crash Dump Directory (Optional)</h4><a name="indexterm-150"></a><a name="indexterm-151"></a><p>In this scenario, the system crashes but no room is left in
the <tt>savecore</tt> directory, and you want to save some critical system crash
dump information.  </p><ol>
<li><a name="tscrashdumps-step-45"></a><b>Log in as superuser or assume an equivalent role after the system reboots.</b></li>
<li><a name="tscrashdumps-step-36"></a><b>Clear out the savecore directory, usually <tt>/var/crash/</tt><i>hostname</i>, by removing existing crash dump files
that have already been sent to your service provider. Or, run the <tt>savecore</tt>
command and specify an alternate directory that has sufficient disk space. See the
next step.</b></li>
<li><a name="tscrashdumps-step-37"></a><b>Manually run the <tt>savecore</tt> command and if necessary, specify an alternate savecore directory.</b><pre># <tt><b>savecore</b></tt> [ <i>directory</i> ]</pre></li></ol>

<a name="tscrashdumps-39"></a><h4>How to Disable or Enable Saving Crash Dumps</h4><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="tscrashdumps-step-33"></a><b>Disable or enable the saving of crash dumps on your system. </b><pre># <tt><b>dumpadm -n | -y</b></tt></pre></li></ol><a name="emjef"></a>Example&nbsp;17-3 Disabling the Saving of Crash Dumps<p>This example illustrates how to disable the saving of crash dumps on your
system.</p><pre># <tt><b>dumpadm -n</b></tt>
      Dump content: all pages
       Dump device: /dev/dsk/c0t1d0s1 (dedicated)
Savecore directory: /var/crash/pluto (minfree = 77071KB)
  Savecore enabled: no</pre><a name="emjdz"></a>Example&nbsp;17-4 Enabling the Saving of Crash Dumps<p>This example illustrates how to enable the saving of crash dump on
your system.</p><pre># <tt><b>dumpadm -y</b></tt>
      Dump content: all pages
       Dump device: /dev/dsk/c0t1d0s1 (dedicated)
Savecore directory: /var/crash/pluto (minfree = 77071KB)
  Savecore enabled: yes</pre>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="tscrashdumps-4.html">Previous</a>
             </td>
             <td align="right">
                 <a href="tsgeneral-32935.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

