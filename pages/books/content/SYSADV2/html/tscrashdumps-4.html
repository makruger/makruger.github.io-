<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>System Crashes (Overview) - System Administration Guide: Advanced Administration</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-05-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: Advanced Administration</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="tscrashdumps-26694.html">Previous</a>
             </td>
             <td align="right">
                 <a href="tscrashdumps-31.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="vol2preface-11.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="modconcepts-20809.html">1.&nbsp;&nbsp;Managing Terminals and Modems (Overview)</a></p>
<p class="toc level1 tocsp"><a href="modsetup-43877.html">2.&nbsp;&nbsp;Setting Up Terminals and Modems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="modsafapp-84569.html">3.&nbsp;&nbsp;Managing Serial Ports With the Service Access Facility (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresconcepts-23051.html">4.&nbsp;&nbsp;Managing System Resources (Overview)</a></p>
<p class="toc level1 tocsp"><a href="sysressysinfo-75169.html">5.&nbsp;&nbsp;Displaying and Changing System Information (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresdiskuse-61891.html">6.&nbsp;&nbsp;Managing Disk Use (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresquotas-97946.html">7.&nbsp;&nbsp;Managing Quotas (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysrescron-18108.html">8.&nbsp;&nbsp;Scheduling System Tasks (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresacctsetup-78801.html">9.&nbsp;&nbsp;Managing System Accounting (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresacctref-14910.html">10.&nbsp;&nbsp;System Accounting (Reference)</a></p>
<p class="toc level1 tocsp"><a href="spconcepts-21354.html">11.&nbsp;&nbsp;Managing System Performance (Overview)</a></p>
<p class="toc level1 tocsp"><a href="spprocess-59633.html">12.&nbsp;&nbsp;Managing System Processes (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="spmonitor-24844.html">13.&nbsp;&nbsp;Monitoring System Performance (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsoverview-10750.html">14.&nbsp;&nbsp;Troubleshooting Software Problems (Overview)</a></p>
<p class="toc level1 tocsp"><a href="eekee.html">15.&nbsp;&nbsp;Managing System Messages</a></p>
<p class="toc level1 tocsp"><a href="tscore-7.html">16.&nbsp;&nbsp;Managing Core Files (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tscrashdumps-40145.html">17.&nbsp;&nbsp;Managing System Crash Information (Tasks)</a></p>
<p class="toc level2"><a href="tscrashdumps-26694.html">Managing System Crash Information (Task Map)</a></p>
<div class="onpage">
<p class="toc level2"><a href="">System Crashes (Overview)</a></p>
</div>
<p class="toc level2"><a href="tscrashdumps-31.html">Managing System Crash Dump Information</a></p>
<p class="toc level3"><a href="tscrashdumps-31.html#tscrashdumps-35">How to Display the Current Crash Dump Configuration</a></p>
<p class="toc level3"><a href="tscrashdumps-31.html#tscrashdumps-37">How to Modify a Crash Dump Configuration</a></p>
<p class="toc level3"><a href="tscrashdumps-31.html#tscrashdumps-58578">How to Examine a Crash Dump</a></p>
<p class="toc level3"><a href="tscrashdumps-31.html#tscrashdumps-34">How to Recover From a Full Crash Dump Directory (Optional)</a></p>
<p class="toc level3"><a href="tscrashdumps-31.html#tscrashdumps-39">How to Disable or Enable Saving Crash Dumps</a></p>
<p class="toc level1 tocsp"><a href="tsgeneral-32935.html">18.&nbsp;&nbsp;Troubleshooting Miscellaneous Software Problems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsfileaccess-28392.html">19.&nbsp;&nbsp;Troubleshooting File Access Problems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsfsck-26279.html">20.&nbsp;&nbsp;Resolving UFS File System Inconsistencies (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsswmgr-40462.html">21.&nbsp;&nbsp;Troubleshooting Software Package Problems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="tscrashdumps-4"></a><h3>System Crashes (Overview)</h3>
<p>System crashes can occur due to hardware malfunctions, I/O problems, and software errors.
If the system crashes, it will display an error message on the console,
and then write a copy of its physical memory to the dump
device. The system will then reboot automatically. When the system reboots, the <tt>savecore</tt>
command is executed to retrieve the data from the dump device and write
the saved crash dump to your <tt>savecore</tt> directory. The saved crash dump files
provide invaluable information to your support provider to aid in diagnosing the problem.</p>

<a name="gentextid-14120"></a><h4>ZFS Support for Swap Devices</h4>
<p>If you select a ZFS root file system during an initial installation or
use live upgrade to migrate from a UFS root file system to
a ZFS root file system, a swap area is created on a ZFS
volume in the ZFS root pool. The swap area size is based on
1/4 to 1/2 of physical memory.</p><p>For example:</p><pre># swap -l
swapfile                  dev    swaplo   blocks     free
/dev/zvol/dsk/rpool/swap 253,3        16  8257520  8257520</pre><p>A ZFS volume is also created for the dump device. Currently, the
swap area and the dump device must reside on separate ZFS volumes.</p><p>If you need to modify your ZFS swap area after installation, then
use the swap command as in previous Solaris releases. For more information, see
<a href="http://docs.sun.com/doc/819-2723/fsswap-14677?a=view">Chapter 21, Configuring Additional Swap Space (Tasks), in <i>System Administration Guide: Devices and File Systems</i></a>.</p><p>For information about managing dump devices, see <a href="tscrashdumps-31.html">Managing System Crash Dump Information</a>.</p>

<a name="fxcly"></a><h4>x86: System Crashes in the GRUB Boot Environment</h4>
<a name="indexterm-143"></a><a name="indexterm-144"></a><a name="indexterm-145"></a><p> If a system crash occurs on an x86 based system in
the GRUB boot environment, it is possible that the SMF service that manages
the GRUB boot archive, <tt>svc:/system/boot-archive:default,</tt> might fail on the next system reboot. To troubleshoot
this type of problem, see <a href="fxcmh.html">x86: What to Do if the SMF Boot Archive Service Fails During a System Reboot</a>. For more information on GRUB based
booting, see <a href="http://docs.sun.com/doc/819-2379/hbx86boot-68676?a=view">Booting an x86 Based System by Using GRUB (Task Map) in <i>System Administration Guide: Basic Administration</i></a>.</p>

<a name="tscrashdumps-1"></a><h4>System Crash Dump Files</h4>
<p>The <tt>savecore</tt> command runs automatically after a system crash to retrieve the crash
dump information from the dump device and writes a pair of files called
<tt>unix</tt>.<i>X</i> and <tt>vmcore</tt>.<i>X</i>, where <i>X</i> identifies the dump sequence number. Together, these files
represent the saved system crash dump information. </p><p>Crash dump files are sometimes confused with <b>core</b> files, which are images of
user applications that are written when the application terminates abnormally.</p><p><a name="tscrashdumps-ix5389"></a><a name="tscrashdumps-ix5391"></a>Crash dump files are saved in a predetermined directory, which by default, is
<tt>/var/crash/</tt><i>hostname</i>. In previous Solaris releases, crash dump files were overwritten when a system
rebooted, unless you manually enabled the system to save the images of physical
memory in a crash dump file. Now, the saving of crash dump files
is enabled by default. </p><p>System crash information is managed with the <tt>dumpadm</tt> command. For more information, see
<a href="#tscrashdumps-32">The <tt>dumpadm</tt> Command</a>.</p>

<a name="tscrashdumps-25"></a><h4>Saving Crash Dumps</h4>
<p>You can examine the control structures, active tables, memory images of a live
or crashed system kernel, and other information about the operation of the kernel
by using the <tt>mdb</tt> utility. Using <tt>mdb</tt> to its full potential requires a
detailed knowledge of the kernel, and is beyond the scope of this manual.
For information on using this utility, see the <a href="http://docs.sun.com/doc/819-2239/mdb-1?a=view"><tt>mdb</tt>(1)</a> man page.</p><p><a name="tscrashdumps-ix5393"></a><a name="tscrashdumps-ix5394"></a><a name="indexterm-146"></a>Additionally, crash dumps saved by <tt>savecore</tt> can be useful to send to a
customer service representative for analysis of why the system is crashing. </p>

<a name="tscrashdumps-32"></a><h4>The <tt>dumpadm</tt> Command</h4>
<p>Use the <tt>dumpadm</tt> command to manage system crash dump information in the Solaris
Operating System.</p>
<ul><li><p>The <tt>dumpadm</tt> command enables you to configure crash dumps of the operating system. The <tt>dumpadm</tt> configuration parameters include the dump content, dump device, and the directory in which crash dump files are saved.</p></li>
<li><p>Dump data is stored in compressed format on the dump device. Kernel crash dump images can be as big as 4 Gbytes or more. Compressing the data means faster dumping and less disk space needed for the dump device.</p></li>
<li><p>Saving crash dump files is run in the background when a dedicated dump device, not the swap area, is part of the dump configuration. This means a booting system does not wait for the <tt>savecore</tt> command to complete before going to the next step. On large memory systems, the system can be available before <tt>savecore</tt> completes.</p></li>
<li><p>System crash dump files, generated by the <tt>savecore</tt> command, are saved by default.</p></li>
<li><p>The <tt>savecore -L</tt> command is a new feature which enables you to get a crash dump of the live running the Solaris OS. This command is intended for troubleshooting a running system by taking a snapshot of memory during some bad state, such as a transient performance problem or service outage. If the system is up and you can still run some commands, you can execute the <tt>savecore -L</tt> command to save a snapshot of the system to the dump device, and then immediately write out the crash dump files to your <tt>savecore</tt> directory. Because the system is still running, you can only use the <tt>savecore -L</tt> command if you have configured a dedicated dump device.</p></li></ul>
<p><a name="indexterm-147"></a><a name="indexterm-148"></a><a name="indexterm-149"></a>The following table describes <tt>dumpadm</tt>'s configuration parameters.</p><table><col width="118*"><col width="278*"><tr><th align="left" valign="top" scope="column"><p>Dump Parameter</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>dump device</p></td>
<td align="left" valign="top" scope="row"><p>The device that stores dump
data temporarily as the system crashes. When the dump device is not the
swap area, <tt>savecore</tt> runs in the background, which speeds up the boot process.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>savecore
directory</p></td>
<td align="left" valign="top" scope="row"><p>The directory that stores system crash dump files.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>dump content</p></td>
<td align="left" valign="top" scope="row"><p>Type of memory data
to dump. </p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>minimum free space</p></td>
<td align="left" valign="top" scope="row"><p>Minimum amount of free space required in the
<tt>savecore</tt> directory after saving crash dump files.  If no minimum free space
has been configured, the default is one Mbyte.</p></td>
</tr>
</table><p>For more information, see <a href="http://docs.sun.com/doc/819-2240/dumpadm-1m?a=view"><tt>dumpadm</tt>(1M)</a>.</p><p>Dump configuration parameters are managed by the <tt>dumpadm</tt> command.</p>

<a name="tscrashdumps-33"></a><h4>How the <tt>dumpadm</tt> Command Works</h4>
<p>During system startup, the <tt>dumpadm</tt> command is invoked by the <tt>svc:/system/dumpadm:default</tt> service to
configure crash dumps parameters.</p><p>Specifically, <tt>dumpadm</tt> initializes the dump device and the dump content through the <tt>/dev/dump</tt>
interface.</p><p>After the dump configuration is complete, the <tt>savecore</tt> script looks for the location
of the crash dump file directory. Then, <tt>savecore</tt> is invoked to check
for crash dumps and check the content of the <tt>minfree</tt> file in
the crash dump directory. </p>

<a name="tscrashdumps-5"></a><h4>Dump Devices and Volume Managers</h4>
<p>Do not configure a dedicated dump device that is under the control
of volume management product such as Solaris Volume Manager for accessibility and performance reasons.
You can keep your swap areas under the control of Solaris Volume Manager
and this is a recommend practice, but keep your dump device separate.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="tscrashdumps-26694.html">Previous</a>
             </td>
             <td align="right">
                 <a href="tscrashdumps-31.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

