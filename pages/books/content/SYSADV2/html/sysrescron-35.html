<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Scheduling a Single System Task (<tt>at</tt>) - System Administration Guide: Advanced Administration</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-05-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: Advanced Administration</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="enmww.html">Previous</a>
             </td>
             <td align="right">
                 <a href="sysresacctsetup-78801.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="vol2preface-11.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="modconcepts-20809.html">1.&nbsp;&nbsp;Managing Terminals and Modems (Overview)</a></p>
<p class="toc level1 tocsp"><a href="modsetup-43877.html">2.&nbsp;&nbsp;Setting Up Terminals and Modems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="modsafapp-84569.html">3.&nbsp;&nbsp;Managing Serial Ports With the Service Access Facility (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresconcepts-23051.html">4.&nbsp;&nbsp;Managing System Resources (Overview)</a></p>
<p class="toc level1 tocsp"><a href="sysressysinfo-75169.html">5.&nbsp;&nbsp;Displaying and Changing System Information (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresdiskuse-61891.html">6.&nbsp;&nbsp;Managing Disk Use (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresquotas-97946.html">7.&nbsp;&nbsp;Managing Quotas (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysrescron-18108.html">8.&nbsp;&nbsp;Scheduling System Tasks (Tasks)</a></p>
<p class="toc level2"><a href="enmwx.html">Creating and Editing <tt>crontab</tt> Files (Task Map)</a></p>
<p class="toc level2"><a href="sysrescron-68.html">Ways to Automatically Execute System Tasks</a></p>
<p class="toc level2"><a href="sysrescron-1.html">Scheduling a Repetitive System Task (<tt>cron</tt>)</a></p>
<p class="toc level2"><a href="sysrescron-24589.html">Creating and Editing <tt>crontab</tt> Files</a></p>
<p class="toc level3"><a href="sysrescron-24589.html#sysrescron-72169">How to Create or Edit a <tt>crontab</tt> File</a></p>
<p class="toc level3"><a href="sysrescron-24589.html#enmxc">How to Verify That a <tt>crontab</tt> File Exists</a></p>
<p class="toc level2 tocsp"><a href="sysrescron-12.html">Displaying <tt>crontab</tt> Files</a></p>
<p class="toc level3"><a href="sysrescron-12.html#sysrescron-60540">How to Display a <tt>crontab</tt> File</a></p>
<p class="toc level2 tocsp"><a href="sysrescron-17.html">Removing <tt>crontab</tt> Files</a></p>
<p class="toc level3"><a href="sysrescron-17.html#sysrescron-31048">How to Remove a <tt>crontab</tt> File</a></p>
<p class="toc level2 tocsp"><a href="sysrescron-23.html">Controlling Access to the <tt>crontab</tt> Command</a></p>
<p class="toc level3"><a href="sysrescron-23.html#sysrescron-88294">How to Deny <tt>crontab</tt> Command Access</a></p>
<p class="toc level3"><a href="sysrescron-23.html#sysrescron-36206">How to Limit <tt>crontab</tt> Command Access to Specified Users</a></p>
<p class="toc level2 tocsp"><a href="enmww.html">Using the <tt>at</tt> Command (Task Map)</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Scheduling a Single System Task (<tt>at</tt>)</a></p>
<p class="toc level3"><a href="#sysrescron-26337">How to Create an <tt>at</tt> Job</a></p>
<p class="toc level3"><a href="#enmxg">How to Display the <tt>at</tt> Queue</a></p>
<p class="toc level3"><a href="#enmxi">How to Verify an <tt>at</tt> Job</a></p>
<p class="toc level3"><a href="#enmxh">How to Display <tt>at</tt> Jobs</a></p>
<p class="toc level3"><a href="#sysrescron-62698">How to Remove <tt>at</tt> Jobs</a></p>
<p class="toc level3"><a href="#sysrescron-94711">How to Deny Access to the <tt>at</tt> Command</a></p>
<p class="toc level3"><a href="#enmxk">How to Verify That <tt>at</tt> Command Access Is Denied</a></p>
</div>
<p class="toc level1 tocsp"><a href="sysresacctsetup-78801.html">9.&nbsp;&nbsp;Managing System Accounting (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresacctref-14910.html">10.&nbsp;&nbsp;System Accounting (Reference)</a></p>
<p class="toc level1 tocsp"><a href="spconcepts-21354.html">11.&nbsp;&nbsp;Managing System Performance (Overview)</a></p>
<p class="toc level1 tocsp"><a href="spprocess-59633.html">12.&nbsp;&nbsp;Managing System Processes (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="spmonitor-24844.html">13.&nbsp;&nbsp;Monitoring System Performance (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsoverview-10750.html">14.&nbsp;&nbsp;Troubleshooting Software Problems (Overview)</a></p>
<p class="toc level1 tocsp"><a href="eekee.html">15.&nbsp;&nbsp;Managing System Messages</a></p>
<p class="toc level1 tocsp"><a href="tscore-7.html">16.&nbsp;&nbsp;Managing Core Files (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tscrashdumps-40145.html">17.&nbsp;&nbsp;Managing System Crash Information (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsgeneral-32935.html">18.&nbsp;&nbsp;Troubleshooting Miscellaneous Software Problems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsfileaccess-28392.html">19.&nbsp;&nbsp;Troubleshooting File Access Problems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsfsck-26279.html">20.&nbsp;&nbsp;Resolving UFS File System Inconsistencies (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsswmgr-40462.html">21.&nbsp;&nbsp;Troubleshooting Software Package Problems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="sysrescron-35"></a><h3>Scheduling a Single System Task (<tt>at</tt>)</h3>
<p><a name="sysrescron-ix2604"></a><a name="sysrescron-ix2605"></a><a name="sysrescron-ix2606"></a><a name="sysrescron-ix2607"></a><a name="sysrescron-ix2608"></a><a name="sysrescron-ix2609"></a>The following sections describe how to use the <tt>at</tt> command to perform the
following tasks:</p>
<ul><li><p>Schedule jobs (command and scripts) for execution at a later time</p></li>
<li><p>How to display and remove these jobs</p></li>
<li><p>How to control access to the <tt>at</tt> command</p></li></ul>
<p>By default, users can create, display, and remove their own <tt>at</tt> job files.
To access <tt>at</tt> files that belong to <tt>root</tt> or other users, you must
have superuser privileges.</p><p>When you submit an <tt>at</tt> job, it is assigned a job identification number
along with the <tt>.a</tt> extension. This designation becomes the job's file name, as
well as its queue number.</p>

<a name="sysrescron-12091"></a><h4>Description of the <tt>at</tt> Command</h4>
<p><a name="sysrescron-ix2612"></a>Submitting an <tt>at</tt> job file involves these steps:</p>
<ol><li><p>Invoking the <tt>at</tt> utility and specifying a command execution time.</p></li>
<li><p>Typing a command or script to execute later.</p>
<hr><p><b>Note - </b>If output from this command or script is important, be sure to direct the output to a file for later examination.</p>
<hr>
</li></ol>
<p><a name="sysrescron-ix2613"></a>For example, the following <tt>at</tt> job removes <tt>core</tt> files from the user account
<tt>smith</tt> near midnight on the last day of July.  </p><pre>$ <tt><b>at 11:45pm July 31</b></tt>
at> <tt><b>rm /home/smith/*core*</b></tt>
at> <i>Press Control-d</i>
commands will be executed using /bin/csh
job 933486300.a at Tue Jul 31 23:45:00 2004</pre>

<a name="sysrescron-32173"></a><h4>Controlling Access to the <tt>at</tt> Command</h4>
<p><a name="sysrescron-ix2614"></a><a name="sysrescron-ix2615"></a><a name="sysrescron-ix2616"></a><a name="sysrescron-ix2617"></a><a name="sysrescron-ix2618"></a>You can set up a file to control access to the <tt>at</tt> command,
permitting only specified users to create, remove, or display queue information about their <tt>at</tt>
jobs. The file that controls access to the <tt>at</tt> command, <tt>/etc/cron.d/at.deny</tt>, consists
of a list of user names, one user name per line. The users
who are listed in this file cannot access <tt>at</tt> commands.   
 </p><p>The <tt>at.deny</tt> file, which is created during SunOS software installation, contains the following
user names:  </p><pre>daemon
bin
smtp
nuucp
listen
nobody
noaccess</pre><p><a name="sysrescron-ix2619"></a><a name="sysrescron-ix2620"></a><a name="sysrescron-ix2621"></a><a name="sysrescron-ix2622"></a>With superuser privileges, you can edit the <tt>at.deny</tt> file to add other user names
whose <tt>at</tt> command access you want to restrict.</p>

<a name="sysrescron-26337"></a><h4>How to Create an <tt>at</tt> Job</h4><ol>
<li><a name="sysrescron-step-37"></a><b><a name="sysrescron-ix2625"></a><a name="sysrescron-ix2626"></a><a name="sysrescron-ix2627"></a>Start the <tt>at</tt> utility, specifying the time you want your job executed. 
</b><pre>$ <tt><b>at</b></tt> [<tt><b>-m</b></tt>] <i>time</i> [<i>date</i>] </pre><dl><dt><tt>-m</tt></dt>
<dd><p>Sends you email after the job is completed.</p></dd>
<dt><i>time</i></dt>
<dd><p>Specifies the hour that you want to schedule the job. Add <tt>am</tt> or <tt>pm</tt> if you do not specify the hours according to the 24-hour clock. Acceptable keywords are <tt>midnight</tt>, <tt>noon</tt>, and <tt>now</tt>. Minutes are optional.</p></dd>
<dt><i>date</i></dt>
<dd><p>Specifies the first three or more letters of a month, a day of the week, or the keywords <tt>today</tt> or <tt>tomorrow</tt>.</p></dd>
</dl>
</li>
<li><a name="sysrescron-step-38"></a><b>At the <tt>at</tt> prompt, type the commands or scripts that you want to
execute, one per line. </b><p>You may type more than one command by pressing Return at the end
of each line. </p></li>
<li><a name="sysrescron-step-39"></a><b>Exit the <tt>at</tt> utility and save the <tt>at</tt> job by pressing Control-D. </b><p>Your <tt>at</tt> job is assigned a queue number, which is also the
job's file name. This number is displayed when you exit the <tt>at</tt> utility.
</p></li></ol><a name="emjft"></a>Example&nbsp;8-7 Creating an <tt>at</tt> Job<p><a name="sysrescron-ix2633"></a>The following example shows the <tt>at</tt> job that user <tt>jones</tt> created to remove
her backup files at 7:30 p.m. She used the <tt>-m</tt> option so that
she would receive an email message after her job completed.  </p><pre>$ <tt><b>at -m 1930</b></tt>
at> <tt><b>rm /home/jones/*.backup</b></tt>
at> <i>Press Control-D</i>
job 897355800.a at Thu Jul  12 19:30:00 2004</pre><p>She received a email message which confirmed the execution of her <tt>at</tt>
job. </p><pre>Your &ldquo;at&rdquo; job &ldquo;<tt><b>rm /home/jones/*.backup</b></tt>&rdquo;
completed.</pre><p><a name="sysrescron-ix2639"></a><a name="sysrescron-ix2640"></a>The following example shows how <tt>jones</tt> scheduled a large <tt>at</tt> job for 4:00
a.m. Saturday morning. The job output was directed to a file named <tt>big.file</tt>.
 </p><pre>$ <tt><b>at 4 am Saturday</b></tt>
at> <tt><b>sort -r /usr/dict/words > /export/home/jones/big.file</b></tt></pre>

<a name="enmxg"></a><h4>How to Display the <tt>at</tt> Queue</h4><ul>
<li><b>To check your jobs that are waiting in the <tt>at</tt> queue, use the
<tt>atq</tt> command. This command displays status information about the <tt>at</tt> jobs that you
have created. </b><pre>$ <tt><b>atq</b></tt></pre></li></ul>

<a name="enmxi"></a><h4>How to Verify an <tt>at</tt> Job</h4><ul>
<li><b>To verify that you have created an <tt>at</tt> job, use the <tt>atq</tt> command.
In the following example, the <tt>atq</tt> command confirms that <tt>at</tt> jobs that
belong to <tt>jones</tt> have been submitted to the queue. </b><pre>$ <tt><b>atq</b></tt>
Rank      Execution Date     Owner     Job         Queue   Job Name
  1st   Jul 12, 2004 19:30   jones  897355800.a     a     stdin
  2nd   Jul 14, 2004 23:45   jones  897543900.a     a     stdin
  3rd   Jul 17, 2004 04:00   jones  897732000.a     a     stdin</pre></li></ul>

<a name="enmxh"></a><h4>How to Display <tt>at</tt> Jobs</h4><ul>
<li><b>To display information about the execution times of your <tt>at</tt> jobs, use the
<tt>at -l</tt> command.</b><pre>$ <tt><b>at -l</b></tt> [<i>job-id</i>]</pre><p>where the <tt>-l</tt> <i>job-id</i> option identifies the identification number of the job whose
status you want to display.</p></li></ul><a name="sysrescron-43"></a>Example&nbsp;8-8 Displaying <tt>at</tt> Jobs<p>The following example shows output from the <tt>at -l</tt> command, which provides information on
the status of all jobs submitted by a user.</p><pre>$ <tt><b>at -l</b></tt>
897543900.a    Sat Jul 14 23:45:00 2004
897355800.a    Thu Jul 12 19:30:00 2004
897732000.a    Tue Jul 17 04:00:00 2004</pre><p><a name="sysrescron-ix2651"></a><a name="sysrescron-ix2652"></a><a name="sysrescron-ix2653"></a>The following example shows the output that is displayed when a single job
is specified with the <tt>at -l</tt> command.</p><pre>$ <tt><b>at -l 897732000.a</b></tt>
897732000.a        Tue Jul 17 04:00:00 2004</pre>

<a name="sysrescron-62698"></a><h4>How to Remove <tt>at</tt> Jobs</h4><h6>Before You Begin</h6><p>Become superuser or assume an equivalent role to remove an <tt>at</tt> job that
belongs to <tt>root</tt> or another user. Roles contain authorizations and privileged commands. For
more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p><p>You do not need to become superuser or assume an equivalent role
to remove your own <tt>at</tt> job.</p><ol>
<li><a name="sysrescron-step-46"></a><b>Remove the <tt>at</tt> job from the queue before the job is executed. </b><pre>$ <tt><b>at -r</b></tt> [<i>job-id</i>]</pre><p>where the <tt>-r</tt> <i>job-id</i> option specifies the identification number of the job you
want to remove.</p></li>
<li><a name="sysrescron-step-59"></a><b>Verify that the <tt>at</tt> job is removed by using the <tt>at -l</tt> (or the
<tt>atq</tt>) command.</b><p>The <tt>at -l</tt> command displays the jobs remaining in the <tt>at</tt> queue. The job
whose identification number you specified should not appear.</p><pre>$ <tt><b>at -l</b></tt> [<i>job-id</i>]</pre></li></ol><a name="emjfk"></a>Example&nbsp;8-9 Removing <tt>at</tt> Jobs<p><a name="sysrescron-ix2656"></a><a name="sysrescron-ix2657"></a><a name="sysrescron-ix2658"></a>In the following example, a user wants to remove an <tt>at</tt> job
that was scheduled to execute at 4 a.m. on July 17th. First, the
user displays the <tt>at</tt> queue to locate the job identification number. Next, the
user removes this job from the <tt>at</tt> queue. Finally, the user verifies that
this job has been removed from the queue.   </p><pre>$ <tt><b>at -l</b></tt>
897543900.a    Sat Jul 14 23:45:00 2003
897355800.a    Thu Jul 12 19:30:00 2003
897732000.a    Tue Jul 17 04:00:00 2003
$ <tt><b>at -r 897732000.a</b></tt>
$ <tt><b>at -l 897732000.a</b></tt>
at: 858142000.a: No such file or directory</pre>

<a name="sysrescron-94711"></a><h4>How to Deny Access to the <tt>at</tt> Command</h4><a name="indexterm-70"></a><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="sysrescron-step-53"></a><b>Edit the <tt>/etc/cron.d/at.deny</tt> file and add the names of users, one user name
per line, that will be prevented from using the <tt>at</tt> commands.  </b><pre>daemon
bin
smtp
nuucp
listen
nobody
noaccess
<i>username1</i>
<i>username2</i>
<i>username3</i>
.
.
.</pre></li></ol><a name="emjfu"></a>Example&nbsp;8-10 Denying <tt>at</tt> Access<p><a name="sysrescron-ix2666"></a><a name="sysrescron-ix2667"></a><a name="sysrescron-ix2670"></a><a name="sysrescron-ix2671"></a><a name="sysrescron-ix2672"></a><a name="sysrescron-ix2673"></a>The following example shows an <tt>at.deny</tt> file that has been edited so
that the users <tt>smith</tt> and <tt>jones</tt> cannot access the <tt>at</tt> command. 
     </p><pre>$ <tt><b>cat at.deny</b></tt>
daemon
bin
smtp
nuucp
listen
nobody
noaccess
jones
smith</pre>

<a name="enmxk"></a><h4>How to Verify That <tt>at</tt> Command Access Is Denied</h4><ul>
<li><b>To verify that a username was added correctly to  the <tt>/etc/cron.d/at.deny</tt>
file, use the <tt>at -l</tt> command while logged in as the user. If the
user <tt>smith</tt> cannot access the <tt>at</tt> command, the following message is displayed. <a name="sysrescron-ix2664"></a><a name="sysrescron-ix2665"></a></b><pre># <tt><b>su smith</b></tt>
Password:
$ <tt><b>at -l</b></tt>
at: you are not authorized to use at.  Sorry.</pre><p>Likewise, if the user tries to submit an <tt>at</tt> job, the following message
is displayed:  </p><pre>$ <tt><b>at 2:30pm</b></tt>
at: you are not authorized to use at.  Sorry.</pre><p>This message confirms that the user is listed in the <tt>at.deny</tt> file.
</p><p>If <tt>at</tt> command access is allowed, then the <tt>at -l</tt> command returns nothing.</p></li></ul>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="enmww.html">Previous</a>
             </td>
             <td align="right">
                 <a href="sysresacctsetup-78801.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

