<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Managing Core Files Overview - System Administration Guide: Advanced Administration</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-05-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: Advanced Administration</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="tscore-4.html">Previous</a>
             </td>
             <td align="right">
                 <a href="tscore-18.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="vol2preface-11.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="modconcepts-20809.html">1.&nbsp;&nbsp;Managing Terminals and Modems (Overview)</a></p>
<p class="toc level1 tocsp"><a href="modsetup-43877.html">2.&nbsp;&nbsp;Setting Up Terminals and Modems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="modsafapp-84569.html">3.&nbsp;&nbsp;Managing Serial Ports With the Service Access Facility (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresconcepts-23051.html">4.&nbsp;&nbsp;Managing System Resources (Overview)</a></p>
<p class="toc level1 tocsp"><a href="sysressysinfo-75169.html">5.&nbsp;&nbsp;Displaying and Changing System Information (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresdiskuse-61891.html">6.&nbsp;&nbsp;Managing Disk Use (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresquotas-97946.html">7.&nbsp;&nbsp;Managing Quotas (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysrescron-18108.html">8.&nbsp;&nbsp;Scheduling System Tasks (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresacctsetup-78801.html">9.&nbsp;&nbsp;Managing System Accounting (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="sysresacctref-14910.html">10.&nbsp;&nbsp;System Accounting (Reference)</a></p>
<p class="toc level1 tocsp"><a href="spconcepts-21354.html">11.&nbsp;&nbsp;Managing System Performance (Overview)</a></p>
<p class="toc level1 tocsp"><a href="spprocess-59633.html">12.&nbsp;&nbsp;Managing System Processes (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="spmonitor-24844.html">13.&nbsp;&nbsp;Monitoring System Performance (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsoverview-10750.html">14.&nbsp;&nbsp;Troubleshooting Software Problems (Overview)</a></p>
<p class="toc level1 tocsp"><a href="eekee.html">15.&nbsp;&nbsp;Managing System Messages</a></p>
<p class="toc level1 tocsp"><a href="tscore-7.html">16.&nbsp;&nbsp;Managing Core Files (Tasks)</a></p>
<p class="toc level2"><a href="tscore-4.html">Managing Core Files (Task Map)</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Managing Core Files Overview</a></p>
<p class="toc level3"><a href="#tscore-6">How to Set a Core File Name Pattern</a></p>
<p class="toc level3"><a href="#tscore-12">How to Enable a Per-Process Core File Path</a></p>
<p class="toc level3"><a href="#tscore-14">How to Enable a Global Core File Path</a></p>
</div>
<p class="toc level2 tocsp"><a href="tscore-18.html">Troubleshooting Core File Problems</a></p>
<p class="toc level2"><a href="tscore-11.html">Examining Core Files</a></p>
<p class="toc level1 tocsp"><a href="tscrashdumps-40145.html">17.&nbsp;&nbsp;Managing System Crash Information (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsgeneral-32935.html">18.&nbsp;&nbsp;Troubleshooting Miscellaneous Software Problems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsfileaccess-28392.html">19.&nbsp;&nbsp;Troubleshooting File Access Problems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsfsck-26279.html">20.&nbsp;&nbsp;Resolving UFS File System Inconsistencies (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tsswmgr-40462.html">21.&nbsp;&nbsp;Troubleshooting Software Package Problems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="tscore-8"></a><h3>Managing Core Files Overview</h3>
<p><a name="indexterm-129"></a><a name="indexterm-130"></a><a name="indexterm-131"></a>Core files are generated when a process or application terminates abnormally. Core files
are managed with the <tt>coreadm</tt> command.</p><p>For example, you can use the <tt>coreadm</tt> command to configure a system so
that all process core files are placed in a single system directory. This
means it is easier to track problems by examining the core files
in a specific directory whenever a Solaris process or daemon terminates abnormally.</p>

<a name="tscore-9"></a><h4>Configurable Core File Paths</h4>
<p>Two new configurable <tt>core</tt> file paths that can be enabled or disabled independently
of each other are:</p>
<ul><li><p><a name="indexterm-132"></a>A per-process core file path, which defaults to <tt>core</tt> and is enabled by default. If enabled, the per-process core file path causes a <tt>core</tt> file to be produced when the process terminates abnormally. The per-process path is inherited by a new process from its parent process. </p><p>When generated, a per-process core file is owned by the owner of the process with read/write permissions for the owner. Only the owning user can view this file.</p></li>
<li><p><a name="indexterm-133"></a>A global core file path, which defaults to <tt>core</tt> and is disabled by default. If enabled, an <b>additional</b> core file with the same content as the per-process core file is produced by using the global core file path.</p><p>When generated, a global core file is owned by superuser with read/write permissions for superuser only. Non-privileged users cannot view this file.</p></li></ul>
<p>When a process terminates abnormally, it produces a core file in the current
directory by default. If the global core file path is enabled, each abnormally
terminating process might produce two files, one in the current working directory, and
one in the global core file location.</p><p>By default, a <tt>setuid</tt> process does not produce core files using either the
global or per-process path.</p>

<a name="tscore-1"></a><h4>Expanded Core File Names</h4>
<p>If a global core file directory is enabled, <tt>core</tt> files can be distinguished
from one another by using the variables described in the following table.</p><table><col width="143.19*"><col width="252.81*"><tr><th align="left" valign="top" scope="column"><p>Variable Name</p></th>
<th align="left" valign="top" scope="column"><p>Variable
Definition</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>%d</tt></p></td>
<td align="left" valign="top" scope="row"><p>Executable file directory name, up to a maximum of <tt>MAXPATHLEN</tt> characters</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>%f</tt></p></td>
<td align="left" valign="top" scope="row"><p>Executable file
name, up to a maximum of <tt>MAXCOMLEN</tt> characters</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>%g</tt></p></td>
<td align="left" valign="top" scope="row"><p>Effective group ID</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>%m</tt></p></td>
<td align="left" valign="top" scope="row"><p>Machine name (<tt>uname -m</tt>)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>%n</tt></p></td>
<td align="left" valign="top" scope="row"><p>System
node name )<tt>uname -n</tt>)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>%p</tt></p></td>
<td align="left" valign="top" scope="row"><p>Process ID</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>%t</tt></p></td>
<td align="left" valign="top" scope="row"><p>Decimal value of time(2)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>%u</tt></p></td>
<td align="left" valign="top" scope="row"><p>Effective user ID</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>%z</tt></p></td>
<td align="left" valign="top" scope="row"><p>Name of the zone
in which process is executed (<tt>zonename</tt>)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>%%</tt></p></td>
<td align="left" valign="top" scope="row"><p>Literal %</p></td>
</tr>
</table><p>For example, if the global core file path is set to: </p><p><tt>/var/core/core.%f.%p</tt></p><p>and a <tt>sendmail</tt> process with PID <tt>12345</tt> terminates abnormally, it produces the following
<tt>core</tt> file:</p><p><tt>/var/core/core.sendmail.12345</tt></p>

<a name="tscore-2"></a><h4>Setting the Core File Name Pattern</h4>
<p>You can set a core file name pattern on a global, zone,
or per-process basis. In addition, you can set the per-process defaults that persist
across a system reboot.<a name="indexterm-134"></a></p><p>For example, the following <tt>coreadm</tt> command sets the default per-process core file pattern.
This setting applies to all processes that have not explicitly overridden the default
core file pattern. This setting persists across system reboots.</p><pre># <tt><b>coreadm -i /var/core/core.%f.%p</b></tt></pre><p>This <tt>coreadm</tt> command sets the per-process core file name pattern for any processes:</p><pre>$ <tt><b>coreadm -p /var/core/core.%f.%p $$</b></tt></pre><p>The <tt>$$</tt> symbols represent a placeholder for the process ID of the currently
running shell. The per-process core file name pattern is inherited by all child
processes.</p><p>Once a global or per-process core file name pattern is set, it
must be enabled with the <tt>coreadm -e</tt> command. See the following procedures for more information.</p><p>You can set the core file name pattern for all processes run
during a user's login session by putting the command in a user's <tt>$HOME/.profile</tt>
or <tt>.login</tt> file.</p>

<a name="tscore-3"></a><h4>Enabling <tt>setuid</tt> Programs to Produce Core Files</h4>
<p>You can use the <tt>coreadm</tt> command to enable or disable <tt>setuid</tt> programs
to produce core files for all system processes or on a per-process basis
by setting the following paths:</p>
<ul><li><p>If the global <tt>setuid</tt> option is enabled, a global core file path allows all <tt>setuid</tt> programs on a system to produce <tt>core</tt> files.</p></li>
<li><p>If the per-process <tt>setuid</tt> option is enable, a per-process core file path allows specific <tt>setuid</tt> processes to produce <tt>core</tt> files. </p></li></ul>
<p>By default, both flags are disabled. For security reasons, the global core file
path must be a full pathname, starting with a leading <tt>/</tt>. If superuser
disables per-process core files, individual users cannot obtain core files. </p><p>The <tt>setuid</tt> core files are owned by superuser with read/write permissions for superuser
only. Regular users cannot access them even if the process that produced the
<tt>setuid</tt> core file was owned by an ordinary user. </p><p>For more information, see <a href="http://docs.sun.com/doc/819-2240/coreadm-1m?a=view"><tt>coreadm</tt>(1M)</a>.</p>

<a name="tscore-5"></a><h4>How to Display the Current Core Dump Configuration</h4>
<p><a name="indexterm-135"></a><a name="indexterm-136"></a><a name="indexterm-137"></a>Use the <tt>coreadm</tt> command without any options to display the current core dump configuration.</p><pre>$ <tt><b>coreadm</b></tt>
               global core file pattern: 
     global core file content: default
       init core file pattern: core
       init core file content: default
            global core dumps: disabled
       per-process core dumps: enabled
      global setid core dumps: disabled
 per-process setid core dumps: disabled
     global core dump logging: disabled</pre>

<a name="tscore-6"></a><h4>How to Set a Core File Name Pattern</h4><ul>
<li><a name="tscore-step-2"></a><b><a name="indexterm-138"></a><a name="indexterm-139"></a>Determine whether you want to set a per-process or global core file and
select one of the following:</b><ol style="list-style-type: lower-alpha">
				 
<li><a name="tscore-step-3"></a><b>Set a per-process file name pattern.</b><pre>$ <tt><b>coreadm -p $HOME/corefiles/%f.%p $$</b></tt></pre></li>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="tscore-step-4"></a><b>Set a global file name pattern.</b><pre># <tt><b>coreadm -g /var/corefiles/%f.%p</b></tt></pre></li></ol></li></ul>

<a name="tscore-12"></a><h4>How to Enable a Per-Process Core File Path</h4><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="tscore-step-6"></a><b>Enable a per-process core file path.</b><pre># <tt><b>coreadm -e process</b></tt></pre></li>
<li><a name="tscore-step-9"></a><b>Display the current process core file path to verify the configuration.</b><pre>$ <tt><b>coreadm $$</b></tt>
1180:   /home/kryten/corefiles/%f.%p</pre></li></ol>

<a name="tscore-14"></a><h4>How to Enable a Global Core File Path</h4><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="tscore-step-11"></a><b>Enable a global core file path.</b><pre># <tt><b>coreadm -e global -g /var/core/core.%f.%p</b></tt></pre></li>
<li><a name="tscore-step-14"></a><b>Display the current process core file path to verify the configuration.</b><pre># <tt><b>coreadm</b></tt>
       global core file pattern: /var/core/core.%f.%p
     global core file content: default
       init core file pattern: core
       init core file content: default
            global core dumps: enabled
       per-process core dumps: enabled
      global setid core dumps: disabled
 per-process setid core dumps: disabled
     global core dump logging: disabled</pre></li></ol>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="tscore-4.html">Previous</a>
             </td>
             <td align="right">
                 <a href="tscore-18.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

