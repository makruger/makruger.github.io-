<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>SMF Concepts - System Administration Guide: Basic Administration</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-12-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Basic Administration</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="feosq.html">Previous</a>
             </td>
             <td align="right">
                 <a href="dzhjy.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="vol1preface-11.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="saroadmap-1.html">1.&nbsp;&nbsp;Solaris Management Tools (Road Map)</a></p>
<p class="toc level1 tocsp"><a href="smcover-1.html">2.&nbsp;&nbsp;Working With the Solaris Management Console (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ewpor.html">3.&nbsp;&nbsp;Working With the Sun Java Web Console (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="userconcept-97366.html">4.&nbsp;&nbsp;Managing User Accounts and Groups (Overview)</a></p>
<p class="toc level1 tocsp"><a href="usersetup-92366.html">5.&nbsp;&nbsp;Managing User Accounts and Groups (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="clientconcept-15236.html">6.&nbsp;&nbsp;Managing Client-Server Support (Overview)</a></p>
<p class="toc level1 tocsp"><a href="clientsetup-1.html">7.&nbsp;&nbsp;Managing Diskless Clients (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbintro-66644.html">8.&nbsp;&nbsp;Introduction to Shutting Down and Booting a System</a></p>
<p class="toc level1 tocsp"><a href="hboverview-25463.html">9.&nbsp;&nbsp;Shutting Down and Booting a System (Overview)</a></p>
<p class="toc level1 tocsp"><a href="hbsyshalt-84412.html">10.&nbsp;&nbsp;Shutting Down a System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="grubtasks-1.html">11.&nbsp;&nbsp;Modifying Solaris Boot Behavior (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbsparcboot-79782.html">12.&nbsp;&nbsp;Booting a Solaris System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbtsboot-1.html">13.&nbsp;&nbsp;Troubleshooting Booting a Solaris System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="archive-123.html">14.&nbsp;&nbsp;Managing the Solaris Boot Archives (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbsysboot-76719.html">15.&nbsp;&nbsp;x86: GRUB Based Booting (Reference)</a></p>
<p class="toc level1 tocsp"><a href="hbrunlevels-25516.html">16.&nbsp;&nbsp;Managing Services (Overview)</a></p>
<p class="toc level2"><a href="dzhgy.html">Introduction to SMF</a></p>
<p class="toc level2"><a href="feosq.html">Changes in Behavior When Using SMF</a></p>
<div class="onpage">
<p class="toc level2"><a href="">SMF Concepts</a></p>
</div>
<p class="toc level2"><a href="dzhjy.html">SMF Administrative and Programming Interfaces</a></p>
<p class="toc level2"><a href="dzhna.html">SMF Components</a></p>
<p class="toc level2"><a href="fddwo.html">SMF and Booting</a></p>
<p class="toc level2"><a href="dzhkf.html">SMF Compatibility</a></p>
<p class="toc level2"><a href="hbrunlevels-13026.html">Run Levels</a></p>
<p class="toc level2"><a href="hbrunlevels-12863.html"><tt>/etc/inittab</tt> File</a></p>
<p class="toc level1 tocsp"><a href="faauf.html">17.&nbsp;&nbsp;Managing Services (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgsconcepts-52619.html">18.&nbsp;&nbsp;Managing Software (Overview)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgsgui-1.html">19.&nbsp;&nbsp;Managing Software With Solaris System Administration Tools (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgscli-1.html">20.&nbsp;&nbsp;Managing Software by Using Package Commands (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpatchtasks-1.html">21.&nbsp;&nbsp;Managing Solaris Patches by Using the <tt>patchadd</tt> Command (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fddwm.html">A.&nbsp;&nbsp;SMF Services</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="dzhid"></a><h3>SMF Concepts</h3>
<p>This section presents terms and their definitions within the SMF framework. These terms
are used throughout the documentation. To grasp SMF concepts, an understanding of these
terms is essential.</p>

<a name="dzhnj"></a><h4>SMF Service</h4>
<p><a name="indexterm-285"></a>The fundamental unit of administration in the SMF framework is the <b>service instance</b>. Each
SMF service has the potential to have multiple versions of it configured. As
well, multiple instances of the same version can run on a single Solaris
system. An <b>instance</b> is a specific configuration of a service. A web server
is a service. A specific web server daemon that is configured to listen
on port 80 is an instance. Each instance of the web server service
could have different configuration requirements. The service has system-wide configuration requirements, but each instance
can override specific requirements, as needed. Multiple instances of a single service are
managed as child objects of the service object.</p><p>Services are not just the representation for standard long-running system services such as
<tt>in.dhcpd</tt> or <tt>nfsd</tt>. Services also represent varied system entities that include ISV applications
such as Oracle software. In addition, a service can include less traditional entities such
as the following:</p>
<ul><li><p>A physical network device</p></li>
<li><p>A configured IP address</p></li>
<li><p>Kernel configuration information</p></li>
<li><p>Milestones that correspond to system init state, such as the multiuser run level</p></li></ul>
<p>Generically, a service is an entity that provides a list of capabilities to
applications and other services, local and remote. A service is dependent on an
implicitly declared list of local services.</p><p>A <b>milestone</b> is a special type of service. Milestone services represent high-level attributes
of the system. For example, the services which constitute run levels S, 2,
and 3 are each represented by milestone services.</p>

<a name="eqbuc"></a><h4>Service Identifiers</h4>
<a name="indexterm-286"></a><a name="indexterm-287"></a><p>Each service instance is named with a Fault Management Resource Identifier or FMRI.
The FMRI includes the service name and the instance name. For example, the
FMRI for the <tt>rlogin</tt> service is <tt>svc:/network/login:rlogin</tt>, where <tt>network/login</tt> identifies the service and
<tt>rlogin</tt> identifies the service instance.</p><p>Equivalent formats for an FMRI are as follows:</p>
<ul><li><p><tt>svc://localhost/system/system-log:default</tt></p></li>
<li><p><tt>svc:/system/system-log:default</tt></p></li>
<li><p><tt>system/system-log:default</tt></p></li></ul>
<p>In addition, some SMF commands can use the following FMRI format: <tt>svc:/system/system-log</tt>.
Some commands infer what instance to use, when there is no ambiguity. See
the SMF command man pages, such as <a href="http://docs.sun.com/doc/819-2240/svcadm-1m?a=view"><tt>svcadm</tt>(1M)</a> or <a href="http://docs.sun.com/doc/819-2239/svcs-1?a=view"><tt>svcs</tt>(1)</a>, for instructions
about which FMRI formats are appropriate.</p><p>The service names usually include a general functional category. The categories include the
following:</p>
<ul><li><p><tt>application</tt></p></li>
<li><p><tt>device</tt></p></li>
<li><p><tt>milestone</tt></p></li>
<li><p><tt>network</tt></p></li>
<li><p><tt>platform</tt></p></li>
<li><p><tt>site</tt></p></li>
<li><p><tt>system</tt></p></li></ul>
<p>Legacy <tt>init.d</tt> scripts are also represented with FMRIs that start with <tt>lrc</tt> instead
of <tt>svc</tt>, for example: <tt>lrc:/etc/rcS_d/S35cacheos_sh</tt>. The legacy services can be monitored using SMF. However,
you cannot administer these services.</p><p>When booting a system for the first time with SMF, services listed
in <tt>/etc/inetd.conf</tt> are automatically converted into SMF services. The FMRIs for these services
are slightly different. The syntax for a converted <tt>inetd</tt> services is:</p><pre>network/<i>&lt;service-name&gt;</i>/<i>&lt;protocol&gt;</i></pre><p>In addition, the syntax for a converted service that uses the RPC
protocol is:</p><pre><tt>network/rpc-</tt><i>&lt;service-name&gt;</i><tt>/rpc_</tt><i>&lt;protocol&gt;</i></pre><p>Where <i>&lt;service-name&gt;</i> is the name defined in <tt>/etc/inetd.conf</tt> and <i>&lt;protocol&gt;</i> is the protocol for
the service. For instance, the FMRI for the <tt>rpc.cmsd</tt> service is <tt>network/rpc-100068_2-5/rpc_udp</tt>.</p>

<a name="eywvn"></a><h4>Service States</h4>
<a name="indexterm-288"></a><p>The <tt>svcs</tt> command displays the state, start time, and FMRI of service instances.
The state of each service is one of the following:</p>
<ul><li><p><tt>degraded</tt> &ndash; The service instance is enabled, but is running at a limited capacity.</p></li>
<li><p><tt>disabled</tt> &ndash; The service instance is not enabled and is not running.</p></li>
<li><p><tt>legacy_run</tt> &ndash; The legacy service is not managed by SMF, but the service can be observed. This state is only used by legacy services.</p></li>
<li><p><tt>maintenance</tt> &ndash; The service instance has encountered an error that must be resolved by the administrator.</p></li>
<li><p><tt>offline</tt> &ndash; The service instance is enabled, but the service is not yet running or available to run.</p></li>
<li><p><tt>online</tt> &ndash; The service instance is enabled and has successfully started.</p></li>
<li><p><tt>uninitialized</tt> &ndash; This state is the initial state for all services before their configuration has been read.</p></li></ul>


<a name="esini"></a><h4>SMF Manifests</h4>
<a name="indexterm-289"></a><p>An SMF <b>manifest</b> is an XML file that contains a complete set of
properties that are associated with a service or a service instance. The files
are stored in <tt>/var/svc/manifest</tt>. Manifests should not be used to modify the properties
of a service. The service configuration repository is the authoritative source of configuration
information. To incorporate information from the manifest into the repository, you must either run
<tt>svccfg import</tt> or allow the service to import the information during a system boot.</p><p>See the <a href="http://docs.sun.com/doc/819-2251/service-bundle-4?a=view"><tt>service_bundle</tt>(4)</a> man page for a complete description of the contents of
the SMF manifests. If you need to change the properties of a
service, see the <a href="http://docs.sun.com/doc/819-2240/svccfg-1m?a=view"><tt>svccfg</tt>(1M)</a> or <a href="http://docs.sun.com/doc/819-2240/inetadm-1m?a=view"><tt>inetadm</tt>(1M)</a> man pages.</p>

<a name="fgoth"></a><h4>SMF Profiles</h4>
<a name="indexterm-290"></a><p>An SMF <b>profile</b> is an XML file that lists a set of service
instances and whether each should be enabled or disabled. Some profiles which are
delivered with the Solaris release include:</p>
<ul><li><p><tt>/var/svc/profile/generic_open.xml</tt> &ndash; This profile enables the standard services that have been started by default in earlier Solaris releases.</p></li>
<li><p><tt>/var/svc/profile/generic_limited_net.xml</tt> &ndash; This profile disables many of the internet services that have be started by default in earlier Solaris releases. The <tt>network/ssh</tt> service is enabled to provide network connectivity.</p></li>
<li><p><tt>/var/svc/profile/ns_*.xml</tt> &ndash; These profiles enable services associated with the name service that is configured to run on the system.</p></li>
<li><p><tt>/var/svc/profile/platform_*.xml</tt> &ndash; These profiles enable services associated with particular hardware platforms.</p></li></ul>
<p>During the first boot after a new installation or an upgrade to
the Solaris 10 release or any of the subsequent Solaris Express releases, some Solaris
profiles are automatically applied. To be specific, the <tt>/var/svc/profile/generic.xml</tt> profile is applied.
This file is usually symbolically linked to <tt>generic_open.xml</tt> or <tt>generic_limited_net.xml</tt>. Also, if a
profile called <tt>site.xml</tt> is in <tt>/var/svc/profile</tt> during the first boot or is
added between boots, the contents of this profile are applied. By using the
<tt>site.xml</tt> profile, the initial set of enabled services may be customized by the
administrator.</p><p>For more information about using profiles, see <a href="eqbrs.html#fgour">How to Apply an SMF Profile</a>.</p>

<a name="dzhsi"></a><h4>Service Configuration Repository</h4>
<p><a name="indexterm-291"></a><a name="indexterm-292"></a><a name="indexterm-293"></a>The <b>service configuration repository</b> stores persistent configuration information as well as SMF runtime data for
services. The repository is distributed among local memory and local files. SMF is
designed so that eventually, service data can be represented in the network directory service.
The network directory service is not yet available. The data in the service
configuration repository allows for the sharing of configuration information and administrative simplicity across
many Solaris instances. The service configuration repository can only be manipulated or queried
using SMF interfaces. For more information about manipulating and accessing the repository, see
the <a href="http://docs.sun.com/doc/819-2240/svccfg-1m?a=view"><tt>svccfg</tt>(1M)</a> and <a href="http://docs.sun.com/doc/819-2239/svcprop-1?a=view"><tt>svcprop</tt>(1)</a> man pages. The service configuration repository daemon is covered
in the <a href="http://docs.sun.com/doc/819-2240/svc.configd-1m?a=view"><tt>svc.configd</tt>(1M)</a> man page. The service configuration library is documented in the
<a href="http://docs.sun.com/doc/819-2242/libscf-3lib?a=view"><tt>libscf</tt>(3LIB)</a> man page.</p>

<a name="frjjz"></a><h4>SMF Repository Backups</h4>
<p>SMF automatically takes the following backups of the repository:</p>
<ul><li><p>The boot backup is taken immediately before the first change to the repository is made during each system startup.</p></li>
<li><p>The <tt>manifest_import</tt> backup occurs after <tt>svc:/system/manifest-import:default</tt> completes, if it imported any new manifests or ran any upgrade scripts.</p></li></ul>
<p>Four backups of each type are maintained by the system. The system
deletes the oldest backup, when necessary. The backups are stored as <tt>/etc/svc/repository</tt>-<i>type</i>-<i>YYYYMMDD_HHMMSWS</i>, where <i>YYYYMMDD</i>
(year, month, day) and <i>HHMMSS</i> (hour, minute, second), are the date and
time when the backup was taken. Note that the hour format is based
on a 24&ndash;hour clock.</p><p>You can restore the repository from these backups, if an error occurs. To
do so, use the <tt>/lib/svc/bin/restore_repository</tt> command. For more information, see <a href="ecdps.html#ecduh">How to Repair a Corrupt Repository</a>.</p>

<a name="eqbts"></a><h4>SMF Snapshots</h4>
<a name="indexterm-294"></a><p>The data in the service configuration repository includes <b>snapshots</b>, as well as
a configuration that can be edited. Data about each service instance is stored
in the snapshots. The standard snapshots are as follows:</p>
<ul><li><p><tt>initial</tt> &ndash; Taken on the first import of the manifest</p></li>
<li><p><tt>running</tt> &ndash; Used when the service methods are executed</p></li>
<li><p><tt>start</tt> &ndash; Taken at the last successful start</p></li></ul>
<p>The SMF service always executes with the <tt>running</tt> snapshot. This snapshot is automatically
created if it does not exist.</p><p>The <tt>svcadm</tt> <tt>refresh</tt> command, sometimes followed by the <tt>svcadm</tt> <tt>restart</tt> command, makes a
snapshot active. The <tt>svccfg</tt> command is used to view or revert to instance
configurations in a previous snapshot. See <a href="eqbrs.html#ecdpn">How to Revert to Another SMF Snapshot</a> for more information.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="feosq.html">Previous</a>
             </td>
             <td align="right">
                 <a href="dzhjy.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

