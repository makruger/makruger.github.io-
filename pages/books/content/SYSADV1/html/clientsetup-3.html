<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Preparing for Managing Diskless Clients - System Administration Guide: Basic Administration</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-12-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Basic Administration</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="clientsetup-2.html">Previous</a>
             </td>
             <td align="right">
                 <a href="clientsetup-13.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="vol1preface-11.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="saroadmap-1.html">1.&nbsp;&nbsp;Solaris Management Tools (Road Map)</a></p>
<p class="toc level1 tocsp"><a href="smcover-1.html">2.&nbsp;&nbsp;Working With the Solaris Management Console (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ewpor.html">3.&nbsp;&nbsp;Working With the Sun Java Web Console (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="userconcept-97366.html">4.&nbsp;&nbsp;Managing User Accounts and Groups (Overview)</a></p>
<p class="toc level1 tocsp"><a href="usersetup-92366.html">5.&nbsp;&nbsp;Managing User Accounts and Groups (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="clientconcept-15236.html">6.&nbsp;&nbsp;Managing Client-Server Support (Overview)</a></p>
<p class="toc level1 tocsp"><a href="clientsetup-1.html">7.&nbsp;&nbsp;Managing Diskless Clients (Tasks)</a></p>
<p class="toc level2"><a href="clientsetup-2.html">Managing Diskless Clients (Task Map)</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Preparing for Managing Diskless Clients</a></p>
</div>
<p class="toc level2"><a href="clientsetup-13.html">Patching Diskless Client OS Services</a></p>
<p class="toc level2"><a href="gcezq.html">Troubleshooting Diskless Client Problems</a></p>
<p class="toc level1 tocsp"><a href="hbintro-66644.html">8.&nbsp;&nbsp;Introduction to Shutting Down and Booting a System</a></p>
<p class="toc level1 tocsp"><a href="hboverview-25463.html">9.&nbsp;&nbsp;Shutting Down and Booting a System (Overview)</a></p>
<p class="toc level1 tocsp"><a href="hbsyshalt-84412.html">10.&nbsp;&nbsp;Shutting Down a System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="grubtasks-1.html">11.&nbsp;&nbsp;Modifying Solaris Boot Behavior (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbsparcboot-79782.html">12.&nbsp;&nbsp;Booting a Solaris System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbtsboot-1.html">13.&nbsp;&nbsp;Troubleshooting Booting a Solaris System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="archive-123.html">14.&nbsp;&nbsp;Managing the Solaris Boot Archives (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbsysboot-76719.html">15.&nbsp;&nbsp;x86: GRUB Based Booting (Reference)</a></p>
<p class="toc level1 tocsp"><a href="hbrunlevels-25516.html">16.&nbsp;&nbsp;Managing Services (Overview)</a></p>
<p class="toc level1 tocsp"><a href="faauf.html">17.&nbsp;&nbsp;Managing Services (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgsconcepts-52619.html">18.&nbsp;&nbsp;Managing Software (Overview)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgsgui-1.html">19.&nbsp;&nbsp;Managing Software With Solaris System Administration Tools (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgscli-1.html">20.&nbsp;&nbsp;Managing Software by Using Package Commands (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpatchtasks-1.html">21.&nbsp;&nbsp;Managing Solaris Patches by Using the <tt>patchadd</tt> Command (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fddwm.html">A.&nbsp;&nbsp;SMF Services</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="clientsetup-3"></a><h3>Preparing for Managing Diskless Clients</h3>
<p>These sections describe the preparations that are necessary for managing diskless clients.</p><p>Keep the following key points in mind when managing diskless clients:</p>
<ul><li><p>The Solaris installation program doesn't prompt you to set up diskless client support. You must manually create an <tt>/export</tt> partition to support diskless clients. You create the <tt>/export</tt> partition during or after the installation process.</p></li>
<li><p>The <tt>/export</tt> partition must contain a minimum of 5 Gbytes, depending upon the number of clients supported. For specific information, see .</p></li>
<li><p>The name service identified in the <tt>smosservice</tt> or <tt>smdiskless</tt> commands must match the primary name service identified in the <tt>/etc/nsswitch.conf</tt> file. If you don't specify a name service in the <tt>smdiskless</tt> or <tt>smosservice</tt> commands, the default name service is <tt>files</tt>.</p><p>Use the <tt>-D</tt> option to the <tt>smosservice</tt> and <tt>smdiskless</tt> commands to specify a name server. For more information, see the <a href="http://docs.sun.com/doc/819-2240/smosservice-1m?a=view"><tt>smosservice</tt>(1M)</a> and <a href="http://docs.sun.com/doc/819-2240/smdiskless-1m?a=view"><tt>smdiskless</tt>(1M)</a> man pages.</p><p><b>Starting with the Solaris 10 8/07 release</b>, the <tt>set_nfs4_domain</tt> script that was delivered in the Solaris 10 OS is no longer used to set the NFSv4 domain. To set the NFSv4 domain, add the <tt>nfs4_domain</tt> keyword to the diskless client's <tt>sysidcfg</tt> file, for example, <tt>server:/export/root/client/etc/sysidcfg</tt>.</p><p>If the <tt>nfs4_domain</tt> keyword exists in the client system's <tt>sysidcfg</tt> file, the first boot of a diskless client sets the domain accordingly. Also, the OS server should be up and running, and the diskless client's NFSv4 domain setting must match the setting in the OS server's <tt>/var/run/nfs4_domain</tt> file.</p><p>For more information, see <a href="http://docs.sun.com/doc/819-2394/preconsysid-55534?a=view">Preconfiguring With the sysidcfg File in <i>Solaris Express Installation Guide: Network-Based Installations</i></a>.</p></li>
<li><p>The OS server and the diskless client must be on the same subnet.</p></li>
<li><p>You cannot provide client services on a multiterabyte UFS file system, because OS and diskless client services <b>cannot</b> be added to a UFS file system that resides on an EFI-labeled disk.</p>
<hr><p><b>Note - </b>Attempts to add OS and diskless client services to a UFS file system that resides on an EFI-labeled disk result in an erroneous insufficient disk space message similar to the following:</p><pre>The partition /export does not have enough free space.
1897816 KB (1853.34 MB) additional free space required.
Insufficient space available on
/dev/dsk/c0t5d0s0 /export</pre>
<hr>
</li></ul>
<p>After you determine the platform, media path, and cluster for each diskless client,
you are ready to add OS services. </p><p>The following directories are created and populated for each OS service that you
add:</p>
<ul><li><p><tt>/export/Solaris_</tt><i>version</i><tt>/Solaris_</tt><i>version</i><tt>-</tt><i>instruction-set</i><tt>.all</tt> (symbolic link to <tt>/export/exec/Solaris_</tt><i>version</i><tt>/Solaris_</tt><i>version</i><tt>-</tt><i>instruction-set</i><tt>.all</tt>)</p></li>
<li><p><tt>/export/Solaris_</tt><i>version</i><tt></tt></p></li>
<li><p><tt>/export/Solaris_</tt><i>version</i><tt>/var</tt></p></li>
<li><p><tt>/export/Solaris_</tt><i>version</i><tt>/opt</tt></p></li>
<li><p><tt>/export/share</tt></p></li>
<li><p><tt>/export/root/templates/Solaris_</tt><i>version</i><tt></tt></p></li>
<li><p><tt>/export/root/clone</tt></p></li>
<li><p><tt>/export/root/clone/Solaris_</tt><i>version</i><tt></tt></p></li>
<li><p><tt>/export/root/clone/Solaris_</tt><i>version</i><tt>/</tt><i>machine-class</i><tt></tt></p></li></ul>
<p>The following default directories are created and populated on the OS server for
each diskless client that you add:</p>
<ul><li><p><tt>/export/root/</tt><i>diskless-client</i><tt></tt></p></li>
<li><p><tt>/export/swap/</tt><i>diskless-client</i><tt></tt></p></li>
<li><p><tt>/tftpboot/</tt><i>diskless-client-ipaddress-in-hex</i><tt></tt><tt>/export/dump/</tt><i>diskless-client</i><tt></tt> (if you specify the <tt>-x</tt> <i>dump</i> option)</p></li></ul>

<hr><p><b>Note - </b>You can modify the default locations of the root (<tt>/</tt>), <tt>/swap</tt>, and
<tt>/dump</tt> directories by using the <tt>-x</tt> option to the <tt>smosservice</tt> and <tt>smdiskless</tt> commands. However,
do not create these directories under the <tt>/export</tt> file system.</p>
<hr>


<a name="fwaol"></a><h4>x86: How to Prepare for Adding Diskless Clients in a GRUB Based Boot Environment</h4><p>Use this procedure to prepare for adding a diskless client. This procedure includes
general information for x86 based systems.</p><p>When you use the <tt>smosservice add</tt> command to add OS services, you must specify
the platform, media path, and cluster (or software group) of each diskless client
platform that you want to support.</p><h6>Before You Begin</h6><p>Ensure that the system that is intended to be the OS service
is running a supported release. Also, verify that the OS server release and
diskless client release combination is supported. For more information, see <a href="clientconcept-22.html#clientconcept-28">OS Server and Diskless Client Support Information</a>.</p><ol>
<li><b>Identify the diskless client platform by using this format:</b><p><i>instruction-set</i>.<i>machine-class</i>.<i>Solaris-version</i></p><p>For example:</p><p><tt>i386.i86pc.Solaris_11</tt></p><p>The following are the possible platform options:</p><table><col width="27%"><col width="28%"><col width="43%"><tr><th align="left" valign="top" scope="column"><p>Instruction Set</p></th>
<th align="left" valign="top" scope="column"><p>Machine Class</p></th>
<th align="left" valign="top" scope="column"><p>Solaris Version</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>sparc</p></td>
<td align="left" valign="top" scope="row"><p>sun4v</p><p>sun4u, sun4m, sun4d,
and sun4c</p></td>
<td align="left" valign="top" scope="row"><p>Starting with the Solaris 10 1/06 OS</p><p>Solaris Express, Solaris 10, Solaris
9, and Solaris 8</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>i386</p></td>
<td align="left" valign="top" scope="row"><p>i86pc</p></td>
<td align="left" valign="top" scope="row"><p>Solaris Express, Solaris 10, Solaris 9, and Solaris 8</p></td>
</tr>
</table>
<hr><p><b>Note - </b>The sun-4c architecture is not supported in the Solaris 8, Solaris 9, Solaris
10, or Solaris Express releases. The sun-4d architecture is not supported in the
Solaris 9, Solaris 10, or Solaris Express releases. The sun-4m architecture is not supported
in the Solaris Express Developer Editionor the Solaris 10 release.</p>
<hr>
</li>
<li><a name="fwaex"></a><b>Identify the media path.</b><p>The media path is the full path to the disk image that contains
the OS that you want to install for the diskless client.</p><p>The Solaris OS is delivered on multiple CDs. However, you cannot use the
<tt>smosservice</tt> command to load OS services from a multiple CD distribution. You must
run the scripts that are found on the Solaris software CDs (and optional
Language CD) to do the following:</p></li>
<li><b>Create an install image on a server. For information on setting up an
install server, refer to <a href="http://docs.sun.com/doc/819-2394"><i>Solaris Express Installation Guide: Network-Based Installations</i></a>.</b></li>
<li><b>Load the required OS services from the CD image.</b><p>Use one of the following scripts:</p>
<ul><li><p>CD 1 &ndash; <tt>/media/Solaris_11/Tools/setup_install_server</tt></p></li>
<li><p>Additional Solaris Software CDs &ndash; <tt>/media/Solaris_11/Tools/add_to_install_server</tt></p></li>
<li><p>Language CD &ndash; <tt>/media/Solaris_11/Tools/add_to_install_server</tt></p></li></ul>
<p>For example, if you are using the <tt>setup_install_server</tt> script from the Solaris Express
Software 1 CD on a locally connected CD-ROM device, the syntax looks similar
to the following:</p><pre># <tt><b>mkdir /export/install/sol_11_x86</b></tt>
# <tt><b>cd /cd_mount_point/Solaris_11/Tools</b></tt>
# <tt><b>./setup_install_server /export/install/sol_11_x86</b></tt></pre></li>
<li><b>Add the <tt>BootFile</tt> and <tt>BootSrvA</tt> DHCP options to your DHCP server configuration to
enable a PXE boot.</b><p>For example:</p><pre>Boot server IP (BootSrvA) : <i>svr-addr</i>
(BootFile) : 01<i>client-macro</i></pre><p>where <i>svr-addr</i> is the IP address of the OS server and <i>client-macro</i> is
named by the client's Ethernet type (01) and the mac address of the
client. This number is also the name of the file that is used
in the <tt>/tftpboot</tt> directory on the installation server.</p>
<hr><p><b>Note - </b>The notation for the <i>client-macro</i> consists of uppercase letters. This notation should not
contain any colons.</p>
<hr>
<p>You can add these options from the command-line, or by using DHCP
Manager. See <a href="#gcbpt">Example&nbsp;7-4</a> for more information.</p><p>For more information, see <a href="fvzok.html#fvzpk">x86: How to Perform a GRUB Based Boot From the Network</a>, <a href="http://docs.sun.com/doc/819-2394/dhcp-admin-38?a=view">Preconfiguring System Configuration Information With the DHCP Service (Tasks) in <i>Solaris Express Installation Guide: Network-Based Installations</i></a>, and <a href="http://docs.sun.com/doc/819-3000/dhcptm-1?a=view">Part&nbsp;II, DHCP, in <i>System Administration Guide: IP Services</i></a>.</p></li>
<li><b>After the Solaris CD image is installed on the disk, note the disk
media path. For example:</b><pre>/net/export/install/sol_11_x86_</pre><p>This is the disk media path that needs to be specified when
you use the <tt>smosservice</tt> command.</p></li>
<li><a name="fwagu"></a><b>Identify the <tt>SUNWCXall</tt> cluster when you add OS services.</b><p>You must use the same cluster for diskless clients that run the same
OS on the same system. </p>
<hr><p><b>Note - </b>Always specify <tt>SUNWCXall</tt> as the cluster.</p>
<hr>
</li></ol>

<a name="clientsetup-7"></a><h4>How to Prepare for Adding Diskless Clients in the Solaris 10 OS</h4><p>When you use the <tt>smosservice add</tt> command to add OS services, you must specify
the platform, media path, and cluster (or software group) of each diskless client
platform that you want to support.</p><h6>Before You Begin</h6><p>Ensure that the system that is intended to be the OS service
is running a supported release. Also verify that the combination of OS server
release and diskless client release is supported. For more information, see <a href="clientconcept-22.html#clientconcept-28">OS Server and Diskless Client Support Information</a>.</p><ol>
<li><b>Identify the diskless client platform by using this format:</b><p><i>instruction-set</i>.<i>machine-class</i>.Solaris-<i>version</i></p><p>For example:</p><p><tt>sparc.sun4u.Solaris_10</tt></p><p>The following are the possible platform options:</p><table><col width="27%"><col width="28%"><col width="43%"><tr><th align="left" valign="top" scope="column"><p><i>instruction-set</i></p></th>
<th align="left" valign="top" scope="column"><p><i>machine-class</i></p></th>
<th align="left" valign="top" scope="column"><p>Solaris_<i>version</i></p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>sparc</p></td>
<td align="left" valign="top" scope="row"><p>sun4v</p><p>sun4c, sun4d, sun4m, sun4u,</p></td>
<td align="left" valign="top" scope="row"><p>Starting with the
Solaris 10 1/06 OS</p><p> Solaris_10, Solaris_9, and Solaris_8</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>i386</p></td>
<td align="left" valign="top" scope="row"><p>i86pc</p></td>
<td align="left" valign="top" scope="row"><p>Solaris_10, Solaris_9, and Solaris_8</p></td>
</tr>
</table>
<hr><p><b>Note - </b>The sun-4c architecture is not supported in the Solaris 8, Solaris 9, or
Solaris 10 releases. The sun-4d architecture is not supported in the Solaris 9
or 10 releases. The sun-4m architecture is not supported in the Solaris 10
release.</p>
<hr>
</li>
<li><a name="clientsetup-step-22"></a><b>Identify the media path.</b><p>The media path is the full path to the disk image that contains
the OS that you want to install for the diskless client.</p><p>The Solaris OS is delivered on multiple CDs. However, you cannot use the
<tt>smosservice</tt> command to load OS services from a multiple CD distribution. You must
run the scripts that are found on the Solaris software CDs (and optional
Language CD) to do the following:</p></li>
<li><b>Create an install image on a server. For information on setting up an
install server, refer to <a href="http://docs.sun.com/doc/819-2394"><i>Solaris Express Installation Guide: Network-Based Installations</i></a>.</b></li>
<li><b>Load the required OS services from the CD image.</b><p>Use one of the following scripts:</p>
<ul><li><p>CD 1 &ndash; <tt>/media/Solaris_11/Tools/setup_install_server</tt></p></li>
<li><p>Additional Solaris Software CDs &ndash; <tt>/media/Solaris_11/Tools/add_to_install_server</tt></p></li>
<li><p>Language CD &ndash; <tt>/media/Solaris_11/Tools/add_to_install_server</tt></p></li></ul>
<p>For example, if you are using the <tt>setup_install_server</tt> script from the Solaris Express
Community Edition  Software 1 CD on a locally connected CD-ROM device, the
syntax looks similar to the following:</p><pre># <tt><b>mkdir /export/install/sparc_11</b></tt>
# <tt><b>cd /cd_mount_point/Solaris_11/Tools</b></tt>
# <tt><b>./setup_install_server /export/install/sparc_11</b></tt></pre></li>
<li><b>After the Solaris CD image is installed on the disk, specify the disk
media path. For example:</b><pre>/export/install/sparc_11</pre></li>
<li><a name="clientsetup-step-23"></a><b>Identify the <tt>SUNWCXall</tt> cluster when you add OS services.</b><p>You must use the same cluster for diskless clients that run the same
OS on the same system. </p><p>For example, consider the following Solaris 9 diskless clients:</p>
<ul><li><p><tt>sparc.sun4m.Solaris_9</tt></p></li>
<li><p><tt>sparc.sun4u.Solaris_9</tt></p></li></ul>
<p>To set up these diskless clients, you would need to specify the
<tt>SUNWCXall</tt> cluster for each diskless client because the <tt>sun4u</tt> and <tt>sun4m</tt> systems
require the <tt>SUNWCXall</tt> cluster. In addition, diskless clients that run the same operating
release (in this example, Solaris_9) on the same system must use the same
cluster.</p>
<hr><p><b>Note - </b>If you are using a <tt>sun4u</tt> system, or if you are using a
system with an accelerated 8-bit color memory frame buffer (<tt>cgsix</tt>), you <b>must</b>
specify <tt>SUNWCXall</tt> as the cluster. </p>
<hr>
</li></ol>

<a name="clientsetup-20"></a><h4>How to Add OS Services for Diskless Client Support</h4><p>Use this procedure to add OS services for a diskless client on
the server.</p>
<hr><p><b>Note - </b>When adding OS services with the <tt>smosservice add</tt> command, root (<tt>/</tt>) and <tt>/usr</tt> packages
with the <tt>ARCH=all</tt> type are not installed. These packages are skipped. No warning or
error messages are displayed. After you add the OS services to the OS
server, you must install the missing packages manually. For instructions, see <a href="gcezq.html#archall-1">How to Locate and Install Missing <tt>ARCH=all</tt> Packages</a>.</p>
<hr>
<ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="clientsetup-step-7"></a><b>Verify that the Solaris Management Console server is running and that the diskless
client tools are available on the system.</b><pre># <tt><b>/usr/sadm/bin/smosservice list -H </tt><i>host-name</i><tt>:898 --</b></tt></pre></li>
<li><a name="diskless-step-1"></a><b><a name="indexterm-88"></a><a name="indexterm-89"></a>Add the OS services.</b><pre># <tt><b>/usr/sadm/bin/smosservice add -H</b></tt> <i>host-name</i><tt><b>:898</b></tt> <tt><b>-- -o</b></tt> <i>host-name</i> 
<tt><b>-x mediapath=</b></tt><i>path</i> <tt><b>-x platform=</b></tt><i>instruction-set</i>.<i>machine-class</i>.Solaris_<i>version</i> 
<tt><b>-x cluster=</b></tt><i>cluster-name</i> <tt><b>-x locale=</b></tt><i>locale-name</i></pre><dl><dt><tt>add</tt></dt>
<dd><p>Adds the specified OS service.</p></dd>
<dt><tt>-H</tt> <i>host-name</i>:898</dt>
<dd><p>Specifies the host name and port to which you want to connect. If you do not specify a port, the system connects to the default port, 898.</p>
<hr><p><b>Note - </b>The <tt>-H</tt> option is not a required option when using the <tt>smossservice</tt> command to add OS services.</p>
<hr>
</dd>
<dt><tt>--</tt></dt>
<dd><p>Identifies that the subcommand arguments start after this point.</p></dd>
<dt><tt>-x</tt> <i>mediapath=path</i></dt>
<dd><p>Specifies the full path to the Solaris image.</p></dd>
<dt><tt>-x</tt> <i>platform=instruction-set.machine-class.</i>.Solaris_<i>version</i></dt>
<dd><p>Specifies the instruction architecture, machine class, and the Solaris version to be added. </p></dd>
<dt><tt>-x</tt> <i>cluster=cluster-name</i></dt>
<dd><p>Specifies the Solaris cluster to install.</p></dd>
<dt><tt>-x</tt> <i>locale=locale-name</i></dt>
<dd><p>Specifies the locale to install.</p></dd>
</dl>

<hr><p><b>Note - </b>The installation process can take about 45 minutes, depending on the server speed
and the OS service configuration you choose.</p>
<hr>
<p>For more information, see the <a href="http://docs.sun.com/doc/819-2240/smosservice-1m?a=view"><tt>smosservice</tt>(1M)</a> man page.</p></li>
<li><a name="clientsetup-step-10"></a><b>(Optional) Continue to add the other OS services.</b></li>
<li><a name="diskless-step-2"></a><b>When you are finished adding OS services, verify that the OS services were
installed. </b><pre># <tt><b>/usr/sadm/bin/smosservice list -H </tt><i>host-name</i><tt>:898 --</b></tt></pre></li></ol><h6>Example&nbsp;7-1 SPARC: Adding an OS Service for Diskless Client Support</h6><p>This example shows how to add Solaris 10 SPARC based OS services
on the server <tt>jupiter</tt>. The server <tt>jupiter</tt> is running the Solaris 10 release. The
CD image of the Solaris 10 SPARC based OS is located on the
installation server, <tt>myway</tt>, in <tt>/export/s10/combined.s10s_u2wos/61</tt>.</p><pre># <tt><b>/usr/sadm/bin/smosservice add -H jupiter:898 -- -o jupiter -x mediapath=/net/myway/export/s10/combined.s10s_u2wos/61 -x platform=sparc.sun4u.Solaris_10 -x cluster=SUNWCXall -x locale=en_US</b></tt>

# <tt><b>/usr/sadm/bin/smosservice list - H jupiter:898</b></tt>
Authenticating as user: root

Type /? for help, pressing enter accepts the default denoted by [ ]
Please enter a string value for: password :: <i>xxxxxx</i>
Loading Tool: com.sun.admin.osservermgr.cli.OsServerMgrCli
from jupiter:898
Login to jupiter as user root was successful.
Download of com.sun.admin.osservermgr.cli.OsServerMgrCli from jupiter:898 
was successful.</pre><a name="gcfan"></a><h6>Example&nbsp;7-2 x86: Adding an OS Service for Diskless Client Support</h6><p>This example shows how to add Solaris 10 x86 based OS services
on the server <tt>orbit</tt>. The server <tt>orbit</tt> is running the Solaris 10 release. The
CD image of the Solaris 10 x86 based OS is located on the
installation server, <tt>seriously</tt>, in <tt>/export/s10/combined.s10x_u2wos/03</tt>.</p><pre># <tt><b>/usr/sadm/bin/smosservice add -H orbit:898 -- -o orbit -x mediapath=/net/seriously/export/s10u2/combined.s10x_u2wos/03 -x platform=i386.i86pc.Solaris_10 -x cluster=SUNWCXall -x locale=en_US</b></tt>

# <tt><b>/usr/sadm/bin/smosservice list - H orbit:898</b></tt>
Type /? for help, pressing &lt;enter&gt; accepts the default denoted by [ ]
Please enter a string value for: password ::
Starting Solaris Management Console server version 2.1.0.
endpoint created: :898
Solaris Management Console server is ready.
Loading Tool: com.sun.admin.osservermgr.cli.OsServerMgrCli from orbit:898
Login to orbit as user root was successful.
Download of com.sun.admin.osservermgr.cli.OsServerMgrCli from orbit:898 was successful.
Client           Root Area
                Swap Area
                Dump Area
--------------------------------------------------------------------------------
.
.
.
#</pre><h6>Next Steps</h6><p>Locate and install any <tt>ARCH=all</tt> packages that were missed when you ran the
<tt>smosservice add</tt> command to add the OS services to the OS server. For more
information, see <a href="gcezq.html#archall-1">How to Locate and Install Missing <tt>ARCH=all</tt> Packages</a>.</p>

<a name="clientsetup-4"></a><h4>x86: How to Add a Diskless Client in the GRUB Based Boot Environment</h4><p>Starting with the Solaris 10 1/06 release, use this procedure to add a
diskless client after you have added OS services.</p><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="fxjjl"></a><b>Add the diskless client.</b><pre># <tt><b>/usr/sadm/bin/smdiskless add -- -i</b></tt> <i>ip-address</i> <tt><b>-e</b></tt> <i>ethernet-address</i> 
<tt><b>-n</b></tt> <i>client-name</i> <tt><b>-x os=</b></tt><i>instruction-set.machine-class</i>.Solaris_<i>version</i> 
<tt><b>-x root=/export/root/</b></tt><i>client-name</i> <tt><b>-x swap=/export/swap/</b></tt><i>client-name</i> 
<tt><b>-x swapsize=</b></tt><i>size</i> <tt><b>-x tz=</b></tt><i>time-zone</i> <tt><b>-x locale=</b></tt><i>locale-name</i></pre><dl><dt><tt>add</tt></dt>
<dd><p>Adds the specified diskless client.</p></dd>
<dt><tt>--</tt></dt>
<dd><p>Identifies that the subcommand arguments start after this point.</p></dd>
<dt><tt>-i</tt> <i>ip-address</i></dt>
<dd><p>Identifies the IP address of the diskless client.</p></dd>
<dt><tt>-e</tt> <i>ethernet-address</i></dt>
<dd><p>Identifies the Ethernet address of the diskless client.</p></dd>
<dt><tt>-n</tt> <i>client-name</i></dt>
<dd><p>Specifies the name of the diskless client.</p></dd>
<dt><tt>-x os=</tt><i>instruction-set.machine-class</i>.Solaris_<i>version</i></dt>
<dd><p>Specifies the instruction architecture, machine class, OS, and the Solaris version for the diskless client.</p></dd>
<dt><tt>-x root=</tt><tt>root=/export/root/</tt><i>client-name</i></dt>
<dd><p>Identifies the root (<tt>/</tt>) directory for the diskless client.</p></dd>
<dt><tt>-x swap=</tt><tt>root=/export/root/</tt><i>client-name</i></dt>
<dd><p>Identifies the swap file for the diskless client.</p></dd>
<dt><tt>-x swapsize=</tt><i>size</i></dt>
<dd><p>Specifies the size of the swap file in Mbytes. The default is 24 Mbytes.</p></dd>
<dt><tt>-x tz=</tt><i>time-zone</i></dt>
<dd><p>Specifies the time-zone for the diskless client.</p></dd>
<dt><tt>-x locale=</tt><i>locale-name</i></dt>
<dd><p>Specifies the locale to install for the diskless client.</p></dd>
</dl>
<p>For more information, see the <a href="http://docs.sun.com/doc/819-2240/smdiskless-1m?a=view"><tt>smdiskless</tt>(1M)</a> man page.</p></li>
<li><b>If not already created, add the <tt>BootSrva</tt> and <tt>BootFile</tt> DHCP options to
your DHCP server configuration to enable a PXE boot.</b><p>For example:</p><pre>Boot server IP (BootSrvA) : <i>svr-addr</i> 
Boot file (BootFile) : 01<i>client-macro</i></pre><p>where <i>svr-addr</i> is the IP address of the server and <i>client-macro</i> is named
by the client's Ethernet type (01) and the mac address of the client.
This number is also the name of the file that is used in
the <tt>/tftpboot</tt> directory on the installation server.</p>
<hr><p><b>Note - </b>The <i>client-macro</i> notation consists of uppercase letters. The notation should not contain any
colons.</p>
<hr>
<p>The following files and directories are created in the <tt>/tftpboot</tt> directory:</p><pre>drwxr-xr-x   6 root sys     512 Dec 28 14:53 <i>client-host-name</i>
lrwxrwxrwx   1 root root     31 Dec 28 14:53 menu.lst.01<i>ethernet-address</i>
                        -&gt; /tftpboot/<i>client-host-name</i>/grub/menu.lst
-rw-r--r--   1 root root 118672 Dec 28 14:53 01<i>ethernet-address</i></pre></li>
<li><b>If the console is on a serial port, edit the <tt>/tftpboot/menu.lst.01</tt><i>ethernet-address</i> file.
Uncomment the line that specifies the <tt>tty</tt> setting.</b><p>To change the default <tt>menu.lst</tt> file that is created on the client, edit the
<tt>echo</tt> lines in the <tt>/usr/sadm/lib/wbem/config_tftp</tt> file.</p><p>For more information, see <a href="fvzok.html">Booting an x86 Based System from the Network</a>.</p></li>
<li><a name="gbwuj"></a><b>Verify that the diskless clients were installed. </b><pre># <tt><b>/usr/sadm/bin/smdiskless list -H </tt><i>host-name</i><tt>:898 --</b></tt></pre></li>
<li><a name="fxjdz"></a><b>(Optional) Continue to use the <tt>smdiskless add</tt> command to add each diskless client.</b></li></ol><a name="fxjjt"></a><h6>Example&nbsp;7-3 x86: Adding Diskless Client Support to an x86 Based System in the GRUB Boot Environment</h6><p>This example shows how to add a Solaris 10 x86 based diskless
client, <tt>mikey1</tt>.</p><pre>rainy-01# <tt><b>/usr/sadm/bin/smdiskless add -H sdts-01-qfe0 -- -o sdts-01-qfe0 -n mikey1 -i 192.168.20.22 -e 00:E0:88:55:33:BC -x os=i386.i86pc.Solaris_10 -x root=/export/root/mikey1 -x swap=/export/swap/mikey1</b></tt>
Loading Tool: com.sun.admin.osservermgr.cli.OsServerMgrCli
from  sdts-01-qfe0
Login to rainy-01-qfe0 as user root was successful.
Download of com.sun.admin.osservermgr.cli.OsServerMgrCli from
rainy-01-qfe0 was successful.

# <tt><b>/usr/sadm/bin/smdiskless list -H mikey1:898 --</b></tt>
Loading Tool: com.sun.admin.osservermgr.cli.OsServerMgrCli from mikey1:898
Login to mikey1 as user root was successful.
Download of com.sun.admin.osservermgr.cli.OsServerMgrCli from mikey1:898 was 
successful.
Platform
--------------------------------------------------------------------------------
i386.i86pc.Solaris_10                                                           
sparc.sun4us.Solaris_10                                                         
sparc.sun4u.Solaris_10                                                          
i386.i86pc.Solaris_9                                                            </pre><a name="gcbpt"></a><h6>Example&nbsp;7-4 x86: Adding the <tt>BootSrvA</tt> and <tt>BootFile</tt> DHCP Options to the DHCP Server Configuration</h6><p>This example shows how to add the <tt>BootSrva</tt> and <tt>BootFile</tt> DHCP options
that are necessary for enabling a PXE boot.</p><pre>rainy-01# <tt><b>pntadm -A mikey1 -m 0100E0885533BC -f 'MANUAL+PERMANENT' \ -i 0100E0885533BC 192.168.0.101</b></tt></pre><pre>rainy-01# <tt><b>dhtadm -A -m 0100E0885533BC -d \ ":BootSrvA=192.168.0.1:BootFile=0100E0885533BC:"</b></tt></pre><p>In the preceding examples, the server address is the IP address of
the server, and the client macro is named by the client's Ethernet type
(01) and its mac address. This number is also the name of the
file that is used in the <tt>/tftpboot</tt> directory on the installation server. Note that
the notation for the client macro consists of uppercase letters and should not
contain any colons.</p>

<a name="fxcpp"></a><h4>How to Add a Diskless Client in the Solaris 10 OS</h4><p>Use this procedure to add a diskless client after you have added
OS services. Unless otherwise noted, this procedure includes general information for both SPARC based
and x86 based systems.</p><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="fxchq"></a><b>Add the diskless client.</b><pre># <tt><b>/usr/sadm/bin/smdiskless add -- -i</b></tt> <i>ip-address</i> <tt><b>-e</b></tt> <i>ethernet-address</i> 
<tt><b>-n</b></tt> <i>client-name</i> <tt><b>-x os=</b></tt><i>instruction-set.machine-class</i>.Solaris_<i>version</i> 
<tt><b>-x root=/export/root/</b></tt><i>client-name</i> <tt><b>-x swap=/export/swap/</b></tt><i>client-name</i> 
<tt><b>-x swapsize=</b></tt><i>size</i> <tt><b>-x tz=</b></tt><i>time-zone</i> <tt><b>-x locale=</b></tt><i>locale-name</i></pre><dl><dt><tt>add</tt></dt>
<dd><p>Adds the specified diskless client.</p></dd>
<dt><tt>--</tt></dt>
<dd><p>Identifies that the subcommand arguments start after this point.</p></dd>
<dt><tt>-i</tt> <i>ip-address</i></dt>
<dd><p>Identifies the IP address of the diskless client.</p></dd>
<dt><tt>-e</tt> <i>ethernet-address</i></dt>
<dd><p>Identifies the Ethernet address of the diskless client.</p></dd>
<dt><tt>-n</tt> <i>client-name</i></dt>
<dd><p>Specifies the name of the diskless client.</p></dd>
<dt><tt>-x os=</tt><i>instruction-set.machine-class.</i>.Solaris_<i>version</i></dt>
<dd><p>Specifies the instruction architecture, machine class, OS, and the Solaris version for the diskless client.</p></dd>
<dt><tt>-x root=</tt><tt>root=/export/root/</tt><i>client-name</i></dt>
<dd><p>Identifies the root (<tt>/</tt>) directory for the diskless client.</p></dd>
<dt><tt>-x swap=</tt><tt>root=/export/root/</tt><i>client-name</i></dt>
<dd><p>Identifies the swap file for the diskless client.</p></dd>
<dt><tt>-x swapsize=</tt><i>size</i></dt>
<dd><p>Specifies the size of the swap file in Mbytes. The default is 24 Mbytes.</p></dd>
<dt><tt>-x tz=</tt><i>time-zone</i></dt>
<dd><p>Specifies the time-zone for the diskless client.</p></dd>
<dt><tt>-x locale=</tt><i>locale-name</i></dt>
<dd><p>Specifies the locale to install for the diskless client.</p></dd>
</dl>
<p>For more information, see the <a href="http://docs.sun.com/doc/819-2240/smdiskless-1m?a=view"><tt>smdiskless</tt>(1M)</a> man page.</p></li>
<li><a name="fxcib"></a><b>(Optional) Continue to use the <tt>smdiskless add</tt> command to add each diskless client.</b></li>
<li><a name="fxcth"></a><b>Verify that the diskless clients were installed. </b><pre># <tt><b>/usr/sadm/bin/smdiskless list -H </tt><i>host-name</i><tt>:898 --</b></tt></pre></li></ol><h6>Example&nbsp;7-5 SPARC: Adding Diskless Client Support to a SPARC Based System</h6><p>This example shows how to add Solaris 10 sun4u diskless client, <tt>starlite</tt>,
from the server <tt>bearclaus</tt>.</p><pre># <tt><b>/usr/sadm/bin/smdiskless add -- -i 172.20.27.28 -e 8:0:20:a6:d4:5b -n starlite -x os=sparc.sun4u.Solaris_10 -x root=/export/root/starlite -x swap=/export/swap/starlite -x swapsize=128 -x tz=US/Mountain -x locale=en_US</b></tt>

# <tt><b>/usr/sadm/bin/smdiskless list -H starlite:898 --</b></tt>
Loading Tool: com.sun.admin.osservermgr.cli.OsServerMgrCli from line2-v480:898
Login to line2-v480 as user root was successful.
Download of com.sun.admin.osservermgr.cli.OsServerMgrCli from line2-v480:898 was 
successful.
Platform
--------------------------------------------------------------------------------
i386.i86pc.Solaris_10                                                           
sparc.sun4us.Solaris_10                                                         
sparc.sun4u.Solaris_10                                                          
i386.i86pc.Solaris_9                                                            
sparc.sun4m.Solaris_9                                                           
sparc.sun4u.Solaris_9                                                           
sparc.sun4us.Solaris_9</pre><p>Note that the <tt>smdiskless list</tt> <tt>-H</tt> command output lists both SPARC based and x86
based systems.</p><a name="fxcic"></a><h6>Example&nbsp;7-6 x86: Adding Diskless Client Support to an x86 Based System in the Solaris 10 OS</h6><p>This example shows how to add a Solaris 10 x86 based diskless
client, <tt>mars</tt>, from the server <tt>bearclaus</tt>.</p><pre># <tt><b>/usr/sadm/bin/smdiskless add -- -i 172.20.27.176 -e 00:07:E9:23:56:48 -n mars -x os=i386.i86pc.Solaris_10 -x root=/export/root/mars -x swap=/export/swap/mars -x swapsize=128 -x tz=US/Mountain -x locale=en_US</b></tt></pre>

<a name="fwazk"></a><h4>x86: How to Boot a Diskless Client With GRUB</h4><p>If you have installed or upgraded your system to at least the
Solaris 10 1/06 OS, the procedure for booting a diskless client has changed.
Follow these steps to boot a diskless client with GRUB.</p>
<hr><p><b>Note - </b>Starting with the Solaris Express 3/06 release, the GRUB failsafe interaction has changed.
When booting the failsafe archive, you are no longer prompted by the system
to automatically update the boot archives. The system prompts you to update the
boot archives only if inconsistent boot archives are detected. For more information, see
<a href="ggqdn.html#fvznb">How to Boot the Failsafe Archive on an x86 Based System by Using GRUB</a>.</p>
<hr>
<h6>Before You Begin</h6><p>To ensure that the system boots from the network, verify the following prerequisites
on the OS server:</p>
<ul><li><p>Confirm that the name service used to add the diskless client and the OS services matches the primary name in the server's <tt>/etc/nsswitch.conf</tt> file.</p></li>
<li><p>Verify that the DHCP and <tt>tftp</tt> boot services are running.</p></li>
<li><p>Configure the system BIOS to boot the system from the network by enabling the PXE ROM option.</p><p>Some PXE-capable network adapters have a feature that enables PXE boot if you type a particular keystroke in response to a brief boot-time prompt. See your hardware documentation for information about how to set the boot priority in the BIOS.</p></li></ul>
<ol>
<li><b>Boot the diskless client by typing the correct keystroke combination.</b><p>The GRUB menu is displayed.</p><p>Depending on the configuration of your network installation server, the GRUB menu that
is displayed on your system might vary from the GRUB menu that is
shown here.</p></li>
<li><a name="gcbdt"></a><b><a name="gcbdn"></a>Use the arrow keys to select a boot entry, then press Enter.</b><p>If you do not make a selection, the default OS instance is
automatically booted after several seconds.</p><ul>
<li><b>If you need to modify the GRUB kernel behavior by editing the GRUB
menu at boot time, use the arrow keys to select a boot
entry, then type <tt>e</tt> to edit the entry. </b>
<hr><p><b>Note - </b>The previous example shows the GRUB multiboot implementation. The GRUB menus vary, depending
on the Solaris release you are running.</p>
<hr>
<p>The boot command that you want to edit is displayed in the
GRUB edit screen.</p><p>For more information about modifying kernel behavior at boot time, see <a href="grubtasks-1.html">Chapter&nbsp;11, Modifying Solaris Boot Behavior (Tasks)</a>.</p></li>
<li><b>To save the edits and return to the GRUB menu, press Enter.</b><p>The GRUB menu is displayed, showing the edits you made to the
boot command.</p></li>
<li><b>Type <tt>b</tt> to boot the system from the network.</b></li></ul></li></ol>

<a name="clientsetup-5"></a><h4>SPARC: How to Boot a Diskless Client in the Solaris 10 OS</h4><h6>Before You Begin</h6><p>Verify the following prerequisites on the OS server:</p>
<ul><li><p>Confirm that the name service used to add the diskless client and the OS services matches the primary name in the server's <tt>/etc/nsswitch.conf</tt> file.</p><p>Otherwise, the diskless client will not boot.</p></li>
<li><p>Confirm that the <tt>rpc.bootparamd</tt> daemon is running. If it is not running, start it.</p></li></ul>
<ul>
<li><a name="clientsetup-step-1"></a><b><a name="indexterm-90"></a><a name="indexterm-91"></a>Boot the diskless client.</b><pre>ok <tt><b>boot net</b></tt></pre></li></ul>

<a name="clientsetup-11"></a><h4>How to Remove Diskless Client Support</h4><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="clientsetup-step-18"></a><b>Remove the diskless client support.</b><pre># <tt><b>/usr/sadm/bin/smdiskless delete -- -o </tt><i>host-name</i><tt>:898 -n</b></tt> <i>client-name</i></pre></li>
<li><a name="clientsetup-step-20"></a><b>Verify that the diskless client support has been removed. </b><pre># <tt><b>/usr/sadm/bin/smosservice list -H </tt><i>host-name</i><tt>:898 --</b></tt></pre></li></ol><h6>Example&nbsp;7-7 Removing Diskless Client Support</h6><p>This example shows how to remove the diskless client <tt>holoship</tt> from the OS
server <tt>starlite</tt>.</p><pre># <tt><b>/usr/sadm/bin/smdiskless delete -- -o starlite:898 -n holoship</b></tt>
Authenticating as user: root

Type /? for help, pressing enter accepts the default denoted by [ ]
Please enter a string value for: password :: 
Starting SMC server version 2.0.0.
endpoint created: :898
SMC server is ready.

# <tt><b>/usr/sadm/bin/smosservice list -H starlite:898 --</b></tt>
Loading Tool: com.sun.admin.osservermgr.cli.OsServerMgrCli from starlite
Login to starlite as user root was successful.
Download of com.sun.admin.osservermgr.cli.OsServerMgrCli from starlite
was successful.</pre>

<a name="clientsetup-10"></a><h4>How to Remove OS Services for Diskless Clients</h4><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="clientsetup-step-3"></a><b><a name="indexterm-92"></a><a name="indexterm-93"></a>Remove the OS services for the diskless clients.</b><pre># <tt><b>/usr/sadm/bin/smosservice delete -H $HOST:$PORT -u root -p $PASSWD -- -x </tt><i>instruction-set</i><tt>.all.</tt><i>Solaris_version</i><tt></b></tt></pre>
<hr><p><b>Note - </b>Only the machine-class, <tt>all</tt>, is supported.</p>
<hr>
</li>
<li><a name="clientsetup-step-5"></a><b>Verify that the OS services have been removed.</b><pre># <tt><b>/usr/sadm/bin/smosservice list -H </tt><i>host-name</i><tt>:898 --</b></tt></pre></li></ol><h6>Example&nbsp;7-8 Removing OS Services for Diskless Clients</h6><p><a name="indexterm-94"></a><a name="indexterm-95"></a>The following example shows how to removing the diskless client OS services (<tt>sparc.all.Solaris_10</tt>)
from the server <tt>starlite</tt>.</p><pre># <tt><b>/usr/sadm/bin/smosservice delete -H starlite:898 -u root -p </tt><i>xxxxxx</i><tt> -- -x sparc.all.solaris_10</b></tt>
Authenticating as user: root
Type /? for help, pressing enter accepts the default denoted by [ ]
Please enter a string value for: password :: 

# <tt><b>/usr/sadm/bin/smosservice list -H starlite:898 --</b></tt>
Loading Tool: com.sun.admin.osservermgr.cli.OsServerMgrCli from starlite:898
Login to starlite as user root was successful.
Download of com.sun.admin.osservermgr.cli.OsServerMgrCli from starlite:898
was successful</pre>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="clientsetup-2.html">Previous</a>
             </td>
             <td align="right">
                 <a href="clientsetup-13.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

