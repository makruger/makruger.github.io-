<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Booting the Failsafe Archive on an x86 Based System - System Administration Guide: Basic Administration</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-12-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Basic Administration</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ggqaa.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ghsut.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="vol1preface-11.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="saroadmap-1.html">1.&nbsp;&nbsp;Solaris Management Tools (Road Map)</a></p>
<p class="toc level1 tocsp"><a href="smcover-1.html">2.&nbsp;&nbsp;Working With the Solaris Management Console (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ewpor.html">3.&nbsp;&nbsp;Working With the Sun Java Web Console (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="userconcept-97366.html">4.&nbsp;&nbsp;Managing User Accounts and Groups (Overview)</a></p>
<p class="toc level1 tocsp"><a href="usersetup-92366.html">5.&nbsp;&nbsp;Managing User Accounts and Groups (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="clientconcept-15236.html">6.&nbsp;&nbsp;Managing Client-Server Support (Overview)</a></p>
<p class="toc level1 tocsp"><a href="clientsetup-1.html">7.&nbsp;&nbsp;Managing Diskless Clients (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbintro-66644.html">8.&nbsp;&nbsp;Introduction to Shutting Down and Booting a System</a></p>
<p class="toc level1 tocsp"><a href="hboverview-25463.html">9.&nbsp;&nbsp;Shutting Down and Booting a System (Overview)</a></p>
<p class="toc level1 tocsp"><a href="hbsyshalt-84412.html">10.&nbsp;&nbsp;Shutting Down a System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="grubtasks-1.html">11.&nbsp;&nbsp;Modifying Solaris Boot Behavior (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbsparcboot-79782.html">12.&nbsp;&nbsp;Booting a Solaris System (Tasks)</a></p>
<p class="toc level2"><a href="hbsparcboot-69.html">Booting a SPARC Based System (Task Map)</a></p>
<p class="toc level2"><a href="hbsparcboot-9.html">Booting a SPARC Based System</a></p>
<p class="toc level2"><a href="ggqhf.html">Booting From a ZFS Root File System on a SPARC Based System</a></p>
<p class="toc level2"><a href="ggqqq.html">Booting the Failsafe Archive on a SPARC Based System</a></p>
<p class="toc level2"><a href="hbsparcboot-60.html">Booting a SPARC Based System From the Network</a></p>
<p class="toc level2"><a href="hbx86boot-68676.html">Booting an x86 Based System by Using GRUB (Task Map)</a></p>
<p class="toc level2"><a href="ggqaa.html">Booting From a ZFS Root File System on an x86 Based System</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Booting the Failsafe Archive on an x86 Based System</a></p>
</div>
<p class="toc level2"><a href="ghsut.html">Using Fast Reboot on the x86 Platform (Task Map)</a></p>
<p class="toc level2"><a href="fvzok.html">Booting an x86 Based System from the Network</a></p>
<p class="toc level1 tocsp"><a href="hbtsboot-1.html">13.&nbsp;&nbsp;Troubleshooting Booting a Solaris System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="archive-123.html">14.&nbsp;&nbsp;Managing the Solaris Boot Archives (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbsysboot-76719.html">15.&nbsp;&nbsp;x86: GRUB Based Booting (Reference)</a></p>
<p class="toc level1 tocsp"><a href="hbrunlevels-25516.html">16.&nbsp;&nbsp;Managing Services (Overview)</a></p>
<p class="toc level1 tocsp"><a href="faauf.html">17.&nbsp;&nbsp;Managing Services (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgsconcepts-52619.html">18.&nbsp;&nbsp;Managing Software (Overview)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgsgui-1.html">19.&nbsp;&nbsp;Managing Software With Solaris System Administration Tools (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgscli-1.html">20.&nbsp;&nbsp;Managing Software by Using Package Commands (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpatchtasks-1.html">21.&nbsp;&nbsp;Managing Solaris Patches by Using the <tt>patchadd</tt> Command (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fddwm.html">A.&nbsp;&nbsp;SMF Services</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="ggqdn"></a><h3>Booting the Failsafe Archive on an x86 Based System</h3>
<p>To boot the failsafe archive on a x86 based system, select the
failsafe boot entry when the GRUB menu is displayed during a system boot.
 During the failsafe boot procedure, when prompted by the system, type <tt>y</tt>
to update the primary boot archive.</p><p>Failsafe booting is also supported on systems that are booted from ZFS. When
booting from a UFS-rooted BE, each BE has its own failsafe archive.
 The failsafe archive is located where the root file system is located,
as is the case with a ZFS-rooted BE.  On x86 based systems,
each failsafe archive has an entry in the pool-wide GRUB menu.  The
default failsafe archive is the archive that is in the default bootable file
system. The default bootable file system (dataset) is indicated by the value of
the pool's <tt>bootfs</tt> property.</p><p>Another method that can be used to update the boot archives is
to clear the boot-archive service. See <a href="ggngq.html#gglbw">How to Update an Inconsistent Boot Archive by Clearing the <tt>boot-archive</tt> Service</a>. However, the preferred methods for updating the
boot archives are to boot the failsafe archive or use the <tt>bootadm</tt> command.
For more information, see the <a href="archive-123.html">Chapter&nbsp;14, Managing the Solaris Boot Archives (Tasks)</a>.</p>

<a name="fvznb"></a><h4>How to Boot the Failsafe Archive on an x86 Based System by Using GRUB</h4><a name="indexterm-187"></a><a name="indexterm-188"></a><a name="indexterm-189"></a><a name="indexterm-190"></a><a name="indexterm-191"></a>
<hr><p><b>Note - </b>The GRUB failsafe interaction in some Solaris releases prompts you to update the
boot archives, regardless of whether any inconsistent boot archive are detected. In this
Solaris release, the system only prompts you to update the boot archives if
an inconsistent boot archive is detected.</p>
<hr>
<ol>
<li><a name="gcbmu"></a><b>Stop the system by using one of the methods described in the procedure,
<a href="ghtrz.html#fvzot">x86: How to Stop a System for Recovery Purposes</a>.</b></li>
<li><a name="gcbnn"></a><b>If the system displays the <tt>Press any key to reboot</tt> prompt, press any key to reboot
the system.</b><p>You can also use the Reset button at this prompt. Or, you can
use the power switch to reboot the system.</p><p>When the boot sequence begins, the GRUB menu is displayed.</p><pre>GNU GRUB  version 0.95  (637K lower / 3144640K upper memory)
 +-------------------------------------------------------------------+
| be1
| be1 failsafe
| be3
| be3 failsafe
| be2
| be2 failfafe
  +------------------------------------------------------------------+
      Use the ^ and v keys to select which entry is highlighted.
      Press enter to boot the selected OS, 'e' to edit the
      commands before booting, or 'c' for a command-line.</pre>
<hr><p><b>Note - </b>The GRUB menu that is displayed may vary, depending on the Solaris release
you are running.</p>
<hr>
</li>
<li><b>Use the arrow keys to navigate the GRUB menu to select a
failsafe entry.</b></li>
<li><b>Press Return to boot the failsafe archive.</b><p>The system searches for installed OS instances. If an inconsistent boot archive is
detected, a message similar to the following is displayed:</p><pre>Searching for installed OS instances...
    
    An out of sync boot archive was detected on /dev/dsk/c0t0d0s0.
    The boot archive is a cache of files used during boot and
    should be kept in sync to ensure proper system operation.
    
    Do you wish to automatically update this boot archive? [y,n,?]</pre></li>
<li><b>Type <tt>y</tt> to update the boot archive.</b><p>If multiple inconsistent boot archives are detected, the system will prompt you to type
<tt>y</tt> to update each inconsistent boot archive.</p><p>For each archive that is updated successfully, the following message is displayed:</p><pre>Updating boot archive on /dev/dsk/c0t0d0s0.
    The boot archive on /dev/dsk/c0t0d0s0 was updated successfully.</pre><p>After the boot archive is updated, the system searches again for all installed
OS instances, then prompts you to select a device to mount on
<tt>/a</tt>. Note that this same message is displayed when the system first boots
if no inconsistent boot archives are detected.</p><pre>Searching for installed OS instances...

Multiple OS instances were found. To check and mount one of them
read-write under /a, select it from the following list. To not mount
any, select 'q'.

  1  pool10:13292304648356142148     ROOT/be10
  2  rpool:14465159259155950256      ROOT/be01

Please select a device to be mounted (q for none) [?,??,q]:</pre><ul>
<li><b>If you choose not to mount a device, type <tt>q</tt> to continue to
boot process.</b></li>
<li><b>If you choose to mount a device, follow these steps:</b><ol style="list-style-type: lower-alpha">
				 
<li><b>Type the number of the device and press Return.</b><p>The system mounts the device on <tt>/a</tt>, and returns you to a shell prompt.</p></li>
<li><b>Repair the critical system resource.</b></li>
<li><b>When you are done repairing the critical system resource, unmount the device.</b><pre># <tt><b>umount /a</b></tt></pre></li>
<li><b>Reboot the system.</b><pre># <tt><b>reboot</b></tt></pre></li></ol></li></ul></li></ol>

<a name="gcbcn"></a><h4>x86: How to Boot the Failsafe Archive to Forcibly Update a Corrupt Boot Archive</h4><a name="indexterm-192"></a><a name="indexterm-193"></a><a name="indexterm-194"></a><a name="indexterm-195"></a><a name="indexterm-196"></a><p>This procedure shows how to rebuild an inconsistent or corrupt boot archive in
the event you are not prompted by the system to update the
boot archive the system, or in the event of a system hang or
looping sequence occurs.</p><ol>
<li><a name="gcbcp"></a><b>Stop the system by using one of the methods that are described in
the procedure, <a href="ghtrz.html#fvzot">x86: How to Stop a System for Recovery Purposes</a>.</b></li>
<li><a name="gcbfg"></a><b>Reboot the system.</b><pre># <tt><b>reboot</b></tt></pre><p>If the system displays the <tt>Press any key to reboot</tt> prompt, press any key to reboot the
system.</p><p>You can also use the Reset button at this prompt.</p><p>When the boot sequence begins, the GRUB menu is displayed.</p><pre>+---------------------------------------------------------------------+
 | Solaris 10.1... X86                                                     |
 | Solaris failsafe                                                        |
 |                                                                         |
 |                                                                         |
 +-------------------------------------------------------------------------+
      Use the  and  keys to select which entry is highlighted.
      Press enter to boot the selected OS, 'e' to edit the
      commands before booting, or 'c' for a command-line.</pre>
<hr><p><b>Note - </b>The contents of the GRUB menus vary, depending on the Solaris release you
are running.</p>
<hr>
</li>
<li><b>Use the arrow keys to navigate the GRUB menu, then select the failsafe
entry. Press Return to boot the failsafe archive.</b><p>If any boot archives are out of date, a message that is similar
to the following is displayed:</p><pre>Searching for installed OS instances...
    
    An out of sync boot archive was detected on /dev/dsk/c0t0d0s0.
    The boot archive is a cache of files used during boot and
    should be kept in sync to ensure proper system operation.
    
    Do you wish to automatically update this boot archive? [y,n,?]
        </pre></li>
<li><b>Type <tt>y</tt>, then press Enter to update the inconsistent boot archive.</b><p>The system displays the following message:</p><pre>Updating boot archive on /dev/dsk/c0t0d0s0.
    The boot archive on /dev/dsk/c0t0d0s0 was updated successfully.</pre><p>If no inconsistent boot archives are found, a message that is similar to
the following is displayed:</p><pre>Searching for installed OS instances...
    
    Solaris 10.1... X86 was found on /dev/dsk/c0t0d0s0.
    Do you wish to have it mounted read-write on /a? [y,n,?]</pre><p>This message is also displayed after any inconsistent boot archives are updated successfully.</p></li>
<li><b>Mount the device that contains the corrupt boot archive on <tt>/a</tt> by
typing the corresponding number of the device, then press Enter.</b>
<hr><p><b>Note - </b>If any inconsistent boot archives were updated in the previous step, the device
is already mounted on <tt>/a</tt>. Proceed to Step 6.</p>
<hr>
</li>
<li><a name="gcbey"></a><b>To forcibly update the corrupt boot archive, type:</b><pre># <tt><b>bootadm update-archive -f -R /a</b></tt></pre></li>
<li><a name="gcber"></a><b>Unmount the device.</b><pre># <tt><b>umount /a</b></tt></pre></li>
<li><b>Reboot the system.</b><pre># <tt><b>reboot</b></tt></pre></li></ol>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ggqaa.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ghsut.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

