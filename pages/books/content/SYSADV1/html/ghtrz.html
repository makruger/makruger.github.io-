<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Troubleshooting Booting on the x86 Platform (Task Map) - System Administration Guide: Basic Administration</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-12-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Basic Administration</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ggkti.html">Previous</a>
             </td>
             <td align="right">
                 <a href="archive-123.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="vol1preface-11.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="saroadmap-1.html">1.&nbsp;&nbsp;Solaris Management Tools (Road Map)</a></p>
<p class="toc level1 tocsp"><a href="smcover-1.html">2.&nbsp;&nbsp;Working With the Solaris Management Console (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ewpor.html">3.&nbsp;&nbsp;Working With the Sun Java Web Console (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="userconcept-97366.html">4.&nbsp;&nbsp;Managing User Accounts and Groups (Overview)</a></p>
<p class="toc level1 tocsp"><a href="usersetup-92366.html">5.&nbsp;&nbsp;Managing User Accounts and Groups (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="clientconcept-15236.html">6.&nbsp;&nbsp;Managing Client-Server Support (Overview)</a></p>
<p class="toc level1 tocsp"><a href="clientsetup-1.html">7.&nbsp;&nbsp;Managing Diskless Clients (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbintro-66644.html">8.&nbsp;&nbsp;Introduction to Shutting Down and Booting a System</a></p>
<p class="toc level1 tocsp"><a href="hboverview-25463.html">9.&nbsp;&nbsp;Shutting Down and Booting a System (Overview)</a></p>
<p class="toc level1 tocsp"><a href="hbsyshalt-84412.html">10.&nbsp;&nbsp;Shutting Down a System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="grubtasks-1.html">11.&nbsp;&nbsp;Modifying Solaris Boot Behavior (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbsparcboot-79782.html">12.&nbsp;&nbsp;Booting a Solaris System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbtsboot-1.html">13.&nbsp;&nbsp;Troubleshooting Booting a Solaris System (Tasks)</a></p>
<p class="toc level2"><a href="ggkti.html">Troubleshooting Booting on the SPARC Platform (Task Map)</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Troubleshooting Booting on the x86 Platform (Task Map)</a></p>
</div>
<p class="toc level1 tocsp"><a href="archive-123.html">14.&nbsp;&nbsp;Managing the Solaris Boot Archives (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbsysboot-76719.html">15.&nbsp;&nbsp;x86: GRUB Based Booting (Reference)</a></p>
<p class="toc level1 tocsp"><a href="hbrunlevels-25516.html">16.&nbsp;&nbsp;Managing Services (Overview)</a></p>
<p class="toc level1 tocsp"><a href="faauf.html">17.&nbsp;&nbsp;Managing Services (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgsconcepts-52619.html">18.&nbsp;&nbsp;Managing Software (Overview)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgsgui-1.html">19.&nbsp;&nbsp;Managing Software With Solaris System Administration Tools (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgscli-1.html">20.&nbsp;&nbsp;Managing Software by Using Package Commands (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpatchtasks-1.html">21.&nbsp;&nbsp;Managing Solaris Patches by Using the <tt>patchadd</tt> Command (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fddwm.html">A.&nbsp;&nbsp;SMF Services</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="ghtrz"></a><h3>Troubleshooting Booting on the x86 Platform (Task Map)</h3>
<table><col width="28%"><col width="40%"><col width="31%"><tr><th align="left" valign="top" scope="column"><p>Task</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>For Instructions</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Stop a system for recovery purposes. </p></td>
<td align="left" valign="top" scope="row"><p>If a damaged file
is preventing the system from booting normally, first stop the system to attempt
recovery</p></td>
<td align="left" valign="top" scope="row"><p><a href="#fvzot">x86: How to Stop a System for Recovery Purposes</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Force a crash dump of and reboot of the system.</p></td>
<td align="left" valign="top" scope="row"><p>You can force
a crash dump and reboot of the system as a troubleshooting measure.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#fvzni">x86: How to Force a Crash Dump and Reboot of the System</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Boot a
system with the kernel debugger.</p></td>
<td align="left" valign="top" scope="row"><p>You can the system with the kernel debugger
to troubleshoot booting problems. Use the <tt>kmdb</tt> command to boot the system.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#fvzpl">x86: How to Boot a System With the Kernel Debugger in the GRUB Boot Environment (<tt>kmdb</tt>)</a></p></td>
</tr>
</table>

<a name="gewzl"></a><h4>x86: Troubleshooting Error Messages Upon System Boot</h4>
<a name="indexterm-238"></a><a name="indexterm-239"></a><a name="indexterm-240"></a><a name="indexterm-241"></a><p>If any multiboot entries that support directly booting the <tt>unix</tt> kernel are encountered
by GRUB, the following message is displayed:</p><pre>multiboot is no longer used to boot the Solaris Operating System.
The grub entry should be changed to:
kernel$ /boot/$ISADIR/xen.gz
module$ /platform/i86xpv/kernel/$ISADIR/unix /platform/i86xpv/kernel/$ISADIR/unix -B $ZFS-BOOTFS
module$ /platform/i86pc/$ISADIR/boot_archive
See http://www.sun.com/msg/SUNOS-8000-AK for details.
Press any key to reboot.</pre><p>If the preceding message is displayed, you will need to update the
entries in the GRUB <tt>menu.lst</tt> manually to successfully boot the system. More information can
be found at <a href="http://www.sun.com/msg/SUNOS-8000-AK">http://www.sun.com/msg/SUNOS-8000-AK</a> and the <a href="http://docs.sun.com/doc/819-2240/boot-1m?a=view"><tt>boot</tt>(1M)</a> man page. For further information and
instructions, see <a href="hbx86boot-68676.html#ggpts">x86: Error Messages Upon System Boot</a>.</p>

<a name="fvzot"></a><h4>x86: How to Stop a System for Recovery Purposes</h4><ol>
<li><b><a name="indexterm-242"></a>Stop the system by using one of the following commands, if possible:</b>
<ul><li><p>If the keyboard and mouse are functional, become superuser. Then, type <tt>init 0</tt> to stop the system. After the <tt>Press any key to reboot</tt> prompt appears, press any key to reboot the system.</p></li>
<li><p>If the keyboard and mouse are functional, become superuser. then, type <tt>init 6</tt> to reboot the system.</p></li></ul>
</li>
<li><a name="fvzoz"></a><b>If the system does not respond to any input from the mouse or
the keyboard, press the Reset key, if it exists, to reboot the
system. </b><p>Or, you can use the power switch to reboot the system.</p></li></ol>

<a name="fvzpo"></a><h4>x86: Forcing a Crash Dump and Reboot of the System</h4>
<p>Forcing a crash dump and reboot of the system are sometimes necessary for
troubleshooting purposes. The <tt>savecore</tt> feature is enabled by default.</p><p>For more information about system crash dumps, see <a href="http://docs.sun.com/doc/819-2380/tscrashdumps-40145?a=view">Chapter 17, Managing System Crash Information (Tasks), in <i>System Administration Guide: Advanced Administration</i></a>. </p>

<a name="fvzni"></a><h5>x86: How to Force a Crash Dump and Reboot of the System</h5>
<p>If you cannot use the <tt>reboot</tt> <tt>-d</tt> or the <tt>halt</tt> <tt>-d</tt> command, you
can use the kernel debugger, <tt>kmdb</tt>, to force a crash dump. The kernel
debugger must have been loaded, either at boot, or with the <tt>mdb</tt> <tt>-k</tt>
command, for the following procedure to work.</p>
<hr><p><b>Note - </b>You must be in text mode to access the kernel debugger (<tt>kmdb</tt>).
So, first exit any window system.</p>
<hr>
<ol>
<li><b>Access the kernel debugger.</b><p>The method used to access the debugger is dependent upon the type
of console that you are using to access the system.</p>
<ul><li><p>If you are using a locally attached keyboard, press F1&ndash;A.</p></li>
<li><p>If you are using a serial console, send a break by using the method appropriate to that type of serial console.</p></li></ul>
<p>The <tt>kmdb</tt> prompt is displayed.</p></li>
<li><b>To induce a crash, use the <tt>systemdump</tt> macro.</b><pre>[0]&gt; $&lt;<tt><b>systemdump</b></tt></pre><p>Panic messages are displayed, the crash dump is saved, and the system reboots.</p></li>
<li><a name="ghttw"></a><b>Verify that the system has rebooted by logging in at the console login
prompt.</b></li></ol><a name="ghtua"></a><h6>Example&nbsp;13-6 x86: Forcing a Crash Dump and Reboot of the System by Using <tt>halt</tt> <tt>-d</tt></h6><p>This example shows how to force a crash dump and reboot of
the x86 based system <tt>neptune</tt> by using the <tt>halt</tt> <tt>-d</tt> and <tt>boot</tt> commands.
Use this method to force a crash dump of the system. Reboot the
system afterwards manually.</p><pre># <tt><b>halt -d</b></tt>
4ay 30 15:35:15 wacked.Central.Sun.COM halt: halted by <i>user</i>

panic[cpu0]/thread=ffffffff83246ec0: forced crash dump initiated at user request

fffffe80006bbd60 genunix:kadmin+4c1 ()
fffffe80006bbec0 genunix:uadmin+93 ()
fffffe80006bbf10 unix:sys_syscall32+101 ()

syncing file systems... done
dumping to /dev/dsk/c1t0d0s1, offset 107675648, content: kernel
NOTICE: adpu320: bus reset
100% done: 38438 pages dumped, compression ratio 4.29, dump succeeded

Welcome to kmdb
Loaded modules: [ audiosup crypto ufs unix krtld s1394 sppp nca uhci lofs 
genunix ip usba specfs nfs md random sctp ]
[0]&gt; 
kmdb: Do you really want to reboot? (y/n) <tt><b>y</b></tt></pre>

<a name="fvzpl"></a><h4>x86: How to Boot a System With the Kernel Debugger in the GRUB Boot Environment (<tt>kmdb</tt>)</h4><p>This procedure shows the basics for loading the kernel debugger (<tt>kmdb</tt>). The
<tt>savecore</tt> feature is enabled by default. For more detailed information about using the
kernel debugger, see the <a href="http://docs.sun.com/doc/817-2543"><i>Solaris Modular Debugger Guide</i></a>.</p><ol>
<li><b>Boot the system.</b><p>The GRUB menu is displayed when the system is booted.</p></li>
<li><a name="ghtuq"></a><b>When the GRUB menu is displayed, type <tt>e</tt> to access the GRUB edit
menu.</b></li>
<li><b>Use the arrow keys to select the <tt>kernel$</tt> line.</b><p>If you cannot use the arrow keys, use the <tt>^</tt> key to scroll
up and the <tt>v</tt> key to scroll down.</p></li>
<li><b>Type <tt>e</tt> to edit the line.</b><p>The boot entry menu is displayed. In this menu, you can modify Solaris
boot behavior by adding additional boot arguments to the end of the <tt>kernel$</tt>
line.</p></li>
<li><b>Type <tt>-k</tt> at the end of the line.</b></li>
<li><b>Press enter to return to the GRUB main menu.</b></li>
<li><b>Type <tt>b</tt> to boot the system with the kernel debugger enabled.</b></li>
<li><b>Access the kernel debugger.</b><p>The method used to access the debugger is dependent upon the type
of console that you are using to access the system:</p>
<ul><li><p>If you are using a locally attached keyboard, press F1&ndash;A.</p></li>
<li><p>If you are using a serial console, send a break by using the method appropriate to that type of serial console.</p></li></ul>
<p>A welcome message is displayed when you access the kernel debugger for the
first time.</p></li></ol><a name="ghtwx"></a><h6>Example&nbsp;13-7 x86: Booting a System With the Kernel Debugger (Hypervisor Support)</h6><p>This example shows how to boot a 64-bit capable x86 based system,
with the kernel debugger enabled:</p><pre>kernel$ /boot/$ISADIR/xen.gz
module$ /platform/i86xpv/kernel/$ISADIR/unix /platform/i86xpv/kernel/$ISADIR/unix -B $ZFS-BOOTFS <tt><b>-k</b></tt></pre><p>This example shows how to boot a 64-bit capable x86 based system
in 32-bit mode, with the kernel debugger enabled:</p><pre>kernel$ /boot/xen.gz
module$ /platform/i86xpv/kernel/unix /platform/i86xpv/kernel/unix -B $ZFS-BOOTFS <tt><b>-k</b></tt></pre><a name="ghtwr"></a><h6>Example&nbsp;13-8 x86: Booting a System With the Kernel Debugger (Support for Directly Loading and Booting the <tt>unix</tt> Kernel)</h6><p>The following examples apply to a Solaris release with GRUB support for directly
loading and booting the <tt>unix</tt> kernel.</p><p>This example shows how to boot a 64-bit capable x86 based system,
with the kernel debugger enabled.</p><pre>kernel$ /platform/i86pc/kernel/$ISADIR/unix -B $ZFS-BOOTFS <tt><b>-k</b></tt></pre><p>This example shows how to boot a 64-bit capable x86 based system
in 32-bit mode, with the kernel debugger enabled.</p><pre>kernel$ /platform/i86pc/kernel/unix -B $ZFS-BOOTFS <tt><b>-k</b></tt></pre><a name="ghtwy"></a><h6>Example&nbsp;13-9 x86: Booting a System With the Kernel Debugger (GRUB Multiboot Implementation)</h6><p>This example shows how to manually boot a 64-bit capable x86 based
system with the kernel debugger enabled.</p><pre>kernel$ /platform/i86pc/multiboot <tt><b>kernel/amd64/unix -k</b></tt> -B $ZFS-BOOTFS</pre><p>This example shows how to boot a 64-bit capable x86 based system
32-bit mode with the kernel debugger enabled.</p><pre>kernel$ /platform/i86pc/multiboot <tt><b>kernel/unix -k -B $ZFS-BOOTFS</b></tt></pre>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ggkti.html">Previous</a>
             </td>
             <td align="right">
                 <a href="archive-123.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

