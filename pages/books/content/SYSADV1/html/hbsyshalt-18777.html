<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Shutting Down the System - System Administration Guide: Basic Administration</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-12-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Basic Administration</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="etesp.html">Previous</a>
             </td>
             <td align="right">
                 <a href="hbsyshalt-33237.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="vol1preface-11.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="saroadmap-1.html">1.&nbsp;&nbsp;Solaris Management Tools (Road Map)</a></p>
<p class="toc level1 tocsp"><a href="smcover-1.html">2.&nbsp;&nbsp;Working With the Solaris Management Console (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ewpor.html">3.&nbsp;&nbsp;Working With the Sun Java Web Console (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="userconcept-97366.html">4.&nbsp;&nbsp;Managing User Accounts and Groups (Overview)</a></p>
<p class="toc level1 tocsp"><a href="usersetup-92366.html">5.&nbsp;&nbsp;Managing User Accounts and Groups (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="clientconcept-15236.html">6.&nbsp;&nbsp;Managing Client-Server Support (Overview)</a></p>
<p class="toc level1 tocsp"><a href="clientsetup-1.html">7.&nbsp;&nbsp;Managing Diskless Clients (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbintro-66644.html">8.&nbsp;&nbsp;Introduction to Shutting Down and Booting a System</a></p>
<p class="toc level1 tocsp"><a href="hboverview-25463.html">9.&nbsp;&nbsp;Shutting Down and Booting a System (Overview)</a></p>
<p class="toc level1 tocsp"><a href="hbsyshalt-84412.html">10.&nbsp;&nbsp;Shutting Down a System (Tasks)</a></p>
<p class="toc level2"><a href="etesp.html">Shutting Down the System (Task Map)</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Shutting Down the System</a></p>
</div>
<p class="toc level2"><a href="hbsyshalt-33237.html">Turning Off Power to All Devices</a></p>
<p class="toc level1 tocsp"><a href="grubtasks-1.html">11.&nbsp;&nbsp;Modifying Solaris Boot Behavior (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbsparcboot-79782.html">12.&nbsp;&nbsp;Booting a Solaris System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbtsboot-1.html">13.&nbsp;&nbsp;Troubleshooting Booting a Solaris System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="archive-123.html">14.&nbsp;&nbsp;Managing the Solaris Boot Archives (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbsysboot-76719.html">15.&nbsp;&nbsp;x86: GRUB Based Booting (Reference)</a></p>
<p class="toc level1 tocsp"><a href="hbrunlevels-25516.html">16.&nbsp;&nbsp;Managing Services (Overview)</a></p>
<p class="toc level1 tocsp"><a href="faauf.html">17.&nbsp;&nbsp;Managing Services (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgsconcepts-52619.html">18.&nbsp;&nbsp;Managing Software (Overview)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgsgui-1.html">19.&nbsp;&nbsp;Managing Software With Solaris System Administration Tools (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgscli-1.html">20.&nbsp;&nbsp;Managing Software by Using Package Commands (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpatchtasks-1.html">21.&nbsp;&nbsp;Managing Solaris Patches by Using the <tt>patchadd</tt> Command (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fddwm.html">A.&nbsp;&nbsp;SMF Services</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="hbsyshalt-18777"></a><h3>Shutting Down the System</h3>
<p>Solaris software is designed to run continuously so that the electronic mail and
network software can work correctly. However, some system administration tasks and emergency situations
require that the system is shut down to a level where it is
safe to remove power. In some cases, the system needs to be
brought to an intermediate level, where not all system services are available. </p><p>Such cases include the following:</p>
<ul><li><p>Adding or removing hardware</p></li>
<li><p>Preparing for an expected power outage</p></li>
<li><p>Performing file system maintenance, such as a backup</p></li></ul>
<p>For a complete list of system administration tasks that require a system shutdown,
see <a href="hboverview-25463.html">Chapter&nbsp;9, Shutting Down and Booting a System (Overview)</a>.</p><p>For information on using your system's power management features, see the <a href="http://docs.sun.com/doc/819-2240/pmconfig-1m?a=view"><tt>pmconfig</tt>(1M)</a> man page.</p>

<a name="hbsyshalt-34923"></a><h4>System Shutdown Commands</h4>
<p><a name="hbsyshalt-ix969"></a><a name="hbsyshalt-ix970"></a>The use of the <tt>init</tt> and <tt>shutdown</tt> commands are the primary ways to
shut down a system. Both commands perform a <b>clean</b> <b>shutdown</b> of the
system. As such, all file system changes are written to the disk, and
all system services, processes, and the operating system are terminated normally.  </p><p>The use of a system's Stop key sequence or turning a system
off and then on are not clean shutdowns because system services are terminated
abruptly. However, sometimes these actions are needed in emergency situations. For instructions on system
recovery techniques, see <a href="hbsparcboot-79782.html">Chapter&nbsp;12, Booting a Solaris System (Tasks)</a> and<a href="archive-123.html">Chapter&nbsp;14, Managing the Solaris Boot Archives (Tasks)</a>.</p>
<hr><p><b>Note - </b>On x86 systems that are running at least the Solaris 10 6/06
release, pressing and releasing the power button initiates a clean system shutdown. This method
is equivalent to using the <tt>init 5</tt> command.</p>
<hr>
<p><a name="hbsyshalt-ix971"></a>The following table describes the various shutdown commands and provides recommendations for using
them. </p><a name="hbsyshalt-36501"></a><h6>Table&nbsp;10-1 Shutdown Commands</h6><table><col width="17%"><col width="36%"><col width="45%"><tr><th align="left" valign="top" scope="column"><p>Command</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>When To Use</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>shutdown</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="hbsyshalt-ix972"></a>An executable shell script that calls the <tt>init</tt> program to
shut down the system. The system is brought to run level S by
default. </p></td>
<td align="left" valign="top" scope="row"><p>Recommended for servers operating at run level 3 because users are
notified of the impending shutdown. Also notified are the systems that are mounting resources
from the server that is being shut down. </p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>init</tt> </p></td>
<td align="left" valign="top" scope="row"><p><a name="hbsyshalt-ix973"></a>An executable that
kills all active processes and synchronizes the disks before changing run levels. </p></td>
<td align="left" valign="top" scope="row"><p>Recommended
for stand-alone systems when other users will not be affected. Provides a faster
system shutdown because users are not notified of the impending shutdown.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>reboot</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="hbsyshalt-ix974"></a>An executable that
synchronizes the disks and passes boot instructions to the <tt>uadmin</tt> system call. In
turn, this system call stops the processor. </p></td>
<td align="left" valign="top" scope="row"><p>The <tt>init</tt> command is the preferred
method.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>halt</tt>, <tt>poweroff</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="hbsyshalt-ix975"></a><a name="indexterm-134"></a>An executable that synchronizes the disks and stops the processor. </p></td>
<td align="left" valign="top" scope="row"><p>Not
recommended because it doesn't shutdown all processes, and unmount any remaining file systems.
Stopping the services, without doing a clean shutdown, should only be done in
an emergency or if most of the services are already stopped.</p></td>
</tr>
</table>

<a name="hbsyshalt-30713"></a><h4>User Notification of System Down Time</h4>
<p><a name="hbsyshalt-ix978"></a>When the <tt>shutdown</tt> command is initiated, a warning followed by a final
shutdown message is broadcast to all users who are currently logged in to
the system and all systems that are mounting resources from the affected system.</p><p><a name="hbsyshalt-ix979"></a>For this reason, the <tt>shutdown</tt> command is preferred instead of the <tt>init</tt> command
when you need to shut down a server. When you use either command,
you might want to give users more notice by sending them a mail
message about any scheduled system shutdown. </p><p>Use the <tt>who</tt> command to determine which users on the system need to
be notified. This command is also useful for determining a system's current run
level. For more information, see <a href="hbrunlevels-13026.html#hbrunlevels-25070">Determining a System's Run Level</a> and the <a href="http://docs.sun.com/doc/819-2239/who-1?a=view"><tt>who</tt>(1)</a> man page.</p>

<a name="hbsyshalt-38708"></a><h4>How to Determine Who Is Logged in to a System</h4><ol>
<li><a name="hbsyshalt-step-2"></a><b>Log into the system to be shut down.</b></li>
<li><a name="hbsyshalt-step-3"></a><b><a name="hbsyshalt-ix981"></a>Display all users who are logged in to the system. </b><pre>$ <tt><b>who</b></tt></pre></li></ol><h6>Example&nbsp;10-1 Determining Who Is Logged in to a System</h6><p>The following example shows how to display who is logged in to
the system.</p><pre>$ <tt><b>who</b></tt>
holly       console      May  7 07:30
kryten      pts/0        May  7 07:35   (starlite) 
lister      pts/1        May  7 07:40   (bluemidget)</pre>
<ul><li><p>Data in the first column identifies the user name of the logged-in user</p></li>
<li><p>Data in the second column identifies the terminal line of the logged-in user</p></li>
<li><p>Data in the third column identifies the date and time that the user logged in</p></li>
<li><p>Data in the forth column, if present, identifies the host name if a user is logged in from a remote system</p></li></ul>


<a name="hbsyshalt-91289"></a><h4>How to Shut Down a Server</h4><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="hbsyshalt-step-7"></a><b>Find out if users are logged in to the system.</b><pre># <tt><b>who</b></tt></pre><p>A list of all logged-in users is displayed. You might want to
send mail or broadcast a message to let users know that the system
is being shut down.</p></li>
<li><a name="hbsyshalt-step-8"></a><b><a name="hbsyshalt-ix983"></a>Shut down the system.</b><pre># <tt><b>shutdown -i</b></tt><i>init-level</i> <tt><b>-g</b></tt><i>grace-period</i> <tt><b>-y</b></tt></pre><dl><dt><tt>-i</tt><i>init-level</i></dt>
<dd><p>Brings the system to an init level that is different from the default of S. The choices are 0, 1, 2, 5, and 6.</p><p>Run levels 0 and 5 are reserved states for shutting the system down. Run level 6 reboots the system. Run level 2 is available as a multi-user operating state.</p></dd>
<dt><tt>-g</tt><i>grace-period</i></dt>
<dd><p>Indicates a time (in seconds) before the system is shut down. The default is 60 seconds.</p></dd>
<dt><tt>-y</tt></dt>
<dd><p>Continues to shut down the system without intervention. Otherwise, you are prompted to continue the shutdown process after 60 seconds.</p></dd>
</dl>
<p>For more information, see the <a href="http://docs.sun.com/doc/819-2240/shutdown-1m?a=view"><tt>shutdown</tt>(1M)</a> man page.</p></li>
<li><a name="hbsyshalt-step-9"></a><b>If you are asked for confirmation, type <tt>y</tt>.</b><pre>Do you want to continue? (y or n): <tt><b>y</b></tt></pre><p>If you used the <tt>shutdown -y</tt> command, you will not be prompted to continue.</p></li>
<li><a name="hbsyshalt-step-10"></a><b>Type the superuser password, if prompted.</b><pre>Type Ctrl-d to proceed with normal startup,
(or give root password for system maintenance): <tt><b>xxxxxx</b></tt></pre></li>
<li><a name="hbsyshalt-step-29"></a><b>After you have finished the system administration tasks, press Control-D to return to
the default system run level.</b></li>
<li><a name="hbsyshalt-step-11"></a><b>Use the following table to verify that the system is at the run
level that you specified in the <tt>shutdown</tt> command.</b><table><col width="31%"><col width="33%"><col width="34%"><tr><th align="left" valign="top" scope="column"><p>Specified Run Level</p></th>
<th align="left" valign="top" scope="column"><p>SPARC Based System
Prompt</p></th>
<th align="left" valign="top" scope="column"><p>x86 Based System Prompt</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>S (single-user level)</p></td>
<td align="left" valign="top" scope="row"><p>#</p></td>
<td align="left" valign="top" scope="row"><p>#</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>0 (power-down level)</p></td>
<td align="left" valign="top" scope="row"><p><tt>ok</tt> or <tt>&gt;</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>Press any key to reboot</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Run level 3
(multiuser level with remote resources shared)</p></td>
<td align="left" valign="top" scope="row"><p><i>hostname</i> <tt>console login:</tt></p></td>
<td align="left" valign="top" scope="row"><p><i>hostname</i> <tt>console login:</tt></p></td>
</tr>
</table></li></ol><h6>Example&nbsp;10-2 SPARC: Bringing a Server to Run Level S</h6><p>In the following example, the <tt>shutdown</tt> command is used to bring a SPARC
based system to run level S (single-user level) in three minutes.</p><pre># <tt><b>who</b></tt>
root   console      Jun 14 15:49    (:0)

# <tt><b>shutdown -g180 -y</b></tt>

Shutdown started.    Mon Jun 14 15:46:16 MDT 2004

Broadcast Message from root (pts/4) on venus Mon Jun 14 15:46:16...
The system venus will be shut down in 3 minutes .
.
.
Broadcast Message from root (pts/4) on venus Mon Jun 14 15:46:16...
The system venus will be shut down in 30 seconds .
.
.
INIT: New run level: S
The system is coming down for administration.  Please wait.
Unmounting remote filesystems: /vol nfs done.
Shutting down Solaris Management Console server on port 898.
Print services stopped.
Jun 14 15:49:00 venus syslogd: going down on signal 15
Killing user processes: done.

Requesting System Maintenance Mode
SINGLE USER MODE

Root password for system maintenance (control-d to bypass): <tt><b>xxxxxx</b></tt>
single-user privilege assigned to /dev/console.
Entering System Maintenance Mode
#</pre><h6>Example&nbsp;10-3 SPARC: Bringing a Server to Run Level 0</h6><p>In the following example, the <tt>shutdown</tt> command is used to bring a SPARC
based system to run level 0 in 5 minutes without requiring additional confirmation.</p><pre># <tt><b>who</b></tt>
root       console       Jun 17 12:39
userabc         pts/4        Jun 17 12:39   (:0.0)
# <tt><b>shutdown -i0 -g300 -y</b></tt>
Shutdown started.    Thu Jun 17 12:40:25 MST 2004

Broadcast Message from root (console) on pretend Thu Jun 17 12:40:25...
The system pretend will be shut down in 5 minutes 
.
.
.
Changing to init state 0 - please wait
# 
INIT: New run level: 0
The system is coming down.  Please wait.
System services are now being stopped.
.
.
.
The system is down.
syncing file systems... done
Program terminated
Type  help  for more information
ok </pre><p>If you are bringing the system to run level 0 to turn
off power to all devices, see <a href="hbsyshalt-33237.html#hbsyshalt-26887">How to Turn Off Power to All Devices</a>. </p><h6>Example&nbsp;10-4 SPARC: Rebooting a Server to Run Level 3</h6><p>In the following example, the <tt>shutdown</tt> command is used to reboot a SPARC
based system to run level 3 in two minutes. No additional confirmation is
required.</p><pre># <tt><b>who</b></tt>
root           console      Jun 14 15:49    (:0)
userabc    pts/4        Jun 14 15:46    (:0.0)
# <tt><b>shutdown -i6 -g120 -y</b></tt>
Shutdown started.    Mon Jun 14 15:46:16 MDT 2004

Broadcast Message from root (pts/4) on venus Mon Jun 14 15:46:16...
The system venus will be shut down in 2 minutes 


Changing to init state 6 - please wait
# 
INIT: New run level: 6
The system is coming down.  Please wait.
.
.
.
The system is down.
syncing file systems... done
rebooting...
.
.
.
venus console login:</pre><h6>See Also</h6><p>Regardless of why you shut down a system, you'll probably want to
return to run level 3 where all file resources are available and users
can log in. For instructions on bringing a system back to a multiuser
level, see <a href="hbsparcboot-79782.html">Chapter&nbsp;12, Booting a Solaris System (Tasks)</a>.</p>

<a name="hbsyshalt-93400"></a><h4>How to Shut Down a Stand-Alone System</h4><p>Use this procedure when you need to shut down a stand-alone system.</p><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="hbsyshalt-step-16"></a><b>Shut down the system. </b><pre># <tt><b>init 5</b></tt></pre><p>For more information, see the <a href="http://docs.sun.com/doc/819-2240/init-1m?a=view"><tt>init</tt>(1M)</a> man page.</p><ul>
<li><b>Alternately, you can use the <tt>uadmin</tt> command to shut down the system.</b><pre># <tt><b>uadmin 2 0</b></tt></pre></li>
<li><b>If you have an x86 based system that is running at least
the Solaris 10 6/06 release, you can press and release the power button
to initiate a clean system shutdown and turn off the system. This functionality
is equivalent to using the <tt>init 5</tt> command to shut down a system. 
For more information, see <a href="etmjx.html">What's New in Shutting Down and Booting a System</a>.</b></li></ul></li>
<li><a name="hbsyshalt-step-30"></a><b><a name="hbsyshalt-ix985"></a>Use the following table to verify that the system is at the
run level that you specified in the <tt>init</tt> command.</b><table><col width="35%"><col width="32%"><col width="32%"><tr><th align="left" valign="top" scope="column"><p>Specified Run Level</p></th>
<th align="left" valign="top" scope="column"><p> SPARC Based
System Prompt</p></th>
<th align="left" valign="top" scope="column"><p> x86 Based System Prompt</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>S (single-user level)</p></td>
<td align="left" valign="top" scope="row"><p><tt>#</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>#</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>2 (multiuser level)</p></td>
<td align="left" valign="top" scope="row"><p><tt>#</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>#</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>0 (power-down level)</p></td>
<td align="left" valign="top" scope="row"><p><tt>ok</tt>
or <tt>&gt;</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>Press any key to reboot</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>3 (multiuser level with NFS resources shared)</p></td>
<td align="left" valign="top" scope="row"><p><i>hostname</i> <tt>console login:</tt></p></td>
<td align="left" valign="top" scope="row"><p><i>hostname</i> <tt>console login:</tt></p></td>
</tr>
</table></li></ol><a name="ggmmu"></a><h6>Example&nbsp;10-5 Using the <tt>uadmin</tt> command to Shut Down a System</h6><pre># <tt><b>uadmin 2 0</b></tt>
syncing file systems... done
Program terminated</pre><h6>Example&nbsp;10-6 Bringing a Stand-Alone System to Run Level 0</h6><p>In this example, the <tt>init</tt> command is used to bring an x86 based
stand-alone system to the level where it is safe to turn off power.</p><pre># <tt><b>init 0</b></tt>
#
INIT: New run level: 0
The system is coming down.  Please wait.
.
 
.
 
.
The system is down.
syncing file systems... [11] [10] [3] done
Press any key to reboot</pre><p>If you are bringing the system to run level 0 to turn
off power to all devices, see <a href="hbsyshalt-33237.html#hbsyshalt-26887">How to Turn Off Power to All Devices</a>.</p><h6>Example&nbsp;10-7 SPARC: Bringing a Stand-Alone System to Run Level S</h6><p>In this example, the <tt>init</tt> command is used to bring a SPARC based
stand-alone system to run level S (single-user level).</p><pre># <tt><b>init s</b></tt>
#
INIT: New run level: S
The system is coming down for administration.  Please wait.
Unmounting remote filesystems: /vol nfs done.
Print services stopped.
syslogd: going down on signal 15
Killing user processes: done. 

SINGLE USER MODE

Root password for system maintenance (control-d to bypass): <tt><b>xxxxxx</b></tt>
single-user privilege assigned to /dev/console.
Entering System Maintenance Mode
# </pre><h6>See Also</h6><p>Regardless of why you shut down the system, you'll probably want to return
to run level 3 where all file resources are available and users
can log in. For instructions on bringing a system back to a multiuser
level, see <a href="hbsparcboot-79782.html">Chapter&nbsp;12, Booting a Solaris System (Tasks)</a>.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="etesp.html">Previous</a>
             </td>
             <td align="right">
                 <a href="hbsyshalt-33237.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

