<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Managing Solaris Patches by Using the patchadd Command (Task Map) - System Administration Guide: Basic Administration</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-12-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Basic Administration</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="glossary.html">Previous</a>
             </td>
             <td align="right">
                 <a href="fddwm.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="vol1preface-11.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="saroadmap-1.html">1.&nbsp;&nbsp;Solaris Management Tools (Road Map)</a></p>
<p class="toc level1 tocsp"><a href="smcover-1.html">2.&nbsp;&nbsp;Working With the Solaris Management Console (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ewpor.html">3.&nbsp;&nbsp;Working With the Sun Java Web Console (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="userconcept-97366.html">4.&nbsp;&nbsp;Managing User Accounts and Groups (Overview)</a></p>
<p class="toc level1 tocsp"><a href="usersetup-92366.html">5.&nbsp;&nbsp;Managing User Accounts and Groups (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="clientconcept-15236.html">6.&nbsp;&nbsp;Managing Client-Server Support (Overview)</a></p>
<p class="toc level1 tocsp"><a href="clientsetup-1.html">7.&nbsp;&nbsp;Managing Diskless Clients (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbintro-66644.html">8.&nbsp;&nbsp;Introduction to Shutting Down and Booting a System</a></p>
<p class="toc level1 tocsp"><a href="hboverview-25463.html">9.&nbsp;&nbsp;Shutting Down and Booting a System (Overview)</a></p>
<p class="toc level1 tocsp"><a href="hbsyshalt-84412.html">10.&nbsp;&nbsp;Shutting Down a System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="grubtasks-1.html">11.&nbsp;&nbsp;Modifying Solaris Boot Behavior (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbsparcboot-79782.html">12.&nbsp;&nbsp;Booting a Solaris System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbtsboot-1.html">13.&nbsp;&nbsp;Troubleshooting Booting a Solaris System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="archive-123.html">14.&nbsp;&nbsp;Managing the Solaris Boot Archives (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbsysboot-76719.html">15.&nbsp;&nbsp;x86: GRUB Based Booting (Reference)</a></p>
<p class="toc level1 tocsp"><a href="hbrunlevels-25516.html">16.&nbsp;&nbsp;Managing Services (Overview)</a></p>
<p class="toc level1 tocsp"><a href="faauf.html">17.&nbsp;&nbsp;Managing Services (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgsconcepts-52619.html">18.&nbsp;&nbsp;Managing Software (Overview)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgsgui-1.html">19.&nbsp;&nbsp;Managing Software With Solaris System Administration Tools (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgscli-1.html">20.&nbsp;&nbsp;Managing Software by Using Package Commands (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpatchtasks-1.html">21.&nbsp;&nbsp;Managing Solaris Patches by Using the <tt>patchadd</tt> Command (Tasks)</a></p>
<p class="toc level2"><a href="swmgrpatchconcepts-32371.html">Types of Patches</a></p>
<p class="toc level2"><a href="swmgrpatchconcepts-13707.html">Accessing Solaris Patches</a></p>
<p class="toc level2"><a href="swmgrpatchconcepts-30492.html">Managing Patches in the Solaris Operating System</a></p>
<p class="toc level2"><a href="glossary.html">Solaris Patch Management Terms and Definitions</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Managing Solaris Patches by Using the <tt>patchadd</tt> Command (Task Map)</a></p>
</div>
<p class="toc level1 tocsp"><a href="fddwm.html">A.&nbsp;&nbsp;SMF Services</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="swmgrpatchtasks-14"></a><h3>Managing Solaris Patches by Using the <tt>patchadd</tt> Command (Task Map)</h3>
<a name="indexterm-394"></a><table><col width="30%"><col width="41%"><col width="27%"><tr><th align="left" valign="top" scope="column"><p>Task</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>For Instructions</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>1. (Optional) Set up the package keystore.</p></td>
<td align="left" valign="top" scope="row"><p>If you
plan to apply signed patches to your system, you must first import Sun's
Root CA certificate into your package keystore.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#swmgrpatchtasks-8">How to Import a Trusted Certificate to Your Package Keystore</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>2. (Optional) Specify a web proxy.</p></td>
<td align="left" valign="top" scope="row"><p>If
your system is behind a firewall with a web proxy, you must
specify the web proxy to obtain patches from the Sun patch server.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#swmgrpatchtasks-21">How to Specify a Web Proxy</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>3. Download
and apply a patch.</p></td>
<td align="left" valign="top" scope="row"><p>You can download and apply a patch to your
system by using the <tt>patchadd</tt> command.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#swmgrpatchtasks-7">How to Download and Apply a Solaris Patch</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>4. (Optional) Display information about patches that
have been applied to your system.</p></td>
<td align="left" valign="top" scope="row"><p>If you want information about the patches that
have already been applied to your system, use the <tt>patchadd</tt>, <tt>showrev</tt>, or <tt>pkgparam</tt> command.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#swmgrpatchconcepts-30">How to Display Information About Solaris Patches</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>5.
(Optional) Remove a patch from your system.</p></td>
<td align="left" valign="top" scope="row"><p>If necessary, remove a patch from
your system by using the <tt>patchrm</tt> command.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#swmgrpatchtasks-18">How to Remove a Solaris Patch by Using the <tt>patchrm</tt> Command</a></p></td>
</tr>
</table>

<a name="swmgrpatchtasks-8"></a><h4>How to Import a Trusted Certificate to Your Package Keystore</h4><p>To apply <a href="glossary.html#glossary_signed_patch"><b> signed patches</b></a> to your system by using the <tt>patchadd</tt> command, you must
add Sun's Root CA certificate, at the very least, to verify the
signature of your signed patch. You can import this certificate from the Java
<a href="glossary.html#glossary_keystore"><b>keystore</b></a> to the package keystore.</p><ol>
<li><b>Become superuser or assume an equivalent role.</b></li>
<li><b>If you are using the <tt>patchadd</tt> command to install signed patches, add the
new trusted Verisign certificate to the keystore.</b><ol style="list-style-type: lower-alpha">
				 
<li><b>Download the Class 2 Public Primary Certification Authority - G2 trusted Verisign certificate
from <a href="http://www.sun.com/pki/certs/ca/">http://www.sun.com/pki/certs/ca/</a>.</b><p>The Subject Name of this certificate is:</p><pre>C=US, O=VeriSign, Inc., OU=Class 2 Public Primary Certification
Authority - G2, OU=(c) 1998 VeriSign, Inc. - For authorized use only,
OU=VeriSign Trust Network</pre></li>
<li><b>Select the binary format (DER encoded).</b></li>
<li><b>Copy the certificate to the file, <tt>/tmp/root.crt</tt>.</b></li></ol>
<hr><p><b>Note - </b>In the event you are unable to download the trusted Verisign certificate, see
<a href="#gdyuy">Exporting the Root CA Certificate From the Java Keystore</a> for alternate instructions.</p>
<hr>
</li>
<li><b>Import the Root CA certificate from the temporary file to the package keystore.</b><p>Unless changed by the system administrator, the default Java keystore password is <tt>changeit</tt>.</p><p>For example:</p><pre># <tt><b>pkgadm addcert -t -f der /tmp/root.crt</b></tt>
     Keystore Alias: /C=US/O=VeriSign, Inc./OU=Class 2 Public Primary Certification Authority - G2/O
        Common Name: /C=US/O=VeriSign, Inc./OU=Class 2 Public Primary Certification Authority - G2/O
   Certificate Type: Trusted Certificate 
Issuer Common Name: /C=US/O=VeriSign, Inc./OU=Class 2 Public Primary Certification Authority - G2/O
     Validity Dates: &lt;May 18 00:00:00 1998 GMT&gt; - &lt;Aug  1 23:59:59 2028 GMT&gt;
MD5 Fingerprint: 2D:BB:E5:25:D3:D1:65:82:3A:B7:0E:FA:E6:EB:E2:E1
   SHA1 Fingerprint: B3:EA:C4:47:76:C9:C8:1C:EA:F2:9D:95:B6:CC:A0:08:1B:67:EC:9D

Are you sure you want to trust this certificate? <tt><b>yes</b></tt>
Trusting certificate &lt;/C=US/O=VeriSign, Inc./OU=Class 2 Public Primary Certification Authority - G2/O&gt;
Type a Keystore protection Password. <tt><b>changeit</b></tt>
Press ENTER for no protection password (not recommended):
For Verification: Type a Keystore protection Password.
Press ENTER for no protection password (not recommended):
Certificate(s) from &lt;/tmp/root.crt&gt; are now trusted </pre><dl><dt><tt>-t</tt></dt>
<dd><p>Indicates that the certificate is a trusted CA certificate. The command output includes the certificate details, which you are asked to verify.</p></dd>
<dt><tt>-f</tt> <i>format</i></dt>
<dd><p>Specifies the format of the certificate or private key. When importing a certificate, it must be encoded using either the PEM (<tt>pem</tt>) or binary DER (<tt>der</tt>) format.</p></dd>
<dt><i>certfile</i></dt>
<dd><p>Specifies the file that contains the certificate.</p></dd>
</dl>
</li>
<li><b>Display the certificate information.</b><pre># <tt><b>pkgadm listcert</b></tt>
Enter Keystore Password: <i>storepass</i>
     Keystore Alias: /C=US/O=VeriSign, Inc./OU=Class 2 Public Primary Certification Authority - G2/O
        Common Name: /C=US/O=VeriSign, Inc./OU=Class 2 Public Primary Certification Authority - G2/O
   Certificate Type: Trusted Certificate
Issuer Common Name: /C=US/O=VeriSign, Inc./OU=Class 2 Public Primary Certification Authority - G2/O
Validity Dates: &lt;May 18 00:00:00 1998 GMT&gt; - &lt;Aug 1 23:59:59 2028 GMT&gt;
 MD5 Fingerprint: 2D:BB:E5:25:D3:D1:65:82:3A:B7:0E:FA:E6:EB:E2:E1
   SHA1 Fingerprint: B3:EA:C4:47:76:C9:C8:1C:EA:F2:9D:95:B6:CC:A0:08:1B:67:EC:9D</pre></li>
<li><b>Remove the temporary file.</b><pre># <tt><b>rm /tmp/root.crt</b></tt></pre></li></ol>

<a name="gdyuy"></a><h4>Exporting the Root CA Certificate From the Java Keystore</h4>
<p>If you are unable to download the trusted Verisign certificate from <a href="http://www.sun.com/pki/certs/ca/">http://www.sun.com/pki/certs/ca/</a>,
as described in Step 2 of <a href="#swmgrpatchtasks-8">How to Import a Trusted Certificate to Your Package Keystore</a>, you can export the Root CA
certificate from the Java keystore to a temporary file.</p><p>For example:</p><pre># <tt><b>keytool -export -storepass changeit -alias verisignclass2g2ca \ -keystore /usr/java/jre/lib/security/cacerts -file /tmp/root.crt</b></tt>
Certificate stored in file &lt;/tmp/root.crt&gt;</pre><dl><dt><tt>-export</tt></dt>
<dd><p>Exports the trusted certificate.</p></dd>
<dt><tt>-storepass</tt> <i>storepass</i></dt>
<dd><p>Specifies the password that protects the integrity of the Java keystore.</p></dd>
<dt><tt>-alias</tt> <tt>verisignclass2g2ca</tt></dt>
<dd><p>Identifies the alias of the trusted certificate.</p></dd>
<dt><tt>-keystore</tt> <i>certfile</i></dt>
<dd><p>Specifies the name and location of the keystore file.</p></dd>
<dt><tt>-file</tt> <i>filename</i></dt>
<dd><p>Identifies the file in which to hold the exported certificate.</p></dd>
</dl>
<p>You are now ready to import the Root CA certificate from the
temporary file to the package keystore. See the remaining steps in the section,
<a href="#swmgrpatchtasks-8">How to Import a Trusted Certificate to Your Package Keystore</a>, for instructions.</p>

<a name="swmgrpatchtasks-21"></a><h4>How to Specify a Web Proxy</h4><p>If your system is behind a firewall with a web proxy, you
must specify the web proxy to use <tt>patchadd</tt> to <a href="glossary.html#glossary_apply"><b>apply</b></a> a patch.</p><ol>
<li><b>Become superuser or assume an equivalent role.</b></li>
<li><b>Use one of the following methods to specify a web proxy:</b>
<ul><li><p>Specify the web proxy by using the <tt>http_proxy</tt>, <tt>HTTPPROXY</tt>, or <tt>HTTPPROXYPORT</tt> environment variable.</p><p>For example:</p><pre># <tt><b>setenv http_proxy http:</b></tt><i>//mycache.domain:8080</i></pre><p>Or, specify one of the following:</p><pre># <tt><b>setenv HTTPPROXY</b></tt> <i>mycache.domain</i>
# <tt><b>setenv HTTPPROXYPORT</b></tt> <i>8080</i></pre></li>
<li><p>Specify the web proxy on the <tt>patchadd</tt> command line.</p><p>For example:</p><pre># <tt><b>patchadd -x mycache.domain:8080 \ -M http://www.sun.com/solaris/patches/latest 101223-02 102323-02</b></tt></pre></li></ul>
</li></ol>

<a name="gdytw"></a><h4>Restrictions on Using <tt>patchadd -R</tt> to Create an Alternate <tt>root</tt> Path</h4>
<p>On systems that are running a Solaris release that is not zones
aware, using the <tt>patchadd</tt> command, or any command that accepts the <tt>-R</tt> option to
specify an alternate <tt>root</tt> path for a global zone that has non-global zones
installed, does not work.</p><p>You can use of the <tt>-R</tt> option to add and remove software packages
and patches, if the alternate boot environment has configured non-global zones, but no
installed non-global zones.</p><p>To avoid a potential problem, restrict the use of the <tt>-R</tt> option for
the creation of an alternate root path.</p><p>If you are running this Solaris release, you can alternately choose one of
the following methods:</p>
<ul><li><p>Upgrade any systems that are not running the current Solaris release.</p></li>
<li><p>Boot an alternate root as the active OS.</p></li></ul>
<p>If you are running the Solaris 10 OS, you can alternately choose
one of the following methods:</p>
<ul><li><p>Upgrade any systems that are not running at least the Solaris 10 1/06 OS to the Solaris 10 1/06 release.</p></li>
<li><p>If you are running the Solaris 10 initial 3/05 release, you can install the following patch to enable the use of commands that accept the <tt>-R</tt> option for creation of an alternate root path.</p>
<ul><li><p><b>For SPARC based systems</b> &ndash; Install at least revision 19 of patch 119254.</p></li>
<li><p><b>For x86 based systems</b> &ndash; Install at least revision 19 patch 119255.</p></li></ul>
</li>
<li><p>Boot an alternate root, for example the Solaris 10 release, as the active OS. You can then install and uninstall packages and patches without using the <tt>-R</tt> option.</p></li></ul>
<p>For more information, see the <a href="http://docs.sun.com/doc/819-2240/patchadd-1m?a=view"><tt>patchadd</tt>(1M)</a>, <a href="http://docs.sun.com/doc/819-2240/patchrm-1m?a=view"><tt>patchrm</tt>(1M)</a>, <a href="http://docs.sun.com/doc/819-2240/pkgadd-1m?a=view"><tt>pkgadd</tt>(1M)</a>, and <a href="http://docs.sun.com/doc/819-2240/pkgrm-1m?a=view"><tt>pkgrm</tt>(1M)</a> man pages.</p>

<a name="swmgrpatchtasks-7"></a><h4>How to Download and Apply a Solaris Patch</h4><a name="indexterm-395"></a><p>Use this procedure to <a href="glossary.html#glossary_download"><b>download</b></a> either a signed or an <a href="glossary.html#glossary_unsigned_patch"><b>unsigned Solaris patch</b></a> and then
apply it to your system.</p><p>If you want to apply signed patches, you must first set up
the package keystore.</p><ol>
<li><b>Gain access to the system in one of the following ways:</b><ul>
<li><b>Log in to the system where you want to apply the patch.</b></li>
<li><b>Download the patch and use the <tt>ftp</tt> command to copy the patch to
the target system.<a name="indexterm-396"></a><a name="indexterm-397"></a></b></li></ul></li>
<li><b>Start a web browser and go to the SunSolve Online Patch Portal at
<a href="http://sunsolve.Sun.COM">http://sunsolve.Sun.COM</a>.</b></li>
<li><b>Determine whether to download a specific patch or a patch cluster, then do
one of the following:</b><ul>
<li><b>Type the patch number (<i>patch-id</i>) in the Find Patch search field, then click
Find Patch.</b><p>Entering <i>patch-id</i> downloads the latest patch revision.</p><p>If this patch is freely available, the patch README appears. If this patch
is not freely available, an <tt>ACCESS DENIED</tt> message appears.</p><p>Note that patch numbers for SPARC based and x86 based systems are
different. The <a href="glossary.html#glossary_patch_id"><b>patch IDs</b></a> are listed in the patch README. Ensure that you apply the
patch that matches your system architecture.</p></li>
<li><b>Select the Recommended Patch Cluster that matches the Solaris release that is running
on the system that you want to patch.</b></li></ul></li>
<li><b>Download the patch by following these instructions:</b><ul>
<li><b>To download a copy of the signed patch, click the Download Signed Patch
(<i>n</i> bytes) button.</b></li>
<li><b>To download an unsigned patch, click the Download Patch (<i>n</i> bytes) button.</b></li></ul><p>When the patch or patches are successfully downloaded, close the web browser.</p></li>
<li><b>Change to the directory that contains the downloaded patch.</b></li>
<li><b>Become superuser or assume an equivalent role.</b></li>
<li><b>(<b>Unsigned patch</b>) If you downloaded an unsigned patch, unzip the patch.</b><pre># <tt><b>unzip </tt><i>patch-id</i><tt></b></tt></pre></li>
<li><b>Apply the signed or unsigned patch.</b>
<ul><li><p>If you downloaded a signed patch, apply it.</p><p>For example:</p><pre># <tt><b>patchadd /tmp/111879-01.jar</b></tt></pre></li>
<li><p>If you downloaded an unsigned patch, apply it.</p><p>For example:</p><pre># <tt><b>patchadd /tmp/111879-01</b></tt></pre></li></ul>
</li>
<li><b>Verify that the patch has been successfully applied.</b><p>For example:</p><pre># <tt><b>patchadd -p | grep 111879</b></tt>
Patch: 111879-01 Obsoletes:  Requires:  Incompatibles:  Packages: SUNWwsr</pre></li></ol>

<a name="swmgrpatchconcepts-30"></a><h4>How to Display Information About Solaris Patches</h4><a name="indexterm-398"></a><a name="indexterm-399"></a><a name="indexterm-400"></a><a name="indexterm-401"></a><p>Before applying patches, you might want to know more about patches that have
been previously applied.</p><p>The following commands provide useful information about patches that are already applied to
a system.</p>
<ul><li><p><tt>patchadd -p</tt> or <tt>showrev -p</tt></p><p>Shows all patches that have been applied to the system.</p></li>
<li><p><tt>pkgparam</tt> <i>pkgid</i> <tt>PATCHLIST</tt></p><p>Shows all patches that have been applied to the package identified by <b>pkgid</b>, for example, <tt>SUNWadmap</tt>.</p></li>
<li><p><tt>patchadd -S</tt> <i>Solaris-OS</i> <tt>-p</tt></p><p>Shows all the <tt>/usr</tt> patches that have been applied to an OS server.</p></li></ul>
<ul>
<li><b>Use one of the following <tt>patchadd</tt> command lines to display information about patches
that have been applied to your system.</b>
<ul><li><p>To obtain information about all patches that have been applied to your system, type:</p><pre>$ <tt><b>patchadd -p</b></tt></pre></li>
<li><p>To verify whether a particular patch has been applied to your system, type, for example:</p><pre>$ <tt><b>patchadd -p | grep 111879</b></tt></pre></li></ul>
</li></ul>

<a name="swmgrpatchtasks-18"></a><h4>How to Remove a Solaris Patch by Using the <tt>patchrm</tt> Command</h4><a name="indexterm-402"></a><ol>
<li><b>Become superuser.</b></li>
<li><b>Remove the patch.</b><pre># <tt><b>patchrm 111879-01</b></tt>
Checking installed patches...

Backing out patch 111879-01...

Patch 111879-01 has been backed out.</pre></li>
<li><b>Verify that the patch was removed.</b><pre># <tt><b>patchadd -p | grep 111879</b></tt>
#</pre></li></ol>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="glossary.html">Previous</a>
             </td>
             <td align="right">
                 <a href="fddwm.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

