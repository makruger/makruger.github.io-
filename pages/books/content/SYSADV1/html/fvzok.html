<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Booting an x86 Based System from the Network - System Administration Guide: Basic Administration</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-12-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Basic Administration</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ghsut.html">Previous</a>
             </td>
             <td align="right">
                 <a href="hbtsboot-1.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="vol1preface-11.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="saroadmap-1.html">1.&nbsp;&nbsp;Solaris Management Tools (Road Map)</a></p>
<p class="toc level1 tocsp"><a href="smcover-1.html">2.&nbsp;&nbsp;Working With the Solaris Management Console (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ewpor.html">3.&nbsp;&nbsp;Working With the Sun Java Web Console (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="userconcept-97366.html">4.&nbsp;&nbsp;Managing User Accounts and Groups (Overview)</a></p>
<p class="toc level1 tocsp"><a href="usersetup-92366.html">5.&nbsp;&nbsp;Managing User Accounts and Groups (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="clientconcept-15236.html">6.&nbsp;&nbsp;Managing Client-Server Support (Overview)</a></p>
<p class="toc level1 tocsp"><a href="clientsetup-1.html">7.&nbsp;&nbsp;Managing Diskless Clients (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbintro-66644.html">8.&nbsp;&nbsp;Introduction to Shutting Down and Booting a System</a></p>
<p class="toc level1 tocsp"><a href="hboverview-25463.html">9.&nbsp;&nbsp;Shutting Down and Booting a System (Overview)</a></p>
<p class="toc level1 tocsp"><a href="hbsyshalt-84412.html">10.&nbsp;&nbsp;Shutting Down a System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="grubtasks-1.html">11.&nbsp;&nbsp;Modifying Solaris Boot Behavior (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbsparcboot-79782.html">12.&nbsp;&nbsp;Booting a Solaris System (Tasks)</a></p>
<p class="toc level2"><a href="hbsparcboot-69.html">Booting a SPARC Based System (Task Map)</a></p>
<p class="toc level2"><a href="hbsparcboot-9.html">Booting a SPARC Based System</a></p>
<p class="toc level2"><a href="ggqhf.html">Booting From a ZFS Root File System on a SPARC Based System</a></p>
<p class="toc level2"><a href="ggqqq.html">Booting the Failsafe Archive on a SPARC Based System</a></p>
<p class="toc level2"><a href="hbsparcboot-60.html">Booting a SPARC Based System From the Network</a></p>
<p class="toc level2"><a href="hbx86boot-68676.html">Booting an x86 Based System by Using GRUB (Task Map)</a></p>
<p class="toc level2"><a href="ggqaa.html">Booting From a ZFS Root File System on an x86 Based System</a></p>
<p class="toc level2"><a href="ggqdn.html">Booting the Failsafe Archive on an x86 Based System</a></p>
<p class="toc level2"><a href="ghsut.html">Using Fast Reboot on the x86 Platform (Task Map)</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Booting an x86 Based System from the Network</a></p>
</div>
<p class="toc level1 tocsp"><a href="hbtsboot-1.html">13.&nbsp;&nbsp;Troubleshooting Booting a Solaris System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="archive-123.html">14.&nbsp;&nbsp;Managing the Solaris Boot Archives (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbsysboot-76719.html">15.&nbsp;&nbsp;x86: GRUB Based Booting (Reference)</a></p>
<p class="toc level1 tocsp"><a href="hbrunlevels-25516.html">16.&nbsp;&nbsp;Managing Services (Overview)</a></p>
<p class="toc level1 tocsp"><a href="faauf.html">17.&nbsp;&nbsp;Managing Services (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgsconcepts-52619.html">18.&nbsp;&nbsp;Managing Software (Overview)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgsgui-1.html">19.&nbsp;&nbsp;Managing Software With Solaris System Administration Tools (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgscli-1.html">20.&nbsp;&nbsp;Managing Software by Using Package Commands (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpatchtasks-1.html">21.&nbsp;&nbsp;Managing Solaris Patches by Using the <tt>patchadd</tt> Command (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fddwm.html">A.&nbsp;&nbsp;SMF Services</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="fvzok"></a><h3>Booting an x86 Based System from the Network</h3>
<a name="indexterm-217"></a><a name="indexterm-218"></a><a name="indexterm-219"></a><a name="indexterm-220"></a><a name="indexterm-221"></a><p>This section describes the requirements and warnings for performing a GRUB based boot
from the network.</p><p>Any system can boot from the network, if a boot server is
available. You might need to boot a stand-alone system from the network for
recovery purposes if the system cannot boot from the local disk. You can
boot a Solaris OS x86 based system directly from a network that supports
the PXE network boot protocol.</p>
<hr><p><b>Note - </b>The PXE network boot is available only for devices that implement the Intel
Preboot Execution Environment specification.</p>
<hr>
<p>The default network boot strategy  that is used for a GRUB
based PXE network boot is DHCP. For non-PXE devices, you can use either
the DHCP or the RARP boot strategy. The strategy that you use depends
on which type of boot server is available on your network. If no
PXE or DHCP server is available, you can load GRUB from a diskette,
a CD-ROM, or a local disk.</p><p>To perform a GRUB based network boot, a DHCP server that is
configured for PXE clients is required. A boot server that provides <tt>tftp</tt> service is
also required. The DHCP server supplies the information that the client needs to
configure its network interface.</p><p>The DHCP server must be able to respond to the DHCP classes,
<tt>PXEClient</tt> and <tt>GRUBClient</tt> with the following information:</p>
<ul><li><p>IP address of the file server</p></li>
<li><p>Name of the boot file (<tt>pxegrub</tt>)</p></li></ul>
<p>The sequence for performing a PXE network boot of the Solaris OS
is as follows:</p>
<ol><li><p>The BIOS is configured to boot from a network interface.</p></li>
<li><p>The BIOS sends a DHCP request.</p></li>
<li><p>The DHCP server replies with the server address and the name of the boot file.</p></li>
<li><p>The BIOS downloads <tt>pxegrub</tt> by using <tt>tftp</tt> and executes <tt>pxegrub</tt>.</p></li>
<li><p>The system downloads a GRUB menu file by using <tt>tftp</tt>.</p><p>This file displays the boot menu entries that are available.</p></li>
<li><p>After you select a menu entry, the system begins to load the Solaris OS.</p></li></ol>
<p><a name="indexterm-222"></a><a name="indexterm-223"></a>See <a href="http://docs.sun.com/doc/819-3000/ipconfig-79?a=view">How to Set Up a Network Configuration Server in <i>System Administration Guide: IP Services</i></a> for more information.</p><p>Running the <tt>add_install_client</tt> command creates the <tt>/tftpboot_01</tt><i>ethernet-address</i> file. This file is linked to
<tt>pxegrub</tt> and the<tt>/tftpboot/menu.lst.01</tt><i>ethernet-address</i> file. The <tt>/tftpboot/menu.lst.01</tt><i>ethernet-address</i> file is the GRUB menu file. If
this file does not exist, then <tt>pxegrub</tt> reverts to using DHCP Option 150,
if this option is specified, or the <tt>/tftpboot/boot/grub/menu.lst</tt> file. Typically, a single
system is set up to serve both functions. In this instance, the <tt>add_install_client</tt>
command sets up the <tt>/tftpboot</tt> file with the correct <tt>pxegrub</tt> menu file and the
Solaris files. DHCP service is handled separately by using the <tt>add_install_client</tt> command.
The setup only needs to be completed once per client. See <a href="#fwfdk">x86: About DHCP Macros</a> and
<a href="#fvzpk">x86: How to Perform a GRUB Based Boot From the Network</a> for more information.</p>

<a name="fwfdk"></a><h4>x86: About DHCP Macros</h4>
<a name="indexterm-224"></a><a name="indexterm-225"></a><a name="indexterm-226"></a><a name="indexterm-227"></a><p>When you add clients with the <tt>add_install_client</tt> <tt>-d</tt> script on the install
server, the script reports DHCP configuration information to standard output. You can use
this information when you create the options and macros that are needed to
pass network installation information to clients. </p><p>To install DHCP clients with a DHCP server over the network, you
must create DHCP options. This information is needed to install the Solaris OS.
</p><p>When a client sends a DHCP request, the server must have the
following client information:</p>
<ul><li><p>Client's ID, which is typically the Ethernet address</p></li>
<li><p>Class of the client request</p></li>
<li><p>Subnet the client resides on</p></li></ul>
<p>The Solaris DHCP server forms a response. This response is based on the
following <b>macros</b>, which matches the client request:<a name="indexterm-228"></a></p><dl><dt><b>class macro</b></dt>
<dd><p>The class macro is based on a <b>class string</b> that is contained in the DHCP request. On x86 based systems, the BIOS already makes a DHCP request with the class <tt>PXEClient:Arch:00000:UNDI:002001</tt>. If a macro by this name is defined in the DHCP server configuration, then the macro content is sent to the x86 based clients.</p></dd>
<dt><b>network macro</b></dt>
<dd><p><a name="indexterm-229"></a>The network macro is named by the IP address of the subnet that the client resides on. If the macro <tt>129.146.87.0</tt> is defined on the DHPC server, the macro content is sent to all clients on that subnet. The macro content is sent, regardless of the class of the request. If an option is defined in both the class macro and the network macro, the network macro takes precedence.</p></dd>
<dt><b>IP macro</b></dt>
<dd><p><a name="indexterm-230"></a>The IP macro is named by an IP address. This macro is rarely used</p></dd>
<dt><b>client macro</b></dt>
<dd><p><a name="indexterm-231"></a>The client macro is named by the client type (01 for Ethernet) and the mac address of the client, in uppercase letters. For a client with the Ethernet address <tt>0:0:39:fc:f2:ef</tt>, the corresponding macro name is <tt>01000039FCEF</tt>. Note the absence of colons in the client macro.</p></dd>
</dl>
<p>For example, for a client on the subnet <tt>192.168.100.0</tt>, with the Ethernet address
<tt>0:0:39:fc:f2:ef</tt>, making a DHCP request of class <tt>PXEClient</tt>, the DHCP server has the
following matching macro:</p><pre>PXEClient
    BootSrvA:  192.168.100.0
    BootFile:  pxegrub
  129.146.87.0
    Router:    129.146.87.1
    NISdmain:  sunsoft.eng.sun.com
  01000039FCEF
    BootFile:  01000039FCEF
The actual DHCP response will be
    BootSrvA:  192.168.100.0
    BootFile:  01000039FCEF
    Router:    129.146.87.1
    NISdmain:  sunsoft.eng.sun.com</pre><p>Note that the <tt>BootFile</tt> in the client macro overrides the <tt>BootFile</tt> in the
class macro. </p><p>For more detailed information, see <a href="http://docs.sun.com/doc/819-2394/dhcp-admin-38?a=view">Preconfiguring System Configuration Information With the DHCP Service (Tasks) in <i>Solaris Express Installation Guide: Network-Based Installations</i></a>.</p>

<a name="fvzpk"></a><h4>x86: How to Perform a GRUB Based Boot From the Network</h4><p>To perform a GRUB based network boot a DHCP server that is
configured for PXE clients is required.  A boot server that provides <tt>tftp</tt>
service is also required. The DHCP server must be able respond to the
DHCP classes, <tt>PXEClient</tt> and <tt>GRUBClient</tt> to obtain the IP address of the file
server and the boot file (<tt>pxegrub</tt>). By default, the menu file is <tt>/tftpboot/menu.lst.01</tt><i>ethernet-address</i><tt></tt>. If
this file does not exist, then <tt>pxegrub</tt> reverts to DHCP Option 150, if
this option is specified, or the <tt>/tftpboot/boot/grub/menu.lst</tt> file.</p><p>If you are booting the system from the Solaris Software 1 CD
or DVD, the system boots automatically.</p><h6>Before You Begin</h6><p>Before performing a network boot on an x86 based system with GRUB,
do the following:</p>
<ul><li><p>Run the appropriate commands on the installation server to enable the system to boot from the network.</p></li>
<li><p>Add the client system as an install client.</p></li></ul>
<p>See <a href="http://docs.sun.com/doc/819-2394/netinstalloverview-28995?a=view">Chapter 4, Installing From the Network (Overview), in <i>Solaris Express Installation Guide: Network-Based Installations</i></a> for more information.</p><ol>
<li><b>On the DHCP server, create a client macro for the DHCP service with
the following two options:</b>
<ul><li><p><tt>BootSrvA</tt>: <i>svr-addr</i></p></li>
<li><p><tt>BootFile</tt>: <i>client-macro</i></p><p>Note that you must have superuser privileges on the DHCP server to run the <tt>dhtadm</tt> command.</p><p>where <i>svr-addr</i> is the IP address of the server, and <i>client-macro</i> is named by the client's Ethernet type (01) and the mac address, in uppercase letters. This number is also the name of the file that is used in the <tt>/tftpboot</tt> directory on the installation server.</p>
<hr><p><b>Note - </b>The notation for the <i>client-macro</i> should not contain any colons.</p>
<hr>
<p>You can create the client macro from the DHCP GUI or from command-line interface.</p><p>To create the client macro from the command-line, type:</p><pre># <tt><b>dhtadm -[MA] -m </tt><i>client macro</i><tt> -d ":BootFile=</tt><i>client-macro</i><tt>:BootSrvA=</tt><i>svr-addr:</i><tt>"</b></tt></pre></li></ul>
</li>
<li><a name="fvzqv"></a><b>Reboot the system.</b></li>
<li><b>Instruct the BIOS to boot from the network.</b>
<ul><li><p>If your system uses a specific keystroke sequence to boot from the network, type the keystrokes when the BIOS screen is displayed.</p></li>
<li><p>If you need to manually modify the BIOS settings to boot from the network, type the keystroke sequence to access the BIOS setup utility. Then, modify the boot priority to boot from the network.</p></li></ul>
</li>
<li><b>When the GRUB menu is displayed, select the network installation image that you
want to install.</b></li></ol>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ghsut.html">Previous</a>
             </td>
             <td align="right">
                 <a href="hbtsboot-1.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

