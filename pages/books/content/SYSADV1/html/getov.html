<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Modifying Solaris Boot Behavior on x86 Based Systems (Task Map) - System Administration Guide: Basic Administration</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-12-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Basic Administration</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ggkuh.html">Previous</a>
             </td>
             <td align="right">
                 <a href="hbsparcboot-79782.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="vol1preface-11.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="saroadmap-1.html">1.&nbsp;&nbsp;Solaris Management Tools (Road Map)</a></p>
<p class="toc level1 tocsp"><a href="smcover-1.html">2.&nbsp;&nbsp;Working With the Solaris Management Console (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ewpor.html">3.&nbsp;&nbsp;Working With the Sun Java Web Console (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="userconcept-97366.html">4.&nbsp;&nbsp;Managing User Accounts and Groups (Overview)</a></p>
<p class="toc level1 tocsp"><a href="usersetup-92366.html">5.&nbsp;&nbsp;Managing User Accounts and Groups (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="clientconcept-15236.html">6.&nbsp;&nbsp;Managing Client-Server Support (Overview)</a></p>
<p class="toc level1 tocsp"><a href="clientsetup-1.html">7.&nbsp;&nbsp;Managing Diskless Clients (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbintro-66644.html">8.&nbsp;&nbsp;Introduction to Shutting Down and Booting a System</a></p>
<p class="toc level1 tocsp"><a href="hboverview-25463.html">9.&nbsp;&nbsp;Shutting Down and Booting a System (Overview)</a></p>
<p class="toc level1 tocsp"><a href="hbsyshalt-84412.html">10.&nbsp;&nbsp;Shutting Down a System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="grubtasks-1.html">11.&nbsp;&nbsp;Modifying Solaris Boot Behavior (Tasks)</a></p>
<p class="toc level2"><a href="ggkuh.html">Modifying Boot Behavior on SPARC Based Systems (Task Map)</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Modifying Solaris Boot Behavior on x86 Based Systems (Task Map)</a></p>
</div>
<p class="toc level1 tocsp"><a href="hbsparcboot-79782.html">12.&nbsp;&nbsp;Booting a Solaris System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbtsboot-1.html">13.&nbsp;&nbsp;Troubleshooting Booting a Solaris System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="archive-123.html">14.&nbsp;&nbsp;Managing the Solaris Boot Archives (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbsysboot-76719.html">15.&nbsp;&nbsp;x86: GRUB Based Booting (Reference)</a></p>
<p class="toc level1 tocsp"><a href="hbrunlevels-25516.html">16.&nbsp;&nbsp;Managing Services (Overview)</a></p>
<p class="toc level1 tocsp"><a href="faauf.html">17.&nbsp;&nbsp;Managing Services (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgsconcepts-52619.html">18.&nbsp;&nbsp;Managing Software (Overview)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgsgui-1.html">19.&nbsp;&nbsp;Managing Software With Solaris System Administration Tools (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgscli-1.html">20.&nbsp;&nbsp;Managing Software by Using Package Commands (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpatchtasks-1.html">21.&nbsp;&nbsp;Managing Solaris Patches by Using the <tt>patchadd</tt> Command (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fddwm.html">A.&nbsp;&nbsp;SMF Services</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="getov"></a><h3>Modifying Solaris Boot Behavior on x86 Based Systems (Task Map)</h3>
<a name="indexterm-141"></a><a name="indexterm-142"></a><a name="getny"></a><h6>Table&nbsp;11-1 x86: Modifying Boot Behavior: Task Map</h6><table><col width="33%"><col width="33%"><col width="33%"><tr><th align="left" valign="top" scope="column"><p>Task</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>For Information</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Set
boot file parameters by using the <tt>eeprom</tt> command.</p></td>
<td align="left" valign="top" scope="row"><p>Modify boot behavior on an
x86 based system by using the <tt>eeprom</tt> command. Boot options that are set
by using the <tt>eeprom</tt> command persist over a system reboot, unless these options
are overridden by modifying kernel behavior in the GRUB menu at boot time.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#fwbon">x86: How to Modify Boot Behavior by Using the <tt>eeprom</tt> Command</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Modify
boot behavior by editing the GRUB menu at boot time.</p></td>
<td align="left" valign="top" scope="row"><p>Modify boot behavior
by editing GRUB menu at boot time. Boot options that are specified by
modifying the boot behavior in the GRUB menu persist only until the next
system reboot.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#fwbme">x86: How to Modify Boot Behavior by Editing the GRUB Menu at Boot Time</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Modify boot behavior by manually editing the <tt>menu.lst</tt> file.</p></td>
<td align="left" valign="top" scope="row"><p>Modify boot behavior
by editing the <tt>menu.lst</tt> configuration file to add new OS entries or redirect
the console. Changes you make to the file persist over system reboots.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#fvbbb">x86: How to Modify Boot Behavior by Editing the <tt>menu.lst</tt> File</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Modify the <tt>menu.lst</tt>
file to include entries that support the <tt>findroot</tt> command.</p></td>
<td align="left" valign="top" scope="row"><p>Additional menu entries that use
the <tt>findroot</tt> command can be added to the <tt>menu.lst</tt> file menu after an
installation or upgrade.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#ggvms">x86: How to Add GRUB Menu Entries That Use the <tt>findroot</tt> Command</a></p></td>
</tr>
</table>

<a name="fwbee"></a><h4>Modifying Boot Behavior on x86 Based Systems</h4>
<a name="indexterm-143"></a><a name="indexterm-144"></a><p>The primary methods for modifying boot behavior on an x86 based system are
as follows:</p>
<ul><li><p>By using the <tt>eeprom</tt> command.</p><p>The <tt>eeprom</tt> command is used to assign a different value to a standard set of properties. These values, which are equivalent to the SPARC OpenBoot PROM NVRAM variables, are stored either in the <tt>/boot/solaris/bootenv.rc</tt> file or in the <tt>menu.lst</tt> file. Changes that are made to boot behavior by using the <tt>eeprom</tt> command persist over each system reboot and are preserved during a software upgrade. See the <a href="http://docs.sun.com/doc/819-2240/eeprom-1m?a=view"><tt>eeprom</tt>(1M)</a> man page for more information.</p>
<hr><p><b>Caution - </b>If you directly edit the <tt>menu.lst</tt> file, certain boot properties (boot-file, boot-args, and console) may not be changed at a later time by using the <tt>eeprom</tt> command.</p>
<hr>
</li>
<li><p>By editing the GRUB menu at boot time.</p><p>Changes that are made by modifying the GRUB kernel behavior at boot time override options that you set by using the <tt>eeprom</tt> command. However, these changes only remain in effect until the next time you boot the system. See the <a href="http://docs.sun.com/doc/819-2240/kernel-1m?a=view"><tt>kernel</tt>(1M)</a> man page for more information.</p></li>
<li><p>By manually editing the GRUB <tt>menu.lst</tt> file.</p>
<hr><p><b>Caution - </b>Any system generated changes made to <tt>menu.lst</tt> entries are changed or lost during a system upgrade. However, any new boot entries that you manually added remain after an upgrade. You can override <tt>eeprom</tt> settings by editing the GRUB menu at boot time or by editing the <tt>menu.lst</tt> file. Changes made by editing the GRUB menu at boot time do not persist. Changes that are made to <tt>menu.lst</tt> file persist over system reboots.</p>
<hr>
</li></ul>


<a name="fwbon"></a><h5>x86: How to Modify Boot Behavior by Using the <tt>eeprom</tt> Command</h5>
<a name="indexterm-145"></a><a name="indexterm-146"></a><p>You can display or set boot parameters by using the <tt>eeprom</tt> command. These
parameters are found in the <tt>/boot/solaris/bootenv.rc</tt> file. Changes that are made by using
the <tt>eeprom</tt> command persist over a system reboot. You can override <tt>eeprom</tt> settings by
editing the GRUB menu at boot time to specify alternative boot behavior.</p><p>See <a href="#fwbme">x86: How to Modify Boot Behavior by Editing the GRUB Menu at Boot Time</a>. For more information about changes to the <tt>eeprom</tt> command in this
release, see the <a href="http://docs.sun.com/doc/819-2240/eeprom-1m?a=view"><tt>eeprom</tt>(1M)</a> man page.</p><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><b>To change the specified parameter, type the <tt>eeprom</tt> command with the appropriate arguments
.</b><pre># <tt><b>eeprom </tt><i>parameter</i><tt>=</tt><i>new-value</i><tt></b></tt></pre></li>
<li><b>Verify that the new parameter has been set.</b><pre># <tt><b>eeprom </tt><i>parameter</i><tt></b></tt></pre><p>The output should display the new <tt>eeprom</tt> value for the specified parameter.</p></li></ol><a name="fwbps"></a><h6>Example&nbsp;11-3 x86: Setting <tt>boot-file</tt> Parameters by Using the <tt>eeprom</tt> Command</h6><p>This example shows how to manually specify that the system boot a
64-bit kernel. Note that the system must support 64-bit computing.</p><pre># <tt><b>eeprom boot-file=kernel/amd64/unix</b></tt></pre><p>This example shows how to manually boot a 32-bit kernel on a
64-bit capable system.</p><pre># <tt><b>eeprom boot-file=kernel/unix</b></tt></pre><p>This example shows how to restore the default auto detected boot behavior on
a system.</p><pre># <tt><b>eeprom boot-file=""</b></tt></pre>

<a name="fwbqs"></a><h4>x86: Modifying Boot Behavior by Editing the GRUB Menu at Boot Time</h4>
<a name="indexterm-147"></a><a name="indexterm-148"></a><a name="indexterm-149"></a><p>The following is an example of a GRUB main menu in a
Solaris release that supports booting a system from a ZFS root file system.
This menu is based on the contents of the <tt>menu.lst</tt> configuration file and includes
menu entries for all of the bootable OS instances on the system. The
first entry in the menu is the default, unless otherwise specified. To specify
another boot entry as the default, add the <tt>default=</tt><i>n</i> command to the
<tt>menu.lst</tt> file, where <i>n</i> is a number, starting from 0 (the first
boot entry).</p><pre>GNU GRUB  version 0.95  (637K lower / 3144640K upper memory)
 +-------------------------------------------------------------------------+
be1)
be1 failsafe
be3
be3 failsafe
be2
be2 failsafe
+-------------------------------------------------------------------------+
      Use the ^ and v keys to select which entry is highlighted.
      Press enter to boot the selected OS, 'e' to edit the
      commands before booting, or 'c' for a command-line.</pre>
<hr><p><b>Note - </b>The information that is contained in the <tt>menu.lst</tt> file varies, depending on the
Solaris release and the installation method that was used.</p>
<hr>
<p>To edit a boot entry in the GRUB menu, use the arrow
keys to select the entry, then type <tt>e</tt>.</p><pre>GNU GRUB  version 0.95  (637K lower / 3144640K upper memory)
 +-------------------------------------------------------------------------+
findroot (BE_be1,0,a)
bootfs rpool/ROOT/szboot_0508
kernel$ /platform/i86pc/kernel/$ISADIR/unix -B $ZFS-BOOTFS 
module$ /platform/i86pc/$ISADIR/boot_archive
 +-------------------------------------------------------------------------+
      Use the ^ and v keys to select which entry is highlighted.
      Press enter to boot the selected OS, 'e' to edit the
      commands before booting, or 'c' for a command-line.</pre><p>For instructions on editing the GRUB menu at boot time, see <a href="#fwbme">x86: How to Modify Boot Behavior by Editing the GRUB Menu at Boot Time</a>.</p>

<a name="ghchp"></a><h4>Description of the GRUB Edit Menu</h4>
<p>The following examples show the edit menu in the various GRUB implementations:</p><p><b>GRUB ZFS Support:</b></p><pre>grub edit&gt; kernel$ /platform/i86pc/kernel/$ISADIR/unix -B $ZFS-BOOTFS,<i>prop=value</i> [,<i>prop=value</i>...]][-asrvxk]
[-m <i>smf-options</i>] [-i altinit]</pre>
<hr><p><b>Note - </b>When adding boot arguments on a system with ZFS support, any additional
<tt>-B</tt> options should be added after the default <tt>-B</tt> <tt>$ZFS-BOOTFS</tt> argument.</p>
<hr>
<p><b>GRUB hypervisor Support:</b></p><pre>grub edit&gt; module$ /platform/i86xpv/$ISADIR/unix /platform/i86xpv/$ISADIR/unix -B $ZFS-BOOTFS,\
<i>prop=value</i> [,<i>prop=value</i>...]][-asrvxk] [-m <i>smf-options</i>] [-i altinit]</pre><p><b>GRUB UFS Support:</b></p><pre>grub edit&gt; kernel$ /platform/i86pc/kernel/$ISADIR/unix [-asrvxk]
            [-m <b>smf-options</b>] [-i altinit][-B <i>prop=value</i> [,<i>prop=value</i>...]]</pre>

<a name="ghckl"></a><h4>Boot Arguments You Can Specify When Editing the GRUB Menu at Boot Time</h4>
<p>The following list describes the boot arguments and options that can be specified
by editing the GRUB menu at boot time:</p><dl><dt>unix</dt>
<dd><p>Specifies the kernel to boot.</p></dd>
<dt><tt>-a</tt></dt>
<dd><p>Prompts the user for configuration information.</p></dd>
<dt><tt>-s</tt></dt>
<dd><p>Boots the system in single-user mode.</p></dd>
<dt><tt>-r</tt></dt>
<dd><p>Specifies a reconfiguration boot.</p><p> The system probes all attached hardware devices and then assigns nodes in the file system to represent only those devices that are actually found.</p></dd>
<dt><tt>-v</tt></dt>
<dd><p>Boots the system with verbose messages enabled.</p></dd>
<dt><tt>-x</tt></dt>
<dd><p>Does not boot in clustered mode.</p></dd>
<dt><tt>-k</tt></dt>
<dd><p>Boots the system with the kernel debugger enabled.</p></dd>
<dt><tt>-m</tt> <i>smf-options</i></dt>
<dd><p>Controls the boot behavior of the Service Management Facility (SMF). Included are two categories of options, recovery options and messages options.</p></dd>
<dt><tt>-i</tt> <tt>altinit</tt></dt>
<dd><p>Specifies an alternative executable as the primordial process.  <tt>altinit</tt> is a valid path to an executable.</p></dd>
<dt><tt>-B</tt> <i>prop=value [,prop=value]...</i></dt>
<dd><p>Specifies kernel boot properties.</p></dd>
</dl>
<p>The following are various ways you can modify boot behavior in the
GRUB menu by using the <tt>-B</tt> <b>prop=val</b> option:</p><dl><dt><tt>-B</tt> <tt>console=ttya</tt></dt>
<dd><p>Redirects the console to <tt>ttya</tt>.</p></dd>
<dt><tt>-B</tt> <tt>acpi-enum=off</tt></dt>
<dd><p>Disables Advanced Configuration and Power Interface (ACPI) enumeration of devices.</p></dd>
<dt><tt>-B</tt> <tt>console=ttya,acpi-enum=off</tt></dt>
<dd><p>Redirects the console to <tt>ttya</tt> and disables the ACPI enumeration of devices.</p></dd>
<dt><tt>-B</tt> <tt>acpi-user-options=0x2</tt></dt>
<dd><p>Disables ACPI entirely.</p></dd>
</dl>

<hr><p><b>Note - </b>When properties are specified by using the <tt>eeprom</tt> command <b>and</b> on the
GRUB command line, the GRUB command takes precedence.</p>
<hr>


<a name="fwbme"></a><h4>x86: How to Modify Boot Behavior by Editing the GRUB Menu at Boot Time</h4><a name="indexterm-150"></a><a name="indexterm-151"></a><a name="indexterm-152"></a><p>When you modify the GRUB kernel behavior by editing the GRUB menu
at boot time, the changes do not persist over a system reboot. Default
boot behavior is restored the next time you boot the system.</p><ol>
<li><a name="fwbqq"></a><b>Reboot the system.</b><p>When the boot sequence begins, the GRUB main menu is displayed.</p></li>
<li><b>Use the arrow keys to select the boot entry to edit, then
type <tt>e</tt> to access the GRUB edit menu.</b></li>
<li><b>Use the arrow keys to select the <tt>kernel</tt> or <tt>kernel$</tt> line in
this menu.</b></li>
<li><b>Type <tt>e</tt> to add boot arguments to the line.</b></li>
<li><b>Type any additional boot arguments that you want to specify.</b></li>
<li><b>Press Return to save your changes and return to the previous menu.</b>
<hr><p><b>Note - </b>Pressing the Escape key returns you to the GRUB main menu without saving
your changes.</p>
<hr>
</li>
<li><b>To boot the system, type <tt>b</tt>. </b><p>Changes you make take affect when the system is booted.</p></li></ol><a name="ggqax"></a><h6>Example&nbsp;11-4 x86: Booting a 32-Bit Kernel on a 64-Bit Enabled System</h6><p>To boot a 32-bit kernel on a 64-bit capable system, add the
<tt>kernel/unix</tt> argument.</p><pre>grub edit&gt; kernel /platform/i86pc/multiboot <tt><b>kernel/unix</b></tt><tt><b></b></tt></pre><a name="fwbtl"></a><h6>Example&nbsp;11-5 x86: Redirecting the Serial Console</h6><p>To redirect the serial console to <tt>ttyb</tt>, add the <tt>-B console=ttyb</tt> argument.</p><pre>grub edit&gt; kernel /platform/i86pc/multiboot <tt><b>-B console=ttyb</b></tt></pre><p>Alternatively, you can use <tt>input-device/output-device</tt> property, as shown in the following example:</p><pre>grub edit&gt; kernel /platform/i86pc/multiboot <tt><b>-B input-device=ttyb,output-device=ttyb</b></tt></pre><p>This example shows how you would override the serial line speed:</p><pre>grub edit&gt; kernel /platform/i86pc/multiboot <tt><b>-B ttyb-mode="115200,8,n,1,-"</b></tt></pre><p><b>Caution:</b> In the preceding example, the property value contains commas, which is also
a property separator. To avoid confusing the property parser, use double quotation marks
around the entire property value.</p>

<a name="fvbsi"></a><h4>x86: Modifying Boot Behavior by Editing the <tt>menu.lst</tt> File</h4>
<a name="indexterm-153"></a><a name="indexterm-154"></a><a name="indexterm-155"></a><a name="indexterm-156"></a><p>The GRUB menu, which is based on the <tt>menu.lst</tt> configuration file, can be
customized. When you install or upgrade the Solaris release, the <tt>bootadm</tt> command automatically
updates the <tt>menu.lst</tt> file to reflect menu entries that are supported for
that particular GRUB implementation. Any newly installed OS that is listed in this
file is displayed as a boot entry in the GRUB menu when the
system is rebooted. Note that when installing an operating system other than the
Solaris OS, you will need to manually add the menu entry to the
<tt>menu.lst</tt> file afterwards.</p><p>The following is an example of a typical GRUB main menu, based
on the contents of the <tt>menu.lst</tt> file. The GRUB main menu consists of boot
entries that are available, plus a failsafe archive.</p><pre>GNU GRUB  version 0.95  (631K lower / 2095488K upper memory)
 +-------------------------------------------------------------------------+
 | Solaris 10.1 ... X86                                                    |
 | Solaris failsafe                                                        |
 |                                                                         |
 +-------------------------------------------------------------------------+</pre><p>A configurable timeout is available to boot the default OS entry. The default
OS boot entry that is booted is configurable through the <tt>default</tt> command.
The Solaris installation software typically sets this command to boot one of the
valid Solaris boot entries. To boot a different instance of the Solaris OS
(if applicable), or to boot a different OS, use the arrow keys to
highlight a different boot entry. Then press Enter to boot that entry. Note
that if the <tt>default</tt> command is not set, the first boot entry in
the GRUB menu is booted.</p><p>Only the <b>active</b> <tt>menu.lst</tt> file is used to boot the system.  To
modify the GRUB menu that is displayed when you boot the system, edit
the active GRUB  <tt>menu.lst</tt> file. Changing any other <tt>menu.lst</tt> file has no
effect on the menu that is displayed when you boot the system To
determine the location of the active <tt>menu.lst</tt> file, use the <tt>list-menu</tt> subcommand of the
<tt>bootadm</tt> command. For more information about using the <tt>bootadm</tt> command, see <a href="gglaj.html">Using the <tt>bootadm</tt> Command to Manage the Boot Archives</a>.</p><p>For a complete description of the <tt>menu.lst</tt> file in each of the GRUB
implementations in the Solaris OS, see <a href="ghcsf.html#getnk">x86: Supported GRUB Implementations</a>.</p>

<a name="fvbbb"></a><h4>x86: How to Modify Boot Behavior by Editing the <tt>menu.lst</tt> File</h4><a name="indexterm-157"></a><a name="indexterm-158"></a><a name="indexterm-159"></a><a name="indexterm-160"></a><a name="indexterm-161"></a><p>You might need to modify the <tt>menu.lst</tt> file for one of the following
reasons:</p>
<ul><li><p>To add new OS entries</p></li>
<li><p>To add GRUB console redirection information</p></li></ul>
<h6>Before You Begin</h6><p>Because only the <b>active</b> GRUB <tt>menu.lst</tt> file is used to boot the system,
make sure you edit the correct file. Changing any other GRUB <tt>menu.lst</tt> file
has no effect on the menu that is displayed when you boot the
system.</p><p>The location of the active <tt>menu.lst</tt> file varies, depending on whether you have
a system with a UFS root or a ZFS root.</p>
<ul><li><p>For a UFS root, the active <tt>menu.lst</tt> file is <tt>/boot/grub/menu.lst</tt>.</p></li>
<li><p>For a ZFS root, the active <tt>menu.lst</tt> file is /<i>pool-name</i><tt>/boot/grub/menu.lst</tt><a name="indexterm-162"></a><a name="indexterm-163"></a><a name="indexterm-164"></a></p></li></ul>
<p>You can determine the location of the active GRUB <tt>menu.lst</tt> file by using
the <tt>bootadm</tt> command with the <tt>list-menu</tt> subcommand.</p><pre># <tt><b>bootadm list-menu</b></tt></pre><p>For more information about the <tt>bootadm</tt> command, see the <a href="http://docs.sun.com/doc/819-2240/bootadm-1m?a=view"><tt>bootadm</tt>(1M)</a> man page.</p><ol>
<li><b>Become superuser or assume an equivalent role. </b></li>
<li><b>To add a new OS entry to the active <tt>menu.lst</tt> file, use a
text editor to modify the file.</b><p>The comments within the <tt>menu.lst</tt> file provide you with the necessary information
for adding a new OS entry.</p><p>The following is an example of a <tt>menu.lst</tt> file on a system that
is running a Solaris release with ZFS boot support.  Boot entries in
the <tt>menu.lst</tt> file vary, depending on the Solaris release you are running.</p><pre>#---------- ADDED BY BOOTADM - DO NOT EDIT ----------
title Solaris 11 s10x_90 X86
findroot (pool_rpool,0,a)
kernel$ /platform/i86pc/kernel/$ISADIR/unix -B $ZFS-BOOTFS
module$ /platform/i86pc/$ISADIR/boot_archive
#---------------------END BOOTADM--------------------</pre>
<hr><p><b>Caution - </b>Do not directly edit the original contents of the <tt>menu.lst</tt> file. To
make changes to any of the OS entries in the file, edit the
file manually, duplicating the existing content. Then, make the modifications to the duplicated
content.</p><p>Also note when manually adding new user entries to the file, do not
include guard comments that are reserved for use by the system, such as
&ldquo;Added by bootadm&rdquo; or &ldquo;Added by Live Upgrade&rdquo;. Not using these comments for
manually-added entries ensures that these entries remain intact during a software upgrade.</p>
<hr>
<ul>
<li><b>To specify a 32-bit Solaris kernel as the default kernel to boot, remove
all instances of the <tt>$ISADIR</tt> keyword from the <tt>menu.lst</tt> file.</b><pre>title Solaris Nevada snv_53 X86
kernel$ /platform/i86pc/kernel/unix [*]
module$ /platform/i86pc/boot_archive</pre><p>To specify a 32-bit kernel as the boot method, you must also
change the line that begins with the <tt>kernel</tt> keyword in the Solaris failsafe entry:</p><pre>title Solaris failsafe
kernel /boot/platform/i86pc/kernel/unix [-B *] -s [*]
module /boot/x86.miniroot-safe</pre></li></ul><p>If you have added any additional entries, beyond the default entries, make equivalent
changes manually.</p><p>The [<tt>-B</tt> *] and [*] flags must be preserved, if these flags exist
in the original <tt>menu.lst</tt> file. Also, the failsafe entry should always have an
<tt>-s</tt> flag.</p></li>
<li><b>After adding the required information, save the file.</b><p>Note that any changes you make to the file take effect at the
next system reboot.</p>
<hr><p><b>Tip - </b>If you are running the Linux OS, and install the Solaris OS,
the Linux OS entry is not displayed in the GRUB menu when the
system is rebooted. Before installing the Solaris software, save a copy of the
<tt>menu.lst</tt> file that contains the Linux information. After the installation, add the Linux information
back to the newly-created <tt>menu.lst</tt> file in the Solaris partition.</p>
<hr>
<p>Because changes you make to the <tt>menu.lst</tt> file are not directly related to
the Solaris OS, you cannot make them by using the <tt>eeprom</tt> command.
You must edit the file directly. Note that the Solaris software upgrade process
preserves any changes that you make to the <tt>menu.lst</tt> file.</p>
<hr><p><b>Caution - </b>Solaris GRUB is capable of booting both the Linux OS and the Solaris
OS. However, Linux GRUB is not capable of booting the Solaris OS.
</p><p>Always ensure that one of the following conditions are met:</p>
<ul><li><p>The Solaris <tt>fdisk</tt> partition is active, that it has GRUB installed , and that the <tt>menu.lst</tt> file is the <b>active</b> GRUB menu </p></li>
<li><p>That Solaris GRUB is installed to the Master Boot Record (MBR) and that it refers to a <tt>menu.lst</tt> in the Solaris <tt>fdisk</tt> partition. </p></li></ul>

<hr>
<p>For a detailed description of the GRUB <tt>menu.lst</tt> that pertains to each Solaris
release, see <a href="ghcsf.html#getnk">x86: Supported GRUB Implementations</a>.</p></li></ol><a name="ggvmo"></a><h6>Example&nbsp;11-6 <tt>menu.lst</tt> File on a System With a ZFS Boot Loader</h6><p>The following examples show what a <tt>menu.lst</tt> file looks like on a system
that has a ZFS boot loader. By default, this system will boot from
a ZFS root file system. Note that the contents of the file varies,
depending on the installation type.</p><p><b>New installation or standard upgrade:</b></p><pre>title Solaris 11 s10x_90 X86
findroot (pool_rpool,0,a)
kernel$ /platform/i86pc/kernel/$ISADIR/unix -B $ZFS-BOOTFS
module$ /platform/i86pc/$ISADIR/boot_archive

title Solaris 11 failsafe
findroot (pool_rpool,0,a)
kernel /boot/platform/i86pc/kernel/unix -B console=ttyb
module /boot/x86.miniroot-safe</pre><p><b>Solaris Live Upgrade:</b></p><pre>title be1
findroot (BE_be1,0,a)
bootfs rpool/ROOT/szboot_0508
kernel$ /platform/i86pc/kernel/$ISADIR/unix -B $ZFS-BOOTFS
module$ /platform/i86pc/$ISADIR/boot_archive

title be1 failsafe
findroot (BE_be1,0,a)
kernel /boot/platform/i86pc/kernel/unix -s -B console=ttyb
module /boot/x86.miniroot-safe</pre><a name="ggvnh"></a><h6>Example&nbsp;11-7 <tt>menu.lst</tt> File on a System With a UFS Boot Loader</h6><p>The following examples show what a <tt>menu.lst</tt> file looks like on a system
that has a UFS root file system installed. By default, this system will
boot from a UFS root file system.</p><p><b>New installation or standard upgrade:</b></p><pre>title Solaris 11 s10x_90 X86
findroot (rootfs0,0,a)
kernel$ /platform/i86pc/kernel/$ISADIR/unix
module$ /platform/i86pc/$ISADIR/boot_archive

title Solaris 11 failsafe
findroot (rootfs0,0,a)
kernel /boot/platform/i86pc/kernel/unix -s -B console=ttyb
module /boot/x86.miniroot-safe</pre><p><b>Solaris Live Upgrade:</b></p><pre>title be1
findroot (BE_be1,0,a)
kernel$ /platform/i86pc/kernel/$ISADIR/unix
module$ /platform/i86pc/$ISADIR/boot_archive

title be1 failsafe
findroot (BE_be1,0,a)
kernel /boot/platform/i86pc/kernel/unix -s -B console=ttyb
module /boot/x86.miniroot-safe</pre><a name="gfrge"></a><h6>Example&nbsp;11-8 x86: <tt>menu.lst</tt> File With Hypervisor Support</h6><p>The following examples are for a GRUB implementation that supports booting the Solaris
OS as a dom0, with hypervisor support.</p><p>In this example, the <tt>menu.lst</tt> file has been modified to enable a 64-bit
capable system to boot the Solaris OS as a dom0, in 32-bit mode.
This modification includes removing all instances of <tt>$ISADIR</tt> from the file.</p><pre>title 32-bit Solaris on xVM
kernel$ /boot/xen.gz
module$ /platform/i86xpv/kernel/unix /platform/i86xpv/kernel/unix -B $ZFS-BOOTFS [*]
module$ /platform/i86pc/boot_archive</pre><p>In this example, the <tt>menu.lst</tt> file has been modified to direct the hypervisor
to use the serial console. Note that the serial console is also shared
by the Solaris OS dom0 console.</p><pre>title Solaris on xVM
kernel$ /boot/$ISADIR/xen.gz console=com1 com1=9600,8n1
module$ /platform/i86xpv/kernel/$ISADIR/unix /platform/i86xpv/kernel/$ISADIR/unix \
-B $ZFS-BOOTFS console=hypervisor
module$ /platform/i86pc/$ISADIR/boot_archive</pre>

<a name="gguqf"></a><h4>x86: Locating the Active GRUB <tt>menu.lst</tt> File</h4>
<p>On systems that have a ZFS root, the active <tt>menu.lst</tt> file is typically
located in <tt>/</tt><i>pool-name</i><tt>/boot/grub/menu.lst</tt>.</p><p>On systems that have a UFS root, the active <tt>menu.lst</tt> file is typically
located in <tt>/boot/grub/menu.lst</tt>.</p><p>To locate the active GRUB menu, use the <tt>bootadm</tt> command with the <tt>list-menu</tt>
subcommand:</p><pre># <tt><b>bootadm list-menu</b></tt></pre><p>This command also lists the contents of the active <tt>menu.lst</tt> file:</p><pre># <tt><b>bootadm list-menu</b></tt>
The location for the active GRUB menu is: /<i>pool-name</i>/boot/grub/menu.lst
default 0
timeout 10
0 be1
1 be1 failsafe
2 be3
3 be3 failsafe
4 be2
5 be2 failsafe</pre><p>For further instructions on using the <tt>bootadm</tt> command, see <a href="gglaj.html">Using the <tt>bootadm</tt> Command to Manage the Boot Archives</a>.</p>

<a name="ggumt"></a><h4>x86: Implementation of the <tt>findroot</tt> Command</h4>
<a name="indexterm-165"></a><p>All Solaris installation methods, including Solaris Live Upgrade, now use the <tt>findroot</tt> command
for specifying which disk slice on an x86 based system to boot. This
implementation supports booting systems with ZFS roots, as well as UFS roots. This
information is located in the <tt>menu.lst</tt> file that is used by GRUB.
Previously, the <tt>root</tt> command, <tt>root</tt> (<tt>hd0.0.a</tt>), was used to explicitly specify which disk
slice to boot. </p><p>The installation methods include Solaris Live Upgrade, JumpStart, and the installation GUI program.</p><p>In addition to the <tt>findroot</tt> command, is the additional of a signature file
on the slice, (<i>mysign</i>, <tt>0, a</tt>), where <i>mysign</i> is the name of a
signature file that is located in the <tt>/boot/grub/bootsign</tt> directory. When booting a system from
a ZFS root, the ZFS GRUB plug-in looks for and tries to mount
a ZFS file system in slice <tt>a</tt> of <tt>fdisk</tt> partition <tt>0</tt>. </p><p>The name of the signature file varies, depending on the type of installation
that was used. For more information about the naming convention that is used
by the <tt>findroot</tt> command, see <a href="ghcsf.html#ghskt">Naming Conventions That Are Used by the <tt>findroot</tt> Command</a>.</p><p>Additional menu entries, which also use the <tt>findroot</tt> command, can be added
to the GRUB menu after an installation or upgrade. For instructions, see 
<a href="#ggvms">x86: How to Add GRUB Menu Entries That Use the <tt>findroot</tt> Command</a>.</p>
<hr><p><b>Caution - </b>The boot signature must be unique. Do not use or remove system generated
signatures or user signatures that are duplicated across multiple instances of the Solaris
software. Doing so might result in booting an incorrect OS instance or prevent
the system from booting.</p>
<hr>
<p>Note that the <tt>root</tt> command can still be used in the <tt>menu.lst</tt>
file in certain instances, for example to boot Windows. However, use of the
<tt>root</tt> command in cases where the <tt>findroot</tt> command is preferred is discouraged.</p><a name="ghcrj"></a><h6>Example&nbsp;11-9 x86: Default <tt>menu.lst</tt> file on a System That Uses the <tt>findroot</tt> Command</h6><p>The following example shows the format of a <tt>menu.lst</tt> file entry that implements
the <tt>findroot</tt> command:</p><pre># title Solaris <i>version</i>
    findroot  (foosign<i>partition-no</i>,<i>slice-no</i>,x) --x = Solaris root slice
    kernel$ /platform/i86pc/kernel/$ISADIR/unix
    module$ /platform/i86pc/$ISADIR/boot_archive</pre><a name="ghcsp"></a><h6>Example&nbsp;11-10 x86: Default <tt>menu.lst</tt> file That Supports ZFS Boot Loader</h6><p>This is an example of a <tt>menu.lst</tt> file on system that supports a
ZFS boot loader. The information for booting from a ZFS root file system
is automatically added to the file when a Solaris Live Upgrade is performed.</p><pre>title be1
findroot (BE_be1,0,a)
kernel$ /platform/i86pc/kernel/$ISADIR/unix -B $ZFS-BOOTFS
module$ /platform/i86pc/$ISADIR/boot_archive

title be1 failsafe
findroot (BE_be1,0,a)
bootfs rpool/ROOT/szboot_0508
kernel /boot/platform/i86pc/kernel/unix -s -B console=ttyb
module /boot/x86.miniroot-safe</pre>

<a name="ggvms"></a><h4>x86: How to Add GRUB Menu Entries That Use the <tt>findroot</tt> Command</h4><a name="indexterm-166"></a><a name="indexterm-167"></a><a name="indexterm-168"></a><p>This procedure shows how to manually update the <tt>menu.lst</tt> file with user defined
entries that use the <tt>findroot</tt> command. Typically, these entries are added after an
installation or an upgrade. For guidelines on adding user&hyphen;defined entries that use the <tt>findroot</tt>
command, see <a href="#ggumt">x86: Implementation of the <tt>findroot</tt> Command</a>.</p><ol>
<li><b>Become superuser or assume an equivalent role.</b></li>
<li><b>Create a boot signature file on the root (<tt>/</tt>) file system or root
pool that is booted.</b><ul>
<li><b>For a ZFS pool, <i>my-pool</i>, create the boot signature file in the <tt>/</tt><i>my-pool</i><tt>/boot/grub/bootsign</tt>
directory.</b><pre>#  <tt><b>touch /</tt><i>my-pool</i><tt>/boot/grub/bootsign/</tt><i>user-sign</i><tt></b></tt></pre></li>
<li><b>For a UFS file system, create the boot signature file in the
<tt>/boot/grub/bootsign</tt> directory of the root file system to be booted.</b><pre>#  <tt><b>touch /boot/grub/bootsign/</tt><i>user-sign</i><tt></b></tt></pre></li></ul>
<hr><p><b>Note - </b>Make sure the file name that you choose for the boot signature
is unique. Do not use system generated signature names or user signature names
that are duplicated across multiple instances of the Solaris software. Doing so might
prevent the system from booting or cause the wrong Solaris instance to boot.</p>
<hr>
</li>
<li><b>Add a menu entry that contains the <tt>findroot</tt> command.</b><ol style="list-style-type: lower-alpha">
				 
<li><b>Locate the active <tt>menu.lst</tt> file:</b><pre># <tt><b>bootadm list-menu</b></tt></pre></li>
<li><b>Using a text editor, edit the active <tt>menu.lst</tt> file, adding the following entry:</b><pre>title    User Solaris boot entry
findroot  (<i>user-sign</i>, 3, c)
kernel$   /platform/i86pc/kernel/$ISADIR/unix
module$  /platform/i86pc/$ISADIR/boot_archive</pre><p>In the preceding example, the <tt>3</tt> represents the 4th <tt>fdisk</tt> partition (partitions start at
0). The <tt>c</tt> represents the slice within a Solaris <tt>fdisk</tt> partition (slices
start with a).</p></li></ol></li>
<li><b>Reboot the system.</b><p>The new entry appears in the GRUB menu and can be selected to
boot the specified Solaris OS instance.</p></li></ol>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ggkuh.html">Previous</a>
             </td>
             <td align="right">
                 <a href="hbsparcboot-79782.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

