<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Troubleshooting Booting on the SPARC Platform (Task Map) - System Administration Guide: Basic Administration</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-12-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Basic Administration</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="hbtsboot-1.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ghtrz.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="vol1preface-11.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="saroadmap-1.html">1.&nbsp;&nbsp;Solaris Management Tools (Road Map)</a></p>
<p class="toc level1 tocsp"><a href="smcover-1.html">2.&nbsp;&nbsp;Working With the Solaris Management Console (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ewpor.html">3.&nbsp;&nbsp;Working With the Sun Java Web Console (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="userconcept-97366.html">4.&nbsp;&nbsp;Managing User Accounts and Groups (Overview)</a></p>
<p class="toc level1 tocsp"><a href="usersetup-92366.html">5.&nbsp;&nbsp;Managing User Accounts and Groups (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="clientconcept-15236.html">6.&nbsp;&nbsp;Managing Client-Server Support (Overview)</a></p>
<p class="toc level1 tocsp"><a href="clientsetup-1.html">7.&nbsp;&nbsp;Managing Diskless Clients (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbintro-66644.html">8.&nbsp;&nbsp;Introduction to Shutting Down and Booting a System</a></p>
<p class="toc level1 tocsp"><a href="hboverview-25463.html">9.&nbsp;&nbsp;Shutting Down and Booting a System (Overview)</a></p>
<p class="toc level1 tocsp"><a href="hbsyshalt-84412.html">10.&nbsp;&nbsp;Shutting Down a System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="grubtasks-1.html">11.&nbsp;&nbsp;Modifying Solaris Boot Behavior (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbsparcboot-79782.html">12.&nbsp;&nbsp;Booting a Solaris System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbtsboot-1.html">13.&nbsp;&nbsp;Troubleshooting Booting a Solaris System (Tasks)</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Troubleshooting Booting on the SPARC Platform (Task Map)</a></p>
</div>
<p class="toc level2"><a href="ghtrz.html">Troubleshooting Booting on the x86 Platform (Task Map)</a></p>
<p class="toc level1 tocsp"><a href="archive-123.html">14.&nbsp;&nbsp;Managing the Solaris Boot Archives (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbsysboot-76719.html">15.&nbsp;&nbsp;x86: GRUB Based Booting (Reference)</a></p>
<p class="toc level1 tocsp"><a href="hbrunlevels-25516.html">16.&nbsp;&nbsp;Managing Services (Overview)</a></p>
<p class="toc level1 tocsp"><a href="faauf.html">17.&nbsp;&nbsp;Managing Services (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgsconcepts-52619.html">18.&nbsp;&nbsp;Managing Software (Overview)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgsgui-1.html">19.&nbsp;&nbsp;Managing Software With Solaris System Administration Tools (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgscli-1.html">20.&nbsp;&nbsp;Managing Software by Using Package Commands (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpatchtasks-1.html">21.&nbsp;&nbsp;Managing Solaris Patches by Using the <tt>patchadd</tt> Command (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fddwm.html">A.&nbsp;&nbsp;SMF Services</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="ggkti"></a><h3>Troubleshooting Booting on the SPARC Platform (Task Map)</h3>
<table><col width="28%"><col width="40%"><col width="31%"><tr><th align="left" valign="top" scope="column"><p>Task</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>For Instructions</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Stop a system for recovery purposes. </p></td>
<td align="left" valign="top" scope="row"><p>If a damaged file is
preventing the system from booting normally, first stop the system to attempt recovery</p></td>
<td align="left" valign="top" scope="row"><p><a href="#hbsparcboot-50162">SPARC: How to Stop the System for Recovery Purposes</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Force
a crash dump of and reboot of the system.</p></td>
<td align="left" valign="top" scope="row"><p>You can force a
crash dump and reboot of the system as a troubleshooting measure.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#hbsparcboot-70469">SPARC: How to Force a Crash Dump and Reboot of the System</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Boot a SPARC
based system for recovery purposes.</p></td>
<td align="left" valign="top" scope="row"><p>Boot to repair an important system file that
is preventing the system from booting successfully.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#hbsparcboot-82678">SPARC: How to Boot a System for Recovery Purposes</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Boot a system with the kernel debugger.</p></td>
<td align="left" valign="top" scope="row"><p>You
can the system with the kernel debugger to troubleshoot booting problems. Use the
<tt>kmdb</tt> command to boot the system.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#euayz">SPARC: How to Boot the System With the Kernel Debugger (<tt>kmdb</tt>)</a></p></td>
</tr>
</table><p>You might need to use one or more of the following methods
to troubleshoot problems that prevent the system from booting successfully.</p>
<ul><li><p>Troubleshoot error messages when the system boots.</p></li>
<li><p>Stop the system to attempt recovery.</p></li>
<li><p>Boot a system for recovery purposes.</p></li>
<li><p>Force a crash dump and reboot of the system.</p></li>
<li><p>Boot the system with the kernel debugger by using the <tt>kmdb</tt> command.</p></li></ul>


<a name="hbsparcboot-50162"></a><h4>SPARC: How to Stop the System for Recovery Purposes</h4><ol>
<li><a name="ggpng"></a><b><a name="indexterm-232"></a>Type the Stop key sequence for your system.</b><p>The monitor displays the <tt>ok</tt> PROM prompt.</p><pre>ok</pre><p><a name="ggpmv"></a><a name="ggpqn"></a><a name="ggpuw"></a>The specific Stop key sequence depends on your keyboard type. For example, you
can press Stop-A or L1-A. On terminals, press the Break key. </p></li>
<li><a name="ggpuz"></a><b>Synchronize the file systems.</b><pre>ok <tt><b>sync</b></tt></pre></li>
<li><a name="ggptj"></a><b>When you see the <tt>syncing file systems...</tt> message, press the Stop key sequence again.</b></li>
<li><a name="ggptw"></a><b>Type the appropriate <tt>boot</tt> command to start the boot process.</b><p>For more information, see the <a href="http://docs.sun.com/doc/819-2240/boot-1m?a=view"><tt>boot</tt>(1M)</a> man page.</p></li>
<li><a name="ggpsm"></a><b>Verify that the system was booted to the specified run level.</b><pre># <tt><b>who -r</b></tt>
 .       run-level s  May  2 07:39     3      0  S</pre></li></ol><h6>Example&nbsp;13-1 SPARC: Stopping the System for Recovery Purposes</h6><pre>Press Stop-A
ok <tt><b>sync</b></tt>
syncing file systems...
Press Stop-A
ok <tt><b>boot</b></tt></pre>

<a name="hbsparcboot-37"></a><h4>SPARC: Forcing a Crash Dump and Reboot of the System</h4>
<p>Forcing a crash dump and reboot of the system are sometimes necessary for
troubleshooting purposes. The <tt>savecore</tt> feature is enabled by default.</p><p>For more information about system crash dumps, see <a href="http://docs.sun.com/doc/819-2380/tscrashdumps-40145?a=view">Chapter 17, Managing System Crash Information (Tasks), in <i>System Administration Guide: Advanced Administration</i></a>. </p>

<a name="hbsparcboot-70469"></a><h5>SPARC: How to Force a Crash Dump and Reboot of the System</h5>
<p>Use this procedure to force a crash dump of the system. The
example that follows this procedure shows how to use the <tt>halt</tt> <tt>-d</tt> command
to force a crash dump of the system. You will need to
manually reboot the system after running this command.</p><ol>
<li><a name="ggpul"></a><b>Type the stop key sequence for your system.</b><p>The specific stop key sequence depends on your keyboard type. For example, you can
press Stop-A or L1-A. On terminals, press the Break key.</p><p>The PROM displays the <tt>ok</tt> prompt.</p></li>
<li><a name="ggpsc"></a><b><a name="ggptg"></a><a name="ggprl"></a>Synchronize the file systems and write the crash dump.  </b><pre>&gt; <tt><b>n</b></tt>
ok <tt><b>sync</b></tt></pre><p>After the crash dump is written to disk, the system will continue
to reboot.</p></li>
<li><a name="ggpun"></a><b>Verify the system boots to run level 3.</b><p>The login prompt is displayed when the boot process has finished successfully.</p><pre><i>hostname</i> console login:</pre></li></ol><a name="ggptc"></a><h6>Example&nbsp;13-2 SPARC: Forcing a Crash Dump and Reboot of the System by Using the <tt>halt</tt> <tt>-d</tt> Command</h6><p>This example shows how to force a crash dump and reboot of
the system <tt>jupiter</tt> by using the <tt>halt</tt> <tt>-d</tt> and <tt>boot</tt> command. Use
this method to force a crash dump and reboot of the system.</p><pre># <tt><b>halt -d</b></tt>
Jul 21 14:13:37 jupiter halt: halted by root

panic[cpu0]/thread=30001193b20: forced crash dump initiated at user request

000002a1008f7860 genunix:kadmin+438 (b4, 0, 0, 0, 5, 0)
  %l0-3: 0000000000000000 0000000000000000 0000000000000004 0000000000000004
  %l4-7: 00000000000003cc 0000000000000010 0000000000000004 0000000000000004
000002a1008f7920 genunix:uadmin+110 (5, 0, 0, 6d7000, ff00, 4)
  %l0-3: 0000030002216938 0000000000000000 0000000000000001 0000004237922872
  %l4-7: 000000423791e770 0000000000004102 0000030000449308 0000000000000005

syncing file systems... 1 1 done
dumping to /dev/dsk/c0t0d0s1, offset 107413504, content: kernel
100% done: 5339 pages dumped, compression ratio 2.68, dump succeeded
Program terminated
ok boot
Resetting ... 

Sun Ultra 5/10 UPA/PCI (UltraSPARC-IIi 333MHz), No Keyboard
OpenBoot 3.15, 128 MB memory installed, Serial #10933339.
Ethernet address 8:0:20:a6:d4:5b, Host ID: 80a6d45b.

Rebooting with command: boot
Boot device: /pci@1f,0/pci@1,1/ide@3/disk@0,0:a
File and args: kernel/sparcv9/unix
SunOS Release 5.10 Version s10_60 64-bit
Copyright 1983-2004 Sun Microsystems, Inc.  All rights reserved.
Use is subject to license terms.
configuring IPv4 interfaces: hme0.
add net default: gateway 172.20.27.248
Hostname: jupiter
The system is coming up.  Please wait.
NIS domain name is example.com
.
.
.
System dump time: Wed Jul 21 14:13:41 2004
Jul 21 14:15:23 jupiter savecore: saving system crash dump
in /var/crash/jupiter/*.0
Constructing namelist /var/crash/jupiter/unix.0
Constructing corefile /var/crash/jupiter/vmcore.0
100% done: 5339 of 5339 pages saved

Starting Sun(TM) Web Console Version 2.1-dev...
.
.
.</pre>

<a name="hbsparcboot-82678"></a><h4>SPARC: How to Boot a System for Recovery Purposes</h4><p>Use this procedure when an important file, such as <tt>/etc/passwd</tt>, has an invalid
entry and causes the boot process to fail. </p><p>Use the stop sequence described in this procedure if you do not
know the <tt>root</tt> password or if you can't log in to the system. For
more information, see <a href="#hbsparcboot-50162">SPARC: How to Stop the System for Recovery Purposes</a>.</p><p>Substitute the device name of the file system to be repaired for
the <i>device-name</i> variable in the following procedure. If you need help identifying a
system's device names, refer to <a href="http://docs.sun.com/doc/819-2723/devconfig-27211?a=view">Displaying Device Configuration Information in <i>System Administration Guide: Devices and File Systems</i></a>.</p><ol>
<li><a name="hbsparcboot-step-68"></a><b>Stop the system by using the system's Stop key sequence.</b></li>
<li><a name="hbsparcboot-step-21"></a><b>Boot the system in single-user mode.</b>
<ul><li><p>Boot the system from the Solaris Software 1 CD or DVD,</p>
<ul><li><p>Insert the Solaris installation media into the drive.</p></li>
<li><p>Boot from the installation media in single-user mode.</p><pre>ok <tt><b>boot cdrom -s</b></tt></pre></li></ul>
</li>
<li><p>Boot the system from the network if an installation server or remote CD or DVD drive is not available.</p><pre>ok <tt><b>boot net -s</b></tt></pre></li></ul>
</li>
<li><a name="hbsparcboot-step-22"></a><b>Mount the file system that contains the file with an invalid entry.</b><pre># <tt><b>mount /dev/dsk/</b></tt><i>device-name</i> <tt><b>/a</b></tt></pre></li>
<li><a name="hbsparcboot-step-23"></a><b>Change to the newly mounted file system.</b><pre># <tt><b>cd /a/</b></tt><i>file-system</i></pre></li>
<li><a name="hbsparcboot-step-24"></a><b>Set the terminal type.</b><pre># <tt><b>TERM=</b></tt><i>sun</i>
# <tt><b>export TERM</b></tt></pre></li>
<li><a name="hbsparcboot-step-25"></a><b>Remove the invalid entry from the file by using an editor.</b><pre># <tt><b>vi</b></tt> <i>filename</i></pre></li>
<li><a name="hbsparcboot-step-26"></a><b>Change to the root (<tt>/</tt>) directory.</b><pre># <tt><b>cd /</b></tt></pre></li>
<li><a name="hbsparcboot-step-27"></a><b>Unmount the <tt>/a</tt> directory.</b><pre># <tt><b>umount /a</b></tt></pre></li>
<li><a name="hbsparcboot-step-28"></a><b>Reboot the system.</b><pre># <tt><b>init 6</b></tt></pre></li>
<li><a name="hbsparcboot-step-51"></a><b>Verify that the system booted to run level 3.</b><p>The login prompt is displayed when the boot process has finished successfully.</p><pre><i>hostname</i> console login:</pre></li></ol><h6>Example&nbsp;13-3 SPARC: Booting a System for Recovery Purposes (Damaged Password File)</h6><p><a name="hbsparcboot-ix1004"></a><a name="hbsparcboot-ix1005"></a><a name="indexterm-233"></a>The following example shows how to repair an important system file (in this
case, <tt>/etc/passwd</tt>) after booting from a local CD-ROM. </p><pre>ok <tt><b>boot cdrom -s</b></tt>
# <tt><b>mount /dev/dsk/c0t3d0s0 /a</b></tt>
# <tt><b>cd /a/etc</b></tt>
# <tt><b>TERM=vt100</b></tt>
# <tt><b>export TERM</b></tt>
# <tt><b>vi passwd</b></tt>
(Remove invalid entry)
# <tt><b>cd /</b></tt>
# <tt><b>umount /a</b></tt>
# <tt><b>init 6</b></tt></pre><h6>Example&nbsp;13-4 SPARC: Booting a System if You Forgot the <tt>root</tt> Password</h6><p><a name="indexterm-234"></a><a name="indexterm-235"></a><a name="indexterm-236"></a><a name="indexterm-237"></a>The following example shows how to boot the system from the network when
you have forgotten the <tt>root</tt> password. This example assumes that the network boot server
is already available. Be sure to apply a new <tt>root</tt> password after the
system has rebooted.</p><pre>ok <tt><b>boot net -s</b></tt>
# <tt><b>mount /dev/dsk/c0t3d0s0 /a</b></tt>
# <tt><b>cd /a/etc</b></tt>
# <tt><b>TERM=vt100</b></tt>
# <tt><b>export TERM</b></tt>
# <tt><b>vi shadow</b></tt>
(Remove root's encrypted password string)
# <tt><b>cd /</b></tt>
# <tt><b>umount /a</b></tt>
# <tt><b>init 6</b></tt></pre>

<a name="euayz"></a><h4>SPARC: How to Boot the System With the Kernel Debugger (<tt>kmdb</tt>)</h4><p>This procedure shows you the basics for loading the kernel debugger (<tt>kmdb</tt>). For
more detailed information, see the <i>Solaris Modular Debugger Guide</i>.</p>
<hr><p><b>Note - </b>Use the <tt>reboot</tt> and <tt>halt</tt> command with the <tt>-d</tt> option if you do
not have time to debug the system interactively. To run the <tt>halt</tt> command
with the <tt>-d</tt> option requires a manual reboot of the system afterwards. Whereas,
if you use the <tt>reboot</tt> command, the system boots automatically. See the
<a href="http://docs.sun.com/doc/819-2240/reboot-1m?a=view"><tt>reboot</tt>(1M)</a> for more information.</p>
<hr>
<ol>
<li><b>Halt the system, causing it to display the <tt>ok</tt> prompt.</b><p>To halt the system gracefully, use the <tt>/usr/sbin/halt</tt> command.</p></li>
<li><b>Type either <tt>boot kmdb</tt> or <tt>boot <tt>-k</tt></tt> to request the loading of the kernel debugger.
Press return.</b></li>
<li><b>Enter the kernel debugger.</b><p>The method used to enter the debugger is dependent upon the type
of console that is used to access the system:</p>
<ul><li><p>If a locally attached keyboard is being used, press Stop-A or L1&ndash;A, depending upon the type of keyboard.</p></li>
<li><p>If a serial console is being used, send a break by using the method that is appropriate for the type of serial console that is being used.</p></li></ul>
<p>A welcome message is displayed when you enter the kernel debugger for the
first time.</p><pre>Rebooting with command: kadb
Boot device: /iommu/sbus/espdma@4,800000/esp@4,8800000/sd@3,0
.
.
.</pre></li></ol><h6>Example&nbsp;13-5 SPARC: Booting a System With the Kernel Debugger (<tt>kmdb</tt>)</h6><pre>ok <tt><b>boot kmdb</b></tt>
Resetting...

Executing last command: boot kmdb -d
Boot device: /pci@1f,0/ide@d/disk@0,0:a File and args: kmdb -d
Loading kmdb...</pre>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="hbtsboot-1.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ghtrz.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

