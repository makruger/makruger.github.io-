<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Modifying Boot Behavior on SPARC Based Systems (Task Map) - System Administration Guide: Basic Administration</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-12-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Basic Administration</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="grubtasks-1.html">Previous</a>
             </td>
             <td align="right">
                 <a href="getov.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="vol1preface-11.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="saroadmap-1.html">1.&nbsp;&nbsp;Solaris Management Tools (Road Map)</a></p>
<p class="toc level1 tocsp"><a href="smcover-1.html">2.&nbsp;&nbsp;Working With the Solaris Management Console (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ewpor.html">3.&nbsp;&nbsp;Working With the Sun Java Web Console (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="userconcept-97366.html">4.&nbsp;&nbsp;Managing User Accounts and Groups (Overview)</a></p>
<p class="toc level1 tocsp"><a href="usersetup-92366.html">5.&nbsp;&nbsp;Managing User Accounts and Groups (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="clientconcept-15236.html">6.&nbsp;&nbsp;Managing Client-Server Support (Overview)</a></p>
<p class="toc level1 tocsp"><a href="clientsetup-1.html">7.&nbsp;&nbsp;Managing Diskless Clients (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbintro-66644.html">8.&nbsp;&nbsp;Introduction to Shutting Down and Booting a System</a></p>
<p class="toc level1 tocsp"><a href="hboverview-25463.html">9.&nbsp;&nbsp;Shutting Down and Booting a System (Overview)</a></p>
<p class="toc level1 tocsp"><a href="hbsyshalt-84412.html">10.&nbsp;&nbsp;Shutting Down a System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="grubtasks-1.html">11.&nbsp;&nbsp;Modifying Solaris Boot Behavior (Tasks)</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Modifying Boot Behavior on SPARC Based Systems (Task Map)</a></p>
</div>
<p class="toc level2"><a href="getov.html">Modifying Solaris Boot Behavior on x86 Based Systems (Task Map)</a></p>
<p class="toc level1 tocsp"><a href="hbsparcboot-79782.html">12.&nbsp;&nbsp;Booting a Solaris System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbtsboot-1.html">13.&nbsp;&nbsp;Troubleshooting Booting a Solaris System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="archive-123.html">14.&nbsp;&nbsp;Managing the Solaris Boot Archives (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbsysboot-76719.html">15.&nbsp;&nbsp;x86: GRUB Based Booting (Reference)</a></p>
<p class="toc level1 tocsp"><a href="hbrunlevels-25516.html">16.&nbsp;&nbsp;Managing Services (Overview)</a></p>
<p class="toc level1 tocsp"><a href="faauf.html">17.&nbsp;&nbsp;Managing Services (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgsconcepts-52619.html">18.&nbsp;&nbsp;Managing Software (Overview)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgsgui-1.html">19.&nbsp;&nbsp;Managing Software With Solaris System Administration Tools (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgscli-1.html">20.&nbsp;&nbsp;Managing Software by Using Package Commands (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpatchtasks-1.html">21.&nbsp;&nbsp;Managing Solaris Patches by Using the <tt>patchadd</tt> Command (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fddwm.html">A.&nbsp;&nbsp;SMF Services</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="ggkuh"></a><h3>Modifying Boot Behavior on SPARC Based Systems (Task Map)</h3>
<table><col width="28%"><col width="40%"><col width="31%"><tr><th align="left" valign="top" scope="column"><p>Task</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>For Instructions</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Identify the
PROM revision number.</p></td>
<td align="left" valign="top" scope="row"><p>Use the banner command at the <tt>ok</tt> prompt to display the
PROM revision number for a system.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#hbsparcboot-68368">SPARC: How to Find the PROM Revision Number for a System</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Identify devices on the system that can
be booted.</p></td>
<td align="left" valign="top" scope="row"><p>Before modifying boot behavior by using the boot PROM, identify the devices
on the system.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#hbsparcboot-75">SPARC: How to Identify Devices on a System</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Display the current boot device.</p></td>
<td align="left" valign="top" scope="row"><p>Use this procedure to determine the
current default boot device from which the system will boot.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#ggmpz">SPARC: How to Determine the Default Boot Device</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Change the default boot
device.</p></td>
<td align="left" valign="top" scope="row"><p>To change the default boot device, use one of the following methods:</p>
<ul><li><p>Change the <tt>boot-device</tt> parameter at the boot PROM.</p></li>
<li><p>Change the <tt>boot-device</tt> parameter by using the <tt>eeprom</tt> command.</p></li></ul>
</td>
<td align="left" valign="top" scope="row"><p><a href="#hbsparcboot-61766">SPARC: How to Change the Default Boot Device by Using the Boot PROM</a></p><p><a href="#bootdevice-change">SPARC: How to Change the Default Boot Device by Using the <tt>eeprom</tt> Command</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Reset
the system.</p></td>
<td align="left" valign="top" scope="row"><p>When you reset the system, the system runs diagnostic tests on
the hardware, then reboots.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#hbsparcboot-84747">SPARC: Resetting the System</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Change the default boot file.</p></td>
<td align="left" valign="top" scope="row"><p>To change the default kernel that
the system boots, use one of the following methods:</p>
<ul><li><p>Change the <tt>boot-file</tt> parameter by using the boot PROM.</p></li>
<li><p>Change the<tt>boot-file</tt> parameter by using the <tt>eeprom</tt> command.</p></li></ul>
</td>
<td align="left" valign="top" scope="row"><p><a href="#ggmsh">SPARC: How to Change the Default Kernel by Using the Boot PROM</a></p><p><a href="#bootfile-change">SPARC: How to Change the Default Kernel by Using the <tt>eeprom</tt> Command</a></p></td>
</tr>
</table>

<a name="hbsparcboot-41506"></a><h4>SPARC: Using the Boot PROM</h4>
<p>The boot PROM is used to boot a system. You might need
to change the way the system boots. For example, you might want to
reset the device to boot from or run hardware diagnostics before you bring
the system to a multiuser level. </p><p>System administrators typically use the PROM level to boot a system. You can
also change the default boot file and boot device at the PROM
level.</p><p>If you need to perform any of the following tasks, you need
to change the default boot device:</p>
<ul><li><p>Add a new drive to the system either permanently or temporarily</p></li>
<li><p>Change the network boot strategy</p></li>
<li><p>Temporarily boot a stand-alone system from the network</p></li></ul>
<p>For a complete list of PROM commands, see <a href="http://docs.sun.com/doc/819-2240/monitor-1m?a=view"><tt>monitor</tt>(1M)</a> or <a href="http://docs.sun.com/doc/819-2240/eeprom-1m?a=view"><tt>eeprom</tt>(1M)</a>.</p>

<a name="hbsparcboot-68368"></a><h4>SPARC: How to Find the PROM Revision Number for a System</h4><ul>
<li><b><a name="hbsparcboot-ix991"></a>Display a system's PROM revision number by using the <tt>banner</tt> command. </b><pre>ok <tt><b>banner</b></tt>
Sun Ultra 5/10 UPA/PCI (UltraSPARC-IIi 333MHz), No Keyboard
OpenBoot 3.15, 128 MB memory installed, Serial #<i>number</i>.
Ethernet address <i>number</i>, Host ID: <i>number</i>.</pre><p><a name="hbsparcboot-ix992"></a>Hardware configuration information, including the revision number of the PROM, is displayed. In
this example, the PROM revision number is 3.15.</p></li></ul>

<a name="hbsparcboot-75"></a><h4>SPARC: How to Identify Devices on a System</h4><p>You might need to identify the devices on the system to determine
what are the appropriate devices to boot from.</p><h6>Before You Begin</h6><p>Before you can safely use the <tt>probe</tt> commands to determine what devices are
attached to the system, you need to do the following:</p>
<ul><li><p>Change the PROM <tt>auto-boot?</tt> parameter to false.</p><pre>ok <tt><b>setenv auto-boot? false</b></tt></pre></li>
<li><p>Issue the <tt>reset-all</tt> command to clear system registers.</p><pre>ok <tt><b>reset-all</b></tt></pre></li></ul>
<p>You can view the <tt>probe</tt> commands that are available on your system by
using the <tt>sifting probe</tt> command:</p><pre>ok <tt><b>sifting probe</b></tt></pre><p>If you run the <tt>probe</tt> commands without clearing the system registers, the following
message is displayed:</p><pre>ok <tt><b>probe-scsi</b></tt>
This command may hang the system if a Stop-A or halt command
has been executed.  Please type reset-all to reset the system 
before executing this command. 
Do you wish to continue? (y/n) <tt><b>n</b></tt></pre><ol>
<li><a name="hbsparcboot-step-79"></a><b>Identify the devices on the system.</b><pre>ok <tt><b>probe-</b></tt><i>device</i></pre></li>
<li><a name="hbsparcboot-step-80"></a><b>(Optional) If you want the system to reboot after a power failure or
after using the <tt>reset</tt> command, then reset the <tt>auto-boot?</tt> parameter to true.</b><pre>ok <tt><b>setenv auto-boot? true</b></tt>
auto-boot? =          true</pre></li>
<li><a name="hbsparcboot-step-81"></a><b>Boot the system to multiuser mode.</b><pre>ok <tt><b>reset-all</b></tt></pre></li></ol><h6>Example&nbsp;11-1 SPARC: Identifying the Devices on a System</h6><p>The following example shows how to identify the devices connected to an Ultra<sup>TM</sup>
10 system.</p><pre>ok <tt><b>setenv auto-boot? false</b></tt>
auto-boot? =          false
ok <tt><b>reset-all</b></tt>
Resetting ... 

Sun Ultra 5/10 UPA/PCI (UltraSPARC-IIi 333MHz), No Keyboard
OpenBoot 3.15, 128 MB memory installed, Serial #10933339.
Ethernet address 8:0:20:a6:d4:5b, Host ID: 80a6d45b.

ok <tt><b>probe-ide</b></tt>
  Device 0  ( Primary Master ) 
          ATA Model: ST34321A                                

  Device 1  ( Primary Slave ) 
         Not Present

  Device 2  ( Secondary Master ) 
         Removable ATAPI Model: CRD-8322B                               

  Device 3  ( Secondary Slave ) 
         Not Present

ok <tt><b>setenv auto-boot? true</b></tt>
auto-boot? =          true</pre><p>Alternatively, you can use the <tt>devalias</tt> command to identify the device aliases and
the associated paths of devices that <b>might</b> be connected to the system.
For example:</p><pre>ok <tt><b>devalias</b></tt>
screen                   /pci@1f,0/pci@1,1/SUNW,m64B@2
net                      /pci@1f,0/pci@1,1/network@1,1
cdrom                    /pci@1f,0/pci@1,1/ide@3/cdrom@2,0:f
disk                     /pci@1f,0/pci@1,1/ide@3/disk@0,0
disk3                    /pci@1f,0/pci@1,1/ide@3/disk@3,0
disk2                    /pci@1f,0/pci@1,1/ide@3/disk@2,0
disk1                    /pci@1f,0/pci@1,1/ide@3/disk@1,0
disk0                    /pci@1f,0/pci@1,1/ide@3/disk@0,0
ide                      /pci@1f,0/pci@1,1/ide@3
floppy                   /pci@1f,0/pci@1,1/ebus@1/fdthree
ttyb                     /pci@1f,0/pci@1,1/ebus@1/se:b
ttya                     /pci@1f,0/pci@1,1/ebus@1/se:a
keyboard!                /pci@1f,0/pci@1,1/ebus@1/su@14,3083f8:forcemode
keyboard                 /pci@1f,0/pci@1,1/ebus@1/su@14,3083f8
mouse                    /pci@1f,0/pci@1,1/ebus@1/su@14,3062f8
name                     aliases</pre>

<a name="ggmpz"></a><h4>SPARC: How to Determine the Default Boot Device</h4><ol>
<li><b>Bring the system to the <tt>ok</tt> PROM prompt.</b><p>For more information, see <a href="hbsyshalt-18777.html#hbsyshalt-93400">How to Shut Down a Stand-Alone System</a>.</p></li>
<li><b>Use the <tt>printenv</tt> command to determine the default boot device.</b><pre>ok <tt><b>printenv boot-device</b></tt></pre><dl><dt><tt>boot-device</tt></dt>
<dd><p>Identifies the parameter for setting the device from which to boot.</p></dd>
<dt><i>device</i>[<i>n</i>]</dt>
<dd><p>Identifies the <tt>boot-device</tt> value such as a disk or the network. The <i>n</i> can be specified as the <i>disk number</i>.</p></dd>
</dl>
<p>The default boot-device is displayed in a format that is similar to the
following:</p><pre>boot-device = /pci@1f,4000/scsi@3/disk@1,0:a</pre><p>If the default boot-device is a network boot device, the output is
similar to the following:</p><pre>boot-device = /sbus@1f,0/SUNW,fas@e,8800000/sd@a,0:a \
/sbus@1f,0/SUNW,fas@e,8800000/sd@0,0:a disk net</pre></li></ol>

<a name="hbsparcboot-61766"></a><h4>SPARC: How to Change the Default Boot Device by Using the Boot PROM</h4><p>You might need to identify the devices on the system before you
can change the default boot device to some other device. For information on
identifying devices on the system, see <a href="#hbsparcboot-75">SPARC: How to Identify Devices on a System</a>.</p><ol>
<li><a name="hbsparcboot-step-3"></a><b>Change to run level 0.</b><pre># <tt><b>init 0</b></tt></pre><p>The <tt>ok</tt> PROM prompt is displayed. For more information, see the<a href="http://docs.sun.com/doc/819-2240/init-1m?a=view"><tt>init</tt>(1M)</a> man page.</p></li>
<li><a name="hbsparcboot-step-5"></a><b>Change the value of the <tt>boot-device</tt> parameter.</b><pre>ok <tt><b>setenv boot-device</b></tt> <i>device</i>[<i>n</i>]</pre><p>Use one of the <tt>probe</tt> commands if you need help identifying the disk
number.</p></li>
<li><a name="hbsparcboot-step-6"></a><b>Verify that the default boot device has been changed.</b><pre>ok <tt><b>printenv boot-device</b></tt></pre></li>
<li><a name="hbsparcboot-step-7"></a><b>Save the new <tt>boot-device</tt> value.</b><pre>ok <tt><b>reset-all</b></tt></pre><p>The new <tt>boot-device</tt> value is written to the PROM.</p></li></ol><h6>Example&nbsp;11-2 SPARC: Changing the Default Boot Device</h6><p>In this example, the default boot device is set to disk.</p><pre># <tt><b>init 0</b></tt>
# 
INIT: New run level: 0
.
.
.
The system is down.
syncing file systems... done
Program terminated
ok <tt><b>setenv boot-device /pci@1f,4000/scsi@3/disk@1,0</b></tt>
boot-device =         /pci@1f,4000/scsi@3/disk@1,0
ok <tt><b>printenv boot-device</b></tt>
boot-device           /pci@1f,4000/scsi@3/disk@1,0
ok <tt><b>boot</b></tt>
Resetting ... 

screen not found.
Can't open input device.
Keyboard not present.  Using ttya for input and output.

Sun Enterprise 220R (2 X UltraSPARC-II 450MHz), No Keyboard
OpenBoot 3.23, 1024 MB memory installed, Serial #13116682.
Ethernet address 8:0:20:c8:25:a, Host ID: 80c8250a.

Rebooting with command: boot disk1                                    
Boot device: /pci@1f,4000/scsi@3/disk@1,0  File and args:</pre><p>In this example, the default boot device is set to the network.</p><pre># <tt><b>init 0</b></tt>
# 
INIT: New run level: 0
.
.
.
The system is down.
syncing file systems... done
Program terminated
ok <tt><b>setenv boot-device net</b></tt>
boot-device =         net
ok <tt><b>printenv boot-device</b></tt>
boot-device           net                    disk
ok <tt><b>reset</b></tt>
Sun Ultra 5/10 UPA/PCI (UltraSPARC-IIi 333MHz), No Keyboard
OpenBoot 3.15, 128 MB memory installed, Serial #<i>number</i>.
Ethernet address <i>number</i>, Host ID: <i>number</i>.



Boot device: net  File and args:
.
.
.
pluto console login:</pre>

<a name="bootdevice-change"></a><h4>SPARC: How to Change the Default Boot Device by Using the <tt>eeprom</tt> Command</h4><ol>
<li><b>Become superuser or assume an equivalent role.</b></li>
<li><b>Specify the alternate kernel to boot.</b><pre># <tt><b>eeprom boot-device </tt><i>new-boot-device</i><tt></b></tt></pre></li>
<li><b>Verify that the new parameter has been set.</b><pre># <tt><b>eeprom boot-device</b></tt></pre><p>The output should display the new <tt>eeprom</tt> value for the <tt>boot-device</tt> parameter.</p></li></ol>

<a name="hbsparcboot-84747"></a><h4>SPARC: Resetting the System</h4>
<p><a name="hbsparcboot-ix995"></a>Run the following command from the <tt>ok</tt> prompt:</p><pre>ok <tt><b>reset-all</b></tt></pre><p><a name="ghctm"></a>The self-test program, which runs diagnostic tests on the hardware, is executed. Then,
if the <tt>auto-boot?</tt> parameter is set to true, the system is rebooted.</p>

<a name="ggmsh"></a><h4>SPARC: How to Change the Default Kernel by Using the Boot PROM</h4><a name="indexterm-138"></a><a name="indexterm-139"></a><a name="indexterm-140"></a><ol>
<li><a name="ggmwq"></a><b>Change to run level 0.</b><pre># <tt><b>init 0</b></tt></pre><p>The <tt>ok</tt> PROM prompt is displayed. For more information, see the<a href="http://docs.sun.com/doc/819-2240/init-1m?a=view"><tt>init</tt>(1M)</a> man page.</p></li>
<li><b>Set the <tt>boot-file</tt> property to an alternate kernel.</b><pre>ok <tt><b>setenv boot-file </tt><i>boot-file</i><tt></b></tt></pre></li>
<li><a name="ggmvl"></a><b>Verify that the default boot device has been changed.</b><pre>ok <tt><b>printenv boot-file</b></tt></pre></li>
<li><a name="ggmwa"></a><b>Save the new <tt>boot-file</tt> value.</b><pre>ok <tt><b>reset-all</b></tt></pre><p>The new <tt>boot-file</tt> value is written to the PROM.</p></li></ol>

<a name="bootfile-change"></a><h4>SPARC: How to Change the Default Kernel by Using the <tt>eeprom</tt> Command</h4><ol>
<li><b>Become superuser or assume an equivalent role.</b></li>
<li><b>Specify the alternate kernel to boot.</b><pre># <tt><b>eeprom boot-file </tt><i>new boot-file</i><tt></b></tt></pre><p>For example:</p><pre># <tt><b>eeprom boot-file=kernel.</tt><i>name</i><tt>/sparcv9/unix</b></tt></pre></li>
<li><b>Verify that the new parameter has been set.</b><pre># <tt><b>eeprom boot-file</b></tt></pre><p>The output should display the new <tt>eeprom</tt> value for the specified parameter.</p></li></ol>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="grubtasks-1.html">Previous</a>
             </td>
             <td align="right">
                 <a href="getov.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

