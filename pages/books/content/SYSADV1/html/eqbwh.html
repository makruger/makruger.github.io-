<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Configuring SMF Services - System Administration Guide: Basic Administration</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-12-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">System Administration Guide: Basic Administration</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="eqbrs.html">Previous</a>
             </td>
             <td align="right">
                 <a href="etesg.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="vol1preface-11.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="saroadmap-1.html">1.&nbsp;&nbsp;Solaris Management Tools (Road Map)</a></p>
<p class="toc level1 tocsp"><a href="smcover-1.html">2.&nbsp;&nbsp;Working With the Solaris Management Console (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ewpor.html">3.&nbsp;&nbsp;Working With the Sun Java Web Console (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="userconcept-97366.html">4.&nbsp;&nbsp;Managing User Accounts and Groups (Overview)</a></p>
<p class="toc level1 tocsp"><a href="usersetup-92366.html">5.&nbsp;&nbsp;Managing User Accounts and Groups (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="clientconcept-15236.html">6.&nbsp;&nbsp;Managing Client-Server Support (Overview)</a></p>
<p class="toc level1 tocsp"><a href="clientsetup-1.html">7.&nbsp;&nbsp;Managing Diskless Clients (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbintro-66644.html">8.&nbsp;&nbsp;Introduction to Shutting Down and Booting a System</a></p>
<p class="toc level1 tocsp"><a href="hboverview-25463.html">9.&nbsp;&nbsp;Shutting Down and Booting a System (Overview)</a></p>
<p class="toc level1 tocsp"><a href="hbsyshalt-84412.html">10.&nbsp;&nbsp;Shutting Down a System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="grubtasks-1.html">11.&nbsp;&nbsp;Modifying Solaris Boot Behavior (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbsparcboot-79782.html">12.&nbsp;&nbsp;Booting a Solaris System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbtsboot-1.html">13.&nbsp;&nbsp;Troubleshooting Booting a Solaris System (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="archive-123.html">14.&nbsp;&nbsp;Managing the Solaris Boot Archives (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="hbsysboot-76719.html">15.&nbsp;&nbsp;x86: GRUB Based Booting (Reference)</a></p>
<p class="toc level1 tocsp"><a href="hbrunlevels-25516.html">16.&nbsp;&nbsp;Managing Services (Overview)</a></p>
<p class="toc level1 tocsp"><a href="faauf.html">17.&nbsp;&nbsp;Managing Services (Tasks)</a></p>
<p class="toc level2"><a href="eqbrp.html">Managing Services (Task Map)</a></p>
<p class="toc level2"><a href="dzhaq.html">Monitoring SMF Services</a></p>
<p class="toc level2"><a href="gdqyb.html">Managing SMF Services (Task Map)</a></p>
<p class="toc level2"><a href="eqbrs.html">Managing SMF Services</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Configuring SMF Services</a></p>
</div>
<p class="toc level2"><a href="etesg.html">Using Run Control Scripts (Task Map)</a></p>
<p class="toc level2"><a href="fahqr.html">Using Run Control Scripts</a></p>
<p class="toc level2"><a href="ecdps.html">Troubleshooting the Service Management Facility</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgsconcepts-52619.html">18.&nbsp;&nbsp;Managing Software (Overview)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgsgui-1.html">19.&nbsp;&nbsp;Managing Software With Solaris System Administration Tools (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpkgscli-1.html">20.&nbsp;&nbsp;Managing Software by Using Package Commands (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="swmgrpatchtasks-1.html">21.&nbsp;&nbsp;Managing Solaris Patches by Using the <tt>patchadd</tt> Command (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="fddwm.html">A.&nbsp;&nbsp;SMF Services</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="eqbwh"></a><h3>Configuring SMF Services</h3>


<a name="ecdhr"></a><h4>How to Modify a Service</h4><p>The following procedure shows how to change the configuration of a service that
is not managed by the <tt>inetd</tt> service.</p><ol>
<li><b>Become superuser or assume a role that includes the <tt>Service Management</tt> rights profile.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-30?a=view">Configuring RBAC in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><b>Make changes to the configuration files, as needed.</b><p>Many of the services have one or more configuration files that are used
to define the startup or other configuration information. These files can be changed while
the service is running. The contents of the files is only checked
when the service is started.</p></li>
<li><b>Restart the service.</b><pre># svcadm restart <i>FMRI</i></pre></li></ol><a name="eupsa"></a><h6>Example&nbsp;17-11 Sharing an NFS File System</h6><p>To share a file system using the NFS service, you must define
the file system in the <tt>/etc/dfs/dfstab</tt> file and then restart the NFS service. This
example shows you what the <tt>dfstab</tt> file could look like, as well as
how to restart the service.</p><pre># <tt><b>cat /etc/dfs/dfstab</b></tt>
 .
 .
share -F nfs -o rw /export/home
# <tt><b>svcadm restart svc:/network/nfs/server</b></tt></pre>

<a name="fgoxy"></a><h4>How to Change an Environment Variable for a Service</h4><p>This procedure shows how to modify <tt>cron</tt> environment variables to help with debugging.</p><ol>
<li><b>Become superuser or assume a role that includes the <tt>Service Management</tt> rights profile.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-30?a=view">Configuring RBAC in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><b>Verify that the service is running.</b><pre># <tt><b>svcs system/cron</b></tt>
STATE          STIME    FMRI
online         Dec_04   svc:/system/cron:default</pre></li>
<li><b>Set environment variables.</b><p>In this example the <tt>UMEM_DEBUG</tt> and <tt>LD_PRELOAD</tt> environment variables are set. For information
about the <tt>setenv</tt> subcommand refer to the <a href="http://docs.sun.com/doc/819-2240/svccfg-1m?a=view"><tt>svccfg</tt>(1M)</a> man page.</p><pre># <tt><b>svccfg -s system/cron:default setenv UMEM_DEBUG default</b></tt>
# <tt><b>svccfg -s system/cron:default setenv LD_PRELOAD libumem.so</b></tt></pre></li>
<li><b>Refresh and restart the service.</b><pre># <tt><b>svcadm refresh system/cron</b></tt>
# <tt><b>svcadm restart system/cron</b></tt></pre></li>
<li><b>Verify that the change has been made.</b><pre># <tt><b>pargs -e `pgrep -f /usr/sbin/cron`</b></tt>
100657: /usr/sbin/cron
envp[0]: LOGNAME=root
envp[1]: LD_PRELOAD=libumem.so
envp[2]: PATH=/usr/sbin:/usr/bin
envp[3]: SMF_FMRI=svc:/system/cron:default
envp[4]: SMF_METHOD=/lib/svc/method/svc-cron
envp[5]: SMF_RESTARTER=svc:/system/svc/restarter:default
envp[6]: TZ=GB
envp[7]: UMEM_DEBUG=default
#</pre></li></ol>

<a name="euprm"></a><h4>How to Change a Property for an <tt>inetd</tt> Controlled Service</h4><ol>
<li><b>Become superuser or assume a role that includes the <tt>Service Management</tt> rights profile.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-30?a=view">Configuring RBAC in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><b>List the properties for the specific service.</b><p>This command displays all of the properties for the service identified by the
FMRI.</p><pre># inetadm -l <i>FMRI</i></pre></li>
<li><b>Change the property for the service.</b><p>Each property for an <tt>inetd</tt> controlled service is defined by a property name and
an assigned value. Supplying the property name without a specified value resets the
property to the default value. Specific information about the properties for a service
should be covered in the man page associated with the service.</p><pre># inetadm -m <i>FMRI</i> <i>property-name=value</i></pre></li>
<li><b>Verify that the property has changed.</b><p>List the properties again to make sure that the appropriate change has occurred.</p><pre># inetadm -l <i>FMRI</i></pre></li>
<li><b>Confirm that the change has taken effect.</b><p>Confirm the property change that the change has the desired effect.</p></li></ol><a name="eupro"></a><h6>Example&nbsp;17-12 Changing the <tt>tcp_trace</tt> Property for <tt>telnet</tt></h6><p>The following example shows how to set the <tt>tcp_trace</tt> property for <tt>telnet</tt> to
<tt>true</tt>. Checking the <tt>syslog</tt> output after running a <tt>telnet</tt> command shows that the
change has taken effect.</p><pre># <tt><b>inetadm -l svc:/network/telnet:default</b></tt>
SCOPE    NAME=VALUE
         name="telnet"
 .
 .
default  inherit_env=TRUE
<tt><b>default tcp_trace=FALSE</b></tt>
default  tcp_wrappers=FALSE
# <tt><b>inetadm -m svc:/network/telnet:default tcp_trace=TRUE</b></tt>
# <tt><b>inetadm -l svc:/network/telnet:default</b></tt>
SCOPE    NAME=VALUE
         name="telnet"
 .
 .
default  inherit_env=TRUE
         <tt><b>tcp_trace=TRUE</b></tt>
default  tcp_wrappers=FALSE
# <tt><b>telnet localhost</b></tt>
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
login: <tt><b>root</b></tt>
Password: 
Last login: Mon Jun 21 05:55:45 on console
Sun Microsystems Inc.   SunOS 5.10      s10_57  May 2004
# <tt><b>^D</b></tt>
Connection to localhost closed by foreign host.
# <tt><b>tail -1 /var/adm/messages</b></tt>
Jun 21 06:04:57 yellow-19 inetd[100308]: [ID 317013 daemon.notice] telnet[100625]
    from 127.0.0.1 32802</pre>

<a name="eupri"></a><h4>How to Modify a Command-Line Argument for an <tt>inetd</tt> Controlled Service</h4><ol>
<li><b>Become superuser or assume a role that includes the <tt>Service Management</tt> rights profile.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-30?a=view">Configuring RBAC in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><b>List the <tt>exec</tt> property for the specific service.</b><p>This command displays all the properties for the service identified by the FMRI.
Adding the <tt>grep</tt> command restricts the output to the <tt>exec</tt> property for the
service.</p><pre># inetadm -l <i>FMRI</i>|grep exec</pre></li>
<li><b>Change the <tt>exec</tt> property for the service.</b><p>The <i>command-syntax</i> set with the <tt>exec</tt> property defines the command string that is
run when the service is started.</p><pre># inetadm -m <i>FMRI</i> exec="<i>command-syntax</i>"</pre></li>
<li><b>Verify that the property has changed.</b><p>List the properties again to make sure that the appropriate change has occurred.</p><pre># inetadm -l <i>FMRI</i></pre></li></ol><a name="euprk"></a><h6>Example&nbsp;17-13 Adding the Connection Logging (<tt>-l</tt>) Option to the <tt>ftp</tt> Command</h6><p>In this example, the <tt>-l</tt> option is added to the <tt>ftp</tt> daemon
when it is started. The effect of this change can be seen by
reviewing the <tt>syslog</tt> output after a <tt>ftp</tt> login session has been completed.</p><pre># <tt><b>inetadm -l svc:/network/ftp:default | grep exec</b></tt>
        exec="/usr/sbin/in.ftpd -a"
# <tt><b>inetadm -m svc:/network/ftp:default exec="/usr/sbin/in.ftpd -a -l"</b></tt>
# <tt><b>inetadm -l svc:/network/ftp:default</b></tt>
SCOPE    NAME=VALUE
         name="ftp"
         endpoint_type="stream"
         proto="tcp6"
         isrpc=FALSE
         wait=FALSE
         <tt><b>exec="/usr/sbin/in.ftpd -a -l"</b></tt>
 .
 .
# <tt><b>ftp localhost</b></tt>
Connected to localhost.
220 yellow-19 FTP server ready.
Name (localhost:root): <tt><b>mylogin</b></tt>
331 Password required for mylogin.
Password:
230 User mylogin logged in.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; <tt><b>quit</b></tt>
221-You have transferred 0 bytes in 0 files.
221-Total traffic for this session was 236 bytes in 0 transfers.
221-Thank you for using the FTP service on yellow-19.
221 Goodbye.
# <tt><b>tail -2 /var/adm/message</b></tt>s
Jun 21 06:54:33 yellow-19 ftpd[100773]: [ID 124999 daemon.info] FTP LOGIN FROM localhost 
     [127.0.0.1], mylogin
Jun 21 06:54:38 yellow-19 ftpd[100773]: [ID 528697 daemon.info] FTP session closed</pre>

<a name="epubw"></a><h4>How to Convert <tt>inetd.conf</tt> Entries</h4><p>The following procedure converts <tt>inetd.conf</tt> entries into SMF service manifests. This procedure needs
to be run anytime a third-party application that depends on <tt>inetd</tt> is added
to a system. Also run this procedure, if you need to make configuration
changes to the entry in <tt>/etc/inetd.conf</tt>.</p><ol>
<li><b>Become superuser or assume a role that includes the <tt>Service Management</tt> rights profile.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-30?a=view">Configuring RBAC in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><b>Convert the <tt>inetd.conf</tt> entries.</b><p>The <tt>inetconv</tt> command converts each entry in the selected file into service manifests.</p><pre># inetconv -i <i>filename</i></pre></li></ol><a name="epuby"></a><h6>Example&nbsp;17-14 Converting <tt>/etc/inet/inetd.conf</tt> Entries into SMF Service Manifests</h6><pre># <tt><b>inetconv -i /etc/inet/inetd.conf</b></tt></pre>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="eqbrs.html">Previous</a>
             </td>
             <td align="right">
                 <a href="etesg.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

