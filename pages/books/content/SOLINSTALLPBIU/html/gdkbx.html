<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Upgrading With Non-Global Zones - Solaris Express Installation Guide: Planning for Installation and Upgrade</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-05-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">Solaris Express Installation Guide: Planning for Installation and Upgrade</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="gavhc.html">Previous</a>
             </td>
             <td align="right">
                 <a href="gcdfn.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="epucn.html">Part&nbsp;I&nbsp;Overall Planning of Any Solaris Installation or Upgrade</a></p>
<p class="toc level2"><a href="intro-1.html">1.&nbsp;&nbsp;Where to Find Solaris Installation Planning Information</a></p>
<p class="toc level2"><a href="gaufd.html">2.&nbsp;&nbsp;What's New in Solaris Installation</a></p>
<p class="toc level2"><a href="planning-8.html">3.&nbsp;&nbsp;Solaris Installation and Upgrade (Roadmap)</a></p>
<p class="toc level2"><a href="diskspace-1.html">4.&nbsp;&nbsp;System Requirements, Guidelines, and Upgrade (Planning)</a></p>
<p class="toc level2"><a href="gatherinfo-1.html">5.&nbsp;&nbsp;Gathering Information Before Installation or Upgrade (Planning)</a></p>
<p class="toc level1 tocsp"><a href="epucs.html">Part&nbsp;II&nbsp;Understanding Installations That Relate to GRUB, Solaris Zones, and RAID-1 Volumes</a></p>
<p class="toc level2"><a href="grub-1.html">6.&nbsp;&nbsp;x86: GRUB Based Booting for Solaris Installation</a></p>
<p class="toc level2"><a href="gdhbj.html">7.&nbsp;&nbsp;Upgrading When Solaris Zones Are Installed on a System (Planning)</a></p>
<p class="toc level3"><a href="gavhc.html">Solaris Zones (Overview)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Upgrading With Non-Global Zones</a></p>
</div>
<p class="toc level3"><a href="gcdfn.html">Disk Space Requirements for Non-Global Zones</a></p>
<p class="toc level2 tocsp"><a href="mirroroverview-1.html">8.&nbsp;&nbsp;Creating RAID-1 Volumes (Mirrors) During Installation (Overview)</a></p>
<p class="toc level2"><a href="mirrorplanning-1.html">9.&nbsp;&nbsp;Creating RAID-1 Volumes (Mirrors) During Installation (Planning)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="gdkbx"></a><h3>Upgrading With Non-Global Zones</h3>
<p><a name="indexterm-85"></a><a name="indexterm-86"></a><a name="indexterm-87"></a>After the Solaris OS is installed, you can install and configure non-global zones.
You can upgrade the Solaris OS when non-global zones are installed. If you
have branded non-global zones installed, they are ignored during the upgrade process. Changes to
accommodate systems that have non-global zones installed are summarized below.</p>
<ul><li><p>For the Solaris interactive installation program, you can upgrade or patch a system when non-global zones are installed. The time to upgrade or patch might be extensive, depending on the number of non-global zones that are installed. For more information about installing with this program, see <a href="http://docs.sun.com/doc/819-2393/webstart-91?a=view">Chapter 2, Installing With the Solaris Installation Program (Tasks), in <i>Solaris Express Installation Guide: Basic Installations</i></a>.</p></li>
<li><p>For an automated JumpStart installation, you can upgrade or patch with any keyword that applies to an upgrade or patching. The time to upgrade or patch might be extensive, depending on the number of non-global zones that are installed. For more information about installing with this program, see <a href="http://docs.sun.com/doc/819-2396"><i>Solaris Express Installation Guide: Custom JumpStart and Advanced Installations</i></a>.</p></li>
<li><p> For Solaris Live Upgrade, you can upgrade or patch a system that contains non-global zones. If you have a system that contains non-global zones, Solaris Live Upgrade is the recommended upgrade program or program to add patches. Other upgrade programs might require extensive upgrade time, because the time required to complete the upgrade increases linearly with the number of installed non-global zones. If you are patching a system with Solaris Live Upgrade, you do not have to take the system to single-user mode and you can maximize your system's uptime. Changes to accommodate systems that have non-global zones installed are the following:</p>
<ul><li><p>A new package, <tt>SUNWlucfg</tt>, is required to be installed with the other Solaris Live Upgrade packages, <tt>SUNWlur</tt> and <tt>SUNWluu</tt>.</p></li>
<li><p>Creating a new boot environment from the currently running boot environment remains the same with one exception. You can specify a destination slice for a shared file system within a non-global zone. This exception occurs under the following circumstances:</p>
<ul><li><p>If on the current boot environment the <tt>zonecfg add fs</tt> command was used that created a separate file system for a non-global zone</p></li>
<li><p>If this separate file system resides on a shared file system, such as <tt>/zone/root/export</tt></p></li></ul>
<p>To prevent this separate file system from being shared in the new boot environment, the <tt>lucreate</tt> command has changed to enable specifying a destination slice for a separate file system for a non-global zone. The argument to the <tt>-m</tt> option has a new optional field, <i>zonename</i>. This new field places the non-global zone's separate file system on a separate slice in the new boot environment. For more information on setting up a non-global zone with a separate file system, see <a href="http://docs.sun.com/doc/819-2240/zonecfg-1m?a=view"><tt>zonecfg</tt>(1M)</a>.</p>
<hr><p><b>Note - </b>By default, any file system other than the critical file systems (root (<tt>/</tt>), <tt>/usr</tt>, and <tt>/opt</tt> file systems) is shared between the current and new boot environments. Updating shared files in the active boot environment also updates data in the inactive boot environment. The <tt>/export</tt> file system is an example of a shared file system. If you use the <tt>-m</tt> option and the <i>zonename</i> option, the non-global zone's shared file system is copied to a separate slice and data is not shared. This option prevents non-global zone file systems that were created with the <tt>zonecfg add fs</tt> command from being shared between the boot environments. </p>
<hr>
</li>
<li><p>Comparing boot environments is enhanced. The <tt>lucompare</tt> command now generates a comparison of boot environments that includes the contents of any non-global zone.</p></li>
<li><p>The <tt>lumount</tt> command now provides non-global zones with access to their corresponding separate file systems that exist on inactive boot environments. When the global zone administrator uses the <tt>lumount</tt> command to mount an inactive boot environment, the boot environment is mounted for non-global zones as well.</p></li>
<li><p>Listing file systems with the <tt>lufslist</tt> command is enhanced to display a list of file systems for both the global zone and the non-global zones.</p></li></ul>
</li></ul>
<p>For step-by-step instructions on using Solaris Live Upgrade when non-global zones are installed,
see <a href="http://docs.sun.com/doc/819-2395/gdzlc?a=view">Chapter 9, Upgrading the Solaris OS on a System With Non-Global Zones Installed, in <i>Solaris Express Installation Guide: Solaris Live Upgrade and Upgrade Planning</i></a>.</p><a name="gebmx"></a><h6>Table&nbsp;7-1 Limitations When Upgrading With Non-Global Zones</h6><table><col width="32.84*"><col width="67.16*"><tr><th align="left" valign="top" scope="column"><p>Program or Condition</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Solaris Flash archives</p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-88"></a><a name="indexterm-89"></a><a name="indexterm-90"></a>A Solaris Flash archive cannot be properly created
when a non-global zone is installed. The Solaris Flash feature is not compatible
 with Solaris Zones partitioning technology. If you create a Solaris Flash archive,
the resulting  archive is not installed properly when the archive is deployed
under these conditions:</p>
<ul><li><p>The archive is created in a non-global zone.</p></li>
<li><p>The archive is created in a global zone that has non-global zones installed.</p></li></ul>
<p>For more information about using Solaris Flash archives, see <a href="http://docs.sun.com/doc/819-2397"><i>Solaris Express Installation Guide: Solaris Flash Archives (Creation and Installation)</i></a>.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Using
a command that uses the <tt>-R</tt> option or equivalent must not be used
in some situations.</p></td>
<td align="left" valign="top" scope="row"><p>Any command that accepts an alternate root (<tt>/</tt>) file system by
using the <tt>-R</tt> option or equivalent must not be used if the following
are true:</p>
<ul><li><p>The command is run in the global zone.</p></li>
<li><p>The alternative root (<tt>/</tt>) file system refers to any path within a non-global zone.</p></li></ul>
<p>An example is the <tt>-R</tt> <i>root_path</i> option to the <tt>pkgadd</tt> utility run
from the global zone with a path to the root (<tt>/</tt>) file system
in a non-global zone.</p><p>For a list of utilities that accept an alternate
root (<tt>/</tt>) file system and more information about zones, see <a href="http://docs.sun.com/doc/819-2450/z.admin.ov-46?a=view">Restriction on Accessing A Non-Global Zone From the Global Zone in <i>System Administration Guide: Solaris Containers-Resource Management and Solaris Zones</i></a>.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>ZFS file systems
and non-global zones</p></td>
<td align="left" valign="top" scope="row"><p> If a non-global zone is on a ZFS file
system, the upgrade process does not upgrade the non-global zone.</p></td>
</tr>
</table>

<a name="gdhbs"></a><h4>Backing Up Your System Before Performing an Upgrade With Zones</h4>
<p>You should back up the global and non-global zones on your Solaris
system before you perform the upgrade. For information about backing up a system with
zones installed, see <a href="http://docs.sun.com/doc/819-2450/z.admin.ov-1?a=view">Chapter 26, Solaris Zones Administration (Overview), in <i>System Administration Guide: Solaris Containers-Resource Management and Solaris Zones</i></a>.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="gavhc.html">Previous</a>
             </td>
             <td align="right">
                 <a href="gcdfn.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

