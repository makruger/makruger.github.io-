<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>x86: GRUB Based Booting (Planning) - Solaris Express Installation Guide: Planning for Installation and Upgrade</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-05-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">Solaris Express Installation Guide: Planning for Installation and Upgrade</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="fxivs.html">Previous</a>
             </td>
             <td align="right">
                 <a href="gdhbj.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="epucn.html">Part&nbsp;I&nbsp;Overall Planning of Any Solaris Installation or Upgrade</a></p>
<p class="toc level2"><a href="intro-1.html">1.&nbsp;&nbsp;Where to Find Solaris Installation Planning Information</a></p>
<p class="toc level2"><a href="gaufd.html">2.&nbsp;&nbsp;What's New in Solaris Installation</a></p>
<p class="toc level2"><a href="planning-8.html">3.&nbsp;&nbsp;Solaris Installation and Upgrade (Roadmap)</a></p>
<p class="toc level2"><a href="diskspace-1.html">4.&nbsp;&nbsp;System Requirements, Guidelines, and Upgrade (Planning)</a></p>
<p class="toc level2"><a href="gatherinfo-1.html">5.&nbsp;&nbsp;Gathering Information Before Installation or Upgrade (Planning)</a></p>
<p class="toc level1 tocsp"><a href="epucs.html">Part&nbsp;II&nbsp;Understanding Installations That Relate to GRUB, Solaris Zones, and RAID-1 Volumes</a></p>
<p class="toc level2"><a href="grub-1.html">6.&nbsp;&nbsp;x86: GRUB Based Booting for Solaris Installation</a></p>
<p class="toc level3"><a href="fxivs.html">x86: GRUB Based Booting (Overview)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">x86: GRUB Based Booting (Planning)</a></p>
</div>
<p class="toc level2 tocsp"><a href="gdhbj.html">7.&nbsp;&nbsp;Upgrading When Solaris Zones Are Installed on a System (Planning)</a></p>
<p class="toc level2"><a href="mirroroverview-1.html">8.&nbsp;&nbsp;Creating RAID-1 Volumes (Mirrors) During Installation (Overview)</a></p>
<p class="toc level2"><a href="mirrorplanning-1.html">9.&nbsp;&nbsp;Creating RAID-1 Volumes (Mirrors) During Installation (Planning)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="gavdl"></a><h3>x86: GRUB Based Booting (Planning)</h3>
<p><a name="indexterm-77"></a><a name="indexterm-78"></a>This section describes the basics of GRUB based booting and describes the GRUB
menu.</p><p>When you install the Solaris OS, two GRUB menu entries are installed on
the system by default. The first entry is the Solaris OS entry.
The second entry is the failsafe boot archive, which is to be used
for system recovery. The Solaris GRUB menu entries are installed and updated automatically
as part of the Solaris software installation and upgrade process. These entries are directly
managed by the OS and should not be manually edited.</p><p>During a standard Solaris OS installation, GRUB is installed on the Solaris <tt>fdisk</tt>
partition without modifying the system BIOS setting. If the OS is not on
the BIOS boot disk, you need to do one of the following: </p>
<ul><li><p>Modify the BIOS setting.</p></li>
<li><p>Use a boot manager to bootstrap to the Solaris partition. For more details, see your boot manager. </p></li></ul>
<p>The preferred method is to install the Solaris OS on the boot
disk. If multiple operating systems are installed on the machine, you can add
entries to the <tt>menu.lst</tt> file. These entries are then displayed in the GRUB menu
the next time you boot the system.</p><p>For additional information on multiple operating systems, see <a href="http://docs.sun.com/doc/819-2379/fxjig?a=view">How Multiple Operating Systems Are Supported in the GRUB Boot Environment in <i>System Administration Guide: Basic Administration</i></a>.</p>

<a name="gavdu"></a><h4>x86: Performing a GRUB Based Installation From the Network</h4>
<a name="indexterm-79"></a><a name="indexterm-80"></a><a name="indexterm-81"></a><p>Performing a GRUB based network boot requires a DHCP server that is configured
for PXE clients and an install server that provides <tt>tftp</tt> service. The DHCP
server must be able to respond to the DHCP classes, <tt>PXEClient</tt> and
<tt>GRUBClient</tt>. The DHCP response must contain the following information:</p>
<ul><li><p>IP address of the file server</p></li>
<li><p>Name of the boot file (<tt>pxegrub</tt>)</p></li></ul>

<hr><p><b>Note - </b><tt>rpc.bootparamd</tt>, which is usually a requirement on the server side for performing a
network boot, is not required for a GRUB based network boot.</p>
<hr>
<p>If no PXE or DHCP server is available, you can load GRUB
from CD-ROM or local disk. You can then manually configure the network in
GRUB and download the multiboot program and the boot archive from the file
server.</p><p>For more information, see <a href="http://docs.sun.com/doc/819-2394/bootdiskette-31?a=view">Overview of Booting and Installing Over the Network With PXE in <i>Solaris Express Installation Guide: Network-Based Installations</i></a>.</p>

<a name="gavha"></a><h4>Description of the GRUB Main Menu</h4>
<p><a name="indexterm-82"></a>When you boot an x86 based system, the GRUB menu is displayed. This
menu provides a list of boot entries to choose from. A <b>boot entry</b> is
an OS instance that is installed on your system. The GRUB menu is
based on the <tt>menu.lst</tt> file, which is a configuration file. The <tt>menu.lst</tt> file
is created by the Solaris installation program and can be modified after installation. The
<tt>menu.lst</tt> file dictates the list of OS instances that are shown in the
GRUB menu. </p>
<ul><li><p>If you install or upgrade the Solaris OS, the GRUB menu is automatically updated. The Solaris OS is then displayed as a new boot entry. </p></li>
<li><p>If you install an OS other than the Solaris OS, you must modify the <tt>menu.lst</tt> configuration file to include the new OS instance. Adding the new OS instance enables the new boot entry to appear in the GRUB menu the next time that you boot the system. </p></li></ul>
<a name="gavhg"></a>Example&nbsp;6-1 GRUB Main Menu<p>In the following example, the GRUB main menu shows the Solaris and
Microsoft Windows operating systems.  A Solaris Live Upgrade boot environment is also listed
that is named <tt>second_disk</tt>. See the following for descriptions of each menu item.</p><pre>GNU GRUB version 0.95 (616K lower / 4127168K upper memory)
+-------------------------------------------------------------------+
|Solaris                                                            |
|Solaris failsafe                                                   |
|second_disk                                                        |
|second_disk failsafe                                               |
|Windows                                                            |
+-------------------------------------------------------------------+
Use the ^ and v keys to select which entry is highlighted. Press
enter to boot the selected OS, 'e' to edit the commands before
booting, or 'c' for a command-line.</pre><dl><dt>Solaris</dt>
<dd><p>Specifies the Solaris OS. </p></dd>
<dt>Solaris failsafe</dt>
<dd><p>Specifies a boot archive that can be used for recovery if the Solaris OS is damaged.</p></dd>
<dt>second_disk</dt>
<dd><p>Specifies a Solaris Live Upgrade boot environment. The <tt>second_disk</tt> boot environment was created as a copy of the Solaris OS. It was upgraded and activated with the <tt>luactivate</tt> command. The boot environment is available for booting.</p></dd>
<dt>Windows</dt>
<dd><p>Specifies the Microsoft Windows OS. GRUB detects these partitions but does not verify that the OS can be booted.</p></dd>
</dl>


<a name="gavhe"></a><h5>Description of GRUB <tt>menu.lst</tt> File</h5>
<a name="indexterm-83"></a><a name="indexterm-84"></a><p>The GRUB <tt>menu.lst</tt> file lists the contents of the GRUB main menu. The
GRUB main menu lists boot entries for all the OS instances that are
installed on your system, including Solaris Live Upgrade boot environments. The Solaris software
upgrade process preserves any changes that you make to this file.</p><p>Any revisions made to the <tt>menu.lst</tt> file are displayed on the GRUB main
menu, along with the Solaris Live Upgrade entries. Any changes that you make
to the file become effective at the next system reboot. You can revise
this file for the following reasons:</p>
<ul><li><p>To add to the GRUB menu entries for operating systems other than Solaris</p></li>
<li><p>To customize booting behavior such as specifying the default OS on the GRUB menu</p></li></ul>

<hr><p><b>Caution - </b>Do not use the GRUB <tt>menu.lst</tt> file to modify Solaris Live Upgrade entries.
Modifications could cause Solaris Live Upgrade to fail.</p>
<hr>
<p>Although you can use the <tt>menu.lst</tt> file to customize booting behavior such as
booting with the kernel debugger, the preferred method for customization is to use
the <tt>eeprom</tt> command. If you use the <tt>menu.lst</tt> file to customize, the Solaris
OS entries might be modified during a software upgrade. Changes to the file
would then be lost.</p><p>For information about how to use the <tt>eeprom</tt> command, see <a href="http://docs.sun.com/doc/819-2379/fwbon?a=view">How to Modify Boot Behavior by Using the eeprom Command in <i>System Administration Guide: Basic Administration</i></a>.</p><a name="gavgn"></a>Example&nbsp;6-2 <tt>Menu.lst</tt> File<p>Here is a sample of a <tt>menu.lst</tt> file:</p><pre>default 0
timeout 10
title Solaris
  root (hd0,0,a)
  kernel$ /platform/i86pc/kernel/$ISADIR/unix -B console=ttya
  module$ /platform/i86pc/$ISADIR/boot_archive
title Solaris failsafe
  root (hd0,0,a)
  kernel /boot/platform/i86pc/kernel/unix -s -B console=ttya
  module /boot/x86.miniroot-safe
#----- second_disk - ADDED BY LIVE UPGRADE - DO NOT EDIT  -----
title second_disk
  root (hd0,1,a)
  kernel$ /platform/i86pc/kernel/$ISADIR/unix
  module$ /platform/i86pc/$ISADIR/boot_archive
title second_disk failsafe
  root (hd0,1,a)
  kernel /boot/platform/i86pc/kernel/unix -s
  module /boot/x86.miniroot-safe
#----- second_disk -------------- END LIVE UPGRADE ------------
title Windows
  root (hd0,0)
  chainloader -1</pre><dl><dt><tt>default</tt></dt>
<dd><p>Specifies which item to boot if the timeout expires. To change the default, you can specify another item in the list by changing the number. The count begins with zero for the first title. For example, change the default to 2 to boot automatically to the <tt>second_disk</tt> boot environment.</p></dd>
<dt><tt>timeout</tt></dt>
<dd><p>Specifies the number of seconds to wait for user input before booting the default entry. If no timeout is specified, you are required to choose an entry.</p></dd>
<dt><tt>title</tt> <i>OS name</i></dt>
<dd><p>Specifies the name of the operating system. </p>
<ul><li><p>If this is a Solaris Live Upgrade boot environment, <i>OS name</i> is the name you gave the new boot environment when it was created. In the previous example, the Solaris Live Upgrade boot environment is named <tt>second_disk</tt>.</p></li>
<li><p>If this is a failsafe boot archive, this boot archive is used for recovery when the primary OS is damaged. In the previous example, Solaris failsafe and <tt>second_disk</tt> failsafe are the recovery boot archives for the Solaris and <tt>second_disk</tt> operating systems.</p></li></ul>
</dd>
<dt><tt>root (hd0,0,a)</tt></dt>
<dd><p>Specifies on which disk, partition, and slice to load files. GRUB automatically detects the file system type.</p></dd>
<dt><tt>kernel$ /platform/i86pc/kernel/$ISADIR/unix</tt></dt>
<dd><p>Specifies the boot loader that runs on the system. GRUB expands the <tt>$ISADIR</tt> keyword to <tt>amd64</tt> on 64-bit hardware. <tt>$ISADIR</tt> becomes a null value on 32-bit only hardware.</p><p><b>Starting with the Solaris Express Developer Edition 5/07 release,</b> see new GRUB enhancements described at <a href="gevkv.html#gfajo">x86: GRUB Extended Support for Directly Loading and Booting the UNIX Kernel</a>.</p></dd>
</dl>
<p>For a complete description of multiple operating systems, see <a href="http://docs.sun.com/doc/819-2379/fxjig?a=view">How Multiple Operating Systems Are Supported in the GRUB Boot Environment in <i>System Administration Guide: Basic Administration</i></a>.</p>

<a name="gbdif"></a><h5>Locating the <tt>menu.lst</tt> File to Change the GRUB Menu</h5>
<p>You must always use the <tt>bootadm</tt> command to locate the GRUB menu's <tt>menu.lst</tt>
file. The <tt>list-menu</tt> subcommand finds the active GRUB menu. The <tt>menu.lst</tt> file lists
all the operating systems that are installed on a  system.  The
contents of this file dictate the list of operating systems  that is
displayed on the GRUB menu.  If you want to make changes to
this file, see <a href="http://docs.sun.com/doc/819-2395/gbdfr?a=view">Locating the GRUB Menu&rsquo;s menu.lst File (Tasks) in <i>Solaris Express Installation Guide: Solaris Live Upgrade and Upgrade Planning</i></a>.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="fxivs.html">Previous</a>
             </td>
             <td align="right">
                 <a href="gdhbj.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

