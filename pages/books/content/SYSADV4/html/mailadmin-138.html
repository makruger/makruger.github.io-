<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Administering the Queue Directories - System Administration Guide: Network Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: Network Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="mailadmin-262.html">Previous</a>
             </td>
             <td align="right">
                 <a href="mailadmin-264.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="netservices-1.html">Part&nbsp;I&nbsp;Network Services Topics</a></p>
<p class="toc level2"><a href="nsov-1.html">1.&nbsp;&nbsp;Network Service (Overview)</a></p>
<p class="toc level2"><a href="nca-1.html">2.&nbsp;&nbsp;Managing Web Cache Servers</a></p>
<p class="toc level2"><a href="time-1.html">3.&nbsp;&nbsp;Time-Related Services</a></p>
<p class="toc level1 tocsp"><a href="rfstm-1.html">Part&nbsp;II&nbsp;Accessing Network File Systems Topics</a></p>
<p class="toc level2"><a href="rfsintro-2.html">4.&nbsp;&nbsp;Managing Network File Systems (Overview)</a></p>
<p class="toc level2"><a href="rfsadmin-8.html">5.&nbsp;&nbsp;Network File System Administration (Tasks)</a></p>
<p class="toc level2"><a href="rfsrefer-1.html">6.&nbsp;&nbsp;Accessing Network File Systems (Reference)</a></p>
<p class="toc level1 tocsp"><a href="slptm.html">Part&nbsp;III&nbsp;SLP Topics</a></p>
<p class="toc level2"><a href="slparch-16.html">7.&nbsp;&nbsp;SLP (Overview)</a></p>
<p class="toc level2"><a href="slp.setup-10.html">8.&nbsp;&nbsp;Planning and Enabling SLP (Tasks)</a></p>
<p class="toc level2"><a href="ch.configuration-6.html">9.&nbsp;&nbsp;Administering SLP (Tasks)</a></p>
<p class="toc level2"><a href="legacy-7.html">10.&nbsp;&nbsp;Incorporating Legacy Services</a></p>
<p class="toc level2"><a href="slpreference.html">11.&nbsp;&nbsp;SLP (Reference)</a></p>
<p class="toc level1 tocsp"><a href="mailtm-1.html">Part&nbsp;IV&nbsp;Mail Services Topics</a></p>
<p class="toc level2"><a href="mailintro-1.html">12.&nbsp;&nbsp;Mail Services (Overview)</a></p>
<p class="toc level2"><a href="mailadmin-1.html">13.&nbsp;&nbsp;Mail Services (Tasks)</a></p>
<p class="toc level3"><a href="mailadmin-270.html">Task Map for Mail Services</a></p>
<p class="toc level3"><a href="mailadmin-2.html">Planning Your Mail System</a></p>
<p class="toc level3"><a href="mailadmin-263.html">Setting Up Mail Services (Task Map)</a></p>
<p class="toc level3"><a href="mailadmin-13.html">Setting Up Mail Services</a></p>
<p class="toc level4"><a href="mailadmin-13.html#mailadmin-15">How to Set Up a Mail Server</a></p>
<p class="toc level4"><a href="mailadmin-13.html#mailadmin-20">How to Set Up a Mail Client</a></p>
<p class="toc level4"><a href="mailadmin-13.html#mailadmin-29">How to Set Up a Mail Host</a></p>
<p class="toc level4"><a href="mailadmin-13.html#mailadmin-37">How to Set Up a Mail Gateway</a></p>
<p class="toc level4"><a href="mailadmin-13.html#mailadmin-122">How to Use DNS With <tt>sendmail</tt></a></p>
<p class="toc level3 tocsp"><a href="mailadmin-43.html">Building the <tt>sendmail.cf</tt> Configuration File</a></p>
<p class="toc level4"><a href="mailadmin-43.html#mailadmin-44">How to Build a New <tt>sendmail.cf</tt> File</a></p>
<p class="toc level3 tocsp"><a href="ganav.html">Setting SMTP to Use TLS</a></p>
<p class="toc level4"><a href="ganav.html#fxcty">How to Set SMTP to Use TLS</a></p>
<p class="toc level3 tocsp"><a href="mailadmin-377.html">Managing Mail Delivery by Using an Alternate Configuration</a></p>
<p class="toc level4"><a href="mailadmin-377.html#mailadmin-378">How to Manage Mail Delivery by Using an Alternate Configuration of <tt>sendmail.cf</tt></a></p>
<p class="toc level3 tocsp"><a href="mailadmin-260.html">Administering Mail Alias Files (Task Map)</a></p>
<p class="toc level3"><a href="mailadmin-52.html">Administering Mail Alias Files</a></p>
<p class="toc level4"><a href="mailadmin-52.html#mailadmin-345">How to Initiate an NIS+ <tt>mail_aliases</tt> Table</a></p>
<p class="toc level4"><a href="mailadmin-52.html#mailadmin-327">How to List the Contents of the NIS+ <tt>mail_aliases</tt> Table</a></p>
<p class="toc level4"><a href="mailadmin-52.html#mailadmin-330">How to Add Aliases to the NIS+ <tt>mail_aliases</tt> Table From the Command Line</a></p>
<p class="toc level4"><a href="mailadmin-52.html#mailadmin-331">How to Add Entries by Editing an NIS+ <tt>mail_aliases</tt> Table</a></p>
<p class="toc level4"><a href="mailadmin-52.html#mailadmin-332">How to Edit Entries in an NIS+ <tt>mail_aliases</tt> Table</a></p>
<p class="toc level4"><a href="mailadmin-52.html#mailadmin-93">How to Set Up an NIS <tt>mail.aliases</tt> Map</a></p>
<p class="toc level4"><a href="mailadmin-52.html#mailadmin-106">How to Set Up a Local Mail Alias File</a></p>
<p class="toc level4"><a href="mailadmin-52.html#mailadmin-118">How to Create a Keyed Map File</a></p>
<p class="toc level3 tocsp"><a href="mailadmin-262.html">Administering the Queue Directories (Task Map)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Administering the Queue Directories</a></p>
<p class="toc level4"><a href="#eyhyo">How to Display the Contents of the Mail Queue, <tt>/var/spool/mqueue</tt></a></p>
<p class="toc level4"><a href="#mailadmin-142">How to Force Mail Queue Processing in the Mail Queue, <tt>/var/spool/mqueue</tt></a></p>
<p class="toc level4"><a href="#mailadmin-145">How to Run a Subset of the Mail Queue, <tt>/var/spool/mqueue</tt></a></p>
<p class="toc level4"><a href="#mailadmin-148">How to Move the Mail Queue, <tt>/var/spool/mqueue</tt></a></p>
<p class="toc level4"><a href="#mailadmin-156">How to Run the Old Mail Queue, <tt>/var/spool/omqueue</tt></a></p>
</div>
<p class="toc level3 tocsp"><a href="mailadmin-264.html">Administering <tt>.forward</tt> Files (Task Map)</a></p>
<p class="toc level3"><a href="mailadmin-160.html">Administering <tt>.forward</tt> Files</a></p>
<p class="toc level4"><a href="mailadmin-160.html#mailadmin-161">How to Disable <tt>.forward</tt> Files</a></p>
<p class="toc level4"><a href="mailadmin-160.html#mailadmin-167">How to Change the <tt>.forward</tt>-File Search Path</a></p>
<p class="toc level4"><a href="mailadmin-160.html#mailadmin-173">How to Create and Populate <tt>/etc/shells</tt></a></p>
<p class="toc level3 tocsp"><a href="mailadmin-265.html">Troubleshooting Procedures and Tips for Mail Services (Task Map)</a></p>
<p class="toc level3"><a href="mailadmin-180.html">Troubleshooting Procedures and Tips for Mail Services</a></p>
<p class="toc level4"><a href="mailadmin-180.html#mailadmin-181">How to Test the Mail Configuration</a></p>
<p class="toc level4"><a href="mailadmin-180.html#mailadmin-195">How to Test the <tt>sendmail</tt> Rule Sets</a></p>
<p class="toc level3 tocsp"><a href="mailadmin-219.html">Resolving Error Messages</a></p>
<p class="toc level2 tocsp"><a href="mailrefer-1.html">14.&nbsp;&nbsp;Mail Services (Reference)</a></p>
<p class="toc level1 tocsp"><a href="modemtm-1.html">Part&nbsp;V&nbsp;Serial Networking Topics</a></p>
<p class="toc level2"><a href="pppsvrconfig.intro-1.html">15.&nbsp;&nbsp;Solaris PPP 4.0 (Overview)</a></p>
<p class="toc level2"><a href="pppsvrconfig.p2plink-1.html">16.&nbsp;&nbsp;Planning for the PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.dialin-1.html">17.&nbsp;&nbsp;Setting Up a Dial-up PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.leased-1.html">18.&nbsp;&nbsp;Setting Up a Leased-Line PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.auth-1.html">19.&nbsp;&nbsp;Setting Up PPP Authentication (Tasks)</a></p>
<p class="toc level2"><a href="ppp.pppoe-1.html">20.&nbsp;&nbsp;Setting Up a PPPoE Tunnel (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.troubleshoot-1.html">21.&nbsp;&nbsp;Fixing Common PPP Problems (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.reference-1.html">22.&nbsp;&nbsp;Solaris PPP 4.0 (Reference)</a></p>
<p class="toc level2"><a href="pppsvrconfig.convert.app-1.html">23.&nbsp;&nbsp;Migrating From Asynchronous Solaris PPP to Solaris PPP 4.0 (Tasks)</a></p>
<p class="toc level2"><a href="uucpov-1.html">24.&nbsp;&nbsp;UUCP (Overview)</a></p>
<p class="toc level2"><a href="uucptasks-1.html">25.&nbsp;&nbsp;Administering UUCP (Tasks)</a></p>
<p class="toc level2"><a href="uucpref-1.html">26.&nbsp;&nbsp;UUCP (Reference)</a></p>
<p class="toc level1 tocsp"><a href="wwrstm.html">Part&nbsp;VI&nbsp;Working With Remote Systems Topics</a></p>
<p class="toc level2"><a href="wwrsov.html">27.&nbsp;&nbsp;Working With Remote Systems (Overview)</a></p>
<p class="toc level2"><a href="wuftp-17.html">28.&nbsp;&nbsp;Administering the FTP Server (Tasks)</a></p>
<p class="toc level2"><a href="remotehowtoaccess-99941.html">29.&nbsp;&nbsp;Accessing Remote Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="netmonitortm-1.html">Part&nbsp;VII&nbsp;Monitoring Network Services Topics</a></p>
<p class="toc level2"><a href="netmonitor-1.html">30.&nbsp;&nbsp;Monitoring Network Performance (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="mailadmin-138"></a><h3>Administering the Queue Directories</h3>
<p>This section describes some helpful tasks for queue administration. For information about the client-only queue,
refer to <a href="mailrefer-105.html#mailrefer-106"><tt>submit.cf</tt> Configuration File From Version 8.12 of <tt>sendmail</tt></a>. For other related information, you can refer to <a href="mailrefer-105.html#mailrefer-119">Additional Queue Features From Version 8.12 of <tt>sendmail</tt></a>. </p><p>Refer to the following:</p>
<ul><li><p><a href="#eyhyo">How to Display the Contents of the Mail Queue, <tt>/var/spool/mqueue</tt></a></p></li>
<li><p><a href="#mailadmin-142">How to Force Mail Queue Processing in the Mail Queue, <tt>/var/spool/mqueue</tt></a></p></li>
<li><p><a href="#mailadmin-145">How to Run a Subset of the Mail Queue, <tt>/var/spool/mqueue</tt></a></p></li>
<li><p><a href="#mailadmin-148">How to Move the Mail Queue, <tt>/var/spool/mqueue</tt></a></p></li>
<li><p><a href="#mailadmin-156">How to Run the Old Mail Queue, <tt>/var/spool/omqueue</tt></a></p></li></ul>


<a name="eyhyo"></a><h4>How to Display the Contents of the Mail Queue, <tt>/var/spool/mqueue</tt></h4><ul>
<li><b>Show how many messages are in the queue and how fast they are being
cleared from the queue.</b><p>Type the following:</p><pre># <tt><b>/usr/bin/mailq | more</b></tt></pre><p>This command provides the following information.</p>
<ul><li><p>The queue IDs</p></li>
<li><p>The size of the message</p></li>
<li><p>The date that the message entered the queue</p></li>
<li><p>The message status</p></li>
<li><p>The sender and the recipients</p></li></ul>
<p>Additionally, this command now checks for the authorization attribute, <tt>solaris.admin.mail.mailq</tt>. If the check is
successful, the equivalent of specifying the <tt>-bp</tt> flag with <tt>sendmail</tt> is executed. If the check
fails, an error message is printed. By default, this authorization attribute is enabled for all
users. The authorization attribute can be disabled by modifying the user entry in <tt>prof_attr</tt>. For
more information, refer to the man pages for <a href="http://docs.sun.com/doc/819-2251/prof-attr-4?a=view"><tt>prof_attr</tt>(4)</a> and <a href="http://docs.sun.com/doc/819-2239/mailq-1?a=view"><tt>mailq</tt>(1)</a>.</p></li></ul>

<a name="mailadmin-142"></a><h4>How to Force Mail Queue Processing in the Mail Queue, <tt>/var/spool/mqueue</tt></h4><p><a name="indexterm-1194"></a>Use this procedure, for example, to process messages to a system that was previously
unable to receive messages.</p><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.
To configure a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="mailadmin-step-144"></a><b>Force queue processing and display the progress of the jobs as the queue is
cleared.</b><pre># <tt><b>/usr/lib/sendmail -q -v</b></tt> </pre></li></ol>

<a name="mailadmin-145"></a><h4>How to Run a Subset of the Mail Queue, <tt>/var/spool/mqueue</tt></h4><p><a name="indexterm-1195"></a>Use this procedure, for example, to force a substring of an address, such as
a host name, to be processed. Also, use this procedure to force a particular
message from the queue.</p><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.
To configure a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="mailadmin-step-147"></a><b>Run a subset of the mail queue at any time with <tt>-qR</tt><i>string</i>.</b><pre># <tt><b>/usr/lib/sendmail -qR</b></tt><i>string</i></pre><dl><dt><i>string</i></dt>
<dd><p>Use a recipient's alias or a substring of <i>user@host.domain</i>, such as a host name.</p></dd>
</dl>
<p>Alternately, you can run a subset of the mail queue with <tt>-qI</tt><i>nnnnn</i>.</p><pre># <tt><b>/usr/lib/sendmail -qI</b></tt><i>nnnnn</i></pre><dl><dt><i>nnnnn</i></dt>
<dd><p>Use a queue ID.</p></dd>
</dl>
</li></ol>

<a name="mailadmin-148"></a><h4>How to Move the Mail Queue, <tt>/var/spool/mqueue</tt></h4><p><a name="indexterm-1196"></a>If you are moving the mail queue, follow these instructions.</p><ol>
<li><a name="mailadmin-step-150"></a><b>Become <tt>root</tt> on the mail host or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>. To configure a
role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="mailadmin-step-151"></a><b>Kill the <tt>sendmail</tt> daemon. </b><pre># <tt><b>svcadm disable network/smtp:sendmail</b></tt></pre><p>Now <tt>sendmail</tt> is no longer processing the queue directory.</p></li>
<li><a name="mailadmin-step-152"></a><b>Change to the <tt>/var/spool</tt> directory.</b><pre># <tt><b>cd /var/spool</b></tt></pre></li>
<li><a name="mailadmin-step-153"></a><b>Move the directory, <tt>mqueue</tt>, and all its contents to the <tt>omqueue</tt> directory. Then create a
new empty directory that is named <tt>mqueue</tt>.</b><pre># <tt><b>mv mqueue omqueue; mkdir mqueue</b></tt></pre></li>
<li><a name="mailadmin-step-154"></a><b>Set the permissions of the directory to read/write/execute by owner, and read/execute by group. Also,
set the owner and group to <tt>daemon</tt>.</b><pre># <tt><b>chmod 750 mqueue; chown root:bin mqueue</b></tt></pre></li>
<li><a name="mailadmin-step-155"></a><b>Start <tt>sendmail</tt>.</b><pre># <tt><b>svcadm enable network/smtp:sendmail</b></tt></pre></li></ol>

<a name="mailadmin-156"></a><h4>How to Run the Old Mail Queue, <tt>/var/spool/omqueue</tt></h4><p><a name="indexterm-1197"></a><a name="indexterm-1198"></a><a name="indexterm-1199"></a>To run an old mail queue, follow these instructions.</p><ol>
<li><a name="mailadmin-step-374"></a><b>Become <tt>root</tt> or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>. To configure
a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="mailadmin-step-158"></a><b>Run the old mail queue.</b><pre># <tt><b>/usr/lib/sendmail -oQ/var/spool/omqueue -q</b></tt></pre><p>The <tt>-oQ</tt> flag specifies an alternate queue directory. The <tt>-q</tt> flag says to run every
job in the queue. Use the <tt>-v</tt> flag if you are displaying the
verbose output on the screen.</p></li>
<li><a name="mailadmin-step-159"></a><b>Remove the empty directory.</b><pre># <tt><b>rmdir /var/spool/omqueue</b></tt></pre></li></ol>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="mailadmin-262.html">Previous</a>
             </td>
             <td align="right">
                 <a href="mailadmin-264.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

