<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Task Overview for Autofs Administration - System Administration Guide: Network Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: Network Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="rfsadmin-110.html">Previous</a>
             </td>
             <td align="right">
                 <a href="rfsadmin-214.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="netservices-1.html">Part&nbsp;I&nbsp;Network Services Topics</a></p>
<p class="toc level2"><a href="nsov-1.html">1.&nbsp;&nbsp;Network Service (Overview)</a></p>
<p class="toc level2"><a href="nca-1.html">2.&nbsp;&nbsp;Managing Web Cache Servers</a></p>
<p class="toc level2"><a href="time-1.html">3.&nbsp;&nbsp;Time-Related Services</a></p>
<p class="toc level1 tocsp"><a href="rfstm-1.html">Part&nbsp;II&nbsp;Accessing Network File Systems Topics</a></p>
<p class="toc level2"><a href="rfsintro-2.html">4.&nbsp;&nbsp;Managing Network File Systems (Overview)</a></p>
<p class="toc level2"><a href="rfsadmin-8.html">5.&nbsp;&nbsp;Network File System Administration (Tasks)</a></p>
<p class="toc level3"><a href="rfsadmin-56.html">Automatic File-System Sharing</a></p>
<p class="toc level4"><a href="rfsadmin-56.html#rfsadmin-57">How to Set Up Automatic File-System Sharing</a></p>
<p class="toc level4"><a href="rfsadmin-56.html#rfsadmin-112">How to Enable WebNFS Access</a></p>
<p class="toc level4"><a href="rfsadmin-56.html#rfsadmin-101">How to Enable NFS Server Logging</a></p>
<p class="toc level3 tocsp"><a href="rfsadmin-61.html">Mounting File Systems</a></p>
<p class="toc level4"><a href="rfsadmin-61.html#rfsadmin-62">How to Mount a File System at Boot Time</a></p>
<p class="toc level4"><a href="rfsadmin-61.html#rfsadmin-66">How to Mount a File System From the Command Line</a></p>
<p class="toc level4"><a href="rfsadmin-61.html#rfsadmin-75">How to Disable Large Files on an NFS Server</a></p>
<p class="toc level4"><a href="rfsadmin-61.html#rfsadmin-81">How to Use Client-Side Failover</a></p>
<p class="toc level4"><a href="rfsadmin-61.html#rfsadmin-84">How to Disable Mount Access for One Client</a></p>
<p class="toc level4"><a href="rfsadmin-61.html#rfsadmin-88">How to Mount an NFS File System Through a Firewall</a></p>
<p class="toc level4"><a href="rfsadmin-61.html#rfsadmin-92">How to Mount an NFS File System Using an NFS URL</a></p>
<p class="toc level3 tocsp"><a href="rfsadmin-68.html">Setting Up NFS Services</a></p>
<p class="toc level4"><a href="rfsadmin-68.html#rfsadmin-69">How to Start the NFS Services</a></p>
<p class="toc level4"><a href="rfsadmin-68.html#rfsadmin-72">How to Stop the NFS Services</a></p>
<p class="toc level4"><a href="rfsadmin-68.html#rfsadmin-121">How to Start the Automounter</a></p>
<p class="toc level4"><a href="rfsadmin-68.html#rfsadmin-124">How to Stop the Automounter</a></p>
<p class="toc level4"><a href="rfsadmin-68.html#rfsadmin-965">How to Select Different Versions of NFS on a Server</a></p>
<p class="toc level4"><a href="rfsadmin-68.html#rfsadmin-966">How to Select Different Versions of NFS on a Client by Modifying the <tt>/etc/default/nfs</tt> File</a></p>
<p class="toc level4"><a href="rfsadmin-68.html#ekqwg">How to Use the Command Line to Select Different Versions of NFS on a Client</a></p>
<p class="toc level3 tocsp"><a href="rfsadmin-96.html">Administering the Secure NFS System</a></p>
<p class="toc level4"><a href="rfsadmin-96.html#rfsadmin-97">How to Set Up a Secure NFS Environment With DH Authentication</a></p>
<p class="toc level3 tocsp"><a href="rfsadmin-110.html">WebNFS Administration Tasks</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Task Overview for Autofs Administration</a></p>
<p class="toc level4"><a href="#rfsadmin-250">How to Use the <tt>/etc/default/autofs</tt> File</a></p>
<p class="toc level4"><a href="#rfsadmin-133">How to Modify the Master Map</a></p>
<p class="toc level4"><a href="#rfsadmin-139">How to Modify Indirect Maps</a></p>
<p class="toc level4"><a href="#rfsadmin-142">How to Modify Direct Maps</a></p>
<p class="toc level4"><a href="#rfsadmin-149">How to Access CD-ROM Applications With Autofs</a></p>
<p class="toc level4"><a href="#rfsadmin-152">How to Access PC-DOS Data Diskettes With Autofs</a></p>
<p class="toc level4"><a href="#rfsadmin-156">How to Access NFS File Systems by Using CacheFS</a></p>
<p class="toc level4"><a href="#rfsadmin-162">How to Set Up <tt>/home</tt> With Multiple Home Directory File Systems</a></p>
<p class="toc level4"><a href="#rfsadmin-166">How to Consolidate Project-Related Files Under <tt>/ws</tt></a></p>
<p class="toc level4"><a href="#rfsadmin-171">How to Set Up Different Architectures to Access a Shared Namespace</a></p>
<p class="toc level4"><a href="#rfsadmin-179">How to Support Incompatible Client Operating System Versions</a></p>
<p class="toc level4"><a href="#rfsadmin-183">How to Replicate Shared Files Across Several Servers</a></p>
<p class="toc level4"><a href="#rfsadmin-186">How to Apply Autofs Security Restrictions</a></p>
<p class="toc level4"><a href="#rfsadmin-189">How to Use a Public File Handle With Autofs</a></p>
<p class="toc level4"><a href="#rfsadmin-192">How to Use NFS URLs With Autofs</a></p>
<p class="toc level4"><a href="#rfsadmin-196">How to Completely Disable Autofs Browsability on a Single NFS Client</a></p>
<p class="toc level4"><a href="#rfsadmin-200">How to Disable Autofs Browsability for All Clients</a></p>
<p class="toc level4"><a href="#rfsadmin-204">How to Disable Autofs Browsability on a Selected File System</a></p>
</div>
<p class="toc level3 tocsp"><a href="rfsadmin-214.html">Strategies for NFS Troubleshooting</a></p>
<p class="toc level3"><a href="rfsadmin-215.html">NFS Troubleshooting Procedures</a></p>
<p class="toc level4"><a href="rfsadmin-215.html#rfsadmin-216">How to Check Connectivity on an NFS Client</a></p>
<p class="toc level4"><a href="rfsadmin-215.html#rfsadmin-224">How to Check the NFS Server Remotely</a></p>
<p class="toc level4"><a href="rfsadmin-215.html#rfsadmin-231">How to Verify the NFS Service on the Server</a></p>
<p class="toc level4"><a href="rfsadmin-215.html#rfsadmin-240">How to Restart NFS Services</a></p>
<p class="toc level4"><a href="rfsadmin-215.html#rfsadmin-243">How to Warm-Start <tt>rpcbind</tt></a></p>
<p class="toc level4"><a href="rfsadmin-215.html#rfsadmin-251">How to Verify Options Used With the <tt>mount</tt> Command</a></p>
<p class="toc level3 tocsp"><a href="rfsadmin-210.html">Troubleshooting Autofs</a></p>
<p class="toc level3"><a href="rfsadmin-255.html">NFS Error Messages</a></p>
<p class="toc level2 tocsp"><a href="rfsrefer-1.html">6.&nbsp;&nbsp;Accessing Network File Systems (Reference)</a></p>
<p class="toc level1 tocsp"><a href="slptm.html">Part&nbsp;III&nbsp;SLP Topics</a></p>
<p class="toc level2"><a href="slparch-16.html">7.&nbsp;&nbsp;SLP (Overview)</a></p>
<p class="toc level2"><a href="slp.setup-10.html">8.&nbsp;&nbsp;Planning and Enabling SLP (Tasks)</a></p>
<p class="toc level2"><a href="ch.configuration-6.html">9.&nbsp;&nbsp;Administering SLP (Tasks)</a></p>
<p class="toc level2"><a href="legacy-7.html">10.&nbsp;&nbsp;Incorporating Legacy Services</a></p>
<p class="toc level2"><a href="slpreference.html">11.&nbsp;&nbsp;SLP (Reference)</a></p>
<p class="toc level1 tocsp"><a href="mailtm-1.html">Part&nbsp;IV&nbsp;Mail Services Topics</a></p>
<p class="toc level2"><a href="mailintro-1.html">12.&nbsp;&nbsp;Mail Services (Overview)</a></p>
<p class="toc level2"><a href="mailadmin-1.html">13.&nbsp;&nbsp;Mail Services (Tasks)</a></p>
<p class="toc level2"><a href="mailrefer-1.html">14.&nbsp;&nbsp;Mail Services (Reference)</a></p>
<p class="toc level1 tocsp"><a href="modemtm-1.html">Part&nbsp;V&nbsp;Serial Networking Topics</a></p>
<p class="toc level2"><a href="pppsvrconfig.intro-1.html">15.&nbsp;&nbsp;Solaris PPP 4.0 (Overview)</a></p>
<p class="toc level2"><a href="pppsvrconfig.p2plink-1.html">16.&nbsp;&nbsp;Planning for the PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.dialin-1.html">17.&nbsp;&nbsp;Setting Up a Dial-up PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.leased-1.html">18.&nbsp;&nbsp;Setting Up a Leased-Line PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.auth-1.html">19.&nbsp;&nbsp;Setting Up PPP Authentication (Tasks)</a></p>
<p class="toc level2"><a href="ppp.pppoe-1.html">20.&nbsp;&nbsp;Setting Up a PPPoE Tunnel (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.troubleshoot-1.html">21.&nbsp;&nbsp;Fixing Common PPP Problems (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.reference-1.html">22.&nbsp;&nbsp;Solaris PPP 4.0 (Reference)</a></p>
<p class="toc level2"><a href="pppsvrconfig.convert.app-1.html">23.&nbsp;&nbsp;Migrating From Asynchronous Solaris PPP to Solaris PPP 4.0 (Tasks)</a></p>
<p class="toc level2"><a href="uucpov-1.html">24.&nbsp;&nbsp;UUCP (Overview)</a></p>
<p class="toc level2"><a href="uucptasks-1.html">25.&nbsp;&nbsp;Administering UUCP (Tasks)</a></p>
<p class="toc level2"><a href="uucpref-1.html">26.&nbsp;&nbsp;UUCP (Reference)</a></p>
<p class="toc level1 tocsp"><a href="wwrstm.html">Part&nbsp;VI&nbsp;Working With Remote Systems Topics</a></p>
<p class="toc level2"><a href="wwrsov.html">27.&nbsp;&nbsp;Working With Remote Systems (Overview)</a></p>
<p class="toc level2"><a href="wuftp-17.html">28.&nbsp;&nbsp;Administering the FTP Server (Tasks)</a></p>
<p class="toc level2"><a href="remotehowtoaccess-99941.html">29.&nbsp;&nbsp;Accessing Remote Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="netmonitortm-1.html">Part&nbsp;VII&nbsp;Monitoring Network Services Topics</a></p>
<p class="toc level2"><a href="netmonitor-1.html">30.&nbsp;&nbsp;Monitoring Network Performance (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="rfsadmin-127"></a><h3>Task Overview for Autofs Administration</h3>
<p>This section describes some of the most common tasks you might encounter in
your own environment. Recommended procedures are included for each scenario to help you
configure autofs to best meet your clients' needs. To perform the tasks that
are discussed in this section, use the Solaris Management Console tools or see
the <a href="http://docs.sun.com/doc/819-3195"><i>System Administration Guide: Naming and Directory Services (NIS+)</i></a>.</p>
<hr><p><b>Note - </b>Starting in the Solaris 10 release, you can also use the <tt>/etc/default/autofs</tt>
file to configure your autofs environment. For task information, refer to <a href="#rfsadmin-249">Using the <tt>/etc/default/autofs</tt> File to Configure Your autofs Environment</a>.</p>
<hr>


<a name="rfsadmin-60"></a><h4>Task Map for Autofs Administration</h4>
<p>The following table provides a description and a pointer to many of the
tasks that are related to autofs.</p><a name="rfsadmin-tbl-59"></a><h6>Table&nbsp;5-5 Task Map for Autofs Administration</h6><table><col width="110*"><col width="167*"><col width="119*"><tr><th align="left" valign="top" scope="column"><p>Task</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>For Instructions</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Start autofs</p></td>
<td align="left" valign="top" scope="row"><p>Start the automount service without
having to reboot the system</p></td>
<td align="left" valign="top" scope="row"><p><a href="rfsadmin-68.html#rfsadmin-121">How to Start the Automounter</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Stop autofs</p></td>
<td align="left" valign="top" scope="row"><p>Stop the automount service without disabling other
network services</p></td>
<td align="left" valign="top" scope="row"><p><a href="rfsadmin-68.html#rfsadmin-124">How to Stop the Automounter</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Configure your autofs environment by using the <tt>/etc/default/autofs</tt> file</p></td>
<td align="left" valign="top" scope="row"><p>Assign values to
keywords in the <tt>/etc/default/autofs</tt> file</p></td>
<td align="left" valign="top" scope="row"><p><a href="#rfsadmin-249">Using the <tt>/etc/default/autofs</tt> File to Configure Your autofs Environment</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Access file systems by using autofs</p></td>
<td align="left" valign="top" scope="row"><p>Access file systems
by using the automount service</p></td>
<td align="left" valign="top" scope="row"><p><a href="rfsadmin-61.html#rfsadmin-67">Mounting With the Automounter</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Modify the autofs maps</p></td>
<td align="left" valign="top" scope="row"><p>Steps to modify the master
map, which should be used to list other maps</p></td>
<td align="left" valign="top" scope="row"><p><a href="#rfsadmin-133">How to Modify the Master Map</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"></td>
<td align="left" valign="top" scope="row"><p>Steps to modify an
indirect map, which should be used for most maps</p></td>
<td align="left" valign="top" scope="row"><p><a href="#rfsadmin-139">How to Modify Indirect Maps</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"></td>
<td align="left" valign="top" scope="row"><p>Steps to modify a
direct map, which should be used when a direct association between a mount
point on a client and a server is required</p></td>
<td align="left" valign="top" scope="row"><p><a href="#rfsadmin-142">How to Modify Direct Maps</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Modify the autofs maps
to access non-NFS file systems</p></td>
<td align="left" valign="top" scope="row"><p>Steps to set up an autofs map with
an entry for a CD-ROM application</p></td>
<td align="left" valign="top" scope="row"><p><a href="#rfsadmin-149">How to Access CD-ROM Applications With Autofs</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"></td>
<td align="left" valign="top" scope="row"><p>Steps to set up an autofs map
with an entry for a PC-DOS diskette</p></td>
<td align="left" valign="top" scope="row"><p><a href="#rfsadmin-152">How to Access PC-DOS Data Diskettes With Autofs</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"></td>
<td align="left" valign="top" scope="row"><p>Steps to use autofs to access
a CacheFS file system</p></td>
<td align="left" valign="top" scope="row"><p><a href="#rfsadmin-156">How to Access NFS File Systems by Using CacheFS</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Using <tt>/home</tt></p></td>
<td align="left" valign="top" scope="row"><p>Example of how to set up a common
<tt>/home</tt> map</p></td>
<td align="left" valign="top" scope="row"><p><a href="#rfsadmin-161">Setting Up a Common View of <tt>/home</tt></a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"></td>
<td align="left" valign="top" scope="row"><p>Steps to set up a <tt>/home</tt> map that refers to multiple file
systems</p></td>
<td align="left" valign="top" scope="row"><p><a href="#rfsadmin-162">How to Set Up <tt>/home</tt> With Multiple Home Directory File Systems</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Using a new autofs mount point</p></td>
<td align="left" valign="top" scope="row"><p>Steps to set up a project-related autofs
map</p></td>
<td align="left" valign="top" scope="row"><p><a href="#rfsadmin-166">How to Consolidate Project-Related Files Under <tt>/ws</tt></a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"></td>
<td align="left" valign="top" scope="row"><p>Steps to set up an autofs map that supports different client architectures</p></td>
<td align="left" valign="top" scope="row"><p><a href="#rfsadmin-171">How to Set Up Different Architectures to Access a Shared Namespace</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"></td>
<td align="left" valign="top" scope="row"><p>Steps
to set up an autofs map that supports different operating systems</p></td>
<td align="left" valign="top" scope="row"><p><a href="#rfsadmin-179">How to Support Incompatible Client Operating System Versions</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Replicate file
systems with autofs</p></td>
<td align="left" valign="top" scope="row"><p>Provide access to file systems that fail over</p></td>
<td align="left" valign="top" scope="row"><p><a href="#rfsadmin-183">How to Replicate Shared Files Across Several Servers</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Using security restrictions
with autofs</p></td>
<td align="left" valign="top" scope="row"><p>Provide access to file systems while restricting remote <tt>root</tt> access to the
files</p></td>
<td align="left" valign="top" scope="row"><p><a href="#rfsadmin-186">How to Apply Autofs Security Restrictions</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Using a public file handle with autofs</p></td>
<td align="left" valign="top" scope="row"><p>Force use of the public file
handle when mounting a file system</p></td>
<td align="left" valign="top" scope="row"><p><a href="#rfsadmin-189">How to Use a Public File Handle With Autofs</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Using an NFS URL with autofs</p></td>
<td align="left" valign="top" scope="row"><p>Add an
NFS URL so that the automounter can use it</p></td>
<td align="left" valign="top" scope="row"><p><a href="#rfsadmin-192">How to Use NFS URLs With Autofs</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Disable autofs browsability</p></td>
<td align="left" valign="top" scope="row"><p>Steps to
disable browsability so that autofs mount points are not automatically populated on a
single client</p></td>
<td align="left" valign="top" scope="row"><p><a href="#rfsadmin-196">How to Completely Disable Autofs Browsability on a Single NFS Client</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"></td>
<td align="left" valign="top" scope="row"><p>Steps to disable browsability so that autofs mount points are not
automatically populated on all clients</p></td>
<td align="left" valign="top" scope="row"><p><a href="#rfsadmin-200">How to Disable Autofs Browsability for All Clients</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"></td>
<td align="left" valign="top" scope="row"><p>Steps to disable browsability so that a specific autofs
mount point is  not automatically populated on a client</p></td>
<td align="left" valign="top" scope="row"><p><a href="#rfsadmin-204">How to Disable Autofs Browsability on a Selected File System</a></p></td>
</tr>
</table>

<a name="rfsadmin-249"></a><h4>Using the <tt>/etc/default/autofs</tt> File to Configure Your autofs Environment</h4>
<a name="indexterm-285"></a><p>Starting in the Solaris 10 release, you can use the <tt>/etc/default/autofs</tt> file
to configure your autofs environment. Specifically, this file provides an additional way to
configure your autofs commands and autofs daemons. The same specifications you would make
on the command line can be made in this configuration file. You can
make your specifications by providing values to keywords. For more information, refer to
<a href="rfsrefer-6.html#rfsrefer-146"><tt>/etc/default/autofs</tt> File</a>.</p><p>The following procedure shows you how to use the <tt>/etc/default/autofs</tt> file.</p>

<a name="rfsadmin-250"></a><h4>How to Use the <tt>/etc/default/autofs</tt> File</h4><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.
To configure a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b>Add or modify an entry in the <tt>/etc/default/autofs</tt> file.</b><p>For example, if you want to turn off browsing for all autofs mount
points, you could add the following line.</p><pre><tt><b>AUTOMOUNTD_NOBROWSE=ON</b></tt></pre><p>This keyword is the equivalent of the <tt>-n</tt> argument for <tt>automountd</tt>. For
a list of keywords, refer to <a href="rfsrefer-6.html#rfsrefer-146"><tt>/etc/default/autofs</tt> File</a>.</p></li>
<li><b>Restart the autofs daemon. </b><p>Type the following command:</p><pre># <tt><b>svcadm restart system/filesystem/autofs</b></tt></pre></li></ol>

<a name="rfsadmin-128"></a><h4>Administrative Tasks Involving Maps</h4>
<p><a name="indexterm-286"></a><a name="indexterm-287"></a>The following tables describe several of the factors you need to be aware
of when administering autofs maps. Your choice of map and name service affect
the mechanism that you need to use to make changes to the
autofs maps. </p><p><a name="indexterm-288"></a><a name="indexterm-289"></a>The following table describes the types of maps and their uses.</p><a name="rfsadmin-tbl-129"></a><h6>Table&nbsp;5-6 Types of autofs Maps and Their Uses</h6><table><col width="2*"><col width="7*"><tr><th align="left" valign="top" scope="column"><p>Type of
Map</p></th>
<th align="left" valign="top" scope="column"><p>Use</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><a name="indexterm-290"></a>Master </p></td>
<td align="left" valign="top" scope="row"><p>Associates a directory with a map</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><a name="indexterm-291"></a>Direct </p></td>
<td align="left" valign="top" scope="row"><p>Directs autofs to specific file
systems</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><a name="indexterm-292"></a>Indirect </p></td>
<td align="left" valign="top" scope="row"><p>Directs autofs to reference-oriented file systems</p></td>
</tr>
</table><p><a name="indexterm-293"></a><a name="indexterm-294"></a>The following table describes how to make changes to your autofs environment that
are  based on your name service.  </p><a name="rfsadmin-tbl-130"></a><h6>Table&nbsp;5-7 Map Maintenance</h6><table><col width="2*"><col width="2*"><tr><th align="left" valign="top" scope="column"><p>Name Service</p></th>
<th align="left" valign="top" scope="column"><p>Method</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Local files</p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-295"></a>Text editor</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>NIS</p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-296"></a><tt>make</tt>
files</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>NIS+</p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-297"></a><tt>nistbladm</tt></p></td>
</tr>
</table><p><a name="indexterm-298"></a><a name="indexterm-299"></a>The next table tells you when to run the <tt>automount</tt> command, depending on
the modification you have made to the type of map. For example, if
you have made an addition or a deletion to a direct map,
you need to run the <tt>automount</tt> command on the local system. By running
the command, you make the change effective. However, if you have modified an
existing entry, you do not need to run the <tt>automount</tt> command for the change
to become effective. </p><a name="rfsadmin-tbl-131"></a><h6>Table&nbsp;5-8 When to Run the <tt>automount</tt> Command</h6><table><col width="2*"><col width="3*"><col width="3*"><tr><th align="left" valign="top" scope="column"><p>Type of Map</p></th>
<th align="left" valign="top" scope="column"><p>Restart <tt>automount</tt>?</p></th>
<th align="left" valign="top" scope="column"><p></p></th>
</tr>
<tr><th align="left" valign="top" scope="column"><p></p></th>
<th align="left" valign="top" scope="column"><p>Addition or Deletion</p></th>
<th align="left" valign="top" scope="column"><p>Modification</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><a name="indexterm-300"></a><tt>auto_master</tt> </p></td>
<td align="left" valign="top" scope="row"><p><tt>Y</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>Y</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><a name="indexterm-301"></a><tt>direct</tt> </p></td>
<td align="left" valign="top" scope="row"><p><tt>Y</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>N</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><a name="indexterm-302"></a><tt>indirect</tt> </p></td>
<td align="left" valign="top" scope="row"><p><tt>N</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>N</tt></p></td>
</tr>
</table>

<a name="rfsadmin-132"></a><h4>Modifying the Maps</h4>
<p>The following procedures require that you use NIS+ as your name service.</p>

<a name="rfsadmin-133"></a><h4>How to Modify the Master Map</h4><ol>
<li><a name="rfsadmin-step-211"></a><b>Log in as a user who has permissions to change the maps.</b></li>
<li><a name="rfsadmin-step-135"></a><b><a name="indexterm-303"></a><a name="indexterm-304"></a><a name="indexterm-305"></a><a name="indexterm-306"></a>Using the <tt>nistbladm</tt> command, make your changes to the master map.  
</b><p>See the <a href="http://docs.sun.com/doc/819-3195"><i>System Administration Guide: Naming and Directory Services (NIS+)</i></a>.</p></li>
<li><a name="rfsadmin-step-136"></a><b>For each client, become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.
To configure a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="rfsadmin-step-137"></a><b><a name="indexterm-307"></a>For each client, run the <tt>automount</tt> command to ensure that your changes become
effective.</b></li>
<li><a name="rfsadmin-step-138"></a><b>Notify your users of the changes. </b><p>Notification is required so that the users can also run the <tt>automount</tt>
command as superuser on their own computers. Note that the <tt>automount</tt> command
gathers information from the master map whenever it is run.</p></li></ol>

<a name="rfsadmin-139"></a><h4>How to Modify Indirect Maps</h4><ol>
<li><a name="rfsadmin-step-210"></a><b>Log in as a user who has permissions to change the maps.</b></li>
<li><a name="rfsadmin-step-141"></a><b><a name="indexterm-308"></a><a name="indexterm-309"></a><a name="indexterm-310"></a><a name="indexterm-311"></a>Using the <tt>nistbladm</tt> command, make your changes to the indirect map.  </b><p>See the <a href="http://docs.sun.com/doc/819-3195"><i>System Administration Guide: Naming and Directory Services (NIS+)</i></a>. Note that the change becomes effective the next time that
the map is used, which is the next time a mount is performed.</p></li></ol>

<a name="rfsadmin-142"></a><h4>How to Modify Direct Maps</h4><ol>
<li><a name="rfsadmin-step-212"></a><b>Log in as a user who has permissions to change the maps.</b></li>
<li><a name="rfsadmin-step-144"></a><b><a name="indexterm-312"></a><a name="indexterm-313"></a><a name="indexterm-314"></a><a name="indexterm-315"></a>Using the <tt>nistbladm</tt> command, add or delete your changes to the direct map.
 </b><p>See the <a href="http://docs.sun.com/doc/819-3195"><i>System Administration Guide: Naming and Directory Services (NIS+)</i></a>.</p></li>
<li><a name="rfsadmin-step-145"></a><b><a name="indexterm-316"></a>If you added or deleted a mount-point entry in the previous step, run
the <tt>automount</tt> command.</b></li>
<li><a name="rfsadmin-step-146"></a><b>Notify your users of the changes. </b><p>Notification is required so that the users can also run the <tt>automount</tt>
command as superuser on their own computers.</p>
<hr><p><b>Note - </b>If you only modify or change the contents of an existing direct map
entry, you do not need to run the <tt>automount</tt> command. </p>
<hr>
<p>For example, suppose you modify the <tt>auto_direct</tt> map so that the <tt>/usr/src</tt> directory
is now mounted from a different server. If <tt>/usr/src</tt> is not mounted at
this time, the new entry becomes effective immediately when you try to access
<tt>/usr/src</tt>. If <tt>/usr/src</tt> is mounted now, you can wait until the auto-unmounting occurs,
then access the file. </p>
<hr><p><b>Note - </b>Use indirect maps whenever possible. Indirect maps are easier to construct and less
demanding on the computers' file systems. Also, indirect maps do not occupy as
much space in the mount table as direct maps.</p>
<hr>
</li></ol>

<a name="rfsadmin-147"></a><h4>Avoiding Mount-Point Conflicts</h4>
<p><a name="indexterm-317"></a><a name="indexterm-318"></a><a name="indexterm-319"></a>If you have a local disk partition that is mounted on <tt>/src</tt>
and you plan to use the autofs service to mount other source directories,
you might encounter a problem. If you specify the mount point <tt>/src</tt>, the NFS
service hides the local partition whenever you try to reach it. 
 </p><p>You need to mount the partition in some other location, for example, on
<tt>/export/src</tt>. You then need an entry in <tt>/etc/vfstab</tt> such as the following:</p><pre><tt>/dev/dsk/d0t3d0s5 /dev/rdsk/c0t3d0s5 /export/src ufs 3 yes -</tt> </pre><p>You also need this entry in <tt>auto_src</tt>: </p><pre>terra        terra:/export/src </pre><p><tt>terra</tt> is the name of the computer.</p>

<a name="rfsadmin-148"></a><h4>Accessing Non-NFS File Systems</h4>
<p><a name="indexterm-320"></a><a name="indexterm-321"></a>Autofs can also mount files other than NFS files. Autofs mounts files on
removable media, such as diskettes or CD-ROM. Normally, you would mount files on
removable media by using the Volume Manager. The following examples show how this
mounting could be accomplished through autofs. The Volume Manager and autofs do not
work together, so these entries would not be used without first deactivating the
Volume Manager.  </p><p>Instead of mounting a file system from a server, you put the
media in the drive and reference the file system from the map. If
you plan to access non-NFS file systems and you are using autofs, see
the following procedures.</p>

<a name="rfsadmin-149"></a><h4>How to Access CD-ROM Applications With Autofs</h4>
<hr><p><b>Note - </b><a name="indexterm-322"></a>Use this procedure if you are <b>not</b> using Volume Manager. </p>
<hr>
<ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.
To configure a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="rfsadmin-step-151"></a><b>Update the autofs map.</b><p>Add an entry for the CD-ROM file system, which should resemble the following:</p><pre>hsfs     -fstype=hsfs,ro     :/dev/sr0</pre><p><a name="indexterm-323"></a><a name="indexterm-324"></a><a name="indexterm-325"></a>The CD-ROM device that you intend to mount must appear as a
name that follows the colon.</p></li></ol>

<a name="rfsadmin-152"></a><h4>How to Access PC-DOS Data Diskettes With Autofs</h4>
<hr><p><b>Note - </b><a name="indexterm-326"></a><a name="indexterm-327"></a><a name="indexterm-328"></a>Use this procedure if you are <b>not</b> using Volume Manager.   </p>
<hr>
<ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.
To configure a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="rfsadmin-step-154"></a><b>Update the autofs map.</b><p><a name="indexterm-329"></a><a name="indexterm-330"></a><a name="indexterm-331"></a><a name="indexterm-332"></a><a name="indexterm-333"></a>Add an entry for the diskette file system such as the following:</p><pre> pcfs     -fstype=pcfs     :/dev/diskette</pre></li></ol>

<a name="rfsadmin-155"></a><h4>Accessing NFS File Systems Using CacheFS</h4>
<p><a name="indexterm-334"></a><a name="indexterm-335"></a>The cache file system (CacheFS) is a generic nonvolatile caching mechanism. CacheFS improves
the performance of certain file systems by utilizing a small, fast local disk.
For example, you can improve the performance of the NFS environment by using
CacheFS.</p><p>CacheFS works differently with different versions of NFS. For example, if both the
client and the back file system are running NFS version 2 or
version 3, the files are cached in the front file system for access
by the client. However, if both the client and the server are running
NFS version 4, the functionality is as follows. When the client makes the
initial request to access a file from a CacheFS file system, the request
bypasses the front (or cached) file system and goes directly to the back
file system. With NFS version 4, files are no longer cached in a
front file system.  All file access is provided by the back file
system.  Also, since no files are being cached in the front file
system, CacheFS-specific mount options, which are meant to affect the front file system,
are ignored.  CacheFS-specific mount options do not apply to the back file
system.</p>
<hr><p><b>Note - </b>The first time you configure your system for NFS version 4, a warning
appears on the console to indicate that caching is no longer performed.</p>
<hr>


<a name="rfsadmin-156"></a><h4>How to Access NFS File Systems by Using CacheFS</h4><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.
To configure a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="rfsadmin-step-158"></a><b><a name="indexterm-336"></a>Run the <tt>cfsadmin</tt> command to create a cache directory on the local disk.
</b><pre># <tt><b>cfsadmin -c /var/cache</b></tt></pre></li>
<li><a name="rfsadmin-step-159"></a><b>Add the <tt>cachefs</tt> entry to the appropriate automounter map.</b><p><a name="indexterm-337"></a><a name="indexterm-338"></a><a name="indexterm-339"></a><a name="indexterm-340"></a>For example, adding this entry to the master map caches all home directories:</p><pre>/home auto_home -fstype=cachefs,cachedir=/var/cache,backfstype=nfs</pre><p>Adding this entry to the <tt>auto_home</tt> map only caches the home directory for
the user who is named <tt>rich</tt>:</p><pre>rich -fstype=cachefs,cachedir=/var/cache,backfstype=nfs dragon:/export/home1/rich</pre>
<hr><p><b>Note - </b><a name="indexterm-341"></a>Options that are included in maps that are searched later override options which
are set in maps that are searched earlier. The last options that are
found are the ones that are used. In the previous example, an
additional entry to the <tt>auto_home</tt> map only needs to include the options in the
master maps if some options required changes. </p>
<hr>
</li></ol>

<a name="rfsadmin-160"></a><h4>Customizing the Automounter</h4>
<p>You can set up the automounter maps in several ways. The following
tasks give details about how to customize the automounter maps to provide an
easy-to-use directory structure.</p>

<a name="rfsadmin-161"></a><h4>Setting Up a Common View of <tt>/home</tt></h4>
<p><a name="indexterm-342"></a><a name="indexterm-343"></a>The ideal is for all network users to be able to locate
their own or anyone's home directory under <tt>/home</tt>. This view should be common across
all computers, whether client or server.   </p><p><a name="indexterm-344"></a>Every Solaris installation comes with a master map: <tt>/etc/auto_master</tt>. </p><pre># Master map for autofs
#
+auto_master
/net     -hosts     -nosuid,nobrowse
/home    auto_home  -nobrowse</pre><p>A map for <tt>auto_home</tt> is also installed under <tt>/etc</tt>. </p><pre># Home directory map for autofs
#
+auto_home</pre><p>Except for a reference to an external <tt>auto_home</tt> map, this map is empty.
If the directories under <tt>/home</tt> are to be common to all computers, do
not modify this <tt>/etc/auto_home</tt> map. All home directory entries should appear in the
name service files, either NIS or NIS+.</p>
<hr><p><b>Note - </b>Users should not be permitted to run <tt>setuid</tt> executables from their home directories.
Without this restriction, any user could have superuser privileges on any computer.</p>
<hr>


<a name="rfsadmin-162"></a><h4>How to Set Up <tt>/home</tt> With Multiple Home Directory File Systems</h4><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.
To configure a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="rfsadmin-step-164"></a><b><a name="indexterm-345"></a><a name="indexterm-346"></a><a name="indexterm-347"></a><a name="indexterm-348"></a>Install home directory partitions under <tt>/export/home</tt>.    </b><p>If the system has several partitions, install the partitions under separate directories, for
example, <tt>/export/home1</tt> and <tt>/export/home2</tt>. </p></li>
<li><a name="rfsadmin-step-165"></a><b>Use the Solaris Management Console tools to create and maintain the <tt>auto_home</tt> map.
</b><p>Whenever you create a new user account, type the location of the user's
home directory in the <tt>auto_home</tt> map. Map entries can be simple, for example: </p><pre>rusty        dragon:/export/home1/&amp;
gwenda       dragon:/export/home1/&amp;
charles      sundog:/export/home2/&amp;
rich         dragon:/export/home3/&amp;</pre><p>Notice the use of the <tt>&amp;</tt> (ampersand) to substitute the map key. The
ampersand is an abbreviation for the second occurrence of <tt>rusty</tt> in the
following example. </p><pre>rusty         dragon:/export/home1/rusty</pre><p>With the <tt>auto_home</tt> map in place, users can refer to any home directory
(including their own) with the path <tt>/home/</tt><i>user</i>. <i>user</i> is their login name
and the key in the map. This common view of all home directories
is valuable when logging in to another user's computer. Autofs mounts your home
directory for you. Similarly, if you run a remote windowing system client on
another computer, the client program has the same view of the <tt>/home</tt> directory.
</p><p>This common view also extends to the server. Using the previous example, if
<tt>rusty</tt> logs in to the server <tt>dragon</tt>, autofs there provides direct access to
the local disk by loopback-mounting <tt>/export/home1/rusty</tt> onto <tt>/home/rusty</tt>. </p><p>Users do not need to be aware of the real location of
their home directories. If <tt>rusty</tt> needs more disk space and needs to have
his home directory relocated to another server, a simple change is sufficient. You need
only change <tt>rusty</tt>'s entry in the <tt>auto_home</tt> map to reflect the new location.
Other users can continue to use the <tt>/home/rusty</tt> path.</p></li></ol>

<a name="rfsadmin-166"></a><h4>How to Consolidate Project-Related Files Under <tt>/ws</tt></h4><p><a name="indexterm-349"></a><a name="indexterm-350"></a><a name="indexterm-351"></a><a name="indexterm-352"></a>Assume that you are the administrator of a large software development project. You
plan to make all project-related files available under a directory that is called
<tt>/ws</tt>. This directory is to be common across all workstations at the site.
   </p><ol>
<li><a name="rfsadmin-step-168"></a><b>Add an entry for the <tt>/ws</tt> directory to the site <tt>auto_master</tt> map, either
NIS or NIS+. </b><pre>/ws     auto_ws     -nosuid </pre><p>The <tt>auto_ws</tt> map determines the contents of the <tt>/ws</tt> directory. </p></li>
<li><a name="rfsadmin-step-269"></a><b>Add the <tt>-nosuid</tt> option as a precaution. </b><p>This option prevents users from running setuid programs that might exist in any
workspaces. </p></li>
<li><a name="rfsadmin-step-270"></a><b>Add entries to the <tt>auto_ws</tt> map.</b><p>The <tt>auto_ws</tt> map is organized so that each entry describes a subproject. Your
first attempt yields a map that resembles the following: </p><pre>compiler   alpha:/export/ws/&amp;
windows    alpha:/export/ws/&amp;
files      bravo:/export/ws/&amp;
drivers    alpha:/export/ws/&amp;
man        bravo:/export/ws/&amp;
tools      delta:/export/ws/&amp;</pre><p>The ampersand (<tt>&amp;</tt>) at the end of each entry is an abbreviation for
the entry key. For instance, the first entry is equivalent to the following:
</p><pre>compiler        alpha:/export/ws/compiler </pre><p>This first attempt provides a map that appears simple, but the map
is inadequate. The project organizer decides that the documentation in the <tt>man</tt> entry
should be provided as a subdirectory under each subproject. Also, each subproject requires
subdirectories to describe several versions of the software. You must assign each of
these subdirectories to an entire disk partition on the server. </p><p>Modify the entries in the map as follows:</p><pre>compiler \
    /vers1.0    alpha:/export/ws/&amp;/vers1.0 \
    /vers2.0    bravo:/export/ws/&amp;/vers2.0 \
    /man        bravo:/export/ws/&amp;/man
windows \
    /vers1.0    alpha:/export/ws/&amp;/vers1.0 \
    /man        bravo:/export/ws/&amp;/man
files \
    /vers1.0    alpha:/export/ws/&amp;/vers1.0 \
    /vers2.0    bravo:/export/ws/&amp;/vers2.0 \
    /vers3.0    bravo:/export/ws/&amp;/vers3.0 \
    /man        bravo:/export/ws/&amp;/man
drivers \
    /vers1.0    alpha:/export/ws/&amp;/vers1.0 \
    /man        bravo:/export/ws/&amp;/man
tools \
    /           delta:/export/ws/&amp;</pre><p>Although the map now appears to be much larger, the map still
contains only the five entries. Each entry is larger because each entry contains
multiple mounts. For instance, a reference to <tt>/ws/compiler</tt> requires three mounts for the <tt>vers1.0</tt>,
<tt>vers2.0</tt>, and <tt>man</tt> directories. The backslash at the end of each line informs autofs
that the entry is continued onto the next line. Effectively, the entry is
one long line, though line breaks and some indenting have been used to
make the entry more readable. The <tt>tools</tt> directory contains software development tools for
all subprojects, so this directory is not subject to the same subdirectory structure.
The <tt>tools</tt> directory continues to be a single mount. </p><p>This arrangement provides the administrator with much flexibility. Software projects typically consume substantial amounts
of disk space. Through the life of the project, you might be
required to relocate and expand various disk partitions. If these changes are reflected in
the <tt>auto_ws</tt> map, the users do not need to be notified, as the
directory hierarchy under <tt>/ws</tt> is not changed. </p><p>Because the servers <tt>alpha</tt> and <tt>bravo</tt> view the same autofs map, any users
who log in to these computers can find the <tt>/ws</tt> namespace as
expected. These users are provided with direct access to local files through loopback
mounts instead of NFS mounts. </p></li></ol>

<a name="rfsadmin-171"></a><h4>How to Set Up Different Architectures to Access a Shared Namespace</h4><p><a name="indexterm-353"></a><a name="indexterm-354"></a>You need to assemble a shared namespace for local executables, and applications, such
as spreadsheet applications and word-processing packages. The clients of this namespace use several
different workstation architectures that require different executable formats. Also, some workstations are running different
releases of the operating system.  </p><ol>
<li><a name="rfsadmin-step-173"></a><b>Create the <tt>auto_local</tt> map with the <tt>nistbladm</tt> command. </b><p>See the <a href="http://docs.sun.com/doc/819-3195"><i>System Administration Guide: Naming and Directory Services (NIS+)</i></a>.</p></li>
<li><a name="rfsadmin-step-174"></a><b>Choose a single, site-specific name for the shared namespace.  This name makes
the files and directories that belong to this space easily identifiable. </b><p>For example, if you choose <tt>/usr/local</tt> as the name, the path <tt>/usr/local/bin</tt>
is obviously a part of this namespace. </p></li>
<li><a name="rfsadmin-step-175"></a><b>For ease of user community recognition, create an autofs indirect map. Mount this
map at <tt>/usr/local</tt>. Set up the following entry in the NIS+ (or NIS)
<tt>auto_master</tt> map: </b><pre>/usr/local     auto_local     -ro</pre><p>Notice that the <tt>-ro</tt> mount option implies that clients cannot write to any
files or directories. </p></li>
<li><a name="rfsadmin-step-176"></a><b>Export the appropriate directory on the server. </b></li>
<li><a name="rfsadmin-step-177"></a><b>Include a <tt>bin</tt> entry in the auto_local map. </b><p>Your directory structure resembles the following: </p><pre> bin     aa:/export/local/bin </pre></li>
<li><a name="rfsadmin-step-178"></a>(Optional) <b>To serve clients of different architectures, change the entry by adding the autofs
<tt>CPU</tt> variable. </b><pre>bin     aa:/export/local/bin/$CPU </pre>
<ul><li><p>For SPARC clients &ndash; Place executables in <tt>/export/local/bin/sparc</tt>.</p></li>
<li><p>For x86 clients &ndash; Place executables in <tt>/export/local/bin/i386</tt>.</p></li></ul>
</li></ol>

<a name="rfsadmin-179"></a><h4>How to Support Incompatible Client Operating System Versions</h4><ol>
<li><a name="rfsadmin-step-181"></a><b><a name="indexterm-355"></a><a name="indexterm-356"></a><a name="indexterm-357"></a><a name="indexterm-358"></a>Combine the architecture type with a variable that determines the operating system type
of the client.   </b><p>You can combine the autofs <tt>OSREL</tt> variable with the <tt>CPU</tt> variable to form a
name that determines both CPU type and OS release. </p></li>
<li><a name="rfsadmin-step-182"></a><b>Create the following map entry. </b><pre>bin     aa:/export/local/bin/$CPU$OSREL</pre><p>For clients that are running version 5.6 of the operating system, export the
following file systems:</p>
<ul><li><p>For SPARC clients &ndash; Export <tt>/export/local/bin/sparc5.6</tt>.</p></li>
<li><p>For x86 clients &ndash; Place executables in <tt>/export/local/bin/i3865.6</tt>.</p></li></ul>
</li></ol>

<a name="rfsadmin-183"></a><h4>How to Replicate Shared Files Across Several Servers</h4><p>The best way to share replicated file systems that are read-only is to
use failover. See <a href="rfsrefer-45.html#rfsrefer-51">Client-Side Failover</a> for a discussion of failover.</p><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.
To configure a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="rfsadmin-step-185"></a><b>Modify the entry in the autofs maps.</b><p><a name="indexterm-359"></a><a name="indexterm-360"></a><a name="indexterm-361"></a><a name="indexterm-362"></a><a name="indexterm-363"></a>Create the list of all replica servers as a comma-separated list, such as
the following:     </p><pre><tt>bin aa,bb,cc,dd:/export/local/bin/$CPU</tt></pre><p>Autofs chooses the nearest server. If a server has several network interfaces, list
each interface. Autofs chooses the nearest interface to the client, avoiding unnecessary routing
of NFS traffic. </p></li></ol>

<a name="rfsadmin-186"></a><h4>How to Apply Autofs Security Restrictions</h4><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.
To configure a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="rfsadmin-step-188"></a><b><a name="indexterm-364"></a><a name="indexterm-365"></a>Create the following entry in the name service <tt>auto_master</tt> file, either NIS or
NIS+:  </b><pre><tt>/home auto_home -nosuid</tt></pre><p>The <tt>nosuid</tt> option prevents users from creating files with the <tt>setuid</tt> or <tt>setgid</tt>
bit set.</p><p>This entry overrides the entry for <tt>/home</tt> in a generic local <tt>/etc/auto_master</tt> file.
See the previous example. The override happens because the <tt>+auto_master</tt> reference to the external
name service map occurs before the <tt>/home</tt> entry in the file. If the
entries in the <tt>auto_home</tt> map include mount options, the <tt>nosuid</tt> option is overwritten. Therefore,
either no options should be used in the <tt>auto_home</tt> map or the <tt>nosuid</tt>
option must be included with each entry.</p>
<hr><p><b>Note - </b>Do not mount the home directory disk partitions on or under <tt>/home</tt>
on the server.</p>
<hr>
</li></ol>

<a name="rfsadmin-189"></a><h4>How to Use a Public File Handle With Autofs</h4><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.
To configure a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="rfsadmin-step-191"></a><b><a name="indexterm-366"></a><a name="indexterm-367"></a>Create an entry in the autofs map such as the following:</b><pre>/usr/local     -ro,public    bee:/export/share/local</pre><p>The <tt>public</tt> option forces the public handle to be used. If the NFS
server does not support a public file handle, the mount fails.</p></li></ol>

<a name="rfsadmin-192"></a><h4>How to Use NFS URLs With Autofs</h4><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.
To configure a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="rfsadmin-step-194"></a><b><a name="indexterm-368"></a><a name="indexterm-369"></a>Create an autofs entry such as the following:</b><pre>/usr/local     -ro    nfs://bee/export/share/local</pre><p>The service tries to use the public file handle on the NFS
server. However,  if the server does not support a public file handle,
the MOUNT protocol is used.</p></li></ol>

<a name="rfsadmin-195"></a><h4>Disabling Autofs Browsability</h4>
<p><a name="indexterm-370"></a><a name="indexterm-371"></a><a name="indexterm-372"></a><a name="indexterm-373"></a>Starting with the Solaris 2.6 release, the default version of <tt>/etc/auto_master</tt> that
is installed has the <tt>-nobrowse</tt> option added to the entries for <tt>/home</tt> and
<tt>/net</tt>. In addition, the upgrade procedure  adds the <tt>-nobrowse</tt> option to the <tt>/home</tt>
and <tt>/net</tt> entries in <tt>/etc/auto_master</tt> if these entries have not been modified.
However, you might have to make these changes manually or to turn off
browsability for site-specific autofs mount points after the installation.</p><p>You can turn off the browsability feature in several ways. Disable the feature
by using a command-line option to the <tt>automountd</tt> daemon, which completely disables autofs
browsability for the client. Or disable browsability for each map entry on all
clients by using the autofs maps in either an NIS or NIS+ namespace.
You can also disable the feature for each map entry on each client,
using local autofs maps if no network-wide namespace is being used. </p>

<a name="rfsadmin-196"></a><h4>How to Completely Disable Autofs Browsability on a Single NFS Client</h4><ol>
<li><a name="rfsadmin-step-204"></a><b>Become superuser or assume an equivalent role on the NFS client.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.
To configure a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="rfsadmin-step-252"></a><b>Edit the <tt>/etc/default/autofs</tt> file to include the following keyword and value.</b><pre>AUTOMOUNTD_NOBROWSE=TRUE</pre></li>
<li><a name="rfsadmin-step-199"></a><b>Restart the autofs service. </b><pre># <tt><b>svcadm restart system/filesystem/autofs</b></tt></pre></li></ol>

<a name="rfsadmin-200"></a><h4>How to Disable Autofs Browsability for All Clients</h4><p>To disable browsability for all clients, you must employ a name service such
as NIS or NIS+. Otherwise, you need to manually edit the automounter maps
on each client. In this example, the browsability of the <tt>/home</tt> directory is
disabled. You must follow this procedure for each indirect autofs node that needs
to be disabled.</p><ol>
<li><a name="rfsadmin-step-202"></a><b>Add the <tt>-nobrowse</tt> option to the <tt>/home</tt> entry in the name service <tt>auto_master</tt>
file. </b><pre><tt><b>/home auto_home -nobrowse</b></tt></pre></li>
<li><a name="rfsadmin-step-203"></a><b>Run the <tt>automount</tt> command on all clients.</b><p>The new behavior becomes effective after you run the <tt>automount</tt> command on the
client systems or after a reboot.</p><pre># <tt><b>/usr/sbin/automount</b></tt></pre></li></ol>

<a name="rfsadmin-204"></a><h4>How to Disable Autofs Browsability on a Selected File System</h4><p>In this example, browsability of the <tt>/net</tt> directory is disabled. You can use
the same procedure for <tt>/home</tt> or any other autofs mount points.</p><ol>
<li><a name="rfsadmin-step-206"></a><b>Check the <tt>automount</tt> entry in <tt>/etc/nsswitch.conf</tt>.</b><p>For local file entries to have precedence, the entry in the name service
switch file should list <tt>files</tt> before the name service. For example:</p><pre>automount:  files nisplus</pre><p>This entry shows the default configuration in a standard Solaris installation.</p></li>
<li><a name="rfsadmin-step-207"></a><b>Check the position of the <tt>+auto_master</tt> entry in <tt>/etc/auto_master</tt>.</b><p>For additions to the local files to have precedence over the entries in
the namespace, the <tt>+auto_master</tt> entry must be moved to follow <tt>/net</tt>:</p><pre># Master map for automounter
#
/net    -hosts     -nosuid
/home   auto_home
/xfn    -xfn
<tt><b>+auto_master</b></tt></pre><p>A standard configuration places the <tt>+auto_master</tt> entry at the top of the file.
This placement prevents any local changes from being used.</p></li>
<li><a name="rfsadmin-step-208"></a><b>Add the <tt>nobrowse</tt> option to the <tt>/net</tt> entry in the <tt>/etc/auto_master</tt> file. </b><pre>/<tt>net -hosts -nosuid,</tt><tt><b>nobrowse</b></tt></pre></li>
<li><a name="rfsadmin-step-209"></a><b>On all clients, run the <tt>automount</tt> command.</b><p>The new behavior becomes effective after running the <tt>automount</tt> command on the
client systems or after a reboot.</p><pre># <tt><b>/usr/sbin/automount</b></tt></pre></li></ol>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="rfsadmin-110.html">Previous</a>
             </td>
             <td align="right">
                 <a href="rfsadmin-214.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

