<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Interactions of <tt>sendmail</tt> With Name Services - System Administration Guide: Network Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: Network Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="mailrefer-14.html">Previous</a>
             </td>
             <td align="right">
                 <a href="evemx.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="netservices-1.html">Part&nbsp;I&nbsp;Network Services Topics</a></p>
<p class="toc level2"><a href="nsov-1.html">1.&nbsp;&nbsp;Network Service (Overview)</a></p>
<p class="toc level2"><a href="nca-1.html">2.&nbsp;&nbsp;Managing Web Cache Servers</a></p>
<p class="toc level2"><a href="time-1.html">3.&nbsp;&nbsp;Time-Related Services</a></p>
<p class="toc level1 tocsp"><a href="rfstm-1.html">Part&nbsp;II&nbsp;Accessing Network File Systems Topics</a></p>
<p class="toc level2"><a href="rfsintro-2.html">4.&nbsp;&nbsp;Managing Network File Systems (Overview)</a></p>
<p class="toc level2"><a href="rfsadmin-8.html">5.&nbsp;&nbsp;Network File System Administration (Tasks)</a></p>
<p class="toc level2"><a href="rfsrefer-1.html">6.&nbsp;&nbsp;Accessing Network File Systems (Reference)</a></p>
<p class="toc level1 tocsp"><a href="slptm.html">Part&nbsp;III&nbsp;SLP Topics</a></p>
<p class="toc level2"><a href="slparch-16.html">7.&nbsp;&nbsp;SLP (Overview)</a></p>
<p class="toc level2"><a href="slp.setup-10.html">8.&nbsp;&nbsp;Planning and Enabling SLP (Tasks)</a></p>
<p class="toc level2"><a href="ch.configuration-6.html">9.&nbsp;&nbsp;Administering SLP (Tasks)</a></p>
<p class="toc level2"><a href="legacy-7.html">10.&nbsp;&nbsp;Incorporating Legacy Services</a></p>
<p class="toc level2"><a href="slpreference.html">11.&nbsp;&nbsp;SLP (Reference)</a></p>
<p class="toc level1 tocsp"><a href="mailtm-1.html">Part&nbsp;IV&nbsp;Mail Services Topics</a></p>
<p class="toc level2"><a href="mailintro-1.html">12.&nbsp;&nbsp;Mail Services (Overview)</a></p>
<p class="toc level2"><a href="mailadmin-1.html">13.&nbsp;&nbsp;Mail Services (Tasks)</a></p>
<p class="toc level2"><a href="mailrefer-1.html">14.&nbsp;&nbsp;Mail Services (Reference)</a></p>
<p class="toc level3"><a href="mailrefer-75.html">Solaris Version of <tt>sendmail</tt></a></p>
<p class="toc level3"><a href="mailrefer-53.html">Software and Hardware Components of Mail Services</a></p>
<p class="toc level3"><a href="mailrefer-45.html">Mail Service Programs and Files</a></p>
<p class="toc level3"><a href="mailrefer-14.html">Mail Addresses and Mail Routing</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Interactions of <tt>sendmail</tt> With Name Services</a></p>
</div>
<p class="toc level3"><a href="evemx.html">Changes in Version 8.13 of <tt>sendmail</tt></a></p>
<p class="toc level3"><a href="mailrefer-105.html">Changes From Version 8.12 of <tt>sendmail</tt></a></p>
<p class="toc level1 tocsp"><a href="modemtm-1.html">Part&nbsp;V&nbsp;Serial Networking Topics</a></p>
<p class="toc level2"><a href="pppsvrconfig.intro-1.html">15.&nbsp;&nbsp;Solaris PPP 4.0 (Overview)</a></p>
<p class="toc level2"><a href="pppsvrconfig.p2plink-1.html">16.&nbsp;&nbsp;Planning for the PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.dialin-1.html">17.&nbsp;&nbsp;Setting Up a Dial-up PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.leased-1.html">18.&nbsp;&nbsp;Setting Up a Leased-Line PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.auth-1.html">19.&nbsp;&nbsp;Setting Up PPP Authentication (Tasks)</a></p>
<p class="toc level2"><a href="ppp.pppoe-1.html">20.&nbsp;&nbsp;Setting Up a PPPoE Tunnel (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.troubleshoot-1.html">21.&nbsp;&nbsp;Fixing Common PPP Problems (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.reference-1.html">22.&nbsp;&nbsp;Solaris PPP 4.0 (Reference)</a></p>
<p class="toc level2"><a href="pppsvrconfig.convert.app-1.html">23.&nbsp;&nbsp;Migrating From Asynchronous Solaris PPP to Solaris PPP 4.0 (Tasks)</a></p>
<p class="toc level2"><a href="uucpov-1.html">24.&nbsp;&nbsp;UUCP (Overview)</a></p>
<p class="toc level2"><a href="uucptasks-1.html">25.&nbsp;&nbsp;Administering UUCP (Tasks)</a></p>
<p class="toc level2"><a href="uucpref-1.html">26.&nbsp;&nbsp;UUCP (Reference)</a></p>
<p class="toc level1 tocsp"><a href="wwrstm.html">Part&nbsp;VI&nbsp;Working With Remote Systems Topics</a></p>
<p class="toc level2"><a href="wwrsov.html">27.&nbsp;&nbsp;Working With Remote Systems (Overview)</a></p>
<p class="toc level2"><a href="wuftp-17.html">28.&nbsp;&nbsp;Administering the FTP Server (Tasks)</a></p>
<p class="toc level2"><a href="remotehowtoaccess-99941.html">29.&nbsp;&nbsp;Accessing Remote Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="netmonitortm-1.html">Part&nbsp;VII&nbsp;Monitoring Network Services Topics</a></p>
<p class="toc level2"><a href="netmonitor-1.html">30.&nbsp;&nbsp;Monitoring Network Performance (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="mailrefer-24"></a><h3>Interactions of <tt>sendmail</tt> With Name Services</h3>
<p>This section describes domain names as they apply to <tt>sendmail</tt> and name services. Furthermore,
this section describes the rules for effective use of name services, and the specific interactions
of <tt>sendmail</tt> with name services. For details, refer to the following topics.</p>
<ul><li><p><a href="#mailrefer-87"><tt>sendmail.cf</tt> and Mail Domains</a></p></li>
<li><p><a href="#mailrefer-25"><tt>sendmail</tt> and Name Services</a></p></li>
<li><p><a href="#mailrefer-28">Interactions of NIS and <tt>sendmail</tt></a></p></li>
<li><p><a href="#mailrefer-29">Interactions of <tt>sendmail</tt> With NIS and DNS</a></p></li>
<li><p><a href="#mailrefer-30">Interactions of NIS+ and <tt>sendmail</tt></a></p></li>
<li><p><a href="#mailrefer-31">Interactions of <tt>sendmail</tt> With NIS+ and DNS</a></p></li></ul>
<p>If you are looking for related task information, refer to <a href="mailadmin-13.html#mailadmin-122">How to Use DNS With <tt>sendmail</tt></a> or <a href="mailadmin-260.html">Administering Mail Alias Files (Task Map)</a>
in <a href="mailadmin-1.html">Chapter&nbsp;13, Mail Services (Tasks)</a>.</p>

<a name="mailrefer-87"></a><h4><tt>sendmail.cf</tt> and Mail Domains</h4>
<p>The standard <tt>sendmail.cf</tt> file uses mail domains to determine whether mail is delivered directly
or through a mail host. Intradomain mail is delivered through a direct SMTP connection, while
interdomain mail is forwarded to a mail host.</p><p><a name="indexterm-1473"></a><a name="indexterm-1474"></a>In a secure network, only a few selected hosts are authorized to generate packets
that are targeted to external destinations. Even if a host has the IP address
of the remote host that is external to the mail domain, the establishment of
an SMTP connection is not guaranteed. The standard <tt>sendmail.cf</tt> assumes the following.</p>
<ul><li><p>The current host is not authorized to send packets directly to a host outside the mail domain.</p></li>
<li><p>The mail host is capable of forwarding the mail to an authorized host that can transmit packets directly to an external host. Actually, the mail host can be an authorized host.</p></li></ul>
<p>With these assumptions, the mail host is responsible for delivering or forwarding interdomain mail.</p>

<a name="mailrefer-25"></a><h4><tt>sendmail</tt> and Name Services</h4>
<p><a name="indexterm-1475"></a><tt>sendmail</tt> imposes various requirements on name services. To improve your understanding of these requirements, this
section first describes the relationship of mail domains to name service domains. Then the
section describes the various requirements. Refer to the following.</p>
<ul><li><p><a href="#mailrefer-26">Mail Domains and Name Service Domains</a></p></li>
<li><p><a href="#mailrefer-27">Requirements for Name Services</a></p></li>
<li><p>Man pages for <a href="http://docs.sun.com/doc/819-2239/lc-nis-plus-1?a=view"><tt>nis+</tt>(1)</a>, <a href="http://docs.sun.com/doc/819-2240/nisaddent-1m?a=view"><tt>nisaddent</tt>(1M)</a>, and <a href="http://docs.sun.com/doc/819-2251/nsswitch.conf-4?a=view"><tt>nsswitch.conf</tt>(4)</a></p></li></ul>


<a name="mailrefer-26"></a><h5>Mail Domains and Name Service Domains</h5>
<p>The mail domain name must be a suffix of the name service domain. For
example, if the domain name of the name service is <tt>A.B.C.D</tt>, the mail domain
name could be one of the following.</p>
<ul><li><p><tt>A.B.C.D</tt></p></li>
<li><p><tt>B.C.D</tt></p></li>
<li><p><tt>C.D</tt></p></li>
<li><p><tt>D</tt></p></li></ul>
<p><a name="indexterm-1476"></a><a name="indexterm-1477"></a>When first established, the mail domain name is often identical to the name service
domain. As the network grows, the name service domain can be divided into smaller
pieces to make the name service more manageable. However, the mail domain often remains undivided
to provide consistent aliasing.</p>

<a name="mailrefer-27"></a><h5>Requirements for Name Services</h5>
<p>This section describes the requirements that <tt>sendmail</tt> imposes on name services.</p><p>A host table or map in a name service must be set up
to support three types of <tt>gethostbyname()</tt> queries.</p>
<ul><li><p><tt>mailhost</tt> &ndash; Some name service configurations satisfy this requirement automatically.</p></li>
<li><p>Full host name (for example, <tt>smith.admin.acme.com</tt>) &ndash; Many name service configurations satisfy this requirement.</p></li>
<li><p>Short host name (for example, <tt>smith</tt>) &ndash; <tt>sendmail</tt> must connect to the mail host in order to forward external mail. To determine if a mail address is within the current mail domain, <tt>gethostbyname()</tt> is invoked with the full host name. If the entry is found, the address is considered internal.</p><p>NIS, NIS+, and DNS support <tt>gethostbyname()</tt> with a short host name as an argument, so this requirement is automatically satisfied.</p></li></ul>
<p>Two additional rules about the host name service need to be followed to establish
efficient <tt>sendmail</tt> services within a name service.</p>
<ul><li><p><tt>gethostbyname()</tt> with full host-name argument and short host-name argument should yield consistent results. For example, <tt>gethostbyname(smith.admin.acme.com)</tt> should return the same result as <tt>gethostbyname(smith)</tt>, if both functions are called from the mail domain <tt>admin.acme.com</tt>.</p></li>
<li><p><a name="indexterm-1478"></a>For all name service domains under a common mail domain, <tt>gethostbyname()</tt> with a short host name should yield the same result. For example, if the mail domain <tt>smith.admin.acme.com</tt> is given, <tt>gethostbyname(smith)</tt> should return the same result when the call originates from either the <tt>ebb.admin.acme.com</tt> domain or the <tt>esg.admin.acme.com</tt> domain. The mail domain name is usually shorter than the name service domain, which gives this requirement special implications for various name services.</p></li></ul>
<p>For more information about the <tt>gethostbyname()</tt> function, refer to the <a href="http://docs.sun.com/doc/819-2244/gethostbyname-3nsl?a=view"><tt>gethostbyname</tt>(3NSL)</a> man page.</p>

<a name="mailrefer-28"></a><h4>Interactions of NIS and <tt>sendmail</tt></h4>
<p><a name="indexterm-1479"></a>The following list describes the interactions of <tt>sendmail</tt> and NIS and provides some guidance.</p>
<ul><li><p><b>Mail domain name</b> &ndash; If you are setting up NIS as the primary name service, <tt>sendmail</tt> automatically strips the first component of the NIS domain name and uses the result as the mail domain name. For example, <tt>ebs.admin.acme.com</tt> becomes <tt>admin.acme.com</tt>.</p></li>
<li><p><b>Mail host name</b> &ndash; You must have a <tt>mailhost</tt> entry in the NIS host map.</p></li>
<li><p><b>Full host names</b> &ndash; The normal NIS setup does not &ldquo;understand&rdquo; the full host name. Rather than trying to make NIS understand the full host name, turn off this requirement from the <tt>sendmail</tt> side by editing the <tt>sendmail.cf</tt> file and replacing all occurrences of <tt>%l</tt> with <tt>%y</tt>. This change turns off <tt>sendmail</tt>'s interdomain mail detection. If the target host can be resolved to an IP address, a direct SMTP delivery is attempted. Ensure that your NIS host map does not contain any host entry that is external to the current mail domain. Otherwise, you need to further customize the <tt>sendmail.cf</tt> file.</p></li>
<li><p><b>Matching full host names and short host names</b> &ndash; Follow the previous instructions about how to turn off <tt>gethostbyname()</tt> for a full host name.</p></li>
<li><p><b>Multiple NIS domains in one mail domain</b> &ndash; All NIS host maps under a common mail domain should have the same set of host entries. For example, the host map in the <tt>ebs.admin.acme.com</tt> domain should be the same as the host map in the <tt>esg.admin.acme.com</tt>. Otherwise, one address might work in one NIS domain, but fail in the other NIS domain. </p></li></ul>
<p>For task information, refer to <a href="mailadmin-260.html">Administering Mail Alias Files (Task Map)</a> in <a href="mailadmin-1.html">Chapter&nbsp;13, Mail Services (Tasks)</a>.</p>

<a name="mailrefer-29"></a><h4>Interactions of <tt>sendmail</tt> With NIS and DNS</h4>
<p><a name="indexterm-1480"></a>The following list describes the interactions of <tt>sendmail</tt> with NIS and DNS and provides
some guidance.</p>
<ul><li><p><b>Mail domain name</b> &ndash; If you are setting up NIS as the primary name service, <tt>sendmail</tt> automatically strips the first component of the NIS domain name and uses the result as the mail domain name. For example, <tt>ebs.admin.acme.com</tt> becomes <tt>admin.acme.com</tt>.</p></li>
<li><p><b>Mail host name</b> &ndash; When the DNS forwarding feature is turned on, queries that NIS cannot resolve are forwarded to DNS, so you do not need a <tt>mailhost</tt> entry in the NIS host map. </p></li>
<li><p><b>Full host names</b> &ndash; Although NIS does not &ldquo;understand&rdquo; full host names, DNS does understand. This requirement is satisfied when you follow the regular procedure for setting up NIS and DNS. </p></li>
<li><p><b>Matching full host names and short host names</b> &ndash; For every host entry in the NIS host table, you must have a corresponding host entry in DNS.</p></li>
<li><p><b>Multiple NIS domains in one mail domain</b> &ndash; All NIS host maps under a common mail domain should have the same set of host entries. For example, the host map in the <tt>ebs.admin.acme.com</tt> domain should be the same as the host map in the <tt>esg.admin.acme.com</tt> domain. Otherwise, one address might work in one NIS domain, but fail in the other NIS domain.</p></li></ul>
<p>For task information, refer to <a href="mailadmin-13.html#mailadmin-122">How to Use DNS With <tt>sendmail</tt></a> and <a href="mailadmin-260.html">Administering Mail Alias Files (Task Map)</a> in <a href="mailadmin-1.html">Chapter&nbsp;13, Mail Services (Tasks)</a>.</p>

<a name="mailrefer-30"></a><h4>Interactions of NIS+ and <tt>sendmail</tt></h4>
<p><a name="indexterm-1481"></a>The following list describes the interactions of <tt>sendmail</tt> with NIS+ and provides some guidance.</p>
<ul><li><p><b>Mail domain name</b> &ndash; If you are setting up NIS+ as your primary name service, <tt>sendmail</tt> can check the mail domain from the NIS+ <tt>sendmailvars</tt> table. This NIS+ table has one key column and one value column. To set up your mail domain, you must add one entry to this table. This entry should have the key column set to the literal string <tt>maildomain</tt> and the value column set to your mail domain name. An example is <tt>admin.acme.com</tt>. Although NIS+ allows any string in the <tt>sendmailvars</tt> table, the suffix rule still applies for the mail system to work correctly. You can use <tt>nistbladm</tt> to add the <tt>maildomain</tt> entry to the <tt>sendmailvars</tt> table. Notice in the following example that the mail domain is a suffix of the NIS+ domain.</p><pre>nistbladm -A key="maildomain" value=&lt;mail domain> sendmailvars.org_dir.&lt;NIS+ domain></pre></li>
<li><p><b>Mailhost host name</b> &ndash; You must have a <tt>mailhost</tt> entry in the NIS+ hosts table.</p></li>
<li><p><b>Full host names</b> &ndash; NIS+ &ldquo;understands&rdquo; the full host name. Following the regular NIS+ setup procedure satisfies this requirement.</p></li>
<li><p><b>Matching full host names and short host names</b> &ndash; To satisfy this requirement, you can duplicate the entries in the host table. Otherwise, you can enter all host entries in the user name-service domains into a master host table at mail domain level. </p></li>
<li><p><b>Multiple NIS domains in one mail domain</b> &ndash; To satisfy this requirement, you can duplicate the entries in all the host tables. Otherwise, you can type all host entries in the user name service domains into a master host table at mail domain level. Effectively, you are merging multiple host tables that are logical or physical into one host table. Therefore, the same host name cannot be reused in the multiple name service domain that shares a common mail domain.</p></li></ul>
<p>For task information, refer to <a href="mailadmin-260.html">Administering Mail Alias Files (Task Map)</a> in <a href="mailadmin-1.html">Chapter&nbsp;13, Mail Services (Tasks)</a>.</p>

<a name="mailrefer-31"></a><h4>Interactions of <tt>sendmail</tt> With NIS+ and DNS</h4>
<p><a name="indexterm-1482"></a>The following list describes the interactions of <tt>sendmail</tt> with NIS+ and DNS and provides
some guidance.</p>
<ul><li><p><b>Mail domain name</b> &ndash; If you are setting up NIS+ as your primary name service, <tt>sendmail</tt> can check the mail domain from the NIS+ <tt>sendmailvars</tt> table. This NIS+ table has one key column and one value column. To set up your mail domain, you must add one entry to this table. This entry should have the key column set to the literal string <tt>maildomain</tt> and the value column set to your mail domain name. An example is <tt>admin.acme.com</tt>. Although NIS+ allows any string in the <tt>sendmailvars</tt> table, the suffix rule still applies for the mail system to work correctly. You can use <tt>nistbladm</tt> to add the <tt>maildomain</tt> entry to the <tt>sendmailvars</tt> table. Notice in the following example that the mail domain is a suffix of the NIS+ domain.</p><pre>nistbladm -A key="maildomain" value=&lt;mail domain> sendmailvars.org_dir.&lt;NIS+ domain></pre></li>
<li><p><b>Mailhost host name</b> &ndash; If your network uses both NIS+ and DNS as the source for the host database, you can put the <tt>mailhost</tt> entry in either the NIS+ or DNS host table. Ensure that your users include both NIS+ and DNS as the source for the host database in the <tt>/etc/nsswitch.conf</tt> file.</p></li>
<li><p><b>Full host names</b> &ndash; Both NIS+ and DNS &ldquo;understand&rdquo; full host names. Following the regular NIS+ and DNS setup procedures satisfies this requirement.</p></li>
<li><p><b>Matching full host names and short host names</b> &ndash; For every host entry in the NIS+ host table, you must have a corresponding host entry in DNS.</p></li>
<li><p><b>Multiple NIS domains in one mail domain</b> &ndash; To satisfy this requirement, you can duplicate the entries in all the host tables. Alternately, you can type all host entries in the user name-service domains into a master host table at the mail domain level.</p></li></ul>
<p>For task information, refer to <a href="mailadmin-260.html">Administering Mail Alias Files (Task Map)</a> and <a href="mailadmin-13.html#mailadmin-122">How to Use DNS With <tt>sendmail</tt></a> in <a href="mailadmin-1.html">Chapter&nbsp;13, Mail Services (Tasks)</a>.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="mailrefer-14.html">Previous</a>
             </td>
             <td align="right">
                 <a href="evemx.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

