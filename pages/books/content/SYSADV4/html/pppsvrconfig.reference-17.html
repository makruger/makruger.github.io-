<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Authenticating Callers on a Link - System Administration Guide: Network Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: Network Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="pppsvrconfig.reference-66.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ppp.reference-39.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="netservices-1.html">Part&nbsp;I&nbsp;Network Services Topics</a></p>
<p class="toc level2"><a href="nsov-1.html">1.&nbsp;&nbsp;Network Service (Overview)</a></p>
<p class="toc level2"><a href="nca-1.html">2.&nbsp;&nbsp;Managing Web Cache Servers</a></p>
<p class="toc level2"><a href="time-1.html">3.&nbsp;&nbsp;Time-Related Services</a></p>
<p class="toc level1 tocsp"><a href="rfstm-1.html">Part&nbsp;II&nbsp;Accessing Network File Systems Topics</a></p>
<p class="toc level2"><a href="rfsintro-2.html">4.&nbsp;&nbsp;Managing Network File Systems (Overview)</a></p>
<p class="toc level2"><a href="rfsadmin-8.html">5.&nbsp;&nbsp;Network File System Administration (Tasks)</a></p>
<p class="toc level2"><a href="rfsrefer-1.html">6.&nbsp;&nbsp;Accessing Network File Systems (Reference)</a></p>
<p class="toc level1 tocsp"><a href="slptm.html">Part&nbsp;III&nbsp;SLP Topics</a></p>
<p class="toc level2"><a href="slparch-16.html">7.&nbsp;&nbsp;SLP (Overview)</a></p>
<p class="toc level2"><a href="slp.setup-10.html">8.&nbsp;&nbsp;Planning and Enabling SLP (Tasks)</a></p>
<p class="toc level2"><a href="ch.configuration-6.html">9.&nbsp;&nbsp;Administering SLP (Tasks)</a></p>
<p class="toc level2"><a href="legacy-7.html">10.&nbsp;&nbsp;Incorporating Legacy Services</a></p>
<p class="toc level2"><a href="slpreference.html">11.&nbsp;&nbsp;SLP (Reference)</a></p>
<p class="toc level1 tocsp"><a href="mailtm-1.html">Part&nbsp;IV&nbsp;Mail Services Topics</a></p>
<p class="toc level2"><a href="mailintro-1.html">12.&nbsp;&nbsp;Mail Services (Overview)</a></p>
<p class="toc level2"><a href="mailadmin-1.html">13.&nbsp;&nbsp;Mail Services (Tasks)</a></p>
<p class="toc level2"><a href="mailrefer-1.html">14.&nbsp;&nbsp;Mail Services (Reference)</a></p>
<p class="toc level1 tocsp"><a href="modemtm-1.html">Part&nbsp;V&nbsp;Serial Networking Topics</a></p>
<p class="toc level2"><a href="pppsvrconfig.intro-1.html">15.&nbsp;&nbsp;Solaris PPP 4.0 (Overview)</a></p>
<p class="toc level2"><a href="pppsvrconfig.p2plink-1.html">16.&nbsp;&nbsp;Planning for the PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.dialin-1.html">17.&nbsp;&nbsp;Setting Up a Dial-up PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.leased-1.html">18.&nbsp;&nbsp;Setting Up a Leased-Line PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.auth-1.html">19.&nbsp;&nbsp;Setting Up PPP Authentication (Tasks)</a></p>
<p class="toc level2"><a href="ppp.pppoe-1.html">20.&nbsp;&nbsp;Setting Up a PPPoE Tunnel (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.troubleshoot-1.html">21.&nbsp;&nbsp;Fixing Common PPP Problems (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.reference-1.html">22.&nbsp;&nbsp;Solaris PPP 4.0 (Reference)</a></p>
<p class="toc level3"><a href="pppsvrconfig.reference-65.html">Using PPP Options in Files and on the Command Line</a></p>
<p class="toc level3"><a href="enmzz.html">Configuring User-Specific Options</a></p>
<p class="toc level3"><a href="pppsvrconfig.reference-45.html">Specifying Information for Communicating With the Dial-in Server</a></p>
<p class="toc level3"><a href="ppp.reference-65.html">Configuring Modem Speed for a Dial-up Link</a></p>
<p class="toc level3"><a href="pppsvrconfig.reference-66.html">Defining the Conversation on the Dial-up Link</a></p>
<p class="toc level4"><a href="pppsvrconfig.reference-66.html#ppp.reference-2">How to Invoke a Chat Script (Task)</a></p>
<p class="toc level4"><a href="pppsvrconfig.reference-66.html#ppp.reference-3">How to Create an Executable Chat Program</a></p>
<div class="onpage">
<p class="toc level3 tocsp"><a href="">Authenticating Callers on a Link</a></p>
</div>
<p class="toc level3"><a href="ppp.reference-39.html">Creating an IP Addressing Scheme for Callers</a></p>
<p class="toc level3"><a href="ppp.reference-45.html">Creating PPPoE Tunnels for DSL Support</a></p>
<p class="toc level2 tocsp"><a href="pppsvrconfig.convert.app-1.html">23.&nbsp;&nbsp;Migrating From Asynchronous Solaris PPP to Solaris PPP 4.0 (Tasks)</a></p>
<p class="toc level2"><a href="uucpov-1.html">24.&nbsp;&nbsp;UUCP (Overview)</a></p>
<p class="toc level2"><a href="uucptasks-1.html">25.&nbsp;&nbsp;Administering UUCP (Tasks)</a></p>
<p class="toc level2"><a href="uucpref-1.html">26.&nbsp;&nbsp;UUCP (Reference)</a></p>
<p class="toc level1 tocsp"><a href="wwrstm.html">Part&nbsp;VI&nbsp;Working With Remote Systems Topics</a></p>
<p class="toc level2"><a href="wwrsov.html">27.&nbsp;&nbsp;Working With Remote Systems (Overview)</a></p>
<p class="toc level2"><a href="wuftp-17.html">28.&nbsp;&nbsp;Administering the FTP Server (Tasks)</a></p>
<p class="toc level2"><a href="remotehowtoaccess-99941.html">29.&nbsp;&nbsp;Accessing Remote Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="netmonitortm-1.html">Part&nbsp;VII&nbsp;Monitoring Network Services Topics</a></p>
<p class="toc level2"><a href="netmonitor-1.html">30.&nbsp;&nbsp;Monitoring Network Performance (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="pppsvrconfig.reference-17"></a><h3>Authenticating Callers on a Link</h3>
<p>This section explains how the PPP authentication protocols work and explains the databases that
are associated with the authentication protocols.</p>

<a name="pppsvrconfig.intro-8"></a><h4>Password Authentication Protocol (PAP)</h4>
<p><a name="indexterm-2030"></a>PAP authentication is somewhat similar in operation to the UNIX <tt>login</tt> program, though PAP does
not grant shell access to the user. PAP uses the PPP configuration files and
PAP database in the form of the <tt>/etc/ppp/pap-secrets</tt> file for setting up authentication. PAP also
uses <tt>/etc/ppp/pap-secrets</tt> for defining PAP security credentials. These credentials include a peer name, a &ldquo;user
name&rdquo; in PAP parlance, and a password. PAP credentials also contain related information for
each caller who is permitted to link to the local machine. The PAP user
names and passwords can be identical to or different from the UNIX user names and
passwords in the password database.</p>

<a name="pppsvrconfig.reference-25"></a><h5><tt>/etc/ppp/pap-secrets</tt> File</h5>
<p><a name="indexterm-2031"></a>The PAP database is implemented in the <tt>/etc/ppp/pap-secrets</tt> file. Machines on both sides of
the PPP link must have properly configured PAP credentials in their <tt>/etc/ppp/pap-secrets</tt> files for
successful authentication. The caller (authenticatee) supplies credentials in the <tt>user</tt> and <tt>password</tt> columns of
the <tt>/etc/ppp/pap-secrets</tt> file or in the obsolete <tt>+ua</tt> file. The server (authenticator) validates these credentials
against information in <tt>/etc/ppp/pap-secrets</tt>, through the UNIX <tt>passwd</tt> database, or in the PAM facility.</p><p><a name="indexterm-2032"></a>The <tt>/etc/ppp/pap-secrets</tt> file has the following syntax.</p><pre>myclient ISP-server mypassword *</pre><p>The parameters have the following meaning.</p><dl><dt><tt>myclient</tt></dt>
<dd><p>PAP user name of the caller. Often, this name is identical to the caller's UNIX user name, particularly if the dial-in server uses the <tt>login</tt> option of PAP.</p></dd>
<dt><tt>ISP-server</tt></dt>
<dd><p>Name of the remote machine, often a dial-in server.</p></dd>
<dt><tt>mypassword</tt></dt>
<dd><p>Caller's PAP password.</p></dd>
<dt><tt>*</tt></dt>
<dd><p>IP address that is associated with the caller. Use an asterisk (*) to indicate any IP address.</p></dd>
</dl>


<a name="egkab"></a><h5>Creating PAP Passwords</h5>
<p><a name="indexterm-2033"></a>PAP passwords are sent over the link  <b>in the clear</b>, that is,  in readable
ASCII format. For the caller (authenticatee), the PAP password must be stored in the clear
in any of the following locations:</p>
<ul><li><p>In <tt>/etc/ppp/pap-secrets</tt></p></li>
<li><p>In another external file</p></li>
<li><p>In a named pipe through the <tt>pap-secrets</tt> @ feature</p></li>
<li><p>As an option to <tt>pppd</tt>, either on the command line or in a PPP configuration file</p></li>
<li><p>Through the <tt>+ua</tt> file</p></li></ul>
<p>On the server (authenticator), the PAP password can be hidden by doing one of
the following:</p>
<ul><li><p>Specifying <tt>papcrypt</tt> and using passwords that are hashed by <tt>crypt</tt>(3C) in the <tt>pap-secrets</tt> file.</p></li>
<li><p>Specifying the <tt>login</tt> option to <tt>pppd</tt> and omitting the password from the <tt>pap-secrets</tt> file by placing double quotes (<tt>""</tt>) in the password column. In this instance, authentication is performed through the UNIX passwd database or the <tt>pam</tt>(3pam) mechanism.</p></li></ul>


<a name="pppsvrconfig.reference-18"></a><h5>What Happens During PAP Authentication</h5>
<p><a name="indexterm-2034"></a><a name="indexterm-2035"></a>PAP authentication occurs in the following sequence.</p><a name="pppsvrconfig.reference-fig-19"></a><h6>Figure&nbsp;22-1 PAP Authentication Process</h6><img src="figures/PAP-auth-pro.gif" alt="The following context describes the sequence that is shown in the flow diagram."></img>
<ol><li><p>The caller (authenticatee) calls the remote peer (authenticator) and provides its PAP user name and password as part of link negotiation.</p></li>
<li><p>The peer verifies the identity of the caller in its <tt>/etc/ppp/pap-secrets</tt> file. If the peer uses the <tt>login</tt> option of PAP, the peer verifies the caller's user name and password in its password database.</p></li>
<li><p>If authentication is successful, the peer continues link negotiation with the caller. If authentication fails, the link is dropped.</p></li>
<li><p>(Optional) If the caller authenticates responses from remote peers, the remote peer must send its own PAP credentials to the caller. Thus, the remote peer becomes the authenticatee and the caller the authenticator. </p></li>
<li><p>(Optional) The original caller reads its own <tt>/etc/ppp/pap-secrets</tt> to verify the identity of the remote peer.</p>
<hr><p><b>Note - </b>If the original caller does require authentication credentials from the remote peer, Step 1 and Step 4 happen in parallel.</p>
<hr>
<p>If the peer is authenticated, negotiation continues. Otherwise, the link is dropped.</p></li>
<li><p>Negotiation between caller and peer continues until the link is successfully established.</p></li></ol>


<a name="pppsvrconfig.reference-20"></a><h5>Using the <tt>login</tt> Option With <tt>/etc/ppp/pap-secrets</tt></h5>
<a name="indexterm-2036"></a><a name="indexterm-2037"></a><a name="indexterm-2038"></a><p>You can add the <tt>login</tt> option for authenticating PAP credentials to any PPP configuration
file. When <tt>login</tt> is specified, for example, in <tt>/etc/ppp/options</tt>, <tt>pppd</tt> verifies that the
caller's PAP credentials exist in the Solaris password database. The following shows the format of
a <tt>/etc/ppp/pap-secrets</tt> file with the <tt>login</tt> option.</p><pre>joe    *  ""  *
sally  *  ""  *
sue    *  ""  *</pre><p>The parameters have the following meanings.</p><dl><dt>Caller</dt>
<dd><p><tt>joe</tt>, <tt>sally</tt>, and <tt>sue</tt> are the names of the authorized callers.</p></dd>
<dt>Server</dt>
<dd><p>Asterisk (*), which indicates that any server name is valid. The <tt>name</tt> option is not required in the PPP configuration files.</p></dd>
<dt>Password</dt>
<dd><p>Double quotes, which indicate that any password is valid.</p><p>If a password is in this column, then the password from the peer must match both the PAP password and the UNIX <tt>passwd</tt> database.</p></dd>
<dt>IP Addresses</dt>
<dd><p>Asterisk (*), which indicates that any IP address is allowed.</p></dd>
</dl>


<a name="pppsvrconfig.reference-21"></a><h4>Challenge-Handshake Authentication Protocol (CHAP)</h4>
<p><a name="indexterm-2039"></a>CHAP authentication uses the notion of the <b>challenge</b> and <b>response</b>, which means that the
peer (authenticator) challenges the caller (authenticatee) to prove its identity. The challenge includes a random
number and a unique ID that is generated by the authenticator. The caller must
use the ID, random number, and its CHAP security credentials to generate the proper
response (handshake) to send to the peer.</p><p>CHAP security credentials include a CHAP user name and a CHAP &ldquo;secret.&rdquo; The CHAP
secret is an arbitrary string that is known to both the caller and the
peer before they negotiate a PPP link. You configure CHAP security credentials in the
CHAP database, <tt>/etc/ppp/chap-secrets</tt>. </p>

<a name="pppsvrconfig.reference-250"></a><h5><tt>/etc/ppp/chap-secrets</tt> File</h5>
<p><a name="indexterm-2040"></a><a name="indexterm-2041"></a>The CHAP database is implemented in the <tt>/etc/ppp/chap-secrets</tt> file. Machines on both sides of
the PPP link must have each others' CHAP credentials in their <tt>/etc/ppp/chap-secrets</tt> files for successful
authentication. </p>
<hr><p><b>Note - </b>Unlike PAP, the shared secret must be in the clear on both peers. You
cannot use crypt, PAM, or the PPP login option with CHAP.</p>
<hr>
<p>The <tt>/etc/ppp/chap-secrets</tt> file has the following syntax.</p><pre>myclient myserver secret5748 *</pre><p>The parameters have the following meanings:</p><dl><dt><tt>myclient</tt></dt>
<dd><p>CHAP user name of the caller. This name can be the same as or different from the caller's UNIX user name.</p></dd>
<dt><tt>myserver</tt></dt>
<dd><p>Name of the remote machine, often a dial-in server.</p></dd>
<dt><tt>secret5748</tt></dt>
<dd><p>Caller's CHAP secret.</p>
<hr><p><b>Note - </b>Unlike PAP passwords, CHAP secrets are never sent over the link. Rather, CHAP secrets are used when the local machines compute the response.</p>
<hr>
</dd>
<dt><tt>*</tt></dt>
<dd><p>IP address that is associated with the caller. Use an asterisk (*) to indicate any IP address.</p></dd>
</dl>


<a name="pppsvrconfig.reference-22"></a><h5>What Happens During CHAP Authentication</h5>
<p>CHAP authentication occurs in the following sequence.</p><a name="pppsvrconfig.reference-fig-23"></a><h6>Figure&nbsp;22-2 CHAP Authentication Sequence</h6><a name="indexterm-2042"></a><img src="figures/CHAP-auth-pro.gif" alt="The following context describes the sequence that is shown in the flow diagram."></img>
<ol><li><p>Two peers that are about to initiate communications agree on a secret to be used for authentication during negotiation of a PPP link. </p></li>
<li><p><a name="indexterm-2043"></a>The administrators of both machines add the secret, CHAP user names, and other CHAP credentials to the <tt>/etc/ppp/chap-secrets</tt> database of their respective machines.</p></li>
<li><p>The caller (authenticatee) calls the remote peer (authenticator).</p></li>
<li><p>The authenticator generates a random number and an ID, and sends this data to the authenticatee as a challenge. </p></li>
<li><p>The authenticatee looks up the peer's name and secret in its <tt>/etc/ppp/chap-secrets</tt> database.</p></li>
<li><p>The authenticatee calculates a response by applying the MD5 computational algorithm to the secret and the peer's random number challenge. Then the authenticatee sends the results as its response to the authenticator.</p></li>
<li><p>The authenticator looks up the authenticatee's name and secret in its <tt>/etc/ppp/chap-secrets</tt> database.</p></li>
<li><p>The authenticator calculates its own figure by applying MD5 to the number that was generated as the challenge and the secret for the authenticatee in <tt>/etc/ppp/chap-secrets</tt>.</p></li>
<li><p>The authenticator compares its results with the response from the caller. If the two numbers are the same, the peer has successfully authenticated the caller, and link negotiation continues. Otherwise the link is dropped.</p></li></ol>

         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="pppsvrconfig.reference-66.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ppp.reference-39.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

