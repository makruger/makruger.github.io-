<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>NFS Troubleshooting Procedures - System Administration Guide: Network Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: Network Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="rfsadmin-214.html">Previous</a>
             </td>
             <td align="right">
                 <a href="rfsadmin-210.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="netservices-1.html">Part&nbsp;I&nbsp;Network Services Topics</a></p>
<p class="toc level2"><a href="nsov-1.html">1.&nbsp;&nbsp;Network Service (Overview)</a></p>
<p class="toc level2"><a href="nca-1.html">2.&nbsp;&nbsp;Managing Web Cache Servers</a></p>
<p class="toc level2"><a href="time-1.html">3.&nbsp;&nbsp;Time-Related Services</a></p>
<p class="toc level1 tocsp"><a href="rfstm-1.html">Part&nbsp;II&nbsp;Accessing Network File Systems Topics</a></p>
<p class="toc level2"><a href="rfsintro-2.html">4.&nbsp;&nbsp;Managing Network File Systems (Overview)</a></p>
<p class="toc level2"><a href="rfsadmin-8.html">5.&nbsp;&nbsp;Network File System Administration (Tasks)</a></p>
<p class="toc level3"><a href="rfsadmin-56.html">Automatic File-System Sharing</a></p>
<p class="toc level4"><a href="rfsadmin-56.html#rfsadmin-57">How to Set Up Automatic File-System Sharing</a></p>
<p class="toc level4"><a href="rfsadmin-56.html#rfsadmin-112">How to Enable WebNFS Access</a></p>
<p class="toc level4"><a href="rfsadmin-56.html#rfsadmin-101">How to Enable NFS Server Logging</a></p>
<p class="toc level3 tocsp"><a href="rfsadmin-61.html">Mounting File Systems</a></p>
<p class="toc level4"><a href="rfsadmin-61.html#rfsadmin-62">How to Mount a File System at Boot Time</a></p>
<p class="toc level4"><a href="rfsadmin-61.html#rfsadmin-66">How to Mount a File System From the Command Line</a></p>
<p class="toc level4"><a href="rfsadmin-61.html#rfsadmin-75">How to Disable Large Files on an NFS Server</a></p>
<p class="toc level4"><a href="rfsadmin-61.html#rfsadmin-81">How to Use Client-Side Failover</a></p>
<p class="toc level4"><a href="rfsadmin-61.html#rfsadmin-84">How to Disable Mount Access for One Client</a></p>
<p class="toc level4"><a href="rfsadmin-61.html#rfsadmin-88">How to Mount an NFS File System Through a Firewall</a></p>
<p class="toc level4"><a href="rfsadmin-61.html#rfsadmin-92">How to Mount an NFS File System Using an NFS URL</a></p>
<p class="toc level3 tocsp"><a href="rfsadmin-68.html">Setting Up NFS Services</a></p>
<p class="toc level4"><a href="rfsadmin-68.html#rfsadmin-69">How to Start the NFS Services</a></p>
<p class="toc level4"><a href="rfsadmin-68.html#rfsadmin-72">How to Stop the NFS Services</a></p>
<p class="toc level4"><a href="rfsadmin-68.html#rfsadmin-121">How to Start the Automounter</a></p>
<p class="toc level4"><a href="rfsadmin-68.html#rfsadmin-124">How to Stop the Automounter</a></p>
<p class="toc level4"><a href="rfsadmin-68.html#rfsadmin-965">How to Select Different Versions of NFS on a Server</a></p>
<p class="toc level4"><a href="rfsadmin-68.html#rfsadmin-966">How to Select Different Versions of NFS on a Client by Modifying the <tt>/etc/default/nfs</tt> File</a></p>
<p class="toc level4"><a href="rfsadmin-68.html#ekqwg">How to Use the Command Line to Select Different Versions of NFS on a Client</a></p>
<p class="toc level3 tocsp"><a href="rfsadmin-96.html">Administering the Secure NFS System</a></p>
<p class="toc level4"><a href="rfsadmin-96.html#rfsadmin-97">How to Set Up a Secure NFS Environment With DH Authentication</a></p>
<p class="toc level3 tocsp"><a href="rfsadmin-110.html">WebNFS Administration Tasks</a></p>
<p class="toc level3"><a href="rfsadmin-127.html">Task Overview for Autofs Administration</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-250">How to Use the <tt>/etc/default/autofs</tt> File</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-133">How to Modify the Master Map</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-139">How to Modify Indirect Maps</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-142">How to Modify Direct Maps</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-149">How to Access CD-ROM Applications With Autofs</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-152">How to Access PC-DOS Data Diskettes With Autofs</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-156">How to Access NFS File Systems by Using CacheFS</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-162">How to Set Up <tt>/home</tt> With Multiple Home Directory File Systems</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-166">How to Consolidate Project-Related Files Under <tt>/ws</tt></a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-171">How to Set Up Different Architectures to Access a Shared Namespace</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-179">How to Support Incompatible Client Operating System Versions</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-183">How to Replicate Shared Files Across Several Servers</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-186">How to Apply Autofs Security Restrictions</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-189">How to Use a Public File Handle With Autofs</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-192">How to Use NFS URLs With Autofs</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-196">How to Completely Disable Autofs Browsability on a Single NFS Client</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-200">How to Disable Autofs Browsability for All Clients</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-204">How to Disable Autofs Browsability on a Selected File System</a></p>
<p class="toc level3 tocsp"><a href="rfsadmin-214.html">Strategies for NFS Troubleshooting</a></p>
<div class="onpage">
<p class="toc level3"><a href="">NFS Troubleshooting Procedures</a></p>
<p class="toc level4"><a href="#rfsadmin-216">How to Check Connectivity on an NFS Client</a></p>
<p class="toc level4"><a href="#rfsadmin-224">How to Check the NFS Server Remotely</a></p>
<p class="toc level4"><a href="#rfsadmin-231">How to Verify the NFS Service on the Server</a></p>
<p class="toc level4"><a href="#rfsadmin-240">How to Restart NFS Services</a></p>
<p class="toc level4"><a href="#rfsadmin-243">How to Warm-Start <tt>rpcbind</tt></a></p>
<p class="toc level4"><a href="#rfsadmin-251">How to Verify Options Used With the <tt>mount</tt> Command</a></p>
</div>
<p class="toc level3 tocsp"><a href="rfsadmin-210.html">Troubleshooting Autofs</a></p>
<p class="toc level3"><a href="rfsadmin-255.html">NFS Error Messages</a></p>
<p class="toc level2 tocsp"><a href="rfsrefer-1.html">6.&nbsp;&nbsp;Accessing Network File Systems (Reference)</a></p>
<p class="toc level1 tocsp"><a href="slptm.html">Part&nbsp;III&nbsp;SLP Topics</a></p>
<p class="toc level2"><a href="slparch-16.html">7.&nbsp;&nbsp;SLP (Overview)</a></p>
<p class="toc level2"><a href="slp.setup-10.html">8.&nbsp;&nbsp;Planning and Enabling SLP (Tasks)</a></p>
<p class="toc level2"><a href="ch.configuration-6.html">9.&nbsp;&nbsp;Administering SLP (Tasks)</a></p>
<p class="toc level2"><a href="legacy-7.html">10.&nbsp;&nbsp;Incorporating Legacy Services</a></p>
<p class="toc level2"><a href="slpreference.html">11.&nbsp;&nbsp;SLP (Reference)</a></p>
<p class="toc level1 tocsp"><a href="mailtm-1.html">Part&nbsp;IV&nbsp;Mail Services Topics</a></p>
<p class="toc level2"><a href="mailintro-1.html">12.&nbsp;&nbsp;Mail Services (Overview)</a></p>
<p class="toc level2"><a href="mailadmin-1.html">13.&nbsp;&nbsp;Mail Services (Tasks)</a></p>
<p class="toc level2"><a href="mailrefer-1.html">14.&nbsp;&nbsp;Mail Services (Reference)</a></p>
<p class="toc level1 tocsp"><a href="modemtm-1.html">Part&nbsp;V&nbsp;Serial Networking Topics</a></p>
<p class="toc level2"><a href="pppsvrconfig.intro-1.html">15.&nbsp;&nbsp;Solaris PPP 4.0 (Overview)</a></p>
<p class="toc level2"><a href="pppsvrconfig.p2plink-1.html">16.&nbsp;&nbsp;Planning for the PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.dialin-1.html">17.&nbsp;&nbsp;Setting Up a Dial-up PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.leased-1.html">18.&nbsp;&nbsp;Setting Up a Leased-Line PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.auth-1.html">19.&nbsp;&nbsp;Setting Up PPP Authentication (Tasks)</a></p>
<p class="toc level2"><a href="ppp.pppoe-1.html">20.&nbsp;&nbsp;Setting Up a PPPoE Tunnel (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.troubleshoot-1.html">21.&nbsp;&nbsp;Fixing Common PPP Problems (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.reference-1.html">22.&nbsp;&nbsp;Solaris PPP 4.0 (Reference)</a></p>
<p class="toc level2"><a href="pppsvrconfig.convert.app-1.html">23.&nbsp;&nbsp;Migrating From Asynchronous Solaris PPP to Solaris PPP 4.0 (Tasks)</a></p>
<p class="toc level2"><a href="uucpov-1.html">24.&nbsp;&nbsp;UUCP (Overview)</a></p>
<p class="toc level2"><a href="uucptasks-1.html">25.&nbsp;&nbsp;Administering UUCP (Tasks)</a></p>
<p class="toc level2"><a href="uucpref-1.html">26.&nbsp;&nbsp;UUCP (Reference)</a></p>
<p class="toc level1 tocsp"><a href="wwrstm.html">Part&nbsp;VI&nbsp;Working With Remote Systems Topics</a></p>
<p class="toc level2"><a href="wwrsov.html">27.&nbsp;&nbsp;Working With Remote Systems (Overview)</a></p>
<p class="toc level2"><a href="wuftp-17.html">28.&nbsp;&nbsp;Administering the FTP Server (Tasks)</a></p>
<p class="toc level2"><a href="remotehowtoaccess-99941.html">29.&nbsp;&nbsp;Accessing Remote Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="netmonitortm-1.html">Part&nbsp;VII&nbsp;Monitoring Network Services Topics</a></p>
<p class="toc level2"><a href="netmonitor-1.html">30.&nbsp;&nbsp;Monitoring Network Performance (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="rfsadmin-215"></a><h3>NFS Troubleshooting Procedures</h3>
<p>To determine where the NFS service has failed, you need to follow
several procedures to isolate the failure. Check for the following items:</p>
<ul><li><p>Can the client reach the server?</p></li>
<li><p>Can the client contact the NFS services on the server?</p></li>
<li><p>Are the NFS services running on the server?</p></li></ul>
<p><a name="indexterm-386"></a><a name="indexterm-387"></a><a name="indexterm-388"></a>In the process of checking these items, you might notice that other portions
of the network are not functioning. For example, the name service or the
physical network hardware might not be functioning. The <a href="http://docs.sun.com/doc/819-3194"><i>System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</i></a> contains debugging procedures for
several name services. Also, during the process you might see that the problem
is not at the client end. An example is if you get
at least one trouble call from every subnet in your work area. In
this situation, you should  assume that the problem is the server or
the network hardware near the server. So, you should  start the debugging
process at the server, not at the client.   </p>

<a name="rfsadmin-216"></a><h4>How to Check Connectivity on an NFS Client</h4><a name="indexterm-389"></a><ol>
<li><a name="rfsadmin-step-785"></a><b><a name="indexterm-390"></a><a name="indexterm-391"></a><a name="indexterm-392"></a><a name="indexterm-393"></a>Check that the NFS server is reachable from the client. On the client,
type the following command.</b><pre>% <tt><b>/usr/sbin/ping bee</b></tt>
bee is alive</pre><p>If the command reports that the server is alive, remotely check the NFS
server. See <a href="#rfsadmin-224">How to Check the NFS Server Remotely</a>.</p></li>
<li><a name="rfsadmin-step-786"></a><b>If the server is not reachable from the client, ensure that the local
name service is running. </b><p>For NIS+ clients, type the following:</p><pre>% <tt><b>/usr/lib/nis/nisping -u</b></tt>
Last updates for directory eng.acme.com. :
Master server is eng-master.acme.com.
        Last update occurred at Mon Jun  5 11:16:10 1995

Replica server is eng1-replica-58.acme.com.
        Last Update seen was Mon Jun  5 11:16:10 1995</pre></li>
<li><a name="rfsadmin-step-787"></a><b>If the name service is running, ensure that the client has received the
correct host information by typing the following:</b><pre>% <tt><b>/usr/bin/getent hosts bee</b></tt>
129.144.83.117    bee.eng.acme.com</pre></li>
<li><a name="rfsadmin-step-221"></a><b>If the host information is correct, but the server is not reachable from
the client, run the <tt>ping</tt> command from another client.</b><p>If the command run from a second client fails, see <a href="#rfsadmin-231">How to Verify the NFS Service on the Server</a>.</p></li>
<li><a name="rfsadmin-step-788"></a><b>If the server is reachable from the second client, use <tt>ping</tt> to check
connectivity of the first client to other systems on the local net.</b><p>If this command fails, check the networking software configuration on the client, for
example, <tt>/etc/netmasks</tt> and <tt>/etc/nsswitch.conf</tt>.</p></li>
<li><a name="rfsadmin-step-231"></a>(Optional) <b>Check the output of the <tt>rpcinfo</tt> command.</b><p>If the <tt>rpcinfo</tt> command does not display <tt>program 100003 version 4 ready and waiting</tt>, then NFS version 4 is not
enabled on the server. See <a href="rfsadmin-68.html#rfsadmin-tbl-196">Table&nbsp;5-3</a> for information about enabling NFS version 4.</p></li>
<li><a name="rfsadmin-step-789"></a><b>If the software is correct, check the networking hardware.</b><p>Try to move the client onto a second net drop.</p></li></ol>

<a name="rfsadmin-224"></a><h4>How to Check the NFS Server Remotely</h4><p>Note that support for both the UDP and the MOUNT protocols is
not necessary if you are using an NFS version 4 server.</p><ol>
<li><a name="rfsadmin-step-226"></a><b>Check that the NFS services have started on the NFS server by typing
the following command:</b><pre>% <tt><b>rpcinfo -s bee|egrep 'nfs|mountd'</b></tt>
 100003  3,2    tcp,udp,tcp6,upd6                nfs     superuser
 100005  3,2,1  ticots,ticotsord,tcp,tcp6,ticlts,udp,upd6  mountd  superuser</pre><p>If the daemons have not been started, see <a href="#rfsadmin-240">How to Restart NFS Services</a>.</p></li>
<li><a name="rfsadmin-step-275"></a><b>Check that the server's <tt>nfsd</tt> processes are responding. </b><p><a name="indexterm-394"></a><a name="indexterm-395"></a>On the client, type the following command to test the UDP NFS connections
from the server.  </p><pre>% <tt><b>/usr/bin/rpcinfo -u bee nfs</b></tt>
program 100003 version 2 ready and waiting
program 100003 version 3 ready and waiting</pre>
<hr><p><b>Note - </b>NFS version 4 does not support UDP.</p>
<hr>
<p>If the server is running, it prints a list of program and
version numbers. Using the <tt>-t</tt> option tests the TCP connection. If this command fails,
proceed to <a href="#rfsadmin-231">How to Verify the NFS Service on the Server</a>.</p></li>
<li><a name="rfsadmin-step-228"></a><b><a name="indexterm-396"></a><a name="indexterm-397"></a>Check that the server's <tt>mountd</tt> is responding, by typing the following command.</b><pre>% <tt><b>/usr/bin/rpcinfo -u bee mountd</b></tt>
program 100005 version 1 ready and waiting
program 100005 version 2 ready and waiting
program 100005 version 3 ready and waiting</pre><p>If the server is running, it prints a list of program and
version numbers that are associated with the UDP protocol. Using the <tt>-t</tt> option tests
the TCP connection. If either attempt fails, proceed to <a href="#rfsadmin-231">How to Verify the NFS Service on the Server</a>.</p></li>
<li><a name="rfsadmin-step-276"></a><b>Check the local autofs service if it is being used:</b><pre>% <tt><b>cd /net/wasp</b></tt></pre><p>Choose a <tt>/net</tt> or <tt>/home</tt> mount point that you know should work properly.
If this command fails, then as <tt>root</tt> on the client, type the
following to restart the autofs service:</p><pre># <tt><b>svcadm restart system/filesystem/autofs</b></tt></pre></li>
<li><a name="rfsadmin-step-277"></a><b>Verify that file system is shared as expected on the server.</b><pre>% <tt><b>/usr/sbin/showmount -e bee</b></tt>
/usr/src                                        eng
/export/share/man                        (everyone)</pre><p>Check the entry on the server and the local mount entry for
errors. Also, check the namespace. In this instance, if the first client is
not in the <tt>eng</tt> netgroup, that client cannot mount the <tt>/usr/src</tt> file system.</p><p>Check all entries that include mounting information in all the local files. The
list includes <tt>/etc/vfstab</tt> and all the <tt>/etc/auto_*</tt> files.</p></li></ol>

<a name="rfsadmin-231"></a><h4>How to Verify the NFS Service on the Server</h4><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.
To configure a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="rfsadmin-step-234"></a><b>Check that the server can reach the clients. </b><pre># <tt><b>ping lilac</b></tt>
lilac is alive</pre></li>
<li><a name="rfsadmin-step-235"></a><b>If the client is not reachable from the server, ensure that the local
name service is running. For NIS+ clients, type the following:</b><pre>% <tt><b>/usr/lib/nis/nisping -u</b></tt>
Last updates for directory eng.acme.com. :
Master server is eng-master.acme.com.
        Last update occurred at Mon Jun  5 11:16:10 1995

Replica server is eng1-replica-58.acme.com.
        Last Update seen was Mon Jun  5 11:16:10 1995</pre></li>
<li><a name="rfsadmin-step-236"></a><b>If the name service is running, check the networking software configuration on the
server, for example, <tt>/etc/netmasks</tt> and <tt>/etc/nsswitch.conf</tt>.</b></li>
<li><a name="rfsadmin-step-239"></a><b><a name="indexterm-398"></a>Type the following command to check whether the <tt>rpcbind</tt> daemon is running. </b><pre># <tt><b>/usr/bin/rpcinfo -u localhost rpcbind</b></tt>
program 100000 version 1 ready and waiting
program 100000 version 2 ready and waiting
program 100000 version 3 ready and waiting</pre><p><a name="indexterm-399"></a>If the server is running, it prints a list of program and
version numbers that are associated with the UDP protocol. If <tt>rpcbind</tt> seems to be
hung, either reboot the server or follow the steps in <a href="#rfsadmin-243">How to Warm-Start <tt>rpcbind</tt></a>. </p></li>
<li><a name="rfsadmin-step-237"></a><b><a name="indexterm-400"></a><a name="indexterm-401"></a>Type the following command to check whether the <tt>nfsd</tt> daemon is running. 
</b><pre># <tt><b>rpcinfo -u localhost nfs</b></tt>
program 100003 version 2 ready and waiting
program 100003 version 3 ready and waiting
# <tt><b>ps -ef | grep nfsd</b></tt>
root    232      1  0  Apr 07     ?     0:01 /usr/lib/nfs/nfsd -a 16
root   3127   2462  1  09:32:57  pts/3  0:00 grep nfsd</pre>
<hr><p><b>Note - </b>NFS version 4 does not support UDP.</p>
<hr>
<p>If the server is running, it prints a list of program and
version numbers that are associated with the UDP protocol. Also use the <tt>-t</tt>
option with <tt>rpcinfo</tt> to check the TCP connection. If these commands fail, restart the
NFS service. See <a href="#rfsadmin-240">How to Restart NFS Services</a>. </p></li>
<li><a name="rfsadmin-step-238"></a><b><a name="indexterm-402"></a><a name="indexterm-403"></a><a name="indexterm-404"></a><a name="indexterm-405"></a>Type the following command to check whether the <tt>mountd</tt> daemon is running. 
  </b><pre># <tt><b>/usr/bin/rpcinfo -u localhost mountd</b></tt>
program 100005 version 1 ready and waiting
program 100005 version 2 ready and waiting
program 100005 version 3 ready and waiting
# <tt><b>ps -ef | grep mountd</b></tt>
root    145      1 0 Apr 07  ?     21:57 /usr/lib/autofs/automountd
root    234      1 0 Apr 07  ?     0:04  /usr/lib/nfs/mountd
root   3084 2462 1 09:30:20 pts/3  0:00  grep mountd</pre><p>If the server is running, it prints a list of program and
version numbers that are associated with the UDP protocol. Also use the <tt>-t</tt>
option with <tt>rpcinfo</tt> to check the TCP connection. If these commands fail, restart the
NFS service. See <a href="#rfsadmin-240">How to Restart NFS Services</a>. </p></li></ol>

<a name="rfsadmin-240"></a><h4>How to Restart NFS Services</h4><a name="indexterm-406"></a><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.
To configure a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="rfsadmin-step-242"></a><b>Restart the NFS service on the server.</b><p>Type the following command.</p><pre># <tt><b>svcadm restart network/nfs/server</b></tt></pre></li></ol>

<a name="rfsadmin-243"></a><h4>How to Warm-Start <tt>rpcbind</tt></h4><p><a name="indexterm-407"></a><a name="indexterm-408"></a>If the NFS server cannot be rebooted because of work in progress, you
can restart <tt>rpcbind</tt> without having to restart all of the services that use
RPC. Just complete a warm start by following these steps.</p><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.
To configure a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="rfsadmin-step-245"></a><b>Determine the PID for <tt>rpcbind</tt>.</b><p>Run <tt>ps</tt> to get the PID, which is the value in the second
column.</p><pre># <tt><b>ps -ef |grep rpcbind</b></tt>
    root   115     1  0   May 31 ?        0:14 /usr/sbin/rpcbind
    root 13000  6944  0 11:11:15 pts/3    0:00 grep rpcbind</pre></li>
<li><a name="rfsadmin-step-246"></a><b>Send a SIGTERM signal to the <tt>rpcbind</tt> process.</b><p>In this example, <tt>term</tt> is the signal that is to be sent and
<tt>115</tt> is the PID for the program (see the <a href="http://docs.sun.com/doc/819-2239/kill-1?a=view"><tt>kill</tt>(1)</a> man page).
This command causes <tt>rpcbind</tt> to create a list of the current registered
services in <tt>/tmp/portmap.file</tt> and <tt>/tmp/rpcbind.file</tt>.</p><pre># <tt><b>kill -s term 115</b></tt></pre>
<hr><p><b>Note - </b>If you do not kill the <tt>rpcbind</tt> process with the <tt>-s</tt> <tt>term</tt> option,
you cannot complete a warm start of <tt>rpcbind</tt>. You must reboot the server
to restore service.</p>
<hr>
</li>
<li><a name="rfsadmin-step-247"></a><b>Restart <tt>rpcbind</tt>.</b><p>Warm-restart the command so that the files that were created by the
<tt>kill</tt> command are consulted. A warm start also ensures that the process resumes
without requiring a restart of all the RPC services. See the <a href="http://docs.sun.com/doc/819-2240/rpcbind-1m?a=view"><tt>rpcbind</tt>(1M)</a>
man page.</p><pre># <tt><b>/usr/sbin/rpcbind -w</b></tt></pre></li></ol>

<a name="rfsadmin-248"></a><h4>Identifying Which Host Is Providing NFS File Service</h4>
<a name="indexterm-409"></a><a name="indexterm-410"></a><p>Run the <tt>nfsstat</tt> command with the <tt>-m</tt> option to gather current NFS information.
The name of the current server is printed after &ldquo;<tt>currserver=</tt>&rdquo;. </p><pre>% <tt><b>nfsstat -m</b></tt>
/usr/local from bee,wasp:/export/share/local
 Flags: vers=3,proto=tcp,sec=sys,hard,intr,llock,link,synlink,
        acl,rsize=32768,wsize=32678,retrans=5
 Failover: noresponse=0, failover=0, remap=0, currserver=bee</pre>

<a name="rfsadmin-251"></a><h4>How to Verify Options Used With the <tt>mount</tt> Command</h4><p>In the Solaris 2.6 release and in any versions of the <tt>mount</tt>
command that were patched after the 2.6 release, no warning is issued for
invalid options. The following procedure helps determine whether the options that were supplied either
on the command line or through <tt>/etc/vfstab</tt> were valid.</p><p>For this example, assume that the following command has been run:</p><pre># <tt><b>mount -F nfs -o ro,vers=2 bee:/export/share/local /mnt</b></tt></pre><ol>
<li><a name="rfsadmin-step-253"></a><b>Verify the options by running the following command.</b><pre>% <tt><b>nfsstat -m</b></tt>
/mnt from bee:/export/share/local
Flags:  vers=2,proto=tcp,sec=sys,hard,intr,dynamic,acl,rsize=8192,wsize=8192,
        retrans=5</pre><p>The file system from <tt>bee</tt> has been mounted with the protocol version set
to <tt>2</tt>. Unfortunately, the <tt>nfsstat</tt> command does not display information about all
of the options. However, using the <tt>nfsstat</tt> command is the most accurate way to
verify the options.</p></li>
<li><a name="rfsadmin-step-254"></a><b>Check the entry in <tt>/etc/mnttab</tt>.</b><p>The <tt>mount</tt> command does not allow invalid options to be added to the
mount table. Therefore, verify that the options that are listed in the file
match those options that are listed on the command line. In this way,
you can check those options that are not reported by the <tt>nfsstat</tt>
command.</p><pre># <tt><b>grep bee /etc/mnttab</b></tt>
bee:/export/share/local /mnt nfs    ro,vers=2,dev=2b0005e 859934818</pre></li></ol>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="rfsadmin-214.html">Previous</a>
             </td>
             <td align="right">
                 <a href="rfsadmin-210.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

