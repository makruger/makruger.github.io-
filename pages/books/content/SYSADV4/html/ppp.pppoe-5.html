<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Setting Up a PPPoE Access Server - System Administration Guide: Network Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: Network Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ppp.pppoe-2.html">Previous</a>
             </td>
             <td align="right">
                 <a href="pppsvrconfig.troubleshoot-1.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="netservices-1.html">Part&nbsp;I&nbsp;Network Services Topics</a></p>
<p class="toc level2"><a href="nsov-1.html">1.&nbsp;&nbsp;Network Service (Overview)</a></p>
<p class="toc level2"><a href="nca-1.html">2.&nbsp;&nbsp;Managing Web Cache Servers</a></p>
<p class="toc level2"><a href="time-1.html">3.&nbsp;&nbsp;Time-Related Services</a></p>
<p class="toc level1 tocsp"><a href="rfstm-1.html">Part&nbsp;II&nbsp;Accessing Network File Systems Topics</a></p>
<p class="toc level2"><a href="rfsintro-2.html">4.&nbsp;&nbsp;Managing Network File Systems (Overview)</a></p>
<p class="toc level2"><a href="rfsadmin-8.html">5.&nbsp;&nbsp;Network File System Administration (Tasks)</a></p>
<p class="toc level2"><a href="rfsrefer-1.html">6.&nbsp;&nbsp;Accessing Network File Systems (Reference)</a></p>
<p class="toc level1 tocsp"><a href="slptm.html">Part&nbsp;III&nbsp;SLP Topics</a></p>
<p class="toc level2"><a href="slparch-16.html">7.&nbsp;&nbsp;SLP (Overview)</a></p>
<p class="toc level2"><a href="slp.setup-10.html">8.&nbsp;&nbsp;Planning and Enabling SLP (Tasks)</a></p>
<p class="toc level2"><a href="ch.configuration-6.html">9.&nbsp;&nbsp;Administering SLP (Tasks)</a></p>
<p class="toc level2"><a href="legacy-7.html">10.&nbsp;&nbsp;Incorporating Legacy Services</a></p>
<p class="toc level2"><a href="slpreference.html">11.&nbsp;&nbsp;SLP (Reference)</a></p>
<p class="toc level1 tocsp"><a href="mailtm-1.html">Part&nbsp;IV&nbsp;Mail Services Topics</a></p>
<p class="toc level2"><a href="mailintro-1.html">12.&nbsp;&nbsp;Mail Services (Overview)</a></p>
<p class="toc level2"><a href="mailadmin-1.html">13.&nbsp;&nbsp;Mail Services (Tasks)</a></p>
<p class="toc level2"><a href="mailrefer-1.html">14.&nbsp;&nbsp;Mail Services (Reference)</a></p>
<p class="toc level1 tocsp"><a href="modemtm-1.html">Part&nbsp;V&nbsp;Serial Networking Topics</a></p>
<p class="toc level2"><a href="pppsvrconfig.intro-1.html">15.&nbsp;&nbsp;Solaris PPP 4.0 (Overview)</a></p>
<p class="toc level2"><a href="pppsvrconfig.p2plink-1.html">16.&nbsp;&nbsp;Planning for the PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.dialin-1.html">17.&nbsp;&nbsp;Setting Up a Dial-up PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.leased-1.html">18.&nbsp;&nbsp;Setting Up a Leased-Line PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.auth-1.html">19.&nbsp;&nbsp;Setting Up PPP Authentication (Tasks)</a></p>
<p class="toc level2"><a href="ppp.pppoe-1.html">20.&nbsp;&nbsp;Setting Up a PPPoE Tunnel (Tasks)</a></p>
<p class="toc level3"><a href="ppp.pppoe-40.html">Major Tasks for Setting Up a PPPoE Tunnel (Task Maps)</a></p>
<p class="toc level3"><a href="ppp.pppoe-2.html">Setting Up the PPPoE Client</a></p>
<p class="toc level4"><a href="ppp.pppoe-2.html#ppp.pppoe-55">How to Configure an Interface for a PPPoE Client</a></p>
<p class="toc level4"><a href="ppp.pppoe-2.html#ppp.pppoe-56">How to Define a PPPoE Access Server Peer</a></p>
<div class="onpage">
<p class="toc level3 tocsp"><a href="">Setting Up a PPPoE Access Server</a></p>
<p class="toc level4"><a href="#ppp.pppoe-58">How to Set Up a PPPoE Access Server</a></p>
<p class="toc level4"><a href="#ppp.pppoe-60">How to Modify an Existing <tt>/etc/ppp/pppoe</tt> File</a></p>
<p class="toc level4"><a href="#ppp.pppoe-61">How to Restrict the Use of an Interface to Particular Clients</a></p>
</div>
<p class="toc level2 tocsp"><a href="pppsvrconfig.troubleshoot-1.html">21.&nbsp;&nbsp;Fixing Common PPP Problems (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.reference-1.html">22.&nbsp;&nbsp;Solaris PPP 4.0 (Reference)</a></p>
<p class="toc level2"><a href="pppsvrconfig.convert.app-1.html">23.&nbsp;&nbsp;Migrating From Asynchronous Solaris PPP to Solaris PPP 4.0 (Tasks)</a></p>
<p class="toc level2"><a href="uucpov-1.html">24.&nbsp;&nbsp;UUCP (Overview)</a></p>
<p class="toc level2"><a href="uucptasks-1.html">25.&nbsp;&nbsp;Administering UUCP (Tasks)</a></p>
<p class="toc level2"><a href="uucpref-1.html">26.&nbsp;&nbsp;UUCP (Reference)</a></p>
<p class="toc level1 tocsp"><a href="wwrstm.html">Part&nbsp;VI&nbsp;Working With Remote Systems Topics</a></p>
<p class="toc level2"><a href="wwrsov.html">27.&nbsp;&nbsp;Working With Remote Systems (Overview)</a></p>
<p class="toc level2"><a href="wuftp-17.html">28.&nbsp;&nbsp;Administering the FTP Server (Tasks)</a></p>
<p class="toc level2"><a href="remotehowtoaccess-99941.html">29.&nbsp;&nbsp;Accessing Remote Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="netmonitortm-1.html">Part&nbsp;VII&nbsp;Monitoring Network Services Topics</a></p>
<p class="toc level2"><a href="netmonitor-1.html">30.&nbsp;&nbsp;Monitoring Network Performance (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="ppp.pppoe-5"></a><h3>Setting Up a PPPoE Access Server</h3>
<p><a name="indexterm-1895"></a><a name="indexterm-1896"></a>If your company is a service provider, you can offer Internet and other services
to clients that reach your site through DSL connections. The procedure involves determining which interfaces
on the server to involve in the PPPoE tunnel and defining which services are
made available to the users.</p>

<a name="ppp.pppoe-58"></a><h4>How to Set Up a PPPoE Access Server</h4><p>Use this procedure to define the Ethernet interface to be used for the PPPoE
tunnel and to configure the services that the access server offers.</p><ol>
<li><a name="ppp.pppoe-step-14"></a><b>Become superuser on the access server or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>. To configure a
role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="ppp.pppoe-step-26"></a><b>Add the name of the Ethernet interfaces that are dedicated to the PPPoE tunnels to
the <tt>/etc/ppp/pppoe.if</tt> file.</b><p><a name="indexterm-1897"></a><a name="indexterm-1898"></a>For example, you would use the following <tt>/etc/ppp/pppoe.if</tt> file for the access server
<tt>dslserve</tt> that is shown in <a href="ppp.p2plink-25.html#ppp.p2plink-28">Example of a Configuration for a PPPoE Tunnel</a>.</p><pre># <tt><b>cat /etc/ppp/pppoe.if</b></tt>
<tt><b>hme1</b></tt>
<tt><b>hme2</b></tt></pre></li>
<li><b><a name="indexterm-1899"></a>Define global services that are provided by the access server in the <tt>/etc/ppp/pppoe</tt> file.</b><p>The following <tt>/etc/ppp/pppoe</tt> file lists the services that are provided by access server
<tt>dslserve</tt>, which was shown in <a href="ppp.p2plink-25.html#ppp.p2plink-fig-38">Figure&nbsp;16-5</a>.</p><pre><tt><b>device hme1,hme2</b></tt>
<tt><b>service internet</b></tt>
    <tt><b>pppd "proxyarp 192.168.1.1:"</b></tt>
<tt><b>service debugging</b></tt>
    <tt><b>pppd "debug proxyarp 192.168.1.1:"</b></tt></pre><p>In the file example, Internet service is announced for <tt>dslserve</tt>'s Ethernet interfaces <tt>hme1</tt>
and <tt>hme2</tt>. Debugging is turned on for PPP links on the Ethernet interfaces.</p></li>
<li><b>Set up the PPP configuration files in the same way that you would for
a dial-in server.</b><p>For more information, refer to <a href="ppp.reference-39.html">Creating an IP Addressing Scheme for Callers</a>.</p></li>
<li><b><a name="indexterm-1900"></a>Start the <tt>pppoed</tt> daemon.</b><pre><tt><b># /etc/init.d/pppd start</b></tt></pre><p><tt>pppd</tt> also plumbs the interfaces that are listed in <tt>/etc/ppp/pppoe.if</tt>.</p></li>
<li><a name="ppp.pppoe-step-45"></a>(Optional) <b>Verify that the interfaces on the server are plumbed for PPPoE.</b><pre># <tt><b>/usr/sbin/sppptun query</b></tt>
hme1:pppoe
hme1:pppoed
hme2:pppoe
hme2:pppoed</pre><p>The previous sample shows that interfaces <tt>hme1</tt> and <tt>hme2</tt> are currently plumbed for PPPoE.
You can also use the <tt>/usr/sbin/sppptun</tt> command to manually plumb interfaces for PPPoE. For
instructions, refer to <a href="ppp.reference-45.html#ppp.reference-49"><tt>/usr/sbin/sppptun</tt> Command</a>.</p></li></ol>

<a name="ppp.pppoe-60"></a><h4>How to Modify an Existing <tt>/etc/ppp/pppoe</tt> File</h4><a name="indexterm-1901"></a><a name="indexterm-1902"></a><a name="indexterm-1903"></a><ol>
<li><a name="ppp.pppoe-step-50"></a><b>Become superuser on the access server or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>. To configure a
role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="ppp.pppoe-step-47"></a><b>Modify <tt>/etc/ppp/pppoe</tt>, as needed.</b></li>
<li><a name="ppp.pppoe-step-48"></a><b>Cause the <tt>pppoed</tt> daemon to recognize the new services.</b><pre># <tt><b>pkill -HUP pppoed</b></tt></pre></li></ol>

<a name="ppp.pppoe-61"></a><h4>How to Restrict the Use of an Interface to Particular Clients</h4><p><a name="indexterm-1904"></a>The next procedure shows how to restrict an interface to a group of PPPoE
clients. Before performing this task, you need to obtain the real Ethernet MAC addresses
of the clients you are assigning to the interface.</p>
<hr><p><b>Note - </b>Some systems allow you to change the MAC address on the Ethernet interface. You
should view this ability as a convenience factor, not a security measure. </p>
<hr>
<p>Using the example that is shown in <a href="ppp.p2plink-25.html#ppp.p2plink-28">Example of a Configuration for a PPPoE Tunnel</a>, these steps show how to reserve
one of <tt>dslserve</tt>'s interfaces, <tt>hme1</tt>, for clients at MiddleCo.</p><ol>
<li><a name="ppp.pppoe-step-44"></a><b><a name="indexterm-1905"></a>Configure the access server's interfaces and define the services, as shown in <a href="#ppp.pppoe-58">How to Set Up a PPPoE Access Server</a>.</b></li>
<li><a name="ppp.pppoe-step-52"></a><b>Create entries for clients in the server's <tt>/etc/ethers</tt> database.</b><p>Here is a sample entry for clients Red, Blue, and Yellow.</p><pre>8:0:20:1:40:30 redether
8:0:20:1:40:10 yellowether
8:0:20:1:40:25 blueether</pre><p>The sample assigns the symbolic names <tt>redether</tt>, <tt>yellowether</tt>, and <tt>blueether</tt> to the Ethernet
addresses of clients Red, Yellow, and Blue. The assignment of symbolic names to the MAC
addresses is optional. </p></li>
<li><a name="ppp.pppoe-step-32"></a><b><a name="indexterm-1906"></a><a name="indexterm-1907"></a>Restrict services that are provided on a specific interface by defining the following information in
the <tt>/etc/ppp/pppoe.</tt><b>device</b> file.</b><p>In this file, <b>device</b> is the name of the device to be defined.</p><pre># <tt><b>cat /etc/ppp/pppoe.hme1</b></tt>
service internet
     pppd "name dslserve-hme1"
     clients redether,yellowether,blueether</pre><p><tt>dslserve-hme1</tt> is the access server's name, which is used in matching entries in the
<tt>pap-secrets</tt> file. The <tt>clients</tt> option restricts the use of interface <tt>hme1</tt> to clients with
the symbolic Ethernet names <tt>redether</tt>, <tt>yellowether</tt>, and <tt>blueether</tt>. </p><p>If you did not define symbolic names for client's MAC addresses in <tt>/etc/ethers</tt>, you can
use the numeric addresses as arguments for the <tt>clients</tt> option. Wildcards are allowed.</p><p>For example, you can specify the numeric address <tt>clients 8:0:20:*:*:*</tt>. By using wildcards, all matching addresses in
<tt>/etc/ethers</tt> are accepted.</p></li>
<li><a name="ppp.pppoe-step-37"></a><b><a name="indexterm-1908"></a>Create the <tt>/etc/ppp/pap-secrets</tt> file for the access server: </b><pre><tt><b>Red dslserve-hme1 redpasswd *</b></tt>
<tt><b>Blue dslserve-hme1 bluepasswd *</b></tt>
<tt><b>Yellow dslserve-hme1 yellowpassd *</b></tt></pre><p>The entries are the PAP names and passwords of clients that are allowed to
run PPP over <tt>dslserve</tt>'s <tt>hme1</tt> interface. </p><p>For more information about PAP authentication, see <a href="pppsvrconfig.auth-2.html">Configuring PAP Authentication</a>.</p></li></ol><h6>See Also</h6><p>The following list provides references to related information.</p>
<ul><li><p>To learn more about PPPoE, see <a href="ppp.reference-45.html">Creating PPPoE Tunnels for DSL Support</a>.</p></li>
<li><p>To troubleshoot PPPoE and PPP problems, see <a href="ppp.trouble-6.html">Solving PPP-Related and PPPoE-Related Problems</a>.</p></li>
<li><p>To configure a PPPoE client, see <a href="ppp.pppoe-2.html">Setting Up the PPPoE Client</a>.</p></li>
<li><p>To configure PAP authentication for a client, see <a href="pppsvrconfig.auth-2.html#pppsvrconfig.auth-6">Configuring PAP Authentication for Trusted Callers (Dial-out Machines)</a>.</p></li>
<li><p>To configure PAP authentication on a server, see <a href="pppsvrconfig.auth-2.html#pppsvrconfig.auth-3">Configuring PAP Authentication on the Dial-in Server</a>.</p></li></ul>

         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ppp.pppoe-2.html">Previous</a>
             </td>
             <td align="right">
                 <a href="pppsvrconfig.troubleshoot-1.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

