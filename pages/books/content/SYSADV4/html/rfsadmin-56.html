<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Automatic File-System Sharing - System Administration Guide: Network Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: Network Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="rfsadmin-8.html">Previous</a>
             </td>
             <td align="right">
                 <a href="rfsadmin-61.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="netservices-1.html">Part&nbsp;I&nbsp;Network Services Topics</a></p>
<p class="toc level2"><a href="nsov-1.html">1.&nbsp;&nbsp;Network Service (Overview)</a></p>
<p class="toc level2"><a href="nca-1.html">2.&nbsp;&nbsp;Managing Web Cache Servers</a></p>
<p class="toc level2"><a href="time-1.html">3.&nbsp;&nbsp;Time-Related Services</a></p>
<p class="toc level1 tocsp"><a href="rfstm-1.html">Part&nbsp;II&nbsp;Accessing Network File Systems Topics</a></p>
<p class="toc level2"><a href="rfsintro-2.html">4.&nbsp;&nbsp;Managing Network File Systems (Overview)</a></p>
<p class="toc level2"><a href="rfsadmin-8.html">5.&nbsp;&nbsp;Network File System Administration (Tasks)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Automatic File-System Sharing</a></p>
<p class="toc level4"><a href="#rfsadmin-57">How to Set Up Automatic File-System Sharing</a></p>
<p class="toc level4"><a href="#rfsadmin-112">How to Enable WebNFS Access</a></p>
<p class="toc level4"><a href="#rfsadmin-101">How to Enable NFS Server Logging</a></p>
</div>
<p class="toc level3 tocsp"><a href="rfsadmin-61.html">Mounting File Systems</a></p>
<p class="toc level4"><a href="rfsadmin-61.html#rfsadmin-62">How to Mount a File System at Boot Time</a></p>
<p class="toc level4"><a href="rfsadmin-61.html#rfsadmin-66">How to Mount a File System From the Command Line</a></p>
<p class="toc level4"><a href="rfsadmin-61.html#rfsadmin-75">How to Disable Large Files on an NFS Server</a></p>
<p class="toc level4"><a href="rfsadmin-61.html#rfsadmin-81">How to Use Client-Side Failover</a></p>
<p class="toc level4"><a href="rfsadmin-61.html#rfsadmin-84">How to Disable Mount Access for One Client</a></p>
<p class="toc level4"><a href="rfsadmin-61.html#rfsadmin-88">How to Mount an NFS File System Through a Firewall</a></p>
<p class="toc level4"><a href="rfsadmin-61.html#rfsadmin-92">How to Mount an NFS File System Using an NFS URL</a></p>
<p class="toc level3 tocsp"><a href="rfsadmin-68.html">Setting Up NFS Services</a></p>
<p class="toc level4"><a href="rfsadmin-68.html#rfsadmin-69">How to Start the NFS Services</a></p>
<p class="toc level4"><a href="rfsadmin-68.html#rfsadmin-72">How to Stop the NFS Services</a></p>
<p class="toc level4"><a href="rfsadmin-68.html#rfsadmin-121">How to Start the Automounter</a></p>
<p class="toc level4"><a href="rfsadmin-68.html#rfsadmin-124">How to Stop the Automounter</a></p>
<p class="toc level4"><a href="rfsadmin-68.html#rfsadmin-965">How to Select Different Versions of NFS on a Server</a></p>
<p class="toc level4"><a href="rfsadmin-68.html#rfsadmin-966">How to Select Different Versions of NFS on a Client by Modifying the <tt>/etc/default/nfs</tt> File</a></p>
<p class="toc level4"><a href="rfsadmin-68.html#ekqwg">How to Use the Command Line to Select Different Versions of NFS on a Client</a></p>
<p class="toc level3 tocsp"><a href="rfsadmin-96.html">Administering the Secure NFS System</a></p>
<p class="toc level4"><a href="rfsadmin-96.html#rfsadmin-97">How to Set Up a Secure NFS Environment With DH Authentication</a></p>
<p class="toc level3 tocsp"><a href="rfsadmin-110.html">WebNFS Administration Tasks</a></p>
<p class="toc level3"><a href="rfsadmin-127.html">Task Overview for Autofs Administration</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-250">How to Use the <tt>/etc/default/autofs</tt> File</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-133">How to Modify the Master Map</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-139">How to Modify Indirect Maps</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-142">How to Modify Direct Maps</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-149">How to Access CD-ROM Applications With Autofs</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-152">How to Access PC-DOS Data Diskettes With Autofs</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-156">How to Access NFS File Systems by Using CacheFS</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-162">How to Set Up <tt>/home</tt> With Multiple Home Directory File Systems</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-166">How to Consolidate Project-Related Files Under <tt>/ws</tt></a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-171">How to Set Up Different Architectures to Access a Shared Namespace</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-179">How to Support Incompatible Client Operating System Versions</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-183">How to Replicate Shared Files Across Several Servers</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-186">How to Apply Autofs Security Restrictions</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-189">How to Use a Public File Handle With Autofs</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-192">How to Use NFS URLs With Autofs</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-196">How to Completely Disable Autofs Browsability on a Single NFS Client</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-200">How to Disable Autofs Browsability for All Clients</a></p>
<p class="toc level4"><a href="rfsadmin-127.html#rfsadmin-204">How to Disable Autofs Browsability on a Selected File System</a></p>
<p class="toc level3 tocsp"><a href="rfsadmin-214.html">Strategies for NFS Troubleshooting</a></p>
<p class="toc level3"><a href="rfsadmin-215.html">NFS Troubleshooting Procedures</a></p>
<p class="toc level4"><a href="rfsadmin-215.html#rfsadmin-216">How to Check Connectivity on an NFS Client</a></p>
<p class="toc level4"><a href="rfsadmin-215.html#rfsadmin-224">How to Check the NFS Server Remotely</a></p>
<p class="toc level4"><a href="rfsadmin-215.html#rfsadmin-231">How to Verify the NFS Service on the Server</a></p>
<p class="toc level4"><a href="rfsadmin-215.html#rfsadmin-240">How to Restart NFS Services</a></p>
<p class="toc level4"><a href="rfsadmin-215.html#rfsadmin-243">How to Warm-Start <tt>rpcbind</tt></a></p>
<p class="toc level4"><a href="rfsadmin-215.html#rfsadmin-251">How to Verify Options Used With the <tt>mount</tt> Command</a></p>
<p class="toc level3 tocsp"><a href="rfsadmin-210.html">Troubleshooting Autofs</a></p>
<p class="toc level3"><a href="rfsadmin-255.html">NFS Error Messages</a></p>
<p class="toc level2 tocsp"><a href="rfsrefer-1.html">6.&nbsp;&nbsp;Accessing Network File Systems (Reference)</a></p>
<p class="toc level1 tocsp"><a href="slptm.html">Part&nbsp;III&nbsp;SLP Topics</a></p>
<p class="toc level2"><a href="slparch-16.html">7.&nbsp;&nbsp;SLP (Overview)</a></p>
<p class="toc level2"><a href="slp.setup-10.html">8.&nbsp;&nbsp;Planning and Enabling SLP (Tasks)</a></p>
<p class="toc level2"><a href="ch.configuration-6.html">9.&nbsp;&nbsp;Administering SLP (Tasks)</a></p>
<p class="toc level2"><a href="legacy-7.html">10.&nbsp;&nbsp;Incorporating Legacy Services</a></p>
<p class="toc level2"><a href="slpreference.html">11.&nbsp;&nbsp;SLP (Reference)</a></p>
<p class="toc level1 tocsp"><a href="mailtm-1.html">Part&nbsp;IV&nbsp;Mail Services Topics</a></p>
<p class="toc level2"><a href="mailintro-1.html">12.&nbsp;&nbsp;Mail Services (Overview)</a></p>
<p class="toc level2"><a href="mailadmin-1.html">13.&nbsp;&nbsp;Mail Services (Tasks)</a></p>
<p class="toc level2"><a href="mailrefer-1.html">14.&nbsp;&nbsp;Mail Services (Reference)</a></p>
<p class="toc level1 tocsp"><a href="modemtm-1.html">Part&nbsp;V&nbsp;Serial Networking Topics</a></p>
<p class="toc level2"><a href="pppsvrconfig.intro-1.html">15.&nbsp;&nbsp;Solaris PPP 4.0 (Overview)</a></p>
<p class="toc level2"><a href="pppsvrconfig.p2plink-1.html">16.&nbsp;&nbsp;Planning for the PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.dialin-1.html">17.&nbsp;&nbsp;Setting Up a Dial-up PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.leased-1.html">18.&nbsp;&nbsp;Setting Up a Leased-Line PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.auth-1.html">19.&nbsp;&nbsp;Setting Up PPP Authentication (Tasks)</a></p>
<p class="toc level2"><a href="ppp.pppoe-1.html">20.&nbsp;&nbsp;Setting Up a PPPoE Tunnel (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.troubleshoot-1.html">21.&nbsp;&nbsp;Fixing Common PPP Problems (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.reference-1.html">22.&nbsp;&nbsp;Solaris PPP 4.0 (Reference)</a></p>
<p class="toc level2"><a href="pppsvrconfig.convert.app-1.html">23.&nbsp;&nbsp;Migrating From Asynchronous Solaris PPP to Solaris PPP 4.0 (Tasks)</a></p>
<p class="toc level2"><a href="uucpov-1.html">24.&nbsp;&nbsp;UUCP (Overview)</a></p>
<p class="toc level2"><a href="uucptasks-1.html">25.&nbsp;&nbsp;Administering UUCP (Tasks)</a></p>
<p class="toc level2"><a href="uucpref-1.html">26.&nbsp;&nbsp;UUCP (Reference)</a></p>
<p class="toc level1 tocsp"><a href="wwrstm.html">Part&nbsp;VI&nbsp;Working With Remote Systems Topics</a></p>
<p class="toc level2"><a href="wwrsov.html">27.&nbsp;&nbsp;Working With Remote Systems (Overview)</a></p>
<p class="toc level2"><a href="wuftp-17.html">28.&nbsp;&nbsp;Administering the FTP Server (Tasks)</a></p>
<p class="toc level2"><a href="remotehowtoaccess-99941.html">29.&nbsp;&nbsp;Accessing Remote Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="netmonitortm-1.html">Part&nbsp;VII&nbsp;Monitoring Network Services Topics</a></p>
<p class="toc level2"><a href="netmonitor-1.html">30.&nbsp;&nbsp;Monitoring Network Performance (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="rfsadmin-56"></a><h3>Automatic File-System Sharing</h3>
<p><a name="indexterm-161"></a><a name="indexterm-162"></a><a name="indexterm-163"></a><a name="indexterm-164"></a>Servers provide access to their file systems by sharing the file systems over
the NFS environment. Note the following:</p>
<ul><li><p>Previously, you would specify which file systems are to be shared with the <tt>share</tt> command or with the <tt>/etc/dfs/dfstab</tt> file.</p><p>Entries in the <tt>/etc/dfs/dfstab</tt> file are shared automatically whenever you start NFS server operation. You should set up automatic sharing if you need to share the same set of file systems on a regular basis. For example, if your computer is a server that supports home directories, you need to make the home directories available at all times. Most file-system sharing should be done automatically. The only time that manual sharing should occur is during testing or troubleshooting.</p><p>The <tt>dfstab</tt> file lists all the file systems that your server shares with its clients. This file also controls which clients can mount a file system. You can modify <tt>dfstab</tt> to add or delete a file system or change the way sharing occurs. Just edit the file with any text editor that is supported (such as <tt>vi</tt>). The next time that the computer enters run level 3, the system reads the updated <tt>dfstab</tt> to determine which file systems should be shared automatically.</p><p><a name="indexterm-165"></a>Each line in the <tt>dfstab</tt> file consists of a <tt>share</tt> command, the same command that you type at the command-line prompt to share the file system. The <tt>share</tt> command is located in <tt>/usr/sbin</tt>.</p></li>
<li><p>Starting in the Solaris Express, Developer Edition 2/07 release, you can use the <tt>sharemgr</tt> and <tt>sharectl</tt> utilities to manage file systems and file-sharing protocols. For more information, see the following:</p>
<ul><li><p><tt>sharemgr</tt>(1M) man page and <a href="rfsrefer-13.html#gcrvu"><tt>sharemgr</tt> Command</a></p></li>
<li><p><tt>sharectl</tt>(1M) man page and <a href="rfsrefer-13.html#gecpc"><tt>sharectl</tt> Command</a></p></li></ul>

<hr><p><b>Note - </b>When you use <tt>sharemgr</tt>, you do not need to use the <tt>share</tt>, <tt>shareall</tt>, and <tt>unshare</tt> commands. Also, you do not need to edit the <tt>/etc/dfs/dfstab</tt> file.</p>
<hr>
</li></ul>
<a name="rfsadmin-tbl-166"></a><h6>Table&nbsp;5-1 File-System Sharing Task Map</h6><table><col width="110*"><col width="167*"><col width="119*"><tr><th align="left" valign="top" scope="column"><p>Task</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>For Instructions</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Establish automatic file-system sharing</p></td>
<td align="left" valign="top" scope="row"><p>Steps to configure a server so that file
systems are automatically shared when the server is rebooted</p>
<hr><p><b>Note - </b>The procedure shows you how
to use the <tt>sharemgr</tt> command. The example that follows the procedure uses
the <tt>share</tt> and <tt>shareall</tt> commands to complete the same task.</p>
<hr>
</td>
<td align="left" valign="top" scope="row"><p><a href="#rfsadmin-57">How to Set Up Automatic File-System Sharing</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Enable WebNFS</p></td>
<td align="left" valign="top" scope="row"><p>Steps to
configure a server so that users can access files by using WebNFS</p>
<hr><p><b>Note - </b>The procedure shows
you how to use the <tt>sharemgr</tt> command. The example that follows the procedure
uses the <tt>share</tt> and <tt>shareall</tt> commands to complete the same task.</p>
<hr>
</td>
<td align="left" valign="top" scope="row"><p><a href="#rfsadmin-112">How to Enable WebNFS Access</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Enable NFS
server logging</p></td>
<td align="left" valign="top" scope="row"><p>Steps to configure a server so that NFS logging is run
on selected file systems</p>
<hr><p><b>Note - </b>The procedure shows you how to use the <tt>sharemgr</tt> command. The example
that follows the procedure uses the <tt>share</tt> and <tt>shareall</tt> commands to complete
the same task.</p>
<hr>
</td>
<td align="left" valign="top" scope="row"><p><a href="#rfsadmin-101">How to Enable NFS Server Logging</a></p></td>
</tr>
</table>

<a name="rfsadmin-57"></a><h4>How to Set Up Automatic File-System Sharing</h4><p>Starting with the Solaris Express, Developer Edition 2/07 release, you can do the
following:</p>
<ul><li><p>Use the <tt>sharemgr</tt> utility to share file systems, set property values for the shared file systems, and perform related tasks. For information about <tt>sharemgr</tt>, including descriptions of subcommands and properties, see the <tt>sharemgr</tt>(1M) man page and <a href="rfsrefer-13.html#gcrvu"><tt>sharemgr</tt> Command</a>.</p></li>
<li><p>Use the <tt>sharectl</tt> utility to configure file-sharing protocols, such as NFS. See the <tt>sharectl</tt>(1M) man page and <a href="rfsrefer-13.html#gecpc"><tt>sharectl</tt> Command</a>.</p></li></ul>

<hr><p><b>Note - </b>When you use <tt>sharemgr</tt>, you do not need to use the <tt>share</tt>, <tt>shareall</tt>,
 and <tt>unshare</tt> commands. Also, you do not need to edit the <tt>/etc/dfs/dfstab</tt>
file.</p>
<hr>
<p>The following procedure uses the <tt>sharemgr</tt> utility. If you prefer to use the
<tt>share</tt> and <tt>shareall</tt> utilities, see the example that follows this procedure. Note that
whether you use <tt>sharemgr</tt> or <tt>share</tt> and <tt>shareall</tt>, you must set up your
autofs maps so that clients can access the file systems that you have
shared on the server.</p><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.
To configure a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="rfsadmin-step-59"></a><b>Use the <tt>sharemgr</tt> utility to assign property values to the file system to
be shared.</b><ol style="list-style-type: lower-alpha">
				 
<li><b>Use the following syntax to create a share group with the desired property
value.</b><pre># sharemgr create [-P protocol] [-p property=value] share-group</pre></li>
<li><b>Use the following syntax to add shares to the share group.</b><pre># sharemgr add-share -s share-path [-t] [-d description] [-r resource-name] share-group</pre></li>
<li>(Optional) <b>If necessary, use the following syntax to set more property values to an
existing share group.</b><pre># sharemgr set [-P protocol] [-S security-mode] [-p property=value] share-group</pre>
<hr><p><b>Note - </b>You do not need to repeat this command-line syntax for each additional property
value. You can use the <tt>-p</tt> option multiple times to define multiple properties
on the same command line.</p>
<hr>
</li></ol></li>
<li><a name="rfsadmin-step-1209"></a><b>Use the <tt>sharemgr</tt> utility to verify what you have created by using the
    following syntax.</b><pre># sharemgr show [-v] [-p] [-x] [share-group...]</pre></li></ol><a name="gecqk"></a>Example&nbsp;5-1 How to Use the <tt>share</tt> and <tt>shareall</tt> Commands to Set Up Automatic File-System Sharing
<ol><li><p>Become superuser or assume an equivalent role.</p><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>. To configure a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><p>Add entries for each file system to be shared.</p><p><a name="indexterm-166"></a><a name="indexterm-167"></a><a name="indexterm-168"></a>Edit <tt>/etc/dfs/dfstab</tt>. Add one entry to the file for every file system that you want to be automatically shared. Each entry must be on a line by itself in the file and use this syntax:</p><pre>share [-F nfs] [-o specific-options] [-d description] pathname</pre><p>See the <a href="http://docs.sun.com/doc/819-2251/dfstab-4?a=view"><tt>dfstab</tt>(4)</a> man page for a description of <tt>/etc/dfs/dfstab</tt> and the <a href="http://docs.sun.com/doc/819-2240/share-nfs-1m?a=view"><tt>share_nfs</tt>(1M)</a> man page for a complete list of options.</p></li>
<li><p>Share the file system.</p><p><a name="indexterm-169"></a><a name="indexterm-170"></a>After the entry is in <tt>/etc/dfs/dfstab</tt>, you can share the file system by either rebooting the system or by using the <tt>shareall</tt> command.</p><pre># <tt><b>shareall</b></tt></pre></li>
<li><p>Verify that the information is correct.</p><p>Run the <tt>share</tt> command to check that the correct options are listed:</p><pre># <tt><b>share</b></tt>
-        /export/share/man   ro   ""
-        /usr/src     rw=eng   ""
-        /export/ftp    ro,public  ""</pre></li></ol>
<h6>See Also</h6><p>Whether you use <tt>sharemgr</tt> or <tt>share</tt> and <tt>shareall</tt>, the next step is
to set up your autofs maps so that clients can access the file
systems that you have shared on the server. See <a href="rfsadmin-127.html">Task Overview for Autofs Administration</a>.</p>

<a name="rfsadmin-112"></a><h4>How to Enable WebNFS Access</h4><a name="indexterm-171"></a><a name="indexterm-172"></a><p>Note the following:</p>
<ul><li><p>Starting with the Solaris 2.6 release, by default all file systems that are available for NFS mounting are automatically available for WebNFS access. The only condition that requires the use of this procedure is one of the following:</p>
<ul><li><p>To allow NFS mounting on a server that does not currently allow NFS mounting</p></li>
<li><p>To reset the public file handle to shorten NFS URLs by using the <tt>public</tt> option with the <tt>share</tt> command</p></li>
<li><p>To force a specific HTML file to be loaded by using the <tt>index</tt> option with the <tt>share</tt> command</p></li></ul>
</li>
<li><p>Starting with the Solaris Express, Developer Edition 2/07 release, you can do the following:</p>
<ul><li><p>Use the <tt>sharemgr</tt> utility to share file systems, set property values for the shared file systems, and perform related tasks. For information about <tt>sharemgr</tt>, including descriptions of subcommands and properties, see the <tt>sharemgr</tt>(1M) man page and <a href="rfsrefer-13.html#gcrvu"><tt>sharemgr</tt> Command</a>.</p></li>
<li><p>Use the <tt>sharectl</tt> utility to configure file-sharing protocols, such as NFS. See the <tt>sharectl</tt>(1M) man page and <a href="rfsrefer-13.html#gecpc"><tt>sharectl</tt> Command</a>.</p></li></ul>

<hr><p><b>Note - </b>When you use <tt>sharemgr</tt>, you do not need to use the <tt>share</tt>, <tt>shareall</tt>, and <tt>unshare</tt> commands. Also, you do not need to edit the <tt>/etc/dfs/dfstab</tt> file.</p>
<hr>
</li></ul>
<p>See <a href="rfsadmin-110.html#rfsadmin-111">Planning for WebNFS Access</a> for a list of issues to consider before starting the WebNFS
service.</p><p>The following procedure uses the <tt>sharemgr</tt> utility. If you prefer to use the
<tt>share</tt> and <tt>shareall</tt> utilities, see the example that follows this procedure.</p><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.
To configure a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="rfsadmin-step-114"></a><b>Use the <tt>sharemgr</tt> utility to assign property values to the file system to
be shared by the WebNFS service.</b><ol style="list-style-type: lower-alpha">
				 
<li><b>Use the following syntax to create a share group with the desired property
value.</b><pre># sharemgr create [-P protocol] [-p property=value] share-group</pre><p>For example:</p>
<ul><li><p>To create a share group that forces a specific HTML file to be loaded, you can use the index property:</p><pre># sharemgr create [-P protocol] -p index=[file-path.html] share-group</pre></li>
<li><p>To create a share group that moves the location of the public file handle from <tt>root</tt> (<tt>/</tt>) to an exported directory for WebNFS-enabled browsers and clients, you can use the following:</p><pre># sharemgr set -P nfs -p public=true -s share-path share-group</pre><p>Note that the <tt>public</tt> property moves the location of a public file handle from <tt>root</tt> (<tt>/</tt>) to an exported directory for WebNFS-enabled browsers and clients. However, only one file system (or share) on each server can use this property. Because a share-group can consist of more than one file system, this property is not accepted by a share group. For more information, see the <a href="http://docs.sun.com/doc/819-2240/share-nfs-1m?a=view"><tt>share_nfs</tt>(1M)</a> man page.</p></li></ul>
</li>
<li><b>Use the following syntax to add shares to the share group.</b><pre># sharemgr add-share -s share-path [-t] [-d description] [-r resource-name] share-group</pre></li>
<li>(Optional) <b>If necessary, use the following syntax to set more property values to an
existing share group.</b><pre># sharemgr set [-P protocol] [-S security-mode] [-p property=value] share-group</pre>
<hr><p><b>Note - </b>You do not need to repeat this command-line syntax for each additional property
value. You can use the <tt>-p</tt> option multiple times to define multiple properties
on the same command line.</p>
<hr>
</li></ol></li>
<li><a name="rfsadmin-step-116"></a><b>Use the <tt>sharemgr</tt> utility to verify what you have created.</b><pre># sharemgr show [-v] [-p] [-x] [share-group...]</pre></li></ol><a name="gedgg"></a>Example&nbsp;5-2 How to Use the <tt>share</tt> and <tt>shareall</tt> Commands to Enable WebNFS Access
<ol><li><p>Become superuser or assume an equivalent role.</p><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>. To configure a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><p>Add entries for each file system to be shared by using the WebNFS service.</p><p><a name="indexterm-173"></a><a name="indexterm-174"></a><a name="indexterm-175"></a><a name="indexterm-176"></a>Edit <tt>/etc/dfs/dfstab</tt>. Add one entry to the file for every file system. The <tt>public</tt> and <tt>index</tt> tags that are shown in the following example are optional. </p><pre>share -F nfs -o ro,public,index=index.html /export/ftp</pre><p>See the <a href="http://docs.sun.com/doc/819-2251/dfstab-4?a=view"><tt>dfstab</tt>(4)</a> man page for a description of <tt>/etc/dfs/dfstab</tt> and the <a href="http://docs.sun.com/doc/819-2240/share-nfs-1m?a=view"><tt>share_nfs</tt>(1M)</a> man page for a complete list of options.</p></li>
<li><p>Share the file system.</p><p><a name="indexterm-177"></a><a name="indexterm-178"></a>After the entry is in <tt>/etc/dfs/dfstab</tt>, you can share the file system by either rebooting the system or by using the <tt>shareall</tt> command.</p><pre># <tt><b>shareall</b></tt></pre></li>
<li><p>Verify that the information is correct.</p><p>Run the <tt>share</tt> command to check that the correct options are listed:</p><pre># <tt><b>share</b></tt>
-        /export/share/man   ro   ""
-        /usr/src     rw=eng   ""
-        /export/ftp    ro,public,index=index.html  ""</pre></li></ol>


<a name="rfsadmin-101"></a><h4>How to Enable NFS Server Logging</h4><a name="indexterm-179"></a><a name="indexterm-180"></a><p>Starting with the Solaris Express, Developer Edition 2/07 release, you can do the
following:</p>
<ul><li><p>Use the <tt>sharemgr</tt> utility to share file systems, set property values for the shared file systems, and perform related tasks. For information about <tt>sharemgr</tt>, including descriptions of subcommands and properties, see the <tt>sharemgr</tt>(1M) man page and <a href="rfsrefer-13.html#gcrvu"><tt>sharemgr</tt> Command</a>.</p></li>
<li><p>Use the <tt>sharectl</tt> utility to configure file-sharing protocols, such as NFS. See the <tt>sharectl</tt>(1M) man page and <a href="rfsrefer-13.html#gecpc"><tt>sharectl</tt> Command</a>.</p></li></ul>

<hr><p><b>Note - </b>When you use <tt>sharemgr</tt>, you do not need to use the <tt>share</tt>, <tt>shareall</tt>,
 and <tt>unshare</tt> commands. Also, you do not need to edit the <tt>/etc/dfs/dfstab</tt>
file.</p>
<hr>
<p>The following procedure uses the <tt>sharemgr</tt> utility. If you prefer to use the
<tt>share</tt> and <tt>shareall</tt> utilities, see the example that follows this procedure.</p><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.
To configure a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="rfsadmin-step-264"></a>(Optional) <b>Change file-system configuration settings.</b><p>In <tt>/etc/nfs/nfslog.conf</tt>, you can change the settings in one of two ways. You
can edit the default settings for all file systems by changing the data
that is associated with the <tt>global</tt> tag. Alternately, you can add a
new tag for this file system. If these changes are not needed, you
do not need to change this file. The format of <tt>/etc/nfs/nfslog.conf</tt> is described
in the <a href="http://docs.sun.com/doc/819-2251/nfslog.conf-4?a=view"><tt>nfslog.conf</tt>(4)</a> man page. </p></li>
<li><a name="rfsadmin-step-65"></a><b>Use the <tt>sharemgr</tt> utility to assign property values to the file system to
be     shared by using NFS server logging.</b><ol style="list-style-type: lower-alpha">
				 
<li><b>Use the following syntax to create a share group with the desired property
value.</b><pre># sharemgr create [-P protocol] [-p property=value] share-group</pre><p>For example:</p><pre># <tt><b>sharemgr create -p log=global my-group</b></tt></pre><p>This example uses the default settings associated with the global tag. Note that
the tag assigned to the log property must also exist in the
<tt>/etc/nfs/nfslog.conf</tt> file.</p></li>
<li><b>Use the following syntax to add shares to the share group.</b><pre># sharemgr add-share -s share-path [-t] [-d description] [-r resource-name] share-group</pre></li>
<li>(Optional) <b>If necessary, use the following syntax to set more property values to an
existing share group.</b><pre># sharemgr set [-P protocol] [-S security-mode] [-p property=value] share-group</pre><p>For example:</p><pre># <tt><b>sharemgr set -p ro=true my-group</b></tt></pre><p>In this example the permissions for <tt>my-group</tt> are set to read-only.</p>
<hr><p><b>Note - </b>You do not need to repeat this command-line syntax for each additional property
value. You can use the <tt>-p</tt> option multiple times to define multiple properties
on the same command line.</p>
<hr>
</li></ol></li>
<li><a name="rfsadmin-step-67"></a><b>Use the following syntax to verify what you have created.</b><pre># sharemgr show [-v] [-p] [-x] [share-group...]</pre></li>
<li><a name="rfsadmin-step-68"></a><b>Check if <tt>nfslogd</tt>, the NFS log daemon, is running.</b><pre># <tt><b>ps -ef | grep nfslogd</b></tt></pre></li>
<li>(Optional) <b>Start <tt>nfslogd</tt>, if it is not running.</b><pre># <tt><b>svcadm restart network/nfs/server:default</b></tt></pre></li></ol><a name="gecrn"></a>Example&nbsp;5-3 How to Use the <tt>share</tt> and <tt>shareall</tt> Commands to Enable NFS Server Logging
<ol><li><p>Become superuser or assume an equivalent role.</p><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>. To configure a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><p>(Optional) Change file-system configuration settings.</p><p><a name="indexterm-181"></a><a name="indexterm-182"></a>In <tt>/etc/nfs/nfslog.conf</tt>, you can change the settings in one of two ways. You can edit the default settings for all file systems by changing the data that is associated with the <tt>global</tt> tag. Alternately, you can add a new tag for this file system. If these changes are not needed, you do not need to change this file. The format of <tt>/etc/nfs/nfslog.conf</tt> is described in <a href="http://docs.sun.com/doc/819-2251/nfslog.conf-4?a=view"><tt>nfslog.conf</tt>(4)</a>. </p></li>
<li><p>Add entries for each file system to be shared by using NFS server logging.</p><p><a name="indexterm-183"></a><a name="indexterm-184"></a><a name="indexterm-185"></a>Edit <tt>/etc/dfs/dfstab</tt>. Add one entry to the file for the file system on which you are enabling NFS server logging. The tag that is used with the <tt>log=</tt><i>tag</i> option must be entered in <tt>/etc/nfs/nfslog.conf</tt>. This example uses the default settings in the <tt>global</tt> tag.</p><pre>share -F nfs -o ro,log=global /export/ftp</pre><p>See the <a href="http://docs.sun.com/doc/819-2251/dfstab-4?a=view"><tt>dfstab</tt>(4)</a> man page for a description of <tt>/etc/dfs/dfstab</tt> and the <a href="http://docs.sun.com/doc/819-2240/share-nfs-1m?a=view"><tt>share_nfs</tt>(1M)</a> man page for a complete list of options.</p></li>
<li><p>Share the file system.</p><p>After the entry is in <tt>/etc/dfs/dfstab</tt>, you can share the file system by either rebooting the system or by using the <tt>shareall</tt> command.</p><pre># <tt><b>shareall</b></tt></pre></li>
<li><p>Verify that the information is correct.</p><p><a name="indexterm-186"></a><a name="indexterm-187"></a>Run the <tt>share</tt> command to check that the correct options are listed:</p><pre># <tt><b>share</b></tt>
-        /export/share/man   ro   ""
-        /usr/src     rw=eng   ""
-        /export/ftp    ro,log=global  ""</pre></li>
<li><p>Check if <tt>nfslogd</tt>, the NFS log daemon, is running.</p><pre># <tt><b>ps -ef | grep nfslogd</b></tt></pre></li>
<li><p><a name="indexterm-188"></a>(Optional) Start <tt>nfslogd</tt>, if it is not running already.</p>
<ul><li><p>(Optional) If <tt>/etc/nfs/nfslogtab</tt> is present, start the NFS log daemon by typing the following:</p><pre># <tt><b>svcadm restart network/nfs/server:default</b></tt></pre></li>
<li><p>(Optional) If <tt>/etc/nfs/nfslogtab</tt> is not present, run any of the <tt>share</tt> commands to create the file and then start the daemon.</p><pre># <tt><b>shareall</b></tt>
# <tt><b>svcadm restart network/nfs/server:default</b></tt></pre></li></ul>
</li></ol>

         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="rfsadmin-8.html">Previous</a>
             </td>
             <td align="right">
                 <a href="rfsadmin-61.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

