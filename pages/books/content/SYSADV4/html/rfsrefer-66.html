<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Autofs Maps - System Administration Guide: Network Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: Network Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="rfsrefer-45.html">Previous</a>
             </td>
             <td align="right">
                 <a href="rfsrefer-75.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="netservices-1.html">Part&nbsp;I&nbsp;Network Services Topics</a></p>
<p class="toc level2"><a href="nsov-1.html">1.&nbsp;&nbsp;Network Service (Overview)</a></p>
<p class="toc level2"><a href="nca-1.html">2.&nbsp;&nbsp;Managing Web Cache Servers</a></p>
<p class="toc level2"><a href="time-1.html">3.&nbsp;&nbsp;Time-Related Services</a></p>
<p class="toc level1 tocsp"><a href="rfstm-1.html">Part&nbsp;II&nbsp;Accessing Network File Systems Topics</a></p>
<p class="toc level2"><a href="rfsintro-2.html">4.&nbsp;&nbsp;Managing Network File Systems (Overview)</a></p>
<p class="toc level2"><a href="rfsadmin-8.html">5.&nbsp;&nbsp;Network File System Administration (Tasks)</a></p>
<p class="toc level2"><a href="rfsrefer-1.html">6.&nbsp;&nbsp;Accessing Network File Systems (Reference)</a></p>
<p class="toc level3"><a href="rfsrefer-6.html">NFS Files</a></p>
<p class="toc level3"><a href="rfsrefer-8.html">NFS Daemons</a></p>
<p class="toc level3"><a href="rfsrefer-13.html">NFS Commands</a></p>
<p class="toc level3"><a href="rfsrefer-37.html">Commands for Troubleshooting NFS Problems</a></p>
<p class="toc level3"><a href="rfsrefer-154.html">NFS Over RDMA</a></p>
<p class="toc level3"><a href="rfsrefer-45.html">How the NFS Service Works</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Autofs Maps</a></p>
</div>
<p class="toc level3"><a href="rfsrefer-75.html">How Autofs Works</a></p>
<p class="toc level3"><a href="rfsrefer-98.html">Autofs Reference</a></p>
<p class="toc level1 tocsp"><a href="slptm.html">Part&nbsp;III&nbsp;SLP Topics</a></p>
<p class="toc level2"><a href="slparch-16.html">7.&nbsp;&nbsp;SLP (Overview)</a></p>
<p class="toc level2"><a href="slp.setup-10.html">8.&nbsp;&nbsp;Planning and Enabling SLP (Tasks)</a></p>
<p class="toc level2"><a href="ch.configuration-6.html">9.&nbsp;&nbsp;Administering SLP (Tasks)</a></p>
<p class="toc level2"><a href="legacy-7.html">10.&nbsp;&nbsp;Incorporating Legacy Services</a></p>
<p class="toc level2"><a href="slpreference.html">11.&nbsp;&nbsp;SLP (Reference)</a></p>
<p class="toc level1 tocsp"><a href="mailtm-1.html">Part&nbsp;IV&nbsp;Mail Services Topics</a></p>
<p class="toc level2"><a href="mailintro-1.html">12.&nbsp;&nbsp;Mail Services (Overview)</a></p>
<p class="toc level2"><a href="mailadmin-1.html">13.&nbsp;&nbsp;Mail Services (Tasks)</a></p>
<p class="toc level2"><a href="mailrefer-1.html">14.&nbsp;&nbsp;Mail Services (Reference)</a></p>
<p class="toc level1 tocsp"><a href="modemtm-1.html">Part&nbsp;V&nbsp;Serial Networking Topics</a></p>
<p class="toc level2"><a href="pppsvrconfig.intro-1.html">15.&nbsp;&nbsp;Solaris PPP 4.0 (Overview)</a></p>
<p class="toc level2"><a href="pppsvrconfig.p2plink-1.html">16.&nbsp;&nbsp;Planning for the PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.dialin-1.html">17.&nbsp;&nbsp;Setting Up a Dial-up PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.leased-1.html">18.&nbsp;&nbsp;Setting Up a Leased-Line PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.auth-1.html">19.&nbsp;&nbsp;Setting Up PPP Authentication (Tasks)</a></p>
<p class="toc level2"><a href="ppp.pppoe-1.html">20.&nbsp;&nbsp;Setting Up a PPPoE Tunnel (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.troubleshoot-1.html">21.&nbsp;&nbsp;Fixing Common PPP Problems (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.reference-1.html">22.&nbsp;&nbsp;Solaris PPP 4.0 (Reference)</a></p>
<p class="toc level2"><a href="pppsvrconfig.convert.app-1.html">23.&nbsp;&nbsp;Migrating From Asynchronous Solaris PPP to Solaris PPP 4.0 (Tasks)</a></p>
<p class="toc level2"><a href="uucpov-1.html">24.&nbsp;&nbsp;UUCP (Overview)</a></p>
<p class="toc level2"><a href="uucptasks-1.html">25.&nbsp;&nbsp;Administering UUCP (Tasks)</a></p>
<p class="toc level2"><a href="uucpref-1.html">26.&nbsp;&nbsp;UUCP (Reference)</a></p>
<p class="toc level1 tocsp"><a href="wwrstm.html">Part&nbsp;VI&nbsp;Working With Remote Systems Topics</a></p>
<p class="toc level2"><a href="wwrsov.html">27.&nbsp;&nbsp;Working With Remote Systems (Overview)</a></p>
<p class="toc level2"><a href="wuftp-17.html">28.&nbsp;&nbsp;Administering the FTP Server (Tasks)</a></p>
<p class="toc level2"><a href="remotehowtoaccess-99941.html">29.&nbsp;&nbsp;Accessing Remote Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="netmonitortm-1.html">Part&nbsp;VII&nbsp;Monitoring Network Services Topics</a></p>
<p class="toc level2"><a href="netmonitor-1.html">30.&nbsp;&nbsp;Monitoring Network Performance (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="rfsrefer-66"></a><h3>Autofs Maps</h3>
<p>Autofs uses three types of maps:</p>
<ul><li><p>Master map</p></li>
<li><p>Direct maps </p></li>
<li><p>Indirect maps</p></li></ul>


<a name="rfsrefer-67"></a><h4>Master Autofs Map</h4>
<p><a name="indexterm-780"></a><a name="indexterm-781"></a><a name="indexterm-782"></a><a name="indexterm-783"></a><a name="indexterm-784"></a><a name="indexterm-785"></a><a name="indexterm-786"></a><a name="indexterm-787"></a><a name="indexterm-788"></a><a name="indexterm-789"></a>The <tt>auto_master</tt> map associates a directory with a map. The map is a
master list that specifies all the maps that autofs should check. The following
example shows what an <tt>auto_master</tt> file could contain. </p><a name="rfsrefer-ex-68"></a>Example&nbsp;6-3 Sample <tt>/etc/auto_master</tt> File<pre># Master map for automounter 
# 
+auto_master 
/net            -hosts           -nosuid,nobrowse 
/home           auto_home        -nobrowse 
/-              auto_direct     -ro  </pre><p><a name="indexterm-790"></a>This example shows the generic <tt>auto_master</tt> file with one addition for the <tt>auto_direct</tt>
map. Each line in the master map <tt>/etc/auto_master</tt> has the following syntax: </p><p><i>mount-point map-name</i> <tt>[</tt> <i>mount-options</i> <tt>]</tt></p><dl><dt><i>mount-point</i></dt>
<dd><p><a name="indexterm-791"></a><a name="indexterm-792"></a><a name="indexterm-793"></a><a name="indexterm-794"></a><i>mount-point</i> is the full (absolute) path name of a directory. If the directory does not exist, autofs creates the directory if possible. If the directory exists and is not empty, mounting on the directory hides its contents. In this situation, autofs issues a warning.</p><p>The notation <tt>/-</tt> as a mount point indicates that this particular map is a direct map. The notation also means that no particular mount point is associated with the map. </p></dd>
<dt><i>map-name</i></dt>
<dd><p><a name="indexterm-795"></a><a name="indexterm-796"></a><i>map-name</i> is the map autofs uses to find directions to locations, or mount information. If the name is preceded by a slash (/), autofs interprets the name as a local file. Otherwise, autofs searches for the mount information by using the search that is specified in the name-service switch configuration file (<tt>/etc/nsswitch.conf</tt>). Special maps are also used for <tt>/net</tt>. See <a href="#rfsrefer-70">Mount Point <tt>/net</tt></a> for more information. </p></dd>
<dt><i>mount-options</i></dt>
<dd><p><i>mount-options</i> is an optional, comma-separated list of options that apply to the mounting of the entries that are specified in map-name, unless the entries in map-name list other options. Options for each specific type of file system are listed in the mount man page for that file system. For example, see the <a href="http://docs.sun.com/doc/819-2240/mount-nfs-1m?a=view"><tt>mount_nfs</tt>(1M)</a> man page for NFS-specific mount options. For NFS-specific mount points, the <tt>bg</tt> (background) and <tt>fg</tt> (foreground) options do not apply.</p></dd>
</dl>
<p><a name="indexterm-797"></a><a name="indexterm-798"></a><a name="indexterm-799"></a><a name="indexterm-800"></a><a name="indexterm-801"></a><a name="indexterm-802"></a>A line that begins with <tt>#</tt> is a comment. All the text that
follows until the end of the line is ignored.   
  </p><p><a name="indexterm-803"></a><a name="indexterm-804"></a><a name="indexterm-805"></a>To split long lines into shorter ones, put a backslash (<tt>\</tt>) at the
end of the line. The maximum number of characters of an entry
is 1024.   </p>
<hr><p><b>Note - </b>If the same mount point is used in two entries, the first
entry is used by the <tt>automount</tt> command. The second entry is ignored.</p>
<hr>


<a name="rfsrefer-69"></a><h5>Mount Point <tt>/home</tt></h5>
<p><a name="indexterm-806"></a><a name="indexterm-807"></a><a name="indexterm-808"></a>The mount point <tt>/home</tt> is the directory under which the entries that are
listed in <tt>/etc/auto_home</tt> (an indirect map) are to be mounted.   </p>
<hr><p><b>Note - </b><a name="indexterm-809"></a><a name="indexterm-810"></a><a name="indexterm-811"></a>Autofs runs on all computers and supports <tt>/net</tt> and <tt>/home</tt> (automounted home
directories) by default. These defaults can be overridden by entries in the NIS
<tt>auto.master</tt> map or NIS+ <tt>auto_master</tt> table, or by local editing of the <tt>/etc/auto_master</tt>
file.</p>
<hr>


<a name="rfsrefer-70"></a><h5>Mount Point <tt>/net</tt></h5>
<p><a name="indexterm-812"></a><a name="indexterm-813"></a>Autofs mounts under the directory <tt>/net</tt> all the entries in the special map
 <tt>-hosts</tt>. The map is a built-in map that uses only the hosts
database. Suppose that the computer <tt>gumbo</tt> is in the hosts database and it
exports any of its file systems. The following command changes the current directory
to the root directory of the computer <tt>gumbo</tt>.</p><pre>% <tt><b>cd /net/gumbo</b></tt></pre><p>Autofs can mount only the <b>exported</b> file systems of host <tt>gumbo</tt>, that is,
those file systems on a server that are available to network users instead
of those file systems on a local disk. Therefore, all the files and
directories on <tt>gumbo</tt> might not be available through <tt>/net/gumbo</tt>. </p><p>With the <tt>/net</tt> method of access, the server name is in the path
and is location dependent. If you want to move an exported file system
from one server to another, the path might no longer work. Instead, you
should set up an entry in a map specifically for the file
system you want rather than use <tt>/net</tt>. </p>
<hr><p><b>Note - </b><a name="indexterm-814"></a>Autofs checks the server's export list only at mount time. After a server's
file systems are mounted, autofs does not check with the server again until
the server's file systems are automatically unmounted. Therefore, newly exported file systems are
not &ldquo;seen&rdquo; until the file systems on the client are unmounted and then
remounted.</p>
<hr>


<a name="rfsrefer-72"></a><h4>Direct Autofs Maps</h4>
<p><a name="indexterm-815"></a><a name="indexterm-816"></a><a name="indexterm-817"></a>A direct map is an automount point. With a direct map, a
direct association exists between a mount point on the client and a directory
on the server. Direct maps have a full path name and indicate the
relationship explicitly. The following is a typical <tt>/etc/auto_direct</tt> map: </p><pre>/usr/local          -ro \
   /bin                   ivy:/export/local/sun4 \
   /share                 ivy:/export/local/share \
   /src                   ivy:/export/local/src
/usr/man            -ro   oak:/usr/man \
                          rose:/usr/man \
                          willow:/usr/man 
/usr/games          -ro   peach:/usr/games 
/usr/spool/news     -ro   pine:/usr/spool/news \
                          willow:/var/spool/news </pre><p><a name="indexterm-818"></a>Lines in direct maps have the following syntax: </p><p><i>key</i> <tt>[</tt> <i>mount-options</i> <tt>]</tt> <i>location</i></p><dl><dt><i>key</i></dt>
<dd><p><i>key</i> is the path name of the mount point in a direct map. </p></dd>
<dt><i>mount-options</i></dt>
<dd><p><i>mount-options</i> is the options that you want to apply to this particular mount. These options are required only if the options differ from the map default. Options for each specific type of file system are listed in the mount man page for that file system. For example, see the <a href="http://docs.sun.com/doc/819-2240/mount-cachefs-1m?a=view"><tt>mount_cachefs</tt>(1M)</a> man page for CacheFS specific mount options. For information about using CacheFS options with different versions of NFS, see <a href="rfsadmin-127.html#rfsadmin-155">Accessing NFS File Systems Using CacheFS</a>.</p></dd>
<dt><i>location</i></dt>
<dd><p><i>location</i> is the location of the file system. One or more file systems are specified as <i>server</i>:<i>pathname</i> for NFS file systems or :<i>devicename</i> for High Sierra file systems (HSFS). </p>
<hr><p><b>Note - </b>The <i>pathname</i> should not include an automounted mount point. The <i>pathname</i> should be the actual absolute path to the file system. For instance, the location of a home directory should be listed as <i>server</i><tt>:/export/home/</tt><i>username</i>, not as <i>server</i><tt>:/home/</tt><i>username</i>.</p>
<hr>
</dd>
</dl>
<p><a name="indexterm-819"></a><a name="indexterm-820"></a><a name="indexterm-821"></a><a name="indexterm-822"></a><a name="indexterm-823"></a><a name="indexterm-824"></a><a name="indexterm-825"></a><a name="indexterm-826"></a><a name="indexterm-827"></a>As in the master map, a line that begins with <tt>#</tt> is a
comment. All the text that follows until the end of the line
is ignored. Put a backslash at the end of the line to split
long lines into shorter ones. </p><p>Of all the maps, the entries in a direct map most closely
resemble the corresponding entries in <tt>/etc/vfstab</tt>. An entry might appear in <tt>/etc/vfstab</tt> as follows:
</p><pre>dancer:/usr/local - /usr/local/tmp nfs - yes ro </pre><p>The equivalent entry appears in a direct map as follows:  </p><pre>/usr/local/tmp     -ro     dancer:/usr/local</pre>
<hr><p><b>Note - </b>No concatenation of options occurs between the automounter maps. Any options that are
added to an automounter map override all options that are listed in maps
that are searched earlier. For instance, options that are included in the <tt>auto_master</tt>
map would be overridden by corresponding entries in any other map.</p>
<hr>
<p><a name="indexterm-828"></a><a name="indexterm-829"></a><a name="indexterm-830"></a>See <a href="rfsrefer-75.html#rfsrefer-86">How Autofs Selects the Nearest Read-Only Files for Clients (Multiple Locations)</a> for other important features that are associated with this type of
map.   </p>

<a name="rfsrefer-73"></a><h5>Mount Point <tt>/&minus;</tt></h5>
<p><a name="indexterm-831"></a><a name="indexterm-832"></a><a name="indexterm-833"></a><a name="indexterm-834"></a>In <a href="#rfsrefer-ex-68">Example&nbsp;6-3</a>, the mount point <tt>/-</tt> tells autofs not to associate the entries in
<tt>auto_direct</tt> with any specific mount point. Indirect maps use mount points that are
defined in the <tt>auto_master</tt> file. Direct maps use mount points that are specified
in the named map. Remember, in a direct map the key, or mount
point, is a full path name. </p><p>An NIS or NIS+ <tt>auto_master</tt> file can have only one direct map entry
because the mount point must be a unique value in the namespace. An
<tt>auto_master</tt> file that is a local file can have any number of direct
map entries if entries are not duplicated.</p>

<a name="rfsrefer-74"></a><h4>Indirect Autofs Maps</h4>
<p><a name="indexterm-835"></a><a name="indexterm-836"></a><a name="indexterm-837"></a>An indirect map uses a substitution value of a key to establish the
association between a mount point on the client and a directory on
the server. Indirect maps are useful for accessing specific file systems, such as home
directories. The <tt>auto_home</tt> map is an example of an indirect map. </p><p><a name="indexterm-838"></a>Lines in indirect maps have the following general syntax: </p><p><i>key</i> <tt>[</tt> <i>mount-options</i> <tt>]</tt> <i>location</i></p><dl><dt><i>key</i></dt>
<dd><p><i>key</i> is a simple name without slashes in an indirect map.</p></dd>
<dt><i>mount-options</i></dt>
<dd><p><i>mount-options</i> is the options that you want to apply to this particular mount. These options are required only if the options differ from the map default. Options for each specific type of file system are listed in the mount man page for that file system. For example, see the <a href="http://docs.sun.com/doc/819-2240/mount-nfs-1m?a=view"><tt>mount_nfs</tt>(1M)</a> man page for NFS-specific mount options. </p></dd>
<dt><i>location</i></dt>
<dd><p><i>location</i> is the location of the file system. One or more file systems are specified as <i>server</i>:<i>pathname</i>. </p>
<hr><p><b>Note - </b>The <i>pathname</i> should not include an automounted mount point. The <i>pathname</i> should be the actual absolute path to the file system. For instance, the location of a directory should be listed as <i>server</i><tt>:/usr/local</tt>, not as <i>server</i><tt>:/net/</tt><i>server</i><tt>/usr/local</tt>.</p>
<hr>
</dd>
</dl>
<p><a name="indexterm-839"></a><a name="indexterm-840"></a><a name="indexterm-841"></a><a name="indexterm-842"></a><a name="indexterm-843"></a><a name="indexterm-844"></a><a name="indexterm-845"></a><a name="indexterm-846"></a><a name="indexterm-847"></a><a name="indexterm-848"></a>As in the master map, a line that begins with <tt>#</tt> is a
comment. All the text that follows until the end of the line
is ignored. Put a backslash (<tt>\</tt>) at the end of the line to
split long lines into shorter ones. <a href="#rfsrefer-ex-68">Example&nbsp;6-3</a> shows an <tt>auto_master</tt> map that contains the
following entry:   </p><pre>/home      auto_home        -nobrowse    </pre><p><a name="indexterm-849"></a><tt>auto_home</tt> is the name of the indirect map that contains the entries to
be mounted under <tt>/home</tt>. A typical <tt>auto_home</tt> map might contain the following:
</p><pre>david                  willow:/export/home/david
rob                    cypress:/export/home/rob
gordon                 poplar:/export/home/gordon
rajan                  pine:/export/home/rajan
tammy                  apple:/export/home/tammy
jim                    ivy:/export/home/jim
linda    -rw,nosuid    peach:/export/home/linda</pre><p>As an example, assume that the previous map is on host <tt>oak</tt>. Suppose
that the user <tt>linda</tt> has an entry in the password database that specifies
her home directory as <tt>/home/linda</tt>. Whenever <tt>linda</tt> logs in to computer <tt>oak</tt>, autofs mounts
the directory <tt>/export/home/linda</tt> that resides on the computer <tt>peach</tt>. Her home directory is
mounted read-write, nosuid. </p><p>Assume the following conditions occur: User linda's home directory is listed in the
password database as <tt>/home/linda</tt>. Anybody, including Linda, has access to this path from
any computer that is set up with the master map referring to the
map in the previous example.</p><p>Under these conditions, user linda can run <tt>login</tt> or <tt>rlogin</tt> on any
of these computers and have her home directory mounted in place for her.
</p><p>Furthermore, now Linda can also type the following command:  </p><pre>% <tt><b>cd ~david</b></tt></pre><p>autofs mounts David's home directory for her (if all permissions allow).</p>
<hr><p><b>Note - </b>No concatenation of options occurs between the automounter maps. Any options that are
added to an automounter map override all options that are listed in maps
that are searched earlier. For instance, options that are included in the <tt>auto_master</tt>
map are overridden by corresponding entries in any other map.</p>
<hr>
<p><a name="indexterm-850"></a><a name="indexterm-851"></a><a name="indexterm-852"></a><a name="indexterm-853"></a>On a network without a name service, you have to change all
the relevant files (such as <tt>/etc/passwd</tt>) on all systems on the network to allow
Linda access to her files. With NIS, make the changes on the NIS
master server and propagate the relevant databases to the slave servers. On a
network that is running NIS+, propagating the relevant databases to the slave servers
is done automatically after the changes are made. </p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="rfsrefer-45.html">Previous</a>
             </td>
             <td align="right">
                 <a href="rfsrefer-75.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

