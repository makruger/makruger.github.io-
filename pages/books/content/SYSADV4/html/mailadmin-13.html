<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Setting Up Mail Services - System Administration Guide: Network Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: Network Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="mailadmin-263.html">Previous</a>
             </td>
             <td align="right">
                 <a href="mailadmin-43.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="netservices-1.html">Part&nbsp;I&nbsp;Network Services Topics</a></p>
<p class="toc level2"><a href="nsov-1.html">1.&nbsp;&nbsp;Network Service (Overview)</a></p>
<p class="toc level2"><a href="nca-1.html">2.&nbsp;&nbsp;Managing Web Cache Servers</a></p>
<p class="toc level2"><a href="time-1.html">3.&nbsp;&nbsp;Time-Related Services</a></p>
<p class="toc level1 tocsp"><a href="rfstm-1.html">Part&nbsp;II&nbsp;Accessing Network File Systems Topics</a></p>
<p class="toc level2"><a href="rfsintro-2.html">4.&nbsp;&nbsp;Managing Network File Systems (Overview)</a></p>
<p class="toc level2"><a href="rfsadmin-8.html">5.&nbsp;&nbsp;Network File System Administration (Tasks)</a></p>
<p class="toc level2"><a href="rfsrefer-1.html">6.&nbsp;&nbsp;Accessing Network File Systems (Reference)</a></p>
<p class="toc level1 tocsp"><a href="slptm.html">Part&nbsp;III&nbsp;SLP Topics</a></p>
<p class="toc level2"><a href="slparch-16.html">7.&nbsp;&nbsp;SLP (Overview)</a></p>
<p class="toc level2"><a href="slp.setup-10.html">8.&nbsp;&nbsp;Planning and Enabling SLP (Tasks)</a></p>
<p class="toc level2"><a href="ch.configuration-6.html">9.&nbsp;&nbsp;Administering SLP (Tasks)</a></p>
<p class="toc level2"><a href="legacy-7.html">10.&nbsp;&nbsp;Incorporating Legacy Services</a></p>
<p class="toc level2"><a href="slpreference.html">11.&nbsp;&nbsp;SLP (Reference)</a></p>
<p class="toc level1 tocsp"><a href="mailtm-1.html">Part&nbsp;IV&nbsp;Mail Services Topics</a></p>
<p class="toc level2"><a href="mailintro-1.html">12.&nbsp;&nbsp;Mail Services (Overview)</a></p>
<p class="toc level2"><a href="mailadmin-1.html">13.&nbsp;&nbsp;Mail Services (Tasks)</a></p>
<p class="toc level3"><a href="mailadmin-270.html">Task Map for Mail Services</a></p>
<p class="toc level3"><a href="mailadmin-2.html">Planning Your Mail System</a></p>
<p class="toc level3"><a href="mailadmin-263.html">Setting Up Mail Services (Task Map)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Setting Up Mail Services</a></p>
<p class="toc level4"><a href="#mailadmin-15">How to Set Up a Mail Server</a></p>
<p class="toc level4"><a href="#mailadmin-20">How to Set Up a Mail Client</a></p>
<p class="toc level4"><a href="#mailadmin-29">How to Set Up a Mail Host</a></p>
<p class="toc level4"><a href="#mailadmin-37">How to Set Up a Mail Gateway</a></p>
<p class="toc level4"><a href="#mailadmin-122">How to Use DNS With <tt>sendmail</tt></a></p>
</div>
<p class="toc level3 tocsp"><a href="mailadmin-43.html">Building the <tt>sendmail.cf</tt> Configuration File</a></p>
<p class="toc level4"><a href="mailadmin-43.html#mailadmin-44">How to Build a New <tt>sendmail.cf</tt> File</a></p>
<p class="toc level3 tocsp"><a href="ganav.html">Setting SMTP to Use TLS</a></p>
<p class="toc level4"><a href="ganav.html#fxcty">How to Set SMTP to Use TLS</a></p>
<p class="toc level3 tocsp"><a href="mailadmin-377.html">Managing Mail Delivery by Using an Alternate Configuration</a></p>
<p class="toc level4"><a href="mailadmin-377.html#mailadmin-378">How to Manage Mail Delivery by Using an Alternate Configuration of <tt>sendmail.cf</tt></a></p>
<p class="toc level3 tocsp"><a href="mailadmin-260.html">Administering Mail Alias Files (Task Map)</a></p>
<p class="toc level3"><a href="mailadmin-52.html">Administering Mail Alias Files</a></p>
<p class="toc level4"><a href="mailadmin-52.html#mailadmin-345">How to Initiate an NIS+ <tt>mail_aliases</tt> Table</a></p>
<p class="toc level4"><a href="mailadmin-52.html#mailadmin-327">How to List the Contents of the NIS+ <tt>mail_aliases</tt> Table</a></p>
<p class="toc level4"><a href="mailadmin-52.html#mailadmin-330">How to Add Aliases to the NIS+ <tt>mail_aliases</tt> Table From the Command Line</a></p>
<p class="toc level4"><a href="mailadmin-52.html#mailadmin-331">How to Add Entries by Editing an NIS+ <tt>mail_aliases</tt> Table</a></p>
<p class="toc level4"><a href="mailadmin-52.html#mailadmin-332">How to Edit Entries in an NIS+ <tt>mail_aliases</tt> Table</a></p>
<p class="toc level4"><a href="mailadmin-52.html#mailadmin-93">How to Set Up an NIS <tt>mail.aliases</tt> Map</a></p>
<p class="toc level4"><a href="mailadmin-52.html#mailadmin-106">How to Set Up a Local Mail Alias File</a></p>
<p class="toc level4"><a href="mailadmin-52.html#mailadmin-118">How to Create a Keyed Map File</a></p>
<p class="toc level3 tocsp"><a href="mailadmin-262.html">Administering the Queue Directories (Task Map)</a></p>
<p class="toc level3"><a href="mailadmin-138.html">Administering the Queue Directories</a></p>
<p class="toc level4"><a href="mailadmin-138.html#eyhyo">How to Display the Contents of the Mail Queue, <tt>/var/spool/mqueue</tt></a></p>
<p class="toc level4"><a href="mailadmin-138.html#mailadmin-142">How to Force Mail Queue Processing in the Mail Queue, <tt>/var/spool/mqueue</tt></a></p>
<p class="toc level4"><a href="mailadmin-138.html#mailadmin-145">How to Run a Subset of the Mail Queue, <tt>/var/spool/mqueue</tt></a></p>
<p class="toc level4"><a href="mailadmin-138.html#mailadmin-148">How to Move the Mail Queue, <tt>/var/spool/mqueue</tt></a></p>
<p class="toc level4"><a href="mailadmin-138.html#mailadmin-156">How to Run the Old Mail Queue, <tt>/var/spool/omqueue</tt></a></p>
<p class="toc level3 tocsp"><a href="mailadmin-264.html">Administering <tt>.forward</tt> Files (Task Map)</a></p>
<p class="toc level3"><a href="mailadmin-160.html">Administering <tt>.forward</tt> Files</a></p>
<p class="toc level4"><a href="mailadmin-160.html#mailadmin-161">How to Disable <tt>.forward</tt> Files</a></p>
<p class="toc level4"><a href="mailadmin-160.html#mailadmin-167">How to Change the <tt>.forward</tt>-File Search Path</a></p>
<p class="toc level4"><a href="mailadmin-160.html#mailadmin-173">How to Create and Populate <tt>/etc/shells</tt></a></p>
<p class="toc level3 tocsp"><a href="mailadmin-265.html">Troubleshooting Procedures and Tips for Mail Services (Task Map)</a></p>
<p class="toc level3"><a href="mailadmin-180.html">Troubleshooting Procedures and Tips for Mail Services</a></p>
<p class="toc level4"><a href="mailadmin-180.html#mailadmin-181">How to Test the Mail Configuration</a></p>
<p class="toc level4"><a href="mailadmin-180.html#mailadmin-195">How to Test the <tt>sendmail</tt> Rule Sets</a></p>
<p class="toc level3 tocsp"><a href="mailadmin-219.html">Resolving Error Messages</a></p>
<p class="toc level2 tocsp"><a href="mailrefer-1.html">14.&nbsp;&nbsp;Mail Services (Reference)</a></p>
<p class="toc level1 tocsp"><a href="modemtm-1.html">Part&nbsp;V&nbsp;Serial Networking Topics</a></p>
<p class="toc level2"><a href="pppsvrconfig.intro-1.html">15.&nbsp;&nbsp;Solaris PPP 4.0 (Overview)</a></p>
<p class="toc level2"><a href="pppsvrconfig.p2plink-1.html">16.&nbsp;&nbsp;Planning for the PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.dialin-1.html">17.&nbsp;&nbsp;Setting Up a Dial-up PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.leased-1.html">18.&nbsp;&nbsp;Setting Up a Leased-Line PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.auth-1.html">19.&nbsp;&nbsp;Setting Up PPP Authentication (Tasks)</a></p>
<p class="toc level2"><a href="ppp.pppoe-1.html">20.&nbsp;&nbsp;Setting Up a PPPoE Tunnel (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.troubleshoot-1.html">21.&nbsp;&nbsp;Fixing Common PPP Problems (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.reference-1.html">22.&nbsp;&nbsp;Solaris PPP 4.0 (Reference)</a></p>
<p class="toc level2"><a href="pppsvrconfig.convert.app-1.html">23.&nbsp;&nbsp;Migrating From Asynchronous Solaris PPP to Solaris PPP 4.0 (Tasks)</a></p>
<p class="toc level2"><a href="uucpov-1.html">24.&nbsp;&nbsp;UUCP (Overview)</a></p>
<p class="toc level2"><a href="uucptasks-1.html">25.&nbsp;&nbsp;Administering UUCP (Tasks)</a></p>
<p class="toc level2"><a href="uucpref-1.html">26.&nbsp;&nbsp;UUCP (Reference)</a></p>
<p class="toc level1 tocsp"><a href="wwrstm.html">Part&nbsp;VI&nbsp;Working With Remote Systems Topics</a></p>
<p class="toc level2"><a href="wwrsov.html">27.&nbsp;&nbsp;Working With Remote Systems (Overview)</a></p>
<p class="toc level2"><a href="wuftp-17.html">28.&nbsp;&nbsp;Administering the FTP Server (Tasks)</a></p>
<p class="toc level2"><a href="remotehowtoaccess-99941.html">29.&nbsp;&nbsp;Accessing Remote Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="netmonitortm-1.html">Part&nbsp;VII&nbsp;Monitoring Network Services Topics</a></p>
<p class="toc level2"><a href="netmonitor-1.html">30.&nbsp;&nbsp;Monitoring Network Performance (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="mailadmin-13"></a><h3>Setting Up Mail Services</h3>
<p>You can readily set up a mail service if your site does not
provide connections to email services outside your company or if your company is in a
single domain.</p><p>Mail requires two types of configurations for local mail. Refer to <a href="mailadmin-2.html#mailadmin-fig-4">Figure&nbsp;13-1</a> in
<a href="mailadmin-2.html#mailadmin-3">Local Mail Only</a> for a representation of these configurations. Mail requires two more configurations for communication with
networks outside your domain. Refer to <a href="mailintro-2.html#mailintro-fig-18">Figure&nbsp;12-1</a> in <a href="mailintro-2.html#mailintro-17">Overview of the Hardware Components</a> or <a href="mailadmin-2.html#mailadmin-fig-8">Figure&nbsp;13-2</a> in <a href="mailadmin-2.html#mailadmin-7">Local Mail and a Remote Connection</a>
for a representation of these configurations. You can combine these configurations on the same system
or provide these configurations on separate systems. For example, if your mail host and mail
server functions are on the same system, follow the directions in this section for
setting up that system as a mail host. Then, follow the directions in this
section for setting up the same system as a mail server.</p>
<hr><p><b>Note - </b><a name="indexterm-1133"></a>The following procedures for setting up a mail server and mail client apply when
mailboxes are NFS mounted. However, mailboxes typically are maintained in locally mounted <tt>/var/mail</tt> directories,
which eliminates the need for the following procedures.</p>
<hr>
<p>Refer to the following:</p>
<ul><li><p><a href="#mailadmin-15">How to Set Up a Mail Server</a></p></li>
<li><p><a href="#mailadmin-20">How to Set Up a Mail Client</a></p></li>
<li><p><a href="#mailadmin-29">How to Set Up a Mail Host</a></p></li>
<li><p><a href="#mailadmin-37">How to Set Up a Mail Gateway</a></p></li>
<li><p><a href="#mailadmin-122">How to Use DNS With <tt>sendmail</tt></a></p></li>
<li><p><a href="#mailadmin-268">Setting Up a Virtual Host</a></p></li></ul>


<a name="mailadmin-15"></a><h4>How to Set Up a Mail Server</h4><p>No special steps are required to set up a mail server that is
only serving mail for local users. The user must have an entry in the
password file or in the namespace. Also, for mail to be delivered, the user
should have a local home directory for checking the <tt>~/.forward</tt> file. For this reason, home
directory servers are often set up as the mail server. <a href="mailrefer-53.html#mailrefer-68">Hardware Components</a> in <a href="mailrefer-1.html">Chapter&nbsp;14, Mail Services (Reference)</a>
provides more information about the mail server.</p><p>The mail server can route mail for many mail clients. This type of mail
server must have adequate spooling space for client mailboxes.</p>
<hr><p><b>Note - </b>The <tt>mail.local</tt> program automatically creates mailboxes in the <tt>/var/mail</tt> directory the first time a message
is delivered. You do not need to create individual mailboxes for your mail clients.</p><p>For clients to access their mailboxes, the <tt>/var/mail</tt> directory should be available for remote
mounting. Alternately, a service such as Post Office Protocol (POP) or Internet Message Access Protocol
(IMAP) should be available from the server. The following task shows you how to
set up a mail server by using the <tt>/var/mail</tt> directory. To provide configuration guidelines
for POP or IMAP is beyond the scope of this document.</p>
<hr>
<p>For the following task, ensure that the <tt>/etc/dfs/dfstab</tt> file shows that the <tt>/var/mail</tt> directory is
exported.</p><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.
To configure a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="mailadmin-step-273"></a><b>Stop <tt>sendmail</tt>.</b><pre># <tt><b>svcadm -t disable network/smtp:sendmail</b></tt></pre></li>
<li><a name="mailadmin-step-17"></a><b><a name="indexterm-1134"></a>Check if the <tt>/var/mail</tt> directory is available for remote access.</b><pre># <tt><b>share</b></tt></pre><p>If the <tt>/var/mail</tt> directory is listed, proceed to step 5.</p><p>If the <tt>/var/mail</tt> directory is not listed or if no list appears, continue with
the appropriate substep.</p><ol style="list-style-type: lower-alpha">
				 
<li><a name="mailadmin-step-230"></a>(Optional) <b>If no list appears, start NFS services.</b><p>Follow the procedure, <a href="rfsadmin-56.html#rfsadmin-57">How to Set Up Automatic File-System Sharing</a>, to use the <tt>/var/mail</tt> directory to start NFS services.</p></li>
<li><a name="mailadmin-step-231"></a>(Optional) <b>If the <tt>/var/mail</tt> directory is not included in the list, add the directory to
<tt>/etc/dfs/dfstab</tt>.</b><p>Add the following command line to the <tt>/etc/dfs/dfstab</tt> file.</p><pre><tt><b>share -F nfs -o rw /var/mail</b></tt></pre></li></ol></li>
<li><a name="mailadmin-step-19"></a><b>Make the file system available for mounting.</b><pre># <tt><b>shareall</b></tt></pre></li>
<li><a name="mailadmin-step-274"></a><b>Ensure that your name service has been started.</b><ol style="list-style-type: lower-alpha">
				 
<li><a name="mailadmin-step-232"></a>(Optional) <b>If you are running NIS, use this command.</b><pre># <tt><b>ypwhich</b></tt></pre><p>For more information, refer to the <a href="http://docs.sun.com/doc/819-2239/ypwhich-1?a=view"><tt>ypwhich</tt>(1)</a> man page.</p></li>
<li><a name="mailadmin-step-233"></a>(Optional) <b>If you are running NIS+, use this command.</b><pre># <tt><b>nisls</b></tt></pre><p>For more information, refer to the <a href="http://docs.sun.com/doc/819-2239/nisls-1?a=view"><tt>nisls</tt>(1)</a> man page.</p></li>
<li><a name="mailadmin-step-234"></a>(Optional) <b>If you are running DNS, use this command.</b><pre># <tt><b>nslookup </tt><i>hostname</i><tt></b></tt></pre><dl><dt><i>hostname</i></dt>
<dd><p>Use your host name.</p></dd>
</dl>
<p>For more information, refer to the <a href="http://docs.sun.com/doc/819-2240/nslookup-1m?a=view"><tt>nslookup</tt>(1M)</a> man page.</p></li>
<li><a name="mailadmin-step-235"></a>(Optional) <b>If you are running LDAP, use this command.</b><pre># <tt><b>ldaplist</b></tt></pre><p>For more information, refer to the <a href="http://docs.sun.com/doc/819-2239/ldaplist-1?a=view"><tt>ldaplist</tt>(1)</a> man page.</p></li></ol></li>
<li><a name="mailadmin-step-276"></a><b>Restart <tt>sendmail</tt>.</b><pre># <tt><b>svcadm enable network/smtp:sendmail</b></tt></pre></li></ol>

<a name="mailadmin-20"></a><h4>How to Set Up a Mail Client</h4><p><a name="indexterm-1135"></a><a name="indexterm-1136"></a>A mail client is a user of mail services with a mailbox on a
mail server. Additionally, the mail client has a mail alias in the <tt>/etc/mail/aliases</tt>
file that points to the location of the mailbox.</p>
<hr><p><b>Note - </b>You can also perform the task of setting up a mail client by using
a service such as Post Office Protocol (POP) or Internet Message Access Protocol (IMAP).
However, to provide configuration guidelines for POP or IMAP is beyond the scope of this
document.</p>
<hr>
<ol>
<li><a name="mailadmin-step-22"></a><b>Become superuser on the mail client's system or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>. To configure
a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="mailadmin-step-277"></a><b>Stop <tt>sendmail</tt>.</b><pre># <tt><b>svcadm -t disable network/smtp:sendmail</b></tt></pre></li>
<li><a name="mailadmin-step-23"></a><b><a name="indexterm-1137"></a><a name="indexterm-1138"></a><a name="indexterm-1139"></a>Ensure that a <tt>/var/mail</tt> mount point exists on the mail client's system. 
 </b><p>The mount point should have been created during the installation process. You can use
<tt>ls</tt> to ensure that the file system exists. The following example shows the response that
you receive if the file system has not been created.</p><pre># <tt><b>ls -l /var/mail</b></tt>
/var/mail not found</pre></li>
<li><a name="mailadmin-step-278"></a><b>Ensure that no files are in the <tt>/var/mail</tt> directory.</b><p>If mail files do exist in this directory, you should move them so that
they are not covered when the <tt>/var/mail</tt> directory is mounted from the server.</p></li>
<li><a name="mailadmin-step-24"></a><b><a name="indexterm-1140"></a>Mount the <tt>/var/mail</tt> directory from the mail server. </b><p><a name="indexterm-1141"></a><a name="indexterm-1142"></a>You can mount the mail directory automatically or at boot time.  </p><ol style="list-style-type: lower-alpha">
				 
<li><a name="mailadmin-step-25"></a>(Optional) <b>Mount <tt>/var/mail</tt> automatically.</b><p><a name="indexterm-1143"></a><a name="indexterm-1144"></a>Add an entry such as the following to the <tt>/etc/auto_direct</tt> file.</p><pre>/var/mail -rw,hard,actimeo=0 <i>server</i>:/var/mail</pre><dl><dt><i>server</i></dt>
<dd><p>Use the assigned server name.</p></dd>
</dl>
</li>
<li><a name="mailadmin-step-26"></a>(Optional) <b>Mount <tt>/var/mail</tt> at boot time.</b><p>Add the following entry to the <tt>/etc/vfstab</tt> file. This entry permits the <tt>/var/mail</tt>
directory on the mail server that is specified to mount the local <tt>/var/mail</tt> directory.</p><pre><i>server</i>:/var/mail - /var/mail nfs - no rw,hard,actimeo=0</pre><p>The client's mailbox is automatically mounted whenever the system is rebooted. If you are
not rebooting the system, type the following command to mount the client mailbox.</p><pre># <tt><b>mountall</b></tt></pre>
<hr><p><b>Caution - </b>For mailbox locking and mailbox access to work properly, you must include the <tt>actimeo=0</tt>
option when mounting mail from an NFS server.</p>
<hr>
</li></ol></li>
<li><a name="mailadmin-step-27"></a><b>Update <tt>/etc/hosts</tt>.</b><p>Edit the <tt>/etc/hosts</tt> file and add an entry for the mail server. This step is
not required if you are using a name service. </p><pre># <tt><b>cat /etc/hosts</b></tt>
#
# Internet host table
#
..
<i>IP-address</i>     <i>mailhost</i>  mailhost  mailhost.<i>example.com</i></pre><dl><dt><i>IP-address</i></dt>
<dd><p>Use the assigned IP addresses.</p></dd>
<dt><i>example.com</i></dt>
<dd><p>Use the assigned domain.</p></dd>
<dt><i>mailhost</i></dt>
<dd><p>Use the assigned mailhost.</p></dd>
</dl>
<p>For more information, refer to the <a href="http://docs.sun.com/doc/819-2251/hosts-4?a=view"><tt>hosts</tt>(4)</a> man page.</p></li>
<li><a name="mailadmin-step-28"></a><b>Add an entry for the client to one of the alias files.</b><p>Refer to <a href="mailadmin-260.html">Administering Mail Alias Files (Task Map)</a> for a task map about administering mail alias files. Note that the
<tt>mail.local</tt> program automatically creates mailboxes in the <tt>/var/mail</tt> directory the first time a message
is delivered. You do not need to create individual mailboxes for your mail clients.</p></li>
<li><a name="mailadmin-step-211"></a><b>Restart <tt>sendmail</tt>.</b><pre># <tt><b>svcadm enable network/smtp:sendmail</b></tt></pre></li></ol>

<a name="mailadmin-29"></a><h4>How to Set Up a Mail Host</h4><p><a name="indexterm-1145"></a><a name="indexterm-1146"></a>A mail host resolves email addresses and reroutes mail within your domain. A good
candidate for a mail host is a system that provides your network with a
remote connection or connects your network to a parent domain. The following procedure shows you
how to set up a mail host.</p><ol>
<li><a name="mailadmin-step-31"></a><b>Become superuser on the mail host system or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>. To configure
a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="mailadmin-step-279"></a><b>Stop <tt>sendmail</tt>.</b><pre># <tt><b>svcadm -t disable network/smtp:sendmail</b></tt></pre></li>
<li><a name="mailadmin-step-32"></a><b>Verify the host-name configuration.</b><p><a name="indexterm-1147"></a>Run the <tt>check-hostname</tt> script to verify that <tt>sendmail</tt> can identify the fully qualified
host name for this server.</p><pre>% <tt><b>/usr/sbin/check-hostname</b></tt>
hostname phoenix OK: fully qualified as phoenix.example.com</pre><p>If this script is not successful in identifying the fully qualified host name, you
need to add the fully qualified host name as the first alias for the
host in <tt>/etc/hosts</tt>. </p></li>
<li><a name="mailadmin-step-33"></a><b>Update the <tt>/etc/hosts</tt> file.</b><p>Choose the step that is appropriate for you.</p><ol style="list-style-type: lower-alpha">
				 
<li><a name="mailadmin-step-226"></a>(Optional) <b>If you are using NIS or NIS+, edit the <tt>/etc/hosts</tt> file on the system
that is to be the new mail host. </b><p>Add the word <tt>mailhost</tt> and <tt>mailhost.</tt><i>domain</i><tt></tt> after the IP address and system name
of the mail host system.</p><pre><i>IP-address</i> <i>mailhost</i> mailhost mailhost.<i>domain</i> loghost</pre><dl><dt><i>IP-address</i></dt>
<dd><p>Use the assigned IP address.</p></dd>
<dt><i>mailhost</i></dt>
<dd><p>Use the system name of the mail host system.</p></dd>
<dt><i>domain</i></dt>
<dd><p>Use the expanded domain name.</p></dd>
</dl>
<p>The system is now designated as a mail host. The <i>domain</i> should be identical
to the string that is given as the subdomain name in the output of
the following command.</p><pre>% <tt><b>/usr/lib/sendmail -bt -d0 &lt;/dev/null</b></tt>
Version 8.13.1+Sun
 Compiled with: LDAPMAP MAP_REGEX LOG MATCHGECOS MIME7TO8 MIME8TO7
                NAMED_BIND NDBM NETINET NETINET6 NETUNIX NEWDB NIS
                NISPLUS QUEUE SCANF SMTP USERDB XDEBUG

============ SYSTEM IDENTITY (after readcf) ============
      (short domain name) $w = phoenix
  (canonical domain name) $j = phoenix.example.com
         (subdomain name) $m = example.com
              (node name) $k = phoenix
========================================================</pre><p>See the following example of how the <tt>hosts</tt> file should look after these changes.</p><pre># <tt><b>cat /etc/hosts</b></tt>
#
# Internet host table
#
172.31.255.255   localhost        
192.168.255.255  phoenix mailhost mailhost.example.com loghost</pre></li>
<li><a name="mailadmin-step-326"></a>(Optional) <b>If you are not using NIS or NIS+, edit the <tt>/etc/hosts</tt> file on
each system in the network. Create the following entry.</b><pre><i>IP-address</i> <i>mailhost</i> mailhost <i>mailhost</i>.<i>domain</i> loghost</pre></li></ol></li>
<li><a name="mailadmin-step-36"></a><b>Restart <tt>sendmail</tt>.</b><pre># <tt><b>svcadm enable network/smtp:sendmail</b></tt></pre></li>
<li><a name="mailadmin-step-280"></a><b>Test your mail configuration.</b><p>See <a href="mailadmin-180.html#mailadmin-181">How to Test the Mail Configuration</a> for instructions.</p>
<hr><p><b>Note - </b>For further information about mail hosts, refer to <a href="mailrefer-53.html#mailrefer-68">Hardware Components</a> in <a href="mailrefer-1.html">Chapter&nbsp;14, Mail Services (Reference)</a>.</p>
<hr>
</li></ol>

<a name="mailadmin-37"></a><h4>How to Set Up a Mail Gateway</h4><p><a name="indexterm-1148"></a><a name="indexterm-1149"></a>A mail gateway manages communication with networks outside your domain. The mailer on the
sending mail gateway can match the mailer on the receiving system.</p><p>A good candidate for a mail gateway is a system that is attached to
Ethernet and phone lines. Another good candidate is a system that is configured as
a router to the Internet. You can configure the mail host or another system
as the mail gateway. You might choose to configure more than one mail gateway
for your domain. If you have UNIX-to-UNIX Copy Program (UUCP) connections, you should configure the
system (or systems) with UUCP connections as the mail gateway.</p><ol>
<li><a name="mailadmin-step-39"></a><b>Become superuser on the mail gateway or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>. To configure a
role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="mailadmin-step-281"></a><b>Stop <tt>sendmail</tt>.</b><pre># <tt><b>svcadm -t disable network/smtp:sendmail</b></tt></pre></li>
<li><a name="mailadmin-step-41"></a><b>Verify the host-name configuration.</b><p><a name="indexterm-1150"></a>Run the <tt>check-hostname</tt> script to verify that <tt>sendmail</tt> can identify the fully qualified
host name for this server.</p><pre># <tt><b>/usr/sbin/check-hostname</b></tt>
hostname phoenix OK: fully qualified as phoenix.example.com</pre><p>If this script is not successful in identifying the fully qualified host name, you
need to add the fully qualified host name as the first alias for the
host in <tt>/etc/hosts</tt>. If you need help with this step, refer to <a href="#mailadmin-step-33">Step&nbsp;4</a> of
<a href="#mailadmin-29">How to Set Up a Mail Host</a>. </p></li>
<li><a name="mailadmin-step-283"></a><b>Ensure that your name service has been started.</b><ol style="list-style-type: lower-alpha">
				 
<li><a name="mailadmin-step-236"></a>(Optional) <b>If you are running NIS, use this command.</b><pre># <tt><b>ypwhich</b></tt></pre><p>For more information, refer to the <a href="http://docs.sun.com/doc/819-2239/ypwhich-1?a=view"><tt>ypwhich</tt>(1)</a> man page.</p></li>
<li><a name="mailadmin-step-237"></a>(Optional) <b>If you are running NIS+, use this command.</b><pre># <tt><b>nisls</b></tt></pre><p>For more information, refer to the <a href="http://docs.sun.com/doc/819-2239/nisls-1?a=view"><tt>nisls</tt>(1)</a> man page.</p></li>
<li><a name="mailadmin-step-238"></a>(Optional) <b>If you are running DNS, use this command.</b><pre># <tt><b>nslookup </tt><i>hostname</i><tt></b></tt></pre><dl><dt><i>hostname</i></dt>
<dd><p>Use your host name.</p></dd>
</dl>
<p>For more information, refer to the <a href="http://docs.sun.com/doc/819-2240/nslookup-1m?a=view"><tt>nslookup</tt>(1M)</a> man page.</p></li>
<li><a name="mailadmin-step-239"></a>(Optional) <b>If you are running LDAP, use this command.</b><pre># <tt><b>ldaplist</b></tt></pre><p>For more information, refer to the <a href="http://docs.sun.com/doc/819-2239/ldaplist-1?a=view"><tt>ldaplist</tt>(1)</a> man page.</p></li></ol></li>
<li><a name="mailadmin-step-42"></a><b>Restart <tt>sendmail</tt>.</b><pre># <tt><b>svcadm enable network/smtp:sendmail</b></tt></pre></li>
<li><a name="mailadmin-step-282"></a><b>Test your mail configuration.</b><p>See <a href="mailadmin-180.html#mailadmin-181">How to Test the Mail Configuration</a> for instructions.</p>
<hr><p><b>Note - </b>For more information about the mail gateway, refer to <a href="mailrefer-53.html#mailrefer-68">Hardware Components</a> in <a href="mailrefer-1.html">Chapter&nbsp;14, Mail Services (Reference)</a>.</p>
<hr>
</li></ol>

<a name="mailadmin-122"></a><h4>How to Use DNS With <tt>sendmail</tt></h4><p><a name="indexterm-1151"></a><a name="indexterm-1152"></a><a name="indexterm-1153"></a>The DNS name service does not support aliases for individuals. This name service does
support aliases for hosts or domains that use Mail Exchanger (MX) records and <tt>CNAME</tt>
records. You can specify host names, domain names, or both names in the DNS
database. For more information about <tt>sendmail</tt> and DNS, see <a href="mailrefer-24.html">Interactions of <tt>sendmail</tt> With Name Services</a> in <a href="mailrefer-1.html">Chapter&nbsp;14, Mail Services (Reference)</a>, or see the
<a href="http://docs.sun.com/doc/819-3194"><i>System Administration Guide: Naming and Directory Services (DNS, NIS, and LDAP)</i></a>. </p><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.
To configure a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="mailadmin-step-125"></a><b>Enable DNS host lookups (NIS+ only).</b><p><a name="indexterm-1154"></a><a name="indexterm-1155"></a>Edit the <tt>/etc/nsswitch.conf</tt> file and remove the <tt>#</tt> from the <tt>hosts</tt> definition that
includes the  <tt>dns</tt> flag. The host entry must include the <tt>dns</tt> flag, as
the following example shows, in order for the DNS host aliases to be used.
</p><pre># <tt><b>grep hosts /etc/nsswitch.conf</b></tt>
#hosts:     nisplus [NOTFOUND=return] files
hosts:      dns nisplus [NOTFOUND=return] files</pre></li>
<li><a name="mailadmin-step-126"></a><b>Check for a <tt>mailhost</tt> and <tt>mailhost.</tt><i>domain</i> entry.</b><p>Use <tt>nslookup</tt> to ensure that an entry exists for <tt>mailhost</tt> and <tt>mailhost.</tt><i>domain</i><tt></tt> in the
DNS database. For more information, refer to the <a href="http://docs.sun.com/doc/819-2240/nslookup-1m?a=view"><tt>nslookup</tt>(1M)</a> man page.</p></li></ol>

<a name="mailadmin-268"></a><h4>Setting Up a Virtual Host</h4>
<p><a name="indexterm-1156"></a><a name="indexterm-1157"></a>If you need to assign more than one IP address to a host, see
this Web site: <a href="http://www.sendmail.org/virtual-hosting.html">http://www.sendmail.org/virtual-hosting.html</a>. This site provides complete instructions about how to use
<tt>sendmail</tt> to set up a virtual host. However, in the &ldquo;Sendmail Configuration&rdquo; section, do
not perform step 3b, as shown in the following.</p><pre># <tt><b>cd sendmail-VERSION/cf/cf</b></tt>
# <tt><b>./Build mailserver.cf</b></tt>
# <tt><b>cp mailserver.cf /etc/mail/sendmail.cf</b></tt></pre><p>Instead, for the Solaris operating system, perform the following steps.</p><pre># <tt><b>cd /etc/mail/cf/cf</b></tt>
# <tt><b>/usr/ccs/bin/make</b></tt> <i>mailserver</i><tt><b>.cf</b></tt>
# <tt><b>cp</b></tt> <i>mailserver</i><tt><b>.cf /etc/mail/sendmail.cf</b></tt></pre><dl><dt><i>mailserver</i></dt>
<dd><p>Use the name of the <tt>.cf</tt> file.</p></dd>
</dl>
<p><a href="mailadmin-43.html">Building the <tt>sendmail.cf</tt> Configuration File</a> outlines the same three steps as part of the build process.</p><p>After you have generated your <tt>/etc/mail/sendmail.cf</tt> file, you can continue with the next
steps to create a virtual user table.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="mailadmin-263.html">Previous</a>
             </td>
             <td align="right">
                 <a href="mailadmin-43.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

