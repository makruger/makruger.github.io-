<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Using <tt>snoop</tt> to Monitor SLP Activity - System Administration Guide: Network Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: Network Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="slp.setup-11.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ch.configuration-6.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="netservices-1.html">Part&nbsp;I&nbsp;Network Services Topics</a></p>
<p class="toc level2"><a href="nsov-1.html">1.&nbsp;&nbsp;Network Service (Overview)</a></p>
<p class="toc level2"><a href="nca-1.html">2.&nbsp;&nbsp;Managing Web Cache Servers</a></p>
<p class="toc level2"><a href="time-1.html">3.&nbsp;&nbsp;Time-Related Services</a></p>
<p class="toc level1 tocsp"><a href="rfstm-1.html">Part&nbsp;II&nbsp;Accessing Network File Systems Topics</a></p>
<p class="toc level2"><a href="rfsintro-2.html">4.&nbsp;&nbsp;Managing Network File Systems (Overview)</a></p>
<p class="toc level2"><a href="rfsadmin-8.html">5.&nbsp;&nbsp;Network File System Administration (Tasks)</a></p>
<p class="toc level2"><a href="rfsrefer-1.html">6.&nbsp;&nbsp;Accessing Network File Systems (Reference)</a></p>
<p class="toc level1 tocsp"><a href="slptm.html">Part&nbsp;III&nbsp;SLP Topics</a></p>
<p class="toc level2"><a href="slparch-16.html">7.&nbsp;&nbsp;SLP (Overview)</a></p>
<p class="toc level2"><a href="slp.setup-10.html">8.&nbsp;&nbsp;Planning and Enabling SLP (Tasks)</a></p>
<p class="toc level3"><a href="slp.setup-11.html">SLP Configuration Considerations</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Using <tt>snoop</tt> to Monitor SLP Activity</a></p>
<p class="toc level4"><a href="#slp.setup-14">How to Use <tt>snoop</tt> to Run SLP Traces</a></p>
</div>
<p class="toc level2 tocsp"><a href="ch.configuration-6.html">9.&nbsp;&nbsp;Administering SLP (Tasks)</a></p>
<p class="toc level2"><a href="legacy-7.html">10.&nbsp;&nbsp;Incorporating Legacy Services</a></p>
<p class="toc level2"><a href="slpreference.html">11.&nbsp;&nbsp;SLP (Reference)</a></p>
<p class="toc level1 tocsp"><a href="mailtm-1.html">Part&nbsp;IV&nbsp;Mail Services Topics</a></p>
<p class="toc level2"><a href="mailintro-1.html">12.&nbsp;&nbsp;Mail Services (Overview)</a></p>
<p class="toc level2"><a href="mailadmin-1.html">13.&nbsp;&nbsp;Mail Services (Tasks)</a></p>
<p class="toc level2"><a href="mailrefer-1.html">14.&nbsp;&nbsp;Mail Services (Reference)</a></p>
<p class="toc level1 tocsp"><a href="modemtm-1.html">Part&nbsp;V&nbsp;Serial Networking Topics</a></p>
<p class="toc level2"><a href="pppsvrconfig.intro-1.html">15.&nbsp;&nbsp;Solaris PPP 4.0 (Overview)</a></p>
<p class="toc level2"><a href="pppsvrconfig.p2plink-1.html">16.&nbsp;&nbsp;Planning for the PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.dialin-1.html">17.&nbsp;&nbsp;Setting Up a Dial-up PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.leased-1.html">18.&nbsp;&nbsp;Setting Up a Leased-Line PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.auth-1.html">19.&nbsp;&nbsp;Setting Up PPP Authentication (Tasks)</a></p>
<p class="toc level2"><a href="ppp.pppoe-1.html">20.&nbsp;&nbsp;Setting Up a PPPoE Tunnel (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.troubleshoot-1.html">21.&nbsp;&nbsp;Fixing Common PPP Problems (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.reference-1.html">22.&nbsp;&nbsp;Solaris PPP 4.0 (Reference)</a></p>
<p class="toc level2"><a href="pppsvrconfig.convert.app-1.html">23.&nbsp;&nbsp;Migrating From Asynchronous Solaris PPP to Solaris PPP 4.0 (Tasks)</a></p>
<p class="toc level2"><a href="uucpov-1.html">24.&nbsp;&nbsp;UUCP (Overview)</a></p>
<p class="toc level2"><a href="uucptasks-1.html">25.&nbsp;&nbsp;Administering UUCP (Tasks)</a></p>
<p class="toc level2"><a href="uucpref-1.html">26.&nbsp;&nbsp;UUCP (Reference)</a></p>
<p class="toc level1 tocsp"><a href="wwrstm.html">Part&nbsp;VI&nbsp;Working With Remote Systems Topics</a></p>
<p class="toc level2"><a href="wwrsov.html">27.&nbsp;&nbsp;Working With Remote Systems (Overview)</a></p>
<p class="toc level2"><a href="wuftp-17.html">28.&nbsp;&nbsp;Administering the FTP Server (Tasks)</a></p>
<p class="toc level2"><a href="remotehowtoaccess-99941.html">29.&nbsp;&nbsp;Accessing Remote Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="netmonitortm-1.html">Part&nbsp;VII&nbsp;Monitoring Network Services Topics</a></p>
<p class="toc level2"><a href="netmonitor-1.html">30.&nbsp;&nbsp;Monitoring Network Performance (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="slp.setup-13"></a><h3>Using <tt>snoop</tt> to Monitor SLP Activity</h3>
<p><a name="indexterm-938"></a>The <tt>snoop</tt> utility is a passive administrative tool that provides network traffic information.
The utility itself generates minimal traffic and enables you to watch all activity
on your network as it occurs.</p><p>The <tt>snoop</tt> utility provides traces of the actual SLP message traffic. For example,
when you run <tt>snoop</tt> with the <tt>slp</tt> command-line argument, the utility displays
traces with information on SLP registrations and deregistrations. You can use the information
to gauge the network load by checking which services are being registered and
how much reregistration activity its occurring.</p><p>The <tt>snoop</tt> utility is also useful for observing the traffic flow between SLP
hosts in your enterprise. When you run <tt>snoop</tt> with the <tt>slp</tt> command-line argument,
you can monitor the following types of SLP activity to determine if network
or agent reconfiguration is needed:</p>
<ul><li><p>The number of hosts that are using a particular DA. Use this information to decide whether to deploy additional DAs for load balancing.</p></li>
<li><p>The number of hosts that are using a particular DA. Use this information to help you determine whether to configure certain hosts with new or different scopes.</p></li>
<li><p><a name="indexterm-939"></a>Whether UA requests a timeout or DA acknowledgment is slow. You can determine whether a DA is overloaded by monitoring UA timeouts and retransmissions. You can also check if the DA requires more than a few seconds to send registration acknowledgments to an SA. Use this information to rebalance the network load on the DA, if necessary, by deploying additional DAs or changing the scope configurations.</p></li></ul>
<p>Using <tt>snoop</tt> with the <tt>-V</tt> (verbose) command-line argument, you can obtain registration lifetimes
and value of the fresh flag in <tt>SrvReg</tt> to determine whether the number of
reregistrations should be reduced. </p><p>You can also use <tt>snoop</tt> to trace other kinds of SLP traffic, such
as the following:</p>
<ul><li><p>Traffic between UA clients and DAs</p></li>
<li><p>Traffic between multicasting UA clients and replying SAs</p></li></ul>
<p><a name="indexterm-940"></a>For more information about <tt>snoop</tt>, refer to the  <a href="http://docs.sun.com/doc/819-2240/snoop-1m?a=view"><tt>snoop</tt>(1M)</a>.</p>
<hr><p><b>Tip - </b>Use the <tt>netstat</tt> command in conjunction with <tt>snoop</tt> to view traffic and
congestion statistics. For more information about <tt>netstat</tt>, refer to <a href="http://docs.sun.com/doc/819-2240/netstat-1m?a=view"><tt>netstat</tt>(1M)</a>.</p>
<hr>


<a name="slp.setup-14"></a><h4>How to Use <tt>snoop</tt> to Run SLP Traces</h4><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.
To configure a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="slp.setup-step-17"></a><b>Run <tt>snoop</tt> with the <tt>slp</tt> command-line argument.</b><pre><b>Brief Mode</b>:
# <tt><b>snoop slp</b></tt></pre><p>When you run <tt>snoop</tt> in the default <b>brief</b> mode, ongoing output is delivered
to your screen. SLP messages are truncated to fit on one line per
SLP trace. </p><pre><b>Verbose Mode</b>:
# <tt><b>snoop -v slp</b></tt></pre><p><a name="indexterm-941"></a>When you run <tt>snoop</tt> in <b>verbose</b> mode, <tt>snoop</tt> delivers ongoing, unabbreviated output
to your screen, which provides the following information:</p>
<ul><li><p>The complete address of the service URL</p></li>
<li><p>All service attributes</p></li>
<li><p>The registration lifetime</p></li>
<li><p>All security parameters and flags, if any are available</p></li></ul>

<hr><p><b>Note - </b><a name="indexterm-942"></a>You can use the <tt>slp</tt> command-line argument with other <tt>snoop</tt> options. </p>
<hr>
</li></ol>

<a name="slp.setup-18"></a><h4>Analyzing a <tt>snoop slp</tt> Trace</h4>
<p><a name="indexterm-943"></a><a name="indexterm-944"></a>In the following example, <tt>slpd</tt> runs on <b>slphost1</b> in the default mode
as an SA server. The SLP daemon initializes and registers <b>slphost2</b> as an
echo server. Then, the <tt>snoop slp</tt> process is invoked on <b>slphost1</b>.</p>
<hr><p><b>Note - </b>To simplify the description of the trace results, the lines in the following
<tt>snoop</tt> output are flagged with line numbers.</p>
<hr>
<pre>(1) slphost1 -> 239.255.255.253 SLP V@ SrvRqst [24487] service:directory-agent []
(2) slphost2 -> slphost1 SLP V2 DAAdvert [24487] service:directory-agent://129
(3) slphost1 -> 239.255.255.253 SLP V2 SrvRqst [24487] service:directory-agent []
(4) slphost1 -> 239.255.255.253 SLP V2 SrvRqst [24487] service:directory-agent []
(5) slphost1 -> slphost2 SLP V2 SrvReg [24488/tcp]service:echo.sun:tcp://slphost1:
(6) slphost2 -> slphost1 SLP V2 SrvAck [24488/tcp] ok
(7) slphost1 -> slphost2 SLP V2 SrvDereg [24489/tcp] service:echo.sun:tcp://slphost1:
(8) slphost2 -> slphost1 SLP V2 SrvAck [24489/tcp] ok</pre>
<ol><li><p>Shows <tt>slpd</tt> on <b>slphost1</b> performing active directory agent discovery by multicasting to the SLP multicast group address in search of directory agents. The message number, 24487, for the active discovery is indicated in square brackets in the trace display.</p></li>
<li><p>Indicates that the active discovery request 24487 from trace 1 is answered by <tt>slpd</tt>, which is running as a DA on the host <b>slphost2</b>. The service URL from <b>slphost2</b> has been truncated to fit on a single line. The DA has sent a DA advertisement in reply to the multicast directory agent discovery message, as indicated by the matching message numbers in traces 1 and 2.</p></li>
<li><p>Shows multicasts from the UAs on <b>slphost1</b> for additional DAs. Because <b>slphost2</b> has already answered the request, it refrains from responding again, and no other DAs reply.</p></li>
<li><p>Repeats the multicast operation that is shown in the previous line.</p></li>
<li><p>Shows a <tt>slpd</tt> on <b>slphost1</b> forwarding SA client registrations to the DA on <b>slphost2</b>. A unicast service registration (<tt>SrvReg</tt>) for an echo server is made by <b>slphost1</b> to the DA on <b>slphost2</b>.</p></li>
<li><p>Shows <b>slphost2</b> responding to the <b>slphost1</b> <tt>SrvReg</tt> with a service acknowledgment (<tt>SrvAck</tt>) that indicates the registration is successful.</p><p>Traffic between the echo server that runs the SA client and the SLP daemon on <b>slphost1</b> does not appear in the <tt>snoop</tt> trace. This absence of information is because the <tt>snoop</tt> operation is performed over the network loopback.</p></li>
<li><p>Shows the echo server on <b>slphost1</b> deregistering the echo service advertisement. The SLP daemon on <b>slphost1</b> forwards the deregistration to the DA on <b>slphost2</b>.</p></li>
<li><p>Shows <b>slphost2</b> responding to the <b>slphost1</b> with a service acknowledgment (<tt>SrvAck</tt>) that indicates that the deregistration is successful.</p><p>The <tt>/tcp</tt> parameter that is appended to the message number on lines 5, 6, 7, and 8 indicates that the message exchange occurred by TCP.</p></li></ol>


<a name="considerations.xx-36"></a><h5>Where to Go From Here</h5>
<p>After monitoring the SLP traffic, you can use the information that was collected
from the <tt>snoop</tt> traces to help determine whether any reconfiguration of the SLP
defaults is needed. Use the related information in <a href="ch.configuration-6.html">Chapter&nbsp;9, Administering SLP (Tasks)</a> for configuring SLP property
settings. For more information about SLP messaging and service registrations, refer to <a href="slpreference.html">Chapter&nbsp;11, SLP (Reference)</a>.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="slp.setup-11.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ch.configuration-6.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

