<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Managing Mail Delivery by Using an Alternate Configuration - System Administration Guide: Network Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: Network Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ganav.html">Previous</a>
             </td>
             <td align="right">
                 <a href="mailadmin-260.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="netservices-1.html">Part&nbsp;I&nbsp;Network Services Topics</a></p>
<p class="toc level2"><a href="nsov-1.html">1.&nbsp;&nbsp;Network Service (Overview)</a></p>
<p class="toc level2"><a href="nca-1.html">2.&nbsp;&nbsp;Managing Web Cache Servers</a></p>
<p class="toc level2"><a href="time-1.html">3.&nbsp;&nbsp;Time-Related Services</a></p>
<p class="toc level1 tocsp"><a href="rfstm-1.html">Part&nbsp;II&nbsp;Accessing Network File Systems Topics</a></p>
<p class="toc level2"><a href="rfsintro-2.html">4.&nbsp;&nbsp;Managing Network File Systems (Overview)</a></p>
<p class="toc level2"><a href="rfsadmin-8.html">5.&nbsp;&nbsp;Network File System Administration (Tasks)</a></p>
<p class="toc level2"><a href="rfsrefer-1.html">6.&nbsp;&nbsp;Accessing Network File Systems (Reference)</a></p>
<p class="toc level1 tocsp"><a href="slptm.html">Part&nbsp;III&nbsp;SLP Topics</a></p>
<p class="toc level2"><a href="slparch-16.html">7.&nbsp;&nbsp;SLP (Overview)</a></p>
<p class="toc level2"><a href="slp.setup-10.html">8.&nbsp;&nbsp;Planning and Enabling SLP (Tasks)</a></p>
<p class="toc level2"><a href="ch.configuration-6.html">9.&nbsp;&nbsp;Administering SLP (Tasks)</a></p>
<p class="toc level2"><a href="legacy-7.html">10.&nbsp;&nbsp;Incorporating Legacy Services</a></p>
<p class="toc level2"><a href="slpreference.html">11.&nbsp;&nbsp;SLP (Reference)</a></p>
<p class="toc level1 tocsp"><a href="mailtm-1.html">Part&nbsp;IV&nbsp;Mail Services Topics</a></p>
<p class="toc level2"><a href="mailintro-1.html">12.&nbsp;&nbsp;Mail Services (Overview)</a></p>
<p class="toc level2"><a href="mailadmin-1.html">13.&nbsp;&nbsp;Mail Services (Tasks)</a></p>
<p class="toc level3"><a href="mailadmin-270.html">Task Map for Mail Services</a></p>
<p class="toc level3"><a href="mailadmin-2.html">Planning Your Mail System</a></p>
<p class="toc level3"><a href="mailadmin-263.html">Setting Up Mail Services (Task Map)</a></p>
<p class="toc level3"><a href="mailadmin-13.html">Setting Up Mail Services</a></p>
<p class="toc level4"><a href="mailadmin-13.html#mailadmin-15">How to Set Up a Mail Server</a></p>
<p class="toc level4"><a href="mailadmin-13.html#mailadmin-20">How to Set Up a Mail Client</a></p>
<p class="toc level4"><a href="mailadmin-13.html#mailadmin-29">How to Set Up a Mail Host</a></p>
<p class="toc level4"><a href="mailadmin-13.html#mailadmin-37">How to Set Up a Mail Gateway</a></p>
<p class="toc level4"><a href="mailadmin-13.html#mailadmin-122">How to Use DNS With <tt>sendmail</tt></a></p>
<p class="toc level3 tocsp"><a href="mailadmin-43.html">Building the <tt>sendmail.cf</tt> Configuration File</a></p>
<p class="toc level4"><a href="mailadmin-43.html#mailadmin-44">How to Build a New <tt>sendmail.cf</tt> File</a></p>
<p class="toc level3 tocsp"><a href="ganav.html">Setting SMTP to Use TLS</a></p>
<p class="toc level4"><a href="ganav.html#fxcty">How to Set SMTP to Use TLS</a></p>
<div class="onpage">
<p class="toc level3 tocsp"><a href="">Managing Mail Delivery by Using an Alternate Configuration</a></p>
<p class="toc level4"><a href="#mailadmin-378">How to Manage Mail Delivery by Using an Alternate Configuration of <tt>sendmail.cf</tt></a></p>
</div>
<p class="toc level3 tocsp"><a href="mailadmin-260.html">Administering Mail Alias Files (Task Map)</a></p>
<p class="toc level3"><a href="mailadmin-52.html">Administering Mail Alias Files</a></p>
<p class="toc level4"><a href="mailadmin-52.html#mailadmin-345">How to Initiate an NIS+ <tt>mail_aliases</tt> Table</a></p>
<p class="toc level4"><a href="mailadmin-52.html#mailadmin-327">How to List the Contents of the NIS+ <tt>mail_aliases</tt> Table</a></p>
<p class="toc level4"><a href="mailadmin-52.html#mailadmin-330">How to Add Aliases to the NIS+ <tt>mail_aliases</tt> Table From the Command Line</a></p>
<p class="toc level4"><a href="mailadmin-52.html#mailadmin-331">How to Add Entries by Editing an NIS+ <tt>mail_aliases</tt> Table</a></p>
<p class="toc level4"><a href="mailadmin-52.html#mailadmin-332">How to Edit Entries in an NIS+ <tt>mail_aliases</tt> Table</a></p>
<p class="toc level4"><a href="mailadmin-52.html#mailadmin-93">How to Set Up an NIS <tt>mail.aliases</tt> Map</a></p>
<p class="toc level4"><a href="mailadmin-52.html#mailadmin-106">How to Set Up a Local Mail Alias File</a></p>
<p class="toc level4"><a href="mailadmin-52.html#mailadmin-118">How to Create a Keyed Map File</a></p>
<p class="toc level3 tocsp"><a href="mailadmin-262.html">Administering the Queue Directories (Task Map)</a></p>
<p class="toc level3"><a href="mailadmin-138.html">Administering the Queue Directories</a></p>
<p class="toc level4"><a href="mailadmin-138.html#eyhyo">How to Display the Contents of the Mail Queue, <tt>/var/spool/mqueue</tt></a></p>
<p class="toc level4"><a href="mailadmin-138.html#mailadmin-142">How to Force Mail Queue Processing in the Mail Queue, <tt>/var/spool/mqueue</tt></a></p>
<p class="toc level4"><a href="mailadmin-138.html#mailadmin-145">How to Run a Subset of the Mail Queue, <tt>/var/spool/mqueue</tt></a></p>
<p class="toc level4"><a href="mailadmin-138.html#mailadmin-148">How to Move the Mail Queue, <tt>/var/spool/mqueue</tt></a></p>
<p class="toc level4"><a href="mailadmin-138.html#mailadmin-156">How to Run the Old Mail Queue, <tt>/var/spool/omqueue</tt></a></p>
<p class="toc level3 tocsp"><a href="mailadmin-264.html">Administering <tt>.forward</tt> Files (Task Map)</a></p>
<p class="toc level3"><a href="mailadmin-160.html">Administering <tt>.forward</tt> Files</a></p>
<p class="toc level4"><a href="mailadmin-160.html#mailadmin-161">How to Disable <tt>.forward</tt> Files</a></p>
<p class="toc level4"><a href="mailadmin-160.html#mailadmin-167">How to Change the <tt>.forward</tt>-File Search Path</a></p>
<p class="toc level4"><a href="mailadmin-160.html#mailadmin-173">How to Create and Populate <tt>/etc/shells</tt></a></p>
<p class="toc level3 tocsp"><a href="mailadmin-265.html">Troubleshooting Procedures and Tips for Mail Services (Task Map)</a></p>
<p class="toc level3"><a href="mailadmin-180.html">Troubleshooting Procedures and Tips for Mail Services</a></p>
<p class="toc level4"><a href="mailadmin-180.html#mailadmin-181">How to Test the Mail Configuration</a></p>
<p class="toc level4"><a href="mailadmin-180.html#mailadmin-195">How to Test the <tt>sendmail</tt> Rule Sets</a></p>
<p class="toc level3 tocsp"><a href="mailadmin-219.html">Resolving Error Messages</a></p>
<p class="toc level2 tocsp"><a href="mailrefer-1.html">14.&nbsp;&nbsp;Mail Services (Reference)</a></p>
<p class="toc level1 tocsp"><a href="modemtm-1.html">Part&nbsp;V&nbsp;Serial Networking Topics</a></p>
<p class="toc level2"><a href="pppsvrconfig.intro-1.html">15.&nbsp;&nbsp;Solaris PPP 4.0 (Overview)</a></p>
<p class="toc level2"><a href="pppsvrconfig.p2plink-1.html">16.&nbsp;&nbsp;Planning for the PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.dialin-1.html">17.&nbsp;&nbsp;Setting Up a Dial-up PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.leased-1.html">18.&nbsp;&nbsp;Setting Up a Leased-Line PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.auth-1.html">19.&nbsp;&nbsp;Setting Up PPP Authentication (Tasks)</a></p>
<p class="toc level2"><a href="ppp.pppoe-1.html">20.&nbsp;&nbsp;Setting Up a PPPoE Tunnel (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.troubleshoot-1.html">21.&nbsp;&nbsp;Fixing Common PPP Problems (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.reference-1.html">22.&nbsp;&nbsp;Solaris PPP 4.0 (Reference)</a></p>
<p class="toc level2"><a href="pppsvrconfig.convert.app-1.html">23.&nbsp;&nbsp;Migrating From Asynchronous Solaris PPP to Solaris PPP 4.0 (Tasks)</a></p>
<p class="toc level2"><a href="uucpov-1.html">24.&nbsp;&nbsp;UUCP (Overview)</a></p>
<p class="toc level2"><a href="uucptasks-1.html">25.&nbsp;&nbsp;Administering UUCP (Tasks)</a></p>
<p class="toc level2"><a href="uucpref-1.html">26.&nbsp;&nbsp;UUCP (Reference)</a></p>
<p class="toc level1 tocsp"><a href="wwrstm.html">Part&nbsp;VI&nbsp;Working With Remote Systems Topics</a></p>
<p class="toc level2"><a href="wwrsov.html">27.&nbsp;&nbsp;Working With Remote Systems (Overview)</a></p>
<p class="toc level2"><a href="wuftp-17.html">28.&nbsp;&nbsp;Administering the FTP Server (Tasks)</a></p>
<p class="toc level2"><a href="remotehowtoaccess-99941.html">29.&nbsp;&nbsp;Accessing Remote Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="netmonitortm-1.html">Part&nbsp;VII&nbsp;Monitoring Network Services Topics</a></p>
<p class="toc level2"><a href="netmonitor-1.html">30.&nbsp;&nbsp;Monitoring Network Performance (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="mailadmin-377"></a><h3>Managing Mail Delivery by Using an Alternate Configuration</h3>
<p><a name="indexterm-1165"></a>To facilitate the transport of inbound mail and outbound mail, the new default configuration
of <tt>sendmail</tt> uses a daemon and a client queue runner. If you have disabled
your daemon, you should perform the following task. For a detailed explanation, refer to
<a href="mailrefer-105.html#mailrefer-106"><tt>submit.cf</tt> Configuration File From Version 8.12 of <tt>sendmail</tt></a>.</p>

<a name="mailadmin-378"></a><h4>How to Manage Mail Delivery by Using an Alternate Configuration of <tt>sendmail.cf</tt></h4><p>In the default configuration of <tt>sendmail</tt>, the client queue runner must be able to submit
mail to the daemon on the local SMTP port. If the daemon is
not listening on the SMTP port, the mail remains in the queue. To avoid
this problem, perform the following task. For more information about the daemon and client queue
runner and to understand why you might have to use this alternate configuration, refer
to <a href="mailrefer-105.html#mailrefer-106"><tt>submit.cf</tt> Configuration File From Version 8.12 of <tt>sendmail</tt></a>.</p><p>This procedure ensures that your daemon runs only to accept connections from the local
host.</p><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.
To configure a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="mailadmin-step-1284"></a><b>Stop <tt>sendmail</tt>.</b><pre># <tt><b>svcadm -t disable network/smtp:sendmail</b></tt></pre></li>
<li><a name="mailadmin-step-1046"></a><b>Make a copy of the configuration file that you are changing.</b><pre># <tt><b>cd /etc/mail/cf/cf</b></tt>
# <tt><b>cp sendmail.mc</b></tt> <i>myhost</i><tt><b>.mc</b></tt></pre><dl><dt><i>myhost</i></dt>
<dd><p>Select a new name for your <tt>.mc</tt> file.</p></dd>
</dl>
</li>
<li><a name="mailadmin-step-1047"></a><b>Edit the new configuration file (for example, <i>myhost</i><tt>.mc</tt>). </b><p>Add the following line before the <tt>MAILER()</tt> lines.</p><pre># <tt><b>cat </tt><i>myhost</i><tt>.mc</b></tt>
..
<tt><b>FEATURE(`no_default_msa')dnl</b></tt>
<tt><b>DAEMON_OPTIONS(`NAME=NoMTA4, Family=inet, Addr=127.0.0.1')dnl</b></tt>
<tt><b>DAEMON_OPTIONS(`Name=MSA4, Family=inet, Addr=127.0.0.1, Port=587, M=E')dnl</b></tt></pre>
<hr><p><b>Note - </b>Use these configuration macros on machines that only have configured addresses for IPv4.</p>
<hr>
<ol style="list-style-type: lower-alpha">
				 
<li>(Optional) <b>If your host has an IPv6 local host address that is enabled, edit the
new configuration file as follows.</b><p>Add the following lines before the <tt>MAILER()</tt> lines.</p><pre># <tt><b>cat </tt><i>myhost</i><tt>.mc</b></tt>
..
<tt><b>FEATURE(`no_default_msa')dnl</b></tt>
<tt><b>DAEMON_OPTIONS(`NAME=NoMTA4, Family=inet, Addr=127.0.0.1')dnl</b></tt>
<tt><b>DAEMON_OPTIONS(`Name=MSA4, Family=inet, Addr=127.0.0.1, Port=587, M=E')dnl</b></tt>
<tt><b>DAEMON_OPTIONS(`NAME=NoMTA6, Family=inet6, Addr=::1')dnl</b></tt>
<tt><b>DAEMON_OPTIONS(`Name=MSA6, Family=inet6, Addr=::1, Port=587, M=E')dnl</b></tt></pre>
<hr><p><b>Caution - </b>To add these configuration macros, you must have configured addresses for IPv4 and IPv6.</p>
<hr>
</li>
<li><a name="mailadmin-step-392"></a>(Optional) <b>To see if your host has an IPv6 local host address that is enabled,
run the following command.</b><pre># /usr/sbin/ifconfig -a</pre><p>If IPv6 is enabled, you should see output that is similar to the following.</p><pre>lo0: flags=2000849&lt;UP,LOOPBACK,RUNNING,MULTICAST,IPv6> mtu 8252 index 1
              inet6 ::1/128</pre></li></ol></li>
<li><a name="mailadmin-step-1048"></a><b>Build the configuration file by using <tt>m4</tt>.</b><pre># <tt><b>/usr/ccs/bin/make</b></tt> <i>myhost</i><tt><b>.cf</b></tt></pre></li>
<li><a name="mailadmin-step-1050"></a><b>Install the new configuration file after making a copy of the original.</b><pre># <tt><b>cp /etc/mail/sendmail.cf /etc/mail/sendmail.cf.save</b></tt>
# <tt><b>cp</b></tt> <i>myhost</i><tt><b>.cf /etc/mail/sendmail.cf</b></tt></pre></li>
<li><a name="mailadmin-step-1051"></a><b>Restart the <tt>sendmail</tt> service.</b><pre># <tt><b>svcadm enable network/smtp:sendmail</b></tt></pre></li></ol>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ganav.html">Previous</a>
             </td>
             <td align="right">
                 <a href="mailadmin-260.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

