<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Tools for Troubleshooting PPP - System Administration Guide: Network Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: Network Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="pppsvrconfig.troubleshoot-2.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ppp.trouble-6.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="netservices-1.html">Part&nbsp;I&nbsp;Network Services Topics</a></p>
<p class="toc level2"><a href="nsov-1.html">1.&nbsp;&nbsp;Network Service (Overview)</a></p>
<p class="toc level2"><a href="nca-1.html">2.&nbsp;&nbsp;Managing Web Cache Servers</a></p>
<p class="toc level2"><a href="time-1.html">3.&nbsp;&nbsp;Time-Related Services</a></p>
<p class="toc level1 tocsp"><a href="rfstm-1.html">Part&nbsp;II&nbsp;Accessing Network File Systems Topics</a></p>
<p class="toc level2"><a href="rfsintro-2.html">4.&nbsp;&nbsp;Managing Network File Systems (Overview)</a></p>
<p class="toc level2"><a href="rfsadmin-8.html">5.&nbsp;&nbsp;Network File System Administration (Tasks)</a></p>
<p class="toc level2"><a href="rfsrefer-1.html">6.&nbsp;&nbsp;Accessing Network File Systems (Reference)</a></p>
<p class="toc level1 tocsp"><a href="slptm.html">Part&nbsp;III&nbsp;SLP Topics</a></p>
<p class="toc level2"><a href="slparch-16.html">7.&nbsp;&nbsp;SLP (Overview)</a></p>
<p class="toc level2"><a href="slp.setup-10.html">8.&nbsp;&nbsp;Planning and Enabling SLP (Tasks)</a></p>
<p class="toc level2"><a href="ch.configuration-6.html">9.&nbsp;&nbsp;Administering SLP (Tasks)</a></p>
<p class="toc level2"><a href="legacy-7.html">10.&nbsp;&nbsp;Incorporating Legacy Services</a></p>
<p class="toc level2"><a href="slpreference.html">11.&nbsp;&nbsp;SLP (Reference)</a></p>
<p class="toc level1 tocsp"><a href="mailtm-1.html">Part&nbsp;IV&nbsp;Mail Services Topics</a></p>
<p class="toc level2"><a href="mailintro-1.html">12.&nbsp;&nbsp;Mail Services (Overview)</a></p>
<p class="toc level2"><a href="mailadmin-1.html">13.&nbsp;&nbsp;Mail Services (Tasks)</a></p>
<p class="toc level2"><a href="mailrefer-1.html">14.&nbsp;&nbsp;Mail Services (Reference)</a></p>
<p class="toc level1 tocsp"><a href="modemtm-1.html">Part&nbsp;V&nbsp;Serial Networking Topics</a></p>
<p class="toc level2"><a href="pppsvrconfig.intro-1.html">15.&nbsp;&nbsp;Solaris PPP 4.0 (Overview)</a></p>
<p class="toc level2"><a href="pppsvrconfig.p2plink-1.html">16.&nbsp;&nbsp;Planning for the PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.dialin-1.html">17.&nbsp;&nbsp;Setting Up a Dial-up PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.leased-1.html">18.&nbsp;&nbsp;Setting Up a Leased-Line PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.auth-1.html">19.&nbsp;&nbsp;Setting Up PPP Authentication (Tasks)</a></p>
<p class="toc level2"><a href="ppp.pppoe-1.html">20.&nbsp;&nbsp;Setting Up a PPPoE Tunnel (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.troubleshoot-1.html">21.&nbsp;&nbsp;Fixing Common PPP Problems (Tasks)</a></p>
<p class="toc level3"><a href="pppsvrconfig.troubleshoot-2.html">Solving PPP Problems (Task Map)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Tools for Troubleshooting PPP</a></p>
<p class="toc level4"><a href="#ppp.trouble-10">How to Obtain Diagnostic Information From <tt>pppd</tt></a></p>
<p class="toc level4"><a href="#ppp.trouble-21">How to Turn on PPP Debugging</a></p>
</div>
<p class="toc level3 tocsp"><a href="ppp.trouble-6.html">Solving PPP-Related and PPPoE-Related Problems</a></p>
<p class="toc level4"><a href="ppp.trouble-6.html#ppp.trouble-75">How to Diagnose Network Problems</a></p>
<p class="toc level4"><a href="ppp.trouble-6.html#ppp.trouble-93">How to Diagnose and Fix Communications Problems</a></p>
<p class="toc level4"><a href="ppp.trouble-6.html#ppp.trouble-100">How to Diagnose Problems With the PPP Configuration</a></p>
<p class="toc level4"><a href="ppp.trouble-6.html#ppp.trouble-27">How to Diagnose Modem Problems</a></p>
<p class="toc level4"><a href="ppp.trouble-6.html#ppp.trouble-44">How to Obtain Debugging Information for Chat Scripts</a></p>
<p class="toc level4"><a href="ppp.trouble-6.html#ppp.trouble-35">How to Diagnose and Fix Serial-Line Speed Problems</a></p>
<p class="toc level4"><a href="ppp.trouble-6.html#ppp.trouble-56">How to Obtain Diagnostic Information for PPPoE</a></p>
<p class="toc level3 tocsp"><a href="ppp.trouble-25.html">Fixing Leased-Line Problems</a></p>
<p class="toc level3"><a href="ppp.trouble-92.html">Diagnosing and Fixing Authentication Problems</a></p>
<p class="toc level2 tocsp"><a href="pppsvrconfig.reference-1.html">22.&nbsp;&nbsp;Solaris PPP 4.0 (Reference)</a></p>
<p class="toc level2"><a href="pppsvrconfig.convert.app-1.html">23.&nbsp;&nbsp;Migrating From Asynchronous Solaris PPP to Solaris PPP 4.0 (Tasks)</a></p>
<p class="toc level2"><a href="uucpov-1.html">24.&nbsp;&nbsp;UUCP (Overview)</a></p>
<p class="toc level2"><a href="uucptasks-1.html">25.&nbsp;&nbsp;Administering UUCP (Tasks)</a></p>
<p class="toc level2"><a href="uucpref-1.html">26.&nbsp;&nbsp;UUCP (Reference)</a></p>
<p class="toc level1 tocsp"><a href="wwrstm.html">Part&nbsp;VI&nbsp;Working With Remote Systems Topics</a></p>
<p class="toc level2"><a href="wwrsov.html">27.&nbsp;&nbsp;Working With Remote Systems (Overview)</a></p>
<p class="toc level2"><a href="wuftp-17.html">28.&nbsp;&nbsp;Administering the FTP Server (Tasks)</a></p>
<p class="toc level2"><a href="remotehowtoaccess-99941.html">29.&nbsp;&nbsp;Accessing Remote Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="netmonitortm-1.html">Part&nbsp;VII&nbsp;Monitoring Network Services Topics</a></p>
<p class="toc level2"><a href="netmonitor-1.html">30.&nbsp;&nbsp;Monitoring Network Performance (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="ppp.trouble-16"></a><h3>Tools for Troubleshooting PPP</h3>
<p><a name="indexterm-1911"></a><a name="indexterm-1912"></a>PPP links generally have three major areas of failure:</p>
<ul><li><p>Failure of the link to be established</p></li>
<li><p>Poor performance of the link during regular usage</p></li>
<li><p>Problems that can be traced to the networks on either side of the link</p></li></ul>
<p>The easiest way to find out if PPP works is to run a
command over the link. Run a command  such as <tt>ping</tt> or <tt>traceroute</tt>
to a host on the peer's network. Then observe the results. However, you should use
PPP and UNIX debugging tools to monitor performance of an established link  or
to troubleshoot a problematic link.</p><p>This section explains how to obtain diagnostic information from <tt>pppd</tt> and its associated log
files. The remaining sections in this chapter describe common problems with PPP that you
can discover and fix with the aid of the PPP troubleshooting tools.</p>

<a name="ppp.trouble-10"></a><h4>How to Obtain Diagnostic Information From <tt>pppd</tt></h4><a name="indexterm-1913"></a><a name="indexterm-1914"></a><p>The next procedure shows how to view the current operation of a link on
the local machine.</p><ol>
<li><a name="ppp.trouble-step-67"></a><b>Become superuser on the local machine or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>. To configure a
role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="ppp.trouble-step-12"></a><b><a name="indexterm-1915"></a><a name="indexterm-1916"></a><a name="indexterm-1917"></a><a name="indexterm-1918"></a><a name="indexterm-1919"></a><a name="indexterm-1920"></a>Run <tt>pppd</tt> with the serial device configured for PPP as the argument:</b><pre># <tt><b>pppd</b></tt> <tt><b>cua/b</b></tt> <tt><b>debug updetach</b></tt></pre><p>The next examples show the resulting displays for a dial-up link and a leased-line
link when <tt>pppd</tt> runs in the foreground. If you run <tt>pppd debug</tt> in the
background, the output that is produced is sent to the <tt>/etc/ppp/connect-errors</tt> file. </p></li></ol><a name="ppp.trouble-ex-17"></a>Example&nbsp;21-1 Output From a Properly Operating Dial-up Link<pre># <tt><b>pppd /dev/cua/b debug updetach</b></tt>
have route to 0.0.0.0/0.0.0.0 via 172.21.0.4
serial speed set to 230400 bps
Using interface sppp0
Connect: sppp0 &lt;--> /dev/cua/b
sent [LCP ConfReq id=0x7b &lt;asyncmap 0x0> &lt;magic 0x73e981c8> &lt;pcomp> &lt;accomp>]
rcvd [LCP Ident id=0x79 magic=0x0 "ppp-2.4.0b1 (Sun Microsystems, Inc., Oct  6 
    2004 09:36:22)"]
Peer Identification: ppp-2.4.0b1 (Sun Microsystems, Inc., Oct  6 2004 09:36:22)
    rcvd [LCP ConfRej id=0x7b &lt;asyncmap 0x0>]
sent [LCP Ident id=0x7c magic=0x0 "ppp-2.4.0b1 (Sun Microsystems, Inc., Sep 15 
    2004 09:38:33)"
sent [LCP ConfReq id=0x7d &lt;magic 0x73e981c8> &lt;pcomp> &lt;accomp>]
rcvd [LCP ConfAck id=0x7d &lt;magic 0x73e981c8> &lt;pcomp> &lt;accomp>]
rcvd [LCP ConfAck id=0x78 &lt;magic 0xdd4ad820> &lt;pcomp> &lt;accomp>]
sent [LCP ConfAck id=0x78 &lt;magic 0xdd4ad820> &lt;pcomp> &lt;accomp>]
sent [LCP Ident id=0x7e magic=0x73e981c8 "ppp-2.4.0b1 (Sun Microsystems, Inc., 
    Sep 15 2004 09:38:33)"]
sent [IPCP ConfReq id=0x3d &lt;addr 0.0.0.0> &lt;compress VJ 0f 01>]
rcvd [LCP Ident id=0x7a magic=0xdd4ad820 "ppp-2.4.0b1 (Sun Microsystems, Inc., 
    Oct  6 2004 09:36:22)"]
Peer Identification: ppp-2.4.0b1 (Sun Microsystems, Inc., Oct  6 2004 09:36:22)
rcvd [IPCP ConfReq id=0x92 &lt;addr 10.0.0.1> &lt;compress VJ 0f 01>
sent [IPCP ConfAck id=0x92 &lt;addr 10.0.0.1> &lt;compress VJ 0f 01>
rcvd [IPCP ConfNak id=0x3d &lt;addr 10.0.0.2>]]
sent [IPCP ConfReq id=0x3e &lt;addr 10.0.0.2> &lt;compress VJ 0f 01>]
rcvd [IPCP ConfAck id=0x3e &lt;addr 10.0.0.2> &lt;compress VJ 0f 01>]
local  IP address 10.0.0.2
remote IP address 10.0.0.1</pre><a name="ppp.trouble-ex-18"></a>Example&nbsp;21-2 Output From a Properly Operating Leased-Line Link<pre># <tt><b>pppd /dev/se_hdlc1 default-asyncmap debug updetach</b></tt>
pppd 2.4.0b1 (Sun Microsystems, Inc., Oct 24 2004 07:13:18) started by root, uid 0
synchronous speed appears to be 0 bps
init option: '/etc/ppp/peers/syncinit.sh' started (pid 105122)
Serial port initialized.
synchronous speed appears to be 64000 bps
Using interface sppp0
Connect: sppp0 &lt;--> /dev/se_hdlc1
sent [LCP ConfReq id=0xe9 &lt;magic 0x474283c6>&lt;pcomp> &lt;accomp>]
rcvd [LCP ConfAck id=0xe9 &lt;magic 0x474283c6>&lt;pcomp> &lt;accomp>]
rcvd [LCP ConfReq id=0x22 &lt;magic 0x8e3a53ff>&lt;pcomp> &lt;accomp>]
sent [LCP ConfReq id=0x22 &lt;magic 0x8e3a53ff>&lt;pcomp> &lt;accomp>]
sent [LCP Ident id=0xea magic=0x474283c6 "ppp-2.4.0b1 (Sun Microsystems, Inc., Oct 
    22 2004 14:31:44)"]
sent [IPCP ConfReq id=0xf7 &lt;addr 0.0.0.0> &lt;compress VJ Of o1>]]
sent [CCP ConfReq id=0x3f &lt;deflate 15> &lt;deflate(old#) 15> &lt;bsd v1 15>]
rcvd [LCP Ident id=0x23 magic=0x8e3a53ff "ppp-2.4.0b1 (Sun Microsystems, Inc., Oct 
    22 2004 14:31:44)"]
Peer Identification: ppp-2.4.0b1 (Sun Microsystems, Inc., Oct 22 2004 14:31:44)
rcvd [IPCP ConfReq id=0x25 &lt;addr 10.0.0.1> &lt;compress VJ Of 01>]
sent [IPCP ConfAck id=0x25 &lt;addr 10.0.0.1> &lt;compress VJ Of 01>]
rcvd [CCP ConfReq id=0x3 &lt;deflate 15> &lt;deflate(old#) 15 &lt;bsd v1 15>]
sent [CCP ConfAck id=0x3 &lt;deflate 15> &lt;deflate(old#) 15 &lt;bsd v1 15>]
rcvd [IPCP ConfNak id=0xf8 &lt;addr 10.0.0.2>]
rcvd [IPCP ConfReq id=0xf7 &lt;addr 10.0.0.2> &lt;compress VJ Of 01>]
rcvd [CCP ConfAck id=0x3f &lt;deflate 15> &lt;deflate(old#) 15 &lt;bsd v1 15>]
Deflate (15) compression enabled
rcvd [IPCP ConfAck id=0xf8 &lt;addr 10.0.0.2> &lt;compress VJ Of 01>]
local  IP address 10.0.0.2
remote IP address 10.0.0.1</pre>

<a name="ppp.trouble-21"></a><h4>How to Turn on PPP Debugging</h4><p><a name="indexterm-1921"></a><a name="indexterm-1922"></a><a name="indexterm-1923"></a><a name="indexterm-1924"></a><a name="indexterm-1925"></a><a name="indexterm-1926"></a>The next task shows how to use the <tt>pppd</tt> command to obtain debugging information.</p>
<hr><p><b>Note - </b>You only need to perform step 1 through step 3 once for each host.
Thereafter, you can proceed to step 4 to turn on debugging for the host.</p>
<hr>
<ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.
To configure a role with the Primary Administrator profile, see <a href="http://docs.sun.com/doc/819-2379/smcover-1?a=view">Chapter 2, Working With the Solaris Management Console (Tasks), in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><a name="ppp.trouble-step-68"></a><b>Create a log file to hold output from <tt>pppd</tt>.</b><pre># <tt><b>touch</b></tt> <tt>/var/log/pppdebug</tt></pre></li>
<li><a name="ppp.trouble-step-30"></a><b>Add the following <tt>syslog</tt> facilities for <tt>pppd</tt> in <tt>/etc/syslog.conf</tt>.</b><pre><tt><b>daemon.debug;local2.debug /var/log/pppdebug</b></tt></pre></li>
<li><a name="ppp.trouble-step-31"></a><b>Restart <tt>syslogd</tt>.</b><pre># <tt><b>pkill -HUP -x syslogd</b></tt></pre></li>
<li><a name="ppp.trouble-step-24"></a><b>Turn on debugging for calls to a particular peer by using the following syntax of
<tt>pppd</tt>.</b><pre># <tt><b>pppd debug call</b></tt> <i>peer-name</i> </pre><p><i>peer-name</i> must be the name of a file in the <tt>/etc/ppp/peers</tt> directory.</p></li>
<li><a name="ppp.trouble-step-23"></a><b>View the contents of the log file.</b><pre># <tt><b>tail -f</b></tt> <tt>/var/log/pppdebug</tt></pre><p>For an example of a log file, see <a href="ppp.trouble-6.html#ppp.trouble-step-59">Step&nbsp;3</a>.</p></li></ol>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="pppsvrconfig.troubleshoot-2.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ppp.trouble-6.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

