<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Monitoring Network Performance - System Administration Guide: Network Services</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-02-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">System Administration Guide: Network Services</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="netmonitor-1.html">Previous</a>
             </td>
             <td align="right">
                 <a href="glossary-1.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="netservices-1.html">Part&nbsp;I&nbsp;Network Services Topics</a></p>
<p class="toc level2"><a href="nsov-1.html">1.&nbsp;&nbsp;Network Service (Overview)</a></p>
<p class="toc level2"><a href="nca-1.html">2.&nbsp;&nbsp;Managing Web Cache Servers</a></p>
<p class="toc level2"><a href="time-1.html">3.&nbsp;&nbsp;Time-Related Services</a></p>
<p class="toc level1 tocsp"><a href="rfstm-1.html">Part&nbsp;II&nbsp;Accessing Network File Systems Topics</a></p>
<p class="toc level2"><a href="rfsintro-2.html">4.&nbsp;&nbsp;Managing Network File Systems (Overview)</a></p>
<p class="toc level2"><a href="rfsadmin-8.html">5.&nbsp;&nbsp;Network File System Administration (Tasks)</a></p>
<p class="toc level2"><a href="rfsrefer-1.html">6.&nbsp;&nbsp;Accessing Network File Systems (Reference)</a></p>
<p class="toc level1 tocsp"><a href="slptm.html">Part&nbsp;III&nbsp;SLP Topics</a></p>
<p class="toc level2"><a href="slparch-16.html">7.&nbsp;&nbsp;SLP (Overview)</a></p>
<p class="toc level2"><a href="slp.setup-10.html">8.&nbsp;&nbsp;Planning and Enabling SLP (Tasks)</a></p>
<p class="toc level2"><a href="ch.configuration-6.html">9.&nbsp;&nbsp;Administering SLP (Tasks)</a></p>
<p class="toc level2"><a href="legacy-7.html">10.&nbsp;&nbsp;Incorporating Legacy Services</a></p>
<p class="toc level2"><a href="slpreference.html">11.&nbsp;&nbsp;SLP (Reference)</a></p>
<p class="toc level1 tocsp"><a href="mailtm-1.html">Part&nbsp;IV&nbsp;Mail Services Topics</a></p>
<p class="toc level2"><a href="mailintro-1.html">12.&nbsp;&nbsp;Mail Services (Overview)</a></p>
<p class="toc level2"><a href="mailadmin-1.html">13.&nbsp;&nbsp;Mail Services (Tasks)</a></p>
<p class="toc level2"><a href="mailrefer-1.html">14.&nbsp;&nbsp;Mail Services (Reference)</a></p>
<p class="toc level1 tocsp"><a href="modemtm-1.html">Part&nbsp;V&nbsp;Serial Networking Topics</a></p>
<p class="toc level2"><a href="pppsvrconfig.intro-1.html">15.&nbsp;&nbsp;Solaris PPP 4.0 (Overview)</a></p>
<p class="toc level2"><a href="pppsvrconfig.p2plink-1.html">16.&nbsp;&nbsp;Planning for the PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.dialin-1.html">17.&nbsp;&nbsp;Setting Up a Dial-up PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.leased-1.html">18.&nbsp;&nbsp;Setting Up a Leased-Line PPP Link (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.auth-1.html">19.&nbsp;&nbsp;Setting Up PPP Authentication (Tasks)</a></p>
<p class="toc level2"><a href="ppp.pppoe-1.html">20.&nbsp;&nbsp;Setting Up a PPPoE Tunnel (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.troubleshoot-1.html">21.&nbsp;&nbsp;Fixing Common PPP Problems (Tasks)</a></p>
<p class="toc level2"><a href="pppsvrconfig.reference-1.html">22.&nbsp;&nbsp;Solaris PPP 4.0 (Reference)</a></p>
<p class="toc level2"><a href="pppsvrconfig.convert.app-1.html">23.&nbsp;&nbsp;Migrating From Asynchronous Solaris PPP to Solaris PPP 4.0 (Tasks)</a></p>
<p class="toc level2"><a href="uucpov-1.html">24.&nbsp;&nbsp;UUCP (Overview)</a></p>
<p class="toc level2"><a href="uucptasks-1.html">25.&nbsp;&nbsp;Administering UUCP (Tasks)</a></p>
<p class="toc level2"><a href="uucpref-1.html">26.&nbsp;&nbsp;UUCP (Reference)</a></p>
<p class="toc level1 tocsp"><a href="wwrstm.html">Part&nbsp;VI&nbsp;Working With Remote Systems Topics</a></p>
<p class="toc level2"><a href="wwrsov.html">27.&nbsp;&nbsp;Working With Remote Systems (Overview)</a></p>
<p class="toc level2"><a href="wuftp-17.html">28.&nbsp;&nbsp;Administering the FTP Server (Tasks)</a></p>
<p class="toc level2"><a href="remotehowtoaccess-99941.html">29.&nbsp;&nbsp;Accessing Remote Systems (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="netmonitortm-1.html">Part&nbsp;VII&nbsp;Monitoring Network Services Topics</a></p>
<p class="toc level2"><a href="netmonitor-1.html">30.&nbsp;&nbsp;Monitoring Network Performance (Tasks)</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Monitoring Network Performance</a></p>
</div>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="netmonitor-2"></a><h3>Monitoring Network Performance</h3>
<p><a name="spnetwork-ix4867"></a><a name="spnetwork-ix4868"></a><a name="spnetwork-ix4869"></a><a name="spnetwork-ix4871"></a><a name="spnetwork-ix4872"></a><a name="spnetwork-ix4873"></a><a name="spnetwork-ix4870"></a><a name="spnetwork-ix4874"></a><a name="spnetwork-ix4875"></a><a name="spnetwork-ix4876"></a><a name="spnetwork-ix4877"></a><a name="spnetwork-ix4878"></a><a name="spnetwork-ix4879"></a><a name="spnetwork-ix4882"></a><a name="spnetwork-ix4883"></a><a name="spnetwork-ix4884"></a><a name="spnetwork-ix4880"></a><a name="spnetwork-ix4881"></a><a href="#netmonitor-3">Table&nbsp;30-1</a> describes the commands that are available for monitoring network performance.   
         </p><a name="netmonitor-3"></a><h6>Table&nbsp;30-1 Network Monitoring Commands</h6><table><col width="64.37*"><col width="294.63*"><tr><th align="left" valign="top" scope="column"><p>Command</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>ping</tt></p></td>
<td align="left" valign="top" scope="row"><p>Look at the
response of hosts on the network.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>spray</tt></p></td>
<td align="left" valign="top" scope="row"><p>Test the reliability of your packet sizes.
This command can tell you whether the network is delaying packets or dropping
packets.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>snoop</tt></p></td>
<td align="left" valign="top" scope="row"><p>Capture packets from the network and trace the calls from each client to
each server.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>netstat</tt></p></td>
<td align="left" valign="top" scope="row"><p>Display network status, including state of the interfaces that are used for
TCP/IP traffic, the IP routing table, and the per-protocol statistics for <tt>UDP</tt>, <tt>TCP</tt>,
<tt>ICMP</tt>, and <tt>IGMP</tt>.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>nfsstat</tt></p></td>
<td align="left" valign="top" scope="row"><p>Display a summary of server and client statistics that can be
used to identify NFS problems.</p></td>
</tr>
</table>

<a name="netmonitor-4"></a><h4>How to Check the Response of Hosts on the Network</h4>
<p><a name="spnetwork-ix4885"></a><a name="spnetwork-ix4886"></a>Check the response of hosts on the network with the <tt>ping</tt> command.</p><pre>$ <tt><b>ping</b></tt> <i>hostname</i></pre><p><a name="spnetwork-ix4887"></a><a name="spnetwork-ix4888"></a><a name="spnetwork-ix4889"></a><a name="spnetwork-ix4890"></a><a name="spnetwork-ix4891"></a>If you suspect a physical problem, you can use <tt>ping</tt> to find
the response time of several hosts on the network. If the response from
one host is not what you would expect, you can investigate that host.
Physical problems could be caused by the following:</p>
<ul><li><p>Loose cables or connectors</p></li>
<li><p>Improper grounding</p></li>
<li><p>No termination</p></li>
<li><p><a name="spnetwork-ix4892"></a><a name="spnetwork-ix4893"></a><a name="spnetwork-ix4894"></a><a name="spnetwork-ix4895"></a>Signal reflection </p></li></ul>
<p>For more information about this command, see <a href="http://docs.sun.com/doc/819-2240/ping-1m?a=view"><tt>ping</tt>(1M)</a>.</p><a name="netmonitor-5"></a>Example&nbsp;30-1 Checking the Response of Hosts on the Network<p><a name="spnetwork-ix4896"></a><a name="spnetwork-ix4897"></a>The simplest version of <tt>ping</tt> sends a single packet to a host on
the network. If <tt>ping</tt> receives the correct response, the command prints the message
<i>host</i> <tt>is alive</tt>.  </p><pre>$ <tt><b>ping elvis</b></tt>
elvis is alive</pre><p>With the <tt>-s</tt> option, <tt>ping</tt> sends one datagram per second to a host.
The command then prints each response and the time that was required for
the round trip. An example follows.</p><pre>$ <tt><b>ping -s pluto</b></tt>
64 bytes from pluto (123.456.78.90): icmp_seq=0. time=3.82 ms
64 bytes from pluto (123.456.78.90): icmp_seq=5. time=0.947 ms
64 bytes from pluto (123.456.78.90): icmp_seq=6. time=0.855 ms
^C
----pluto PING Statistics----
3 packets transmitted, 3 packets received, 0% packet loss
 
round-trip (ms) min/avg/max/sttdev = 0.855/1.87/3.82/1.7</pre>

<a name="netmonitor-6"></a><h4>How to Send Packets to Hosts on the Network</h4>
<p><a name="spnetwork-ix4898"></a><a name="spnetwork-ix4899"></a><a name="spnetwork-ix4900"></a><a name="spnetwork-ix4901"></a>Test the reliability of your packet sizes with the <tt>spray</tt> command. 
  </p><pre>$ <tt><b>spray</b></tt> [ -c <i>count</i> -d <i>interval</i> -l <i>packet-size</i>] <i>hostname</i></pre><dl><dt><tt>-i</tt> <i>count</i></dt>
<dd><p>Number of packets to send.</p></dd>
<dt><tt>-d</tt> <i>interval</i></dt>
<dd><p>Number of microseconds to pause between sending packets. If you do not use a delay, you might deplete the buffers.</p></dd>
<dt><tt>-l</tt> <i>packet-size</i></dt>
<dd><p>Is the packet size.</p></dd>
<dt><i>hostname</i></dt>
<dd><p>Is the system to send packets.</p></dd>
</dl>
<p>For more information about this command, see <a href="http://docs.sun.com/doc/819-2240/spray-1m?a=view"><tt>spray</tt>(1M)</a>.</p><a name="netmonitor-7"></a>Example&nbsp;30-2 Sending Packets to Hosts on the Network<p>The following example sends 100 packets to a host (<tt>-c 100</tt>), with a
packet size of 2048 bytes (<tt>-l 2048</tt>). The packets are sent with a delay
time of 20 microseconds between each burst (<tt>-d 20</tt>). </p><pre>$ <tt><b>spray -c 100 -d 20 -l 2048 pluto</b></tt>
sending 100 packets of length 2048 to pluto ...
no packets dropped by pluto
279 packets/sec, 573043 bytes/sec</pre>

<a name="netmonitor-8"></a><h4>How to Capture Packets From the Network</h4>
<p><a name="spnetwork-ix4902"></a><a name="spnetwork-ix4903"></a><a name="spnetwork-ix4904"></a><a name="spnetwork-ix4905"></a><a name="spnetwork-ix4906"></a><a name="spnetwork-ix4907"></a>To capture packets from the network and trace the calls from each client
to each server, use <tt>snoop</tt>. This command provides accurate timestamps that enable some
network performance problems to be isolated quickly. For more information, see <a href="http://docs.sun.com/doc/819-2240/snoop-1m?a=view"><tt>snoop</tt>(1M)</a>.</p><pre># <tt><b>snoop</b></tt></pre><p><a name="spnetwork-ix4908"></a>Dropped packets could be caused by insufficient buffer space or an overloaded CPU.
</p>

<a name="netmonitor-9"></a><h4>How to Check the Network Status</h4>
<p><a name="spnetwork-ix4909"></a><a name="spnetwork-ix4910"></a><a name="spnetwork-ix4911"></a><a name="spnetwork-ix4912"></a><a name="spnetwork-ix4913"></a><a name="spnetwork-ix4914"></a><a name="spnetwork-ix4915"></a>To display network status information, such as statistics about the state of network
interfaces, routing tables, and various protocols, use the <tt>netstat</tt> command.</p><pre>$ <tt><b>netstat</b></tt> [-i] [-r] [-s]</pre><dl><dt><tt>-i</tt></dt>
<dd><p>Displays the state of the TCP/IP interfaces</p></dd>
<dt><tt>-r</tt></dt>
<dd><p>Displays the IP routing table</p></dd>
<dt><tt>-s</tt></dt>
<dd><p>Displays statistics for the <tt>UDP</tt>, <tt>TCP</tt>, <tt>ICMP</tt>, and <tt>IGMP</tt> protocols</p></dd>
</dl>
<p>For more information, see <a href="http://docs.sun.com/doc/819-2240/netstat-1m?a=view"><tt>netstat</tt>(1M)</a>.</p>

<a name="netmonitor-10"></a><h5>Examples&ndash;Checking the Network Status</h5>
<p>The following example shows output from the <tt>netstat -i</tt> command, which displays the
state of the interfaces that are used for TCP/IP traffic. </p><pre>$ <tt><b>netstat -i</b></tt>
Name  Mtu  Net/Dest    Address      Ipkts  Ierrs Opkts  Oerrs Collis Queue
lo0   8232 software    localhost     1280   0     1280     0       0    0
eri0   1500 loopback    venus      1628480   0   347070    16   39354    0</pre><p><a name="spnetwork-ix4916"></a>This display shows the number of packets that a machine has transmitted and
has received on each interface. A machine with active network traffic should show
both <tt>Ipkts</tt> and <tt>Opkts</tt> continually increasing. </p><p><a name="spnetwork-ix4917"></a><a name="spnetwork-ix4918"></a>Calculate the network collisions rate by dividing the number of collision counts (<tt>Collis</tt>)
by the number of out packets (<tt>Opkts</tt>). In the previous example, the collision rate
is 11 percent. A network-wide collision rate that is greater than 5 to
10 percent can indicate a problem.  </p><p><a name="spnetwork-ix4920"></a><a name="spnetwork-ix4925"></a><a name="spnetwork-ix4926"></a>Calculate the error rate for the input packets by dividing the number of
input errors by the total number of input packets (<tt>Ierrs/Ipkts</tt>). The error rate
for the output packets is the number of output errors divided by the
total number of output packets (<tt>Oerrs/Opkts</tt>). If the input error rate is high, at
over 0.25 percent, the host might be dropping packets.    
 </p><p><a name="spnetwork-ix4927"></a><a name="spnetwork-ix4928"></a><a name="spnetwork-ix4929"></a><a name="spnetwork-ix4930"></a><a name="spnetwork-ix4931"></a>The following example shows output from the <tt>netstat -s</tt>  command, which displays
the per-protocol statistics for the <tt>UDP</tt>, <tt>TCP</tt>, <tt>ICMP</tt>, and <tt>IGMP</tt> protocols.</p><pre>UDP
    udpInDatagrams      =196543    udpInErrors         =     0
    udpOutDatagrams     =187820
 
TCP
    tcpRtoAlgorithm     =     4    tcpRtoMin           =   200
    tcpRtoMax           = 60000    tcpMaxConn          =    -1
    tcpActiveOpens      = 26952    tcpPassiveOpens     =   420
    tcpAttemptFails     =  1133    tcpEstabResets      =     9
    tcpCurrEstab        =    31    tcpOutSegs          =3957636
    tcpOutDataSegs      =2731494   tcpOutDataBytes     =1865269594
    tcpRetransSegs      = 36186    tcpRetransBytes     =3762520
    tcpOutAck           =1225849   tcpOutAckDelayed    =165044
    tcpOutUrg           =     7    tcpOutWinUpdate     =   315
    tcpOutWinProbe      =     0    tcpOutControl       = 56588
    tcpOutRsts          =   803    tcpOutFastRetrans   =   741
    tcpInSegs           =4587678
    tcpInAckSegs        =2087448   tcpInAckBytes       =1865292802
    tcpInDupAck         =109461    tcpInAckUnsent      =     0
    tcpInInorderSegs    =3877639   tcpInInorderBytes   =-598404107
    tcpInUnorderSegs    = 14756    tcpInUnorderBytes   =17985602
    tcpInDupSegs        =    34    tcpInDupBytes       = 32759
    tcpInPartDupSegs    =   212    tcpInPartDupBytes   =134800
    tcpInPastWinSegs    =     0    tcpInPastWinBytes   =     0
    tcpInWinProbe       =   456    tcpInWinUpdate      =     0
    tcpInClosed         =    99    tcpRttNoUpdate      =  6862
    tcpRttUpdate        =435097    tcpTimRetrans       = 15065
    tcpTimRetransDrop   =    67    tcpTimKeepalive     =   763
    tcpTimKeepaliveProbe=     1    tcpTimKeepaliveDrop =     0

IP
    ipForwarding        =     2    ipDefaultTTL        =   255
    ipInReceives        =11757234  ipInHdrErrors       =     0
    ipInAddrErrors      =     0    ipInCksumErrs       =     0
    ipForwDatagrams     =     0    ipForwProhibits     =     0
    ipInUnknownProtos   =     0    ipInDiscards        =     0
    ipInDelivers        =4784901   ipOutRequests       =4195180
    ipOutDiscards       =     0    ipOutNoRoutes       =     0
    ipReasmTimeout      =    60    ipReasmReqds        =  8723
    ipReasmOKs          =  7565    ipReasmFails        =  1158
    ipReasmDuplicates   =     7    ipReasmPartDups     =     0
    ipFragOKs           = 19938    ipFragFails         =     0
    ipFragCreates       =116953    ipRoutingDiscards   =     0
    tcpInErrs           =     0    udpNoPorts          =6426577
    udpInCksumErrs      =     0    udpInOverflows      =   473
    rawipInOverflows    =     0

ICMP
    icmpInMsgs          =490338    icmpInErrors        =     0
    icmpInCksumErrs     =     0    icmpInUnknowns      =     0
    icmpInDestUnreachs  =   618    icmpInTimeExcds     =   314
    icmpInParmProbs     =     0    icmpInSrcQuenchs    =     0
    icmpInRedirects     =   313    icmpInBadRedirects  =     5
    icmpInEchos         =   477    icmpInEchoReps      =    20
    icmpInTimestamps    =     0    icmpInTimestampReps =     0
    icmpInAddrMasks     =     0    icmpInAddrMaskReps  =     0
    icmpInFragNeeded    =     0    icmpOutMsgs         =   827
    icmpOutDrops        =   103    icmpOutErrors       =     0
    icmpOutDestUnreachs =    94    icmpOutTimeExcds    =   256
    icmpOutParmProbs    =     0    icmpOutSrcQuenchs   =     0
    icmpOutRedirects    =     0    icmpOutEchos        =     0
    icmpOutEchoReps     =   477    icmpOutTimestamps   =     0
    icmpOutTimestampReps=     0    icmpOutAddrMasks    =     0
    icmpOutAddrMaskReps =     0    icmpOutFragNeeded   =     0
    icmpInOverflows     =     0

IGMP:
        0 messages received
        0 messages received with too few bytes
        0 messages received with bad checksum
        0 membership queries received
        0 membership queries received with invalid field(s)
        0 membership reports received
        0 membership reports received with invalid field(s)
        0 membership reports received for groups to which we belong
        0 membership reports sent</pre><p><a name="spnetwork-ix4932"></a><a name="spnetwork-ix4933"></a><a name="spnetwork-ix4934"></a>The following example shows output from the <tt>netstat</tt>  <tt>-r</tt> command, which
displays the IP routing table.   </p><pre>Routing Table:
  Destination        Gateway           Flags  Ref   Use    Interface
------------------ -------------------- ----- ----- ------ ---------
localhost            localhost             UH       0   2817  lo0
earth-bb             pluto                 U        3  14293  eri0
224.0.0.0            pluto                 U        3      0  eri0
default              mars-gate             UG       0  14142  
 </pre><p><a name="spnetwork-ix4939"></a><a name="spnetwork-ix4940"></a>The fields in the <tt>netstat</tt> <tt>-r</tt> report are described in <a href="#netmonitor-11">Table&nbsp;30-2</a>. </p><a name="netmonitor-11"></a><h6>Table&nbsp;30-2 Output From the <tt>netstat</tt> <tt>-r</tt> Command</h6><table><col width="87*"><col width="54*"><col width="216*"><tr><th align="left" valign="top" scope="column"><p>Field Name</p></th>
<th align="left" valign="top" scope="column"><p></p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>Flags</tt>
</p></td>
<td align="left" valign="top" scope="row"><p><tt>U</tt></p><p><tt>G</tt></p><p><tt>H</tt></p><p><tt>D</tt></p></td>
<td align="left" valign="top" scope="row"><p>The route is up.</p><p>The route is through a gateway.</p><p>The route is to
a host.</p><p>The route was dynamically created by using a redirect.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>Ref</tt> </p></td>
<td align="left" valign="top" scope="row"><p></p></td>
<td align="left" valign="top" scope="row"><p>Shows the
current number of routes that share the same link layer.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>Use</tt> </p></td>
<td align="left" valign="top" scope="row"><p></p></td>
<td align="left" valign="top" scope="row"><p>Indicates the number
of packets that were sent out.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>Interface</tt> </p></td>
<td align="left" valign="top" scope="row"><p></p></td>
<td align="left" valign="top" scope="row"><p>Lists the network interface that is
used for the route. </p></td>
</tr>
</table>

<a name="netmonitor-12"></a><h4>How to Display NFS Server and Client Statistics</h4>
<p>The NFS distributed file service uses a remote procedure call (RPC) facility that
translates local commands into requests for the remote host. The remote procedure calls
are synchronous. The client application is blocked or suspended until the server has completed
the call and has returned the results. One of the major factors that
affects NFS performance is the retransmission rate. </p><p><a name="spnetwork-ix4941"></a><a name="spnetwork-ix4942"></a>If the file server cannot respond to a client's request, the client retransmits
the request a specified number of times before the client quits. Each retransmission
imposes system overhead and increases network traffic. Excessive retransmissions can cause network performance problems.
If the retransmission rate is high, you could look for the following:</p>
<ul><li><p>Overloaded servers that complete requests too slowly</p></li>
<li><p>An Ethernet interface that is dropping packets</p></li>
<li><p><a name="spnetwork-ix4943"></a><a name="spnetwork-ix4944"></a>Network congestion, which slows the packet transmission  </p></li></ul>
<p><a href="#netmonitor-13">Table&nbsp;30-3</a> describes the <tt>nfsstat</tt> options to display client and server statistics.</p><a name="netmonitor-13"></a><h6>Table&nbsp;30-3 Commands for Displaying Client/Server Statistics</h6><table><col width="108*"><col width="251*"><tr><th align="left" valign="top" scope="column"><p>Command</p></th>
<th align="left" valign="top" scope="column"><p>Display</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>nfsstat -c</tt></p></td>
<td align="left" valign="top" scope="row"><p>Client statistics</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>nfsstat -s</tt></p></td>
<td align="left" valign="top" scope="row"><p>Server statistics</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>netstat -m</tt></p></td>
<td align="left" valign="top" scope="row"><p>Network statistics
for each file system</p></td>
</tr>
</table><p><a name="spnetwork-ix4945"></a><a name="spnetwork-ix4946"></a><a name="spnetwork-ix4947"></a><a name="spnetwork-ix4948"></a><a name="spnetwork-ix4949"></a><a name="spnetwork-ix4950"></a><a name="spnetwork-ix4951"></a><a name="spnetwork-ix4952"></a><a name="spnetwork-ix4953"></a>Use <tt>nfsstat -c</tt> to show client statistics, and <tt>nfsstat -s</tt> to show server statistics. Use
<tt>netstat -m</tt> to display network statistics for each file system. For more information, see
<a href="http://docs.sun.com/doc/819-2240/nfsstat-1m?a=view"><tt>nfsstat</tt>(1M)</a>.         </p>

<a name="netmonitor-14"></a><h5>Examples&ndash;Displaying NFS Server and Client Statistics</h5>
<p><a name="spnetwork-ix4954"></a><a name="spnetwork-ix4955"></a><a name="spnetwork-ix4956"></a>The following example displays RPC and NFS data for the client <tt>pluto</tt>. 
 </p><pre>$ <tt><b>nfsstat -c</b></tt>

Client rpc:
Connection oriented:
calls    badcalls  badxids  timeouts newcreds  badverfs   timers     
1595799  1511      59       297      0         0          0          
cantconn nomem     interrupts 
1198      0         7          
Connectionless:
calls    badcalls  retrans  badxids  timeouts  newcreds   badverfs   
80785    3135      25029    193      9543      0          0          
timers   nomem     cantsend   
17399    0         0          

Client nfs:
calls    badcalls  clgets   cltoomany  
1640097  3112      1640097  0          
Version 2: (46366 calls)
null     getattr   setattr  root     lookup     readlink  read       
0 0%     6589 14%  2202 4%  0 0%     11506 24%  0 0%      7654 16%   
wrcache  write     create   remove   rename     link      symlink    
0 0%     13297 28% 1081 2%  0 0%     0 0%       0 0%      0 0%       
mkdir    rmdir     readdir  statfs     
24 0%    0 0%      906 1%   3107 6%    
Version 3: (1585571 calls)
null    getattr    setattr  lookup     access     readlink  read     
0 0%    508406 32% 10209 0% 263441 16% 400845 25% 3065 0%  117959 7%
write    create     mkdir    symlink    mknod    remove   rmdir 
69201 4% 7615 0%    42 0%    16 0%      0 0%     7875 0%  51 0%      
rename   link       readdir  readdir+   fsstat   fsinfo   pathconf   
929 0%   597 0%     3986 0%  185145 11% 942 0%   300 0%   583 0%     
commit     
4364 0%    
 
Client nfs_acl:
Version 2: (3105 calls)
null       getacl     setacl     getattr    access     
0 0%       0 0%       0 0%       3105 100%  0 0%       
Version 3: (5055 calls)
null       getacl     setacl     
0 0%       5055 100%  0 0%    </pre><p>The output of the <tt>nfsstat -c</tt> command is described in <a href="#netmonitor-15">Table&nbsp;30-4</a>.</p><a name="netmonitor-15"></a><h6>Table&nbsp;30-4 Output From the <tt>nfsstat -c</tt> Command</h6><table><col width="66.72*"><col width="292.28*"><tr><th align="left" valign="top" scope="column"><p>Field</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>calls</tt></p></td>
<td align="left" valign="top" scope="row"><p>The total number of
calls that were sent.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>badcalls</tt></p></td>
<td align="left" valign="top" scope="row"><p>The total number of calls that were rejected by
RPC.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>retrans</tt></p></td>
<td align="left" valign="top" scope="row"><p>The total number of retransmissions. For this client, the number of retransmissions is
less than 1 percent, or approximately 10 timeouts out of 6888 calls. These
retransmissions might be caused by temporary failures. Higher rates might indicate a problem.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>badxid</tt></p></td>
<td align="left" valign="top" scope="row"><p>The
number of times that a duplicate acknowledgment was received for a single NFS
request.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>timeout</tt></p></td>
<td align="left" valign="top" scope="row"><p>The number of calls that timed out.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>wait</tt> </p></td>
<td align="left" valign="top" scope="row"><p>The number of times a
call had to wait because no client handle was available.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>newcred</tt> </p></td>
<td align="left" valign="top" scope="row"><p>The number of
times the authentication information had to be refreshed.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>timers</tt> </p></td>
<td align="left" valign="top" scope="row"><p>The number of times the
time-out value was greater than or equal to the specified time-out value for
a call.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>readlink</tt> </p></td>
<td align="left" valign="top" scope="row"><p>The number of times a <tt>read</tt> was made to a symbolic
link. If this number is high, at over 10 percent, then there could
be too many symbolic links.</p></td>
</tr>
</table><p>The following example shows output from the <tt>nfsstat -m</tt> command.</p><pre>pluto$ <tt><b>nfsstat -m</b></tt>
/usr/man from pluto:/export/svr4/man
Flags: vers=2,proto=udp,auth=unix,hard,intr,dynamic,
        rsize=8192, wsize=8192,retrans=5
 Lookups: srtt=13 (32ms), dev=10 (50ms), cur=6 (120ms)
 All:     srtt=13 (32ms), dev=10 (50ms), cur=6 (120ms)</pre><p>This output of the <tt>nfsstat -m</tt> command, which is displayed in milliseconds, is described
in <a href="#netmonitor-16">Table&nbsp;30-5</a>.</p><a name="netmonitor-16"></a><h6>Table&nbsp;30-5 Output From the <tt>nfsstat -m</tt> Command</h6><table><col width="107*"><col width="252*"><tr><th align="left" valign="top" scope="column"><p>Field</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>srtt</tt> </p></td>
<td align="left" valign="top" scope="row"><p>The smoothed average of the round-trip times</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>dev</tt></p></td>
<td align="left" valign="top" scope="row"><p>The average deviations</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>cur</tt></p></td>
<td align="left" valign="top" scope="row"><p>The current
&ldquo;expected&rdquo; response time</p></td>
</tr>
</table><p><a name="spnetwork-ix4969"></a><a name="spnetwork-ix4970"></a><a name="spnetwork-ix4971"></a><a name="spnetwork-ix4972"></a><a name="spnetwork-ix4973"></a><a name="spnetwork-ix4974"></a><a name="spnetwork-ix4975"></a><a name="spnetwork-ix4976"></a><a name="spnetwork-ix4977"></a><a name="spnetwork-ix4978"></a><a name="spnetwork-ix4979"></a>If you suspect that the hardware components of your network are creating problems,
you need to look closely at the cabling and connectors.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="netmonitor-1.html">Previous</a>
             </td>
             <td align="right">
                 <a href="glossary-1.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

