<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Creating a prototype File - Application Packaging Developer's Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-09-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">Application Packaging Developer's Guide</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ch2buildpkg-26363.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ch2buildpkg-17051.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-10.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="ch1designpkg-51728.html">1.&nbsp;&nbsp;Designing  a Package</a></p>
<p class="toc level1 tocsp"><a href="ch2buildpkg-22939.html">2.&nbsp;&nbsp;Building a Package</a></p>
<p class="toc level2"><a href="ch2buildpkg-30163.html">The Process of Building a Package (Task Map)</a></p>
<p class="toc level2"><a href="ch2buildpkg-13952.html">Package Environment Variables</a></p>
<p class="toc level2"><a href="ch2buildpkg-11300.html">Creating a <tt>pkginfo</tt> File</a></p>
<p class="toc level2"><a href="ch2buildpkg-26363.html">Organizing a Package's Contents</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Creating a <tt>prototype</tt> File</a></p>
</div>
<p class="toc level2"><a href="ch2buildpkg-17051.html">Building a Package</a></p>
<p class="toc level1 tocsp"><a href="ch3enhancepkg-11350.html">3.&nbsp;&nbsp;Enhancing the Functionality of a Package (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ch4verifypkg-18395.html">4.&nbsp;&nbsp;Verifying and Transferring a Package</a></p>
<p class="toc level1 tocsp"><a href="ch5pkgcasestudies-80583.html">5.&nbsp;&nbsp;Case Studies of Package Creation</a></p>
<p class="toc level1 tocsp"><a href="ch6advtech-96543.html">6.&nbsp;&nbsp;Advanced Techniques for Creating Packages</a></p>
<p class="toc level1 tocsp"><a href="gloss-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="ch2buildpkg-16803"></a><h3>Creating a <tt>prototype</tt> File</h3>
<p><a name="indexterm-41"></a><a name="indexterm-42"></a>The <tt>prototype</tt> file is an ASCII file used to specify information about the
objects in a package. Each entry in the <tt>prototype</tt> file describes a single
object, such as a data file, directory, source file, or executable object. Entries
in a <tt>prototype</tt> file consist of several fields of information separated by
white space. Note that the fields <b>must</b> appear in a specific order. Comment lines
begin with a pound sign (#) and are ignored.</p><p><a name="indexterm-43"></a>You can create a <tt>prototype</tt> file with a text editor or by using
the <tt>pkgproto</tt> command. When you first create this file, it is probably
easier to do so with the <tt>pkgproto</tt> command, because it creates the file based
on the directory hierarchy you created previously. If you have not organized your
files as described in <a href="ch2buildpkg-26363.html">Organizing a Package's Contents</a>, you have the cumbersome task of creating
the <tt>prototype</tt> file from scratch with your favorite text editor.</p>

<a name="ch2buildpkg-10912"></a><h4>Format of the <tt>prototype</tt> File</h4>
<p><a name="indexterm-44"></a>Here is the format for each line in the <tt>prototype</tt> file:</p><pre><i>part</i><i>ftype</i><i>class</i><i>path</i><i>major</i><i>minor</i><i>mode</i><i>owner</i><i>group</i></pre><table><col width="33%"><col width="66%"><tr><td align="left" valign="top" scope="row"><p><i>part</i> </p></td>
<td align="left" valign="top" scope="row"><p>Is
an optional, numeric field that enables you to group package objects into parts.
The default value is part 1.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><i>ftype</i> </p></td>
<td align="left" valign="top" scope="row"><p>Is a one-character field that specifies
the object's type. See <a href="#ch2buildpkg-19">The ftype Field</a>.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><i>class</i> </p></td>
<td align="left" valign="top" scope="row"><p>Is the installation class to which the
object belongs. See <a href="#ch2buildpkg-21">The <i>class</i> Field</a>.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><i>path</i> </p></td>
<td align="left" valign="top" scope="row"><p>Is the absolute or relative path name indicating
where the package object will reside on the target system. See <a href="#ch2buildpkg-16793">The <i>path</i> Field</a>.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><i>major</i> </p></td>
<td align="left" valign="top" scope="row"><p>Is
the major device number for block or character special devices.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><i>minor</i> </p></td>
<td align="left" valign="top" scope="row"><p>Is the
minor device number for block or character special devices.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><i>mode</i> </p></td>
<td align="left" valign="top" scope="row"><p>Is the octal
mode of the object (for example, 0644). See <a href="#ch2buildpkg-22">The <i>mode</i> Field</a>.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><i>owner</i> </p></td>
<td align="left" valign="top" scope="row"><p>Is the owner
of the object (for example, <tt>bin</tt> or <tt>root</tt>). See <a href="#ch2buildpkg-23">The <i>owner</i> Field</a>.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><i>group</i> </p></td>
<td align="left" valign="top" scope="row"><p>Is the
group to which the object belongs (for example, <tt>bin</tt> or <tt>sys</tt>). See
<a href="#ch2buildpkg-24">The <i>group</i> Field</a>.</p></td>
</tr>
</table><p>Usually, only the <i>ftype</i>, <i>class</i>, <i>path</i>, <i>mode</i>, <i>owner</i>, and <i>group</i> fields are defined.
These fields are described in the following sections. See the <a href="http://docs.sun.com/doc/816-5174/prototype-4?a=view"><tt>prototype</tt>(4)</a> man page for
additional information on these fields.</p>

<a name="ch2buildpkg-19"></a><h5>The ftype Field</h5>
<p><a name="indexterm-45"></a>The <i>ftype</i>, or file type, field is a one-character field that specifies a
package object's file type. Valid file types are described in the following table</p><a name="ch2buildpkg-tbl-20"></a><h6>Table&nbsp;2-3 Valid File Types in the <tt>prototype</tt> File</h6><table><col width="28%"><col width="71%"><tr><th align="left" valign="top" scope="column"><p>File
type field value</p></th>
<th align="left" valign="top" scope="column"><p>File Type Description</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>f</tt> </p></td>
<td align="left" valign="top" scope="row"><p>Standard executable file or data file</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>e</tt> </p></td>
<td align="left" valign="top" scope="row"><p>File
to be edited upon installation or removal (may be shared by several
packages)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>v</tt> </p></td>
<td align="left" valign="top" scope="row"><p>Volatile file (whose contents are expected to change, such as a
log file)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>d</tt> </p></td>
<td align="left" valign="top" scope="row"><p>Directory</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>x</tt> </p></td>
<td align="left" valign="top" scope="row"><p>Exclusive directory accessible only by this package (may contain
unregistered logs or database information)</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>l</tt> </p></td>
<td align="left" valign="top" scope="row"><p>Linked file</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>p</tt> </p></td>
<td align="left" valign="top" scope="row"><p>Named pipe</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>c</tt> </p></td>
<td align="left" valign="top" scope="row"><p>Character special device</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>b</tt> </p></td>
<td align="left" valign="top" scope="row"><p>Block
special device</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>i</tt> </p></td>
<td align="left" valign="top" scope="row"><p>Information file or installation script</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>s</tt> </p></td>
<td align="left" valign="top" scope="row"><p>Symbolic link</p></td>
</tr>
</table>

<a name="ch2buildpkg-21"></a><h5>The <i>class</i> Field</h5>
<p><a name="indexterm-46"></a>The <b>class</b> field names the class to which an object belongs. Using
classes is an optional package design feature. This feature is discussed in detail
in <a href="ch3enhancepkg-10289.html#ch3enhancepkg-37319">Writing Class Action Scripts</a>. </p><p><a name="indexterm-47"></a>If you do not use classes, an object belongs to the <tt>none</tt>
class. When you execute the <tt>pkgmk</tt> command to build your package, the command
inserts the <tt>CLASSES=none</tt> parameter in the <tt>pkginfo</tt> file. Files with file type
<tt>i</tt> must have a blank <i>class</i> field.</p>

<a name="ch2buildpkg-16793"></a><h5>The <i>path</i> Field</h5>
<p><a name="indexterm-48"></a><a name="indexterm-49"></a><a name="indexterm-50"></a>The <i>path</i> field is used to define where the package object will reside
on the target system. You may indicate the location with either an absolute
path name (for example, <tt>/usr/bin/mail</tt>) or a relative path name (for example, <tt>bin/mail</tt>).
Using an absolute path name means that the object's location on the target
system is defined by the package and cannot be changed. Package objects with
relative path names indicate that the object is <b>relocatable</b>.</p><p>A <b>relocatable object</b> does not need an absolute path location on the target system.
Instead, the object's location is determined during the installation process.</p><p>All or some of a package's objects can be defined as relocatable.
Before writing any installation scripts or creating the <tt>prototype</tt> file, decide if package objects
will have fixed locations (such as start-up scripts in <tt>/etc</tt>) or be
relocatable .</p><p><a name="indexterm-51"></a><a name="indexterm-52"></a>There are two kinds of relocatable objects, <b>collectively relocatable</b> and <b>individually relocatable</b>.</p>

<a name="ch2buildpkg-33395"></a><h5>Collectively Relocatable Objects</h5>
<p><a name="indexterm-53"></a><a name="indexterm-54"></a><a name="indexterm-55"></a>Collectively relocatable objects are located relative to a common installation base called the
<b>base directory</b>. A base directory is defined in the <tt>pkginfo</tt> file, using the <tt>BASEDIR</tt>
parameter. For example, a relocatable object in the <tt>prototype</tt> file named <tt>tests/generic</tt>
requires that the <tt>pkginfo</tt> file define the default <tt>BASEDIR</tt> parameter. For example:</p><pre>BASEDIR=/opt</pre><p>This example means that when the object is installed, it will be
located in the <tt>/opt/tests/generic</tt> directory.</p>
<hr><p><b>Note - </b>The <tt>/opt</tt> directory is the only directory to which software that is not
part of the base Solaris software may be delivered.</p>
<hr>
<p>Use collectively relocatable objects whenever possible. In general, the major part of a
package can be relocatable with a few files (such as files in
<tt>/etc</tt> or <tt>/var</tt>) specified as absolute. However, if a package contains many different
relocations, consider dividing the package into multiple packages with distinct <tt>BASEDIR</tt> values in
their <tt>pkginfo</tt> files.</p>

<a name="ch2buildpkg-39047"></a><h5>Individually Relocatable Objects</h5>
<p><a name="indexterm-56"></a>Individually relocatable objects are not restricted to the same directory location as collectively relocatable
objects. To define an individually relocatable object, you need to specify an install
variable in the <i>path</i> field in the <tt>prototype</tt> file. After specifying the
install variable, create a <tt>request</tt> script to prompt the installer for the
relocatable base directory, or a <tt>checkinstall</tt> script to determine the path name from
file system data. For more information on <tt>request</tt> scripts, see <a href="ch3enhancepkg-10289.html#ch3enhancepkg-21209">Writing a <tt>request</tt> Script</a> and for
information on <tt>checkinstall</tt> scripts, see <a href="ch3enhancepkg-10289.html#ch3enhancepkg-120">How to Gather File System Data</a>.</p>
<hr><p><b>Caution - </b>Individually relocatable objects are difficult to manage. Use of individually relocatable objects might
result in widely scattered package components that are difficult to isolate when installing
multiple versions or architectures of the package. Use collectively relocatable objects whenever possible.</p>
<hr>


<a name="ch2buildpkg-55"></a><h5>Parametric Path Names</h5>
<p><a name="indexterm-57"></a>A <b>parametric path name</b> is a path name that includes a variable specification. For example,
<tt>/opt/$PKGINST/</tt><i>filename</i> is a parametric path name because of the <tt>$PKGINST</tt> variable specification.
A default value for the variable specification <b>must</b> be defined in the
<tt>pkginfo</tt> file. The value may then be changed by a <tt>request</tt> script or
a <tt>checkinstall</tt> script.</p><p>A variable specification in a path must begin or end the path
name, or be bounded by slashes (/). Valid parametric path names take the
following form:</p><pre>$PARAM/tests
tests/$PARAM/generic
/tests/$PARAM</pre><p>The variable specification, once defined, may cause the path to be evaluated as
absolute or relocatable. In the following example, the <tt>prototype</tt> file contains this entry:</p><pre>f none $DIRLOC/tests/generic</pre><p>The <tt>pkginfo</tt> file contains this entry:</p><pre>DIRLOC=/myopt</pre><p>The path name <tt>$DIRLOC/tests/generic</tt> evaluates to the absolute path name <tt>/myopt/tests/generic</tt>, regardless of
whether the <tt>BASEDIR</tt> parameter is set in the <tt>pkginfo</tt> file.</p><p>In this example, the <tt>prototype</tt> file is identical to the one in the
previous example and the <tt>pkginfo</tt> file contains the following entries:</p><pre>DIRLOC=firstcut
BASEDIR=/opt</pre><p>The path name <tt>$DIRLOC/tests/generic</tt> will evaluate to the relocatable path name <tt>/opt/firstcut/tests/generic</tt>.</p><p>For more information on parametric path names, see <a href="ch6advtech-33.html#ch6advtech-39">Using Parametric Base Directories</a>.</p>

<a name="ch2buildpkg-18286"></a><h5>A Brief Word on an Object's Source and Destination Locations</h5>
<p><a name="indexterm-58"></a>The <b>path</b> field in the <tt>prototype</tt> file defines where the object will
be located on the target system. Specify the present location of the package's
objects in the <tt>prototype</tt> file if their directory structure does not mimic the
intended structure on the target system. See <a href="ch2buildpkg-26363.html">Organizing a Package's Contents</a> for more information on structuring objects
in a package.</p><p>If your development area is not structured in the same way that
you want your package structured, you can use the <i>path1=path2</i> format in the <i>path</i>
field. In this format, <i>path1</i> is the location the object should have on
the target system, and <i>path2</i> is the location the object has on your
system.</p><p>You can also use the <i>path1=path2</i> path name format with <i>path1</i> as a
relocatable object name and <i>path2</i> as a full path name to that
object on your system. </p>
<hr><p><b>Note - </b><i>path1</i> may not contain undefined build variables, but may contain undefined install variables.
<i>path2</i> may not contain any undefined variables, although both build variables and install
variables may be used. For information on the difference between install variables and
build variables, see <a href="ch2buildpkg-13952.html">Package Environment Variables</a>.</p>
<hr>
<p><a name="indexterm-59"></a>Links must use the <i>path1= path2</i> format because they are created by the
<tt>pkgadd</tt> command. As a general rule, <i>path2</i> of a link should never be
absolute, but should instead be relative to the directory portion of <i>path1</i>.</p><p>An option to using the <i>path1=path2</i> format is to use the <tt>!search</tt> command.
For more information, see <a href="#ch2buildpkg-13783">Providing a Search Path for the <tt>pkgmk</tt> Command</a>.</p>

<a name="ch2buildpkg-22"></a><h5>The <i>mode</i> Field</h5>
<p>The <i>mode</i> field may contain an octal number, a question mark (<tt>?</tt>), or
a variable specification. An octal number specifies the mode of the object when
it is installed on the target system. A <tt>?</tt> means that the mode
will be unchanged as the object is installed, implying that the object of
the same name already exists on the target system.</p><p>A variable specification of the form <tt>$</tt><i>mode</i>, where the first letter of the
variable must be a lowercase letter, means that this field will be set
as the package is built. Note that this variable must be defined at
build time in either the <tt>prototype</tt> file or as an option to the
<tt>pkgmk</tt> command. For information on the difference between install variables and build variables,
see <a href="ch2buildpkg-13952.html">Package Environment Variables</a>.</p><p>Files with file type <tt>i</tt> (information file), <tt>l</tt> (hard link), and <tt>s</tt> (symbolic
link) should leave this field blank.</p>

<a name="ch2buildpkg-23"></a><h5>The <i>owner</i> Field</h5>
<p>The <i>owner</i> field may contain a user name, a question mark (<tt>?</tt>), or
a variable specification. A user name has a maximum of 14 characters and
should be a name that already exists on the target system (such as
<tt>bin</tt> or <tt>root</tt>). A <tt>?</tt> means that the owner will be unchanged as
the object is installed, implying that the object of the same name already
exists on the target system. </p><p>A variable specification can be of the form <tt>$</tt><i>Owner</i> or <tt>$</tt><i>owner</i>, where the
first letter of the variable is either an uppercase letter or a
lowercase letter. If the variable begins with a lowercase letter, it must be
defined as the package is built, either in the <tt>prototype</tt> file or as
an option to the <tt>pkgmk</tt> command. If the variable begins with an
uppercase letter, the variable specification will be inserted into the <tt>pkginfo</tt> file as
a default value, and may be redefined at install time by a <tt>request</tt>
script. For information on the difference between install variables and build variables, see
<a href="ch2buildpkg-13952.html">Package Environment Variables</a>.</p><p>Files with file type <tt>i</tt> (information file) and <tt>l</tt>b (hard link) should
leave this field blank.</p>

<a name="ch2buildpkg-24"></a><h5>The <i>group</i> Field</h5>
<p>The <i>group </i>field may contain a group name, a question mark (<tt>?</tt>), or a
variable specification. A group name has a maximum of 14 characters and should
be a name that already exists on the target system (such as, <tt>bin</tt>
or <tt>sys</tt>). A <tt>?</tt> means that the group will be unchanged as the
object is installed, implying that the object of the same name already exists
on the target system.</p><p>A variable specification can be of the form <tt>$</tt><i>Group</i> or <tt>$</tt><i>group</i>, where the
first letter of the variable is either an uppercase letter or a
lowercase letter. If the variable begins with a lowercase letter, it must be
defined as the package is built, either in the <tt>prototype</tt> file or as
an option to the <tt>pkgmk</tt> command. If the variable begins with an
uppercase letter, the variable specification will be inserted into the <tt>pkginfo</tt> file as
a default value, and may be redefined at install time by a <tt>request</tt>
script. For information on the difference between install variables and build variables, see
<a href="ch2buildpkg-13952.html">Package Environment Variables</a>.</p><p>Files with file type <tt>i</tt> (information file) and <tt>l</tt> (hard link) should
leave this field blank.</p>

<a name="ch2buildpkg-12289"></a><h4>Creating a <tt>prototype</tt> File From Scratch</h4>
<p><a name="indexterm-60"></a>If you want to create a <tt>prototype</tt> file from scratch, you can do
so with your favorite text editor, adding one entry per package object. See
<a href="#ch2buildpkg-10912">Format of the <tt>prototype</tt> File</a> and the <a href="http://docs.sun.com/doc/816-5174/prototype-4?a=view"><tt>prototype</tt>(4)</a> man page for more information on the format of
this file. However, after you have defined each package object, you might want
to include some of the features described in <a href="#ch2buildpkg-31278">Adding Functionality to a <tt>prototype</tt> File</a>.</p>

<a name="ch2buildpkg-35610"></a><h4>Example&mdash;Creating a <tt>prototype</tt> File With the <tt>pkgproto</tt> Command</h4>
<p><a name="indexterm-61"></a>You can use the <tt>pkgproto</tt> command to build a basic <tt>prototype</tt> file,
as long as you have organized your package directory structure as described in
<a href="ch2buildpkg-26363.html">Organizing a Package's Contents</a>. For example, using the sample directory structure and <tt>pkginfo</tt> file described
in previous sections, the commands for creating the <tt>prototype</tt> file are as
follows:</p><pre>$ <tt><b>cd /home/jane</b></tt>
$ <tt><b>pkgproto ./SUNWcadap &gt; InfoFiles/prototype</b></tt></pre><p>The <tt>prototype</tt> file looks like the following:</p><pre>d none SUNWcadap 0755 jane staff
d none SUNWcadap/demo 0755 jane staff
f none SUNWcadap/demo/file1 0555 jane staff
d none SUNWcadap/srcfiles 0755 jane staff
f none SUNWcadap/srcfiles/file5 0555 jane staff
f none SUNWcadap/srcfiles/file6 0555 jane staff
d none SUNWcadap/lib 0755 jane staff
f none SUNWcadap/lib/file2 0644 jane staff
d none SUNWcadap/man 0755 jane staff
f none SUNWcadap/man/windex 0644 jane staff
d none SUNWcadap/man/man1 0755 jane staff
f none SUNWcadap/man/man1/file4.1 0444 jane staff
f none SUNWcadap/man/man1/file3.1 0444 jane staff</pre>
<hr><p><b>Note - </b>The actual owner and group of the person building the package is
recorded by the <tt>pkgproto</tt> command. A good technique is to use the <tt>chown -R</tt>
and the <tt>chgrp -R</tt> commands, setting the owner and group as intended <b>before</b> running
the <tt>pkgproto</tt> command.</p>
<hr>
<p>This example <tt>prototype</tt> file is not complete. See the following section for information
on completing this file.</p>

<a name="ch2buildpkg-40414"></a><h4>Fine-Tuning a <tt>prototype</tt> File Created With the <tt>pkgproto</tt> Command</h4>
<p><a name="indexterm-62"></a>Although the <tt>pkgproto</tt> command is useful in creating an initial <tt>prototype</tt> file, it
does not create entries for every package object that needs to be defined.
This command does not make complete entries. The <tt>pkgproto</tt> command does not do
any of the following:</p>
<ul><li><p>Create complete entries for objects with file types <tt>v</tt> (volatile files), <tt>e</tt> (editable files), <tt>x</tt> (exclusive directories), or <tt>i</tt> (information files or installation scripts)</p></li>
<li><p>Support multiple classes with a single invocation</p></li></ul>


<a name="ch2buildpkg-25"></a><h5>Creating Object Entries With File Types <tt>v</tt>, <tt>e</tt>, <tt>x</tt>, and <tt>i</tt></h5>
<p>At the very least, you need to modify the <tt>prototype</tt> file to add
objects with file type <tt>i</tt>. If you stored your information files and installation
scripts in the first level of your package directory (for example, <tt>/home/jane/SUNWcadap/pkginfo</tt>),
then an entry in the <tt>prototype</tt> file would look like the following:</p><pre>i pkginfo</pre><p>If you did not store your information files and installation scripts in
the first level of your package directory, then you need to specify their
source location. For example:</p><pre>i pkginfo=/home/jane/InfoFiles/pkginfo</pre><p><a name="indexterm-63"></a>Or, you can use the <tt>!search</tt> command to specify the location for
the <tt>pkgmk</tt> command to look when building the package. See <a href="#ch2buildpkg-13783">Providing a Search Path for the <tt>pkgmk</tt> Command</a> for more
information.</p><p>To add entries for objects with file types <tt>v</tt>, <tt>e</tt>, and <tt>x</tt>,
follow the format described in <a href="#ch2buildpkg-10912">Format of the <tt>prototype</tt> File</a>, or refer to the <a href="http://docs.sun.com/doc/816-5174/prototype-4?a=view"><tt>prototype</tt>(4)</a> man page.</p>
<hr><p><b>Note - </b>Remember to always assign a class to files with a file type
of <tt>e</tt> (editable) and have an associated class action script for that
class. Otherwise, the files will be removed during package removal, even if the
path name is shared with other packages. </p>
<hr>


<a name="ch2buildpkg-26"></a><h5>Using Multiple Class Definitions</h5>
<p>If you use the <tt>pkgproto</tt> command to create your basic <tt>prototype</tt> file,
you can assign all the package objects to the <tt>none</tt> class or
to one, specific class. As shown in <a href="#ch2buildpkg-35610">Example--Creating a <tt>prototype</tt> File With the <tt>pkgproto</tt> Command</a>, the basic <tt>pkgproto</tt> command
assigns all objects to the <tt>none</tt> class. To assign all objects to a
specific class, you can use the <tt>-c</tt> option. For example:</p><pre>$ <tt><b>pkgproto -c </tt><i>classname</i><tt> /home/jane/SUNWcadap &gt; /home/jane/InfoFiles/prototype</b></tt></pre><p>If you use multiple classes, you might need to manually edit the
<tt>prototype</tt> file and modify the <i>class</i> field for each object. If you use
classes, you also need to define the <tt>CLASSES</tt> parameter in the <tt>pkginfo</tt> file
and write class action scripts. Using classes is an optional feature and is
discussed in detail in <a href="ch3enhancepkg-10289.html#ch3enhancepkg-37319">Writing Class Action Scripts</a>.</p>

<a name="ch2buildpkg-27"></a><h5>Example&mdash;Fine-Tuning a <tt>prototype</tt> File Created Using the <tt>pkgproto</tt> Command</h5>
<p><a name="indexterm-64"></a>Given the <tt>prototype</tt> file created by the <tt>pkgproto</tt> command in <a href="#ch2buildpkg-35610">Example--Creating a <tt>prototype</tt> File With the <tt>pkgproto</tt> Command</a>, several
modifications need to be made.</p>
<ul><li><p>There needs to be an entry for the <tt>pkginfo</tt> file.</p></li>
<li><p>The <i>path</i> fields need to be changed to the <i>path1=path2</i> format because the package source is in <tt>/home/jane</tt>. Since the package source is a hierarchical directory, and the <tt>!search</tt> command does not search recursively, it might be easier to use the <i>path1=path2</i> format.</p></li>
<li><p>The <i>owner</i> and <i>group</i> fields should contain the names of existing users and groups on the target system. That is, the owner <tt>jane</tt> will result in an error because this owner is not part of the SunOS<sup>TM</sup> operating system.</p><p>The modified <tt>prototype</tt> file looks like the following:</p><pre>i pkginfo=/home/jane/InfoFiles/pkginfo
d none SUNWcadap=/home/jane/SUNWcadap 0755 root sys
d none SUNWcadap/demo=/home/jane/SUNWcadap/demo 0755 root bin
f none SUNWcadap/demo/file1=/home/jane/SUNWcadap/demo/file1 0555 root bin
d none SUNWcadap/srcfiles=/home/jane/SUNWcadap/srcfiles 0755 root bin
f none SUNWcadap/srcfiles/file5=/home/jane/SUNWcadap/srcfiles/file5 0555 root bin
f none SUNWcadap/srcfiles/file6=/home/jane/SUNWcadap/srcfiles/file6 0555 root bin
d none SUNWcadap/lib=/home/jane/SUNWcadap/lib 0755 root bin
f none SUNWcadap/lib/file2=/home/jane/SUNWcadap/lib/file2 0644 root bin
d none SUNWcadap/man=/home/jane/SUNWcadap/man 0755 bin bin
f none SUNWcadap/man/windex=/home/jane/SUNWcadap/man/windex 0644 root other
d none SUNWcadap/man/man1=/home/jane/SUNWcadap/man/man1 0755 bin bin
f none SUNWcadap/man/man1/file4.1=/home/jane/SUNWcadap/man/man1/file4.1 0444 bin bin
f none SUNWcadap/man/man1/file3.1=/home/jane/SUNWcadap/man/man1/file3.1 0444 bin bin</pre></li></ul>


<a name="ch2buildpkg-31278"></a><h4>Adding Functionality to a <tt>prototype</tt> File</h4>
<p><a name="indexterm-65"></a>Besides defining every package object in the <tt>prototype</tt> file, you can also do
the following:</p>
<ul><li><p>Define additional objects to be created at install time.</p></li>
<li><p>Create links at install time.</p></li>
<li><p>Distribute packages over multiple volumes.</p></li>
<li><p>Nest <tt>prototype</tt> files.</p></li>
<li><p>Set a default value for the <i>mode</i>, <i>owner</i>, and <i>group</i> fields.</p></li>
<li><p>Provide a search path for the <tt>pkgmk</tt> command.</p></li>
<li><p>Set environment variables.</p></li></ul>
<p>See the following sections for information on making these changes.</p>

<a name="ch2buildpkg-28"></a><h5>Defining Additional Objects to Be Created at Install Time</h5>
<p><a name="indexterm-66"></a>You can use the <tt>prototype</tt> file to define objects that are not actually
delivered on the installation medium. During installation, using the <tt>pkgadd</tt> command, these objects
are created with the required file types, if they do not already exist
at the time of installation.</p><p>To specify that an object be created on the target system, add
an entry for it in the <tt>prototype</tt> file with the appropriate file type.
</p><p>For example, if you want a directory created on the target system,
but do not want to deliver it on the installation medium, add the
following entry for the directory in the <tt>prototype</tt> file:</p><pre>d none /<i>directory</i> 0644 root other</pre><p>If you want to create an empty file on the target system,
an entry for the file in the <tt>prototype</tt> file might look like the
following:</p><pre>f none <i>filename</i>=/dev/null 0644 bin bin</pre><p>The only objects that <b>must</b> be delivered on the installation medium are regular
files and edit scripts (file types <tt>e</tt>, <tt>v</tt>, <tt>f</tt>) and the directories
required to contain them. Any additional objects are created without reference to the
delivered objects, directories, named pipes, devices, hard links, and symbolic links.</p>

<a name="ch2buildpkg-29"></a><h5>Creating Links at Install Time</h5>
<p><a name="indexterm-67"></a><a name="indexterm-68"></a>To create links during package installation, define the following in the <tt>prototype</tt> file
entry for the linked object: </p>
<ul><li><p>Its file type as <tt>l</tt> (a link) or <tt>s</tt> (a symbolic link). </p></li>
<li><p>The linked object's path name with the format <i>path1=path2</i> where <i>path1</i> is the destination and <i>path2</i> is the source file. As a general rule, <i>path2</i> of a link should never be absolute, but should instead be relative to the directory portion of <i>path1</i>. For example, a <tt>prototype</tt> file entry that defines a symbolic link could be as follows: </p><pre>s none etc/mount=../usr/etc/mount</pre></li></ul>
<p>Relative links would be specified in this manner whether the package is
installed as absolute or relocatable. </p>

<a name="ch2buildpkg-30"></a><h5>Distributing Packages Over Multiple Volumes</h5>
<p><a name="indexterm-69"></a><a name="indexterm-70"></a>When you build your package with the <tt>pkgmk</tt> command, the command performs
the calculations and actions necessary to organize a multiple volume package.  A
multiple volume package is called a <b>segmented package</b>.</p><p>However, you can use the optional <i>part</i> field in the <tt>prototype</tt> file
to define which part you want an object to be located. A number
in this field overrides the <tt>pkgmk</tt> command and forces the placement of the
component into the part given in the field. Note that a one-to-one correspondence
exists between parts and volumes for removable media formatted as file systems. If
the volumes are preassigned by the developer, the <tt>pkgmk</tt> command issues an error
if there is insufficient space on any volume.</p>

<a name="ch2buildpkg-31"></a><h5>Nesting <tt>prototype</tt> Files</h5>
<p><a name="indexterm-71"></a>You can create multiple <tt>prototype</tt> files and then include them by using the
<tt>!include</tt> command in the <tt>prototype</tt> file. You might want to nest files
for easier maintenance.</p><p>In the following example there are three <tt>prototype</tt> files. The main file (<tt>prototype</tt>)
is being edited. The other two files (<tt>proto2</tt> and <tt>proto3</tt>) are being included.
</p><pre>!include /<i>source-dir</i>/proto2
!include /<i>source-dir</i>/proto3</pre>

<a name="ch2buildpkg-32"></a><h5>Setting Default Values for the <i>mode</i>, <i>owner</i>, and <i>group</i> Fields</h5>
<p><a name="indexterm-72"></a>To set default values for the <i>mode</i>, <i>owner</i>, and <i>group</i> fields for specific package
objects, you can insert the <tt>!</tt><tt>default</tt> command into the <tt>prototype</tt> file. For example:</p><pre>!default 0644 root other</pre>
<hr><p><b>Note - </b>The <tt>!</tt><tt>default</tt> command's range starts from where it is inserted and extends to
the end of the file. The command's range does not span to included
files.</p>
<hr>
<p>However, for directories (file type <tt>d</tt>) and editable files (file type <tt>e</tt>) that
you know exist on target systems (like <tt>/usr</tt> or <tt>/etc/vfstab</tt>), make sure
that the <i>mode</i>, <i>owner</i>, and <i>group</i> fields in the <tt>prototype</tt> file are set
to question marks (<tt>?</tt>). That way you will not destroy existing settings that
a site administrator may have modified.</p>

<a name="ch2buildpkg-13783"></a><h5>Providing a Search Path for the <tt>pkgmk</tt> Command</h5>
<p>If the source location for package objects is different than their destination location,
and you do not want to use the <i>path1=path2</i> format as described in
<a href="#ch2buildpkg-18286">A Brief Word on an Object's Source and Destination Locations</a>, then you can use the <tt>!search</tt> command in the <tt>prototype</tt> file.</p><p><a name="indexterm-73"></a><a name="indexterm-74"></a>For example, if you created a directory, <tt>pkgfiles</tt>, in your home directory,
and it contains all of your information files and installation scripts, you can
specify that this directory be searched when the package is built with the
<tt>pkgmk</tt> command.</p><p>The command in the prototype file would look like the following:</p><pre>!search /<i>home-dir</i>/pkgfiles</pre>
<hr><p><b>Note - </b>Search requests do not span to included files. In addition, a search
is limited to the specific directories listed and does not search recursively.</p>
<hr>


<a name="ch2buildpkg-33"></a><h5>Setting Environment Variables</h5>
<p><a name="indexterm-75"></a>You can also add commands to the <tt>prototype</tt> file of the form <tt>!</tt><i>PARAM=value</i>.
Commands of this form define variables in the current environment. If you have
multiple <tt>prototype</tt> files, the scope of this command is local to the
<tt>prototype</tt> file where it is defined.</p><p><a name="indexterm-76"></a>The variable <i>PARAM</i> can begin with either a lowercase letter or an uppercase
letter. If the value of the <i>PARAM</i> variable is not known at
build time, the <tt>pkgmk</tt> command aborts with an error. For more information on
the difference between build variables and install variables, see <a href="ch2buildpkg-13952.html">Package Environment Variables</a>.</p>

<a name="ch2buildpkg-64"></a><h4>How to Create a <tt>prototype</tt> File by Using the <tt>pkgproto</tt> Command</h4>
<hr><p><b>Note - </b><a name="indexterm-77"></a>It is easier to create information files and installation scripts before you create
a <tt>prototype</tt> file. However, this order is not required. You can always edit
the <tt>prototype</tt> file after changing your package contents. For more information on information
files and installation scripts, see <a href="ch3enhancepkg-11350.html">Chapter&nbsp;3, Enhancing the Functionality of a Package (Tasks)</a>.</p>
<hr>
<ol>
<li><a name="ch2buildpkg-step-34"></a><b>Determine which package objects will be absolute and which package objects will be
relocatable, if not done already.</b><p>For information that will help you complete this step, see <a href="#ch2buildpkg-16793">The <i>path</i> Field</a>.</p></li>
<li><a name="ch2buildpkg-step-35"></a><b>Organize your package's objects to mimic their location on the target system.</b><p>If you already organized your packages as described in <a href="ch2buildpkg-26363.html">Organizing a Package's Contents</a>, note that you
might need to make some changes based on your decisions in <a href="#ch2buildpkg-step-34">Step&nbsp;1</a>.
If you have not organized your package yet, you should do so now.
If you do not organize your package, you cannot use the <tt>pkgproto</tt> command
to create a basic <tt>prototype</tt> file.</p></li>
<li><a name="ch2buildpkg-step-36"></a><b>If your package has collectively relocatable objects, edit the <tt>pkginfo</tt> file to set
the <tt>BASEDIR</tt> parameter to the appropriate value.</b><p>For example:</p><pre>BASEDIR=/opt</pre><p>For information on collectively relocatable objects, see <a href="#ch2buildpkg-33395">Collectively Relocatable Objects</a>.</p></li>
<li><a name="ch2buildpkg-step-37"></a><b>If your package has individually relocatable objects, create a <tt>request</tt> script to prompt
the installer for the appropriate path name. Alternatively, create a <tt>checkinstall</tt> script to determine
the appropriate path from file system data.</b><p>The following list gives page numbers for your reference regarding common tasks:</p>
<ul><li><p>To create a <tt>request</tt> script, see <a href="ch3enhancepkg-10289.html#ch3enhancepkg-119">How to Write a <tt>request</tt> Script</a>.</p></li>
<li><p>To create a <tt>checkinstall</tt> script, see <a href="ch3enhancepkg-10289.html#ch3enhancepkg-120">How to Gather File System Data</a>.</p></li>
<li><p>For more information on individually relocatable objects, see <a href="#ch2buildpkg-39047">Individually Relocatable Objects</a>.</p></li></ul>
</li>
<li><a name="ch2buildpkg-step-55"></a><b>Change the owner and group on all of your package components to be
the intended owner and group on the target systems.</b><p>Use the <tt>chown -R</tt> and the <tt>chgrp -R</tt> commands on your package directory and information
files directory.</p></li>
<li><a name="ch2buildpkg-step-38"></a><b>Execute the <tt>pkgproto</tt> command to create a basic <tt>prototype</tt> file.</b><p>The <tt>pkgproto</tt> command scans your directories to create a basic file. For
example:</p><pre>$ <tt><b>cd</b></tt> <i>package-directory</i>
$ <tt><b>pkgproto ./</b></tt><i>package-directory</i><tt><b> &gt; prototype</b></tt></pre><p>The <tt>prototype</tt> file can be located anywhere on your system. Keeping your information
files and installation scripts in one place simplifies access and maintenance. For additional
information on the <tt>pkgproto</tt> command, see the <a href="http://docs.sun.com/doc/816-5165/pkgproto-1?a=view"><tt>pkgproto</tt>(1)</a> man page.</p></li>
<li><a name="ch2buildpkg-step-39"></a><b>Edit the <tt>prototype</tt> file by using your favorite text editor, and add entries
for files of type <tt>v</tt>, <tt>e</tt>, <tt>x</tt>, and <tt>i</tt>.</b><p>For information on the specific changes you might need to make, see <a href="#ch2buildpkg-40414">Fine-Tuning a <tt>prototype</tt> File Created With the <tt>pkgproto</tt> Command</a>.</p></li>
<li><a name="ch2buildpkg-step-40"></a><b>(Optional) If you are using multiple classes, edit the <tt>prototype</tt> and <tt>pkginfo</tt> files.
Use your favorite text editor to make the necessary changes, and create corresponding class
action scripts.</b><p>For information on the specific changes you might need to make, see <a href="#ch2buildpkg-40414">Fine-Tuning a <tt>prototype</tt> File Created With the <tt>pkgproto</tt> Command</a>
and <a href="ch3enhancepkg-10289.html#ch3enhancepkg-37319">Writing Class Action Scripts</a>. </p></li>
<li><a name="ch2buildpkg-step-41"></a><b>Edit the <tt>prototype</tt> file by using your favorite text editor to redefine path
names and change other field settings.</b><p>For more information, see <a href="#ch2buildpkg-40414">Fine-Tuning a <tt>prototype</tt> File Created With the <tt>pkgproto</tt> Command</a>.</p></li>
<li><a name="ch2buildpkg-step-42"></a><b>(Optional) Edit the <tt>prototype</tt> file by using your favorite text editor to add
functionality to your <tt>prototype</tt> file.</b><p>For more information, see <a href="#ch2buildpkg-31278">Adding Functionality to a <tt>prototype</tt> File</a>.</p></li>
<li><a name="ch2buildpkg-step-43"></a><b>Save your changes and quit the editor.</b></li></ol><h6>See Also</h6><p>If you are ready for the next task, see <a href="ch2buildpkg-17051.html#ch2buildpkg-66">How to Build a Package</a>.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ch2buildpkg-26363.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ch2buildpkg-17051.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

