<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Creating Home Directories in Trusted Extensions - Solaris Trusted Extensions Installation and Configuration</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-05-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">Solaris Trusted Extensions Installation and Configuration</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="txconf-14.html">Previous</a>
             </td>
             <td align="right">
                 <a href="txconf-64.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-4.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="ovw-1.html">1.&nbsp;&nbsp;Security Planning for Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="tmap-1.html">2.&nbsp;&nbsp;Installation and Configuration Roadmap for Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="startinst-1.html">3.&nbsp;&nbsp;Installing Solaris Trusted Extensions Software  (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="txconf-1.html">4.&nbsp;&nbsp;Configuring Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="txconf-60.html">Setting Up the Global Zone in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-60.html#confsys-17">Check and Install Your Label Encodings File</a></p>
<p class="toc level3"><a href="txconf-60.html#txconf-35">Enable IPv6 Networking in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-60.html#txconf-42">Create ZFS Pool for Cloning Zones</a></p>
<p class="toc level3"><a href="txconf-60.html#confsys-3">Reboot and Log In to Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-60.html#confsys-21">Initialize the Solaris Management Console Server in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-60.html#txldap-8">Make the Global Zone an LDAP Client in Trusted Extensions</a></p>
<p class="toc level2 tocsp"><a href="txconf-20.html">Creating Labeled Zones</a></p>
<p class="toc level3"><a href="txconf-20.html#txconf-80">Run the <tt>txzonemgr</tt> Script</a></p>
<p class="toc level3"><a href="txconf-20.html#txconf-netint-1">Configure the Network Interfaces in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-20.html#txconf-11">Name and Label the Zone</a></p>
<p class="toc level3"><a href="txconf-20.html#txconf-install-1">Install the Labeled Zone</a></p>
<p class="toc level3"><a href="txconf-20.html#txconf-76">Boot the Labeled Zone</a></p>
<p class="toc level3"><a href="txconf-20.html#txconf-74">Verify the Status of the Zone</a></p>
<p class="toc level3"><a href="txconf-20.html#txconf-48">Customize the Labeled Zone</a></p>
<p class="toc level3"><a href="txconf-20.html#txconf-54">Create Another Zone in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-20.html#txconf-84">Add a Network Interface to an Existing Labeled Zone</a></p>
<p class="toc level2 tocsp"><a href="txconf-14.html">Creating Roles and Users in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-14.html#txconf-23">Create the Security Administrator Role in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-14.html#txconf-25">Create Users Who Can Assume Roles in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-14.html#txconf-29">Verify That the Trusted Extensions Roles Work</a></p>
<p class="toc level3"><a href="txconf-14.html#txconf-34">Enable Users to Log In to a Labeled Zone</a></p>
<div class="onpage">
<p class="toc level2 tocsp"><a href="">Creating Home Directories in Trusted Extensions</a></p>
<p class="toc level3"><a href="#txconf-52">Create the Home Directory Server in Trusted Extensions</a></p>
<p class="toc level3"><a href="#txconf-56">Enable Users to Access Their Home Directories in Trusted Extensions</a></p>
</div>
<p class="toc level2 tocsp"><a href="txconf-64.html">Adding Users and Hosts to an Existing Trusted Network</a></p>
<p class="toc level3"><a href="txconf-64.html#txconf-65">Add an NIS User to the LDAP Server</a></p>
<p class="toc level2 tocsp"><a href="txconf-trouble-1.html">Troubleshooting Your Trusted Extensions Configuration</a></p>
<p class="toc level2"><a href="txconf-18.html">Additional Trusted Extensions Configuration Tasks</a></p>
<p class="toc level3"><a href="txconf-18.html#basic-52">How to Copy Files to Portable Media in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-18.html#basic-25">How to Copy Files From Portable Media in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-18.html#txconf-72">How to Remove Trusted Extensions From the System</a></p>
<p class="toc level1 tocsp"><a href="txldap-1.html">5.&nbsp;&nbsp;Configuring LDAP for Trusted Extensions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="headl-1.html">6.&nbsp;&nbsp;Configuring a Headless System With Trusted Extensions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="appol-1.html">A.&nbsp;&nbsp;Site Security Policy</a></p>
<p class="toc level1 tocsp"><a href="aptxconf-1.html">B.&nbsp;&nbsp;Using CDE Actions to Install Zones in Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="checklist-1.html">C.&nbsp;&nbsp;Configuration Checklist for Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="txconf-50"></a><h3>Creating Home Directories in Trusted Extensions</h3>
<a name="indexterm-191"></a><a name="indexterm-192"></a><p>In Trusted Extensions, users need access to their home directories at every label
at which the users work. To make every home directory available to
the user requires that you create a multilevel home directory server, run the automounter
on the server, and export the home directories. On the client side, you
can run scripts to find the home directory for every zone for
each user, or you can have the user log in to the home
directory server.</p>

<a name="txconf-52"></a><h4>Create the Home Directory Server in Trusted Extensions</h4><a name="indexterm-193"></a><a name="indexterm-194"></a><h6>Before You Begin</h6><p>You must be superuser, in the <tt>root</tt> role, or in the Primary Administrator
role.</p><ol>
<li><b>Install and configure the home directory server with Trusted Extensions software.</b>
<ul><li><p>If you are cloning zones, make sure that you use a Solaris ZFS snapshot that has empty home directories.</p></li>
<li><p>Because users require a home directory at every label that they they can log in to, create every zone that a user can log in to. For example, if you use the default <tt>label_encodings</tt> file, you would create a zone for the <tt>PUBLIC</tt> label.</p></li></ul>
</li>
<li><b>If you are using UFS and not Solaris ZFS, enable the NFS server
to serve itself.</b><ol style="list-style-type: lower-alpha">
				 
<li><b>In the global zone, modify the <tt>automount</tt> entry in the <tt>nsswitch.conf</tt> file.</b><p>Use the trusted editor to edit the <tt>/etc/nsswitch.conf</tt> file. For the procedure, see <a href="http://docs.sun.com/doc/819-7309/roles-10?a=view">How to Edit Administrative Files in Trusted Extensions in <i>Solaris Trusted Extensions Administrator&rsquo;s Procedures</i></a>.</p><pre>automount: files</pre></li>
<li><b>In the global zone, run the <tt>automount</tt> command.</b></li></ol></li>
<li><b>For every labeled zone, follow the automount procedure in <a href="http://docs.sun.com/doc/819-7309/txconf-41?a=view">How to NFS Mount Files in a Labeled Zone in <i>Solaris Trusted Extensions Administrator&rsquo;s Procedures</i></a>. Then, return to
this procedure.</b></li>
<li><b>Verify that the home directories have been created.</b><ol style="list-style-type: lower-alpha">
				 
<li><b>Log out of the home directory server.</b></li>
<li><b>As a regular user, log in to the home directory server.</b></li>
<li><b>In the login zone, open a terminal.</b></li>
<li><b>In the terminal window, verify that the user's home directory exists.</b></li>
<li><b>Create workspaces for every zone that the user can work in.</b></li>
<li><b>In each zone, open a terminal window to verify that the user's home
directory exists.</b></li></ol></li>
<li><b>Log out of the home directory server.</b></li></ol>

<a name="txconf-56"></a><h4>Enable Users to Access Their Home Directories in Trusted Extensions</h4><a name="indexterm-195"></a><a name="indexterm-196"></a><p>Users can initially log in to the home directory server to create
a home directory that can be shared with other systems. To create a
home directory at every label, each user must log in to the home
directory server at every label.</p><p>Alternatively, you, as administrator, can create a script to create a mount point
for home directories on each user's home system before the user first logs
in. The script creates mount points at every label at which the user
is permitted to work.</p><h6>Before You Begin</h6><p>The home directory server for your Trusted Extensions domain is configured.</p><ul>
<li><b>Choose whether to allow direct login to the server, or whether to run
a script.</b><ul>
<li><b>Enable users to log in directly to the home directory server.</b><ol style="list-style-type: lower-alpha">
				 
<li><b>Instruct each user to log in to the home directory server.</b><p>After successful login, the user must log out.</p></li>
<li><b>Instruct each user to log in again, and this time, to choose
a different login label.</b><p>The user uses the label builder to choose a different login label. After
successful login, the user must log out.</p></li>
<li><b>Instruct each user to repeat the login process for every label that the
user is permitted to use.</b></li>
<li><b>Instruct the users to log in from their regular workstation.</b><p>Their home directory for their default label is available. When a user changes
the label of a session or adds a workspace at a different
label, the user's home directory for that label is mounted.</p></li></ol></li>
<li><b>Write a script that creates a home directory mount point for every user,
and run the script.</b><pre>#!/bin/sh
#
for zoneroot in `/usr/sbin/zoneadm list -p | cut -d ":" -f4` ; do
    if [ $zoneroot != / ]; then
        prefix=$zoneroot/root/export
    
        for j in `getent passwd|tr ' ' _` ; do
            uid=`echo $j|cut -d ":" -f3`
            if [ $uid -ge 100 ]; then
                gid=`echo $j|cut -d ":" -f4`
                homedir=`echo $j|cut -d ":" -f6`
                mkdir -m 711 -p $prefix$homedir
                chown $uid:$gid $prefix$homedir
            fi
        done
    fi
done</pre><ol style="list-style-type: lower-alpha">
				 
<li><b>From the global zone, run this script on the NFS server.</b></li>
<li><b>Then, run this script on every multilevel desktop that the user is going
to log in to.</b></li></ol></li></ul></li></ul>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="txconf-14.html">Previous</a>
             </td>
             <td align="right">
                 <a href="txconf-64.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

