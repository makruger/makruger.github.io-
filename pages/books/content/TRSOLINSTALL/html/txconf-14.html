<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Creating Roles and Users in Trusted Extensions - Solaris Trusted Extensions Installation and Configuration</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-05-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">Solaris Trusted Extensions Installation and Configuration</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="txconf-20.html">Previous</a>
             </td>
             <td align="right">
                 <a href="txconf-50.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-4.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="ovw-1.html">1.&nbsp;&nbsp;Security Planning for Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="tmap-1.html">2.&nbsp;&nbsp;Installation and Configuration Roadmap for Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="startinst-1.html">3.&nbsp;&nbsp;Installing Solaris Trusted Extensions Software  (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="txconf-1.html">4.&nbsp;&nbsp;Configuring Trusted Extensions (Tasks)</a></p>
<p class="toc level2"><a href="txconf-60.html">Setting Up the Global Zone in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-60.html#confsys-17">Check and Install Your Label Encodings File</a></p>
<p class="toc level3"><a href="txconf-60.html#txconf-35">Enable IPv6 Networking in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-60.html#txconf-42">Create ZFS Pool for Cloning Zones</a></p>
<p class="toc level3"><a href="txconf-60.html#confsys-3">Reboot and Log In to Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-60.html#confsys-21">Initialize the Solaris Management Console Server in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-60.html#txldap-8">Make the Global Zone an LDAP Client in Trusted Extensions</a></p>
<p class="toc level2 tocsp"><a href="txconf-20.html">Creating Labeled Zones</a></p>
<p class="toc level3"><a href="txconf-20.html#txconf-80">Run the <tt>txzonemgr</tt> Script</a></p>
<p class="toc level3"><a href="txconf-20.html#txconf-netint-1">Configure the Network Interfaces in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-20.html#txconf-11">Name and Label the Zone</a></p>
<p class="toc level3"><a href="txconf-20.html#txconf-install-1">Install the Labeled Zone</a></p>
<p class="toc level3"><a href="txconf-20.html#txconf-76">Boot the Labeled Zone</a></p>
<p class="toc level3"><a href="txconf-20.html#txconf-74">Verify the Status of the Zone</a></p>
<p class="toc level3"><a href="txconf-20.html#txconf-48">Customize the Labeled Zone</a></p>
<p class="toc level3"><a href="txconf-20.html#txconf-54">Create Another Zone in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-20.html#txconf-84">Add a Network Interface to an Existing Labeled Zone</a></p>
<div class="onpage">
<p class="toc level2 tocsp"><a href="">Creating Roles and Users in Trusted Extensions</a></p>
<p class="toc level3"><a href="#txconf-23">Create the Security Administrator Role in Trusted Extensions</a></p>
<p class="toc level3"><a href="#txconf-25">Create Users Who Can Assume Roles in Trusted Extensions</a></p>
<p class="toc level3"><a href="#txconf-29">Verify That the Trusted Extensions Roles Work</a></p>
<p class="toc level3"><a href="#txconf-34">Enable Users to Log In to a Labeled Zone</a></p>
</div>
<p class="toc level2 tocsp"><a href="txconf-50.html">Creating Home Directories in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-50.html#txconf-52">Create the Home Directory Server in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-50.html#txconf-56">Enable Users to Access Their Home Directories in Trusted Extensions</a></p>
<p class="toc level2 tocsp"><a href="txconf-64.html">Adding Users and Hosts to an Existing Trusted Network</a></p>
<p class="toc level3"><a href="txconf-64.html#txconf-65">Add an NIS User to the LDAP Server</a></p>
<p class="toc level2 tocsp"><a href="txconf-trouble-1.html">Troubleshooting Your Trusted Extensions Configuration</a></p>
<p class="toc level2"><a href="txconf-18.html">Additional Trusted Extensions Configuration Tasks</a></p>
<p class="toc level3"><a href="txconf-18.html#basic-52">How to Copy Files to Portable Media in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-18.html#basic-25">How to Copy Files From Portable Media in Trusted Extensions</a></p>
<p class="toc level3"><a href="txconf-18.html#txconf-72">How to Remove Trusted Extensions From the System</a></p>
<p class="toc level1 tocsp"><a href="txldap-1.html">5.&nbsp;&nbsp;Configuring LDAP for Trusted Extensions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="headl-1.html">6.&nbsp;&nbsp;Configuring a Headless System With Trusted Extensions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="appol-1.html">A.&nbsp;&nbsp;Site Security Policy</a></p>
<p class="toc level1 tocsp"><a href="aptxconf-1.html">B.&nbsp;&nbsp;Using CDE Actions to Install Zones in Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="checklist-1.html">C.&nbsp;&nbsp;Configuration Checklist for Trusted Extensions</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="txconf-14"></a><h3>Creating Roles and Users in Trusted Extensions</h3>
<a name="indexterm-168"></a><a name="indexterm-169"></a><p>If you are already using <a href="glossary-1.html#glossary-5">administrative role</a>s, you might want to add a
Security Administrator role. For sites that have not yet implemented roles, the procedure
for creating them is similar to the procedure in the Solaris OS. Trusted
Extensions adds the Security Administrator role and requires the use of the Solaris
Management Console to administer a Trusted Extensions domain.</p>

<a name="txconf-23"></a><h4>Create the Security Administrator Role in Trusted Extensions</h4><a name="indexterm-170"></a><a name="indexterm-171"></a><a name="indexterm-172"></a><a name="indexterm-173"></a><p>Role creation in Trusted Extensions is identical to role creation in the
Solaris OS. However, in Trusted Extensions, a Security Administrator role is required. To create
a local Security Administrator role, you can also use the command-line interface, as
in <a href="#txconf-61">Example&nbsp;4-4</a>.</p><h6>Before You Begin</h6><p>You must be superuser, in the <tt>root</tt> role, or in the Primary Administrator
role.</p><p>To create the role on the network, you must have completed <a href="confsys-10.html">Configuring the Solaris Management Console for LDAP (Task Map)</a>.</p><ol>
<li><b>Start the Solaris Management Console.</b><pre># <tt><b>/usr/sbin/smc &amp;</b></tt></pre></li>
<li><b>Select the appropriate toolbox.</b><ul>
<li><b>To create the role locally, use This Computer (<i>this-host</i>: <tt>Scope=Files, Policy=TSOL</tt>).</b></li>
<li><b>To create the role in the LDAP service, use This Computer (<i>this-host</i>:
<tt>Scope=LDAP, Policy=TSOL</tt>).</b></li></ul></li>
<li><b>Click System Configuration, then click Users.</b><p>You are prompted for your password.</p></li>
<li><b>Type the appropriate password.</b></li>
<li><b>Double-click Administrative Roles.</b></li>
<li><b>From the Action menu, choose Add Administrative Role.</b></li>
<li><b>Create the Security Administrator role.</b><p>Use the following information as a guide:</p>
<ul><li><p>Role name &ndash; <tt>secadmin</tt></p></li>
<li><p>Full name &ndash; <tt>Security Administrator</tt></p></li>
<li><p>Description &ndash; Site Security Officer <b>No proprietary information here</b>.</p></li>
<li><p>Role ID Number &ndash; &ge;100</p></li>
<li><p>Role shell &ndash; Administrator's Bourne (profile shell)</p></li>
<li><p>Create a role mailing list &ndash; Leave the checkbox selected.</p></li>
<li><p>Password and confirm &ndash; Assign a password of at least 6 alphanumeric characters.</p><p>The password for the Security Administrator role, and all passwords, must be difficult to guess, thus reducing the chance of an adversary gaining unauthorized access by attempting to guess passwords.</p>
<hr><p><b>Note - </b>For all administrative roles, make the account Always Available, and do not set password expiration dates.</p>
<hr>
</li>
<li><p>Available and Granted Rights &ndash; Information Security, User Security</p></li>
<li><p>Home Directory Server &ndash; <i>home-directory-server</i></p></li>
<li><p>Home Directory Path &ndash; /<i>mount-path</i></p></li>
<li><p>Assign Users&ndash; This field is automatically filled in when you assign a role to a user.</p></li></ul>
</li>
<li><b>After creating the role, check that the settings are correct.</b><p>Select the role, then double-click it.</p><p>Review the values in the following fields:</p>
<ul><li><p>Available Groups &ndash; Add groups if required.</p></li>
<li><p>Trusted Extensions Attributes &ndash; Defaults are correct.</p><p>For a single-label system where the labels must not be visible, choose Hide for Label: Show or Hide.</p></li>
<li><p>Audit Excluded and Included &ndash; Set audit flags only if the role's audit flags are exceptions to the system settings in the <tt>audit_control</tt> file.</p></li></ul>
</li>
<li><b>To create other roles, use the Security Administrator role as a guide.</b><p>For examples, see <a href="http://docs.sun.com/doc/819-3321/rbactask-32?a=view">How to Create and Assign a Role By Using the GUI in <i>System Administration Guide: Security Services</i></a>. Give each role a unique ID, and assign to
the role the correct rights profile. Possible roles include the following:</p>
<ul><li><p>admin Role &ndash; <tt>System Administrator</tt> Granted Rights</p></li>
<li><p>primaryadmin Role &ndash; <tt>Primary Administrator</tt> Granted Rights</p></li>
<li><p>oper Role &ndash; <tt>Operator</tt> Granted Rights</p></li></ul>
</li></ol><a name="txconf-61"></a>Example&nbsp;4-4 Using the <tt>roleadd</tt> Command to Create a Local Security Administrator Role<a name="indexterm-174"></a><a name="indexterm-175"></a><a name="indexterm-176"></a><a name="indexterm-177"></a><p>In this example, the <tt>root</tt> user adds the Security Administrator role to the
local system by using the <tt>roleadd</tt> command. For details, see the <a href="http://docs.sun.com/doc/819-2240/roleadd-1m?a=view"><tt>roleadd</tt>(1M)</a> man page.
The <tt>root</tt> user consults <a href="ovw-36.html#ovw-tbl-4">Table&nbsp;1-2</a> before creating the role.</p><pre># <tt><b>roleadd -c "Local Security Administrator" -d /export/home1 \</b></tt>
<tt><b>-u 110 -P "Information Security,User Security" -K lock_after_retries=no \</b></tt>
<tt><b>-K idletime=5 -K idlecmd=lock -K labelview=showsl \</b></tt>
<tt><b>-K min_label=ADMIN_LOW -K clearance=ADMIN_HIGH secadmin</b></tt></pre><p>The <tt>root</tt> user provides an initial password for the role.</p><pre># <tt><b>passwd -r files secadmin</b></tt>
New Password:        &lt;Type password>
Re-enter new Password: &lt;Retype password>
passwd: password successfully changed for secadmin
#</pre><p>To assign the role to a local user, see <a href="#txconf-63">Example&nbsp;4-5</a>.</p>

<a name="txconf-25"></a><h4>Create Users Who Can Assume Roles in Trusted Extensions</h4><a name="indexterm-178"></a><a name="indexterm-179"></a><a name="indexterm-180"></a><p>To create a local user, you can use the command-line interface, as
in <a href="#txconf-63">Example&nbsp;4-5</a>, instead of the following procedure. Where site security policy permits, you
can choose to create a user who can assume more than one administrative
role.</p><p>For secure user creation, the System Administrator role creates the user, and the
Security Administrator role assigns security-relevant attributes, such as a password.</p><h6>Before You Begin</h6><p>You must be superuser, in the <tt>root</tt> role, in the Security Administrator role,
or in the Primary Administrator role. The Security Administrator role has the least
amount of privilege that is required for user creation.</p><p>The Solaris Management Console is displayed. For details, see <a href="#txconf-23">Create the Security Administrator Role in Trusted Extensions</a>.</p><ol>
<li><b>Double-click User Accounts in the Solaris Management Console.</b></li>
<li><b>From the Action menu, choose Add User &rarr; Use Wizard.</b>
<hr><p><b>Caution - </b>The names and IDs of roles and users come from the same
pool. Do not use existing names or IDs for the users that you
add.</p>
<hr>
</li>
<li><b>Follow the online help.</b><p>You can also follow the procedures in <a href="http://docs.sun.com/doc/819-2379/usersetup-21?a=view">How to Add a User With the Solaris Management Console&rsquo;s Users Tool in <i>System Administration Guide: Basic Administration</i></a>.</p></li>
<li><b>After creating the user, double-click the created user to modify the settings.</b>
<hr><p><b>Note - </b>For users who can assume roles, make the user account Always Available, and
do not set password expiration dates.</p>
<hr>
<p>Ensure that the following fields are correctly set:</p>
<ul><li><p>Description &ndash; No proprietary information here.</p></li>
<li><p>Password and confirm &ndash; Assign a password of at least 6 alphanumeric characters.</p>
<hr><p><b>Note - </b>When the install team chooses a password, the team must select a password that is difficult to guess, thus reducing the chance of an adversary gaining unauthorized access by attempting to guess passwords.</p>
<hr>
</li>
<li><p>Account Availability &ndash; Always Available.</p></li>
<li><p>Trusted Extensions Attributes &ndash; Defaults are correct.</p><p>For a single-label system where the labels must not be visible, choose Hide for Label: Show or Hide.</p></li>
<li><p>Account Usage &ndash; Set Idle time and Idle action.</p><p>Lock account &ndash; Set to No for any user who can assume a role.</p></li></ul>
</li>
<li><b>Customize the user's environment.</b><ul>
<li><b>Assign Convenient Authorizations</b><p>After checking your site security policy, you might want to grant your first
users the Convenient Authorizations rights profile. With this right, users can allocate devices, print
PostScript<sup>TM</sup> files, print without labels, remotely log in, and shut down the system.</p></li>
<li><b>Customize user initialization files</b><p>See <a href="http://docs.sun.com/doc/819-7309/manageusers-1?a=view">Chapter 7, Managing Users, Rights, and Roles in Trusted Extensions (Tasks), in <i>Solaris Trusted Extensions Administrator&rsquo;s Procedures</i></a>.</p><p>Also see <a href="http://docs.sun.com/doc/819-7309/usermgr-13?a=view">Managing Users and Rights With the Solaris Management Console (Task Map) in <i>Solaris Trusted Extensions Administrator&rsquo;s Procedures</i></a>.</p></li>
<li><b>Create multilabel copy and link files</b><p>On a multilabel system, users and roles can be set up with files
that list user initialization files to be copied or linked to other labels.
For more information, see <a href="http://docs.sun.com/doc/819-7309/manageusers-28?a=view">.copy_files and .link_files Files in <i>Solaris Trusted Extensions Administrator&rsquo;s Procedures</i></a>.</p></li></ul></li></ol><a name="txconf-63"></a>Example&nbsp;4-5 Using the <tt>useradd</tt> Command to Create a Local User<a name="indexterm-181"></a><a name="indexterm-182"></a><a name="indexterm-183"></a><a name="indexterm-184"></a><p>In this example, the <tt>root</tt> user creates a local user who can assume
the Security Administrator role. For details, see the <a href="http://docs.sun.com/doc/819-2240/useradd-1m?a=view"><tt>useradd</tt>(1M)</a> and <a href="http://docs.sun.com/doc/819-7307/atohexlabel-1m?a=view"><tt>atohexlabel</tt>(1M)</a> man
pages.</p><p>First, the <tt>root</tt> user determines the hexadecimal format of the user's minimum label
and clearance label.</p><pre># <tt><b>atohexlabel public</b></tt>
0x0002-08-08
# <tt><b>atohexlabel -c "confidential restricted"</b></tt>
0x0004-08-78</pre><p>Next, the <tt>root</tt> user consults <a href="ovw-36.html#ovw-tbl-4">Table&nbsp;1-2</a>, and then creates the user.</p><pre># <tt><b>useradd -c "Local user for Security Admin" -d /export/home1 \</b></tt>
<tt><b>-K idletime=10 -K idlecmd=logout -K lock_after_retries=no</b></tt>
<tt><b>-K min_label=0x0002-08-08 -K clearance=0x0004-08-78 -K labelview=showsl jandoe</b></tt></pre><p>Then, the <tt>root</tt> user provides an initial password.</p><pre># <tt><b>passwd -r files jandoe</b></tt>
New Password:    &lt;Type password>
Re-enter new Password: &lt;Retype password>
passwd: password successfully changed for jandoe
#</pre><p>Finally, the <tt>root</tt> user adds the Security Administrator role to the user's definition.
The role was created in <a href="#txconf-23">Create the Security Administrator Role in Trusted Extensions</a>.</p><pre># <tt><b>usermod -R secadmin jandoe</b></tt></pre>

<a name="txconf-29"></a><h4>Verify That the Trusted Extensions Roles Work</h4><a name="indexterm-185"></a><a name="indexterm-186"></a><a name="indexterm-187"></a><p>To verify each role, assume the role. Then, perform tasks that only that
role can perform.</p><h6>Before You Begin</h6><p>If you have configured DNS or routing, you must reboot after you
create the roles and before you verify that the roles work.</p><ol>
<li><b>For each role, log in as a user who can assume the
role.</b></li>
<li><b>Open the Trusted Path menu.</b><ul>
<li><b>In Trusted CDE, click the workspace switch area.</b></li>
<li><b>In Trusted JDS, click the trusted symbol.</b></li></ul><br><img src="figures/tpmenu.gif" alt="Illustration shows the Trusted Path menu in CDE." width="174" height="240"></img></li>
<li><b>From the menu, assume the role.</b></li>
<li><b>In the role workspace, start the Solaris Management Console.</b><pre>$ <tt><b>/usr/sbin/smc &amp;</b></tt></pre></li>
<li><b>Select the appropriate scope for the role that you are testing.</b></li>
<li><b>Click System Services, and navigate to Users.</b><p>You are prompted for a password.</p><ol style="list-style-type: lower-alpha">
				 
<li><b>Type the role password.</b></li>
<li><b>Double-click User Accounts.</b></li></ol></li>
<li><b>Click a user.</b>
<ul><li><p>The System Administrator role should be able to modify fields under the General, Home Directory, and Group tabs.</p></li>
<li><p>The Security Administrator role should be able to modify fields under all tabs.</p></li>
<li><p>The Primary Administrator role should be able to modify fields under all tabs.</p></li></ul>
</li></ol>

<a name="txconf-34"></a><h4>Enable Users to Log In to a Labeled Zone</h4><a name="indexterm-188"></a><a name="indexterm-189"></a><a name="indexterm-190"></a><p>When the host is rebooted, the association between the devices and the underlying
storage must be re-established.</p><h6>Before You Begin</h6><p>You have created at least one labeled zone. That zone is not
being used for cloning.</p><ol>
<li><b>Reboot the system.</b></li>
<li><b>Log in as the <tt>root</tt> user.</b></li>
<li><b>Restart the zones service.</b><pre># <tt><b>svcs zones</b></tt>
STATE          STIME    FMRI
offline        -        svc:/system/zones:default</pre><pre># <tt><b>svcadm restart svc:/system/zones:default</b></tt></pre></li>
<li><b>Log out.</b><p>Regular users can now log in. Their session is in a labeled zone.</p></li></ol>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="txconf-20.html">Previous</a>
             </td>
             <td align="right">
                 <a href="txconf-50.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

