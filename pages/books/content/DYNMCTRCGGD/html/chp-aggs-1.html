<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Aggregating Functions - Solaris Dynamic Tracing Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-11-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">Solaris Dynamic Tracing Guide</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="chp-aggs.html">Previous</a>
             </td>
             <td align="right">
                 <a href="chp-aggs-2.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="chp-intro.html">1.&nbsp;&nbsp;Introduction</a></p>
<p class="toc level1 tocsp"><a href="chp-typeopexpr.html">2.&nbsp;&nbsp;Types, Operators, and Expressions</a></p>
<p class="toc level1 tocsp"><a href="chp-variables.html">3.&nbsp;&nbsp;Variables</a></p>
<p class="toc level1 tocsp"><a href="chp-prog.html">4.&nbsp;&nbsp;D Program Structure</a></p>
<p class="toc level1 tocsp"><a href="chp-pointers.html">5.&nbsp;&nbsp;Pointers and Arrays</a></p>
<p class="toc level1 tocsp"><a href="chp-strings.html">6.&nbsp;&nbsp;Strings</a></p>
<p class="toc level1 tocsp"><a href="chp-structs.html">7.&nbsp;&nbsp;Structs and Unions</a></p>
<p class="toc level1 tocsp"><a href="chp-types.html">8.&nbsp;&nbsp;Type and Constant Definitions</a></p>
<p class="toc level1 tocsp"><a href="chp-aggs.html">9.&nbsp;&nbsp;Aggregations</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Aggregating Functions</a></p>
</div>
<p class="toc level2"><a href="chp-aggs-2.html">Aggregations</a></p>
<p class="toc level2"><a href="chp-aggs-7.html">Printing Aggregations</a></p>
<p class="toc level2"><a href="chp-aggs-normalization.html">Data Normalization</a></p>
<p class="toc level2"><a href="chp-aggs-clear.html">Clearing Aggregations</a></p>
<p class="toc level2"><a href="chp-aggs-trunc.html">Truncating aggregations</a></p>
<p class="toc level2"><a href="chp-aggs-4.html">Minimizing Drops</a></p>
<p class="toc level1 tocsp"><a href="chp-actsub.html">10.&nbsp;&nbsp;Actions and Subroutines</a></p>
<p class="toc level1 tocsp"><a href="chp-buf.html">11.&nbsp;&nbsp;Buffers and Buffering</a></p>
<p class="toc level1 tocsp"><a href="chp-fmt.html">12.&nbsp;&nbsp;Output Formatting</a></p>
<p class="toc level1 tocsp"><a href="chp-spec.html">13.&nbsp;&nbsp;Speculative Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-dtrace1m.html">14.&nbsp;&nbsp;<tt>dtrace</tt>(1M) Utility</a></p>
<p class="toc level1 tocsp"><a href="chp-script.html">15.&nbsp;&nbsp;Scripting</a></p>
<p class="toc level1 tocsp"><a href="chp-opt.html">16.&nbsp;&nbsp;Options and Tunables</a></p>
<p class="toc level1 tocsp"><a href="chp-dtrace.html">17.&nbsp;&nbsp;<tt>dtrace</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-lockstat.html">18.&nbsp;&nbsp;<tt>lockstat</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-profile.html">19.&nbsp;&nbsp;<tt>profile</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-fbt.html">20.&nbsp;&nbsp;<tt>fbt</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-syscall.html">21.&nbsp;&nbsp;<tt>syscall</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-sdt.html">22.&nbsp;&nbsp;<tt>sdt</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-sysinfo.html">23.&nbsp;&nbsp;<tt>sysinfo</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-vminfo.html">24.&nbsp;&nbsp;<tt>vminfo</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-proc.html">25.&nbsp;&nbsp;<tt>proc</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-sched.html">26.&nbsp;&nbsp;<tt>sched</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-io.html">27.&nbsp;&nbsp;<tt>io</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-mib.html">28.&nbsp;&nbsp;<tt>mib</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-fpuinfo.html">29.&nbsp;&nbsp;<tt>fpuinfo</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-pid.html">30.&nbsp;&nbsp;<tt>pid</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-plockstat.html">31.&nbsp;&nbsp;<tt>plockstat</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-fasttrap.html">32.&nbsp;&nbsp;<tt>fasttrap</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-user.html">33.&nbsp;&nbsp;User Process Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-usdt.html">34.&nbsp;&nbsp;Statically Defined Tracing for User Applications</a></p>
<p class="toc level1 tocsp"><a href="chp-sec.html">35.&nbsp;&nbsp;Security</a></p>
<p class="toc level1 tocsp"><a href="chp-anon.html">36.&nbsp;&nbsp;Anonymous Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-post.html">37.&nbsp;&nbsp;Postmortem Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-perf.html">38.&nbsp;&nbsp;Performance Considerations</a></p>
<p class="toc level1 tocsp"><a href="chp-stab.html">39.&nbsp;&nbsp;Stability</a></p>
<p class="toc level1 tocsp"><a href="chp-xlate.html">40.&nbsp;&nbsp;Translators</a></p>
<p class="toc level1 tocsp"><a href="chp-vers.html">41.&nbsp;&nbsp;Versioning</a></p>
<p class="toc level1 tocsp"><a href="gloss01.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="chp-aggs-1"></a><h3>Aggregating Functions</h3>
<p>An <b>aggregating function</b> is one that has the following property:</p><tt>f(f(x</tt><sub>0</sub><tt>) U f(x</tt><sub>1</sub><tt>) U ... U f(x</tt><sub>n</sub><tt>)) = f(x</tt><sub>0</sub> <tt>U x</tt><sub>1</sub> <tt>U ... U x</tt><sub>n</sub><tt>)</tt><p>where <i>x</i><sub><i>n</i></sub> is a set of arbitrary data. That is, applying an aggregating
function to subsets of the whole and then applying it again to the
results gives the same result as applying it to the whole itself. For
example, consider a function <tt>SUM</tt> that yields the summation of a given
data set. If the raw data consists of {2, 1, 2, 5, 4,
3, 6, 4, 2}, the result of applying <tt>SUM</tt> to the entire set
is {29}. Similarly, the result of applying <tt>SUM</tt> to the subset consisting of
the first three elements is {5}, the result of applying <tt>SUM</tt> to
the set consisting of the subsequent three elements is {12}, and the result
of of applying <tt>SUM</tt> to the remaining three elements is also {12}. <tt>SUM</tt>
is an aggregating function because applying it to the set of these results,
{5, 12, 12}, yields the same result, {29}, as applying <tt>SUM</tt> to the
original data.</p><p>Not all functions are aggregating functions. An example of a non-aggregating function is
the function <tt>MEDIAN</tt> that determines the median element of the set. (The median
is defined to be that element of a set for which as many
elements in the set are greater than it as are less than
it.) The <tt>MEDIAN</tt> is derived by sorting the set and selecting the middle element.
Returning to the original raw data, if <tt>MEDIAN</tt> is applied to the set
consisting of the first three elements, the result is {2}. (The sorted set
is {1, 2, 2}; {2} is the set consisting of the middle
element.) Likewise, applying <tt>MEDIAN</tt> to the next three elements yields {4} and applying <tt>MEDIAN</tt>
to the final three elements yields {4}. Applying <tt>MEDIAN</tt> to each of the
subsets thus yields the set {2, 4, 4}. Applying <tt>MEDIAN</tt> to this set
yields the result {4}. However, sorting the original set yields {1, 2, 2,
2, 3, 4, 4, 5, 6}. Applying <tt>MEDIAN</tt> to this set thus yields
{3}. Because these results do not match, <tt>MEDIAN</tt> is not an aggregating function.</p><p>Many common functions for understanding a set of data are aggregating functions. These
functions include counting the number of elements in the set, computing the minimum
value of the set, computing the maximum value of the set, and summing
all elements in the set. Determining the arithmetic mean of the set can
be constructed from the function to count the number of elements in the
set and the function to sum the number the elements in the
set.</p><p>However, several useful functions are not aggregating functions. These functions include computing the
mode (the most common element) of a set, the median value of the
set, or the standard deviation of the set.</p><p>Applying aggregating functions to data as it is traced has a number of
advantages:</p>
<ul><li><p>The entire data set need not be stored. Whenever a new element is to be added to the set, the aggregating function is calculated given the set consisting of the current intermediate result and the new element. After the new result is calculated, the new element may be discarded. This process reduces the amount of storage required by a factor of the number of data points, which is often quite large.</p></li>
<li><p>Data collection does not induce pathological scalability problems. Aggregating functions enable intermediate results to be kept <b>per-CPU</b> instead of in a shared data structure. DTrace then applies the aggregating function to the set consisting of the per-CPU intermediate results to produce the final system-wide result.</p></li></ul>

         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="chp-aggs.html">Previous</a>
             </td>
             <td align="right">
                 <a href="chp-aggs-2.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

