<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Arguments - Solaris Dynamic Tracing Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-11-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">Solaris Dynamic Tracing Guide</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="gelrk.html">Previous</a>
             </td>
             <td align="right">
                 <a href="chp-io-examples.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="chp-intro.html">1.&nbsp;&nbsp;Introduction</a></p>
<p class="toc level1 tocsp"><a href="chp-typeopexpr.html">2.&nbsp;&nbsp;Types, Operators, and Expressions</a></p>
<p class="toc level1 tocsp"><a href="chp-variables.html">3.&nbsp;&nbsp;Variables</a></p>
<p class="toc level1 tocsp"><a href="chp-prog.html">4.&nbsp;&nbsp;D Program Structure</a></p>
<p class="toc level1 tocsp"><a href="chp-pointers.html">5.&nbsp;&nbsp;Pointers and Arrays</a></p>
<p class="toc level1 tocsp"><a href="chp-strings.html">6.&nbsp;&nbsp;Strings</a></p>
<p class="toc level1 tocsp"><a href="chp-structs.html">7.&nbsp;&nbsp;Structs and Unions</a></p>
<p class="toc level1 tocsp"><a href="chp-types.html">8.&nbsp;&nbsp;Type and Constant Definitions</a></p>
<p class="toc level1 tocsp"><a href="chp-aggs.html">9.&nbsp;&nbsp;Aggregations</a></p>
<p class="toc level1 tocsp"><a href="chp-actsub.html">10.&nbsp;&nbsp;Actions and Subroutines</a></p>
<p class="toc level1 tocsp"><a href="chp-buf.html">11.&nbsp;&nbsp;Buffers and Buffering</a></p>
<p class="toc level1 tocsp"><a href="chp-fmt.html">12.&nbsp;&nbsp;Output Formatting</a></p>
<p class="toc level1 tocsp"><a href="chp-spec.html">13.&nbsp;&nbsp;Speculative Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-dtrace1m.html">14.&nbsp;&nbsp;<tt>dtrace</tt>(1M) Utility</a></p>
<p class="toc level1 tocsp"><a href="chp-script.html">15.&nbsp;&nbsp;Scripting</a></p>
<p class="toc level1 tocsp"><a href="chp-opt.html">16.&nbsp;&nbsp;Options and Tunables</a></p>
<p class="toc level1 tocsp"><a href="chp-dtrace.html">17.&nbsp;&nbsp;<tt>dtrace</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-lockstat.html">18.&nbsp;&nbsp;<tt>lockstat</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-profile.html">19.&nbsp;&nbsp;<tt>profile</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-fbt.html">20.&nbsp;&nbsp;<tt>fbt</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-syscall.html">21.&nbsp;&nbsp;<tt>syscall</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-sdt.html">22.&nbsp;&nbsp;<tt>sdt</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-sysinfo.html">23.&nbsp;&nbsp;<tt>sysinfo</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-vminfo.html">24.&nbsp;&nbsp;<tt>vminfo</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-proc.html">25.&nbsp;&nbsp;<tt>proc</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-sched.html">26.&nbsp;&nbsp;<tt>sched</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-io.html">27.&nbsp;&nbsp;<tt>io</tt> Provider</a></p>
<p class="toc level2"><a href="gelrk.html">Probes</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Arguments</a></p>
</div>
<p class="toc level2"><a href="chp-io-examples.html">Examples</a></p>
<p class="toc level2"><a href="chp-io-stability.html">Stability</a></p>
<p class="toc level1 tocsp"><a href="chp-mib.html">28.&nbsp;&nbsp;<tt>mib</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-fpuinfo.html">29.&nbsp;&nbsp;<tt>fpuinfo</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-pid.html">30.&nbsp;&nbsp;<tt>pid</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-plockstat.html">31.&nbsp;&nbsp;<tt>plockstat</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-fasttrap.html">32.&nbsp;&nbsp;<tt>fasttrap</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-user.html">33.&nbsp;&nbsp;User Process Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-usdt.html">34.&nbsp;&nbsp;Statically Defined Tracing for User Applications</a></p>
<p class="toc level1 tocsp"><a href="chp-sec.html">35.&nbsp;&nbsp;Security</a></p>
<p class="toc level1 tocsp"><a href="chp-anon.html">36.&nbsp;&nbsp;Anonymous Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-post.html">37.&nbsp;&nbsp;Postmortem Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-perf.html">38.&nbsp;&nbsp;Performance Considerations</a></p>
<p class="toc level1 tocsp"><a href="chp-stab.html">39.&nbsp;&nbsp;Stability</a></p>
<p class="toc level1 tocsp"><a href="chp-xlate.html">40.&nbsp;&nbsp;Translators</a></p>
<p class="toc level1 tocsp"><a href="chp-vers.html">41.&nbsp;&nbsp;Versioning</a></p>
<p class="toc level1 tocsp"><a href="gloss01.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="chp-io-args"></a><h3>Arguments</h3>
<p><a name="indexterm-403"></a>The argument types for the <tt>io</tt> probes are listed in <a href="#tbl-io-args">Table&nbsp;27-2</a>. The arguments are
described in <a href="gelrk.html#tbl-io">Table&nbsp;27-1</a>.</p><a name="tbl-io-args"></a><h6>Table&nbsp;27-2 <tt>io</tt> Probe Arguments</h6><table><col width="25%"><col width="25%"><col width="25%"><col width="25%"><tr><th align="left" valign="top" scope="column"><p>Probe</p></th>
<th align="left" valign="top" scope="column"><p><tt>args[0]</tt></p></th>
<th align="left" valign="top" scope="column"><p><tt>args[1]</tt></p></th>
<th align="left" valign="top" scope="column"><p><tt>args[2]</tt></p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>start</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>struct buf *</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>devinfo_t *</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>fileinfo_t *</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>done</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>struct buf *</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>devinfo_t *</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>fileinfo_t *</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>wait-start</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>struct buf *</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>devinfo_t *</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>fileinfo_t *</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>wait-done</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>struct buf *</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>devinfo_t *</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>fileinfo_t *</tt></p></td>
</tr>
</table><p>Each <tt>io</tt> probe has arguments consisting of a pointer to a <tt>buf</tt>(9S) structure, a
pointer to a <tt>devinfo_t</tt>, and a pointer to a <tt>fileinfo_t</tt>. These structures
are described in greater detail in this section.</p>

<a name="chp-io-buf"></a><h4><tt>bufinfo_t</tt> structure</h4>
<p><a name="indexterm-404"></a><a name="indexterm-405"></a>The <tt>bufinfo_t</tt> structure is the abstraction that describes an I/O request. The buffer
corresponding to an I/O request is pointed to by <tt>args[0]</tt> in the <tt>start</tt>,
<tt>done</tt>, <tt>wait-start</tt>, and <tt>wait-done</tt> probes. The <tt>bufinfo_t</tt> structure definition is as follows:</p><pre>typedef struct bufinfo {
    int b_flags;                    /* flags */
    size_t b_bcount;                /* number of bytes */
    caddr_t b_addr;                 /* buffer address */
    uint64_t b_blkno;               /* expanded block # on device */
    uint64_t b_lblkno;              /* block # on device */
    size_t b_resid;                 /* # of bytes not transferred */
    size_t b_bufsize;               /* size of allocated buffer */ 
    caddr_t b_iodone;               /* I/O completion routine */
    dev_t b_edev;                   /* extended device */
 } bufinfo_t;</pre><p><a name="indexterm-406"></a>The <tt>b_flags</tt> member indicates the state of the I/O buffer, and consists of
a bitwise-or of different state values. The valid state values are in <a href="#tbl-io-flags">Table&nbsp;27-3</a>.</p><a name="tbl-io-flags"></a><h6>Table&nbsp;27-3 <tt>b_flags</tt> Values</h6><table><col width="25%"><col width="75%"><tr><td align="left" valign="top" scope="row"><p><tt>B_DONE</tt></p></td>
<td align="left" valign="top" scope="row"><p>Indicates
that the data transfer has completed.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>B_ERROR</tt></p></td>
<td align="left" valign="top" scope="row"><p>Indicates an I/O transfer error. It is
set in conjunction with the <tt>b_error</tt> field.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>B_PAGEIO</tt></p></td>
<td align="left" valign="top" scope="row"><p>Indicates that the buffer is being
used in a paged I/O request. See the description of the <tt>b_addr</tt> field
for more information.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>B_PHYS</tt></p></td>
<td align="left" valign="top" scope="row"><p>Indicates that the buffer is being used for physical 
(direct) I/O to a user data area.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>B_READ</tt></p></td>
<td align="left" valign="top" scope="row"><p>Indicates that data is to be read
from the peripheral device into main memory.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>B_WRITE</tt></p></td>
<td align="left" valign="top" scope="row"><p>Indicates that the data is to be
transferred from main memory to the peripheral device.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>B_ASYNC</tt></p></td>
<td align="left" valign="top" scope="row"><p>The I/O request is asynchronous, and
will not be waited upon. The <tt>wait-start</tt> and <tt>wait-done</tt> probes don't fire
for asynchronous I/O requests. Note that some I/Os directed to be asynchronous might not
have <tt>B_ASYNC</tt> set: the asynchronous I/O subsystem might implement the asynchronous request by
having a separate worker thread perform a synchronous I/O operation.</p></td>
</tr>
</table><p>The <tt>b_bcount</tt> field is the number of bytes to be transferred as part
of the I/O request.</p><p>The <tt>b_addr</tt> field is the virtual address of the I/O request, unless <tt>B_PAGEIO</tt>
is set. The address is a kernel virtual address unless <tt>B_PHYS</tt> is set,
in which case it is a user virtual address. If <tt>B_PAGEIO</tt> is set,
the <tt>b_addr</tt> field contains kernel private data. Exactly one of <tt>B_PHYS</tt> and
<tt>B_PAGEIO</tt> can be set, or neither flag will be set.</p><p>The <tt>b_lblkno</tt> field identifies which logical block on the device is to be
accessed. The mapping from a logical block to a physical block (such as
the cylinder, track, and so on) is defined by the device.</p><p>The <tt>b_resid</tt> field is set to the number of bytes not transferred because
of an error.</p><p>The <tt>b_bufsize</tt> field contains the size of the allocated buffer.</p><p>The <tt>b_iodone</tt> field identifies a specific routine in the kernel that is called
when the I/O is complete.</p><p>The <tt>b_error</tt> field may hold an error code returned from the driver in
the event of an I/O error. <tt>b_error</tt> is set in conjunction with the
<tt>B_ERROR</tt> bit set in the <tt>b_flags</tt> member.</p><p>The <tt>b_edev</tt> field contains the major and minor device numbers of the device
accessed. Consumers may use the D subroutines <tt>getmajor()</tt> and <tt>getminor()</tt> to extract
the major and minor device numbers from the <tt>b_edev</tt> field.</p>

<a name="chp-io-devinfo"></a><h4><tt>devinfo_t</tt></h4>
<p><a name="indexterm-407"></a><a name="indexterm-408"></a>The <tt>devinfo_t</tt> structure provides information about a device. The <tt>devinfo_t</tt> structure corresponding
to the destination device of an I/O is pointed to by <tt>args[1]</tt> in
the <tt>start</tt>, <tt>done</tt>, <tt>wait-start</tt>, and <tt>wait-done</tt> probes. The members of <tt>devinfo_t</tt> are as
follows:</p><pre>typedef struct devinfo {
    int dev_major;                  /* major number */
    int dev_minor;                  /* minor number */
    int dev_instance;               /* instance number */
    string dev_name;                /* name of device */
    string dev_statname;            /* name of device + instance/minor */
    string dev_pathname;            /* pathname of device */
} devinfo_t;</pre><p>The <tt>dev_major</tt> field is the major number of the device. See <tt>getmajor</tt>(9F) for more
information.</p><p>The <tt>dev_minor</tt> field is the minor number of the device. See <tt>getminor</tt>(9F) for more
information.</p><p>The <tt>dev_instance</tt> field is the instance number of the device. The instance of
a device is different from the minor number. The minor number is an
abstraction managed by the device driver. The instance number is a property of
the device node. You can display device node instance numbers with <a href="http://docs.sun.com/doc/819-2240/prtconf-1m?a=view"><tt>prtconf</tt>(1M)</a>.</p><p>The <tt>dev_name</tt> field is the name of the device driver that manages the
device. You can display device driver names with the <tt>-D</tt> option to <a href="http://docs.sun.com/doc/819-2240/prtconf-1m?a=view"><tt>prtconf</tt>(1M)</a>.</p><p>The <tt>dev_statname</tt> field is the name of the device as reported by <a href="http://docs.sun.com/doc/819-2240/iostat-1m?a=view"><tt>iostat</tt>(1M)</a>. This
name also corresponds to the name of a kernel statistic as reported
by <a href="http://docs.sun.com/doc/819-2240/kstat-1m?a=view"><tt>kstat</tt>(1M)</a>. This field is provided so that aberrant <tt>iostat</tt> or <tt>kstat</tt> output can
be quickly correlated to actual I/O activity.</p><p>The <tt>dev_pathname</tt> field is the full path of the device. This path may
be specified as an argument to <a href="http://docs.sun.com/doc/819-2240/prtconf-1m?a=view"><tt>prtconf</tt>(1M)</a> to obtain detailed device information. The
path specified by <tt>dev_pathname</tt> includes components expressing the device node, the instance number,
and the minor node. However, all three of these elements aren't necessarily expressed
in the statistics name. For some devices, the statistics name consists of the device
name and the instance number. For other devices, the name consists of the
device name and the number of the minor node. As a result,
two devices that have the same <tt>dev_statname</tt> may differ in <tt>dev_pathname</tt>.</p>

<a name="chp-io-fileinfo"></a><h4><tt>fileinfo_t</tt></h4>
<p><a name="indexterm-409"></a><a name="indexterm-410"></a>The <tt>fileinfo_t</tt> structure provides information about a file. The file to which an
I/O corresponds is pointed to by <tt>args[2]</tt> in the <tt>start</tt>, <tt>done</tt>, <tt>wait-start</tt>, and <tt>wait-done</tt>
probes. The presence of file information is contingent upon the filesystem providing this
information when dispatching I/O requests. Some filesystems, especially third-party filesystems, might not provide this
information. Also, I/O requests might emanate from a filesystem for which no file
information exists. For example, any I/O to filesystem metadata will not be associated
with any one file. Finally, some highly optimized filesystems might aggregate I/O from
disjoint files into a single I/O request. In this case, the filesystem might
provide the file information either for the file that represents the majority of
the I/O or for the file that represents <b>some</b> of the I/O.
Alternately, the filesystem might provide no file information at all in this case.</p><p>The definition of the <tt>fileinfo_t</tt> structure is as follows:</p><pre>typedef struct fileinfo {
    string fi_name;                 /* name (basename of fi_pathname) */
    string fi_dirname;              /* directory (dirname of fi_pathname) */
    string fi_pathname;             /* full pathname */
    offset_t fi_offset;             /* offset within file */
    string fi_fs;                   /* filesystem */
    string fi_mount;                /* mount point of file system */
} fileinfo_t;</pre><p>The <tt>fi_name</tt> field contains the name of the file but does not include
any directory components. If no file information is associated with an I/O, the
<tt>fi_name</tt> field will be set to the string <tt>&lt;none&gt;</tt>. In some rare
cases, the pathname associated with a file might be unknown. In this case,
the <tt>fi_name</tt> field will be set to the string <tt>&lt;unknown&gt;</tt>.</p><p>The <tt>fi_dirname</tt> field contains <b>only</b> the directory component of the file name. As
with <tt>fi_name</tt>, this string may be set to <tt>&lt;none&gt;</tt> if no file information is
present, or <tt>&lt;unknown&gt;</tt> if the pathname associated with the file is not known.</p><p>The <tt>fi_pathname</tt> field contains the full pathname to the file. As with <tt>fi_name</tt>,
this string may be set to <tt>&lt;none&gt;</tt> if no file information is
present, or <tt>&lt;unknown&gt;</tt> if the pathname associated with the file is not known.</p><p>The <tt>fi_offset</tt> field contains the offset within the file , or -1 if
either file information is not present or if the offset is otherwise unspecified
by the filesystem.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="gelrk.html">Previous</a>
             </td>
             <td align="right">
                 <a href="chp-io-examples.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

