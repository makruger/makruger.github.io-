<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Readers/Writer Lock Probes - Solaris Dynamic Tracing Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-11-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">Solaris Dynamic Tracing Guide</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="chp-lockstat-7.html">Previous</a>
             </td>
             <td align="right">
                 <a href="chp-lockstat-stability.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="chp-intro.html">1.&nbsp;&nbsp;Introduction</a></p>
<p class="toc level1 tocsp"><a href="chp-typeopexpr.html">2.&nbsp;&nbsp;Types, Operators, and Expressions</a></p>
<p class="toc level1 tocsp"><a href="chp-variables.html">3.&nbsp;&nbsp;Variables</a></p>
<p class="toc level1 tocsp"><a href="chp-prog.html">4.&nbsp;&nbsp;D Program Structure</a></p>
<p class="toc level1 tocsp"><a href="chp-pointers.html">5.&nbsp;&nbsp;Pointers and Arrays</a></p>
<p class="toc level1 tocsp"><a href="chp-strings.html">6.&nbsp;&nbsp;Strings</a></p>
<p class="toc level1 tocsp"><a href="chp-structs.html">7.&nbsp;&nbsp;Structs and Unions</a></p>
<p class="toc level1 tocsp"><a href="chp-types.html">8.&nbsp;&nbsp;Type and Constant Definitions</a></p>
<p class="toc level1 tocsp"><a href="chp-aggs.html">9.&nbsp;&nbsp;Aggregations</a></p>
<p class="toc level1 tocsp"><a href="chp-actsub.html">10.&nbsp;&nbsp;Actions and Subroutines</a></p>
<p class="toc level1 tocsp"><a href="chp-buf.html">11.&nbsp;&nbsp;Buffers and Buffering</a></p>
<p class="toc level1 tocsp"><a href="chp-fmt.html">12.&nbsp;&nbsp;Output Formatting</a></p>
<p class="toc level1 tocsp"><a href="chp-spec.html">13.&nbsp;&nbsp;Speculative Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-dtrace1m.html">14.&nbsp;&nbsp;<tt>dtrace</tt>(1M) Utility</a></p>
<p class="toc level1 tocsp"><a href="chp-script.html">15.&nbsp;&nbsp;Scripting</a></p>
<p class="toc level1 tocsp"><a href="chp-opt.html">16.&nbsp;&nbsp;Options and Tunables</a></p>
<p class="toc level1 tocsp"><a href="chp-dtrace.html">17.&nbsp;&nbsp;<tt>dtrace</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-lockstat.html">18.&nbsp;&nbsp;<tt>lockstat</tt> Provider</a></p>
<p class="toc level2"><a href="chp-lockstat-1.html">Overview</a></p>
<p class="toc level2"><a href="chp-lockstat-2.html">Adaptive Lock Probes</a></p>
<p class="toc level2"><a href="chp-lockstat-5.html">Spin Lock Probes</a></p>
<p class="toc level2"><a href="chp-lockstat-7.html">Thread Locks</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Readers/Writer Lock Probes</a></p>
</div>
<p class="toc level2"><a href="chp-lockstat-stability.html">Stability</a></p>
<p class="toc level1 tocsp"><a href="chp-profile.html">19.&nbsp;&nbsp;<tt>profile</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-fbt.html">20.&nbsp;&nbsp;<tt>fbt</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-syscall.html">21.&nbsp;&nbsp;<tt>syscall</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-sdt.html">22.&nbsp;&nbsp;<tt>sdt</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-sysinfo.html">23.&nbsp;&nbsp;<tt>sysinfo</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-vminfo.html">24.&nbsp;&nbsp;<tt>vminfo</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-proc.html">25.&nbsp;&nbsp;<tt>proc</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-sched.html">26.&nbsp;&nbsp;<tt>sched</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-io.html">27.&nbsp;&nbsp;<tt>io</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-mib.html">28.&nbsp;&nbsp;<tt>mib</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-fpuinfo.html">29.&nbsp;&nbsp;<tt>fpuinfo</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-pid.html">30.&nbsp;&nbsp;<tt>pid</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-plockstat.html">31.&nbsp;&nbsp;<tt>plockstat</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-fasttrap.html">32.&nbsp;&nbsp;<tt>fasttrap</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-user.html">33.&nbsp;&nbsp;User Process Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-usdt.html">34.&nbsp;&nbsp;Statically Defined Tracing for User Applications</a></p>
<p class="toc level1 tocsp"><a href="chp-sec.html">35.&nbsp;&nbsp;Security</a></p>
<p class="toc level1 tocsp"><a href="chp-anon.html">36.&nbsp;&nbsp;Anonymous Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-post.html">37.&nbsp;&nbsp;Postmortem Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-perf.html">38.&nbsp;&nbsp;Performance Considerations</a></p>
<p class="toc level1 tocsp"><a href="chp-stab.html">39.&nbsp;&nbsp;Stability</a></p>
<p class="toc level1 tocsp"><a href="chp-xlate.html">40.&nbsp;&nbsp;Translators</a></p>
<p class="toc level1 tocsp"><a href="chp-vers.html">41.&nbsp;&nbsp;Versioning</a></p>
<p class="toc level1 tocsp"><a href="gloss01.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="chp-lockstat-9"></a><h3>Readers/Writer Lock Probes</h3>
<p><a name="indexterm-310"></a><a name="indexterm-311"></a><b>Readers/writer locks</b> enforce a policy of allowing multiple readers <b>or</b> a single writer
&mdash; but not both &mdash; to be in a critical section. These locks
are typically used for structures that are searched more frequently than they are
modified and for which there is substantial time in the critical section. If
critical section times are short, readers/writer locks will implicitly serialize over the shared
memory used to implement the lock, giving them no advantage over adaptive locks.
See <tt>rwlock</tt>(9F) for more details on readers/writer locks.</p><p>The probes pertaining to readers/writer locks are in <a href="#tbl-rwlock">Table&nbsp;18-4</a>. For each probe,
<tt>arg0</tt> contains a pointer to the <tt>krwlock_t</tt> structure that represents the adaptive lock.</p><a name="tbl-rwlock"></a><h6>Table&nbsp;18-4 Readers/Writer Lock Probes</h6><table><col width="20%"><col width="80%"><tr><td align="left" valign="top" scope="row"><p><tt>rw-acquire</tt></p></td>
<td align="left" valign="top" scope="row"><p>Hold-event
probe that fires immediately after a readers/writer lock is acquired. <tt>arg1</tt> contains the
constant <tt>RW_READER</tt> if the lock was acquired as a reader, and <tt>RW_WRITER</tt> if
the lock was acquired as a writer.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>rw-block</tt></p></td>
<td align="left" valign="top" scope="row"><p>Contention-event probe that fires after a thread
that has blocked on a held readers/writer lock has reawakened and has acquired
the lock. <tt>arg1</tt> contains the length of time (in nanoseconds) that the
current thread had to sleep to acquire the lock. <tt>arg2</tt> contains the constant
<tt>RW_READER</tt> if the lock was acquired as a reader, and <tt>RW_WRITER</tt> if the
lock was acquired as a writer. <tt>arg3</tt> and <tt>arg4</tt> contain more information on
the reason for blocking. <tt>arg3</tt> is non-zero if and only if the lock
was held as a writer when the current thread blocked. <tt>arg4</tt> contains
the readers count when the current thread blocked. If both the <tt>rw-block</tt> and
<tt>rw-acquire</tt> probes are enabled, <tt>rw-block</tt> fires <b>before</b> <tt>rw-acquire</tt>.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>rw-upgrade</tt></p></td>
<td align="left" valign="top" scope="row"><p>Hold-event probe that fires after a
thread has successfully upgraded a readers/writer lock from a reader to a writer.
Upgrades do not have an associated contention event because they are only possible
through a non-blocking interface, <tt>rw_tryupgrade</tt>(9F).</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>rw-downgrade</tt></p></td>
<td align="left" valign="top" scope="row"><p>Hold-event probe that fires after a thread had
downgraded its ownership of a readers/writer lock from writer to reader. Downgrades do
not have an associated contention event because they always succeed without contention.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>rw-release</tt></p></td>
<td align="left" valign="top" scope="row"><p>Hold-event probe
that fires immediately after a readers/writer lock is released. <tt>arg1</tt> contains the constant
<tt>RW_READER</tt> if the released lock was held as a reader, and <tt>RW_WRITER</tt> if the
released lock was held as a writer. Due to upgrades and downgrades,
the lock may <b>not</b> have been released as it was acquired.</p></td>
</tr>
</table>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="chp-lockstat-7.html">Previous</a>
             </td>
             <td align="right">
                 <a href="chp-lockstat-stability.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

