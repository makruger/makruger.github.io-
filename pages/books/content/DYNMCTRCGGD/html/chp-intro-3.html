<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Compilation and Instrumentation - Solaris Dynamic Tracing Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-11-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">Solaris Dynamic Tracing Guide</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="chp-intro-2.html">Previous</a>
             </td>
             <td align="right">
                 <a href="chp-intro-4.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="chp-intro.html">1.&nbsp;&nbsp;Introduction</a></p>
<p class="toc level2"><a href="chp-intro-1.html">Getting Started</a></p>
<p class="toc level2"><a href="chp-intro-2.html">Providers and Probes</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Compilation and Instrumentation</a></p>
</div>
<p class="toc level2"><a href="chp-intro-4.html">Variables and Arithmetic Expressions</a></p>
<p class="toc level2"><a href="chp-intro-5.html">Predicates</a></p>
<p class="toc level2"><a href="chp-intro-6.html">Output Formatting</a></p>
<p class="toc level2"><a href="chp-intro-7.html">Arrays</a></p>
<p class="toc level2"><a href="chp-intro-8.html">External Symbols and Types</a></p>
<p class="toc level1 tocsp"><a href="chp-typeopexpr.html">2.&nbsp;&nbsp;Types, Operators, and Expressions</a></p>
<p class="toc level1 tocsp"><a href="chp-variables.html">3.&nbsp;&nbsp;Variables</a></p>
<p class="toc level1 tocsp"><a href="chp-prog.html">4.&nbsp;&nbsp;D Program Structure</a></p>
<p class="toc level1 tocsp"><a href="chp-pointers.html">5.&nbsp;&nbsp;Pointers and Arrays</a></p>
<p class="toc level1 tocsp"><a href="chp-strings.html">6.&nbsp;&nbsp;Strings</a></p>
<p class="toc level1 tocsp"><a href="chp-structs.html">7.&nbsp;&nbsp;Structs and Unions</a></p>
<p class="toc level1 tocsp"><a href="chp-types.html">8.&nbsp;&nbsp;Type and Constant Definitions</a></p>
<p class="toc level1 tocsp"><a href="chp-aggs.html">9.&nbsp;&nbsp;Aggregations</a></p>
<p class="toc level1 tocsp"><a href="chp-actsub.html">10.&nbsp;&nbsp;Actions and Subroutines</a></p>
<p class="toc level1 tocsp"><a href="chp-buf.html">11.&nbsp;&nbsp;Buffers and Buffering</a></p>
<p class="toc level1 tocsp"><a href="chp-fmt.html">12.&nbsp;&nbsp;Output Formatting</a></p>
<p class="toc level1 tocsp"><a href="chp-spec.html">13.&nbsp;&nbsp;Speculative Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-dtrace1m.html">14.&nbsp;&nbsp;<tt>dtrace</tt>(1M) Utility</a></p>
<p class="toc level1 tocsp"><a href="chp-script.html">15.&nbsp;&nbsp;Scripting</a></p>
<p class="toc level1 tocsp"><a href="chp-opt.html">16.&nbsp;&nbsp;Options and Tunables</a></p>
<p class="toc level1 tocsp"><a href="chp-dtrace.html">17.&nbsp;&nbsp;<tt>dtrace</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-lockstat.html">18.&nbsp;&nbsp;<tt>lockstat</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-profile.html">19.&nbsp;&nbsp;<tt>profile</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-fbt.html">20.&nbsp;&nbsp;<tt>fbt</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-syscall.html">21.&nbsp;&nbsp;<tt>syscall</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-sdt.html">22.&nbsp;&nbsp;<tt>sdt</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-sysinfo.html">23.&nbsp;&nbsp;<tt>sysinfo</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-vminfo.html">24.&nbsp;&nbsp;<tt>vminfo</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-proc.html">25.&nbsp;&nbsp;<tt>proc</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-sched.html">26.&nbsp;&nbsp;<tt>sched</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-io.html">27.&nbsp;&nbsp;<tt>io</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-mib.html">28.&nbsp;&nbsp;<tt>mib</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-fpuinfo.html">29.&nbsp;&nbsp;<tt>fpuinfo</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-pid.html">30.&nbsp;&nbsp;<tt>pid</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-plockstat.html">31.&nbsp;&nbsp;<tt>plockstat</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-fasttrap.html">32.&nbsp;&nbsp;<tt>fasttrap</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-user.html">33.&nbsp;&nbsp;User Process Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-usdt.html">34.&nbsp;&nbsp;Statically Defined Tracing for User Applications</a></p>
<p class="toc level1 tocsp"><a href="chp-sec.html">35.&nbsp;&nbsp;Security</a></p>
<p class="toc level1 tocsp"><a href="chp-anon.html">36.&nbsp;&nbsp;Anonymous Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-post.html">37.&nbsp;&nbsp;Postmortem Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-perf.html">38.&nbsp;&nbsp;Performance Considerations</a></p>
<p class="toc level1 tocsp"><a href="chp-stab.html">39.&nbsp;&nbsp;Stability</a></p>
<p class="toc level1 tocsp"><a href="chp-xlate.html">40.&nbsp;&nbsp;Translators</a></p>
<p class="toc level1 tocsp"><a href="chp-vers.html">41.&nbsp;&nbsp;Versioning</a></p>
<p class="toc level1 tocsp"><a href="gloss01.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="chp-intro-3"></a><h3>Compilation and Instrumentation</h3>
<p>When you write traditional programs in Solaris, you use a compiler to convert
your program from source code into object code that you can execute. When
you use the <tt>dtrace</tt> command you are invoking the compiler for the D
language used earlier to write the <tt>hello.d</tt> program. Once your program is compiled,
it is sent into the operating system kernel for execution by DTrace. There
the probes that are named in your program are enabled and the corresponding
provider performs whatever instrumentation is needed to activate them.</p><p>All of the instrumentation in DTrace is completely dynamic: probes are enabled discretely
only when you are using them. No instrumented code is present for inactive
probes, so your system does not experience any kind of performance degradation when
you are not using DTrace. Once your experiment is complete and the <tt>dtrace</tt>
command exits, all of the probes you used are automatically disabled and their
instrumentation is removed, returning your system to its exact original state. No effective
difference exists between a system where DTrace is not active and one where
the DTrace software is not installed.</p><p>The instrumentation for each probe is performed dynamically on the live running operating
system or on user processes you select. The system is not quiesced or
paused in any way, and instrumentation code is added only for the probes
that you enable. As a result, the probe effect of using DTrace is
limited to exactly what you ask DTrace to do: no extraneous data
is traced, no one big &ldquo;tracing switch&rdquo; is turned on in the system,
and all of the DTrace instrumentation is designed to be as efficient as
possible. These features enable you to use DTrace in production to solve real
problems in real time.</p><p>The DTrace framework also provides support for an arbitrary number of virtual clients.
You can run as many simultaneous DTrace experiments and commands as you like,
limited only by your system's memory capacity, and the commands all operate independently
using the same underlying instrumentation. This same capability also permits any number of
distinct users on the system to take advantage of DTrace simultaneously: developers, administrators,
and service personnel can all work together or on distinct problems on the
same system using DTrace without interfering with one another.</p><p>Unlike programs written in C and C++ and similar to programs written in
the Java<sup>TM</sup> programming language, DTrace D programs are compiled into a safe intermediate
form that is used for execution when your probes fire. This intermediate form
is validated for safety when your program is first examined by the DTrace
kernel software. The DTrace execution environment also handles any run-time errors that might
occur during your D program's execution, including dividing by zero, dereferencing invalid memory, and
so on, and reports them to you. As a result, you can
never construct an unsafe program that would cause DTrace to inadvertently damage the
Solaris kernel or one of the processes running on your system. These safety
features allow you to use DTrace in a production environment without worrying about crashing
or corrupting your system. If you make a programming mistake, DTrace will report
your error to you, disable your instrumentation, and you can correct your mistake
and try again. The DTrace error reporting and debugging features are described later
in this book.</p><p>The following diagram shows the different components of the DTrace architecture, including providers,
probes, the DTrace kernel software, and the <tt>dtrace</tt> command.</p><a name="chapter1-fig-1"></a><h6>Figure&nbsp;1-1 Overview of the DTrace Architecture and Components</h6><img src="figures/architecture.gif" alt="DTrace architecture: the kernel facility and providers, a driver interface from the kernel to a library, and the library supporting a set of commands."></img><p>Now that you understand how DTrace works, let's return to the tour
of the D programming language and start writing some more interesting programs.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="chp-intro-2.html">Previous</a>
             </td>
             <td align="right">
                 <a href="chp-intro-4.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

