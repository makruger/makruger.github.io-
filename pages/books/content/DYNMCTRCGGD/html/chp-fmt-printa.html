<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>printa() - Solaris Dynamic Tracing Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-11-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">Solaris Dynamic Tracing Guide</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="chp-fmt-1.html">Previous</a>
             </td>
             <td align="right">
                 <a href="chp-fmt-3.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="chp-intro.html">1.&nbsp;&nbsp;Introduction</a></p>
<p class="toc level1 tocsp"><a href="chp-typeopexpr.html">2.&nbsp;&nbsp;Types, Operators, and Expressions</a></p>
<p class="toc level1 tocsp"><a href="chp-variables.html">3.&nbsp;&nbsp;Variables</a></p>
<p class="toc level1 tocsp"><a href="chp-prog.html">4.&nbsp;&nbsp;D Program Structure</a></p>
<p class="toc level1 tocsp"><a href="chp-pointers.html">5.&nbsp;&nbsp;Pointers and Arrays</a></p>
<p class="toc level1 tocsp"><a href="chp-strings.html">6.&nbsp;&nbsp;Strings</a></p>
<p class="toc level1 tocsp"><a href="chp-structs.html">7.&nbsp;&nbsp;Structs and Unions</a></p>
<p class="toc level1 tocsp"><a href="chp-types.html">8.&nbsp;&nbsp;Type and Constant Definitions</a></p>
<p class="toc level1 tocsp"><a href="chp-aggs.html">9.&nbsp;&nbsp;Aggregations</a></p>
<p class="toc level1 tocsp"><a href="chp-actsub.html">10.&nbsp;&nbsp;Actions and Subroutines</a></p>
<p class="toc level1 tocsp"><a href="chp-buf.html">11.&nbsp;&nbsp;Buffers and Buffering</a></p>
<p class="toc level1 tocsp"><a href="chp-fmt.html">12.&nbsp;&nbsp;Output Formatting</a></p>
<p class="toc level2"><a href="chp-fmt-1.html"><tt>printf()</tt></a></p>
<div class="onpage">
<p class="toc level2"><a href=""><tt>printa()</tt></a></p>
</div>
<p class="toc level2"><a href="chp-fmt-3.html"><tt>trace()</tt> Default Format</a></p>
<p class="toc level1 tocsp"><a href="chp-spec.html">13.&nbsp;&nbsp;Speculative Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-dtrace1m.html">14.&nbsp;&nbsp;<tt>dtrace</tt>(1M) Utility</a></p>
<p class="toc level1 tocsp"><a href="chp-script.html">15.&nbsp;&nbsp;Scripting</a></p>
<p class="toc level1 tocsp"><a href="chp-opt.html">16.&nbsp;&nbsp;Options and Tunables</a></p>
<p class="toc level1 tocsp"><a href="chp-dtrace.html">17.&nbsp;&nbsp;<tt>dtrace</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-lockstat.html">18.&nbsp;&nbsp;<tt>lockstat</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-profile.html">19.&nbsp;&nbsp;<tt>profile</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-fbt.html">20.&nbsp;&nbsp;<tt>fbt</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-syscall.html">21.&nbsp;&nbsp;<tt>syscall</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-sdt.html">22.&nbsp;&nbsp;<tt>sdt</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-sysinfo.html">23.&nbsp;&nbsp;<tt>sysinfo</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-vminfo.html">24.&nbsp;&nbsp;<tt>vminfo</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-proc.html">25.&nbsp;&nbsp;<tt>proc</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-sched.html">26.&nbsp;&nbsp;<tt>sched</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-io.html">27.&nbsp;&nbsp;<tt>io</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-mib.html">28.&nbsp;&nbsp;<tt>mib</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-fpuinfo.html">29.&nbsp;&nbsp;<tt>fpuinfo</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-pid.html">30.&nbsp;&nbsp;<tt>pid</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-plockstat.html">31.&nbsp;&nbsp;<tt>plockstat</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-fasttrap.html">32.&nbsp;&nbsp;<tt>fasttrap</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-user.html">33.&nbsp;&nbsp;User Process Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-usdt.html">34.&nbsp;&nbsp;Statically Defined Tracing for User Applications</a></p>
<p class="toc level1 tocsp"><a href="chp-sec.html">35.&nbsp;&nbsp;Security</a></p>
<p class="toc level1 tocsp"><a href="chp-anon.html">36.&nbsp;&nbsp;Anonymous Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-post.html">37.&nbsp;&nbsp;Postmortem Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-perf.html">38.&nbsp;&nbsp;Performance Considerations</a></p>
<p class="toc level1 tocsp"><a href="chp-stab.html">39.&nbsp;&nbsp;Stability</a></p>
<p class="toc level1 tocsp"><a href="chp-xlate.html">40.&nbsp;&nbsp;Translators</a></p>
<p class="toc level1 tocsp"><a href="chp-vers.html">41.&nbsp;&nbsp;Versioning</a></p>
<p class="toc level1 tocsp"><a href="gloss01.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="chp-fmt-printa"></a><h3><tt>printa()</tt></h3>
<p><a name="indexterm-226"></a>The <tt>printa()</tt> function is used to format the results of aggregations in a
D program. The function is invoked using one of two forms:</p><pre>printa(@<i>aggregation-name</i>);
printa(<i>format-string</i>, <tt>@</tt><i>aggregation-name</i>);</pre><p>If the first form of the function is used, the <a href="http://docs.sun.com/doc/819-2240/dtrace-1m?a=view"><tt>dtrace</tt>(1M)</a> command
takes a consistent snapshot of the aggregation data and produces output equivalent to
the default output format used for aggregations, described in <a href="chp-aggs.html">Chapter&nbsp;9, Aggregations</a>.</p><p>If the second form of the function is used, the <a href="http://docs.sun.com/doc/819-2240/dtrace-1m?a=view"><tt>dtrace</tt>(1M)</a> command
takes a consistent snapshot of the aggregation data and produces output according to
the conversions specified in the <i>format string</i>, according to the following rules:</p>
<ul><li><p>The format conversions must match the tuple signature used to create the aggregation. Each tuple element may only appear once. For example, if you aggregate a count using the following D statements:</p><pre>@a["hello", 123] = count();
@a["goodbye", 456] = count();</pre><p>and then add the D statement <tt>printa(</tt><i>format-string</i><tt>, @a)</tt> to a probe clause, <tt>dtrace</tt> will snapshot the aggregation data and produce output as if you had entered the statements:</p><pre>printf(<i>format-string</i>, "hello", 123);
printf(<i>format-string</i>, "goodbye", 456);</pre><p>and so on for each tuple defined in the aggregation.</p></li>
<li><p>Unlike <tt>printf()</tt>, the format string you use for <tt>printa()</tt> need not include all elements of the tuple. That is, you can have a tuple of length 3 and only one format conversion. Therefore, you can omit any tuple keys from your <tt>printa()</tt> output by changing your aggregation declaration to move the keys you want to omit to the end of the tuple and then omit corresponding conversion specifiers for them in the <tt>printa()</tt> format string.</p></li>
<li><p>The aggregation result can be included in the output by using the additional <tt>@</tt> format flag character, which is only valid when used with <tt>printa()</tt>. The <tt>@</tt> flag can be combined with any appropriate format conversion specifier, and may appear more than once in a format string so that your tuple result can appear anywhere in the output and can appear more than once. The set of conversion specifiers that can be used with each aggregating function are implied by the aggregating function's result type. The aggregation result types are:</p><table><col width="50%"><col width="50%"><tr><td align="left" valign="top" scope="row"><p><tt>avg()</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>uint64_t</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>count()</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>uint64_t</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>lquantize()</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>int64_t</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>max()</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>uint64_t</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>min()</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>uint64_t</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>quantize()</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>int64_t</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>sum()</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>uint64_t</tt></p></td>
</tr>
</table><p>For example, to format the results of <tt>avg()</tt>, you can apply the <tt>%d</tt>, <tt>%i</tt>, <tt>%o</tt>, <tt>%u</tt>, or <tt>%x</tt> format conversions. The <tt>quantize()</tt> and <tt>lquantize()</tt> functions format their results as an ASCII table rather than as a single value.</p></li></ul>
<p>The following D program shows a complete example of <tt>printa()</tt>, using the <tt>profile</tt>
provider to sample the value of <tt>caller</tt> and then formatting the results
as a simple table:</p><pre>profile:::profile-997
{
    @a[caller] = count();
}

END
{
    printa("%@8u %a\n", @a);
}</pre><p>If you use <tt>dtrace</tt> to execute this program, wait a few seconds, and
press Control-C, you will see output similar to the following example:</p><pre><tt><b># dtrace -s printa.d</b></tt>
<tt><b>^C</b></tt>
CPU     ID                    FUNCTION:NAME
  1      2                             :END        1 0x1
       1 ohci`ohci_handle_root_hub_status_change+0x148
       1 specfs`spec_write+0xe0
       1 0xff14f950
       1 genunix`cyclic_softint+0x588
       1 0xfef2280c
       1 genunix`getf+0xdc
       1 ufs`ufs_icheck+0x50
       1 genunix`infpollinfo+0x80
       1 genunix`kmem_log_enter+0x1e8
       ...</pre>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="chp-fmt-1.html">Previous</a>
             </td>
             <td align="right">
                 <a href="chp-fmt-3.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

