<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Stability Computations and Reports - Solaris Dynamic Tracing Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-11-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">Solaris Dynamic Tracing Guide</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="chp-stab-3.html">Previous</a>
             </td>
             <td align="right">
                 <a href="chp-stab-5.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="chp-intro.html">1.&nbsp;&nbsp;Introduction</a></p>
<p class="toc level1 tocsp"><a href="chp-typeopexpr.html">2.&nbsp;&nbsp;Types, Operators, and Expressions</a></p>
<p class="toc level1 tocsp"><a href="chp-variables.html">3.&nbsp;&nbsp;Variables</a></p>
<p class="toc level1 tocsp"><a href="chp-prog.html">4.&nbsp;&nbsp;D Program Structure</a></p>
<p class="toc level1 tocsp"><a href="chp-pointers.html">5.&nbsp;&nbsp;Pointers and Arrays</a></p>
<p class="toc level1 tocsp"><a href="chp-strings.html">6.&nbsp;&nbsp;Strings</a></p>
<p class="toc level1 tocsp"><a href="chp-structs.html">7.&nbsp;&nbsp;Structs and Unions</a></p>
<p class="toc level1 tocsp"><a href="chp-types.html">8.&nbsp;&nbsp;Type and Constant Definitions</a></p>
<p class="toc level1 tocsp"><a href="chp-aggs.html">9.&nbsp;&nbsp;Aggregations</a></p>
<p class="toc level1 tocsp"><a href="chp-actsub.html">10.&nbsp;&nbsp;Actions and Subroutines</a></p>
<p class="toc level1 tocsp"><a href="chp-buf.html">11.&nbsp;&nbsp;Buffers and Buffering</a></p>
<p class="toc level1 tocsp"><a href="chp-fmt.html">12.&nbsp;&nbsp;Output Formatting</a></p>
<p class="toc level1 tocsp"><a href="chp-spec.html">13.&nbsp;&nbsp;Speculative Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-dtrace1m.html">14.&nbsp;&nbsp;<tt>dtrace</tt>(1M) Utility</a></p>
<p class="toc level1 tocsp"><a href="chp-script.html">15.&nbsp;&nbsp;Scripting</a></p>
<p class="toc level1 tocsp"><a href="chp-opt.html">16.&nbsp;&nbsp;Options and Tunables</a></p>
<p class="toc level1 tocsp"><a href="chp-dtrace.html">17.&nbsp;&nbsp;<tt>dtrace</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-lockstat.html">18.&nbsp;&nbsp;<tt>lockstat</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-profile.html">19.&nbsp;&nbsp;<tt>profile</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-fbt.html">20.&nbsp;&nbsp;<tt>fbt</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-syscall.html">21.&nbsp;&nbsp;<tt>syscall</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-sdt.html">22.&nbsp;&nbsp;<tt>sdt</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-sysinfo.html">23.&nbsp;&nbsp;<tt>sysinfo</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-vminfo.html">24.&nbsp;&nbsp;<tt>vminfo</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-proc.html">25.&nbsp;&nbsp;<tt>proc</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-sched.html">26.&nbsp;&nbsp;<tt>sched</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-io.html">27.&nbsp;&nbsp;<tt>io</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-mib.html">28.&nbsp;&nbsp;<tt>mib</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-fpuinfo.html">29.&nbsp;&nbsp;<tt>fpuinfo</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-pid.html">30.&nbsp;&nbsp;<tt>pid</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-plockstat.html">31.&nbsp;&nbsp;<tt>plockstat</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-fasttrap.html">32.&nbsp;&nbsp;<tt>fasttrap</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-user.html">33.&nbsp;&nbsp;User Process Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-usdt.html">34.&nbsp;&nbsp;Statically Defined Tracing for User Applications</a></p>
<p class="toc level1 tocsp"><a href="chp-sec.html">35.&nbsp;&nbsp;Security</a></p>
<p class="toc level1 tocsp"><a href="chp-anon.html">36.&nbsp;&nbsp;Anonymous Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-post.html">37.&nbsp;&nbsp;Postmortem Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-perf.html">38.&nbsp;&nbsp;Performance Considerations</a></p>
<p class="toc level1 tocsp"><a href="chp-stab.html">39.&nbsp;&nbsp;Stability</a></p>
<p class="toc level2"><a href="chp-stab-1.html">Stability Levels</a></p>
<p class="toc level2"><a href="chp-stab-2.html">Dependency Classes</a></p>
<p class="toc level2"><a href="chp-stab-3.html">Interface Attributes</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Stability Computations and Reports</a></p>
</div>
<p class="toc level2"><a href="chp-stab-5.html">Stability Enforcement</a></p>
<p class="toc level1 tocsp"><a href="chp-xlate.html">40.&nbsp;&nbsp;Translators</a></p>
<p class="toc level1 tocsp"><a href="chp-vers.html">41.&nbsp;&nbsp;Versioning</a></p>
<p class="toc level1 tocsp"><a href="gloss01.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="chp-stab-4"></a><h3>Stability Computations and Reports</h3>
<p><a name="indexterm-528"></a><a name="indexterm-529"></a><a name="indexterm-530"></a><a name="indexterm-531"></a>The D compiler performs stability computations for each of the probe descriptions and
action statements in your D programs. You can use the <tt>dtrace</tt> <tt>-v</tt> option to
display a report of your program's stability. The following example uses a program
written on the command line:</p><pre><tt><b># dtrace -v -n dtrace:::BEGIN'{exit(0);}'</b></tt>
dtrace: description 'dtrace:::BEGIN' matched 1 probe
Stability data for description dtrace:::BEGIN:
        Minimum probe description attributes
                Identifier Names: Evolving
                Data Semantics:   Evolving
                Dependency Class: Common
        Minimum probe statement attributes
                Identifier Names: Stable
                Data Semantics:   Stable
                Dependency Class: Common
CPU     ID                    FUNCTION:NAME
  0      1                           :BEGIN</pre><p>You may also wish to combine the <tt>dtrace</tt> <tt>-v</tt> option with the <tt>-e</tt>
option, which tells dtrace to compile but not execute your D program, so
that you can determine program stability without having to enable any probes and
execute your program. Here is another example stability report:</p><pre><tt><b># dtrace -ev -n dtrace:::BEGIN'{trace(curthread-&gt;t_procp);}'</b></tt>
Stability data for description dtrace:::BEGIN:
        Minimum probe description attributes
                Identifier Names: Evolving
                Data Semantics:   Evolving
                Dependency Class: Common
        Minimum probe statement attributes
                Identifier Names: Stable
                Data Semantics:   Private
                Dependency Class: Common
#</pre><p>Notice that in our new program, we have referenced the D variable
<tt>curthread</tt>, which has a Stable name, but Private data semantics (that is, if
you look at it, you are accessing Private implementation details of the kernel),
and this status is now reflected in the program's stability report. Stability attributes
in the program report are computed by selecting the minimum stability level and
class out of the corresponding values for each interface attributes triplet.</p><p>Stability attributes are computed for a probe description by taking the minimum stability
attributes of all <b>specified</b> probe description fields according to the attributes published by
the provider. The attributes of the available DTrace providers are shown in the
chapter corresponding to each provider. DTrace providers export a stability attributes triplet for each
of the four description fields for all probes published by that provider. Therefore,
a provider's name may have a greater stability than the individual probes it
exports. For example, the probe description:</p><pre>fbt:::</pre><p>indicating that DTrace should trace entry and return from all kernel functions, has
greater stability than the probe description:</p><pre>fbt:foo:bar:entry</pre><p>which names a specific internal function <tt>bar()</tt> in the kernel module <tt>foo</tt>. For
simplicity, most providers use a single set of attributes for all of the
individual <tt></tt><i>module</i><tt>:</tt><i>function</i><tt>:</tt><i>name</i><tt></tt> values that they publish. Providers also specify attributes for the <tt>args[]</tt>
array, as the stability of any probe arguments varies by provider.</p><p>If the provider field is not specified in a probe description, then the
description is assigned the stability attributes Unstable/Unstable/Common because the description might end up
matching probes of providers that do not yet exist when used on a
future Solaris version. As such, Sun is not able to provide guarantees about
the future stability and behavior of this program. You should always explicitly specify
the provider when writing your D program clauses. In addition, any probe description
fields that contain pattern matching characters (see <a href="chp-prog.html">Chapter&nbsp;4, D Program Structure</a>) or macro variables such as <tt>$1</tt>
(see <a href="chp-script.html">Chapter&nbsp;15, Scripting</a>) are treated as if they are unspecified because these description patterns
might expand to match providers or probes released by Sun in future versions
of DTrace and the Solaris OS.</p><p>Stability attributes are computed for most D language statements by taking the minimum
stability and class of the entities in the statement. For example, the following
D language entities have the following attributes:</p><table><col width="50%"><col width="50%"><tr><th align="left" valign="top" scope="column"><p>Entity</p></th>
<th align="left" valign="top" scope="column"><p>Attributes</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>D built-in variable <tt>curthread</tt></p></td>
<td align="left" valign="top" scope="row"><p>Stable/Private/Common</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>D user-defined variable
<tt>x</tt></p></td>
<td align="left" valign="top" scope="row"><p>Stable/Stable/Common</p></td>
</tr>
</table><p>If you write the following D program statement:</p><pre>x += curthread-&gt;t_pri;</pre><p>then the resulting attributes of the statement are Stable/Private/Common, the minimum attributes associated
with the operands <tt>curthread</tt> and <tt>x</tt>. The stability of an expression is
computed by taking the minimum stability attributes of each of the operands.</p><p>Any D variables you define in your program are automatically assigned the attributes
Stable/Stable/Common. In addition, the D language grammar and D operators are implicitly assigned
the attributes Stable/Stable/Common. References to kernel symbols using the backquote (<tt>`</tt>) operator are always
assigned the attributes Private/Private/Unknown because they reflect implementation artifacts. Types that you define
in your D program source code, specifically those that are associated with the
C and D type namespace, are assigned the attributes Stable/Stable/Common. Types that are
defined in the operating system implementation and provided by other type namespaces are assigned
the attributes Private/Private/Unknown. The D type cast operator yields an expression whose stability
attributes are the minimum of the input expression's attributes and the attributes of
the cast output type.</p><p>If you use the C preprocessor to include C system header files,
these types will be associated with the C type namespace and will be
assigned the attributes Stable/Stable/Common as the D compiler has no choice but to
assume that you are taking responsibility for these declarations. It is therefore possible to
mislead yourself about your program's stability if you use the C preprocessor to
include a header file containing implementation artifacts. You should always consult the documentation
corresponding to the header files you are including in order to determine the
correct stability levels.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="chp-stab-3.html">Previous</a>
             </td>
             <td align="right">
                 <a href="chp-stab-5.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

