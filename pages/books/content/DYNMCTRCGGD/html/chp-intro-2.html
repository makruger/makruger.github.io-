<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Providers and Probes - Solaris Dynamic Tracing Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-11-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">Solaris Dynamic Tracing Guide</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="chp-intro-1.html">Previous</a>
             </td>
             <td align="right">
                 <a href="chp-intro-3.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="chp-intro.html">1.&nbsp;&nbsp;Introduction</a></p>
<p class="toc level2"><a href="chp-intro-1.html">Getting Started</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Providers and Probes</a></p>
</div>
<p class="toc level2"><a href="chp-intro-3.html">Compilation and Instrumentation</a></p>
<p class="toc level2"><a href="chp-intro-4.html">Variables and Arithmetic Expressions</a></p>
<p class="toc level2"><a href="chp-intro-5.html">Predicates</a></p>
<p class="toc level2"><a href="chp-intro-6.html">Output Formatting</a></p>
<p class="toc level2"><a href="chp-intro-7.html">Arrays</a></p>
<p class="toc level2"><a href="chp-intro-8.html">External Symbols and Types</a></p>
<p class="toc level1 tocsp"><a href="chp-typeopexpr.html">2.&nbsp;&nbsp;Types, Operators, and Expressions</a></p>
<p class="toc level1 tocsp"><a href="chp-variables.html">3.&nbsp;&nbsp;Variables</a></p>
<p class="toc level1 tocsp"><a href="chp-prog.html">4.&nbsp;&nbsp;D Program Structure</a></p>
<p class="toc level1 tocsp"><a href="chp-pointers.html">5.&nbsp;&nbsp;Pointers and Arrays</a></p>
<p class="toc level1 tocsp"><a href="chp-strings.html">6.&nbsp;&nbsp;Strings</a></p>
<p class="toc level1 tocsp"><a href="chp-structs.html">7.&nbsp;&nbsp;Structs and Unions</a></p>
<p class="toc level1 tocsp"><a href="chp-types.html">8.&nbsp;&nbsp;Type and Constant Definitions</a></p>
<p class="toc level1 tocsp"><a href="chp-aggs.html">9.&nbsp;&nbsp;Aggregations</a></p>
<p class="toc level1 tocsp"><a href="chp-actsub.html">10.&nbsp;&nbsp;Actions and Subroutines</a></p>
<p class="toc level1 tocsp"><a href="chp-buf.html">11.&nbsp;&nbsp;Buffers and Buffering</a></p>
<p class="toc level1 tocsp"><a href="chp-fmt.html">12.&nbsp;&nbsp;Output Formatting</a></p>
<p class="toc level1 tocsp"><a href="chp-spec.html">13.&nbsp;&nbsp;Speculative Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-dtrace1m.html">14.&nbsp;&nbsp;<tt>dtrace</tt>(1M) Utility</a></p>
<p class="toc level1 tocsp"><a href="chp-script.html">15.&nbsp;&nbsp;Scripting</a></p>
<p class="toc level1 tocsp"><a href="chp-opt.html">16.&nbsp;&nbsp;Options and Tunables</a></p>
<p class="toc level1 tocsp"><a href="chp-dtrace.html">17.&nbsp;&nbsp;<tt>dtrace</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-lockstat.html">18.&nbsp;&nbsp;<tt>lockstat</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-profile.html">19.&nbsp;&nbsp;<tt>profile</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-fbt.html">20.&nbsp;&nbsp;<tt>fbt</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-syscall.html">21.&nbsp;&nbsp;<tt>syscall</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-sdt.html">22.&nbsp;&nbsp;<tt>sdt</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-sysinfo.html">23.&nbsp;&nbsp;<tt>sysinfo</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-vminfo.html">24.&nbsp;&nbsp;<tt>vminfo</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-proc.html">25.&nbsp;&nbsp;<tt>proc</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-sched.html">26.&nbsp;&nbsp;<tt>sched</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-io.html">27.&nbsp;&nbsp;<tt>io</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-mib.html">28.&nbsp;&nbsp;<tt>mib</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-fpuinfo.html">29.&nbsp;&nbsp;<tt>fpuinfo</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-pid.html">30.&nbsp;&nbsp;<tt>pid</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-plockstat.html">31.&nbsp;&nbsp;<tt>plockstat</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-fasttrap.html">32.&nbsp;&nbsp;<tt>fasttrap</tt> Provider</a></p>
<p class="toc level1 tocsp"><a href="chp-user.html">33.&nbsp;&nbsp;User Process Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-usdt.html">34.&nbsp;&nbsp;Statically Defined Tracing for User Applications</a></p>
<p class="toc level1 tocsp"><a href="chp-sec.html">35.&nbsp;&nbsp;Security</a></p>
<p class="toc level1 tocsp"><a href="chp-anon.html">36.&nbsp;&nbsp;Anonymous Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-post.html">37.&nbsp;&nbsp;Postmortem Tracing</a></p>
<p class="toc level1 tocsp"><a href="chp-perf.html">38.&nbsp;&nbsp;Performance Considerations</a></p>
<p class="toc level1 tocsp"><a href="chp-stab.html">39.&nbsp;&nbsp;Stability</a></p>
<p class="toc level1 tocsp"><a href="chp-xlate.html">40.&nbsp;&nbsp;Translators</a></p>
<p class="toc level1 tocsp"><a href="chp-vers.html">41.&nbsp;&nbsp;Versioning</a></p>
<p class="toc level1 tocsp"><a href="gloss01.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="chp-intro-2"></a><h3>Providers and Probes</h3>
<p>In the preceding examples, you learned to use two simple probes named
<tt>BEGIN</tt> and <tt>END</tt>. But where did these probes come from? DTrace probes come
from a set of kernel modules called <b>providers</b>, each of which performs
a particular kind of instrumentation to create probes. When you use DTrace, each
provider is given an opportunity to publish the probes it can provide to
the DTrace framework. You can then enable and bind your tracing actions to
any of the probes that have been published. To list all of the
available probes on your system, type the command:</p><pre><tt><b># dtrace -l</b></tt>
  ID   PROVIDER            MODULE          FUNCTION NAME
   1     dtrace                                     BEGIN
   2     dtrace                                     END
   3     dtrace                                     ERROR
   4   lockstat           genunix       mutex_enter adaptive-acquire
   5   lockstat           genunix       mutex_enter adaptive-block
   6   lockstat           genunix       mutex_enter adaptive-spin
   7   lockstat           genunix       mutex_exit  adaptive-release

   ... many lines of output omitted ...

#</pre><p>It might take some time to display all of the output. To
count up all your probes, you can type the command:</p><pre><tt><b># dtrace -l | wc -l</b></tt>
        30122</pre><p>You might observe a different total on your machine, as the number
of probes varies depending on your operating platform and the software you have installed.
As you can see, there are a very large number of probes
available to you so you can peer into every previously dark corner of
the system. In fact, even this output isn't the complete list because, as
you'll see later, some providers offer the ability to create new probes on-the-fly
based on your tracing requests, making the actual number of DTrace probes virtually unlimited.</p><p>Now look back at the output from <tt><b>dtrace -l</b></tt> in your terminal window. Notice
that each probe has the two names we mentioned earlier, an integer ID
and a human-readable name. The human readable name is composed of four parts,
shown as separate columns in the <tt>dtrace</tt> output. The four parts of a
probe name are:</p><table><col width="20%"><col width="80%"><tr><td align="left" valign="top" scope="row"><p>Provider</p></td>
<td align="left" valign="top" scope="row"><p>The name of the DTrace provider that is publishing this
probe. The provider name typically corresponds to the name of the DTrace kernel
module that performs the instrumentation to enable the probe.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Module</p></td>
<td align="left" valign="top" scope="row"><p>If this probe corresponds to
a specific program location, the name of the module in which the probe
is located. This name is either the name of a kernel module or
the name of a user library.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Function</p></td>
<td align="left" valign="top" scope="row"><p>If this probe corresponds to a specific
program location, the name of the program function in which the probe is
located.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Name</p></td>
<td align="left" valign="top" scope="row"><p>The final component of the probe name is a name that gives
you some idea of the probe's semantic meaning, such as <tt>BEGIN</tt> or <tt>END</tt>.</p></td>
</tr>
</table><p>When writing out the full human-readable name of a probe, write all four
parts of the name separated by colons like this:</p><p><i>provider</i>:<i>module</i>:<i>function</i>:<i>name</i></p><p>Notice that some of the probes in the list do not have
a module and function, such as the <tt>BEGIN</tt> and <tt>END</tt> probes used earlier. Some
probes leave these two fields blank because these probes do not correspond to
any specific instrumented program function or location. Instead, these probes refer to a
more abstract concept like the idea of the end of your tracing request.
A probe that has a module and function as part of its name
is known as an <b>anchored probe</b>, and one that does not is known as
<b>unanchored</b>.</p><p>By convention, if you do not specify all of the fields of
a probe name, then DTrace matches your request to <b>all</b> of the probes that
have matching values in the parts of the name that you do
specify. In other words, when you used the probe name <tt>BEGIN</tt> earlier, you were
actually telling DTrace to match any probe whose name field is <tt>BEGIN</tt>,
regardless of the value of the provider, module, and function fields. As it
happens, there is only one probe matching that description, so the result is
the same. But you now know that the true name of the
<tt>BEGIN</tt> probe is <tt>dtrace:::BEGIN</tt>, which indicates that this probe is provided by the
DTrace framework itself and is not anchored to any function. Therefore, the <tt>hello.d</tt>
program could have been written as follows and would produce the same result:</p><pre>dtrace:::BEGIN
{
    trace("hello, world");
    exit(0);
}</pre><p>Now that you understand where probes originate from and how they are named,
we're going to learn a little more about what happens when you
enable probes and ask DTrace to do something, and then we'll return to
our whirlwind tour of D.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="chp-intro-1.html">Previous</a>
             </td>
             <td align="right">
                 <a href="chp-intro-3.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

