<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Creating State Database Replicas - Solaris Volume Manager Administration Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2006-06-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">Solaris Volume Manager Administration Guide</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="tasks-state-db-replicas-15.html">Previous</a>
             </td>
             <td align="right">
                 <a href="tasks-state-db-replicas-8.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="roadmap-10.html">1.&nbsp;&nbsp;Getting Started With Solaris Volume Manager</a></p>
<p class="toc level1 tocsp"><a href="storage-overview-1.html">2.&nbsp;&nbsp;Storage Management Concepts</a></p>
<p class="toc level1 tocsp"><a href="basics-23185.html">3.&nbsp;&nbsp;Solaris Volume Manager Overview</a></p>
<p class="toc level1 tocsp"><a href="eoqra.html">4.&nbsp;&nbsp;Solaris Volume Manager for Sun Cluster (Overview)</a></p>
<p class="toc level1 tocsp"><a href="svm-scenario-1.html">5.&nbsp;&nbsp;Configuring and Using Solaris Volume Manager (Scenario)</a></p>
<p class="toc level1 tocsp"><a href="about-state-db-replicas-1.html">6.&nbsp;&nbsp;State Database (Overview)</a></p>
<p class="toc level1 tocsp"><a href="tasks-state-db-replicas-1.html">7.&nbsp;&nbsp;State Database (Tasks)</a></p>
<p class="toc level2"><a href="tasks-state-db-replicas-15.html">State Database Replicas (Task Map)</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Creating State Database Replicas</a></p>
<p class="toc level3"><a href="#tasks-state-db-replicas-3">How to Create State Database Replicas</a></p>
</div>
<p class="toc level2 tocsp"><a href="tasks-state-db-replicas-8.html">Maintaining State Database Replicas</a></p>
<p class="toc level3"><a href="tasks-state-db-replicas-8.html#maintaintasksnew-25437">How to Check the Status of State Database Replicas</a></p>
<p class="toc level3"><a href="tasks-state-db-replicas-8.html#tasks-state-db-replicas-12">How to Delete State Database Replicas</a></p>
<p class="toc level1 tocsp"><a href="about-metadevices-22802.html">8.&nbsp;&nbsp;RAID-0 (Stripe and Concatenation) Volumes (Overview)</a></p>
<p class="toc level1 tocsp"><a href="tasks-metadevices-1.html">9.&nbsp;&nbsp;RAID-0 (Stripe and Concatenation) Volumes (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="about-mirrors-2.html">10.&nbsp;&nbsp;RAID-1 (Mirror) Volumes (Overview)</a></p>
<p class="toc level1 tocsp"><a href="tasks-mirrors-1.html">11.&nbsp;&nbsp;RAID-1 (Mirror) Volumes (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="about-softpart-1.html">12.&nbsp;&nbsp;Soft Partitions (Overview)</a></p>
<p class="toc level1 tocsp"><a href="tasks-softpart-1.html">13.&nbsp;&nbsp;Soft Partitions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="about-raid5-1.html">14.&nbsp;&nbsp;RAID-5 Volumes (Overview)</a></p>
<p class="toc level1 tocsp"><a href="tasks-raid5-1.html">15.&nbsp;&nbsp;RAID-5 Volumes (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="about-hotspares-40444.html">16.&nbsp;&nbsp;Hot Spare Pools (Overview)</a></p>
<p class="toc level1 tocsp"><a href="tasks-hotspares-1.html">17.&nbsp;&nbsp;Hot Spare Pools (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="about-disksets-31856.html">18.&nbsp;&nbsp;Disk Sets (Overview)</a></p>
<p class="toc level1 tocsp"><a href="tasks-disksets-1.html">19.&nbsp;&nbsp;Disk Sets (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tasks-basics-2.html">20.&nbsp;&nbsp;Maintaining Solaris Volume Manager (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="best-practices-1.html">21.&nbsp;&nbsp;Best Practices for Solaris Volume Manager</a></p>
<p class="toc level1 tocsp"><a href="topdown-overview.html">22.&nbsp;&nbsp;Top-Down Volume Creation (Overview)</a></p>
<p class="toc level1 tocsp"><a href="topdown-tasks-chap.html">23.&nbsp;&nbsp;Top-Down Volume Creation (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tasks-snmp-1.html">24.&nbsp;&nbsp;Monitoring and Error Reporting (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="troubleshoottasks-33506.html">25.&nbsp;&nbsp;Troubleshooting Solaris Volume Manager (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="appendfiles-1.html">A.&nbsp;&nbsp;Important Solaris Volume Manager Files</a></p>
<p class="toc level1 tocsp"><a href="quick-reference-1.html">B.&nbsp;&nbsp;Solaris Volume Manager Quick Reference</a></p>
<p class="toc level1 tocsp"><a href="append-cim-wbem-1.html">C.&nbsp;&nbsp;Solaris Volume Manager CIM/WBEM API</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="tasks-state-db-replicas-9"></a><h3>Creating State Database Replicas</h3>

<hr><p><b>Caution - </b>If you upgraded from the Solstice DiskSuite product to Solaris Volume Manager
and you have state database replicas sharing slices with file systems or logical volumes
(as opposed to on separate slices), do not delete existing replicas and replace
them with new default replicas in the same location.</p><p>The default state database replica size in Solaris Volume Manager is 8192
blocks, while the default size in the Solstice DiskSuite product is 1034 blocks.
Use caution if you delete a default-sized state database replica created in the Solstice
DiskSuite product, and then add a new default-sized replica with Solaris Volume
Manager. You will overwrite the first 7158 blocks of any file system that
occupies the rest of the shared slice, thus destroying the data. </p>
<hr>

<hr><p><b>Caution - </b>Do not place state database replicas on fabric-attached storage, SANs, or other storage
that is not directly attached to the system. You might not be able
to boot Solaris Volume Manager. Replicas must be on storage devices that are
available at the same point in the boot process as traditional SCSI
or IDE drives. </p>
<hr>


<a name="tasks-state-db-replicas-3"></a><h4>How to Create State Database Replicas</h4><h6>Before You Begin</h6><p>Check <a href="addtasks-1.html#addtasks-20933">Prerequisites for Creating Solaris Volume Manager Components</a>.</p><ol>
<li><a name="tasks-state-db-replicas-step-13"></a><b>Become superuser.</b></li>
<li><a name="tasks-state-db-replicas-step-14"></a><b>To create state database replicas, use one of the following methods:</b>
<ul><li><p>From the Enhanced Storage tool within the Solaris Management Console, open the State Database Replicas node. Choose Action&rArr;Create Replicas and follow the onscreen instructions. For more information, see the online help.</p></li>
<li><p>Use the following form of the <tt>metadb</tt> command. See the <a href="http://docs.sun.com/doc/819-2240/metadb-1m?a=view"><tt>metadb</tt>(1M)</a>.</p><pre># <tt><b>metadb -a -c </tt><i>number</i><tt> -l </tt><i>length-of replica</i><tt> -f </tt><i>ctds-of-slice</i><tt></b></tt></pre><dl><dt><tt>-a</tt></dt>
<dd><p>Specifies to add or create a state database replica.</p></dd>
<dt><tt>-f</tt></dt>
<dd><p>Specifies to force the operation, even if no replicas exist. Use the <tt>-f</tt> to force the creation of the initial replicas.</p></dd>
</dl>
<dl><dt><tt>-c</tt> <i>number</i></dt>
<dd><p>Specifies the number of replicas to add to the specified slice.</p></dd>
<dt><tt>-l</tt> <i>length-of-replica</i></dt>
<dd><p>Specifies the size of the new replicas, in blocks. The default size is 8192. This size should be appropriate for virtually all configurations, including those configurations with thousands of logical volumes.</p></dd>
<dt><i>ctds-of-slice</i></dt>
<dd><p>Specifies the name of the component that will hold the replica.</p></dd>
</dl>
</li></ul>

<hr><p><b>Note - </b>The <tt>metadb</tt> command entered on the command line without options reports the status
of all state database replicas.</p>
<hr>
</li></ol><a name="egjwg"></a>Example&nbsp;7-1 Creating the First State Database Replica<pre># <tt><b>metadb -a -f c0t0d0s7</b></tt>
# <tt><b>metadb</b></tt>
        flags         first blk      block count
...
     a      u         16             8192            /dev/dsk/c0t0d0s7</pre><p>You must use the <tt>-f</tt> option along with the <tt>-a</tt> option to
create the first state database replica. The <tt>-a</tt> option adds state database
replicas to the system.The <tt>-f</tt> option forces the creation of the first
replica (and may be omitted when you add supplemental replicas to the system).
</p><a name="egjwz"></a>Example&nbsp;7-2 Adding Two State Database Replicas to the Same Slice<pre># <tt><b>metadb -a -c 2 c1t3d0s1</b></tt>
<tt><b># metadb</b></tt>
        flags         first blk      block count
...
     a        u         16              8192            /dev/dsk/c1t3d0s1
     a        u         8208            8192            /dev/dsk/c1t3d0s1</pre><p>The <tt>-a</tt> option adds state database replicas to the system. The <tt>-c 2</tt> option
places two replicas on the specified slice. The <tt>metadb</tt> command checks that the
replicas are active, as indicated by the <tt>a</tt> flag in the <tt>metadb</tt> command output.</p><a name="egjwb"></a>Example&nbsp;7-3 Adding State Database Replicas of a Specific Size<p>If you are replacing existing state database replicas, you might need to specify
a replica size. Particularly if you have existing state database replicas (on a
system upgraded from the Solstice DiskSuite product, perhaps) that share a slice with
a file system, you must replace existing replicas with other replicas of the
same size or add new replicas in a different location.</p><pre># <tt><b>metadb -a -c 3 -l 1034 c0t0d0s7</b></tt>
<tt><b># metadb</b></tt>
        flags         first blk      block count
...
     a      u         16             1034            /dev/dsk/c0t0d0s7
     a      u         1050           1034            /dev/dsk/c0t0d0s7
     a      u         2084           1034            /dev/dsk/c0t0d0s7</pre><p>The <tt>-a</tt> option adds state database replicas to the system. The <tt>-l</tt> option
specifies the length in blocks of the replica to add.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="tasks-state-db-replicas-15.html">Previous</a>
             </td>
             <td align="right">
                 <a href="tasks-state-db-replicas-8.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

