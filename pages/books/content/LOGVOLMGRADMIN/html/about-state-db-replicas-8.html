<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>About the Solaris Volume Manager State Database and Replicas - Solaris Volume Manager Administration Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2006-06-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">Solaris Volume Manager Administration Guide</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="about-state-db-replicas-1.html">Previous</a>
             </td>
             <td align="right">
                 <a href="config-guide-29115.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="roadmap-10.html">1.&nbsp;&nbsp;Getting Started With Solaris Volume Manager</a></p>
<p class="toc level1 tocsp"><a href="storage-overview-1.html">2.&nbsp;&nbsp;Storage Management Concepts</a></p>
<p class="toc level1 tocsp"><a href="basics-23185.html">3.&nbsp;&nbsp;Solaris Volume Manager Overview</a></p>
<p class="toc level1 tocsp"><a href="eoqra.html">4.&nbsp;&nbsp;Solaris Volume Manager for Sun Cluster (Overview)</a></p>
<p class="toc level1 tocsp"><a href="svm-scenario-1.html">5.&nbsp;&nbsp;Configuring and Using Solaris Volume Manager (Scenario)</a></p>
<p class="toc level1 tocsp"><a href="about-state-db-replicas-1.html">6.&nbsp;&nbsp;State Database (Overview)</a></p>
<div class="onpage">
<p class="toc level2"><a href="">About the Solaris Volume Manager State Database and Replicas</a></p>
</div>
<p class="toc level2"><a href="config-guide-29115.html">Understanding the Majority Consensus Algorithm</a></p>
<p class="toc level2"><a href="extcz.html">Administering State Database Replicas</a></p>
<p class="toc level2"><a href="about-state-db-replicas-8a.html">Handling State Database Replica Errors</a></p>
<p class="toc level2"><a href="about-state-db-replicas-11.html">Scenario--State Database Replicas</a></p>
<p class="toc level1 tocsp"><a href="tasks-state-db-replicas-1.html">7.&nbsp;&nbsp;State Database (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="about-metadevices-22802.html">8.&nbsp;&nbsp;RAID-0 (Stripe and Concatenation) Volumes (Overview)</a></p>
<p class="toc level1 tocsp"><a href="tasks-metadevices-1.html">9.&nbsp;&nbsp;RAID-0 (Stripe and Concatenation) Volumes (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="about-mirrors-2.html">10.&nbsp;&nbsp;RAID-1 (Mirror) Volumes (Overview)</a></p>
<p class="toc level1 tocsp"><a href="tasks-mirrors-1.html">11.&nbsp;&nbsp;RAID-1 (Mirror) Volumes (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="about-softpart-1.html">12.&nbsp;&nbsp;Soft Partitions (Overview)</a></p>
<p class="toc level1 tocsp"><a href="tasks-softpart-1.html">13.&nbsp;&nbsp;Soft Partitions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="about-raid5-1.html">14.&nbsp;&nbsp;RAID-5 Volumes (Overview)</a></p>
<p class="toc level1 tocsp"><a href="tasks-raid5-1.html">15.&nbsp;&nbsp;RAID-5 Volumes (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="about-hotspares-40444.html">16.&nbsp;&nbsp;Hot Spare Pools (Overview)</a></p>
<p class="toc level1 tocsp"><a href="tasks-hotspares-1.html">17.&nbsp;&nbsp;Hot Spare Pools (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="about-disksets-31856.html">18.&nbsp;&nbsp;Disk Sets (Overview)</a></p>
<p class="toc level1 tocsp"><a href="tasks-disksets-1.html">19.&nbsp;&nbsp;Disk Sets (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tasks-basics-2.html">20.&nbsp;&nbsp;Maintaining Solaris Volume Manager (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="best-practices-1.html">21.&nbsp;&nbsp;Best Practices for Solaris Volume Manager</a></p>
<p class="toc level1 tocsp"><a href="topdown-overview.html">22.&nbsp;&nbsp;Top-Down Volume Creation (Overview)</a></p>
<p class="toc level1 tocsp"><a href="topdown-tasks-chap.html">23.&nbsp;&nbsp;Top-Down Volume Creation (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tasks-snmp-1.html">24.&nbsp;&nbsp;Monitoring and Error Reporting (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="troubleshoottasks-33506.html">25.&nbsp;&nbsp;Troubleshooting Solaris Volume Manager (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="appendfiles-1.html">A.&nbsp;&nbsp;Important Solaris Volume Manager Files</a></p>
<p class="toc level1 tocsp"><a href="quick-reference-1.html">B.&nbsp;&nbsp;Solaris Volume Manager Quick Reference</a></p>
<p class="toc level1 tocsp"><a href="append-cim-wbem-1.html">C.&nbsp;&nbsp;Solaris Volume Manager CIM/WBEM API</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="about-state-db-replicas-8"></a><h3>About the Solaris Volume Manager State Database and Replicas</h3>
<p><a name="basics-ix47"></a>The Solaris Volume Manager state database contains configuration and status information for all
volumes, hot spares, and disk sets. Solaris Volume Manager maintains multiple copies (replicas)
of the state database to provide redundancy and to prevent the database from
being corrupted during a system crash (at most, only one database copy will
be corrupted).</p><p>The state database replicas ensure that the data in the state database is
always valid. When the state database is updated, each state database replica is
also updated. The updates occur one at a time (to protect against
corrupting all updates if the system crashes).</p><p><a name="basics-ix48"></a><a name="basics-ix49"></a>If your system loses a state database replica, Solaris Volume Manager must figure
out which state database replicas still contain valid data. Solaris Volume Manager determines
this information by using a <b>majority consensus algorithm</b>. This algorithm requires that a majority (half +
1) of the state database replicas be available and in agreement before any
of them are considered valid. Because of the requirements of the majority consensus
algorithm, you must create at least three state database replicas when you set
up your disk configuration. A consensus can be reached as long as at
least two of the three state database replicas are available.  </p><p><a name="basics-ix50"></a>During booting, Solaris Volume Manager ignores corrupted state database replicas. In some cases,
Solaris Volume Manager tries to rewrite state database replicas that are corrupted. Otherwise,
they are ignored until you repair them. If a state database replica becomes
corrupted because its underlying slice encountered an error, you need to repair or
replace the slice and then enable the replica. </p>
<hr><p><b>Caution - </b>Do not place state database replicas on fabric-attached storage, SANs, or other storage
that is not directly attached to the system. You might not be able
to boot Solaris Volume Manager. Replicas must be on storage devices that are
available at the same point in the boot process as traditional SCSI
or IDE drives.</p>
<hr>
<p>If all state database replicas are lost, you could, in theory, lose all
data that is stored on your Solaris Volume Manager volumes. For this
reason, it is good practice to create enough state database replicas on separate
drives and across controllers to prevent catastrophic failure. It is also wise to save
your initial Solaris Volume Manager configuration information, as well as your disk partition
information.</p><p><a name="basics-ix51"></a>See <a href="tasks-state-db-replicas-1.html">Chapter&nbsp;7, State Database (Tasks)</a> for information on adding additional state database replicas to the system.
See <a href="tasks-state-db-replicas-11.html">Recovering From State Database Replica Failures</a> for information on recovering when state database replicas are lost. </p><p>State database replicas are also used for RAID-1 volume resynchronization regions. Too few
state database replicas relative to the number of mirrors might cause replica I/O
to impact RAID-1 volume performance. That is, if you have a large number
of mirrors, make sure that you have at least two state database replicas
per RAID-1 volume, up to the maximum of 50 replicas per disk set.</p><p>By default each state database replica for volumes, the local set and for
disk sets occupies 4 Mbytes (8192 disk sectors) of disk storage. The
default size of a state database replica for a multi-owner disk set is
16 Mbytes.</p><p>Replicas can be stored on the following devices:</p>
<ul><li><p>A dedicated local disk partition </p></li>
<li><p>A local partition that will be part of a volume</p></li>
<li><p>A local partition that will be part of a UFS logging device</p></li></ul>
<p>Replicas cannot be stored on the root (<tt>/</tt>), <tt>swap</tt>, or <tt>/usr</tt> slices.
Nor can replicas be stored on slices that contain existing file systems or
data. After the replicas have been stored, volumes or file systems can be
placed on the same slice.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="about-state-db-replicas-1.html">Previous</a>
             </td>
             <td align="right">
                 <a href="config-guide-29115.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

