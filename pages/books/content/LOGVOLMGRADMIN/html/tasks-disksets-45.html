<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Maintaining Disk Sets - Solaris Volume Manager Administration Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2006-06-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">Solaris Volume Manager Administration Guide</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="tasks-disksets-41.html">Previous</a>
             </td>
             <td align="right">
                 <a href="efnri.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="roadmap-10.html">1.&nbsp;&nbsp;Getting Started With Solaris Volume Manager</a></p>
<p class="toc level1 tocsp"><a href="storage-overview-1.html">2.&nbsp;&nbsp;Storage Management Concepts</a></p>
<p class="toc level1 tocsp"><a href="basics-23185.html">3.&nbsp;&nbsp;Solaris Volume Manager Overview</a></p>
<p class="toc level1 tocsp"><a href="eoqra.html">4.&nbsp;&nbsp;Solaris Volume Manager for Sun Cluster (Overview)</a></p>
<p class="toc level1 tocsp"><a href="svm-scenario-1.html">5.&nbsp;&nbsp;Configuring and Using Solaris Volume Manager (Scenario)</a></p>
<p class="toc level1 tocsp"><a href="about-state-db-replicas-1.html">6.&nbsp;&nbsp;State Database (Overview)</a></p>
<p class="toc level1 tocsp"><a href="tasks-state-db-replicas-1.html">7.&nbsp;&nbsp;State Database (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="about-metadevices-22802.html">8.&nbsp;&nbsp;RAID-0 (Stripe and Concatenation) Volumes (Overview)</a></p>
<p class="toc level1 tocsp"><a href="tasks-metadevices-1.html">9.&nbsp;&nbsp;RAID-0 (Stripe and Concatenation) Volumes (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="about-mirrors-2.html">10.&nbsp;&nbsp;RAID-1 (Mirror) Volumes (Overview)</a></p>
<p class="toc level1 tocsp"><a href="tasks-mirrors-1.html">11.&nbsp;&nbsp;RAID-1 (Mirror) Volumes (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="about-softpart-1.html">12.&nbsp;&nbsp;Soft Partitions (Overview)</a></p>
<p class="toc level1 tocsp"><a href="tasks-softpart-1.html">13.&nbsp;&nbsp;Soft Partitions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="about-raid5-1.html">14.&nbsp;&nbsp;RAID-5 Volumes (Overview)</a></p>
<p class="toc level1 tocsp"><a href="tasks-raid5-1.html">15.&nbsp;&nbsp;RAID-5 Volumes (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="about-hotspares-40444.html">16.&nbsp;&nbsp;Hot Spare Pools (Overview)</a></p>
<p class="toc level1 tocsp"><a href="tasks-hotspares-1.html">17.&nbsp;&nbsp;Hot Spare Pools (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="about-disksets-31856.html">18.&nbsp;&nbsp;Disk Sets (Overview)</a></p>
<p class="toc level1 tocsp"><a href="tasks-disksets-1.html">19.&nbsp;&nbsp;Disk Sets (Tasks)</a></p>
<p class="toc level2"><a href="tasks-disksets-66.html">Disk Sets (Task Map)</a></p>
<p class="toc level2"><a href="tasks-disksets-32.html">Creating Disk Sets</a></p>
<p class="toc level3"><a href="tasks-disksets-32.html#addtasks-10742">How to Create a Disk Set</a></p>
<p class="toc level2 tocsp"><a href="tasks-disksets-41.html">Expanding Disk Sets</a></p>
<p class="toc level3"><a href="tasks-disksets-41.html#addtasks-42054">How to Add Disks to a Disk Set</a></p>
<p class="toc level3"><a href="tasks-disksets-41.html#tasks-disksets-18">How to Add Another Host to a Disk Set</a></p>
<p class="toc level3"><a href="tasks-disksets-41.html#tasks-disksets-24">How to Create Solaris Volume Manager Components in a Disk Set</a></p>
<div class="onpage">
<p class="toc level2 tocsp"><a href="">Maintaining Disk Sets</a></p>
<p class="toc level3"><a href="#maintaintasksnew-23499">How to Check the Status of a Disk Set</a></p>
<p class="toc level3"><a href="#tasks-disksets-67">How to Delete Disks From a Disk Set</a></p>
<p class="toc level3"><a href="#tasks-disksets-3">How to Take a Disk Set</a></p>
<p class="toc level3"><a href="#tasks-disksets-6">How to Release a Disk Set</a></p>
<p class="toc level3"><a href="#tasks-disksets-71">How to Delete a Host or Disk Set</a></p>
</div>
<p class="toc level2 tocsp"><a href="efnri.html">Importing Disk Sets</a></p>
<p class="toc level3"><a href="efnri.html#eoqsa">How to Print a Report on Disk Sets Available for Import</a></p>
<p class="toc level3"><a href="efnri.html#eoqrs">How to Import a Disk Set From One System to Another System</a></p>
<p class="toc level1 tocsp"><a href="tasks-basics-2.html">20.&nbsp;&nbsp;Maintaining Solaris Volume Manager (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="best-practices-1.html">21.&nbsp;&nbsp;Best Practices for Solaris Volume Manager</a></p>
<p class="toc level1 tocsp"><a href="topdown-overview.html">22.&nbsp;&nbsp;Top-Down Volume Creation (Overview)</a></p>
<p class="toc level1 tocsp"><a href="topdown-tasks-chap.html">23.&nbsp;&nbsp;Top-Down Volume Creation (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="tasks-snmp-1.html">24.&nbsp;&nbsp;Monitoring and Error Reporting (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="troubleshoottasks-33506.html">25.&nbsp;&nbsp;Troubleshooting Solaris Volume Manager (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="appendfiles-1.html">A.&nbsp;&nbsp;Important Solaris Volume Manager Files</a></p>
<p class="toc level1 tocsp"><a href="quick-reference-1.html">B.&nbsp;&nbsp;Solaris Volume Manager Quick Reference</a></p>
<p class="toc level1 tocsp"><a href="append-cim-wbem-1.html">C.&nbsp;&nbsp;Solaris Volume Manager CIM/WBEM API</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="tasks-disksets-45"></a><h3>Maintaining Disk Sets</h3>


<a name="maintaintasksnew-23499"></a><h4>How to Check the Status of a Disk Set</h4><a name="maintaintasksnew-ix205"></a><a name="indexterm-173"></a><a name="indexterm-174"></a><ul>
<li><a name="tasks-disksets-step-59a"></a><b>Use one of the following methods to check the status of a disk
set.</b>
<ul><li><p>From the Enhanced Storage tool within the Solaris Management Console, open the Disk Sets node. Click the right mouse button on the Disk Set you want to monitor. Then choose Properties from the menu. For more information, see the online help.</p></li>
<li><p>Use the following form of the <tt>metaset</tt> command to view disk set status.</p><pre># <tt><b>metaset -s </tt><i>diskset-name</i><tt></b></tt></pre><p>See the <a href="http://docs.sun.com/doc/819-2240/metaset-1m?a=view"><tt>metaset</tt>(1M)</a> man page for more information.</p>
<hr><p><b>Note - </b>Disk set ownership is only shown on the owning host.</p>
<hr>
</li></ul>
</li></ul><a name="egjvu"></a>Example&nbsp;19-6 Checking the Status of a Specified Disk Set<p>The following example shows the <tt>metaset</tt> command with the <tt>-s</tt> option followed by
the name of the disk set, <tt>blue</tt>. The output from this command
displays status information for that disk set. The output indicates that <tt>host1</tt> is
the disk set owner. The <tt>metaset</tt> command also displays the disks in the disk
set.</p><pre>red# <tt><b>metaset -s blue</b></tt>


Set name = blue, Set number = 1

Host                Owner
  host1             Yes 

Drive               Dbase
  c1t6d0             Yes 
  c2t6d0             Yes </pre><p><a name="maintaintasksnew-ix208"></a>The <tt>metaset</tt> command by itself displays the status of all disk sets.</p>

<a name="tasks-disksets-67"></a><h4>How to Delete Disks From a Disk Set</h4><a name="indexterm-175"></a><a name="indexterm-176"></a><a name="indexterm-177"></a><ol>
<li><b>To delete a disk from a disk set, use one of the
following methods:</b>
<ul><li><p>From the Enhanced Storage tool within the Solaris Management Console, open the Disk Sets node. Click the right mouse on the Disk Set that you want to release. Then choose Properties from the menu. Click the Disks tab. Follow the instructions in the online help.</p></li>
<li><p>Use the following form of the <tt>metaset</tt> command to delete a disk from a disk set.</p><pre># <tt><b>metaset -s </tt><i>diskset-name</i><tt> -d </tt><i>disk-name</i><tt></b></tt></pre><dl><dt><tt>-s</tt> <i>diskset-name</i></dt>
<dd><p>Specifies the name of a disk set on which to delete the disk.</p></dd>
<dt><tt>-d</tt> <i>disk-name</i></dt>
<dd><p>Specifies the disks to delete from the disk set. Disk names are in the form <tt>c</tt><i>x</i><tt>t</tt><i>x</i><tt>d</tt><i>x</i>. The &ldquo;s<i>x</i>&rdquo; slice identifiers are not included when deleting a disk from a disk set.</p></dd>
</dl>
<p>See the <a href="http://docs.sun.com/doc/819-2240/metaset-1m?a=view"><tt>metaset</tt>(1M)</a> man page for more information.</p></li></ul>
</li>
<li><a name="tasks-disksets-step-69"></a><b>Verify that the disk has been deleted from the disk.</b><pre># <tt><b>metaset -s </tt><i>diskset-name</i><tt></b></tt></pre>
<hr><p><b>Note - </b>To delete a disk set, you must first delete all the disks
from the disk set.</p>
<hr>
</li></ol><a name="egjwv"></a>Example&nbsp;19-7 Deleting a Disk from a Disk Set<p>The following example shows the deletion of the disk, <tt>c1t6d0</tt> from the disk
set, <tt>blue</tt>.</p><pre>host1# <tt><b>metaset -s blue -d c1t6d0</b></tt>
host1# <tt><b>metaset -s blue</b></tt>
 
Set name = blue, Set number = 1

Host                Owner
  host1            
    host2 

Drive               Dbase
  c2t6d0             Yes 
 </pre>

<a name="tasks-disksets-3"></a><h4>How to Take a Disk Set</h4><a name="indexterm-178"></a><a name="indexterm-179"></a><a name="indexterm-180"></a>
<hr><p><b>Note - </b>This option is not available for multi-owner disk sets.</p>
<hr>
<ul>
<li><a name="tasks-disksets-step-60"></a><b>Use one of the following methods to take a disk set:</b>
<ul><li><p>From the Enhanced Storage tool within the Solaris Management Console, open the Disk Sets node. Click the right mouse on the disk set you want to take. Then, hen choose Take Ownership from the menu. For more information, see the online help.</p></li>
<li><p>Use the following form of the <tt>metaset</tt> command.</p><pre># <tt><b>metaset -s </tt><i>diskset-name</i><tt> -t -f </b></tt></pre></li></ul>
<dl><dt><tt>-s</tt> <i>diskset-name</i></dt>
<dd><p>Specifies the name of a disk set to take.</p></dd>
<dt><tt>-t</tt></dt>
<dd><p>Specifies to take the disk set.</p></dd>
<dt><tt>-f</tt></dt>
<dd><p>Specifies to take the disk set forcibly.</p></dd>
</dl>
<p>See the <a href="http://docs.sun.com/doc/819-2240/metaset-1m?a=view"><tt>metaset</tt>(1M)</a> man page for more information.</p><p>Only one host at a time can own a disk set. When one
host in a disk set takes the disk set, the other host
in the disk set cannot access data on the disks in the disk
set. </p><p>The default behavior of the <tt>metaset</tt> command is to allow your host to take
the disk set only if a release is possible on the host
that has ownership of the disk set. Use the <tt>-f</tt> option to forcibly
take the disk set. This option takes the disk set whether or not
another host currently has the set. Use this method when a host in
the disk set is down or not communicating. If the other host had
the disk set taken at this point, it would panic when it attempts
to perform an I/O operation on the disk set.</p>
<hr><p><b>Note - </b>Disk set ownership is only shown on the owning host.</p>
<hr>
</li></ul><a name="egjxa"></a>Example&nbsp;19-8 Taking a Disk Set<p>In the following example, the host, <tt>host1</tt>, communicates with the host, <tt>host2</tt>. This
communication ensures that the host <tt>host2</tt> has released the disk set before the
host, <tt>host1</tt>, attempts to take the disk set.</p><pre>host1# <tt><b>metaset</b></tt>
...
Set name = blue, Set number = 1
 
Host                Owner
  host1
  host2
...
host1# <tt><b>metaset -s blue -t</b></tt>
host2# <tt><b>metaset</b></tt>
...
Set name = blue, Set number = 1
 
Host                Owner
  host1                Yes
  host2
...</pre><p>If <tt>host2</tt> owned the disk set, <tt>blue</tt>, the &ldquo;Owner&rdquo; column in the preceding
output would still have been blank. The <tt>metaset</tt> command only shows whether the
host issuing the command owns the disk set.</p><a name="egjxb"></a>Example&nbsp;19-9 Taking a Disk Set Forcibly<p><a name="indexterm-181"></a>In the following example, the host that is taking the disk set does
not communicate with the other host. Instead, the <tt>-f</tt> option allows the disks
in the disk set to be forcibly taken without warning. If the other
host had owned the disk set, that host would panic when it
attempted an I/O operation on the disk set.</p><pre># <tt><b>metaset -s blue -t -f</b></tt></pre>

<a name="tasks-disksets-6"></a><h4>How to Release a Disk Set</h4><a name="indexterm-182"></a><a name="indexterm-183"></a><a name="indexterm-184"></a><p>Releasing a disk set is useful when you perform maintenance on the
physical disks in the disk set. When a disk set is released, it
cannot be accessed by the host. If both hosts in a disk set
release the set, neither host in the disk set can access directly the
volumes or hot spare pools that are defined in the disk set .
However, if both hosts release the disk set, the hosts can access the
disks directly through their <tt>c*t*d*</tt> names.</p>
<hr><p><b>Note - </b>This option is not available for multi-owner disk sets.</p>
<hr>
<h6>Before You Begin</h6><p>Check <a href="egjyp.html">Guidelines for Working With Disk Sets</a>.</p><ol>
<li><a name="tasks-disksets-step-75"></a><b>Use one of the following methods to release a disk set:</b>
<ul><li><p>From the Enhanced Storage tool within the Solaris Management Console, open the Disk Sets node. Click the right mouse on the disk set that you want to release. Then choose Release Ownership from the menu. For more information, see the online help.</p></li>
<li><p>To release ownership of the disk set, use the following form of the <tt>metaset</tt> command:</p><pre># <tt><b>metaset -s </tt><i>diskset-name</i><tt> -r</b></tt></pre><dl><dt><tt>-s</tt> <i>diskset-name</i></dt>
<dd><p>Specifies the name of a disk set on which the <tt>metaset</tt> command will work.</p></dd>
<dt><tt>-r</tt></dt>
<dd><p>Releases ownership of a disk set. The reservation of all the disks within the disk set is removed. The volumes within the disk set are no longer accessible.</p></dd>
</dl>
<p>See the <a href="http://docs.sun.com/doc/819-2240/metaset-1m?a=view"><tt>metaset</tt>(1M)</a> man page for more information.</p>
<hr><p><b>Note - </b>Disk set ownership is only shown on the owning host.</p>
<hr>
</li></ul>
</li>
<li><a name="tasks-disksets-step-10"></a><b>Verify that the disk set has been released on this host.</b><pre># <tt><b>metaset</b></tt></pre></li></ol><a name="egjwf"></a>Example&nbsp;19-10 Releasing a Disk Set<p>The following example shows the release of the disk set, <tt>blue</tt>. Note that
there is no owner of the disk set. Viewing status from the
host <tt>host1</tt> could be misleading. A host can only determine if it
does or does not own a disk set. For example, if he host,
<tt>host2</tt>, were to take ownership of the disk set, the ownership would not
appear from the host, <tt>host1</tt>. Only the host, <tt>host2</tt>, would display that <tt>host2</tt> has
ownership of the disk set.</p><pre>host1# <tt><b>metaset -s blue -r</b></tt>
host1# <tt><b>metaset -s blue</b></tt>
 
Set name = blue, Set number = 1

Host                Owner
  host1            
    host2

Drive               Dbase
  c1t6d0             Yes 
  c2t6d0             Yes 
 </pre>

<a name="tasks-disksets-71"></a><h4>How to Delete a Host or Disk Set</h4><a name="indexterm-185"></a><a name="indexterm-186"></a><a name="indexterm-187"></a><a name="indexterm-188"></a><a name="indexterm-189"></a><a name="indexterm-190"></a><p>Deleting a disk set requires that the disk set contains no disks
and that no other hosts are attached to the disk set. Deleting the
last host destroys the disk set.</p><ol>
<li><a name="tasks-disksets-step-76"></a><b>Use one of the following methods to delete a host from a disk
set, or to delete a disk set:</b>
<ul><li><p>From the Enhanced Storage tool within the Solaris Management Console, open the Disk Sets node. Click the right mouse on the disk set you want to release, then choose Delete from the menu. Follow the instructions in the online help.</p></li>
<li><p>To delete the host use the following form of the <tt>metaset</tt> command. </p><pre><tt>metaset <tt>-s</tt> <i>diskset-name</i> <tt>-d</tt> <tt>-h</tt> <i>hostname</i></tt></pre><dl><dt><tt>-s</tt> <i>diskset-name</i></dt>
<dd><p>Specifies the name of a disk set on which the <tt>metaset</tt> command will work.</p></dd>
<dt><tt>-d</tt></dt>
<dd><p>Deletes a host from a disk set.</p></dd>
<dt><tt>-h</tt> <i>hostname</i></dt>
<dd><p>Specifies the name of the host to delete.</p></dd>
</dl>
<p>Use the same form of the preceding <tt>metaset</tt> command to delete a disk set. Deleting a disk set requires that the disk set contains no disks and that no other hosts own the disk set. Deleting the last host destroys the disk set.</p><p>See the <a href="http://docs.sun.com/doc/819-2240/metaset-1m?a=view"><tt>metaset</tt>(1M)</a> man page for more information.</p></li></ul>
</li>
<li><a name="tasks-disksets-step-73"></a><b>Verify that the host has been deleted from the disk set by using
the <tt>metaset</tt> command. Note that only the current (owning) host is shown. Other
hosts have been deleted.</b><pre># <tt><b>metaset -s </tt><i>disk-set</i><tt></b></tt></pre></li></ol><a name="eyprk"></a>Example&nbsp;19-11 Deleting a Host From a Disk Set<p>The following example shows the deletion of the host, <tt>host2</tt> from the disk
set, <tt>blue</tt>.</p><pre># <tt><b>metaset -s blue</b></tt>
Set name = blue, Set number = 1

Host                Owner
  host1            Yes 
..host2

Drive               Dbase
  c1t2d0             Yes 
  c1t3d0             Yes 
  c1t4d0             Yes 
  c1t5d0             Yes 
  c1t6d0             Yes 
  c2t1d0             Yes</pre><pre># <tt><b>metaset -s blue -d -h host2</b></tt></pre><pre># <tt><b>metaset -s blue</b></tt>
Set name = blue, Set number = 1

Host                Owner
  host1            Yes 

Drive               Dbase
  c1t2d0             Yes 
  c1t3d0             Yes 
  c1t4d0             Yes 
  c1t5d0             Yes 
  c1t6d0             Yes 
  c2t1d0             Yes</pre><a name="egjwl"></a>Example&nbsp;19-12 Deleting the Last Host from a Disk Set<p>The following example shows the deletion of the last host from the
disk set, <tt>blue</tt>.</p><pre>host1# <tt><b>metaset -s blue -d -h host1</b></tt>
host1# <tt><b>metaset -s blue</b></tt>
 
metaset: host: setname "blue": no such set </pre>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="tasks-disksets-41.html">Previous</a>
             </td>
             <td align="right">
                 <a href="efnri.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

