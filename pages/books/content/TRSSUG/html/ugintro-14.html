<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Trusted Extensions Provides Discretionary and Mandatory Access Control - Solaris Trusted Extensions User's Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-08-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.org"><img border="0" src="graphics/header.png"></img></a>
   </div>
   <div class="Title">Solaris Trusted Extensions User's Guide</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ugintro-12.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ugintro-16.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="uguidepreface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="ugintro-1.html">1.&nbsp;&nbsp;Introduction to Solaris Trusted Extensions Software</a></p>
<p class="toc level2"><a href="ugintro-10.html">What Is Trusted Extensions Software?</a></p>
<p class="toc level2"><a href="ugintro-12.html">Trusted Extensions Protects Against Intruders</a></p>
<div class="onpage">
<p class="toc level2"><a href="">Trusted Extensions Provides Discretionary and Mandatory Access Control</a></p>
</div>
<p class="toc level2"><a href="ugintro-16.html">Trusted Extensions Separates Information by Label</a></p>
<p class="toc level2"><a href="ugintro-18.html">Trusted Extensions Enables Secure Administration</a></p>
<p class="toc level1 tocsp"><a href="uglog-1.html">2.&nbsp;&nbsp;Logging In to Trusted Extensions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ugtour-1.html">3.&nbsp;&nbsp;Working in Trusted Extensions (Tasks)</a></p>
<p class="toc level1 tocsp"><a href="ugelem-1.html">4.&nbsp;&nbsp;Elements of Trusted Extensions (Reference)</a></p>
<p class="toc level1 tocsp"><a href="uggloss-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="ugintro-14"></a><h3>Trusted Extensions Provides Discretionary and Mandatory Access Control</h3>
<p>Trusted Extensions controls which users can access which information by providing both discretionary
and mandatory access control.</p>

<a name="ugintro-8"></a><h4>Discretionary Access Control</h4>
<a name="indexterm-26"></a><a name="indexterm-27"></a><a name="indexterm-28"></a><a name="indexterm-29"></a><a name="indexterm-30"></a><a name="indexterm-31"></a><a name="indexterm-32"></a><p>Discretionary access control (DAC) is a software mechanism for controlling user access to
files and directories. DAC leaves setting protections for files and directories to the
owner's discretion. The two forms of DAC are UNIX<sup>&reg;</sup>
				  permission bits and
access control lists (ACLs).</p><p>Permission bits let the owner set read, write, and execute protection by owner,
group, and other users. In traditional UNIX systems, the superuser or <tt>root</tt> user
can override DAC protection. With Trusted Extensions software, the ability to override DAC
is permitted for administrators and authorized users only. ACLs provide a finer granularity
of access control. ACLs enable owners to specify separate permissions for specific users
and specific groups. For more information, see <a href="http://docs.sun.com/doc/819-3321/secfile-1?a=view">Chapter 7, Controlling Access to Files (Tasks), in <i>System Administration Guide: Security Services</i></a>.</p>

<a name="ugintro-32"></a><h4>Mandatory Access Control</h4>
<a name="indexterm-33"></a><a name="indexterm-34"></a><a name="indexterm-35"></a><a name="indexterm-36"></a><p>Mandatory access control (MAC) is a system-enforced access control mechanism that is based
on label relationships. The system associates a sensitivity label with all processes that
are created to execute programs. MAC policy uses this label in access control
decisions. In general, processes cannot store information or communicate with other processes, unless
the label of the destination is equal to the label of the process.
MAC policy permits processes to read data from objects at the same label
or from objects at a lower label. However, the administrator can create a
labeled environment in which few lower-level objects or no lower-level objects are available.</p><p>By default, MAC policy is invisible to you. Regular users cannot see objects
unless they have MAC access to those objects. In all cases, users cannot
take any action that is contrary to MAC policy.</p>

<a name="ugintro-9"></a><h5>Sensitivity Labels and Clearances</h5>
<a name="indexterm-37"></a><p><a name="indexterm-38"></a>A label has the following two components:</p>
<ul><li><p>Classification, also referred to as a <b>level</b></p><p>This component indicates a hierarchical level of security. When applied to people, the classification represents a measure of trust. When applied to data, a classification is the degree of protection that is required.</p><p>In the U.S. Government, the classifications are <tt>TOP SECRET</tt>, <tt>SECRET</tt>, <tt>CONFIDENTIAL</tt>, and <tt>UNCLASSIFIED</tt>. Industry classifications are not as standardized. Unique classifications can be established by a company. For an example, see <a href="#ugintro-fig-10">Figure&nbsp;1-3</a>. The terms on the left are classifications. The terms on the right are compartments.</p></li>
<li><p><a name="indexterm-39"></a>Compartments, also referred to as <b>categories</b></p><p>A compartment represents a grouping, such as a work group, department, project, or topic. A classification does not have to have a compartment. In <a href="#ugintro-fig-10">Figure&nbsp;1-3</a>, the <tt>Confidential</tt> classification has three exclusive compartments. <tt>Public</tt> and <tt>Max Label</tt> have no compartments. As the figure shows, five labels are defined by this organization.</p></li></ul>
<p><a name="indexterm-40"></a><a name="indexterm-41"></a><a name="indexterm-42"></a><a name="indexterm-43"></a><a name="indexterm-44"></a><a name="indexterm-45"></a><a name="indexterm-46"></a><a name="indexterm-47"></a>Trusted Extensions maintains two types of labels: <b>sensitivity labels</b> and <b>clearances</b>. A user can be
cleared to work at one or more sensitivity labels. A special label, known
as the <b>user clearance</b>, determines the highest label at which a user is permitted
to work. In addition, each user has a minimum sensitivity label. This label
is used by default during login to a multilevel desktop session. After login,
the user can choose to work at other labels within this range. A
user could be assigned <tt>Public</tt> as the minimum sensitivity label and <tt>Confidential: Need to Know</tt> as the
clearance. At first login, the desktop workspaces are at the label <tt>Public</tt>.
During the session, the user can create workspaces at <tt>Confidential: Internal Use Only</tt> and <tt>Confidential: Need to Know</tt>.</p><a name="ugintro-fig-10"></a><h6>Figure&nbsp;1-3 Typical Industry Sensitivity Labels</h6><img src="figures/industry.labels.UG.gif" alt="Diagram shows typical labels and clearances as defined by industry."></img><p><a name="indexterm-48"></a><a name="indexterm-49"></a>All subjects and objects have labels on a system that is configured with
Trusted Extensions. A <b>subject</b> is an active entity, usually a process. The process
causes information to flow among objects or changes the system state. An <b>object</b>
is a passive entity that contains or receives data, such as a data
file, directory, printer, or other device. In some cases, a process can be
an object, such as when you use the <tt>kill</tt> command on a
process.</p><p><a name="indexterm-50"></a><a name="indexterm-51"></a><a name="indexterm-52"></a>Labels can be displayed in window title bars and in the <b>trusted stripe</b>, which is
a special stripe on the screen. Labels can be hidden. Label visibility depends
on how the administrator  configured the system. <a href="#ugintro-fig-12">Figure&nbsp;1-4</a> shows a typical
multilevel Trusted Extensions session on a system that is configured to display labels.
 The labels and trusted stripe are indicated.</p><a name="ugintro-fig-12"></a><h6>Figure&nbsp;1-4 Typical Trusted CDE Session</h6><img src="figures/workspace.basic.gif" alt="Screen shows labels on windows and icons, the trusted stripe with the trusted symbol and work space label, and the Trusted Path menu."></img>

<a name="ugintro-25"></a><h5>Containers and Labels</h5>
<a name="indexterm-53"></a><a name="indexterm-54"></a><p>Trusted Extensions uses containers for labeling. Containers are also called <b>zones</b>. The
<b>global zone</b> is an administrative zone, and is not available to users. Non-global zones
are called <b>labeled zones</b>. Labeled zones are used by users. The global zone
shares some system files with users. When these files are visible in a
labeled zone, the label of these files is <tt>ADMIN_LOW</tt>.</p><p>Network communication is restricted by label. By default, zones cannot communicate with each
other because their labels are different. Therefore, one zone cannot write into another
zone.</p><p><a name="indexterm-55"></a><a name="indexterm-56"></a><a name="indexterm-57"></a><a name="indexterm-58"></a><a name="indexterm-59"></a>However, the administrator can configure specific zones to be able to read specific directories
from other zones. The other zones could be on the same host,
or on a remote system. For example, a user's home directory in a
lower-level zone can be mounted by using the automount service. The pathname convention for
such lower-level home mounts includes the zone name, as follows:</p><pre>/zone/<i>name-of-lower-level-zone</i>/home/<i>username</i></pre><p>The following terminal window illustrates lower-level home directory visibility. A user whose login
label is <tt>Confidential: Internal Use Only</tt> can view the contents of the <tt>Public</tt> zone when the
automount service is configured to make lower-level zones readable. The <tt>textfileInfo.txt</tt> file has
two versions. The <tt>Public</tt> zone version contains information that can be shared
with the public. The <tt>Confidential: Internal Use Only</tt> version contains information that can be shared within the
company only.</p><a name="ugintro-26"></a><h6>Figure&nbsp;1-5 Viewing Public Information From a Higher-Label Zone</h6><img src="figures/dir.struct.internaltopublic.gif" alt="Illustration shows that the contents of the Public zone is visible from the Internal Use Only zone." width="849" height="328"></img>

<a name="ugintro-13"></a><h5>Labels and Transactions</h5>
<a name="indexterm-60"></a><a name="indexterm-61"></a><a name="indexterm-62"></a><p>Trusted Extensions software manages all attempted security-related transactions. The software compares the subject's
label with the object's label, then allows or disallows the transaction depending on
which label is <b>dominant</b>. An entity's label is said to <b>dominate</b> another entity's label
if the following two conditions are met:</p>
<ul><li><p>The classification component of the first entity's label is equal to the object's classification or is higher than the object's classification.</p></li>
<li><p>All compartments in the second entity's labels are included in the first entity's label.</p></li></ul>
<p>Two labels are said to be <b>equal</b> if the labels have the same
classification and the same set of compartments. If the labels are equal, the
labels dominate each other. Therefore, access is permitted.</p><p>If one of the following conditions is met, then the first label
is said to <b>strictly dominate</b> the second label.</p>
<ul><li><p>The first label has a higher classification than a second label</p></li>
<li><p>The first label's classification is equal to a second label's classification, the first label includes the second label's compartments, and the first label has additional compartments</p></li></ul>
<p>A label that strictly dominates a second label is permitted access to the
second label.</p><p>Two labels are said to be <b>disjoint</b> if neither label dominates the other
label. Access is not permitted between disjoint labels.</p><p><a name="indexterm-63"></a>For example, consider the following figure.</p><img src="figures/TS.AB.Label.UG.gif" alt="Illustration shows a Top Secret classification with two possible compartments, A and B."></img><p>Four labels can be created from these components:</p>
<ul><li><p><tt>TOP SECRET</tt></p></li>
<li><p><tt>TOP SECRET A</tt></p></li>
<li><p><tt>TOP SECRET B</tt></p></li>
<li><p><tt>TOP SECRET AB</tt></p></li></ul>
<p><tt>TOP SECRET AB</tt> dominates itself and strictly dominates the other labels. <tt>TOP SECRET A</tt> dominates itself and
strictly dominates <tt>TOP SECRET</tt>. <tt>TOP SECRET B</tt> dominates itself and strictly dominates <tt>TOP SECRET</tt>. <tt>TOP SECRET A</tt> and <tt>TOP SECRET B</tt> are
disjoint.</p><p><a name="indexterm-64"></a><a name="indexterm-65"></a>In a read transaction, the subject's label must dominate the object's label. This
rule ensures that the subject's level of trust meets the requirements for access
to the object. That is, the subject's label includes all compartments that are
allowed access to the object. <tt>TOP SECRET A</tt> can read <tt>TOP SECRET A</tt> and <tt>TOP SECRET</tt> data. Similarly, <tt>TOP SECRET B</tt>
can read <tt>TOP SECRET B</tt> and <tt>TOP SECRET</tt> data. <tt>TOP SECRET A</tt> cannot read <tt>TOP SECRET B</tt> data. Nor
can <tt>TOP SECRET B</tt> read  <tt>TOP SECRET A</tt> data. <tt>TOP SECRET AB</tt> can read the data at all
labels.</p><p><a name="indexterm-66"></a><a name="indexterm-67"></a>In a write transaction, that is, when a subject creates or modifies an
object, the resulting object's labeled zone must equal the subject's labeled zone. Write
transactions are not allowed from one zone to a different zone.</p><p><a name="indexterm-68"></a><a name="indexterm-69"></a>In practice, subjects and objects in read and write transactions usually have the
same label and strict dominance does not have to be considered. For example,
a <tt>TOP SECRET A</tt> subject can create or modify a <tt>TOP SECRET A</tt> object. In Trusted Extensions, the
<tt>TOP SECRET A</tt> object is in a zone that is labeled <tt>TOP SECRET A</tt>.</p><p>The following table illustrates dominance relationships among U.S. Government labels and among a
set of industry labels.</p><a name="ugintro-tbl-14"></a><h6>Table&nbsp;1-1 Examples of Label Relationships in Trusted Extensions</h6><table><col width="11%"><col width="33%"><col width="33%"><col width="22%"><tr><th align="left" valign="top" scope="column"></th>
<th align="left" valign="top" scope="column"><p>Label 1</p></th>
<th align="left" valign="top" scope="column"><p>Relationship</p></th>
<th align="left" valign="top" scope="column"><p>Label 2</p></th>
</tr>
<tr><td rowspan="2" align="left" valign="top" scope="row"><p>U.S. Government Labels</p></td>
<td align="left" valign="top" scope="row"><p><tt>TOP SECRET AB</tt></p></td>
<td align="left" valign="top" scope="row"><p>(strictly) dominates</p></td>
<td align="left" valign="top" scope="row"><p><tt>SECRET A</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>TOP SECRET AB</tt></p></td>
<td align="left" valign="top" scope="row"><p>(strictly) dominates</p></td>
<td align="left" valign="top" scope="row"><p><tt>SECRET A B</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"></td>
<td align="left" valign="top" scope="row"><p><tt>TOP SECRET AB</tt></p></td>
<td align="left" valign="top" scope="row"><p>(strictly) dominates</p></td>
<td align="left" valign="top" scope="row"><p><tt>TOP SECRET A</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"></td>
<td align="left" valign="top" scope="row"><p><tt>TOP SECRET AB</tt></p></td>
<td align="left" valign="top" scope="row"><p>dominates (equals)</p></td>
<td align="left" valign="top" scope="row"><p><tt>TOP SECRET AB</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"></td>
<td align="left" valign="top" scope="row"><p><tt>TOP SECRET AB</tt></p></td>
<td align="left" valign="top" scope="row"><p>is
disjoint with</p></td>
<td align="left" valign="top" scope="row"><p><tt>TOP SECRET C</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"></td>
<td align="left" valign="top" scope="row"><p><tt>TOP SECRET AB</tt></p></td>
<td align="left" valign="top" scope="row"><p>is disjoint with</p></td>
<td align="left" valign="top" scope="row"><p><tt>SECRET C</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"></td>
<td align="left" valign="top" scope="row"><p><tt>TOP SECRET AB</tt></p></td>
<td align="left" valign="top" scope="row"><p>is disjoint with</p></td>
<td align="left" valign="top" scope="row"><p><tt>SECRET A B C</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Industry Labels</p></td>
<td align="left" valign="top" scope="row"><p><tt>Confidential: Restricted</tt></p></td>
<td align="left" valign="top" scope="row"><p>dominates</p></td>
<td align="left" valign="top" scope="row"><p><tt>Confidential: Need to Know</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"></td>
<td align="left" valign="top" scope="row"><p><tt>Confidential: Restricted</tt></p></td>
<td align="left" valign="top" scope="row"><p>dominates</p></td>
<td align="left" valign="top" scope="row"><p><tt>Confidential: Internal Use Only</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"></td>
<td align="left" valign="top" scope="row"><p><tt>Confidential: Restricted</tt></p></td>
<td align="left" valign="top" scope="row"><p>dominates</p></td>
<td align="left" valign="top" scope="row"><p><tt>Public</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"></td>
<td align="left" valign="top" scope="row"><p><tt>Confidential: Need to Know</tt></p></td>
<td align="left" valign="top" scope="row"><p>dominates</p></td>
<td align="left" valign="top" scope="row"><p><tt>Confidential: Internal Use Only</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"></td>
<td align="left" valign="top" scope="row"><p><tt>Confidential: Need to Know</tt></p></td>
<td align="left" valign="top" scope="row"><p>dominates</p></td>
<td align="left" valign="top" scope="row"><p><tt>Public</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"></td>
<td align="left" valign="top" scope="row"><p><tt>Confidential: Internal</tt></p></td>
<td align="left" valign="top" scope="row"><p>dominates</p></td>
<td align="left" valign="top" scope="row"><p><tt>Public</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"></td>
<td align="left" valign="top" scope="row"><p><tt>Sandbox</tt></p></td>
<td align="left" valign="top" scope="row"><p>is disjoint with</p></td>
<td align="left" valign="top" scope="row"><p>All other labels</p></td>
</tr>
</table><p><a name="indexterm-70"></a><a name="indexterm-71"></a><a name="indexterm-72"></a><a name="indexterm-73"></a><a name="indexterm-74"></a><a name="indexterm-75"></a>When you transfer information between files with different labels, Trusted Extensions displays a
confirmation dialog box if you are authorized to change the label of the
file. If you are not authorized to do so, Trusted Extensions disallows the
transaction. The security administrator can authorize you to upgrade or downgrade information. For
more information, see <a href="ugelem-16.html">Performing Trusted Actions</a>.</p>

<a name="ugintro-21"></a><h4>User Responsibilities for Protecting Data</h4>
<a name="indexterm-76"></a><a name="indexterm-77"></a><a name="indexterm-78"></a><p><a name="indexterm-79"></a><a name="indexterm-80"></a>As a user, you are responsible for setting the permissions to protect your
files and directories. Actions that you can perform to set permissions use a
mechanism called discretionary access control (DAC). You can check the permissions on your
files and directories by using the <tt>ls -l</tt> command or by using the File
Manager, as described in <a href="ugtour-1.html">Chapter&nbsp;3, Working in Trusted Extensions (Tasks)</a>.</p><p>Mandatory access control (MAC) is enforced automatically by the system. If you are
authorized to upgrade or downgrade labeled information, you have a critical responsibility to
ensure that the need for changing the level of information is legitimate.</p><p><a name="indexterm-81"></a>Another aspect of protecting data involves email. Never follow instructions that you receive
in email from an administrator. For example, if you followed emailed instructions to
change your password to a particular value, you would enable the sender to
log in to your account. In limited cases, you might verify the instructions
independently before following the instructions.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="ugintro-12.html">Previous</a>
             </td>
             <td align="right">
                 <a href="ugintro-16.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

