<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Creating a New Boot Environment - Solaris Express Installation Guide:  Solaris Live Upgrade and Upgrade Planning</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-05-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">Solaris Express Installation Guide:  Solaris Live Upgrade and Upgrade Planning</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="lucreate-8.html">Previous</a>
             </td>
             <td align="right">
                 <a href="liveupgrade-1.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="esqbt.html">Part&nbsp;I&nbsp;Upgrading With Solaris Live Upgrade</a></p>
<p class="toc level2"><a href="intro-1.html">1.&nbsp;&nbsp;Where to Find Solaris Installation Planning Information</a></p>
<p class="toc level2"><a href="luoverview-1.html">2.&nbsp;&nbsp;Solaris Live Upgrade (Overview)</a></p>
<p class="toc level2"><a href="luplanning-1.html">3.&nbsp;&nbsp;Solaris Live Upgrade (Planning)</a></p>
<p class="toc level2"><a href="lucreate-1.html">4.&nbsp;&nbsp;Using Solaris Live Upgrade to Create a Boot Environment (Tasks)</a></p>
<p class="toc level3"><a href="lucreate-7.html">Task Map: Installing Solaris Live Upgrade and Creating Boot Environments</a></p>
<p class="toc level3"><a href="lucreate-8.html">Installing Solaris Live Upgrade</a></p>
<p class="toc level4"><a href="lucreate-8.html#lucreate-3">To Install Solaris Live Upgrade With the <tt>pkgadd</tt> Command</a></p>
<p class="toc level4"><a href="lucreate-8.html#luupgrade-1">To Install Solaris Live Upgrade With the Solaris Installation Program</a></p>
<div class="onpage">
<p class="toc level3 tocsp"><a href="">Creating a New Boot Environment</a></p>
<p class="toc level4"><a href="#lucreate-16">To Create a Boot Environment for the First Time</a></p>
<p class="toc level4"><a href="#lucreate-15">To Create a Boot Environment and Merge File Systems </a></p>
<p class="toc level4"><a href="#lucreate-14">To Create a Boot Environment and Split File Systems</a></p>
<p class="toc level4"><a href="#lucreate-13">To Create a Boot Environment and Reconfiguring Swap</a></p>
<p class="toc level4"><a href="#lucreate-12">To Create a Boot Environment and Reconfigure Swap by Using a List</a></p>
<p class="toc level4"><a href="#lucreate-11">To Create a Boot Environment and Copy a Shareable File System</a></p>
<p class="toc level4"><a href="#lucreate-27">To Create a Boot Environment From a Different Source</a></p>
<p class="toc level4"><a href="#lucreate-28">To Create an Empty Boot Environment for a  Solaris Flash Archive</a></p>
<p class="toc level4"><a href="#lucreate-1000">To Create a Boot Environment With RAID-1 Volumes (Mirrors)</a></p>
<p class="toc level4"><a href="#lucreate-1601">To Create a Boot Environment and Customize the Content</a></p>
</div>
<p class="toc level2 tocsp"><a href="liveupgrade-1.html">5.&nbsp;&nbsp;Upgrading With Solaris Live Upgrade (Tasks)</a></p>
<p class="toc level2"><a href="luupgrade-85.html">6.&nbsp;&nbsp;Failure Recovery: Falling Back to the Original Boot Environment (Tasks)</a></p>
<p class="toc level2"><a href="lumaintainence-1.html">7.&nbsp;&nbsp;Maintaining Solaris Live Upgrade Boot Environments (Tasks)</a></p>
<p class="toc level2"><a href="grub-101.html">8.&nbsp;&nbsp;x86: Locating the GRUB Menu's <tt>menu.lst</tt> File (Tasks)</a></p>
<p class="toc level2"><a href="gdzlc.html">9.&nbsp;&nbsp;Upgrading the Solaris OS on a System With Non-Global  Zones Installed</a></p>
<p class="toc level2"><a href="luexample-1.html">10.&nbsp;&nbsp;Solaris Live Upgrade (Examples)</a></p>
<p class="toc level2"><a href="lureference-1.html">11.&nbsp;&nbsp;Solaris Live Upgrade (Command Reference)</a></p>
<p class="toc level1 tocsp"><a href="esqcb.html">Part&nbsp;II&nbsp;Appendices</a></p>
<p class="toc level2"><a href="troubleshooting-9.html">A.&nbsp;&nbsp;Troubleshooting (Tasks)</a></p>
<p class="toc level2"><a href="package-9.html">B.&nbsp;&nbsp;Additional SVR4 Packaging Requirements (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="chapter-33"></a><h3>Creating a New Boot Environment</h3>
<p><a name="indexterm-45"></a>Creating a boot environment provides a method of copying critical file systems from
the active boot environment to a new boot environment. The <tt>lucreate</tt> command enables
reorganizing a disk if necessary, customizing file systems, and copying the critical file systems
to the new boot environment. </p><p>Before file systems are copied to the new boot environment, they can be
customized so that critical file system directories are either merged into their parent
directory or split from their parent directory. User-defined (shareable) file systems are shared
between boot environments by default. But shareable file systems can be copied if
needed. Swap, which is a shareable file system, can be split and merged
also. For an overview of critical and shareable file systems, see <a href="luoverview-100.html#luoverview-13">File System Types</a>.</p>

<a name="lucreate-16"></a><h4>To Create a Boot Environment for the First Time</h4><p>The <tt>lucreate</tt> command that is used with the <tt>-m</tt> option specifies which file
systems and the number of file systems to be created in the new
boot environment. You must specify the exact number of file systems you want
to create by repeating this option. For example, a single use of the
<tt>-m</tt> option specifies where to put all the file systems. You merge all
the file systems from the original boot environment into  the one file
system that is specified by the <tt>-m</tt> option. If you specify the <tt>-m</tt>
option twice, you create two file systems. When using the <tt>-m</tt> option to
create file systems, follow these guidelines:</p>
<ul><li><p>You must specify one <tt>-m</tt> option for the root (<tt>/</tt>) file system for the new boot environment. If you run <tt>lucreate</tt> without the <tt>-m</tt> option, the Configuration menu is displayed. The Configuration menu enables you to customize the new boot environment by redirecting files onto new mount points.</p></li>
<li><p>Any critical file systems that exist in the current boot environment and are not specified in a <tt>-m</tt> option are merged into the next highest-level file system created.</p></li>
<li><p>Only the file systems that are specified by the <tt>-m</tt> option are created on the new boot environment. If your current boot environment contains multiple file systems, and you want to have the same number of file systems in the new boot environment created, you must specify one <tt>-m</tt> option for each file system to be created. For example, if you have file systems for root (<tt>/</tt>), <tt>/opt</tt>, and <tt>/var</tt>, you would use one <tt>-m</tt> option for each file system on the new boot environment.</p></li>
<li><p>Do not duplicate a mount point. For example, you cannot have two root (/) file systems.</p></li></ul>
<ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="lucreate-step-2200"></a><b>To create the new boot environment, type:</b><pre># <tt><b>lucreate [-A '</tt><i>BE_description</i><tt>'] -c </tt><i>BE_name</i><tt> \ -m </tt><i>mountpoint:device[,metadevice]:fs_options</i><tt> [-m ...] -n </tt><i>BE_name</i><tt></b></tt></pre><dl><dt><tt>-A</tt> '<i>BE_description</i>'</dt>
<dd><p>(Optional) Enables the creation of a boot environment description that is associated with the boot environment name (BE_name). The description can be any length and can contain any characters.</p></dd>
<dt><tt>-c</tt> <i>BE_name</i></dt>
<dd><p>Assigns the name <i>BE_name</i> to the active boot environment. This option is not required and is only used when the first boot environment is created. If you run <tt>lucreate</tt> for the first time and you omit the <tt>-c</tt> option, the software creates a default name for you. </p><p>The default name is chosen according to the following criteria:</p>
<ul><li><p>If the physical boot device can be determined, then the base name of the physical boot device is used to name the current boot environment.  </p><p>For example, if the physical boot device is <tt>/dev/dsk/c0t0d0s0</tt>, then the current boot environment is given the name <tt>c0t0d0s0</tt>. </p></li>
<li><p>If the physical boot device cannot be determined, then names from the <tt>uname</tt> command with the <tt>-s</tt> and <tt>-r</tt> options are combined to produce the name. </p><p>For example, if the <tt>uname</tt> <tt>-s</tt> returns the OS name of SunOS and the <tt>uname</tt> <tt>-r</tt> returns the release name of 5.9, then the name <tt>SunOS5.9</tt> is given to the current boot environment. </p></li>
<li><p>If both of the above cannot determine the name, then the name <tt>current</tt> is used to name the current boot environment.</p></li></ul>

<hr><p><b>Note - </b>If you use the <tt>-c</tt> option after the first boot environment creation, the option is ignored or an error message is displayed.</p>
<ul><li><p>If the name specified is the same as the current boot environment name, the option is ignored.</p></li>
<li><p>If the name specified is different than the current boot environment name, then an error message is displayed and the creation fails. The following example shows a boot environment name that causes an error message.</p><pre># <tt><b>lucurr</b></tt> 
c0t0d0s0
# <tt><b>lucreate -c /dev/dsk/c1t1d1s1 -n newbe -m /:/dev/dsk/c1t1d1s1:ufs</b></tt>
ERROR: current boot environment name is c0t0d0s0: cannot change
name using &lt;-c c1t1d1s1></pre></li></ul>

<hr>
</dd>
<dt><tt>-m</tt> <i>mountpoint:device[,metadevice]:fs_options</i> [<tt>-m</tt> ...]</dt>
<dd><p>Specifies the file systems' configuration of the new boot environment in the <tt>vfstab</tt>. The file systems that are specified as arguments to <tt>-m</tt> can be on the same disk or they can be spread across multiple disks. Use this option as many times as needed to create the number of file systems that are needed. </p>
<ul><li><p><i>mountpoint</i> can be any valid mount point or <tt>&ndash;</tt> (hyphen), indicating a swap partition.</p></li>
<li><p><i>device</i> field can be one of the following:</p>
<ul><li><p>The name of a disk device, of the form <tt>/dev/dsk/c</tt><i>w</i><tt>t</tt><i>x</i><tt>d</tt><i>y</i><tt>s</tt><i>z</i><tt></tt></p></li>
<li><p>The name of a Solaris Volume Manager volume, of the form /dev/md/dsk/d<i>num</i></p></li>
<li><p>The name of a Veritas Volume Manager volume, of the form /dev/md/vxfs/dsk/d<i>num</i></p></li>
<li><p>The keyword <tt>merged</tt>, indicating that the file system at the specified mount point is to be merged with its parent</p></li></ul>
</li>
<li><p><i>fs_options</i> field can be one of the following: </p>
<ul><li><p><tt>ufs</tt>, which indicates a UFS file system.</p></li>
<li><p><tt>vxfs</tt>, which indicates a Veritas file system.</p></li>
<li><p><tt>swap</tt>, which indicates a swap file system. The swap mount point must be a <tt>&ndash;</tt> (hyphen).</p></li>
<li><p>For file systems that are logical devices (mirrors), several keywords specify actions to be applied to the file systems. These keywords can create a logical device, change the configuration of a logical device, or delete a logical device. For a description of these keywords, see <a href="#lucreate-1000">To Create a Boot Environment With RAID-1 Volumes (Mirrors)</a>.</p></li></ul>
</li></ul>
</dd>
<dt><tt>-n</tt> <i>BE_name</i></dt>
<dd><p>The name of the boot environment to be created. <i>BE_name</i> must be unique on the system.</p></dd>
</dl>
<p>When creation of the new boot environment is complete, it can be
upgraded and can be activated (made bootable). See <a href="liveupgrade-1.html">Chapter&nbsp;5, Upgrading With Solaris Live Upgrade (Tasks)</a>.</p></li></ol><a name="lucreate-ex-1"></a>Example&nbsp;4-1 Creating a Boot Environment<p>In this example, the active boot environment is named first_disk. The mount points
for the file systems are noted by using the <tt>-m</tt> option. Two file
systems are created, root (<tt>/</tt>) and <tt>/usr</tt>. The new boot environment is named
second_disk. A description, <tt>mydescription</tt>, is associated with the name second_disk. Swap, in
the new boot environment second_disk, is automatically shared from the source, first_disk.</p><pre># <tt><b>lucreate -A 'mydescription' -c first_disk -m /:/dev/dsk/c0t4d0s0:ufs \ -m /usr:/dev/dsk/c0t4d0s3:ufs -n second_disk</b></tt></pre>

<a name="lucreate-15"></a><h4>To Create a Boot Environment and Merge File Systems </h4>
<hr><p><b>Note - </b><a name="indexterm-46"></a>You can use the <tt>lucreate</tt> command with the <tt>-m</tt> option to specify which
file systems and the number of file systems to be created in the
new boot environment. You must specify the exact number of file systems you
want to create by repeating this option. For example, a single use of
the <tt>-m</tt> option specifies where to put all the file systems. You merge
all the file systems from the original boot environment into one file system.
If you specify the <tt>-m</tt> option twice, you create two file systems. </p>
<hr>
<ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="lucreate-step-23"></a><b>Type:</b><pre># <tt><b>lucreate -A '</tt><i>BE_description</i><tt>' \ -m </tt><i>mountpoint:device[,metadevice]:fs_options</i><tt> \ -m [...] -m </tt><i>mountpoint</i><tt>:merged:</tt><i>fs_options</i><tt> -n </tt><i>BE_name</i><tt></b></tt></pre><dl><dt><tt>-A</tt> <i>BE_description</i></dt>
<dd><p>(Optional) Enables the creation of a boot environment description that is associated with the boot environment name (BE_name). The description can be any length and can contain any characters.</p></dd>
<dt><tt>-m</tt> <i>mountpoint:device[,metadevice]:fs_options</i> [<tt>-m</tt>...]</dt>
<dd><p>Specifies the file systems' configuration of the new boot environment. The file systems that are specified as arguments to <tt>-m</tt> can be on the same disk or they can be spread across multiple disks. Use this option as many times as needed to create the number of file systems that are needed. </p>
<ul><li><p><i>mountpoint</i> can be any valid mount point or <tt>&ndash;</tt> (hyphen), indicating a swap partition.</p></li>
<li><p><i>device</i> field can be one of the following:</p>
<ul><li><p>The name of a disk device, of the form <tt>/dev/dsk/c</tt><i>w</i><tt>t</tt><i>x</i><tt>d</tt><i>y</i><tt>s</tt><i>z</i><tt></tt></p></li>
<li><p>The name of a Solaris Volume Manager metadevice, of the form /dev/md/dsk/d<i>num</i></p></li>
<li><p>The name of a Veritas Volume Manager volume, of the form /dev/vx/dsk/<i>volume_name</i></p></li>
<li><p>The keyword <tt>merged</tt>, indicating that the file system at the specified mount point is to be merged with its parent</p></li></ul>
</li>
<li><p><i>fs_options</i> field can be one of the following: </p>
<ul><li><p><tt>ufs</tt>, which indicates a UFS file system.</p></li>
<li><p><tt>vxfs</tt>, which indicates a Veritas file system.</p></li>
<li><p><tt>swap</tt>, which indicates a swap file system. The swap mount point must be a <tt>&ndash;</tt> (hyphen).</p></li>
<li><p>For file systems that are logical devices (mirrors), several keywords specify actions to be applied to the file systems. These keywords can create a logical device, change the configuration of a logical device, or delete a logical device. For a description of these keywords, see <a href="#lucreate-1000">To Create a Boot Environment With RAID-1 Volumes (Mirrors)</a>.</p></li></ul>
</li></ul>
</dd>
<dt><tt>-n</tt> <i>BE_name</i></dt>
<dd><p>The name of the boot environment to be created. <i>BE_name</i> must be unique on the system.</p></dd>
</dl>
<p>When creation of the new boot environment is complete, it can be
upgraded and activated (made bootable). See <a href="liveupgrade-1.html">Chapter&nbsp;5, Upgrading With Solaris Live Upgrade (Tasks)</a>.</p></li></ol><a name="lucreate-ex-2"></a>Example&nbsp;4-2 Creating a Boot Environment and Merging File Systems<p>In this example, the file systems on the current boot environment are root
(<tt>/</tt>), <tt>/usr</tt>, and <tt>/opt</tt>. The <tt>/opt</tt> file system is combined with its parent
file system <tt>/usr</tt>. The new boot environment is named second_disk. A description, <tt>mydescription</tt>, is
associated with the name second_disk.</p><pre># <tt><b>lucreate -A 'mydescription' -c first_disk \ -m /:/dev/dsk/c0t4d0s0:ufs -m /usr:/dev/dsk/c0t4d0s1:ufs \ -m /usr/opt:merged:ufs -n second_disk</b></tt></pre>

<a name="lucreate-14"></a><h4>To Create a Boot Environment and Split File Systems</h4>
<hr><p><b>Note - </b><a name="indexterm-47"></a>When creating file systems for a boot environment, the rules are identical to
the rules for creating file systems for the Solaris OS. Solaris Live Upgrade
cannot prevent you from making invalid configurations on critical file systems. For example,
you could enter an <tt>lucreate</tt> command that would create separate file systems for
root (<tt>/</tt>) and <tt>/kernel</tt>, which is an an invalid division of the root (<tt>/</tt>)
file system. </p>
<hr>
<p>When splitting a directory into multiple mount points, hard links are not maintained
across file systems. For example, if <tt>/usr/stuff1/file</tt> is hard linked to <tt>/usr/stuff2/file</tt>, and
<tt>/usr/stuff1</tt> and <tt>/usr/stuff2</tt> are split into separate file systems, the link between the
files no longer exists. <tt>lucreate</tt> issues a warning message and a symbolic link
is created to replace the lost hard link.</p><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="luupgrade-step-54"></a><b>Type:</b><pre># <tt><b>lucreate [-A '</tt><i>BE_description</i><tt>'] \ -m </tt><i>mountpoint</i><tt>:</tt><i>device</i><tt>[,</tt><i>metadevice</i><tt>]:</tt><i>fs_options</i><tt> \ -m </tt><i>mountpoint</i><tt>:</tt><i>device</i><tt>[,</tt><i>metadevice</i><tt>]:</tt><i>fs_options</i><tt> -n </tt><i>new_BE</i><tt></b></tt></pre><dl><dt><tt>-A</tt> '<i>BE_description</i>'</dt>
<dd><p>(Optional) Enables the creation of a boot environment description that is associated with the boot environment name (BE_name). The description can be any length and contain any characters.</p></dd>
<dt><tt>-m</tt> <i>mountpoint:device[,metadevice]:fs_options</i> [<tt>-m</tt>...]</dt>
<dd><p>Specifies the file systems' configuration of the new boot environment. The file systems that are specified as arguments to <tt>-m</tt> can be on the same disk or they can be spread across multiple disks. Use this option as many times as needed to create the number of file systems that are needed. </p>
<ul><li><p><i>mountpoint</i> can be any valid mount point or <tt>&ndash;</tt> (hyphen), indicating a swap partition.</p></li>
<li><p><i>device</i> field can be one of the following:</p>
<ul><li><p>The name of a disk device, of the form <tt>/dev/dsk/c</tt><i>w</i><tt>t</tt><i>x</i><tt>d</tt><i>y</i><tt>s</tt><i>z</i><tt></tt></p></li>
<li><p>The name of a Solaris Volume Manager metadevice, of the form /dev/md/dsk/d<i>num</i></p></li>
<li><p>The name of a Veritas Volume Manager volume, of the form /dev/vx/dsk/<i>volume_name</i></p></li>
<li><p>The keyword <tt>merged</tt>, indicating that the file system at the specified mount point is to be merged with its parent</p></li></ul>
</li>
<li><p><i>fs_options</i> field can be one of the following: </p>
<ul><li><p><tt>ufs</tt>, which indicates a UFS file system.</p></li>
<li><p><tt>vxfs</tt>, which indicates a Veritas file system.</p></li>
<li><p><tt>swap</tt>, which indicates a swap file system. The swap mount point must be a <tt>&ndash;</tt> (hyphen).</p></li>
<li><p>For file systems that are logical devices (mirrors), several keywords specify actions to be applied to the file systems. These keywords can create a logical device, change the configuration of a logical device, or delete a logical device. For a description of these keywords, see <a href="#lucreate-1000">To Create a Boot Environment With RAID-1 Volumes (Mirrors)</a>.</p></li></ul>
</li></ul>
</dd>
<dt><tt>-n</tt> <i>BE_name</i></dt>
<dd><p>The name of the boot environment to be created. <i>BE_name</i> must be unique on the system.</p></dd>
</dl>
</li></ol><a name="lucreate-ex-3"></a>Example&nbsp;4-3 Creating a Boot Environment and Splitting File Systems<p>In this example, the preceding command splits the root (<tt>/</tt>) file system over
multiple disk slices in the new boot environment. Assume a source boot environment
that has <tt>/usr</tt>, <tt>/var</tt>, and <tt>/opt</tt>  on root (<tt>/</tt>): <tt>/dev/dsk/c0t0d0s0 /</tt>.</p><p>On the new boot environment, separate <tt>/usr,</tt> <tt>/var</tt>, and <tt>/opt</tt>, mounting these
file systems on their own slices, as follows:  </p><p><tt>/dev/dsk/c0t1d0s0 /</tt></p><p><tt>/dev/dsk/c0t1d0s1 /var</tt></p><p><tt>/dev/dsk/c0t1d0s7 /usr</tt></p><p><tt>/dev/dsk/c0t1d0s5 /opt</tt></p><p>A description, <tt>mydescription</tt>, is associated with the boot environment name second_disk.</p><pre># <tt><b>lucreate -A 'mydescription' -c first_disk \ -m /:/dev/dsk/c0t1d0s0:ufs -m /usr:/dev/dsk/c0t1d0s7:ufs \ -m /var:/dev/dsk/c0t1d0s1:ufs -m /opt:/dev/dsk/c0t1d0s5:ufs \ -n second_disk</b></tt></pre><p>When creation of the new boot environment is complete, it can be
upgraded and activated (made bootable). See <a href="liveupgrade-1.html">Chapter&nbsp;5, Upgrading With Solaris Live Upgrade (Tasks)</a>.</p>

<a name="lucreate-13"></a><h4>To Create a Boot Environment and Reconfiguring Swap</h4><p>Swap slices are shared between boot environments by default. By <b>not</b> specifying
swap with the <tt>-m</tt> option, your current and new boot environment share the
same swap slices. If you want to reconfigure the new boot environment's swap,
use the <tt>-m</tt> option to add or remove swap slices in the new
boot environment. </p>
<hr><p><b>Note - </b>The swap slice cannot be in use by any boot environment except the
current boot environment or if the <tt>-s</tt> option is used, the source boot
environment. The boot environment creation fails if the swap slice is being used
by any other boot environment, whether it is a swap, UFS, or any
other file system.</p><p>You can create a boot environment with the existing swap slices and then
edit the <tt>vfstab</tt> file after the creation. </p>
<hr>
<ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="luupgrade-step-76"></a><b>Type:</b><pre># <tt><b>lucreate [-A '</tt><i>BE_description</i><tt>'] \ -m </tt><i>mountpoint:device[,metadevice]:fs_options</i><tt> \ -m </tt><i>-:device</i><tt>:swap -n </tt><i>BE_name</i><tt></b></tt></pre><dl><dt><tt>-A</tt> '<i>BE_description</i>'</dt>
<dd><p>(Optional) Enables the creation of a boot environment description that is associated with the boot environment name (BE_name). The description can be any length and can contain any characters.</p></dd>
<dt><tt>-m</tt> <i>mountpoint:device[,metadevice]:fs_options</i> [<tt>-m</tt>...]</dt>
<dd><p>Specifies the file systems' configuration of the new boot environment. The file systems that are specified as arguments to <tt>-m</tt> can be on the same disk or they can be spread across multiple disks. Use this option as many times as needed to create the number of file systems that are needed. </p>
<ul><li><p><i>mountpoint</i> can be any valid mount point or <tt>&ndash;</tt> (hyphen), indicating a swap partition.</p></li>
<li><p><i>device</i> field can be one of the following:</p>
<ul><li><p>The name of a disk device, of the form <tt>/dev/dsk/c</tt><i>w</i><tt>t</tt><i>x</i><tt>d</tt><i>y</i><tt>s</tt><i>z</i><tt></tt></p></li>
<li><p>The name of a Solaris Volume Manager metadevice, of the form /dev/md/dsk/d<i>num</i></p></li>
<li><p>The name of a Veritas Volume Manager volume, of the form /dev/vx/dsk/<i>volume_name</i></p></li>
<li><p>The keyword <tt>merged</tt>, indicating that the file system at the specified mount point is to be merged with its parent</p></li></ul>
</li>
<li><p><i>fs_options</i> field can be one of the following: </p>
<ul><li><p><tt>ufs</tt>, which indicates a UFS file system.</p></li>
<li><p><tt>vxfs</tt>, which indicates a Veritas file system.</p></li>
<li><p><tt>swap</tt>, which indicates a swap file system. The swap mount point must be a <tt>&ndash;</tt> (hyphen).</p></li>
<li><p>For file systems that are logical devices (mirrors), several keywords specify actions to be applied to the file systems. These keywords can create a logical device, change the configuration of a logical device, or delete a logical device. For a description of these keywords, see <a href="#lucreate-1000">To Create a Boot Environment With RAID-1 Volumes (Mirrors)</a>.</p></li></ul>
</li></ul>
</dd>
<dt><tt>-n</tt> <i>BE_name</i></dt>
<dd><p>The name of the boot environment to be created. <i>BE_name</i> must be unique.</p></dd>
</dl>
<p>The new boot environment is created with swap moved to a different
slice or device.</p><p>When creation of the new boot environment is complete, it can be upgraded
and can be activated (made bootable). See <a href="liveupgrade-1.html">Chapter&nbsp;5, Upgrading With Solaris Live Upgrade (Tasks)</a>.</p></li></ol><a name="lucreate-ex-4"></a>Example&nbsp;4-4 Creating a Boot Environment and Reconfiguring Swap<p>In this example, the current boot environment contains root (<tt>/</tt>) on <tt>/dev/dsk/c0t0d0s0</tt> and
swap is on <tt>/dev/dsk/c0t0d0s1</tt>. The new boot environment copies root (<tt>/</tt>) to <tt>/dev/dsk/c0t4d0s0</tt>
and uses both <tt>/dev/dsk/c0t0d0s1</tt> and <tt>/dev/dsk/c0t4d0s1</tt> as swap slices. A description, <tt>mydescription</tt>,
is associated with the boot environment name second_disk.</p><pre># <tt><b>lucreate -A 'mydescription' -c first_disk \ -m /:/dev/dsk/c0t4d0s0:ufs -m -:/dev/dsk/c0t0d0s1:swap \ -m -:/dev/dsk/c0t4d0s1:swap -n second_disk</b></tt> </pre><p>These swap assignments are effective only after booting from <tt>second_disk</tt>. If you
have a long list of swap slices,  use the <tt>-M</tt> option. See
<a href="#lucreate-12">To Create a Boot Environment and Reconfigure Swap by Using a List</a>.</p>

<a name="lucreate-12"></a><h4>To Create a Boot Environment and Reconfigure Swap by Using a List</h4><p>If you have a long list of swap slices, create a swap
list. <tt>lucreate</tt> uses this list for the swap slices in the new
boot environment.</p>
<hr><p><b>Note - </b>The swap slice cannot be in use by any boot environment except the
current boot environment or if the <tt>-s</tt> option is used, the source boot
environment. The boot environment creation fails if the swap slice is being used
by any other boot environment, whether the swap slice contains a swap, UFS,
or any other file system. </p>
<hr>
<ol>
<li><a name="lucreate-step-25"></a><b>Create a list of swap slices to be used in the new boot
environment. The location and name of this file is user defined. In this
example, the content of the <tt>/etc/lu/swapslices</tt> file is a list of devices and
slices:</b><pre>-:/dev/dsk/c0t3d0s2:swap
-:/dev/dsk/c0t3d0s2:swap
-:/dev/dsk/c0t4d0s2:swap
-:/dev/dsk/c0t5d0s2:swap
-:/dev/dsk/c1t3d0s2:swap
-:/dev/dsk/c1t4d0s2:swap
-:/dev/dsk/c1t5d0s2:swap</pre></li>
<li><a name="luupgrade-step-78"></a><b>Type:</b><pre># <tt><b>lucreate [-A '</tt><i>BE_description</i><tt>'] \ -m </tt><i>mountpoint:device[,metadevice]:fs_options</i><tt></b></tt> \
<tt>-M</tt> <tt><b></tt><i>slice_list</i><tt> -n </tt><i>BE_name</i><tt></b></tt></pre><dl><dt><tt>-A</tt> '<i>BE_description</i>'</dt>
<dd><p>(Optional) Enables the creation of a boot environment description that is associated with the boot environment name (BE_name). The description can be any length and can contain any characters.</p></dd>
<dt><tt>-m</tt> <i>mountpoint:device[,metadevice]:fs_options</i> [<tt>-m</tt>...]</dt>
<dd><p>Specifies the file systems' configuration of the new boot environment. The file systems that are specified as arguments to <tt>-m</tt> can be on the same disk or they can be spread across multiple disks. Use this option as many times as needed to create the number of file systems that are needed. </p>
<ul><li><p><i>mountpoint</i> can be any valid mount point or <tt>&ndash;</tt> (hyphen), indicating a swap partition.</p></li>
<li><p><i>device</i> field can be one of the following:</p>
<ul><li><p>The name of a disk device, of the form <tt>/dev/dsk/c</tt><i>w</i><tt>t</tt><i>x</i><tt>d</tt><i>y</i><tt>s</tt><i>z</i><tt></tt></p></li>
<li><p>The name of a Solaris Volume Manager metadevice, of the form /dev/md/dsk/d<i>num</i></p></li>
<li><p>The name of a Veritas Volume Manager volume, of the form /dev/vx/dsk/<i>volume_name</i></p></li>
<li><p>The keyword <tt>merged</tt>, indicating that the file system at the specified mount point is to be merged with its parent</p></li></ul>
</li>
<li><p><i>fs_options</i> field can be one of the following: </p>
<ul><li><p><tt>ufs</tt>, which indicates a UFS file system.</p></li>
<li><p><tt>vxfs</tt>, which indicates a Veritas file system.</p></li>
<li><p><tt>swap</tt>, which indicates a swap file system. The swap mount point must be a <tt>&ndash;</tt> (hyphen).</p></li>
<li><p>For file systems that are logical devices (mirrors), several keywords specify actions to be applied to the file systems. These keywords can create a logical device, change the configuration of a logical device, or delete a logical device. For a description of these keywords, see <a href="#lucreate-1000">To Create a Boot Environment With RAID-1 Volumes (Mirrors)</a>.</p></li></ul>
</li></ul>
</dd>
<dt><tt>-M</tt> <i>slice_list</i></dt>
<dd><p>List of <tt>-m</tt> options, which are collected in the file <i>slice_list</i>. Specify these arguments in the format that is specified for <tt>-m</tt>. Comment lines, which begin with a hash mark (<tt>#</tt>), are ignored. The <tt>-M</tt> option is useful when you have a long list of file systems for a boot environment. Note that you can combine <tt>-m</tt> and <tt>-M</tt> options. For example, you can store swap slices in <i>slice_list</i> and specify root (<tt>/</tt>) and <tt>/usr</tt> slices with <tt>-m</tt>.</p><p>The <tt>-m</tt> and <tt>-M</tt> options support the listing of multiple slices for a particular mount point. In processing these slices, <tt>lucreate</tt> skips any unavailable slices and selects the first available slice. </p></dd>
<dt><tt>-n</tt> <i>BE_name</i></dt>
<dd><p>The name of the boot environment to be created. <i>BE_name</i> must be unique.</p></dd>
</dl>
<p>When creation of the new boot environment is complete, it can be
upgraded and can be activated (made bootable). See <a href="liveupgrade-1.html">Chapter&nbsp;5, Upgrading With Solaris Live Upgrade (Tasks)</a>.</p></li></ol><a name="lucreate-ex-5"></a>Example&nbsp;4-5 Create a Boot Environment and Reconfiguring Swap By Using a List<p>In this example, swap in the new boot environment is the list
of slices that are noted in the <tt>/etc/lu/swapslices</tt> file. A description, <tt>mydescription</tt>, is
associated with the name second_disk.</p><pre># <tt><b>lucreate -A 'mydescription' -c first_disk \ -m /:/dev/dsk/c02t4d0s0:ufs -m /usr:/dev/dsk/c02t4d0s1:ufs \ -M /etc/lu/swapslices -n second_disk</b></tt> </pre>

<a name="lucreate-11"></a><h4>To Create a Boot Environment and Copy a Shareable File System</h4><p>If you want a shareable file system to be copied to the
new boot environment, specify the mount point to be copied with the <tt>-m</tt>
option. Otherwise, shareable file systems are shared by default, and maintain the same
mount point in the <tt>vfstab</tt> file. Any updating that is applied to the shareable
file system is available to both boot environments.</p><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="lucreate-step-26"></a><b>Create the boot environment.</b><pre># <tt><b>lucreate [-A '</tt><i>BE_description</i><tt>'] \ -m </tt><i>mountpoint:device[,metadevice]:fs_options</i><tt> \ -m </tt><i>mountpoint:device[,metadevice]:fs_options</i><tt> -n </tt><i>BE_name</i><tt></b></tt></pre><dl><dt><tt>-A</tt> '<i>BE_description</i>'</dt>
<dd><p>(Optional) Enables the creation of a boot environment description that is associated with the boot environment name (BE_name). The description can be any length and can contain any characters.</p></dd>
<dt><tt>-m</tt> <i>mountpoint:device[,metadevice]:fs_options</i> [<tt>-m</tt>...]</dt>
<dd><p>Specifies the file systems' configuration of the new boot environment. The file systems that are specified as arguments to <tt>-m</tt> can be on the same disk or they can be spread across multiple disks. Use this option as many times as needed to create the number of file systems that are needed. </p>
<ul><li><p><i>mountpoint</i> can be any valid mount point or <tt>&ndash;</tt> (hyphen), indicating a swap partition.</p></li>
<li><p><i>device</i> field can be one of the following:</p>
<ul><li><p>The name of a disk device, of the form <tt>/dev/dsk/c</tt><i>w</i><tt>t</tt><i>x</i><tt>d</tt><i>y</i><tt>s</tt><i>z</i><tt></tt></p></li>
<li><p>The name of a Solaris Volume Manager metadevice, of the form /dev/md/dsk/d<i>num</i></p></li>
<li><p>The name of a Veritas Volume Manager volume, of the form /dev/vx/dsk/<i>volume_name</i></p></li>
<li><p>The keyword <tt>merged</tt>, indicating that the file system at the specified mount point is to be merged with its parent</p></li></ul>
</li>
<li><p><i>fs_options</i> field can be one of the following: </p>
<ul><li><p><tt>ufs</tt>, which indicates a UFS file system.</p></li>
<li><p><tt>vxfs</tt>, which indicates a Veritas file system.</p></li>
<li><p><tt>swap</tt>, which indicates a swap file system. The swap mount point must be a <tt>&ndash;</tt> (hyphen).</p></li>
<li><p>For file systems that are logical devices (mirrors), several keywords specify actions to be applied to the file systems. These keywords can create a logical device, change the configuration of a logical device, or delete a logical device. For a description of these keywords, see <a href="#lucreate-1000">To Create a Boot Environment With RAID-1 Volumes (Mirrors)</a>.</p></li></ul>
</li></ul>
</dd>
<dt><tt>-n</tt> <i>BE_name</i></dt>
<dd><p>The name of the boot environment to be created. <i>BE_name</i> must be unique.</p></dd>
</dl>
<p>When creation of the new boot environment is complete, it can be
upgraded and activated (made bootable). See <a href="liveupgrade-1.html">Chapter&nbsp;5, Upgrading With Solaris Live Upgrade (Tasks)</a>.</p></li></ol><a name="lucreate-ex-6"></a>Example&nbsp;4-6 Creating a Boot Environment and Copying a Shareable File System<p>In this example, the current boot environment contains two file systems, root (<tt>/</tt>)
and <tt>/home</tt>. In the new boot environment, the root (<tt>/</tt>) file system is
split into two file systems, root (<tt>/</tt>) and <tt>/usr</tt>. The <tt>/home</tt> file system is
copied to the new boot environment. A description, <tt>mydescription</tt>, is associated with the
boot environment name second_disk.</p><pre># <tt><b>lucreate -A 'mydescription' -c first_disk \ -m /:/dev/dsk/c0t4d0s0:ufs -m /usr:/dev/dsk/c0t4d0s3:ufs \ -m /home:/dev/dsk/c0t4d0s4:ufs -n second_disk</b></tt></pre>

<a name="lucreate-27"></a><h4>To Create a Boot Environment From a Different Source</h4><p>The <tt>lucreate</tt> command creates a boot environment that is based on the file
systems in the active boot environment. If you want to create a boot
environment based on a boot environment other than the active boot environment, use
<tt>lucreate</tt> with the <tt>-s</tt> option.</p>
<hr><p><b>Note - </b>If you activate the new boot environment and need to fall back, you
boot back to the boot environment that was last active, not the
source boot environment.</p>
<hr>
<ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="lucreate-step-31"></a><b>Create the boot environment.</b><pre># <tt><b>lucreate [-A '</tt><i>BE_description</i><tt>'] -s </tt><i>source_BE_name</i><tt> -m </tt><i>mountpoint:device[,metadevice]:fs_options</i><tt> -n </tt><i>BE_name</i><tt></b></tt></pre><dl><dt><tt>-A</tt> '<i>BE_description</i>'</dt>
<dd><p>(Optional) Enables the creation of a boot environment description that is associated with the boot environment name (BE_name). The description can be any length and can contain any characters.</p></dd>
<dt><tt>-s</tt> <i>source_BE_name</i></dt>
<dd><p>Specifies the source boot environment for the new boot environment. The source would not be the active boot environment.</p></dd>
<dt><tt>-m</tt> <i>mountpoint:device[,metadevice]:fs_options</i> [<tt>-m</tt>...]</dt>
<dd><p>Specifies the file systems' configuration of the new boot environment. The file systems that are specified as arguments to <tt>-m</tt> can be on the same disk or they can be spread across multiple disks. Use this option as many times as needed to create the number of file systems that are needed. </p>
<ul><li><p><i>mountpoint</i> can be any valid mount point or <tt>&ndash;</tt> (hyphen), indicating a swap partition.</p></li>
<li><p><i>device</i> field can be one of the following:</p>
<ul><li><p>The name of a disk device, of the form <tt>/dev/dsk/c</tt><i>w</i><tt>t</tt><i>x</i><tt>d</tt><i>y</i><tt>s</tt><i>z</i><tt></tt></p></li>
<li><p>The name of a Solaris Volume Manager metadevice, of the form /dev/md/dsk/d<i>num</i></p></li>
<li><p>The name of a Veritas Volume Manager volume, of the form /dev/vx/dsk/<i>volume_name</i></p></li>
<li><p>The keyword <tt>merged</tt>, indicating that the file system at the specified mount point is to be merged with its parent</p></li></ul>
</li>
<li><p><i>fs_options</i> field can be one of the following: </p>
<ul><li><p><tt>ufs</tt>, which indicates a UFS file system.</p></li>
<li><p><tt>vxfs</tt>, which indicates a Veritas file system.</p></li>
<li><p><tt>swap</tt>, which indicates a swap file system. The swap mount point must be a <tt>&ndash;</tt> (hyphen).</p></li>
<li><p>For file systems that are logical devices (mirrors), several keywords specify actions to be applied to the file systems. These keywords can create a logical device, change the configuration of a logical device, or delete a logical device. For a description of these keywords, see <a href="#lucreate-1000">To Create a Boot Environment With RAID-1 Volumes (Mirrors)</a>.</p></li></ul>
</li></ul>
</dd>
<dt><tt>-n</tt> <i>BE_name</i></dt>
<dd><p>The name of the boot environment to be created. <i>BE_name</i> must be unique on the system.</p></dd>
</dl>
<p>When creation of the new boot environment is complete, it can be
upgraded and activated (made bootable). See <a href="liveupgrade-1.html">Chapter&nbsp;5, Upgrading With Solaris Live Upgrade (Tasks)</a>.</p></li></ol><a name="lucreate-ex-33"></a>Example&nbsp;4-7 Creating a Boot Environment From a Different Source<p>In this example, a boot environment is created that is based on
the root (<tt>/</tt>) file system in the source boot environment named <tt>third_disk.</tt> <tt>Third_disk</tt>
is not the active boot environment. A description, <tt>mydescription</tt>, is associated with the new
boot environment named <tt>second_disk.</tt></p><pre># <tt><b>lucreate -A 'mydescription' -s third_disk \ -m /:/dev/dsk/c0t4d0s0:ufs -n second_disk</b></tt></pre>

<a name="lucreate-28"></a><h4>To Create an Empty Boot Environment for a Solaris Flash Archive</h4><p><a name="indexterm-48"></a>The <tt>lucreate</tt> command creates a boot environment that is based on the file
systems in the active boot environment. When using the <tt>lucreate</tt> command with the <tt>-s</tt>
- option, <tt>lucreate</tt> quickly creates an empty boot environment. The slices are reserved
for the file systems that are specified, but no file systems are copied.
The boot environment is named, but not actually created until installed with a
Solaris Flash archive. When the empty boot environment is installed with an archive,
file systems are installed on the reserved slices. </p><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="lucreate-step-32"></a><b>Create the empty boot environment.</b><pre># <tt><b>lucreate -A '</tt><i>BE_name</i><tt>' -s - \ -m </tt><i>mountpoint:device[,metadevice]:fs_options</i><tt> -n </tt><i>BE_name</i><tt></b></tt></pre><dl><dt><tt>-A</tt> '<i>BE_description</i>'</dt>
<dd><p>(Optional) Enables the creation of a boot environment description that is associated with the boot environment name (BE_name). The description can be any length and can contain any characters.</p></dd>
<dt><tt>-s</tt> -</dt>
<dd><p>Specifies that an empty boot environment be created.</p></dd>
<dt><tt>-m</tt> <i>mountpoint:device[,metadevice]:fs_options</i> [<tt>-m</tt>...]</dt>
<dd><p>Specifies the file systems' configuration of the new boot environment. The file systems that are specified as arguments to <tt>-m</tt> can be on the same disk or they can be spread across multiple disks. Use this option as many times as needed to create the number of file systems that are needed. </p>
<ul><li><p><i>mountpoint</i> can be any valid mount point or <tt>&ndash;</tt> (hyphen), indicating a swap partition.</p></li>
<li><p><i>device</i> field can be one of the following:</p>
<ul><li><p>The name of a disk device, of the form <tt>/dev/dsk/c</tt><i>w</i><tt>t</tt><i>x</i><tt>d</tt><i>y</i><tt>s</tt><i>z</i><tt></tt></p></li>
<li><p>The name of a Solaris Volume Manager metadevice, of the form /dev/md/dsk/d<i>num</i></p></li>
<li><p>The name of a Veritas Volume Manager volume, of the form /dev/vx/dsk/<i>volume_name</i></p></li>
<li><p>The keyword <tt>merged</tt>, indicating that the file system at the specified mount point is to be merged with its parent</p></li></ul>
</li>
<li><p><i>fs_options</i> field can be one of the following: </p>
<ul><li><p><tt>ufs</tt>, which indicates a UFS file system.</p></li>
<li><p><tt>vxfs</tt>, which indicates a Veritas file system.</p></li>
<li><p><tt>swap</tt>, which indicates a swap file system. The swap mount point must be a <tt>&ndash;</tt> (hyphen).</p></li>
<li><p>For file systems that are logical devices (mirrors), several keywords specify actions to be applied to the file systems. These keywords can create a logical device, change the configuration of a logical device, or delete a logical device. For a description of these keywords, see <a href="#lucreate-1000">To Create a Boot Environment With RAID-1 Volumes (Mirrors)</a>.</p></li></ul>
</li></ul>
</dd>
<dt><tt>-n</tt> <i>BE_name</i></dt>
<dd><p>The name of the boot environment to be created. <i>BE_name</i> must be unique on the system.</p></dd>
</dl>
</li></ol><a name="lucreate-ex-34"></a>Example&nbsp;4-8 Creating an Empty Boot Environment for a Solaris Flash Archive<p>In this example, a boot environment is created but contains no file systems.
A description, <tt>mydescription</tt>, is associated with the new boot environment that is named
second_disk.</p><pre># <tt><b>lucreate -A 'mydescription' -s - \ -m /:/dev/dsk/c0t1d0s0:ufs -n second_disk</b></tt></pre><p>When creation of the empty boot environment is complete, a flash archive can
be installed and can be activated (made bootable). See <a href="liveupgrade-1.html">Chapter&nbsp;5, Upgrading With Solaris Live Upgrade (Tasks)</a>.</p><p>For an example of creating and populating an empty boot environment, see <a href="luexample-28.html">Example of Creating an Empty Boot Environment and Installing a Solaris Flash Archive</a>.</p><p>The following image shows the creation of an empty boot environment. </p><img src="figures/lu-empty-boot-env.gif" alt="The context describes the illustration."></img>

<a name="lucreate-1000"></a><h4>To Create a Boot Environment With RAID-1 Volumes (Mirrors)</h4><p>When you create a boot environment, Solaris Live Upgrade uses Solaris Volume Manager
technology to create RAID-1 volumes. When creating a boot environment, you can use
Solaris Live Upgrade to manage the following tasks.</p>
<ul><li><p>Remove a single-slice concatenation (submirror) from a RAID-1 volume (mirror). The contents can be saved to become the content of the new boot environment if necessary. Because the contents are not copied, the new boot environment can be quickly created. After the submirror is detached from a mirror, it is no longer part of the original mirror. Reads and writes to the submirror are no longer performed through the mirror.</p></li>
<li><p>Create a boot environment that contains a mirror.</p></li>
<li><p>Attach a single-slice concatenation to the newly created mirror.</p></li></ul>
<h6>Before You Begin</h6><p>To use the mirroring capabilities of Solaris Live Upgrade, you must create a
state database and a state database replica. A state database stores information about
disk about the state of your Solaris Volume Manager configuration.</p>
<ul><li><p>For information about creating a state database, see <a href="http://docs.sun.com/doc/819-2789/about-state-db-replicas-1?a=view">Chapter 6, State Database (Overview), in <i>Solaris Volume Manager Administration Guide</i></a>.</p></li>
<li><p>For an overview of Solaris Volume Manager and the tasks that Solaris Live Upgrade can provide, see <a href="luoverview-100.html#luoverview-7">Creating a Boot Environment With RAID-1 Volume File Systems</a>. </p></li>
<li><p>For in-depth information about complex Solaris Volume Manager configurations that are not allowed when using Solaris Live Upgrade, see <a href="http://docs.sun.com/doc/819-2789/storage-overview-1?a=view">Chapter 2, Storage Management Concepts, in <i>Solaris Volume Manager Administration Guide</i></a>.</p></li></ul>
<ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="lucreate-step-22"></a><b>To create the new boot environment, type:</b><pre># <tt><b>lucreate [-A '</tt><i>BE_description</i><tt>'] \ -m </tt><i>mountpoint:device[,metadevice]:fs_options</i><tt> [-m...] \ -n </tt><i>BE_name</i><tt></b></tt></pre><dl><dt><tt>-A</tt> '<i>BE_description</i>'</dt>
<dd><p>(Optional) Enables the creation of a boot environment description that is associated with the boot environment name <i>BE_name</i>. The description can be any length and can contain any characters.</p></dd>
<dt><tt>-m</tt> <i>mountpoint:device[,metadevice]:fs_options</i> [<tt>-m</tt>...]</dt>
<dd><p>Specifies the file systems' configuration of the new boot environment in the <tt>vfstab</tt>. The file systems that are specified as arguments to <tt>-m</tt> can be on the same disk or they can be spread across multiple disks. Use this option as many times as needed to create the number of file systems that are needed. </p>
<ul><li><p><i>mountpoint</i> can be any valid mount point or <tt>&ndash;</tt> (hyphen), indicating a swap partition.</p></li>
<li><p><i>device</i> field can be one of the following:</p>
<ul><li><p>The name of a disk device, of the form <tt>/dev/dsk/c</tt><i>w</i><tt>t</tt><i>x</i><tt>d</tt><i>y</i><tt>s</tt><i>z</i><tt></tt></p></li>
<li><p>The name of a Solaris Volume Manager volume, of the form /dev/md/dsk/d<i>num</i></p></li>
<li><p>The name of a Veritas Volume Manager volume, of the form /dev/md/vxfs/dsk/d<i>num</i></p></li>
<li><p>The keyword <tt>merged</tt>, indicating that the file system at the specified mount point is to be merged with its parent</p></li></ul>
</li>
<li><p><i>fs_options</i> field can be one of the following types of file systems and keywords: </p>
<ul><li><p><tt>ufs</tt>, which indicates a UFS file system.</p></li>
<li><p><tt>vxfs</tt>, which indicates a Veritas file system.</p></li>
<li><p><tt>swap</tt>, which indicates a swap file system. The swap mount point must be a <tt>&ndash;</tt> (hyphen).</p></li>
<li><p>For file systems that are logical devices (mirrors), several keywords specify actions to be applied to the file systems. These keywords can create a logical device, change the configuration of a logical device, or delete a logical device. </p>
<ul><li><p><a name="indexterm-49"></a><tt>mirror</tt> creates a RAID&ndash;1 volume or mirror on the specified device. In subsequent <tt>-m</tt> options, you must specify <tt>attach</tt> to attach at least one concatenation to the new mirror. The specified device must be correctly named. For example, a logical device name of <tt>/dev/md/dsk/d10</tt> can serve as a mirror name. For more information about naming devices, see <a href="http://docs.sun.com/doc/819-2789/basics-42385?a=view">Overview of Solaris Volume Manager Components in <i>Solaris Volume Manager Administration Guide</i></a>.</p></li>
<li><p><tt>detach</tt> removes a concatenation from a volume that is associated with a specified mount point. The volume does not need to be specified.</p></li>
<li><p><tt>attach</tt> attaches a concatenation to the mirror that is associated with a specified mount point. The physical disk slice that is specified is made into a single device concatenation for attaching to the mirror. To specify a concatenation to attach to a disk, you append a comma and the name of that concatenation to the device name. If you omit the comma and the concatenation name, <tt>lucreate</tt> selects a free volume for the concatenation.</p><p><tt>lucreate</tt> allows you to create only concatenations that contain a single physical slice. This command allows you to attach up to three concatenations to a mirror.</p></li>
<li><p><tt>preserve</tt> saves the existing file system and its content. This keyword enables you to bypass the copying process that copies the content of the source boot environment. Saving the content enables a quick creation of the new boot environment. For a particular mount point, you can use <tt>preserve</tt> with only one physical device. When you use <tt>preserve</tt>, <tt>lucreate</tt> checks that the device's content is suitable for a specified file system. This check is limited and cannot guarantee suitability.</p><p>The <tt>preserve</tt> keyword can be used with both a physical slice and a Solaris Volume Manager volume.</p>
<ul><li><p>If you use the <tt>preserve</tt> keyword when the UFS file system is on a physical slice, the content of the UFS file system is saved on the slice. In the following example of the <tt>-m</tt> option, the <tt>preserve</tt> keyword saves the content of the physical device <tt>c0t0d0s0</tt> as the file system for the mount point for the root (/) file system.</p><pre><tt><b>-m /:/dev/dsk/c0t0d0s0:preserve,ufs</b></tt></pre></li>
<li><p>If you use the <tt>preserve</tt> keyword when the UFS file system is on a volume, the contents of the UFS file system are saved on the volume.</p><p>In the following example of the <tt>-m</tt> option, the <tt>preserve</tt> keyword saves the contents of the RAID-1 volume (mirror) <tt>d10</tt> as the file system for the mount point for the root (<tt>/</tt>) file system. </p><pre><tt><b>-m /:/dev/md/dsk/d10:preserve,ufs</b></tt></pre><p>In the following example of the <tt>-m</tt> option, a RAID-1 volume (mirror) <tt>d10</tt> is configured as the file system for the mount point for the root (<tt>/</tt>) file system. The single-slice concatenation <tt>d20</tt> is detached from its current mirror. <tt>d20</tt> is attached to mirror <tt>d10</tt>. The root (/) file system is preserved on submirror <tt>d20</tt>.</p><pre><tt><b>-m /:/dev/md/dsk/d10:mirror,ufs -m /:/dev/md/dsk/d20:detach,attach,preserve</b></tt></pre></li></ul>
</li></ul>
</li></ul>
</li></ul>
</dd>
<dt><tt>-n</tt> <i>BE_name</i></dt>
<dd><p>The name of the boot environment to be created. <i>BE_name</i> must be unique on the system.</p></dd>
</dl>
<p>When the creation of the new boot environment is complete, it can
be upgraded and can be activated (made bootable). See <a href="liveupgrade-1.html">Chapter&nbsp;5, Upgrading With Solaris Live Upgrade (Tasks)</a>. </p></li></ol><a name="lucreate-ex-100"></a>Example&nbsp;4-9 Creating a Boot Environment With a Mirror and Specifying Devices<p><a name="indexterm-50"></a><a name="indexterm-51"></a>In this example, the mount points for the file systems are specified by
using the <tt>-m</tt> option. </p>
<ul><li><p>A description, <tt>mydescription</tt>, is associated with the name <tt>another_disk</tt>.</p></li>
<li><p><tt>lucreate</tt> configures a UFS file system for the mount point root (<tt>/</tt>). A mirror, <tt>d10</tt>, is created. This mirror is the receptacle for the current boot environment's root (<tt>/</tt>) file system that is copied to the mirror <tt>d10</tt>. All data on the mirror <tt>d10</tt> is overwritten.</p></li>
<li><p>Two slices, <tt>c0t0d0s0</tt> and <tt>c0t1d0s0</tt>, are submirrors, <tt>d1</tt> and <tt>d2</tt>. These two submirrors are added to mirror <tt>d10</tt>. </p></li>
<li><p>The new boot environment is named <tt>another_disk</tt>. </p></li></ul>
<pre># <tt><b>lucreate -A 'mydescription' \ -m /:/dev/md/dsk/d10:ufs,mirror \ -m /:/dev/dsk/c0t0d0s0,/dev/md/dsk/d1:attach \ -m /:/dev/dsk/c0t1c0s0,/dev/md/dsk/d2:attach -n another_disk</b></tt></pre><a name="lucreate-ex-101"></a>Example&nbsp;4-10 Creating a Boot Environment With a Mirror and Not Specifying a Submirror Name<p><a name="indexterm-52"></a><a name="indexterm-53"></a>In this example, the mount points for the file systems are specified by
using the <tt>-m</tt> option.</p>
<ul><li><p>A description, <tt>mydescription</tt>, is associated with the name <tt>another_disk</tt>.</p></li>
<li><p><tt>lucreate</tt> configures a UFS file system for the mount point root (<tt>/</tt>). A mirror, <tt>d10</tt>, is created. This mirror is the receptacle for the current boot environment's root (<tt>/</tt>) file system that is copied to the mirror <tt>d10</tt>. All data on the mirror <tt>d10</tt> is overwritten.</p></li>
<li><p>Two slices, <tt>c0t0d0s0</tt> and <tt>c0t1d0s0</tt>, are specified to be used as submirrors. The submirrors are not specified, but the <tt>lucreate</tt> command chooses names from a list of available volume names. These two submirrors are attached to mirror <tt>d10</tt>. </p></li>
<li><p>The new boot environment is named <tt>another_disk</tt>. </p></li></ul>
<pre># <tt><b>lucreate -A 'mydescription' \ -m /:/dev/md/dsk/d10:ufs,mirror \ -m /:/dev/dsk/c0t0d0s0:attach \ -m /:/dev/dsk/c0t1d0s0:attach -n another_disk</b></tt></pre><p>When the creation of the new boot environment is complete, it can
be upgraded and can be activated (made bootable). See <a href="liveupgrade-1.html">Chapter&nbsp;5, Upgrading With Solaris Live Upgrade (Tasks)</a>.</p><a name="lucreate-ex-102"></a>Example&nbsp;4-11 Creating a Boot Environment and Detaching a Submirror<p><a name="indexterm-54"></a><a name="indexterm-55"></a>In this example, the mount points for the file systems are specified by
using the <tt>-m</tt> option.</p>
<ul><li><p>A description, <tt>mydescription</tt>, is associated with the name <tt>another_disk</tt>.</p></li>
<li><p><tt>lucreate</tt> configures a UFS file system for the mount point root (<tt>/</tt>). A mirror, <tt>d10</tt>, is created. </p></li>
<li><p>Slice <tt>c0t0d0s0</tt> is removed from its current mirror. The slice is specified to be submirror <tt>d1</tt> and is added to mirror d10. The contents of the submirror, the root (<tt>/</tt>) file system, are saved and no copy occurs. Slice <tt>c0t1d0s0</tt> is submirror <tt>d2</tt> and is added to mirror <tt>d10</tt>. </p></li>
<li><p>The new boot environment is named <tt>another_disk</tt>. </p></li></ul>
<pre># <tt><b>lucreate -A 'mydescription' \ -m /:/dev/md/dsk/d10:ufs,mirror \ -m /:/dev/dsk/c0t0d0s0,/dev/md/dsk/d1:detach,attach,preserve \ -m /:/dev/dsk/c0t1d0s0,/dev/md/dsk/d2:attach -n another_disk</b></tt></pre><p>When the creation of the new boot environment is complete, it can
be upgraded and can be activated (made bootable). See <a href="liveupgrade-1.html">Chapter&nbsp;5, Upgrading With Solaris Live Upgrade (Tasks)</a>.</p><a name="lucreate-ex-103"></a>Example&nbsp;4-12 Creating a Boot Environment, Detaching a Submirror, and Saving Its Contents<p><a name="indexterm-56"></a><a name="indexterm-57"></a>In this example, the mount points for the file systems are specified by
using the <tt>-m</tt> option.</p>
<ul><li><p>A description, <tt>mydescription</tt>, is associated with the name <tt>another_disk</tt>.</p></li>
<li><p><tt>lucreate</tt> configures a UFS file system for the mount point root (<tt>/</tt>). A mirror, <tt>d20</tt>, is created. </p></li>
<li><p>Slice <tt>c0t0d0s0</tt> is removed from its current mirror and added to the mirror <tt>d20</tt>. The name of the submirror is not specified. The contents of the submirror, the root (<tt>/</tt>) file system, are saved and no copy occurs. </p></li>
<li><p>The new boot environment is named <tt>another_disk</tt>. </p></li></ul>
<pre># <tt><b>lucreate -A 'mydescription' \ -m /:/dev/md/dsk/d20:ufs,mirror \ -m /:/dev/dsk/c0t0d0s0:detach,attach,preserve \ -n another_disk</b></tt></pre><p>When the creation of the new boot environment is complete, the boot environment
can be upgraded and can be activated (made bootable). See <a href="liveupgrade-1.html">Chapter&nbsp;5, Upgrading With Solaris Live Upgrade (Tasks)</a>.</p><a name="lucreate-ex-104"></a>Example&nbsp;4-13 Creating a Boot Environment With Two Mirrors<p><a name="indexterm-58"></a><a name="indexterm-59"></a>In this example, the mount points for the file systems are specified by
using the <tt>-m</tt> option.</p>
<ul><li><p>A description, <tt>mydescription</tt>, is associated with the name <tt>another_disk</tt>.</p></li>
<li><p><tt>lucreate</tt> configures a UFS file system for the mount point root (<tt>/</tt>). A mirror, <tt>d10</tt>, is created. This mirror is the receptacle for the current boot environment's root (<tt>/</tt>) file system that is copied to the mirror <tt>d10</tt>. All data on the mirror <tt>d10</tt> is overwritten.</p></li>
<li><p>Two slices, <tt>c0t0d0s0</tt> and <tt>c0t1d0s0</tt>, are submirrors <tt>d1</tt> and <tt>d2</tt>. These two submirrors are added to mirror <tt>d10</tt>. </p></li>
<li><p><tt>lucreate</tt> configures UFS file system for the mount point <tt>/opt</tt>. A mirror, <tt>d11</tt>, is created. This mirror is the receptacle for the current boot environment's <tt>/opt</tt> file system that is copied to the mirror <tt>d11</tt>. All data on the mirror <tt>d11</tt> is overwritten.</p></li>
<li><p>Two slices, <tt>c2t0d0s1</tt> and <tt>c3t1d0s1</tt>, are submirrors <tt>d3</tt> and <tt>d4</tt>. These two submirrors are added to mirror <tt>d11</tt>. </p></li>
<li><p>The new boot environment is named <tt>another_disk</tt>. </p></li></ul>
<pre># <tt><b>lucreate -A 'mydescription' \ -m /:/dev/md/dsk/d10:ufs,mirror \ -m /:/dev/dsk/c0t0d0s0,/dev/md/dsk/d1:attach \ -m /:/dev/dsk/c0t1d0s0,/dev/md/dsk/d2:attach \ -m /opt:/dev/md/dsk/d11:ufs,mirror \ -m /opt:/dev/dsk/c2t0d0s1,/dev/md/dsk/d3:attach \ -m /opt:/dev/dsk/c3t1d0s1,/dev/md/dsk/d4:attach -n another_disk</b></tt></pre><p>When the creation of the new boot environment is complete, it can
be upgraded and can be activated (made bootable). See <a href="liveupgrade-1.html">Chapter&nbsp;5, Upgrading With Solaris Live Upgrade (Tasks)</a>.</p>

<a name="lucreate-1601"></a><h4>To Create a Boot Environment and Customize the Content</h4><p>The content of the file system on the new boot environment can
be modified by using the following options. Directories and files are not copied
to the new boot environment.</p><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="lucreate-step-2201"></a><b>To create the new boot environment, type:</b><pre># <tt><b>lucreate -m </tt><i>mountpoint:device[,metadevice]:fs_options</i><tt> [-m ...] \ [-x </tt><i>exclude_dir</i><tt>] [-y </tt><i>include</i><tt>] \ [-Y </tt><i>include_list_file</i><tt>] \ [-f </tt><i>exclude_list_file</i><tt>]\ [-z </tt><i>filter_list</i><tt>] [-I] -n </tt><i>BE_name</i><tt></b></tt></pre><dl><dt><tt>-m</tt> <i>mountpoint:device[,metadevice]:fs_options</i> [<tt>-m</tt> ...]</dt>
<dd><p>Specifies the file systems' configuration of the new boot environment in the <tt>vfstab</tt>. The file systems that are specified as arguments to <tt>-m</tt> can be on the same disk or they can be spread across multiple disks. Use this option as many times as needed to create the number of file systems that are needed. </p>
<ul><li><p><i>mountpoint</i> can be any valid mount point or <tt>&ndash;</tt> (hyphen), indicating a swap partition.</p></li>
<li><p><i>device</i> field can be one of the following:</p>
<ul><li><p>The name of a disk device, of the form <tt>/dev/dsk/c</tt><i>w</i><tt>t</tt><i>x</i><tt>d</tt><i>y</i><tt>s</tt><i>z</i><tt></tt></p></li>
<li><p>The name of a Solaris Volume Manager volume, of the form /dev/md/dsk/d<i>num</i></p></li>
<li><p>The name of a Veritas Volume Manager volume, of the form /dev/md/vxfs/dsk/d<i>num</i></p></li>
<li><p>The keyword <tt>merged</tt>, indicating that the file system at the specified mount point is to be merged with its parent</p></li></ul>
</li>
<li><p><i>fs_options</i> field can be one of the following: </p>
<ul><li><p><tt>ufs</tt>, which indicates a UFS file system.</p></li>
<li><p><tt>vxfs</tt>, which indicates a Veritas file system.</p></li>
<li><p><tt>swap</tt>, which indicates a swap file system. The swap mount point must be a <tt>&ndash;</tt> (hyphen).</p></li>
<li><p>For file systems that are logical devices (mirrors), several keywords specify actions to be applied to the file systems. These keywords can create a logical device, change the configuration of a logical device, or delete a logical device. For a description of these keywords, see <a href="#lucreate-1000">To Create a Boot Environment With RAID-1 Volumes (Mirrors)</a>.</p></li></ul>
</li></ul>
</dd>
<dt><tt>-x</tt> <i>exclude_dir</i></dt>
<dd><p>Excludes files and directories by not copying them to the new boot environment. You can use multiple instances of this option to exclude more than one file or directory.</p><p><i>exclude_dir</i> is the name of the directory or file. </p></dd>
<dt><tt>-y</tt> <i>include_dir</i></dt>
<dd><p>Copies directories and files that are listed to the new boot environment. This option is used when you have excluded a directory, but want to restore individual subdirectories or files.</p><p><i>include_dir</i> is the name of the subdirectory or file to be included. </p></dd>
<dt><tt>-Y</tt> <i>list_filename</i></dt>
<dd><p>Copies directories and files from a list to the new boot environment. This option is used when you have excluded a directory, but want to restore individual subdirectories or files.</p>
<ul><li><p><i>list_filename</i> is the full path to a file that contains a list. </p></li>
<li><p>The <i>list_filename</i> file must contain one file per line. </p></li>
<li><p>If a line item is a directory, all subdirectories and files beneath that directory are included. If a line item is a file, only that file is included.</p></li></ul>
</dd>
<dt><tt>-f</tt> <i>list_filename</i></dt>
<dd><p>Uses a list to exclude directories and files by not copying them to the new boot environment. </p>
<ul><li><p><i>list_filename</i> is the full path to a file that contains a list. </p></li>
<li><p>The <i>list_filename</i> file must contain one file per line. </p></li></ul>
</dd>
<dt><tt>-z</tt> <i>list_filename</i></dt>
<dd><p>Uses a list to copy directories and files to the new boot environment. Each file or directory in the list is noted with a plus &ldquo;+&rdquo; or minus &ldquo;-&rdquo;. A plus indicates an included file or directory and the minus indicates an excluded file or directory.</p>
<ul><li><p><i>list_filename</i> is the full path to a file that contains a list. </p></li>
<li><p>The <i>list_filename</i> file must contain one file per line. A space must follow the plus or minus before the file name. </p></li>
<li><p>If a line item is a directory and is indicated with a + (plus), all subdirectories and files beneath that directory are included. If a line item is a file and is indicated with a + (plus), only that file is included.</p></li></ul>
</dd>
<dt><tt>-I</tt></dt>
<dd><p>Overrides the integrity check of system files. Use this option with caution.</p><p>To prevent you from removing important system files from a boot environment, <tt>lucreate</tt> runs an integrity check. This check examines all files that are registered in the system package database and stops the boot environment creation if any files are excluded. Use of this option overrides this integrity check. This option creates the boot environment more quickly, but might not detect problems.</p></dd>
<dt><tt>-n</tt> <i>BE_name</i></dt>
<dd><p>The name of the boot environment to be created. <i>BE_name</i> must be unique on the system.</p></dd>
</dl>
<p>When creation of the new boot environment is complete, it can be
upgraded and can be activated (made bootable). See <a href="liveupgrade-1.html">Chapter&nbsp;5, Upgrading With Solaris Live Upgrade (Tasks)</a>.</p></li></ol><a name="lucreate-ex-1010"></a>Example&nbsp;4-14 Creating a Boot Environment and Excluding Files<p><a name="indexterm-60"></a>In this example, the new boot environment is named <tt>second_disk</tt>. The source
boot environment contains one file system, root (<tt>/</tt>). In the new boot
environment, the <tt>/var</tt> file system is split from the root (<tt>/</tt>) file system
and put on another slice. The <tt>lucreate</tt> command configures a UFS file system for
the mount points root (<tt>/</tt>) and <tt>/var</tt>. Also, two <tt>/var</tt> mail files,
<tt>root</tt> and <tt>staff</tt> are not copied to the new boot environment. Swap
is automatically shared between the source and the new boot environment.</p><pre># <tt><b>lucreate -n second_disk \ -m /:/dev/dsk/c0t1d0s0:ufs -m /var/mail:/dev/dsk/c0t2d0s0:ufs \ -x /var/mail/root -x /var/mail/staff</b></tt></pre><a name="lucreate-ex-1011"></a>Example&nbsp;4-15 Creating a Boot Environment and Excluding and Including Files<p><a name="indexterm-61"></a>In this example, the new boot environment is named <tt>second_disk</tt>. The source
boot environment contains one file system for the OS, root (<tt>/</tt>). The source
also contains a file system that is named <tt>/mystuff</tt>. <tt>lucreate</tt> configures a UFS file
system for the mount points root (<tt>/</tt>) and <tt>/mystuff</tt>. Only two directories
in <tt>/mystuff</tt> are copied to the new boot environment: <tt>/latest</tt> and <tt>/backup</tt>. Swap
is automatically shared between the source and the new boot environment.</p><pre># <tt><b>lucreate -n second_disk \ -m /:/dev/dsk/c0t0d0s0:ufs -m /mystuff:/dev/dsk/c1t1d0s0:ufs \ -x /mystuff -y /mystuff/latest -y /mystuff/backup</b></tt></pre>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="lucreate-8.html">Previous</a>
             </td>
             <td align="right">
                 <a href="liveupgrade-1.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

