<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Upgrading a Boot Environment - Solaris Express Installation Guide:  Solaris Live Upgrade and Upgrade Planning</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-05-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">Solaris Express Installation Guide:  Solaris Live Upgrade and Upgrade Planning</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="luupgrade-333.html">Previous</a>
             </td>
             <td align="right">
                 <a href="luupgrade-83.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="esqbt.html">Part&nbsp;I&nbsp;Upgrading With Solaris Live Upgrade</a></p>
<p class="toc level2"><a href="intro-1.html">1.&nbsp;&nbsp;Where to Find Solaris Installation Planning Information</a></p>
<p class="toc level2"><a href="luoverview-1.html">2.&nbsp;&nbsp;Solaris Live Upgrade (Overview)</a></p>
<p class="toc level2"><a href="luplanning-1.html">3.&nbsp;&nbsp;Solaris Live Upgrade (Planning)</a></p>
<p class="toc level2"><a href="lucreate-1.html">4.&nbsp;&nbsp;Using Solaris Live Upgrade to Create a Boot Environment (Tasks)</a></p>
<p class="toc level2"><a href="liveupgrade-1.html">5.&nbsp;&nbsp;Upgrading With Solaris Live Upgrade (Tasks)</a></p>
<p class="toc level3"><a href="luupgrade-333.html">Task Map: Upgrading a Boot Environment</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Upgrading a Boot Environment</a></p>
<p class="toc level4"><a href="#luupgrade-86">To Upgrade a Network Installation Image on a Boot Environment</a></p>
<p class="toc level4"><a href="#luupgrade-87">To Upgrade a Network Installation Image From Multiple CDs</a></p>
<p class="toc level4"><a href="#frcbp">To Add Packages to a Network Installation Image on a Boot Environment</a></p>
<p class="toc level4"><a href="#frcbs">To Add Patches to a Network Installation Image on a Boot Environment</a></p>
<p class="toc level4"><a href="#frcfi">To Obtain Information on Packages Installed on a Boot Environment</a></p>
</div>
<p class="toc level3 tocsp"><a href="luupgrade-83.html">Installing Solaris Flash Archives on a Boot Environment</a></p>
<p class="toc level4"><a href="luupgrade-83.html#luupgrade-88">To Install a Solaris Flash Archive on a Boot Environment</a></p>
<p class="toc level4"><a href="luupgrade-83.html#luupgrade1-8800">To Install a Solaris Flash Archive With a Profile</a></p>
<p class="toc level4"><a href="luupgrade-83.html#luupgrade-880">To Install a Solaris Flash Archive With a Profile Keyword</a></p>
<p class="toc level3 tocsp"><a href="luupgrade-84.html">Activating a Boot Environment</a></p>
<p class="toc level4"><a href="luupgrade-84.html#luupgrade-89">To Activate a Boot Environment</a></p>
<p class="toc level4"><a href="luupgrade-84.html#luupgrade-890">To Activate a Boot Environment and Synchronize Files</a></p>
<p class="toc level4"><a href="luupgrade-84.html#gacps">x86: To Activate a Boot Environment With the GRUB Menu</a></p>
<p class="toc level2 tocsp"><a href="luupgrade-85.html">6.&nbsp;&nbsp;Failure Recovery: Falling Back to the Original Boot Environment (Tasks)</a></p>
<p class="toc level2"><a href="lumaintainence-1.html">7.&nbsp;&nbsp;Maintaining Solaris Live Upgrade Boot Environments (Tasks)</a></p>
<p class="toc level2"><a href="grub-101.html">8.&nbsp;&nbsp;x86: Locating the GRUB Menu's <tt>menu.lst</tt> File (Tasks)</a></p>
<p class="toc level2"><a href="gdzlc.html">9.&nbsp;&nbsp;Upgrading the Solaris OS on a System With Non-Global  Zones Installed</a></p>
<p class="toc level2"><a href="luexample-1.html">10.&nbsp;&nbsp;Solaris Live Upgrade (Examples)</a></p>
<p class="toc level2"><a href="lureference-1.html">11.&nbsp;&nbsp;Solaris Live Upgrade (Command Reference)</a></p>
<p class="toc level1 tocsp"><a href="esqcb.html">Part&nbsp;II&nbsp;Appendices</a></p>
<p class="toc level2"><a href="troubleshooting-9.html">A.&nbsp;&nbsp;Troubleshooting (Tasks)</a></p>
<p class="toc level2"><a href="package-9.html">B.&nbsp;&nbsp;Additional SVR4 Packaging Requirements (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="luupgrade-82"></a><h3>Upgrading a Boot Environment</h3>
<p><a name="indexterm-63"></a><a name="indexterm-64"></a>Use the <tt>luupgrade</tt> command to upgrade a boot environment. This section provides the
procedure for upgrading an inactive boot environment from files that are located on
the following media:</p>
<ul><li><p>NFS server</p></li>
<li><p>Local file</p></li>
<li><p>Local tape</p></li>
<li><p>Local device, including DVD or CD</p></li></ul>


<a name="luupgrade-5"></a><h4>Guidelines for Upgrading</h4>
<p><a name="indexterm-65"></a>When you upgrade a boot environment with the latest OS, you do not
affect the active boot environment. The new files merge with the inactive boot
environment critical file systems, but shareable file systems are not changed.</p><p>You can upgrade when RAID-1 volumes are installed, or if non-global zones are
installed, or you can install a Solaris Flash:</p>
<ul><li><p>You can upgrade an inactive boot environment that contains any combination of physical disk slices, Solaris Volume Manager volumes, or Veritas Volume Manager volumes. The slice that is chosen for the root (<tt>/</tt>) file system must be a single-slice concatenation that is included in a RAID&ndash;1 volume (mirror). For procedures about creating a boot environment with mirrored file systems, see <a href="chapter-33.html#lucreate-1000">To Create a Boot Environment With RAID-1 Volumes (Mirrors)</a>.</p>
<hr><p><b>Note - </b>If VxVM volumes are configured on your current system, the <tt>lucreate</tt> command can create a new boot environment. When the data is copied to the new boot environment, the Veritas file system configuration is lost and a UFS file system is created on the new boot environment.</p>
<hr>
</li>
<li><p>You can upgrade a system that has non-global zones installed with any installation program. For procedures about upgrading with non-global zones, see <a href="gdzlc.html">Chapter&nbsp;9, Upgrading the Solaris OS on a System With Non-Global  Zones Installed</a>.</p></li>
<li><p>Rather than upgrading, if you have created a Solaris Flash archive, you could install the archive on an inactive boot environment. The new files overwrite critical file systems of the inactive boot environment, but shareable file systems are not changed. See <a href="luupgrade-83.html">Installing Solaris Flash Archives on a Boot Environment</a>.</p></li></ul>


<a name="luupgrade-6"></a><h5>Upgrading a System With Packages or Patches</h5>
<p><a name="indexterm-66"></a><a name="indexterm-67"></a>You can use Solaris Live Upgrade to add patches and packages to a
system.  Solaris Live Upgrade creates a copy of the currently running
system. This new boot environment can be upgraded or you can add packages
or patches. When you use Solaris Live Upgrade, the only downtime the system
incurs is that of a reboot. You can add patches  and packages
to a new boot environment with the <tt>luupgrade</tt>  command.</p>
<hr><p><b>Caution - </b>When adding and removing packages or patches, Solaris Live Upgrade requires packages or
patches that comply with the SVR4 advanced packaging guidelines. While Sun packages conform
to these guidelines, Sun cannot guarantee the conformance of packages from third-party vendors.
If a package violates these guidelines, the package can cause the package-addition software
to fail or alter the active boot environment during an upgrade. </p><p>For more information about packaging requirements, see <a href="package-9.html">Appendix&nbsp;B, Additional SVR4 Packaging Requirements (Reference)</a>.</p>
<hr>
<a name="ganuh"></a><h6>Table&nbsp;5-2 Upgrading a Boot Environment With Packages and Patches</h6><table><col width="39.42*"><col width="55.29*"><col width="55.29*"><tr><th align="left" valign="top" scope="column"><p>Type of Installation</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>For More Information</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Adding patches
to a boot environment. </p></td>
<td align="left" valign="top" scope="row"><p>Create a new boot environment and use the
<tt>luupgrade</tt> command with the <tt>-t</tt> option.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#frcbs">To Add Patches to a Network Installation Image on a Boot Environment</a></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Adding packages to a boot environment.</p></td>
<td align="left" valign="top" scope="row"><p>Use the <tt>luupgrade</tt>
command  with the <tt>-p</tt> option.</p></td>
<td align="left" valign="top" scope="row"><p><a href="#frcbp">To Add Packages to a Network Installation Image on a Boot Environment</a></p></td>
</tr>
</table>

<a name="luupgrade-86"></a><h4>To Upgrade a Network Installation Image on a Boot Environment</h4><p>To upgrade by using this procedure, you must use a DVD or
a network installation image. If the installation requires more than one CD, you
must use the procedure <a href="#luupgrade-87">To Upgrade a Network Installation Image From Multiple CDs</a>. </p><ol>
<li><b>Install the Solaris Live Upgrade <tt>SUNWlucfg</tt>, <tt>SUNWlur</tt>, and <tt>SUNWluu</tt> packages on your
system. These packages must be from the release you are upgrading to. For
step-by-step procedures, see <a href="lucreate-8.html#lucreate-3">To Install Solaris Live Upgrade With the <tt>pkgadd</tt> Command</a>.</b></li>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="luupgrade-step-38"></a><b>Indicate the boot environment to upgrade and the path to the installation software
by typing:</b><pre># <tt><b>luupgrade -u -n </tt><i>BE_name</i><tt> -s </tt><i>os_image_path</i><tt></b></tt></pre><dl><dt><tt>-u</tt></dt>
<dd><p>Upgrades a network installation image on a boot environment</p></dd>
<dt><tt>-n</tt> <i>BE_name</i></dt>
<dd><p>Specifies the name of the boot environment that is to be upgraded</p></dd>
<dt><tt>-s</tt> <i>os_image_path</i></dt>
<dd><p>Specifies the path name of a directory that contains a network installation image</p></dd>
</dl>
</li></ol><a name="gcnvz"></a>Example&nbsp;5-1 Upgrading a Network Installation Image on a Boot Environment From DVD Media<p>In this example, the <tt>second_disk</tt> boot environment is upgraded by using DVD media.
The pkgadd command adds the Solaris Live Upgrade packages from the release you
are upgrading to.</p><pre># <tt><b>pkgadd -d /server/packages SUNWlucfg SUNWlur SUNWluu</b></tt>
# <tt><b>luupgrade -u -n second_disk -s /media/cdrom/s0</b></tt> </pre><a name="luupgrade-ex-92"></a>Example&nbsp;5-2 Upgrading a Network Installation Image on a Boot Environment From a Network Installation Image<p>In this example, the <tt>second_disk</tt> boot environment is upgraded. The pkgadd command adds
the Solaris Live Upgrade packages from the release you are upgrading to.</p><pre># <tt><b>pkgadd -d /server/packages SUNWlucfg SUNWlur SUNWluu</b></tt>
# <tt><b>luupgrade -u -n second_disk \ -s /net/installmachine/export/Solaris_11/OS_image</b></tt> </pre>

<a name="luupgrade-87"></a><h4>To Upgrade a Network Installation Image From Multiple CDs</h4><p>Because the network installation image resides on more than one CD, you must
use this upgrade procedure. Use the <tt>luupgrade</tt> command with the <tt>-i</tt> option to
install any additional CDs.</p><ol>
<li><b>Install the Solaris Live Upgrade <tt>SUNWlucfg</tt>, <tt>SUNWlur</tt>, and <tt>SUNWluu</tt> packages on your
system. These packages must be from the release you are upgrading to. For
step-by-step procedures, see <a href="lucreate-8.html#lucreate-3">To Install Solaris Live Upgrade With the <tt>pkgadd</tt> Command</a>.</b></li>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="luupgrade-step-106"></a><b>Indicate the boot environment to upgrade and the path to the installation software
by typing:</b><pre># <tt><b>luupgrade -u -n </tt><i>BE_name</i><tt> -s </tt><i>os_image_path</i><tt></b></tt></pre><dl><dt><tt>-u</tt></dt>
<dd><p>Upgrades a network installation image on a boot environment</p></dd>
<dt><tt>-n</tt> <i>BE_name</i></dt>
<dd><p>Specifies the name of the boot environment that is to be upgraded</p></dd>
<dt><tt>-s</tt> <i>os_image_path</i></dt>
<dd><p>Specifies the path name of a directory that contains a network installation image</p></dd>
</dl>
</li>
<li><a name="luupgrade-step-41"></a><b>When the installer is finished with the contents of the first CD, insert
the second CD.</b></li>
<li><a name="luupgrade-step-40"></a><b>This step is identical to the previous step, but the <tt>-u</tt> option is
replaced by the <tt>-i</tt> option. Also, choose to run the installer on the
second CD with menus or with text.</b>
<ul><li><p>This command runs the installer on the second CD with menus.</p><pre># <tt><b>luupgrade -i -n </tt><i>BE_name</i><tt> -s </tt><i>os_image_path</i><tt></b></tt></pre></li>
<li><p>This command runs the installer on the second CD with text and requires no user interaction.</p><pre># <tt><b>luupgrade -i -n </tt><i>BE_name</i><tt> -s </tt><i>os_image_path</i><tt></b></tt> <tt>-O</tt> <tt><b>'</b></tt><tt>-nodisplay</tt> <tt>-noconsole</tt><tt><b>'</b></tt></pre></li></ul>
<dl><dt><tt>-i</tt></dt>
<dd><p>Installs additional CDs. The software looks for an installation program on the specified medium and runs that program. The installer program is specified with <tt>-s</tt>. </p></dd>
<dt><tt>-n</tt> <i>BE_name</i></dt>
<dd><p>Specifies the name of the boot environment that is to be upgraded.</p></dd>
<dt><tt>-s</tt> <i>os_image_path</i></dt>
<dd><p>Specifies the path name of a directory that contains an network installation image.</p></dd>
<dt><tt>-O</tt> '<tt>-nodisplay</tt> <tt>-noconsole</tt>'</dt>
<dd><p>(Optional) Runs the installer on the second CD in text mode and requires no user interaction.</p></dd>
</dl>
</li>
<li><b>Repeat <a href="#luupgrade-step-41">Step&nbsp;4</a> and <a href="#luupgrade-step-40">Step&nbsp;5</a> for each CD that you want to install.</b><p>The boot environment is ready to be activated. See <a href="luupgrade-84.html">Activating a Boot Environment</a>.</p></li></ol><a name="luupgrade-ex-93"></a>Example&nbsp;5-3 SPARC: Upgrading a Network Installation Image From Multiple CDs<p>In this example, the <tt>second_disk</tt> boot environment is upgraded and the installation image
is on two CDs: the Solaris Software - 1 and the Solaris Software
- 2 CDs. The <tt>-u</tt> option determines if sufficient space for all the
packages is on the CD set. The <tt>-O</tt> option with the <tt>-nodisplay</tt> and
<tt>-noconsole</tt> options prevents the character user interface from displaying after the reading of the
second CD. If you use these options, you are not prompted to
type information.</p><p><b>Note</b>: If you do not use the <tt>-O</tt> option with the <tt>-nodisplay</tt> and
<tt>-noconsole</tt> options, the character user interface (CUI) is displayed. Sun no longer recommends using
the (CUI) to do Solaris Live Upgrade tasks.</p><p>Install the Solaris Live Upgrade packages from the release you are upgrading to.</p><pre># <tt><b>pkgadd -d /server/packages SUNWlucfg SUNWlur SUNWluu</b></tt></pre><p>Insert the Solaris Software - 1 CD and type:</p>
<ul><li><p>For SPARC based systems:</p><pre># <tt><b>luupgrade -u -n second_disk -s /media/cdrom/s0</b></tt> </pre></li>
<li><p>For x86 based systems:</p><pre># <tt><b>luupgrade -u -n second_disk -s /media/cdrom/</b></tt> </pre></li></ul>
<p>Insert the Solaris Software - 2 CD and type the following.</p><pre># <tt><b>luupgrade -i -n second_disk -s /media/cdrom -O '-nodisplay \ -noconsole'</b></tt>
Repeat this step for each CD that you need.</pre><p>Repeat the previous step for each CD that you want to install.</p>

<a name="frcbp"></a><h4>To Add Packages to a Network Installation Image on a Boot Environment</h4><p>In the following procedure, packages are removed from and added to a new
boot environment.</p>
<hr><p><b>Caution - </b>When you are upgrading. adding and removing packages or patches, Solaris Live Upgrade
requires packages or patches that comply with the SVR4 advanced packaging guidelines. While
Sun packages conform to these guidelines, Sun cannot guarantee the conformance of packages
from third-party vendors. If a package violates these guidelines, the package can cause
the package-addition software to fail or can alter the active boot environment.</p><p>For more information about packaging requirements, see <a href="package-9.html">Appendix&nbsp;B, Additional SVR4 Packaging Requirements (Reference)</a>.</p>
<hr>
<ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><b>To remove a package or set of packages from a new boot
environment, type:</b><pre>#  <tt><b>luupgrade -P -n second_disk </tt><i>package-name</i><tt></b></tt></pre><dl><dt><tt>-P</tt></dt>
<dd><p>Indicates to remove the named package or packages from the boot environment</p></dd>
<dt><tt>-n</tt> <i>BE_name</i></dt>
<dd><p>Specifies the name of the boot environment where the package is to be removed</p></dd>
<dt><i>package-name</i></dt>
<dd><p>Specifies the names of the packages to be removed. Separate multiple package names with spaces.</p></dd>
</dl>
</li>
<li><b>To add a package or a set of packages to the new
boot environment, type:</b><pre># <tt><b>luupgrade -p -n second_disk -s </tt><i>/path-to-packages</i><tt> </tt><i>package-name</i><tt></b></tt></pre><dl><dt><tt>-p</tt></dt>
<dd><p>Indicates to add packages to the boot environment.</p></dd>
<dt><tt>-n</tt> <i>BE_name</i></dt>
<dd><p>Specifies the name of the boot environment where the package is to be added.</p></dd>
<dt><tt>-s</tt> <i>path-to-packages</i></dt>
<dd><p>Specifies the path to a directory that contains the package or packages that are to be added.</p></dd>
<dt><i>package-name</i></dt>
<dd><p>Specifies the names of the package or packages to be added. Separate multiple package names with a space.</p></dd>
</dl>
</li></ol><a name="frcbr"></a>Example&nbsp;5-4 Adding packages to a Network Installation Image on a Boot Environment<p>In this example, packages are removed then added to the <tt>second_disk</tt> boot
environment.</p><pre># <tt><b>luupgrade -P -n second_disk SUNWabc SUNWdef SUNWghi</b></tt>
# <tt><b>luupgrade -p -n second_disk -s /net/installmachine/export/packages</b></tt> \
<tt><b>SUNWijk SUNWlmn SUNWpkr</b></tt></pre>

<a name="frcbs"></a><h4>To Add Patches to a Network Installation Image on a Boot Environment</h4><p>In the following procedure, patches are removed from and added to a new
boot environment.</p>
<hr><p><b>Caution - </b>When you are adding and removing packages or patches, Solaris Live Upgrade requires
packages or patches that comply with the SVR4 advanced packaging guidelines. While Sun
packages conform to these guidelines, Sun cannot guarantee the conformance of packages from
third-party vendors. If a package violates these guidelines, the package can cause the
package-addition software to fail or can alter the active boot environment.</p>
<hr>
<ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><b>To remove a patch or set of patches from a new boot
environment, type:</b><pre># <tt><b>luupgrade -T -n second_disk </tt><i>patch_name</i><tt></b></tt></pre><dl><dt><tt>-T</tt></dt>
<dd><p>Indicates to remove the named patch or patches from the boot environment.</p></dd>
<dt><tt>-n</tt> <i>BE_name</i></dt>
<dd><p>Specifies the name of the boot environment where the patch or patches are to be removed.</p></dd>
<dt><i>patch-name</i></dt>
<dd><p>Specifies the names of the patches to be removed. Separate multiple patch names with spaces.</p></dd>
</dl>
</li>
<li><b>To add a patch or a set of patches to the new
boot environment, type the following command.</b><pre># <tt><b>luupgrade -t -n second_disk -s </tt><i>/path-to-patches</i><tt> </tt><i>patch-name</i><tt></b></tt></pre><dl><dt><tt>-t</tt></dt>
<dd><p>Indicates to add patches to the boot environment.</p></dd>
<dt><tt>-n</tt> <i>BE_name</i></dt>
<dd><p>Specifies the name of the boot environment where the patch is to be added.</p></dd>
<dt><tt>-s</tt> <i>path-to-patches</i></dt>
<dd><p>Specifies the path to the directory that contains the patches that are to be added.</p></dd>
<dt><i>patch-name</i></dt>
<dd><p>Specifies the names of the patch or patches that are to be added. Separate multiple patch names with a space.</p></dd>
</dl>
</li></ol><a name="frcbv"></a>Example&nbsp;5-5 Adding Patches to a Network Installation Image on a Boot Environment<p>In this example, patches are removed then added to the <tt>second_disk</tt> boot
environment .</p><pre># <tt><b>luupgrade -T -n second_disk 222222-01</b></tt>
# <tt><b>luupgrade -t -n second_disk -s /net/installmachine/export/packages</b></tt> \
<tt><b>333333-01 4444444-01</b></tt></pre>

<a name="frcfi"></a><h4>To Obtain Information on Packages Installed on a Boot Environment</h4><p>The follow procedure checks the integrity of the packages installed on the new
boot environment.</p><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><b>To check the integrity of the newly installed packages on the new boot
environment, type:</b><pre>#  <tt><b>luupgrade -C -n second_disk -O "-v" </tt><i>package-name</i><tt></b></tt></pre><dl><dt><tt>-C</tt></dt>
<dd><p>Indicates to run the <tt>pkgchk</tt> command on the named packages</p></dd>
<dt><tt>-n</tt> <i>BE_name</i></dt>
<dd><p>Specifies the name of the boot environment where the check is to be performed</p></dd>
<dt><tt>-O</tt></dt>
<dd><p>Passes the options directly to the <tt>pkgchk</tt> command</p></dd>
<dt><i>package-name</i></dt>
<dd><p>Specifies the names of the packages to be checked. Separate multiple package names with spaces. If package names are omitted, the check is done on all packages in the specified boot environment.</p></dd>
<dt>&ldquo;<tt>-v</tt>&rdquo;</dt>
<dd><p>Specifies to run the command in verbose mode</p></dd>
</dl>
</li></ol><a name="frcfj"></a>Example&nbsp;5-6 Checking the Integrity of Packages on a Boot Environment<p>In this example, the packages <tt>SUNWabc,</tt> <tt>SUNWdef,</tt> and <tt>SUNWghi</tt> are checked to
make sure they were installed properly and are not damaged.</p><pre># <tt><b>luupgrade -C -n second_disk SUNWabc SUNWdef SUNWghi</b></tt></pre>

<a name="fyggn"></a><h4>Upgrading by Using a JumpStart Profile</h4>
<p>You can create a JumpStart profile to use with Solaris Live Upgrade. If
you are familiar with the custom JumpStart program, this is the same
profile that custom JumpStart uses. The following procedures enable you to create a profile,
test the profile, and install by using the <tt>luupgrade</tt> command with the <tt>-j</tt>
option.</p>
<hr><p><b>Caution - </b>When you install the Solaris OS with a Solaris Flash archive, the archive
and the installation media must contain identical OS versions. For example, if the
archive is the Solaris 10 operating system and you are using DVD media,
then you must use Solaris 10 DVD media to install the archive. If
the OS versions do not match, the installation on the target system
fails. Identical operating systems are necessary when you use the following keyword or command:</p>
<ul><li><p><tt>archive_location</tt> keyword in a profile</p></li>
<li><p><tt>luupgrade</tt> command with <tt>-s</tt>, <tt>-a</tt>, <tt>-j</tt>, and <tt>-J</tt> options</p></li></ul>

<hr>
<p>For more information see the following:</p>
<ul><li><p><a href="#preparecustom-9700">To Create a Profile to be Used by Solaris Live Upgrade</a></p></li>
<li><p><a href="#luupgrade-1162">To Test a Profile to Be Used by Solaris Live Upgrade</a></p></li>
<li><p><a href="#luupgrade-8800">To Upgrade With a Profile by Using Solaris Live Upgrade</a></p></li>
<li><p>For creating a JumpStart profile, see <a href="http://docs.sun.com/doc/819-2396/preparecustom-53442?a=view">Creating a Profile in <i>Solaris Express Installation Guide: Custom JumpStart and Advanced Installations</i></a></p></li></ul>


<a name="preparecustom-9700"></a><h5>To Create a Profile to be Used by Solaris Live Upgrade</h5>
<p>This procedure shows you how to create a profile for use with
Solaris Live Upgrade. You can use this profile to upgrade an inactive boot
environment by using the <tt>luupgrade</tt> command with the <tt>-j</tt> option. </p><p>For procedures to use this profile, see the following sections:</p>
<ul><li><p>For an upgrade with a profile, see <a href="#luupgrade-8800">To Upgrade With a Profile by Using Solaris Live Upgrade</a>.</p></li>
<li><p>For a Solaris Flash installation with a profile, see <a href="luupgrade-83.html#luupgrade1-8800">To Install a Solaris Flash Archive With a Profile</a>.</p></li></ul>
<ol>
<li><b>Use a text editor to create a text file. </b><p>Name the file descriptively. Ensure that the name of the profile reflects how
you intend to use the profile to install the Solaris software on a
system. For example, you might name this profile <tt>upgrade_Solaris_11</tt>.</p></li>
<li><b>Add profile keywords and values to the profile.</b><p>Only the upgrade keywords in the following tables can be used in a
Solaris Live Upgrade profile. </p><p><a name="indexterm-68"></a>The following table lists the keywords you can use with the <tt>Install_type</tt> keyword
values of <tt>upgrade</tt> or <tt>flash_install</tt>.</p><a name="luupgrade-tbl-1167"></a><table><col width="46.76*"><col width="65.62*"><col width="65.62*"><tr><th align="left" valign="top" scope="column"><p>Keywords for an Initial Archive Creation</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>Reference</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>(Required) <tt>Install_type</tt></p></td>
<td align="left" valign="top" scope="row"><p>Defines whether
to upgrade the existing Solaris environment on a system or install a Solaris
Flash archive on the system. Use the following values with this keyword:</p>
<ul><li><p><tt>upgrade</tt> for an upgrade</p></li>
<li><p><tt>flash_install</tt> for a Solaris Flash installation</p></li>
<li><p><tt>flash_update</tt> for a Solaris Flash differential installation</p></li></ul>
</td>
<td align="left" valign="top" scope="row"><p>For a
description of all the values for this keyword, see <a href="http://docs.sun.com/doc/819-2396/preparecustom-90?a=view">install_type Profile Keyword in <i>Solaris Express Installation Guide: Custom JumpStart and Advanced Installations</i></a>.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>(Required for a
Solaris Flash archive) <tt>archive_location</tt></p></td>
<td align="left" valign="top" scope="row"><p>Retrieves a Solaris Flash archive from a designated location.
</p></td>
<td align="left" valign="top" scope="row"><p>For a list of values that can be used with this keyword,
see <a href="http://docs.sun.com/doc/819-2396/preparecustom-2?a=view">archive_location Keyword in <i>Solaris Express Installation Guide: Custom JumpStart and Advanced Installations</i></a>.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>(Optional) <tt>cluster</tt> (adding or deleting clusters)</p></td>
<td align="left" valign="top" scope="row"><p>Designates whether a cluster is to
be added or deleted from the software group that is to be installed
on the system.  </p></td>
<td align="left" valign="top" scope="row"><p>For a list of values that can be
used with this keyword, see <a href="http://docs.sun.com/doc/819-2396/preparecustom-100?a=view">cluster Profile Keyword (Adding Software Groups) in <i>Solaris Express Installation Guide: Custom JumpStart and Advanced Installations</i></a>.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>(Optional) <tt>geo</tt></p></td>
<td align="left" valign="top" scope="row"><p>Designates the regional locale or locales
that  you want to install on a system or to add when
upgrading a system. </p></td>
<td align="left" valign="top" scope="row"><p>For a list of values that can be used
with this keyword, see <a href="http://docs.sun.com/doc/819-2396/preparecustom-1?a=view">geo Profile Keyword in <i>Solaris Express Installation Guide: Custom JumpStart and Advanced Installations</i></a>.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>(Optional) <tt>local_customization</tt></p></td>
<td align="left" valign="top" scope="row"><p>Before you install a Solaris Flash archive
on a clone system, you can create custom scripts to preserve local configurations
on the clone system. The <tt>local_customization</tt> keyword designates the directory where you have stored
these scripts. The value is the path to the script on the clone
system. </p></td>
<td align="left" valign="top" scope="row"><p>For information about predeployment and postdeployment scripts, see <a href="http://docs.sun.com/doc/819-2397/flashcreate-65?a=view">Creating Customization Scripts in <i>Solaris Express Installation Guide: Solaris Flash Archives (Creation and Installation)</i></a>.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>(Optional) <tt>locale</tt></p></td>
<td align="left" valign="top" scope="row"><p>Designates the
locale packages you want to install or add when upgrading. </p></td>
<td align="left" valign="top" scope="row"><p>For a
list of values that can be used with this keyword, see <a href="http://docs.sun.com/doc/819-2396/preparecustom-92?a=view">locale Profile Keyword in <i>Solaris Express Installation Guide: Custom JumpStart and Advanced Installations</i></a>.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>(Optional)
<tt>package</tt></p></td>
<td align="left" valign="top" scope="row"><p>Designates whether a package is to be added to or deleted from
the software group that is to be installed on the system. </p></td>
<td align="left" valign="top" scope="row"><p>For a
list of values that can be used with this keyword, see <a href="http://docs.sun.com/doc/819-2396/preparecustom-94?a=view">package Profile Keyword in <i>Solaris Express Installation Guide: Custom JumpStart and Advanced Installations</i></a>.</p></td>
</tr>
</table><p><a name="indexterm-69"></a>The following table lists the keywords you can use with the <tt>Install_type</tt>
keyword value <tt>flash_update</tt>.</p><a name="luupgrade-tbl-11670"></a><table><col width="42.49*"><col width="79.18*"><col width="56.33*"><tr><th align="left" valign="top" scope="column"><p>Keywords for a Differential Archive Creation</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
<th align="left" valign="top" scope="column"><p>Reference</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>(Required) <tt>Install_type</tt></p></td>
<td align="left" valign="top" scope="row"><p>Defines the installation to
install a Solaris Flash archive on the system. The value for a differential
archive is <tt>flash_update</tt>. </p></td>
<td align="left" valign="top" scope="row"><p>For a description of all the values for this
keyword, see <a href="http://docs.sun.com/doc/819-2396/preparecustom-90?a=view">install_type Profile Keyword in <i>Solaris Express Installation Guide: Custom JumpStart and Advanced Installations</i></a>.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>(Required) <tt>archive_location</tt></p></td>
<td align="left" valign="top" scope="row"><p>Retrieves a Solaris Flash archive from a designated location.
</p></td>
<td align="left" valign="top" scope="row"><p>For a list of values that can be used with this keyword,
see <a href="http://docs.sun.com/doc/819-2396/preparecustom-2?a=view">archive_location Keyword in <i>Solaris Express Installation Guide: Custom JumpStart and Advanced Installations</i></a>.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>(Optional) <tt>forced_deployment</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-70"></a>Forces the installation of a Solaris Flash differential archive onto a
clone system that is different than the software expects. If you use <tt>forced_deployment</tt>, all
new files are deleted to bring the clone system to the expected
state. If you are not certain that you want files to be deleted,
use the default, which protects new files by stopping the installation. </p></td>
<td align="left" valign="top" scope="row"><p>For more
information about this keyword, see <a href="http://docs.sun.com/doc/819-2396/jumpstartreference-702?a=view">forced_deployment Profile Keyword (Installing Solaris Flash Differential Archives) in <i>Solaris Express Installation Guide: Custom JumpStart and Advanced Installations</i></a>.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>(Optional) <tt>local_customization</tt></p></td>
<td align="left" valign="top" scope="row"><p><a name="indexterm-71"></a>Before you install a Solaris Flash archive
on a clone system, you can create custom scripts to preserve local configurations
on the clone system. The <tt>local_customization</tt> keyword designates the directory where you
have stored these scripts. The value is the path to the script on
the clone system. </p></td>
<td align="left" valign="top" scope="row"><p>For information about predeployment and postdeployment scripts, see <a href="http://docs.sun.com/doc/819-2397/flashcreate-65?a=view">Creating Customization Scripts in <i>Solaris Express Installation Guide: Solaris Flash Archives (Creation and Installation)</i></a>.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>(Optional)
<tt>no_content_check</tt></p></td>
<td align="left" valign="top" scope="row"><p>When installing a clone system with a Solaris Flash differential archive, you can
use the <tt>no_content_check</tt> keyword to ignore file-by-file validation. File-by-file validation ensures that the
clone system is a duplicate of the master system. Avoid using this keyword
unless you are sure the clone system is a duplicate of the original
master system.</p></td>
<td align="left" valign="top" scope="row"><p>For more information about this keyword, see <a href="http://docs.sun.com/doc/819-2396/jumpstartreference-703?a=view">no_content_check Profile Keyword (Installing Solaris Flash Archives) in <i>Solaris Express Installation Guide: Custom JumpStart and Advanced Installations</i></a>.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>(Optional) <tt>no_master_check</tt></p></td>
<td align="left" valign="top" scope="row"><p>When installing a
clone system with a Solaris Flash differential archive, you can use the <tt>no_master_check</tt>
keyword to ignore a check of files. Clone system files are not checked.
A check would ensure the clone was built from the original master system.
Avoid using this keyword unless you are sure the clone system is a
duplicate of the original master system.</p></td>
<td align="left" valign="top" scope="row"><p>For more information about this keyword, see <a href="http://docs.sun.com/doc/819-2396/jumpstartreference-704?a=view">no_master_check Profile Keyword (Installing Solaris Flash Archives) in <i>Solaris Express Installation Guide: Custom JumpStart and Advanced Installations</i></a>.</p></td>
</tr>
</table></li>
<li><b>Save the profile in a directory on the local system.</b></li>
<li><b>Ensure that <tt>root</tt> owns the profile and that the permissions are set to
644.</b></li>
<li><b>Test the profile (optional).</b><p>For a procedure to test the profile, see <a href="#luupgrade-1162">To Test a Profile to Be Used by Solaris Live Upgrade</a>.</p></li></ol><a name="preparecustom-ex-98"></a>Example&nbsp;5-7 Creating a Solaris Live Upgrade Profile<p><a name="indexterm-72"></a>In this example, a profile provides the upgrade parameters. This profile is to
be used to upgrade an inactive boot environment with the Solaris Live Upgrade
<tt>luupgrade</tt> command and the <tt>-u</tt> and <tt>-j</tt> options. This profile adds a
package and a cluster. A regional locale and additional locales are also added
to the profile. If you add locales to the profile, make sure that
you have created a boot environment with additional disk space. </p><pre># profile keywords         profile values
# ----------------         -------------------
  install_type             upgrade
  package                  SUNWxwman add
  cluster                  SUNWCacc add
  geo                      C_Europe
  locale                   zh_TW
  locale                   zh_TW.BIG5
  locale                   zh_TW.UTF-8
  locale                   zh_HK.UTF-8
  locale                   zh_HK.BIG5HK
  locale                   zh
  locale                   zh_CN.GB18030
  locale                   zh_CN.GBK
  locale                   zh_CN.UTF-8</pre><a name="chapter-ex-2"></a>Example&nbsp;5-8 Creating a Solaris Live Upgrade Profile to Install a Differential Archive<p><a name="indexterm-73"></a>The following example of a profile is to be used by Solaris Live
Upgrade to install a differential archive on a clone system. Only files that
are specified by the differential archive are added, deleted, or changed. The Solaris
Flash archive is retrieved from an NFS server.  Because the image was
built by the original master system, the clone system is not checked for
a valid system image. This profile is to be used with the Solaris
Live Upgrade <tt>luupgrade</tt> command and the <tt>-u</tt> and <tt>-j</tt> options.</p><pre># profile keywords         profile values
# ----------------         -------------------
 install_type              flash_update
 archive_location          nfs installserver:/export/solaris/archive/solarisarchive
 no_master_check</pre><p>To use the <tt>luupgrade</tt> command to install the differential archive, see <a href="luupgrade-83.html#luupgrade1-8800">To Install a Solaris Flash Archive With a Profile</a>.</p>

<a name="luupgrade-1162"></a><h5>To Test a Profile to Be Used by Solaris Live Upgrade</h5>
<p>After you create a profile, use the <tt>luupgrade</tt> command to test the profile.
By looking at the installation output that is generated by <tt>luupgrade</tt>, you can
quickly determine if a profile works as you intended. </p><ol>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="luupgrade-step-1164"></a><b>Test the profile.</b><pre># <tt><b>luupgrade -u -n </tt><i>BE_name</i><tt> -D -s </tt><i>os_image_path</i><tt> -j </tt><i>profile_path</i><tt></b></tt></pre><dl><dt><tt>-u</tt></dt>
<dd><p>Upgrades an operating system image on a boot environment.</p></dd>
<dt><tt>-n</tt> <i>BE_name</i></dt>
<dd><p>Specifies the name of the boot environment that is to be upgraded.</p></dd>
<dt><tt>-D</tt></dt>
<dd><p><tt>luupgrade</tt> command uses the selected boot environment's disk configuration to test the profile options that are passed with the <tt>-j</tt> option.</p></dd>
<dt><tt>-s</tt> <i>os_image_path</i></dt>
<dd><p>Specifies the path name of a directory that contains an operating system image. This directory can be on an installation medium, such as a DVD-ROM, CD-ROM, or it can be an NFS or UFS directory.</p></dd>
<dt><tt>-j</tt> <i>profile_path</i></dt>
<dd><p>Path to a profile that is configured for an upgrade. The profile must be in a directory on the local machine.</p></dd>
</dl>
</li></ol><a name="luupgrade-ex-1165"></a>Example&nbsp;5-9 Testing a Profile by Using Solaris Live Upgrade<p><a name="indexterm-74"></a>In the following example, the profile is named <tt>Flash_profile</tt>. The profile is
successfully tested on the inactive boot environment that is named <tt>second_disk</tt>. </p><pre># <tt><b>luupgrade -u -n u1b08 -D -s /net/installsvr/export/u1/combined.u1wos \</b></tt>
 <tt><b>-j /var/tmp/flash_profile</b></tt>
Validating the contents of the media /net/installsvr/export/u1/combined.u1wos.
The media is a standard Solaris media.
The media contains an operating system upgrade image.
The media contains Solaris version 10.
Locating upgrade profile template to use.
Locating the operating system upgrade program.
Checking for existence of previously scheduled Live Upgrade requests.
Creating upgrade profile for BE <tt>second_disk</tt>.
Determining packages to install or upgrade for BE <tt>second_disk</tt>.
Simulating the operating system upgrade of the BE <tt>second_disk</tt>.
The operating system upgrade simulation is complete.
INFORMATION: var/sadm/system/data/upgrade_cleanup contains a log of the
upgrade operation.
INFORMATION: var/sadm/system/data/upgrade_cleanup contains a log of
cleanup operations required.
The Solaris upgrade of the boot environment <tt>second_disk</tt> is complete.</pre><p>You can now use the profile to upgrade an inactive boot environment.</p>

<a name="luupgrade-8800"></a><h5>To Upgrade With a Profile by Using Solaris Live Upgrade</h5>
<p>This procedure provides step-by-step instructions for upgrading an OS by using a profile.</p><p>If you want to install a Solaris Flash archive by using a
profile, see <a href="luupgrade-83.html#luupgrade1-8800">To Install a Solaris Flash Archive With a Profile</a>.</p><p>If you added locales to the profile, make sure that you have
created a boot environment with additional disk space.</p>
<hr><p><b>Caution - </b>When you install the Solaris OS with a Solaris Flash archive, the archive
and the installation media must contain identical OS versions. For example, if the
archive is the Solaris 10 operating system and you are using DVD media,
then you must use Solaris 10 DVD media to install the archive. If
the OS versions do not match, the installation on the target system
fails. Identical operating systems are necessary when you use the following keyword or command:</p>
<ul><li><p><tt>archive_location</tt> keyword in a profile</p></li>
<li><p><tt>luupgrade</tt> command with <tt>-s</tt>, <tt>-a</tt>, <tt>-j</tt>, and <tt>-J</tt> options</p></li></ul>

<hr>
<ol>
<li><b>Install the Solaris Live Upgrade <tt>SUNWlucfg</tt>, <tt>SUNWlur</tt>, and <tt>SUNWluu</tt> packages on your
system. These packages must be from the release you are upgrading to. For
step-by-step procedures, see <a href="lucreate-8.html#lucreate-3">To Install Solaris Live Upgrade With the <tt>pkgadd</tt> Command</a>.</b></li>
<li><b>Become superuser or assume an equivalent role.</b><p>Roles contain authorizations and privileged commands. For more information about roles, see <a href="http://docs.sun.com/doc/819-3321/rbactask-15?a=view">Configuring RBAC (Task Map) in <i>System Administration Guide: Security Services</i></a>.</p></li>
<li><a name="luupgrade3-step-1161"></a><b>Create a profile. </b><p>See <a href="#preparecustom-9700">To Create a Profile to be Used by Solaris Live Upgrade</a> for a list of upgrade keywords that can be used
in a Solaris Live Upgrade profile. </p></li>
<li><a name="luupgrade2-step-1080"></a><b>Type:</b><pre># <tt><b>luupgrade -u -n </tt><i>BE_name</i><tt> -s </tt><i>os_image_path</i><tt> -j </tt><i>profile_path</i><tt></b></tt></pre><dl><dt><tt>-u</tt></dt>
<dd><p>Upgrades an operating system image on a boot environment.</p></dd>
<dt><tt>-n</tt> <i>BE_name</i></dt>
<dd><p>Specifies the name of the boot environment that is to be upgraded.</p></dd>
<dt><tt>-s</tt> <i>os_image_path</i></dt>
<dd><p>Specifies the path name of a directory that contains an operating system image. This directory can be on an installation medium, such as a DVD-ROM, CD-ROM, or it can be an NFS or UFS directory.</p></dd>
<dt><tt>-j</tt> <i>profile_path</i></dt>
<dd><p>Path to a profile. The profile must be in a directory on the local machine. For information about creating a profile, see <a href="#preparecustom-9700">To Create a Profile to be Used by Solaris Live Upgrade</a>.</p></dd>
</dl>
</li></ol><a name="luupgrade2-ex-970"></a>Example&nbsp;5-10 Upgrading a Boot Environment by Using a Custom JumpStart Profile<p>In this example, the <tt>second_disk</tt> boot environment is upgraded by using a profile.
The <tt>-j</tt> option is used to access the profile. The boot environment is
then ready to be activated. To create a profile, see <a href="#preparecustom-9700">To Create a Profile to be Used by Solaris Live Upgrade</a>. The <tt>pkgadd</tt>
command adds the Solaris Live Upgrade packages from the release you are upgrading to.</p><pre># <tt><b>pkgadd -d /server/packages SUNWlucfg SUNWlur SUNWluu</b></tt>
# <tt><b>luupgrade -u -n second_disk \ -s /net/installmachine/export/solarisX/OS_image \ -j /var/tmp/profile</b></tt> </pre><p>The boot environment is ready to be activated. See <a href="luupgrade-84.html">Activating a Boot Environment</a>.</p>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="luupgrade-333.html">Previous</a>
             </td>
             <td align="right">
                 <a href="luupgrade-83.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

