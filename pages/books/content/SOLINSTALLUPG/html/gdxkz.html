<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Upgrading With Solaris Live Upgrade and Installed Non-Global Zones (Overview) - Solaris Express Installation Guide:  Solaris Live Upgrade and Upgrade Planning</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2007-05-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/indiana.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo"></div>
   <div class="Title">Solaris Express Installation Guide:  Solaris Live Upgrade and Upgrade Planning</div>
</div>

<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="gdzlc.html">Previous</a>
             </td>
             <td align="right">
                 <a href="gdxla.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="preface-1.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="esqbt.html">Part&nbsp;I&nbsp;Upgrading With Solaris Live Upgrade</a></p>
<p class="toc level2"><a href="intro-1.html">1.&nbsp;&nbsp;Where to Find Solaris Installation Planning Information</a></p>
<p class="toc level2"><a href="luoverview-1.html">2.&nbsp;&nbsp;Solaris Live Upgrade (Overview)</a></p>
<p class="toc level2"><a href="luplanning-1.html">3.&nbsp;&nbsp;Solaris Live Upgrade (Planning)</a></p>
<p class="toc level2"><a href="lucreate-1.html">4.&nbsp;&nbsp;Using Solaris Live Upgrade to Create a Boot Environment (Tasks)</a></p>
<p class="toc level2"><a href="liveupgrade-1.html">5.&nbsp;&nbsp;Upgrading With Solaris Live Upgrade (Tasks)</a></p>
<p class="toc level2"><a href="luupgrade-85.html">6.&nbsp;&nbsp;Failure Recovery: Falling Back to the Original Boot Environment (Tasks)</a></p>
<p class="toc level2"><a href="lumaintainence-1.html">7.&nbsp;&nbsp;Maintaining Solaris Live Upgrade Boot Environments (Tasks)</a></p>
<p class="toc level2"><a href="grub-101.html">8.&nbsp;&nbsp;x86: Locating the GRUB Menu's <tt>menu.lst</tt> File (Tasks)</a></p>
<p class="toc level2"><a href="gdzlc.html">9.&nbsp;&nbsp;Upgrading the Solaris OS on a System With Non-Global  Zones Installed</a></p>
<div class="onpage">
<p class="toc level3"><a href="">Upgrading With Solaris Live Upgrade and Installed Non-Global Zones (Overview)</a></p>
</div>
<p class="toc level3"><a href="gdxla.html">Creating and Upgrading a Boot Environment When Non-Global Zones Are Installed (Tasks)</a></p>
<p class="toc level4"><a href="gdxla.html#gdzpq">Upgrading With Solaris Live Upgrade When Non-Global Zones Are Installed on a System (Tasks)</a></p>
<p class="toc level3 tocsp"><a href="gdzlg.html">Upgrading a System With Non-Global  Zones Installed (Example)</a></p>
<p class="toc level3"><a href="geayk.html">Administering Boot Environments That Contain Non-Global Zones</a></p>
<p class="toc level4"><a href="geayk.html#gebjm">To View the Configuration of a Boot Environment's Non-Global Zone File Systems</a></p>
<p class="toc level4"><a href="geayk.html#gedjg">To Compare Boot Environments for a System With Non-Global Zones Installed</a></p>
<p class="toc level2 tocsp"><a href="luexample-1.html">10.&nbsp;&nbsp;Solaris Live Upgrade (Examples)</a></p>
<p class="toc level2"><a href="lureference-1.html">11.&nbsp;&nbsp;Solaris Live Upgrade (Command Reference)</a></p>
<p class="toc level1 tocsp"><a href="esqcb.html">Part&nbsp;II&nbsp;Appendices</a></p>
<p class="toc level2"><a href="troubleshooting-9.html">A.&nbsp;&nbsp;Troubleshooting (Tasks)</a></p>
<p class="toc level2"><a href="package-9.html">B.&nbsp;&nbsp;Additional SVR4 Packaging Requirements (Reference)</a></p>
<p class="toc level1 tocsp"><a href="glossary-1.html">Glossary</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="gdxkz"></a><h3>Upgrading With Solaris Live Upgrade and Installed Non-Global Zones (Overview)</h3>
<p><a name="indexterm-92"></a><a name="indexterm-93"></a>Starting with the Solaris Express 2/07 release, you can upgrade or patch a system
that contains non-global zones with Solaris Live Upgrade. If you have a system
that contains non-global zones, Solaris Live Upgrade is the recommended program to upgrade
and to add patches.  Other upgrade programs might require extensive upgrade time,
because the time required to complete the upgrade increases linearly with the number
of installed non-global zones.  If you are patching a system with Solaris
Live Upgrade, you do not have  to take the system to single-user
mode and you can maximize your system's uptime. The following list summarizes changes
to accommodate systems that have non-global zones installed.</p>
<ul><li><p>A new package, <tt>SUNWlucfg</tt>, is required to be installed with the other Solaris Live Upgrade packages, <tt>SUNWlur</tt> and <tt>SUNWluu</tt>. This package is required for any system, not just a system with non-global zones installed.</p></li>
<li><p>Creating a new boot environment from the currently running boot environment remains the same as in previous releases with one exception. You can specify a destination disk slice for a shared file system within a non-global zone. For more information, see <a href="gdxla.html">Creating and Upgrading a Boot Environment When Non-Global Zones Are Installed (Tasks)</a>.</p></li>
<li><p>The <tt>lumount</tt> command now provides non-global zones with access to their corresponding file systems that exist on inactive boot environments. When the global zone administrator uses the <tt>lumount</tt> command to mount an inactive boot environment, the boot environment is mounted for non-global zones as well. See <a href="geayk.html#gebjo">Using the <tt>lumount</tt> Command on a System That Contains Non-Global Zones</a>.</p></li>
<li><p>Comparing boot environments is enhanced. The <tt>lucompare</tt> command now generates a comparison of boot environments that includes the contents of any non-global zone. See <a href="geayk.html#gedjg">To Compare Boot Environments for a System With Non-Global Zones Installed</a>.</p></li>
<li><p>Listing file systems with the <tt>lufslist</tt> command is enhanced to list file systems for both the global zone and the non-global zones. See <a href="geayk.html#gebjm">To View the Configuration of a Boot Environment's Non-Global Zone File Systems</a>.</p></li></ul>


<a name="gdxkc"></a><h4>Understanding Solaris Zones and Solaris Live Upgrade</h4>
<p><a name="indexterm-94"></a><a name="indexterm-95"></a>The Solaris Zones partitioning technology is used to virtualize operating system services and provide
an isolated and secure environment for running applications.  A non-global zone is
a virtualized operating system environment created within a single instance of the Solaris
OS, the global zone. When you create a non-global zone, you produce an
application execution environment in which processes are isolated from the rest of the
system.</p><p>Solaris Live Upgrade is a mechanism to copy the currently running system onto
new slices. When non-global zones are installed, they can be copied to the
inactive boot environment along with the global zone's file systems.</p><p><a href="#gedht">Figure&nbsp;9-1</a> shows a non-global zone that is copied to the inactive boot environment
along with the global zone's file system.</p><a name="gedht"></a><h6>Figure&nbsp;9-1 Creating a Boot Environment &ndash; Copying Non-Global Zones</h6><img src="figures/lu-create-zone1.gif" alt="The context describes the illustration."></img>
<ul><li><p>In this example of a system with a single disk, the root (<tt>/</tt>) file system is copied to <tt>c0t0d0s4</tt>. All non-global zones that are associated with the file system are also copied to <tt>s4</tt>. The <tt>/export</tt> and <tt>/swap</tt> file systems are shared between the current boot environment, <tt>bootenv1</tt>, and the inactive boot environment, <tt>bootenv2</tt>. The <tt>lucreate</tt> command is the following:</p><pre># <tt><b>lucreate -c bootenv1 -m /:/dev/dsk/c0t0d0s4:ufs</b></tt> <tt><b>-n bootenv2</b></tt></pre></li>
<li><p>In this example of a system with two disks, the root (<tt>/</tt>) file system is copied to <tt>c0t1d0s0</tt>. All non-global zones that are associated with the file system are also copied to <tt>s0</tt>. The <tt>/export</tt> and <tt>/swap</tt> file systems are shared between the current boot environment, <tt>bootenv1</tt>, and the inactive boot environment, <tt>bootenv2</tt>. The <tt>lucreate</tt> command is the following:</p><pre># <tt><b>lucreate -c bootenv1 -m /:/dev/dsk/c0t1d0s0:ufs</b></tt> <tt><b>-n bootenv2</b></tt></pre></li></ul>
<p><a href="#gedip">Figure&nbsp;9-2</a> shows that a non-global zone is copied to the inactive boot environment.</p><a name="gedip"></a><h6>Figure&nbsp;9-2 Creating a Boot Environment &ndash; Copying a Shared File System From a Non-Global Zone</h6><img src="figures/lu-create-zone2.gif" alt="The context describes the illustration."></img>
<ul><li><p>In this example of a system with a single disk, the root (<tt>/</tt>) file system is copied to <tt>c0t0d0s4</tt>. All non-global zones that are associated with the file system are also copied to <tt>s4</tt>. The non-global zone, <tt>zone1</tt>, has a separate file system that was created by the <tt>zonecfg add fs</tt> command. The zone path is <tt>/zone1/root/export</tt>. To prevent this file system from being shared by the inactive boot environment, the file system is placed on a separate slice, <tt>c0t0d0s6</tt>. The <tt>/export</tt> and <tt>/swap</tt> file systems are shared between the current boot environment, <tt>bootenv1</tt>, and the inactive boot environment, <tt>bootenv2</tt>. The <tt>lucreate</tt> command is the following:</p><pre># <tt><b>lucreate -c bootenv1 -m /:/dev/dsk/c0t0d0s4:ufs</b></tt> \
<tt><b>-m /export:/dev/dsk/c0t0d0s6:ufs:zone1 -n bootenv2</b></tt></pre></li>
<li><p>In this example of a system with two disks, the root (<tt>/</tt>) file system is copied to <tt>c0t1d0s0</tt>. All non-global zones that are associated with the file system are also copied to <tt>s0</tt>. The non-global zone, <tt>zone1</tt>, has a separate file system that was created by the <tt>zonecfg add fs</tt> command. The zone path is <tt>/zone1/root/export</tt>. To prevent this file system from being shared by the inactive boot environment, the file system is placed on a separate slice, <tt>c0t1d0s4</tt>. The <tt>/export</tt> and <tt>/swap</tt> file systems are shared between the current boot environment, <tt>bootenv1</tt>, and the inactive boot environment, <tt>bootenv2</tt>. The <tt>lucreate</tt> command is the following:</p><pre># <tt><b>lucreate -c bootenv1 -m /:/dev/dsk/c0t1d0s0:ufs</b></tt> \
<tt><b>-m /export:/dev/desk/c0t1d0s4:ufs:zone1 -n bootenv2</b></tt></pre></li></ul>

         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="gdzlc.html">Previous</a>
             </td>
             <td align="right">
                 <a href="gdxla.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

