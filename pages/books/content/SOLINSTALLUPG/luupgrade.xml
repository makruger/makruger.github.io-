<chapter id="liveupgrade-1"><title>Upgrading With Solaris Live Upgrade (Tasks)</title><highlights><para>This chapter explains how to use Solaris Live Upgrade to upgrade and
activate an inactive boot environment. This chapter contains the following
sections:</para><itemizedlist><listitem><para><olink targetptr="luupgrade-333" remap="internal">Task Map: Upgrading a Boot
Environment</olink></para>
</listitem><listitem><para><olink targetptr="luupgrade-82" remap="internal">Upgrading a Boot Environment</olink></para>
</listitem><listitem><para><olink targetptr="luupgrade-83" remap="internal">Installing Solaris Flash Archives
on a Boot Environment</olink></para>
</listitem><listitem><para><olink targetptr="luupgrade-84" remap="internal">Activating a Boot Environment</olink></para>
</listitem>
</itemizedlist>
</highlights><sect1 id="luupgrade-333"><title>Task Map: Upgrading a Boot Environment</title><table frame="all" id="luupgrade-tbl-159"><title>Task Map: Upgrading With
Solaris Live Upgrade</title><tgroup cols="3" colsep="0" rowsep="0"><colspec colname="colspec3" colwidth="33*"/><colspec colname="colspec4" colwidth="33*"/><colspec colname="colspec5" colwidth="33*"/><thead><row rowsep="1"><entry colsep="1" rowsep="1"><para>Task </para>
</entry><entry colsep="1" rowsep="1"><para>Description</para>
</entry><entry colsep="1" rowsep="1"><para>For Instructions</para>
</entry>
</row>
</thead><tbody><row><entry colsep="1" rowsep="1"><para>Either upgrade a boot environment or install a Solaris Flash archive.</para>
</entry><entry colsep="1" rowsep="1"><itemizedlist><listitem><para>Upgrade the inactive boot environment with an OS image.</para>
</listitem><listitem><para>Install a Solaris Flash archive on an inactive boot environment.</para>
</listitem>
</itemizedlist>
</entry><entry colsep="1" rowsep="1"><itemizedlist><listitem><para><olink targetptr="luupgrade-82" remap="internal">Upgrading a Boot Environment</olink></para>
</listitem><listitem><para><olink targetptr="luupgrade-83" remap="internal">Installing Solaris Flash Archives
on a Boot Environment</olink></para>
</listitem>
</itemizedlist>
</entry>
</row><row><entry colsep="1" rowsep="1"><para>Activate an inactive boot environment.</para>
</entry><entry colsep="1" rowsep="1"><para>Makes changes effective and switches the inactive boot environment to
active .</para>
</entry><entry colsep="1" rowsep="1"><para><olink targetptr="luupgrade-84" remap="internal">Activating a Boot Environment</olink></para>
</entry>
</row><row><entry colsep="1" rowsep="1"><para>(optional) Switch back if a failure occurs when activating.</para>
</entry><entry colsep="1" rowsep="1"><para>Reactivates to the original boot environment if a failure occurs.</para>
</entry><entry colsep="1" rowsep="1"><para><olink targetptr="luupgrade-85" remap="internal">Chapter&nbsp;6, Failure Recovery: Falling
Back to the Original Boot Environment (Tasks)</olink></para>
</entry>
</row>
</tbody>
</tgroup>
</table>
</sect1><sect1 id="luupgrade-82"><title>Upgrading a Boot Environment</title><para>Use the <command>luupgrade</command> command
to upgrade a boot environment. This section provides the procedure for upgrading
an inactive boot environment from files that are located on the following
media:</para><itemizedlist><listitem><para>NFS server</para>
</listitem><listitem><para>Local file</para>
</listitem><listitem><para>Local tape</para>
</listitem><listitem><para>Local device, including DVD or CD</para>
</listitem>
</itemizedlist><sect2 id="luupgrade-5"><title>Guidelines for Upgrading</title><para>When you upgrade a boot environment with the latest OS, you do
not affect the active boot environment. The new files merge with the inactive
boot environment critical file systems, but shareable file systems are not
changed.</para><para>You can upgrade when RAID-1 volumes are installed, or if non-global
zones are installed, or you can install a Solaris Flash:</para><itemizedlist><listitem><para>You can upgrade an inactive boot environment that contains
any combination of physical disk slices, Solaris Volume Manager volumes, or
Veritas Volume Manager volumes. The slice that is chosen for the root (<filename>/</filename>) file system must be a single-slice concatenation that is included
in a RAID&ndash;1 volume (mirror). For procedures about creating a boot environment
with mirrored file systems, see <olink targetptr="lucreate-1000" remap="internal">To Create
a Boot Environment With RAID-1 Volumes (Mirrors)</olink>.</para><note><para>If VxVM volumes are configured on your current system, the <command>lucreate</command> command can create a new boot environment.  When the data is copied
to the new boot environment, the Veritas file system configuration is lost
and a UFS file system is created on the new boot environment.</para>
</note>
</listitem><listitem><para>You can upgrade a system that has non-global zones installed
with any installation program. For procedures about upgrading with non-global
zones, see <olink targetptr="gdzlc" remap="internal">Chapter&nbsp;9, Upgrading the Solaris
OS on a System With Non-Global  Zones Installed</olink>.</para>
</listitem><listitem><para>Rather than upgrading, if you have created a Solaris Flash archive,
you could install the archive on an inactive boot environment. The new files
overwrite critical file systems of the inactive boot environment, but shareable
file systems are not changed. See <olink targetptr="luupgrade-83" remap="internal">Installing
Solaris Flash Archives on a Boot Environment</olink>.</para>
</listitem>
</itemizedlist><sect3 id="luupgrade-6"><title>Upgrading a System With Packages or Patches</title><para>You can use Solaris Live Upgrade to add patches and packages to
a system.  Solaris Live Upgrade creates a copy of the currently running system.
This new boot environment can be upgraded or you can add packages or patches.
When you use Solaris Live Upgrade, the only downtime the system incurs is
that of a reboot. You can add patches  and packages to a new boot environment
with the <command>luupgrade</command>  command.</para><caution><para>When adding and removing packages or patches, Solaris Live
Upgrade requires packages or patches that comply with the SVR4 advanced packaging
guidelines. While Sun packages conform to these guidelines, Sun cannot guarantee
the conformance of packages from third-party vendors. If a package violates
these guidelines, the package can cause the package-addition software to fail
or alter the active boot environment during an upgrade. </para><para>For more
information about packaging requirements, see <olink targetptr="package-9" remap="internal">Appendix&nbsp;B,
Additional SVR4 Packaging Requirements (Reference)</olink>.</para>
</caution><table frame="topbot" id="ganuh"><title>Upgrading a Boot Environment With
Packages and Patches</title><tgroup cols="3" colsep="0" rowsep="0"><colspec colwidth="39.42*"/><colspec colwidth="55.29*"/><colspec colname="colspec0" colwidth="55.29*"/><thead><row><entry rowsep="1"><para>Type of Installation</para>
</entry><entry rowsep="1"><para>Description</para>
</entry><entry rowsep="1"><para>For More Information</para>
</entry>
</row>
</thead><tbody><row><entry><para>Adding patches to a boot environment. </para>
</entry><entry><para>Create a new boot environment and use the <command>luupgrade</command> command
with the <option>t</option> option.</para>
</entry><entry><para><olink targetptr="frcbs" remap="internal">To Add Patches to a Network Installation Image
on a Boot Environment</olink></para>
</entry>
</row><row><entry><para>Adding packages to a boot environment.</para>
</entry><entry><para>Use the <command>luupgrade</command> command  with the <option>p</option> option.</para>
</entry><entry><para><olink targetptr="frcbp" remap="internal">To Add Packages to a Network Installation Image
on a Boot Environment</olink></para>
</entry>
</row>
</tbody>
</tgroup>
</table>
</sect3>
</sect2><task id="luupgrade-86"><title>To Upgrade a Network Installation Image on
a Boot Environment</title><tasksummary><para>To upgrade by using this procedure, you must use a DVD or a network
installation image. If the installation requires more than one CD, you must
use the procedure <olink targetptr="luupgrade-87" remap="internal">To Upgrade a Network Installation
Image From Multiple CDs</olink>. </para>
</tasksummary><procedure><step><para>Install the Solaris Live Upgrade <literal>SUNWlucfg</literal>, <literal>SUNWlur</literal>, and <literal>SUNWluu</literal> packages on your system.
These packages must be from the release you are upgrading to. For step-by-step
procedures, see <olink targetptr="lucreate-3" remap="internal">To Install Solaris Live Upgrade
With the pkgadd Command</olink>.</para>
</step>&suStepA;<step id="luupgrade-step-38"><para>Indicate the boot environment to upgrade
and the path to the installation software by typing:</para><screen># <userinput>luupgrade -u -n <replaceable>BE_name</replaceable> -s <replaceable>os_image_path</replaceable></userinput></screen><variablelist><varlistentry><term><option>u</option></term><listitem><para>Upgrades a network installation image on a boot environment</para>
</listitem>
</varlistentry><varlistentry><term><option>n</option> <replaceable>BE_name</replaceable></term><listitem><para>Specifies the name of the boot environment that is to be upgraded</para>
</listitem>
</varlistentry><varlistentry><term><option>s</option> <replaceable>os_image_path</replaceable></term><listitem><para>Specifies the path name of a directory that contains a network
installation image</para>
</listitem>
</varlistentry>
</variablelist>
</step>
</procedure><example id="gcnvz"><title>Upgrading a Network Installation Image on a Boot Environment From DVD
Media</title><para>In this example, the <literal>second_disk</literal> boot environment
is upgraded by using DVD media. The pkgadd command adds the Solaris Live Upgrade
packages from the release you are upgrading to.</para><screen># <userinput>pkgadd -d /server/packages SUNWlucfg SUNWlur SUNWluu</userinput>
# <userinput>luupgrade -u -n second_disk -s /media/cdrom/s0</userinput> </screen>
</example><example id="luupgrade-ex-92"><title>Upgrading a Network Installation Image on a Boot Environment From a
Network Installation Image</title><para>In this example, the <literal>second_disk</literal> boot environment
is upgraded. The pkgadd command adds the Solaris Live Upgrade packages from
the release you are upgrading to.</para><screen># <userinput>pkgadd -d /server/packages SUNWlucfg SUNWlur SUNWluu</userinput>
# <userinput>luupgrade -u -n second_disk \ 
-s /net/installmachine/export/Solaris_11/OS_image</userinput> </screen>
</example>
</task><task id="luupgrade-87"><title>To Upgrade a Network Installation Image From
Multiple CDs</title><tasksummary><para>Because the network installation image resides on more than one CD,
you must use this upgrade procedure. Use the <command>luupgrade</command> command
with the <option>i</option> option to install any additional CDs.</para>
</tasksummary><procedure><step><para>Install the Solaris Live Upgrade <literal>SUNWlucfg</literal>, <literal>SUNWlur</literal>, and <literal>SUNWluu</literal> packages on your system.
These packages must be from the release you are upgrading to. For step-by-step
procedures, see <olink targetptr="lucreate-3" remap="internal">To Install Solaris Live Upgrade
With the pkgadd Command</olink>.</para>
</step>&suStepA;<step id="luupgrade-step-106"><para>Indicate the boot environment to upgrade
and the path to the installation software by typing:</para><screen># <userinput>luupgrade -u -n <replaceable>BE_name</replaceable> -s <replaceable>os_image_path</replaceable></userinput></screen><variablelist><varlistentry><term><option>u</option></term><listitem><para>Upgrades a network installation image on a boot environment</para>
</listitem>
</varlistentry><varlistentry><term><option>n</option> <replaceable>BE_name</replaceable></term><listitem><para>Specifies the name of the boot environment that is to be upgraded</para>
</listitem>
</varlistentry><varlistentry><term><option>s</option> <replaceable>os_image_path</replaceable></term><listitem><para>Specifies the path name of a directory that contains a network
installation image</para>
</listitem>
</varlistentry>
</variablelist>
</step><step id="luupgrade-step-41"><para>When the installer is finished with the
contents of the first CD, insert the second CD.</para>
</step><step id="luupgrade-step-40"><para>This step is identical to the previous
step, but the <option>u</option> option is replaced by the <option>i</option> option.
Also, choose to run the installer on the second CD with menus or with text.</para><itemizedlist><listitem><para>This command runs the installer on the second CD with menus.</para><screen># <userinput>luupgrade -i -n <replaceable>BE_name</replaceable> -s <replaceable>os_image_path</replaceable></userinput></screen>
</listitem><listitem><para>This command runs the installer on the second CD with text
and requires no user interaction.</para><screen># <userinput>luupgrade -i -n <replaceable>BE_name</replaceable> -s <replaceable>os_image_path</replaceable></userinput> <option>O</option> <userinput>'</userinput><option>nodisplay</option> <option>noconsole</option><userinput>'</userinput></screen>
</listitem>
</itemizedlist><variablelist><varlistentry><term><option>i</option></term><listitem><para>Installs additional CDs. The software looks for an installation
program on the specified medium and runs that program. The installer program
is specified with <option>s</option>. </para>
</listitem>
</varlistentry><varlistentry><term><option>n</option> <replaceable>BE_name</replaceable></term><listitem><para>Specifies the name of the boot environment that is to be upgraded.</para>
</listitem>
</varlistentry><varlistentry><term><option>s</option> <replaceable>os_image_path</replaceable></term><listitem><para>Specifies the path name of a directory that contains an network
installation image.</para>
</listitem>
</varlistentry><varlistentry><term><option>O</option> '<option>nodisplay</option> <option>noconsole</option>'</term><listitem><para>(Optional) Runs the installer on the second CD in text mode
and requires no user interaction.</para>
</listitem>
</varlistentry>
</variablelist>
</step><step><para>Repeat <olink targetptr="luupgrade-step-41" remap="internal">Step&nbsp;4</olink> and <olink targetptr="luupgrade-step-40" remap="internal">Step&nbsp;5</olink> for each CD that you want
to install.</para><para>The boot environment is ready to be activated. See <olink targetptr="luupgrade-84" remap="internal">Activating a Boot Environment</olink>.</para>
</step>
</procedure><example id="luupgrade-ex-93" arch="sparc"><title>Upgrading a Network Installation Image From Multiple CDs</title><para>In this example, the <literal>second_disk</literal> boot environment
is upgraded and the installation image is on two CDs: the Solaris Software - 1 and
the Solaris Software - 2 CDs. The <option>u</option> option determines if
sufficient space for all the packages is on the CD set. The <option>O</option> option
with the <option>nodisplay</option> and <option>noconsole</option> options
prevents the character user interface from displaying after the reading of
the second CD. If you use these options, you are not prompted to type information.</para><para><emphasis role="strong">Note</emphasis>: If you do not use the <option>O</option> option
with the <option>nodisplay</option> and <option>noconsole</option> options,
the character user interface (CUI) is displayed. Sun no longer recommends
using the (CUI) to do Solaris Live Upgrade tasks.</para><para>Install the Solaris Live Upgrade packages from the release you are upgrading
to.</para><screen># <userinput>pkgadd -d /server/packages SUNWlucfg SUNWlur SUNWluu</userinput></screen><para>Insert the Solaris Software - 1 CD and type:</para><itemizedlist><listitem><para>For SPARC based systems:</para><screen># <userinput>luupgrade -u -n second_disk -s /media/cdrom/s0</userinput> </screen>
</listitem><listitem><para>For x86 based systems:</para><screen># <userinput>luupgrade -u -n second_disk -s /media/cdrom/</userinput> </screen>
</listitem>
</itemizedlist><para>Insert the Solaris Software - 2 CD and type the following.</para><screen># <userinput>luupgrade -i -n second_disk -s /media/cdrom -O '-nodisplay \ 
-noconsole'</userinput>
Repeat this step for each CD that you need.</screen><para>Repeat the previous step for each CD that you want to install.</para>
</example>
</task><task id="frcbp"><title>To Add Packages to a Network Installation Image on
a Boot Environment</title><tasksummary><para>In the following procedure, packages are removed from and added to a
new boot environment.</para><caution><para>When you are upgrading. adding and removing packages or patches,
Solaris Live Upgrade requires packages or patches that comply with the SVR4
advanced packaging guidelines. While Sun packages conform to these guidelines,
Sun cannot guarantee the conformance of packages from third-party vendors.
If a package violates these guidelines, the package can cause the package-addition
software to fail or can alter the active boot environment.</para><para>For
more information about packaging requirements, see <olink targetptr="package-9" remap="internal">Appendix&nbsp;B,
Additional SVR4 Packaging Requirements (Reference)</olink>.</para>
</caution>
</tasksummary><procedure>&suStepA;<step><para>To remove a package or set of packages from a new boot environment,
type:</para><screen>#  <userinput>luupgrade -P -n second_disk <replaceable>package-name</replaceable></userinput></screen><variablelist><varlistentry><term><option>P</option></term><listitem><para>Indicates to remove the named package or packages from the
boot environment</para>
</listitem>
</varlistentry><varlistentry><term><option>n</option> <replaceable>BE_name</replaceable></term><listitem><para>Specifies the name of the boot environment where the package
is to be removed</para>
</listitem>
</varlistentry><varlistentry><term><replaceable>package-name</replaceable></term><listitem><para>Specifies the names of the packages to be removed. Separate
multiple package names with spaces.</para>
</listitem>
</varlistentry>
</variablelist>
</step><step><para>To add a package or a set of packages to the new boot environment,
type:</para><screen># <userinput>luupgrade -p -n second_disk -s <replaceable>/path-to-packages</replaceable> <replaceable>package-name</replaceable></userinput></screen><variablelist><varlistentry><term><option>p</option></term><listitem><para>Indicates to add packages to the boot environment.</para>
</listitem>
</varlistentry><varlistentry><term><option>n</option> <replaceable>BE_name</replaceable></term><listitem><para>Specifies the name of the boot environment where the package
is to be added.</para>
</listitem>
</varlistentry><varlistentry><term><option>s</option> <replaceable>path-to-packages</replaceable></term><listitem><para>Specifies the path to a directory that contains the package
or packages that are to be added.</para>
</listitem>
</varlistentry><varlistentry><term><replaceable>package-name</replaceable></term><listitem><para>Specifies the names of the package or packages to be added.
Separate multiple package names with a space.</para>
</listitem>
</varlistentry>
</variablelist>
</step>
</procedure><example id="frcbr"><title>Adding packages to a Network Installation Image on a Boot Environment</title><para>In this example, packages are removed then added to the <literal>second_disk</literal> boot environment.</para><screen># <userinput>luupgrade -P -n second_disk SUNWabc SUNWdef SUNWghi</userinput>
# <userinput>luupgrade -p -n second_disk -s /net/installmachine/export/packages</userinput> \
<userinput>SUNWijk SUNWlmn SUNWpkr</userinput></screen>
</example>
</task><task id="frcbs"><title>To Add Patches to a Network Installation Image on
a Boot Environment</title><tasksummary><para>In the following procedure, patches are removed from and added to a
new boot environment.</para><caution><para>When you are adding and removing packages or patches, Solaris
Live Upgrade requires packages or patches that comply with the SVR4 advanced
packaging guidelines. While Sun packages conform to these guidelines, Sun
cannot guarantee the conformance of packages from third-party vendors. If
a package violates these guidelines, the package can cause the package-addition
software to fail or can alter the active boot environment.</para>
</caution>
</tasksummary><procedure>&suStepA;<step><para>To remove a patch or set of patches from a new boot environment,
type:</para><screen># <userinput>luupgrade -T -n second_disk <replaceable>patch_name</replaceable></userinput></screen><variablelist><varlistentry><term><option>T</option></term><listitem><para>Indicates to remove the named patch or patches from the boot
environment.</para>
</listitem>
</varlistentry><varlistentry><term><option>n</option> <replaceable>BE_name</replaceable></term><listitem><para>Specifies the name of the boot environment where the patch
or patches are to be removed.</para>
</listitem>
</varlistentry><varlistentry><term><replaceable>patch-name</replaceable></term><listitem><para>Specifies the names of the patches to be removed. Separate
multiple patch names with spaces.</para>
</listitem>
</varlistentry>
</variablelist>
</step><step><para>To add a patch or a set of patches to the new boot environment,
type the following command.</para><screen># <userinput>luupgrade -t -n second_disk -s <replaceable>/path-to-patches</replaceable> <replaceable>patch-name</replaceable></userinput></screen><variablelist><varlistentry><term><option>t</option></term><listitem><para>Indicates to add patches to the boot environment.</para>
</listitem>
</varlistentry><varlistentry><term><option>n</option> <replaceable>BE_name</replaceable></term><listitem><para>Specifies the name of the boot environment where the patch
is to be added.</para>
</listitem>
</varlistentry><varlistentry><term><option>s</option> <replaceable>path-to-patches</replaceable></term><listitem><para>Specifies the path to the directory that contains the patches
that are to be added.</para>
</listitem>
</varlistentry><varlistentry><term><replaceable>patch-name</replaceable></term><listitem><para>Specifies the names of the patch or patches that are to be
added. Separate multiple patch names with a space.</para>
</listitem>
</varlistentry>
</variablelist>
</step>
</procedure><example id="frcbv"><title>Adding Patches to a Network Installation Image on a Boot Environment</title><para>In this example, patches are removed then added to the <literal>second_disk</literal> boot environment .</para><screen># <userinput>luupgrade -T -n second_disk 222222-01</userinput>
# <userinput>luupgrade -t -n second_disk -s /net/installmachine/export/packages</userinput> \
<userinput>333333-01 4444444-01</userinput></screen>
</example>
</task><task id="frcfi"><title>To Obtain Information on Packages Installed on a Boot
Environment</title><tasksummary><para>The follow procedure checks the integrity of the packages installed
on the new boot environment.</para>
</tasksummary><procedure>&suStepA;<step><para>To check the integrity of the newly installed packages on the
new boot environment, type:</para><screen>#  <userinput>luupgrade -C -n second_disk -O "-v" <replaceable>package-name</replaceable></userinput></screen><variablelist><varlistentry><term><option>C</option></term><listitem><para>Indicates to run the <command>pkgchk</command> command on
the named packages</para>
</listitem>
</varlistentry><varlistentry><term><option>n</option> <replaceable>BE_name</replaceable></term><listitem><para>Specifies the name of the boot environment where the check
is to be performed</para>
</listitem>
</varlistentry><varlistentry><term><option>O</option></term><listitem><para>Passes the options directly to the <command>pkgchk</command> command</para>
</listitem>
</varlistentry><varlistentry><term><replaceable>package-name</replaceable></term><listitem><para>Specifies the names of the packages to be checked. Separate
multiple package names with spaces. If package names are omitted, the check
is done on all packages in the specified boot environment.</para>
</listitem>
</varlistentry><varlistentry><term>&ldquo;<option>v</option>&rdquo;</term><listitem><para>Specifies to run the command in verbose mode</para>
</listitem>
</varlistentry>
</variablelist>
</step>
</procedure><example id="frcfj"><title>Checking the Integrity of Packages on a Boot Environment</title><para>In this example, the packages <literal>SUNWabc,</literal> <literal>SUNWdef,</literal> and <literal>SUNWghi</literal> are checked to make sure they were
installed properly and are not damaged.</para><screen># <userinput>luupgrade -C -n second_disk SUNWabc SUNWdef SUNWghi</userinput></screen>
</example>
</task><sect2 id="fyggn"><title>Upgrading by Using a JumpStart Profile</title><para>You can create a JumpStart profile to use with Solaris Live Upgrade.
If you are familiar with the custom JumpStart program, this is the same profile
that custom JumpStart uses. The following procedures enable you to create
a profile, test the profile, and install by using the <command>luupgrade</command> command
with the <option>j</option> option.</para><caution><para>When you install the Solaris OS with a Solaris Flash archive,
the archive and the installation media must contain identical OS versions.
For example, if the archive is the Solaris 10 operating system and you are
using DVD media, then you must use Solaris 10 DVD media to install the archive.
If the OS versions do not match, the installation on the target system fails.
Identical operating systems are necessary when you use the following keyword
or command:</para><itemizedlist><listitem><para><literal>archive_location</literal> keyword in a profile</para>
</listitem><listitem><para><command>luupgrade</command> command with <option>s</option>, <option>a</option>, <option>j</option>, and <option>J</option> options</para>
</listitem>
</itemizedlist>
</caution><para>For more information see the following:</para><itemizedlist><listitem><para><olink targetptr="preparecustom-9700" remap="internal">To Create a Profile
to be Used by Solaris Live Upgrade</olink></para>
</listitem><listitem><para><olink targetptr="luupgrade-1162" remap="internal">To Test a Profile to Be
Used by Solaris Live Upgrade</olink></para>
</listitem><listitem><para><olink targetptr="luupgrade-8800" remap="internal">To Upgrade With a Profile
by Using Solaris Live Upgrade</olink></para>
</listitem><listitem><para>For creating a JumpStart profile, see <olink targetdoc="solinstalladv" targetptr="preparecustom-53442" remap="external"><citetitle remap="section">Creating a Profile</citetitle> in <citetitle remap="book">Solaris Express Installation Guide: Custom JumpStart and Advanced Installations</citetitle></olink></para>
</listitem>
</itemizedlist><task id="preparecustom-9700"><title>To Create a Profile to be Used by Solaris
Live Upgrade</title><tasksummary><para>This procedure shows you how to create a profile for use with Solaris
Live Upgrade. You can use this profile to upgrade an inactive boot environment
by using the <command>luupgrade</command> command with the <option>j</option> option. </para><para>For procedures to use this profile, see the following sections:</para><itemizedlist><listitem><para>For an upgrade with a profile, see <olink targetptr="luupgrade-8800" remap="internal">To Upgrade With a Profile by Using Solaris Live
Upgrade</olink>.</para>
</listitem><listitem><para>For a Solaris Flash installation with a profile, see <olink targetptr="luupgrade1-8800" remap="internal">To Install a Solaris Flash Archive With a Profile</olink>.</para>
</listitem>
</itemizedlist>
</tasksummary><procedure><step><para>Use a text editor to create a text file. </para><para>Name the
file descriptively. Ensure that the name of the profile reflects how you intend
to use the profile to install the Solaris software on a system. For example,
you might name this profile <filename>upgrade_Solaris_11</filename>.</para>
</step><step><para>Add profile keywords and values to the profile.</para><para>Only
the upgrade keywords in the following tables can be used in a Solaris Live
Upgrade profile. </para><para>The following table lists the keywords you can use
with the <literal>Install_type</literal> keyword values of <literal>upgrade</literal> or <literal>flash_install</literal>.</para><informaltable frame="topbot" pgwide="100" id="luupgrade-tbl-1167"><tgroup cols="3" colsep="0" rowsep="0"><colspec colname="colspec2" colwidth="46.76*"/><colspec colname="colspec3" colwidth="65.62*"/><colspec colname="colspec1" colwidth="65.62*"/><thead><row rowsep="1"><entry><para>Keywords for an Initial Archive Creation</para>
</entry><entry><para>Description</para>
</entry><entry><para>Reference</para>
</entry>
</row>
</thead><tbody><row><entry><para>(Required) <literal>Install_type</literal></para>
</entry><entry><para>Defines whether to upgrade the existing Solaris environment on a system
or install a Solaris Flash archive on the system. Use the following values
with this keyword:</para><itemizedlist><listitem><para><literal>upgrade</literal> for an upgrade</para>
</listitem><listitem><para><literal>flash_install</literal> for a Solaris Flash installation</para>
</listitem><listitem><para><literal>flash_update</literal> for a Solaris Flash differential
installation</para>
</listitem>
</itemizedlist>
</entry><entry><para>For a description of all the values for this keyword, see <olink targetdoc="solinstalladv" targetptr="preparecustom-90" remap="external"><citetitle remap="section">install_type Profile Keyword</citetitle> in <citetitle remap="book">Solaris Express Installation Guide: Custom JumpStart and Advanced Installations</citetitle></olink>.</para>
</entry>
</row><row><entry><para>(Required for a Solaris Flash archive) <literal>archive_location</literal></para>
</entry><entry><para>Retrieves a Solaris Flash archive from a designated location. </para>
</entry><entry><para>For a list of values that can be used with this keyword, see <olink targetdoc="solinstalladv" targetptr="preparecustom-2" remap="external"><citetitle remap="section">archive_location Keyword</citetitle> in <citetitle remap="book">Solaris Express Installation Guide: Custom JumpStart and Advanced Installations</citetitle></olink>.</para>
</entry>
</row><row><entry><para>(Optional) <literal>cluster</literal> (adding or deleting clusters)</para>
</entry><entry><para>Designates whether a cluster is to be added or deleted from the software
group that is to be installed on the system.  </para>
</entry><entry><para>For a list of values that can be used with this keyword, see <olink targetdoc="solinstalladv" targetptr="preparecustom-100" remap="external"><citetitle remap="section">cluster Profile Keyword (Adding Software Groups)</citetitle> in <citetitle remap="book">Solaris Express Installation Guide: Custom JumpStart and Advanced Installations</citetitle></olink>.</para>
</entry>
</row><row><entry><para>(Optional) <literal>geo</literal></para>
</entry><entry><para>Designates the regional locale or locales that  you want to install
on a system or to add when upgrading a system. </para>
</entry><entry><para>For a list of values that can be used with this keyword, see <olink targetdoc="solinstalladv" targetptr="preparecustom-1" remap="external"><citetitle remap="section">geo Profile Keyword</citetitle> in <citetitle remap="book">Solaris Express Installation Guide: Custom JumpStart and Advanced Installations</citetitle></olink>.</para>
</entry>
</row><row><entry><para>(Optional) <literal>local_customization</literal></para>
</entry><entry><para>Before you install a Solaris Flash archive on a clone system, you
can create custom scripts to preserve local configurations on the clone system.
The <literal>local_customization</literal> keyword designates the directory
where you have stored these scripts. The value is the path to the script on
the clone system. </para>
</entry><entry><para>For information about predeployment and postdeployment scripts, see <olink targetdoc="solinstallflash" targetptr="flashcreate-65" remap="external"><citetitle remap="section">Creating Customization Scripts</citetitle> in <citetitle remap="book">Solaris Express Installation Guide: Solaris Flash Archives (Creation and Installation)</citetitle></olink>.</para>
</entry>
</row><row><entry><para>(Optional) <literal>locale</literal></para>
</entry><entry><para>Designates the locale packages you want to install or add when upgrading. </para>
</entry><entry><para>For a list of values that can be used with this keyword, see <olink targetdoc="solinstalladv" targetptr="preparecustom-92" remap="external"><citetitle remap="section">locale Profile Keyword</citetitle> in <citetitle remap="book">Solaris Express Installation Guide: Custom JumpStart and Advanced Installations</citetitle></olink>.</para>
</entry>
</row><row><entry><para>(Optional) <literal>package</literal></para>
</entry><entry><para>Designates whether a package is to be added to or deleted from the software
group that is to be installed on the system. </para>
</entry><entry><para>For a list of values that can be used with this keyword, see <olink targetdoc="solinstalladv" targetptr="preparecustom-94" remap="external"><citetitle remap="section">package Profile Keyword</citetitle> in <citetitle remap="book">Solaris Express Installation Guide: Custom JumpStart and Advanced Installations</citetitle></olink>.</para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable><para>The following table lists the keywords you can use with the <literal>Install_type</literal> keyword value <literal>flash_update</literal>.</para><informaltable frame="topbot" pgwide="100" id="luupgrade-tbl-11670"><tgroup cols="3" colsep="0" rowsep="0"><colspec colname="colspec4" colwidth="42.49*"/><colspec colname="colspec5" colwidth="79.18*"/><colspec colname="colspec2" colwidth="56.33*"/><thead><row rowsep="1"><entry><para>Keywords for a Differential Archive Creation</para>
</entry><entry><para>Description</para>
</entry><entry><para>Reference</para>
</entry>
</row>
</thead><tbody><row><entry><para>(Required) <literal>Install_type</literal></para>
</entry><entry><para>Defines the installation to install a Solaris Flash archive on
the system. The value for a differential archive is <literal>flash_update</literal>. </para>
</entry><entry><para>For a description of all the values for this keyword, see <olink targetdoc="solinstalladv" targetptr="preparecustom-90" remap="external"><citetitle remap="section">install_type Profile Keyword</citetitle> in <citetitle remap="book">Solaris Express Installation Guide: Custom JumpStart and Advanced Installations</citetitle></olink>.</para>
</entry>
</row><row><entry><para>(Required) <literal>archive_location</literal></para>
</entry><entry><para>Retrieves a Solaris Flash archive from a designated location. </para>
</entry><entry><para>For a list of values that can be used with this keyword, see <olink targetdoc="solinstalladv" targetptr="preparecustom-2" remap="external"><citetitle remap="section">archive_location Keyword</citetitle> in <citetitle remap="book">Solaris Express Installation Guide: Custom JumpStart and Advanced Installations</citetitle></olink>.</para>
</entry>
</row><row><entry><para>(Optional) <literal>forced_deployment</literal></para>
</entry><entry><para>Forces the installation
of a Solaris Flash differential archive onto a clone system that is different
than the software expects. If you use <literal>forced_deployment</literal>,
all new files are deleted to bring the clone system to the expected state.
If you are not certain that you want files to be deleted, use the default,
which protects new files by stopping the installation. </para>
</entry><entry><para>For more information about this keyword, see <olink targetdoc="solinstalladv" targetptr="jumpstartreference-702" remap="external"><citetitle remap="section">forced_deployment Profile Keyword (Installing Solaris Flash Differential Archives)</citetitle> in <citetitle remap="book">Solaris Express Installation Guide: Custom JumpStart and Advanced Installations</citetitle></olink>.</para>
</entry>
</row><row><entry><para>(Optional) <literal>local_customization</literal></para>
</entry><entry><para>Before
you install a Solaris Flash archive on a clone system, you can create
custom scripts to preserve local configurations on the clone system. The <literal>local_customization</literal> keyword designates the directory where you have
stored these scripts. The value is the path to the script on the clone system. </para>
</entry><entry><para>For information about predeployment and postdeployment scripts, see <olink targetdoc="solinstallflash" targetptr="flashcreate-65" remap="external"><citetitle remap="section">Creating Customization Scripts</citetitle> in <citetitle remap="book">Solaris Express Installation Guide: Solaris Flash Archives (Creation and Installation)</citetitle></olink>.</para>
</entry>
</row><row><entry><para>(Optional) <literal>no_content_check</literal></para>
</entry><entry><para>When installing a clone system with a Solaris Flash differential
archive, you can use the <literal>no_content_check</literal> keyword to ignore
file-by-file validation. File-by-file validation ensures that the clone system
is a duplicate of the master system. Avoid using this keyword unless you are
sure the clone system is a duplicate of the original master system.</para>
</entry><entry><para>For more information about this keyword, see <olink targetdoc="solinstalladv" targetptr="jumpstartreference-703" remap="external"><citetitle remap="section">no_content_check Profile Keyword (Installing Solaris Flash Archives)</citetitle> in <citetitle remap="book">Solaris Express Installation Guide: Custom JumpStart and Advanced Installations</citetitle></olink>.</para>
</entry>
</row><row><entry><para>(Optional) <literal>no_master_check</literal></para>
</entry><entry><para>When installing a clone system with a Solaris Flash differential
archive, you can use the <literal>no_master_check</literal> keyword to ignore
a check of files. Clone system files are not checked. A check would ensure
the clone was built from the original master system. Avoid using this keyword
unless you are sure the clone system is a duplicate of the original master
system.</para>
</entry><entry><para>For more information about this keyword, see <olink targetdoc="solinstalladv" targetptr="jumpstartreference-704" remap="external"><citetitle remap="section">no_master_check Profile Keyword (Installing Solaris Flash Archives)</citetitle> in <citetitle remap="book">Solaris Express Installation Guide: Custom JumpStart and Advanced Installations</citetitle></olink>.</para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable>
</step><step><para>Save the profile in a directory on the local system.</para>
</step><step><para>Ensure that <literal>root</literal> owns the profile and that
the permissions are set to 644.</para>
</step><step><para>Test the profile (optional).</para><para>For a procedure to test
the profile, see <olink targetptr="luupgrade-1162" remap="internal">To Test a Profile to Be
Used by Solaris Live Upgrade</olink>.</para>
</step>
</procedure><example id="preparecustom-ex-98"><title>Creating a Solaris Live Upgrade Profile</title><para>In this example, a profile provides the upgrade parameters. This
profile is to be used to upgrade an inactive boot environment with the Solaris
Live Upgrade <command>luupgrade</command> command and the <option>u</option> and <option>j</option> options. This profile adds a package and a cluster. A regional
locale and additional locales are also added to the profile. If you add locales
to the profile, make sure that you have created a boot environment with additional
disk space. </para><programlisting role="complete"># profile keywords         profile values
# ----------------         -------------------
  install_type             upgrade
  package                  SUNWxwman add
  cluster                  SUNWCacc add
  geo                      C_Europe
  locale                   zh_TW
  locale                   zh_TW.BIG5
  locale                   zh_TW.UTF-8
  locale                   zh_HK.UTF-8
  locale                   zh_HK.BIG5HK
  locale                   zh
  locale                   zh_CN.GB18030
  locale                   zh_CN.GBK
  locale                   zh_CN.UTF-8</programlisting>
</example><example id="chapter-ex-2"><title>Creating a Solaris Live Upgrade Profile to Install a Differential Archive</title><para>The following example of a profile is to be
used by Solaris Live Upgrade to install a differential archive on a clone
system. Only files that are specified by the differential archive are added,
deleted, or changed. The Solaris Flash archive is retrieved from an NFS server.
 Because the image was built by the original master system, the clone system
is not checked for a valid system image. This profile is to be used with the
Solaris Live Upgrade <command>luupgrade</command> command and the <option>u</option> and <option>j</option> options.</para><programlisting width="80100"># profile keywords         profile values
# ----------------         -------------------
 install_type              flash_update
 archive_location          nfs installserver:/export/solaris/archive/solarisarchive
 no_master_check</programlisting><para>To use the <command>luupgrade</command> command to install the differential
archive, see <olink targetptr="luupgrade1-8800" remap="internal">To Install a Solaris Flash
Archive With a Profile</olink>.</para>
</example>
</task><task id="luupgrade-1162"><title>To Test a Profile to Be Used by Solaris Live
Upgrade</title><tasksummary><para>After you create a profile, use the <command>luupgrade</command> command
to test the profile. By looking at the installation output that is generated
by <command>luupgrade</command>, you can quickly determine if a profile works
as you intended. </para>
</tasksummary><procedure>&suStepA;<step id="luupgrade-step-1164"><para>Test the profile.</para><screen># <userinput>luupgrade -u -n <replaceable>BE_name</replaceable> -D -s <replaceable>os_image_path</replaceable> -j <replaceable>profile_path</replaceable></userinput></screen><variablelist><varlistentry><term><option>u</option></term><listitem><para>Upgrades an operating system image on a boot environment.</para>
</listitem>
</varlistentry><varlistentry><term><option>n</option> <replaceable>BE_name</replaceable></term><listitem><para>Specifies the name of the boot environment that is to be upgraded.</para>
</listitem>
</varlistentry><varlistentry><term><option>D</option></term><listitem><para><command>luupgrade</command> command uses the selected boot
environment's disk configuration to test the profile options that are passed
with the <option>j</option> option.</para>
</listitem>
</varlistentry><varlistentry><term><option>s</option> <replaceable>os_image_path</replaceable></term><listitem><para>Specifies the path name of a directory that contains an operating
system image. This directory can be on an installation medium, such as a DVD-ROM,
CD-ROM, or it can be an NFS or UFS directory.</para>
</listitem>
</varlistentry><varlistentry><term><option>j</option> <replaceable>profile_path</replaceable></term><listitem><para>Path to a profile that is configured for an upgrade. The profile
must be in a directory on the local machine.</para>
</listitem>
</varlistentry>
</variablelist>
</step>
</procedure><example id="luupgrade-ex-1165"><title>Testing a Profile by Using Solaris Live Upgrade</title><para>In the following example, the profile is named <filename>Flash_profile</filename>. The profile is successfully tested on the inactive boot environment
that is named <literal>second_disk</literal>. </para><screen width="80100"># <userinput>luupgrade -u -n u1b08 -D -s /net/installsvr/export/u1/combined.u1wos \</userinput>
 <userinput>-j /var/tmp/flash_profile</userinput>
Validating the contents of the media /net/installsvr/export/u1/combined.u1wos.
The media is a standard Solaris media.
The media contains an operating system upgrade image.
The media contains Solaris version 10.
Locating upgrade profile template to use.
Locating the operating system upgrade program.
Checking for existence of previously scheduled Live Upgrade requests.
Creating upgrade profile for BE <literal>second_disk</literal>.
Determining packages to install or upgrade for BE <literal>second_disk</literal>.
Simulating the operating system upgrade of the BE <literal>second_disk</literal>.
The operating system upgrade simulation is complete.
INFORMATION: var/sadm/system/data/upgrade_cleanup contains a log of the
upgrade operation.
INFORMATION: var/sadm/system/data/upgrade_cleanup contains a log of
cleanup operations required.
The Solaris upgrade of the boot environment <literal>second_disk</literal> is complete.</screen><para>You can now use the profile to upgrade an inactive boot environment.</para>
</example>
</task><task id="luupgrade-8800"><title>To Upgrade With a Profile by Using Solaris
Live Upgrade</title><tasksummary><para>This procedure provides step-by-step instructions for upgrading an OS
by using a profile.</para><para>If you want to install a Solaris Flash archive by using a profile,
see <olink targetptr="luupgrade1-8800" remap="internal">To Install a Solaris Flash Archive
With a Profile</olink>.</para><para>If you added locales to the profile, make sure that you have created
a boot environment with additional disk space.</para><caution><para>When you install the Solaris OS with a Solaris Flash archive,
the archive and the installation media must contain identical OS versions.
For example, if the archive is the Solaris 10 operating system and you are
using DVD media, then you must use Solaris 10 DVD media to install the archive.
If the OS versions do not match, the installation on the target system fails.
Identical operating systems are necessary when you use the following keyword
or command:</para><itemizedlist><listitem><para><literal>archive_location</literal> keyword in a profile</para>
</listitem><listitem><para><command>luupgrade</command> command with <option>s</option>, <option>a</option>, <option>j</option>, and <option>J</option> options</para>
</listitem>
</itemizedlist>
</caution>
</tasksummary><procedure><step><para>Install the Solaris Live Upgrade <literal>SUNWlucfg</literal>, <literal>SUNWlur</literal>, and <literal>SUNWluu</literal> packages on your system.
These packages must be from the release you are upgrading to. For step-by-step
procedures, see <olink targetptr="lucreate-3" remap="internal">To Install Solaris Live Upgrade
With the pkgadd Command</olink>.</para>
</step>&suStepA;<step id="luupgrade3-step-1161"><para>Create a profile. </para><para>See <olink targetptr="preparecustom-9700" remap="internal">To Create a Profile to be Used by Solaris Live
Upgrade</olink> for a list of upgrade keywords that can be used in a Solaris
Live Upgrade profile. </para>
</step><step id="luupgrade2-step-1080"><para>Type:</para><screen># <userinput>luupgrade -u -n <replaceable>BE_name</replaceable> -s <replaceable>os_image_path</replaceable> -j <replaceable>profile_path</replaceable></userinput></screen><variablelist><varlistentry><term><option>u</option></term><listitem><para>Upgrades an operating system image on a boot environment.</para>
</listitem>
</varlistentry><varlistentry><term><option>n</option> <replaceable>BE_name</replaceable></term><listitem><para>Specifies the name of the boot environment that is to be upgraded.</para>
</listitem>
</varlistentry><varlistentry><term><option>s</option> <replaceable>os_image_path</replaceable></term><listitem><para>Specifies the path name of a directory that contains an operating
system image. This directory can be on an installation medium, such as a DVD-ROM,
CD-ROM, or it can be an NFS or UFS directory.</para>
</listitem>
</varlistentry><varlistentry><term><option>j</option> <replaceable>profile_path</replaceable></term><listitem><para>Path to a profile. The profile must be in a directory on the
local machine. For information about creating a profile, see <olink targetptr="preparecustom-9700" remap="internal">To Create a Profile to be Used by Solaris Live
Upgrade</olink>.</para>
</listitem>
</varlistentry>
</variablelist>
</step>
</procedure><example id="luupgrade2-ex-970"><title>Upgrading a Boot Environment by Using a Custom JumpStart Profile</title><para>In this example, the <literal>second_disk</literal> boot environment
is upgraded by using a profile. The <option>j</option> option is used to access
the profile. The boot environment is then ready to be activated. To create
a profile, see <olink targetptr="preparecustom-9700" remap="internal">To Create a Profile to
be Used by Solaris Live Upgrade</olink>. The <command>pkgadd</command> command
adds the Solaris Live Upgrade packages from the release you are upgrading
to.</para><screen># <userinput>pkgadd -d /server/packages SUNWlucfg SUNWlur SUNWluu</userinput>
# <userinput>luupgrade -u -n second_disk \ 
-s /net/installmachine/export/solarisX/OS_image \ 
-j /var/tmp/profile</userinput> </screen><para>The boot environment is ready to be activated. See <olink targetptr="luupgrade-84" remap="internal">Activating a Boot Environment</olink>.</para>
</example>
</task>
</sect2>
</sect1><sect1 id="luupgrade-83"><title>Installing Solaris Flash Archives on
a Boot Environment</title><para>This section provides the procedure
for using Solaris Live Upgrade to install Solaris Flash archives. Installing
a Solaris Flash archive overwrites all files on the new boot environment
except for shared files. Archives are stored on the following media:</para><itemizedlist><listitem><para>HTTP server</para>
</listitem><listitem><para>FTP server &ndash; Use this path from the command line only</para>
</listitem><listitem><para>NFS server</para>
</listitem><listitem><para>Local file</para>
</listitem><listitem><para>Local tape</para>
</listitem><listitem><para>Local device, including DVD or CD</para>
</listitem>
</itemizedlist><para>Note the following issues with installing and creating a Solaris Flash archive.</para><informaltable frame="topbot"><tgroup cols="2" colsep="0" rowsep="0"><colspec colwidth="50*"/><colspec colwidth="50*"/><thead><row rowsep="1"><entry><para>Description</para>
</entry><entry><para>Example</para>
</entry>
</row>
</thead><tbody><row><entry rowsep="1"><caution><para>When you install the Solaris OS with a Solaris Flash archive,
the archive and the installation media must contain identical OS versions.
 If the OS versions do not match, the installation on the target system fails.
Identical operating systems are necessary when you use the following keyword
or command: </para><itemizedlist><listitem><para><literal>archive_location</literal> keyword in a profile</para>
</listitem><listitem><para><command>luupgrade</command> command with <option>s</option>, <option>a</option>, <option>j</option>, and <option>J</option> options</para>
</listitem>
</itemizedlist>
</caution>
</entry><entry rowsep="1"><para>For example, if the archive is the Solaris 10 operating system and you
are using DVD media, then you must use Solaris 10 DVD media to install the
archive. </para>
</entry>
</row><row><entry><caution><para>A Solaris Flash archive cannot be properly created when
a non-global zone is installed. The Solaris Flash feature is not compatible
 with the Solaris Zones feature. If you create a Solaris Flash archive in
a non-global zone or create an archive  in a global zone that has non-global
zones installed, the resulting  archive does not install properly when the
archive is deployed.</para>
</caution>
</entry><entry>
</entry>
</row>
</tbody>
</tgroup>
</informaltable><informaltable frame="topbot"><tgroup cols="2" colsep="0" rowsep="0"><colspec colwidth="50*"/><colspec colwidth="50*"/><thead><row><entry rowsep="1"><para>Description</para>
</entry><entry rowsep="1" valign="top"><para>For More Information</para>
</entry>
</row>
</thead><tbody><row><entry><para>For examples of the correct syntax for paths that are associated with
archive storage.</para>
</entry><entry><para>See <olink targetdoc="solinstalladv" targetptr="preparecustom-2" remap="external"><citetitle remap="section">archive_location Keyword</citetitle> in <citetitle remap="book">Solaris Express Installation Guide: Custom JumpStart and Advanced Installations</citetitle></olink>.</para>
</entry>
</row><row><entry><para>To use the Solaris Flash installation feature,  you install a master
system and create the Solaris Flash archive. </para>
</entry><entry><para>For more information about creating an archive, see <olink targetdoc="solinstallflash" targetptr="flashcreate-1" remap="external">Chapter 3, <citetitle remap="chapter">Creating Solaris Flash Archives (Tasks),</citetitle> in <citetitle remap="book">Solaris Express Installation Guide: Solaris Flash Archives (Creation and Installation)</citetitle></olink>.</para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable><task id="luupgrade-88"><title>To Install a Solaris Flash Archive on
a Boot Environment</title><procedure><step><para>Install the Solaris Live Upgrade <literal>SUNWlucfg</literal>, <literal>SUNWlur</literal>, and <literal>SUNWluu</literal> packages on your system.
These packages must be from the release you are upgrading to. For step-by-step
procedures, see <olink targetptr="lucreate-3" remap="internal">To Install Solaris Live Upgrade
With the pkgadd Command</olink>.</para>
</step>&suStepA;<step id="luupgrade-step-108"><para>Type:</para><screen># <userinput>luupgrade -f -n <replaceable>BE_name</replaceable> -s <replaceable>os_image_path</replaceable> -a <replaceable>archive</replaceable></userinput></screen><variablelist><varlistentry><term><option>f</option></term><listitem><para>Indicates to install an operating system from a Solaris Flash archive.</para>
</listitem>
</varlistentry><varlistentry><term><option>n</option> <replaceable>BE_name</replaceable></term><listitem><para>Specifies the name of the boot environment that is to be installed
with an archive.</para>
</listitem>
</varlistentry><varlistentry><term><option>s</option> <replaceable>os_image_path</replaceable></term><listitem><para>Specifies the path name of a directory that contains an operating
system image. This directory can be on an installation medium, such as a DVD-ROM,
CD-ROM, or it can be an NFS or UFS directory.</para>
</listitem>
</varlistentry><varlistentry><term><option>a</option> <replaceable>archive</replaceable></term><listitem><para>Path to the Solaris Flash archive when the archive is
available on the local file system. The operating system image versions that
are specified with the <option>s</option> option and the <option>a</option> option
must be identical.</para>
</listitem>
</varlistentry>
</variablelist>
</step>
</procedure><example id="luupgrade-ex-97"><title>Installing Solaris Flash Archives on a Boot Environment</title><para>In this example, an archive is installed on the <literal>second_disk</literal> boot
environment. The archive is located on the local system. The operating system
versions for the <option>s</option> and <option>a</option> options are both
Solaris Express 5/07 releases. All files are overwritten on <literal>second_disk</literal> except shareable files. The <command>pkgadd</command> command adds
the Solaris Live upgrade packages from the release you are upgrading to.</para><screen># <userinput>pkgadd -d /server/packages SUNWlucfg SUNWlur SUNWluu</userinput>
# <userinput>luupgrade -f -n second_disk \ 
-s /net/installmachine/export/Solaris_11/OS_image \ 
-a /net/server/archive/11</userinput> </screen><para>The boot environment is ready to be activated. See <olink targetptr="luupgrade-84" remap="internal">Activating a Boot Environment</olink>.</para>
</example>
</task><task id="luupgrade1-8800"><title>To Install a Solaris Flash Archive
With a Profile</title><tasksummary><para>This procedure provides the steps to install a Solaris Flash archive
or differential archive by using a profile. </para><para>If you added locales to the profile, make sure that you have created
a boot environment with additional disk space.</para>
</tasksummary><procedure><step><para>Install the Solaris Live Upgrade <literal>SUNWlucfg</literal>, <literal>SUNWlur</literal>, and <literal>SUNWluu</literal> packages on your system.
These packages must be from the release you are upgrading to. For step-by-step
procedures, see <olink targetptr="lucreate-3" remap="internal">To Install Solaris Live Upgrade
With the pkgadd Command</olink>.</para>
</step>&suStepA;<step id="luupgrade2-step-1161"><para>Create a profile. </para><para>See <olink targetptr="preparecustom-9700" remap="internal">To Create a Profile to be Used by Solaris Live
Upgrade</olink> for a list of keywords that can be used in a Solaris Live
Upgrade profile. </para>
</step><step id="luupgrade3-step-1080"><para>Type:</para><screen># <userinput>luupgrade -f -n <replaceable>BE_name</replaceable> -s <replaceable>os_image_path</replaceable> -j <replaceable>profile_path</replaceable></userinput></screen><variablelist><varlistentry><term><option>f</option></term><listitem><para>Indicates to install an operating system from a Solaris Flash archive.</para>
</listitem>
</varlistentry><varlistentry><term><option>n</option> <replaceable>BE_name</replaceable></term><listitem><para>Specifies the name of the boot environment that is to be upgraded.</para>
</listitem>
</varlistentry><varlistentry><term><option>s</option> <replaceable>os_image_path</replaceable></term><listitem><para>Specifies the path name of a directory that contains an operating
system image. This directory can be on an installation medium, such as a DVD-ROM,
CD-ROM, or it can be an NFS or UFS directory.</para>
</listitem>
</varlistentry><varlistentry><term><option>j</option> <replaceable>profile_path</replaceable></term><listitem><para>Path to a JumpStart profile that is configured for a flash
installation. The profile must be in a directory on the local machine. The <option>s</option> option's operating system version and the Solaris Flash archive
operating system version must be identical. </para>
</listitem>
</varlistentry>
</variablelist><para>The boot environment is ready to be activated.  See <olink targetptr="luupgrade-84" remap="internal">Activating a Boot Environment</olink>.</para>
</step>
</procedure><example id="luupgrade3-ex-970"><title>Install a Solaris Flash archive on a Boot Environment With a Profile</title><para>In this example, a profile provides the location of the archive to be
installed. </para><programlisting remap="wide" width="80100"># profile keywords         profile values
# ----------------         -------------------
 install_type              flash_install
 archive_location          nfs installserver:/export/solaris/flasharchive/solarisarchive
 </programlisting><para>After creating the profile, you can run the <command>luupgrade</command> command
and install the archive. The <option>j</option> option is used to access the
profile. The <command>pkgadd</command> command adds the Solaris Live Upgrade
packages from the release you are upgrading to.</para><screen># <userinput>pkgadd -d /server/packages SUNWlucfg SUNWlur SUNWluu</userinput>
# <userinput>luupgrade -f -n second_disk \ 
-s /net/installmachine/export/solarisX/OS_image \ 
-j /var/tmp/profile</userinput> </screen><para>The boot environment is then ready to be activated.  See <olink targetptr="luupgrade-84" remap="internal">Activating a Boot Environment</olink>.</para><para>To create a profile, see <olink targetptr="preparecustom-9700" remap="internal">To Create
a Profile to be Used by Solaris Live Upgrade</olink>.</para>
</example>
</task><task id="luupgrade-880"><title>To Install a Solaris Flash Archive With
a Profile Keyword</title><tasksummary><para>This procedure enables you to install
a Solaris Flash archive and use the <literal>archive_location</literal> keyword
at the command line rather than from a profile file. You can quickly retrieve
an archive without the use of a profile file. </para>
</tasksummary><procedure><step><para>Install the Solaris Live Upgrade <literal>SUNWlucfg</literal>, <literal>SUNWlur</literal>, and <literal>SUNWluu</literal> packages on your system.
These packages must be from the release you are upgrading to. For step-by-step
procedures, see <olink targetptr="lucreate-3" remap="internal">To Install Solaris Live Upgrade
With the pkgadd Command</olink>.</para>
</step>&suStepA;<step id="luupgrade-step-1080"><para>Type:</para><screen># <userinput>luupgrade -f -n <replaceable>BE_name</replaceable> -s <replaceable>os_image_path</replaceable> -J 'archive_location <replaceable>path-to-profile'</replaceable></userinput></screen><variablelist><varlistentry><term><option>f</option></term><listitem><para>Specifies to upgrade an operating system from a Solaris Flash archive.</para>
</listitem>
</varlistentry><varlistentry><term><option>n</option> <replaceable>BE_name</replaceable></term><listitem><para>Specifies the name of the boot environment that is to be upgraded.</para>
</listitem>
</varlistentry><varlistentry><term><option>s</option> <replaceable>os_image_path</replaceable></term><listitem><para>Specifies the path name of a directory that contains an operating
system image. This directory can be on an installation medium, such as a DVD-ROM,
CD-ROM, or it can be an NFS or UFS directory.</para>
</listitem>
</varlistentry><varlistentry><term><option>J</option> 'archive_location <replaceable>path-to-profile'</replaceable></term><listitem><para>Specifies the <literal>archive_location</literal> profile
keyword and the path to the JumpStart profile. The <option>s</option> option's
operating system version and the Solaris Flash archive operating system
version must be identical.  For the keyword values, see <olink targetdoc="solinstalladv" targetptr="preparecustom-2" remap="external"><citetitle remap="section">archive_location Keyword</citetitle> in <citetitle remap="book">Solaris Express Installation Guide: Custom JumpStart and Advanced Installations</citetitle></olink>. </para>
</listitem>
</varlistentry>
</variablelist><para>The boot environment is ready to be activated.  See <olink targetptr="luupgrade-84" remap="internal">Activating a Boot Environment</olink>.</para>
</step>
</procedure><example id="luupgrade-ex-970"><title>Installing a Solaris Flash Archive By Using a Profile Keyword</title><para>In this example, an archive is installed on the <literal>second_disk</literal> boot
environment. The <option>J</option> option and the <literal>archive_location</literal> keywords
are used to retrieve the archive. All files are overwritten on <literal>second_disk</literal> except shareable files. The <command>pkgadd</command> command adds
the Solaris Live Upgrade packages from the release you are upgrading to.</para><screen># <userinput>pkgadd -d /server/packages SUNWlucfg SUNWlur SUNWluu</userinput>
# <userinput>luupgrade -f -n second_disk \ 
-s /net/installmachine/export/solarisX/OS_image \ 
-J 'archive_location http://example.com/myflash.flar'</userinput> </screen>
</example>
</task>
</sect1><sect1 id="luupgrade-84"><title>Activating a Boot Environment</title><para>Activating a boot environment makes it bootable on
the next reboot of the system. You can also switch back quickly to the original
boot environment if a failure occurs on booting the newly active boot environment.
See <olink targetptr="luupgrade-85" remap="internal">Chapter&nbsp;6, Failure Recovery: Falling
Back to the Original Boot Environment (Tasks)</olink>.</para><informaltable frame="topbot"><tgroup cols="2" colsep="0" rowsep="0"><colspec colwidth="50*"/><colspec colwidth="50*"/><thead><row><entry rowsep="1" valign="top"><para>Description</para>
</entry><entry rowsep="1" valign="top"><para>For More Information</para>
</entry>
</row>
</thead><tbody><row><entry rowsep="1"><para>Use this procedure to activate a boot environment with the <command>luactivate</command> command. </para><note><para>The first time you activate a boot environment, the <command>luactivate</command> command must be used.</para>
</note>
</entry><entry rowsep="1"><para><olink targetptr="luupgrade-89" remap="internal">To Activate a Boot Environment</olink></para>
</entry>
</row><row><entry rowsep="1"><para>Use this procedure to activate a boot environment and force a synchronization
of files. </para><note><para>Files are synchronized with the first activation. If you switch
boot environments after the first activation, files are not synchronized.</para>
</note>
</entry><entry rowsep="1"><para><olink targetptr="luupgrade-890" remap="internal">To Activate a Boot Environment and
Synchronize Files</olink></para>
</entry>
</row><row><entry><para><emphasis role="strong">x86</emphasis>: Use this procedure to activate
a boot environment with the GRUB menu.</para><note><para>A GRUB menu can facilitate switching from one boot environment
to another. A boot environment appears in the GRUB menu after the first activation.</para>
</note>
</entry><entry><para><olink targetptr="gacps" remap="internal">To Activate a Boot Environment With the GRUB
Menu</olink></para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable><sect2><title>Requirements and Limitations for Activating a Boot Environment</title><para>To successfully activate a boot environment, that boot environment must
meet the following conditions:</para><informaltable frame="topbot"><tgroup cols="2" colsep="0" rowsep="0"><colspec colname="colspec0" colwidth="50*"/><colspec colname="colspec1" colwidth="50*"/><thead><row><entry rowsep="1"><para>Description</para>
</entry><entry rowsep="1" valign="top"><para>For More Information</para>
</entry>
</row>
</thead><tbody><row><entry rowsep="1"><para>The boot environment must have a status of &ldquo;complete.&rdquo; </para>
</entry><entry rowsep="1"><para>To check status, see <olink targetptr="lumaintenance-33" remap="internal">Displaying
the Status of All Boot Environments</olink></para>
</entry>
</row><row><entry rowsep="1"><para>If the boot environment is not the current boot environment, you cannot
have mounted the partitions of that boot environment by using the <command>luumount</command> or <command>mount</command> commands.</para>
</entry><entry rowsep="1"><para>To view man pages, see <olink targetdoc="refman1m" targetptr="lumount-1m" remap="external"><citerefentry><refentrytitle>lumount</refentrytitle><manvolnum>1M</manvolnum></citerefentry></olink> or <olink targetdoc="refman1m" targetptr="mount-1m" remap="external"><citerefentry><refentrytitle>mount</refentrytitle><manvolnum>1M</manvolnum></citerefentry></olink></para>
</entry>
</row><row><entry rowsep="1"><para>The boot environment that you want to activate cannot be involved in
a comparison operation. </para>
</entry><entry rowsep="1"><para>For procedures, see <olink targetptr="lumaintenance-27" remap="internal">Comparing Boot
Environments</olink></para>
</entry>
</row><row><entry><para>If you want to reconfigure swap, make this change prior to booting the
inactive boot environment. By default, all boot environments share the same
swap devices. </para>
</entry><entry><para>To reconfigure swap, see <olink targetptr="lucreate-13" remap="internal">To Create a
Boot Environment and Reconfiguring Swap</olink></para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable><note arch="x86"><para>If you have an x86 based system, you can also activate
with the GRUB menu. Note the following exceptions:</para><itemizedlist><listitem><para>If a boot environment was created with the <emphasis role="strong">Solaris 8, 9, or 10 3/05 release</emphasis>, the boot environment
must always be activated with the <command>luactivate</command> command. These
older boot environments do not display on the GRUB menu.</para>
</listitem><listitem><para>The first time you activate a boot environment, you must use
the <command>luactivate</command> command. The next time you boot, that boot
environment's name is displayed in the GRUB main menu. You can thereafter
switch to this boot environment by selecting the appropriate entry in the
GRUB menu.</para>
</listitem>
</itemizedlist><para>See <olink targetptr="gamog" remap="internal">Activating a Boot Environment With the
GRUB Menu</olink>.</para>
</note>
</sect2><task id="luupgrade-89"><title>To Activate a Boot Environment</title><tasksummary><para>The following procedure switches a new boot environment to become the
currently running boot environment.</para><note arch="x86"><para>If you have an x86 based system, you can also activate
with the GRUB menu. Note the following exceptions:</para><itemizedlist><listitem><para>If a boot environment was created with the <emphasis role="strong">Solaris 8, 9, or 10 3/05 release</emphasis>, the boot environment
must always be activated with the <command>luactivate</command> command. These
older boot environments do not display on the GRUB menu.</para>
</listitem><listitem><para>The first time you activate a boot environment, you must use
the <command>luactivate</command> command. The next time you boot, that boot
environment's name is displayed in the GRUB main menu. You can thereafter
switch to this boot environment by selecting the appropriate entry in the
GRUB menu.</para>
</listitem>
</itemizedlist><para>See <olink targetptr="gamog" remap="internal">Activating a Boot Environment With the
GRUB Menu</olink>.</para>
</note>
</tasksummary><procedure>&suStepA;<step id="luupgrade-step-110"><para>To activate the boot environment, type:</para><screen># <userinput>/sbin/luactivate  <replaceable>BE_name</replaceable></userinput></screen><variablelist><varlistentry><term><replaceable>BE_name</replaceable></term><listitem><para>Specifies the name of the boot environment that is to be activated</para>
</listitem>
</varlistentry>
</variablelist>
</step><step id="luupgrade-step-50"><para>Reboot.</para><screen># <userinput>init 6</userinput></screen><caution><para>Use only the <command>init</command> or <command>shutdown</command> commands
to reboot. If you use the <command>reboot</command>, <command>halt</command>,
or <command>uadmin</command> commands, the system does not switch boot environments.
The last-active boot environment is booted again.</para>
</caution>
</step>
</procedure><example id="luupgrade-ex-95"><title>Activating a Boot Environment</title><para>In this example, the <literal>second_disk</literal> boot environment
is activated at the next reboot.</para><screen># <userinput>/sbin/luactivate second_disk</userinput>
# <userinput>init 6</userinput></screen>
</example>
</task><task id="luupgrade-890"><title>To Activate a Boot Environment and Synchronize
Files</title><tasksummary><para>The first time you boot from a newly created boot environment, Solaris
Live Upgrade software synchronizes the new boot environment with the boot
environment that was last active. &ldquo;Synchronize&rdquo; means that certain
critical system files and directories are copied from the last-active boot
environment to the boot environment being booted. Solaris Live Upgrade does
not perform this synchronization after the initial boot, unless you force
synchronization with the <command>luactivate</command> command and the <option>s</option> option.</para><note arch="x86"><para>When you switch between boot environments with the
GRUB menu, files also are not synchronized. You must use the following procedure
to synchronize files.</para>
</note><para>For more information about synchronization, see <olink targetptr="luplanning-10" remap="internal">Synchronizing Files Between Boot Environments</olink>.</para>
</tasksummary><procedure>&suStepA;<step id="luupgrade-step-111"><para>To activate the boot environment, type:</para><screen># <userinput>/sbin/luactivate  -s <replaceable>BE_name</replaceable></userinput></screen><variablelist><varlistentry><term><option>s</option></term><listitem><para>Forces a synchronization of files between the last-active
boot environment and the new boot environment. The first time that a boot
environment is activated, the files between the boot environment are synchronized
With subsequent activations, the files are not synchronized unless you use
the <option>s</option> option.</para><caution><para>Use this option with great care, because you  might not  be
aware of or in control of changes that might have occurred in the last-active
 boot environment. For example, if you were running Solaris Express 5/07 software
on your current boot environment and booted back to a Solaris 9 release with
a forced synchronization, files could be changed on the Solaris 9 release.
Because files are dependent on the release of the OS, the boot to the Solaris
9 release could fail because the Solaris Express 5/07 files might not
be compatible with the Solaris 9 files.</para>
</caution>
</listitem>
</varlistentry><varlistentry><term><replaceable>BE_name</replaceable></term><listitem><para>Specifies the name of the boot environment that is to be activated.</para>
</listitem>
</varlistentry>
</variablelist>
</step><step id="luupgrade-step-500"><para>Reboot.</para><screen># <userinput>init 6</userinput></screen>
</step>
</procedure><example id="luupgrade-ex-950"><title>Activating a Boot Environment</title><para>In this example, the <literal>second_disk</literal> boot environment
is activated at the next reboot and the files are synchronized.</para><screen># <userinput>/sbin/luactivate -s second_disk</userinput>
# <userinput>init 6</userinput></screen>
</example>
</task><sect2 id="gamog" arch="x86"><title>Activating a Boot Environment With the
GRUB Menu</title><para>A GRUB menu provides an optional method of switching between boot environments.
The GRUB menu is an alternative to activating (booting) with the <command>luactivate</command> command. The table below notes cautions and limitations when using
the GRUB menu.</para><table frame="topbot" pgwide="100" id="gabrl" arch="x86"><title>Activating
With the GRUB Menu Summary</title><tgroup cols="3" colsep="0" rowsep="0"><colspec colwidth="18.95*"/><colspec colwidth="48.98*"/><colspec colwidth="31.07*"/><thead><row rowsep="1"><entry><para>Task</para>
</entry><entry><para>Description</para>
</entry><entry><para>For More Information</para>
</entry>
</row>
</thead><tbody><row><entry><para><emphasis role="strong">Caution</emphasis></para>
</entry><entry><para>After you have activated a boot environment, do not change the disk
order in the BIOS. Changing the order might cause the GRUB menu to become
invalid. If this problem occurs, changing the disk order back to the original
state fixes the GRUB menu.</para>
</entry><entry>
</entry>
</row><row><entry><para>Activating a boot environment for the first time</para>
</entry><entry><para>The first time you activate a boot environment, you must use the <command>luactivate</command> command. The next time you boot, that boot environment's name is
displayed in the GRUB main menu. You can thereafter switch to this boot environment
by selecting the appropriate entry in the GRUB menu.</para>
</entry><entry><para><olink targetptr="luupgrade-89" remap="internal">To Activate a Boot Environment</olink></para>
</entry>
</row><row><entry><para>Synchronizing files</para>
</entry><entry><para>The first time you activate a boot environment, files are synchronized
between the current boot environment and the new boot environment. With subsequent
activations, files are not synchronized. When you switch between boot environments
with the GRUB menu, files also are not synchronized. You can force a synchronization
when using the <command>luactivate</command> command with the <option>s</option> option.</para>
</entry><entry><para><olink targetptr="luupgrade-890" remap="internal">To Activate a Boot Environment and
Synchronize Files</olink></para>
</entry>
</row><row><entry><para>Boot environments created before the <emphasis role="strong">Solaris
10 1/06 release</emphasis></para>
</entry><entry><para>If a boot environment was created with the <emphasis role="strong">Solaris
8, 9, or 10 3/05 release</emphasis>, the boot environment must always be activated
with the <command>luactivate</command> command. These older boot environments
do not display on the GRUB menu.</para>
</entry><entry><para><olink targetptr="luupgrade-89" remap="internal">To Activate a Boot Environment</olink></para>
</entry>
</row><row><entry><para>Editing or customizing the GRUB menu entries</para>
</entry><entry><para>The <filename>menu.lst</filename> file contains the information that
is displayed in the GRUB menu. You can revise this file for the following
reasons:</para><itemizedlist><listitem><para>To add to the GRUB menu entries for operating systems other
than the Solaris OS. </para>
</listitem><listitem><para>To customize booting behavior. For example, you could change
booting to verbose mode or change the default time that automatically boots
the OS.</para>
</listitem>
</itemizedlist><note><para>If you want to change the GRUB menu, you need to locate the <filename>menu.lst</filename> file. For step-by-step instructions, see <olink targetptr="gbdfr" remap="internal">Locating the GRUB Menu's menu.lst File (Tasks)</olink>.</para>
</note><caution><para>Do not use the GRUB <filename>menu.lst</filename> file to modify
Solaris Live Upgrade entries. Modifications could cause Solaris Live Upgrade
to fail. Although you can use the <filename>menu.lst</filename> file to customize
booting behavior, the preferred method for customization is to use the <command>eeprom</command> command. If you use the <filename>menu.lst</filename> file to customize,
the Solaris OS entries might be modified during a software upgrade. Changes
to the file could be lost.</para>
</caution>
</entry><entry><itemizedlist><listitem><para><olink targetdoc="solinstallpbiu" targetptr="fxivs" remap="external"><citetitle remap="section">GRUB Based Booting (Overview)</citetitle> in <citetitle remap="book">Solaris Express Installation Guide: Planning for Installation and Upgrade</citetitle></olink></para>
</listitem><listitem><para><olink targetdoc="sysadv1" targetptr="hbx86boot-68676" remap="external">Chapter 12, <citetitle remap="chapter">Booting a Solaris System With GRUB (Tasks),</citetitle> in <citetitle remap="book">System Administration Guide: Basic Administration</citetitle></olink></para>
</listitem>
</itemizedlist>
</entry>
</row>
</tbody>
</tgroup>
</table>
</sect2><task id="gacps" arch="x86"><title>To Activate a Boot Environment With the
GRUB Menu</title><tasksummary><para>You can switch between two boot environments with the GRUB menu. Note
the following limitations:</para><itemizedlist><listitem><para>The first activation of a boot environment must be done with
the <command>luactivate</command> command. After the initial activation, the
boot environment is displayed on the GRUB menu. The boot environment can then
be booted from the GRUB menu.</para>
</listitem><listitem><para><emphasis role="strong">Caution</emphasis> - Switching to
a boot environment with the GRUB menu bypasses synchronization. For more information
about synchronizing files, see link <olink targetptr="luplanning-1110" remap="internal">Forcing
a Synchronization Between Boot Environments</olink>.</para>
</listitem><listitem><para>If a boot environment was created with the <emphasis role="strong">Solaris 8, 9, or 10 3/05 release</emphasis>, the boot environment
must always be activated with the <command>luactivate</command> command. These
older boot environments are not displayed on the GRUB menu.</para>
</listitem>
</itemizedlist>
</tasksummary><procedure>&suStepA;<step><para>Reboot the system.</para><screen># <userinput>init 6</userinput></screen><para>The GRUB main menu is displayed. The two operating systems are listed,
Solaris and <literal>second_disk</literal>, which is a Solaris Live Upgrade
boot environment. The <literal>failsafe</literal> entries are for recovery,
if for some reason the primary OS does not boot.</para><screen>GNU GRUB version 0.95 (616K lower / 4127168K upper memory)
+-------------------------------------------------------------------+
|Solaris                                                            |
|Solaris  failsafe                                                  |
|second_disk                                                        |
|second_disk failsafe                                               |
+-------------------------------------------------------------------+
Use the ^ and v keys to select which entry is highlighted. Press
enter to boot the selected OS, 'e' to edit the commands before
booting, or 'c' for a command-line.</screen>
</step><step><para>To activate a boot environment, use the arrow key to select the
desired boot environment and press Return.</para><para>The selected boot environment
is booted and becomes the active boot environment.</para>
</step>
</procedure>
</task>
</sect1>
</chapter>